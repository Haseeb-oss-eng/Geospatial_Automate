var Yke=Object.create;var HR=Object.defineProperty;var Xke=Object.getOwnPropertyDescriptor;var Zke=Object.getOwnPropertyNames;var Kke=Object.getPrototypeOf,Qke=Object.prototype.hasOwnProperty;var XV=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var ve=(t,e)=>()=>(t&&(e=t(t=0)),e);var nr=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),nl=(t,e)=>{for(var r in e)HR(t,r,{get:e[r],enumerable:!0})},Jne=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Zke(e))!Qke.call(t,n)&&n!==r&&HR(t,n,{get:()=>e[n],enumerable:!(i=Xke(e,n))||i.enumerable});return t};var Tt=(t,e,r)=>(r=t!=null?Yke(Kke(t)):{},Jne(e||!t||!t.__esModule?HR(r,"default",{value:t,enumerable:!0}):r,t)),qR=t=>Jne(HR({},"__esModule",{value:!0}),t);var uoe=nr(Ui=>{"use strict";var QV=Symbol.for("react.transitional.element"),Jke=Symbol.for("react.portal"),eRe=Symbol.for("react.fragment"),tRe=Symbol.for("react.strict_mode"),rRe=Symbol.for("react.profiler"),iRe=Symbol.for("react.consumer"),nRe=Symbol.for("react.context"),oRe=Symbol.for("react.forward_ref"),sRe=Symbol.for("react.suspense"),aRe=Symbol.for("react.memo"),noe=Symbol.for("react.lazy"),lRe=Symbol.for("react.activity"),eoe=Symbol.iterator;function cRe(t){return t===null||typeof t!="object"?null:(t=eoe&&t[eoe]||t["@@iterator"],typeof t=="function"?t:null)}var ooe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},soe=Object.assign,aoe={};function bw(t,e,r){this.props=t,this.context=e,this.refs=aoe,this.updater=r||ooe}bw.prototype.isReactComponent={};bw.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};bw.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function loe(){}loe.prototype=bw.prototype;function JV(t,e,r){this.props=t,this.context=e,this.refs=aoe,this.updater=r||ooe}var ej=JV.prototype=new loe;ej.constructor=JV;soe(ej,bw.prototype);ej.isPureReactComponent=!0;var toe=Array.isArray;function KV(){}var Go={H:null,A:null,T:null,S:null},coe=Object.prototype.hasOwnProperty;function tj(t,e,r){var i=r.ref;return{$$typeof:QV,type:t,key:e,ref:i!==void 0?i:null,props:r}}function uRe(t,e){return tj(t.type,e,t.props)}function rj(t){return typeof t=="object"&&t!==null&&t.$$typeof===QV}function hRe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var roe=/\/+/g;function ZV(t,e){return typeof t=="object"&&t!==null&&t.key!=null?hRe(""+t.key):e.toString(36)}function dRe(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(KV,KV):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function vw(t,e,r,i,n){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"bigint":case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case QV:case Jke:s=!0;break;case noe:return s=t._init,vw(s(t._payload),e,r,i,n)}}if(s)return n=n(t),s=i===""?"."+ZV(t,0):i,toe(n)?(r="",s!=null&&(r=s.replace(roe,"$&/")+"/"),vw(n,e,r,"",function(p){return p})):n!=null&&(rj(n)&&(n=uRe(n,r+(n.key==null||t&&t.key===n.key?"":(""+n.key).replace(roe,"$&/")+"/")+s)),e.push(n)),1;s=0;var a=i===""?".":i+":";if(toe(t))for(var u=0;u<t.length;u++)i=t[u],o=a+ZV(i,u),s+=vw(i,e,r,o,n);else if(u=cRe(t),typeof u=="function")for(t=u.call(t),u=0;!(i=t.next()).done;)i=i.value,o=a+ZV(i,u++),s+=vw(i,e,r,o,n);else if(o==="object"){if(typeof t.then=="function")return vw(dRe(t),e,r,i,n);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return s}function YR(t,e,r){if(t==null)return t;var i=[],n=0;return vw(t,i,"","",function(o){return e.call(r,o,n++)}),i}function fRe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ioe=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},pRe={map:YR,forEach:function(t,e,r){YR(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return YR(t,function(){e++}),e},toArray:function(t){return YR(t,function(e){return e})||[]},only:function(t){if(!rj(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ui.Activity=lRe;Ui.Children=pRe;Ui.Component=bw;Ui.Fragment=eRe;Ui.Profiler=rRe;Ui.PureComponent=JV;Ui.StrictMode=tRe;Ui.Suspense=sRe;Ui.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Go;Ui.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Go.H.useMemoCache(t)}};Ui.cache=function(t){return function(){return t.apply(null,arguments)}};Ui.cacheSignal=function(){return null};Ui.cloneElement=function(t,e,r){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var i=soe({},t.props),n=t.key;if(e!=null)for(o in e.key!==void 0&&(n=""+e.key),e)!coe.call(e,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&e.ref===void 0||(i[o]=e[o]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];i.children=s}return tj(t.type,n,i)};Ui.createContext=function(t){return t={$$typeof:nRe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:iRe,_context:t},t};Ui.createElement=function(t,e,r){var i,n={},o=null;if(e!=null)for(i in e.key!==void 0&&(o=""+e.key),e)coe.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(n[i]=e[i]);var s=arguments.length-2;if(s===1)n.children=r;else if(1<s){for(var a=Array(s),u=0;u<s;u++)a[u]=arguments[u+2];n.children=a}if(t&&t.defaultProps)for(i in s=t.defaultProps,s)n[i]===void 0&&(n[i]=s[i]);return tj(t,o,n)};Ui.createRef=function(){return{current:null}};Ui.forwardRef=function(t){return{$$typeof:oRe,render:t}};Ui.isValidElement=rj;Ui.lazy=function(t){return{$$typeof:noe,_payload:{_status:-1,_result:t},_init:fRe}};Ui.memo=function(t,e){return{$$typeof:aRe,type:t,compare:e===void 0?null:e}};Ui.startTransition=function(t){var e=Go.T,r={};Go.T=r;try{var i=t(),n=Go.S;n!==null&&n(r,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(KV,ioe)}catch(o){ioe(o)}finally{e!==null&&r.types!==null&&(e.types=r.types),Go.T=e}};Ui.unstable_useCacheRefresh=function(){return Go.H.useCacheRefresh()};Ui.use=function(t){return Go.H.use(t)};Ui.useActionState=function(t,e,r){return Go.H.useActionState(t,e,r)};Ui.useCallback=function(t,e){return Go.H.useCallback(t,e)};Ui.useContext=function(t){return Go.H.useContext(t)};Ui.useDebugValue=function(){};Ui.useDeferredValue=function(t,e){return Go.H.useDeferredValue(t,e)};Ui.useEffect=function(t,e){return Go.H.useEffect(t,e)};Ui.useEffectEvent=function(t){return Go.H.useEffectEvent(t)};Ui.useId=function(){return Go.H.useId()};Ui.useImperativeHandle=function(t,e,r){return Go.H.useImperativeHandle(t,e,r)};Ui.useInsertionEffect=function(t,e){return Go.H.useInsertionEffect(t,e)};Ui.useLayoutEffect=function(t,e){return Go.H.useLayoutEffect(t,e)};Ui.useMemo=function(t,e){return Go.H.useMemo(t,e)};Ui.useOptimistic=function(t,e){return Go.H.useOptimistic(t,e)};Ui.useReducer=function(t,e,r){return Go.H.useReducer(t,e,r)};Ui.useRef=function(t){return Go.H.useRef(t)};Ui.useState=function(t){return Go.H.useState(t)};Ui.useSyncExternalStore=function(t,e,r){return Go.H.useSyncExternalStore(t,e,r)};Ui.useTransition=function(){return Go.H.useTransition()};Ui.version="19.2.0"});var $t=nr((Igt,hoe)=>{"use strict";hoe.exports=uoe()});var boe=nr(rs=>{"use strict";function sj(t,e){var r=t.length;t.push(e);e:for(;0<r;){var i=r-1>>>1,n=t[i];if(0<XR(n,e))t[i]=e,t[r]=n,r=i;else break e}}function Hp(t){return t.length===0?null:t[0]}function KR(t){if(t.length===0)return null;var e=t[0],r=t.pop();if(r!==e){t[0]=r;e:for(var i=0,n=t.length,o=n>>>1;i<o;){var s=2*(i+1)-1,a=t[s],u=s+1,p=t[u];if(0>XR(a,r))u<n&&0>XR(p,a)?(t[i]=p,t[u]=r,i=u):(t[i]=a,t[s]=r,i=s);else if(u<n&&0>XR(p,r))t[i]=p,t[u]=r,i=u;else break e}}return e}function XR(t,e){var r=t.sortIndex-e.sortIndex;return r!==0?r:t.id-e.id}rs.unstable_now=void 0;typeof performance=="object"&&typeof performance.now=="function"?(doe=performance,rs.unstable_now=function(){return doe.now()}):(ij=Date,foe=ij.now(),rs.unstable_now=function(){return ij.now()-foe});var doe,ij,foe,Cm=[],QA=[],mRe=1,sd=null,tc=3,aj=!1,sM=!1,aM=!1,lj=!1,goe=typeof setTimeout=="function"?setTimeout:null,Aoe=typeof clearTimeout=="function"?clearTimeout:null,poe=typeof setImmediate<"u"?setImmediate:null;function ZR(t){for(var e=Hp(QA);e!==null;){if(e.callback===null)KR(QA);else if(e.startTime<=t)KR(QA),e.sortIndex=e.expirationTime,sj(Cm,e);else break;e=Hp(QA)}}function cj(t){if(aM=!1,ZR(t),!sM)if(Hp(Cm)!==null)sM=!0,ww||(ww=!0,xw());else{var e=Hp(QA);e!==null&&uj(cj,e.startTime-t)}}var ww=!1,lM=-1,yoe=5,_oe=-1;function voe(){return lj?!0:!(rs.unstable_now()-_oe<yoe)}function nj(){if(lj=!1,ww){var t=rs.unstable_now();_oe=t;var e=!0;try{e:{sM=!1,aM&&(aM=!1,Aoe(lM),lM=-1),aj=!0;var r=tc;try{t:{for(ZR(t),sd=Hp(Cm);sd!==null&&!(sd.expirationTime>t&&voe());){var i=sd.callback;if(typeof i=="function"){sd.callback=null,tc=sd.priorityLevel;var n=i(sd.expirationTime<=t);if(t=rs.unstable_now(),typeof n=="function"){sd.callback=n,ZR(t),e=!0;break t}sd===Hp(Cm)&&KR(Cm),ZR(t)}else KR(Cm);sd=Hp(Cm)}if(sd!==null)e=!0;else{var o=Hp(QA);o!==null&&uj(cj,o.startTime-t),e=!1}}break e}finally{sd=null,tc=r,aj=!1}e=void 0}}finally{e?xw():ww=!1}}}var xw;typeof poe=="function"?xw=function(){poe(nj)}:typeof MessageChannel<"u"?(oj=new MessageChannel,moe=oj.port2,oj.port1.onmessage=nj,xw=function(){moe.postMessage(null)}):xw=function(){goe(nj,0)};var oj,moe;function uj(t,e){lM=goe(function(){t(rs.unstable_now())},e)}rs.unstable_IdlePriority=5;rs.unstable_ImmediatePriority=1;rs.unstable_LowPriority=4;rs.unstable_NormalPriority=3;rs.unstable_Profiling=null;rs.unstable_UserBlockingPriority=2;rs.unstable_cancelCallback=function(t){t.callback=null};rs.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):yoe=0<t?Math.floor(1e3/t):5};rs.unstable_getCurrentPriorityLevel=function(){return tc};rs.unstable_next=function(t){switch(tc){case 1:case 2:case 3:var e=3;break;default:e=tc}var r=tc;tc=e;try{return t()}finally{tc=r}};rs.unstable_requestPaint=function(){lj=!0};rs.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=tc;tc=t;try{return e()}finally{tc=r}};rs.unstable_scheduleCallback=function(t,e,r){var i=rs.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?i+r:i):r=i,t){case 1:var n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}return n=r+n,t={id:mRe++,callback:e,priorityLevel:t,startTime:r,expirationTime:n,sortIndex:-1},r>i?(t.sortIndex=r,sj(QA,t),Hp(Cm)===null&&t===Hp(QA)&&(aM?(Aoe(lM),lM=-1):aM=!0,uj(cj,r-i))):(t.sortIndex=n,sj(Cm,t),sM||aj||(sM=!0,ww||(ww=!0,xw()))),t};rs.unstable_shouldYield=voe;rs.unstable_wrapCallback=function(t){var e=tc;return function(){var r=tc;tc=e;try{return t.apply(this,arguments)}finally{tc=r}}}});var woe=nr((Rgt,xoe)=>{"use strict";xoe.exports=boe()});var Toe=nr(Rc=>{"use strict";var gRe=$t();function Soe(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function JA(){}var kc={d:{f:JA,r:function(){throw Error(Soe(522))},D:JA,C:JA,L:JA,m:JA,X:JA,S:JA,M:JA},p:0,findDOMNode:null},ARe=Symbol.for("react.portal");function yRe(t,e,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ARe,key:i==null?null:""+i,children:t,containerInfo:e,implementation:r}}var cM=gRe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function QR(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Rc.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=kc;Rc.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(Soe(299));return yRe(t,e,null,r)};Rc.flushSync=function(t){var e=cM.T,r=kc.p;try{if(cM.T=null,kc.p=2,t)return t()}finally{cM.T=e,kc.p=r,kc.d.f()}};Rc.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,kc.d.C(t,e))};Rc.prefetchDNS=function(t){typeof t=="string"&&kc.d.D(t)};Rc.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var r=e.as,i=QR(r,e.crossOrigin),n=typeof e.integrity=="string"?e.integrity:void 0,o=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;r==="style"?kc.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:n,fetchPriority:o}):r==="script"&&kc.d.X(t,{crossOrigin:i,integrity:n,fetchPriority:o,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Rc.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var r=QR(e.as,e.crossOrigin);kc.d.M(t,{crossOrigin:r,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&kc.d.M(t)};Rc.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var r=e.as,i=QR(r,e.crossOrigin);kc.d.L(t,r,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Rc.preloadModule=function(t,e){if(typeof t=="string")if(e){var r=QR(e.as,e.crossOrigin);kc.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:r,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else kc.d.m(t)};Rc.requestFormReset=function(t){kc.d.r(t)};Rc.unstable_batchedUpdates=function(t,e){return t(e)};Rc.useFormState=function(t,e,r){return cM.H.useFormState(t,e,r)};Rc.useFormStatus=function(){return cM.H.useHostTransitionStatus()};Rc.version="19.2.0"});var uM=nr((Dgt,Eoe)=>{"use strict";function Moe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Moe)}catch(t){console.error(t)}}Moe(),Eoe.exports=Toe()});var zce=nr(wO=>{"use strict";var ja=woe(),Jse=$t(),_Re=uM();function Vt(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function eae(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ZM(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function tae(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function rae(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Coe(t){if(ZM(t)!==t)throw Error(Vt(188))}function vRe(t){var e=t.alternate;if(!e){if(e=ZM(t),e===null)throw Error(Vt(188));return e!==t?null:t}for(var r=t,i=e;;){var n=r.return;if(n===null)break;var o=n.alternate;if(o===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===r)return Coe(n),t;if(o===i)return Coe(n),e;o=o.sibling}throw Error(Vt(188))}if(r.return!==i.return)r=n,i=o;else{for(var s=!1,a=n.child;a;){if(a===r){s=!0,r=n,i=o;break}if(a===i){s=!0,i=n,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,i=n;break}if(a===i){s=!0,i=o,r=n;break}a=a.sibling}if(!s)throw Error(Vt(189))}}if(r.alternate!==i)throw Error(Vt(190))}if(r.tag!==3)throw Error(Vt(188));return r.stateNode.current===r?t:e}function iae(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=iae(t),e!==null)return e;t=t.sibling}return null}var Yo=Object.assign,bRe=Symbol.for("react.element"),JR=Symbol.for("react.transitional.element"),yM=Symbol.for("react.portal"),Pw=Symbol.for("react.fragment"),nae=Symbol.for("react.strict_mode"),Wj=Symbol.for("react.profiler"),oae=Symbol.for("react.consumer"),Bm=Symbol.for("react.context"),z$=Symbol.for("react.forward_ref"),Gj=Symbol.for("react.suspense"),Hj=Symbol.for("react.suspense_list"),U$=Symbol.for("react.memo"),ey=Symbol.for("react.lazy");Symbol.for("react.scope");var qj=Symbol.for("react.activity");Symbol.for("react.legacy_hidden");Symbol.for("react.tracing_marker");var xRe=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var Poe=Symbol.iterator;function hM(t){return t===null||typeof t!="object"?null:(t=Poe&&t[Poe]||t["@@iterator"],typeof t=="function"?t:null)}var wRe=Symbol.for("react.client.reference");function Yj(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===wRe?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Pw:return"Fragment";case Wj:return"Profiler";case nae:return"StrictMode";case Gj:return"Suspense";case Hj:return"SuspenseList";case qj:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case yM:return"Portal";case Bm:return t.displayName||"Context";case oae:return(t._context.displayName||"Context")+".Consumer";case z$:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case U$:return e=t.displayName||null,e!==null?e:Yj(t.type)||"Memo";case ey:e=t._payload,t=t._init;try{return Yj(t(e))}catch{}}return null}var _M=Array.isArray,_i=Jse.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Nn=_Re.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,qv={pending:!1,data:null,method:null,action:null},Xj=[],Iw=-1;function Kp(t){return{current:t}}function al(t){0>Iw||(t.current=Xj[Iw],Xj[Iw]=null,Iw--)}function Lo(t,e){Iw++,Xj[Iw]=t.current,t.current=e}var Zp=Kp(null),BM=Kp(null),hy=Kp(null),R8=Kp(null);function O8(t,e){switch(Lo(hy,e),Lo(BM,t),Lo(Zp,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?Bse(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=Bse(e),t=Tce(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}al(Zp),Lo(Zp,t)}function Yw(){al(Zp),al(BM),al(hy)}function Zj(t){t.memoizedState!==null&&Lo(R8,t);var e=Zp.current,r=Tce(e,t.type);e!==r&&(Lo(BM,t),Lo(Zp,r))}function D8(t){BM.current===t&&(al(Zp),al(BM)),R8.current===t&&(al(R8),qM._currentValue=qv)}var hj,Ioe;function $v(t){if(hj===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);hj=e&&e[1]||"",Ioe=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+hj+t+Ioe}var dj=!1;function fj(t,e){if(!t||dj)return"";dj=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var x=function(){throw Error()};if(Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(k){var M=k}Reflect.construct(t,[],x)}else{try{x.call()}catch(k){M=k}t.call(x.prototype)}}else{try{throw Error()}catch(k){M=k}(x=t())&&typeof x.catch=="function"&&x.catch(function(){})}}catch(k){if(k&&M&&typeof k.stack=="string")return[k.stack,M.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var u=s.split(`
`),p=a.split(`
`);for(n=i=0;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;for(;n<p.length&&!p[n].includes("DetermineComponentFrameRoot");)n++;if(i===u.length||n===p.length)for(i=u.length-1,n=p.length-1;1<=i&&0<=n&&u[i]!==p[n];)n--;for(;1<=i&&0<=n;i--,n--)if(u[i]!==p[n]){if(i!==1||n!==1)do if(i--,n--,0>n||u[i]!==p[n]){var m=`
`+u[i].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=i&&0<=n);break}}}finally{dj=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?$v(r):""}function SRe(t,e){switch(t.tag){case 26:case 27:case 5:return $v(t.type);case 16:return $v("Lazy");case 13:return t.child!==e&&e!==null?$v("Suspense Fallback"):$v("Suspense");case 19:return $v("SuspenseList");case 0:case 15:return fj(t.type,!1);case 11:return fj(t.type.render,!1);case 1:return fj(t.type,!0);case 31:return $v("Activity");default:return""}}function koe(t){try{var e="",r=null;do e+=SRe(t,r),r=t,t=t.return;while(t);return e}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Kj=Object.prototype.hasOwnProperty,V$=ja.unstable_scheduleCallback,pj=ja.unstable_cancelCallback,TRe=ja.unstable_shouldYield,MRe=ja.unstable_requestPaint,uh=ja.unstable_now,ERe=ja.unstable_getCurrentPriorityLevel,sae=ja.unstable_ImmediatePriority,aae=ja.unstable_UserBlockingPriority,L8=ja.unstable_NormalPriority,CRe=ja.unstable_LowPriority,lae=ja.unstable_IdlePriority,PRe=ja.log,IRe=ja.unstable_setDisableYieldValue,KM=null,hh=null;function sy(t){if(typeof PRe=="function"&&IRe(t),hh&&typeof hh.setStrictMode=="function")try{hh.setStrictMode(KM,t)}catch{}}var dh=Math.clz32?Math.clz32:ORe,kRe=Math.log,RRe=Math.LN2;function ORe(t){return t>>>=0,t===0?32:31-(kRe(t)/RRe|0)|0}var e8=256,t8=262144,r8=4194304;function Wv(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function aO(t,e,r){var i=t.pendingLanes;if(i===0)return 0;var n=0,o=t.suspendedLanes,s=t.pingedLanes;t=t.warmLanes;var a=i&134217727;return a!==0?(i=a&~o,i!==0?n=Wv(i):(s&=a,s!==0?n=Wv(s):r||(r=a&~t,r!==0&&(n=Wv(r))))):(a=i&~o,a!==0?n=Wv(a):s!==0?n=Wv(s):r||(r=i&~t,r!==0&&(n=Wv(r)))),n===0?0:e!==0&&e!==n&&(e&o)===0&&(o=n&-n,r=e&-e,o>=r||o===32&&(r&4194048)!==0)?e:n}function QM(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function DRe(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cae(){var t=r8;return r8<<=1,(r8&62914560)===0&&(r8=4194304),t}function mj(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function JM(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function LRe(t,e,r,i,n,o){var s=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var a=t.entanglements,u=t.expirationTimes,p=t.hiddenUpdates;for(r=s&~r;0<r;){var m=31-dh(r),x=1<<m;a[m]=0,u[m]=-1;var M=p[m];if(M!==null)for(p[m]=null,m=0;m<M.length;m++){var k=M[m];k!==null&&(k.lane&=-536870913)}r&=~x}i!==0&&uae(t,i,0),o!==0&&n===0&&t.tag!==0&&(t.suspendedLanes|=o&~(s&~e))}function uae(t,e,r){t.pendingLanes|=e,t.suspendedLanes&=~e;var i=31-dh(e);t.entangledLanes|=e,t.entanglements[i]=t.entanglements[i]|1073741824|r&261930}function hae(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var i=31-dh(r),n=1<<i;n&e|t[i]&e&&(t[i]|=e),r&=~n}}function dae(t,e){var r=e&-e;return r=(r&42)!==0?1:j$(r),(r&(t.suspendedLanes|e))!==0?0:r}function j$(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function $$(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function fae(){var t=Nn.p;return t!==0?t:(t=window.event,t===void 0?32:Bce(t.type))}function Roe(t,e){var r=Nn.p;try{return Nn.p=t,e()}finally{Nn.p=r}}var Sy=Math.random().toString(36).slice(2),Ml="__reactFiber$"+Sy,gu="__reactProps$"+Sy,o2="__reactContainer$"+Sy,Qj="__reactEvents$"+Sy,BRe="__reactListeners$"+Sy,FRe="__reactHandles$"+Sy,Ooe="__reactResources$"+Sy,eE="__reactMarker$"+Sy;function W$(t){delete t[Ml],delete t[gu],delete t[Qj],delete t[BRe],delete t[FRe]}function kw(t){var e=t[Ml];if(e)return e;for(var r=t.parentNode;r;){if(e=r[o2]||r[Ml]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Vse(t);t!==null;){if(r=t[Ml])return r;t=Vse(t)}return e}t=r,r=t.parentNode}return null}function s2(t){if(t=t[Ml]||t[o2]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function vM(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(Vt(33))}function Vw(t){var e=t[Ooe];return e||(e=t[Ooe]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function sl(t){t[eE]=!0}var pae=new Set,mae={};function i1(t,e){Xw(t,e),Xw(t+"Capture",e)}function Xw(t,e){for(mae[t]=e,t=0;t<e.length;t++)pae.add(e[t])}var NRe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Doe={},Loe={};function zRe(t){return Kj.call(Loe,t)?!0:Kj.call(Doe,t)?!1:NRe.test(t)?Loe[t]=!0:(Doe[t]=!0,!1)}function A8(t,e,r){if(zRe(e))if(r===null)t.removeAttribute(e);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+r)}}function i8(t,e,r){if(r===null)t.removeAttribute(e);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+r)}}function Pm(t,e,r,i){if(i===null)t.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(e,r,""+i)}}function ld(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gae(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function URe(t,e,r){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var n=i.get,o=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Jj(t){if(!t._valueTracker){var e=gae(t)?"checked":"value";t._valueTracker=URe(t,e,""+t[e])}}function Aae(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),i="";return t&&(i=gae(t)?t.checked?"true":"false":t.value),t=i,t!==r?(e.setValue(t),!0):!1}function B8(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var VRe=/[\n"\\]/g;function hd(t){return t.replace(VRe,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function e$(t,e,r,i,n,o,s,a){t.name="",s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"?t.type=s:t.removeAttribute("type"),e!=null?s==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+ld(e)):t.value!==""+ld(e)&&(t.value=""+ld(e)):s!=="submit"&&s!=="reset"||t.removeAttribute("value"),e!=null?t$(t,s,ld(e)):r!=null?t$(t,s,ld(r)):i!=null&&t.removeAttribute("value"),n==null&&o!=null&&(t.defaultChecked=!!o),n!=null&&(t.checked=n&&typeof n!="function"&&typeof n!="symbol"),a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.name=""+ld(a):t.removeAttribute("name")}function yae(t,e,r,i,n,o,s,a){if(o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(t.type=o),e!=null||r!=null){if(!(o!=="submit"&&o!=="reset"||e!=null)){Jj(t);return}r=r!=null?""+ld(r):"",e=e!=null?""+ld(e):r,a||e===t.value||(t.value=e),t.defaultValue=e}i=i??n,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=a?t.checked:!!i,t.defaultChecked=!!i,s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(t.name=s),Jj(t)}function t$(t,e,r){e==="number"&&B8(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function jw(t,e,r,i){if(t=t.options,e){e={};for(var n=0;n<r.length;n++)e["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=e.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&i&&(t[r].defaultSelected=!0)}else{for(r=""+ld(r),e=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,i&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function _ae(t,e,r){if(e!=null&&(e=""+ld(e),e!==t.value&&(t.value=e),r==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=r!=null?""+ld(r):""}function vae(t,e,r,i){if(e==null){if(i!=null){if(r!=null)throw Error(Vt(92));if(_M(i)){if(1<i.length)throw Error(Vt(93));i=i[0]}r=i}r==null&&(r=""),e=r}r=ld(e),t.defaultValue=r,i=t.textContent,i===r&&i!==""&&i!==null&&(t.value=i),Jj(t)}function Zw(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var jRe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Boe(t,e,r){var i=e.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?i?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":i?t.setProperty(e,r):typeof r!="number"||r===0||jRe.has(e)?e==="float"?t.cssFloat=r:t[e]=(""+r).trim():t[e]=r+"px"}function bae(t,e,r){if(e!=null&&typeof e!="object")throw Error(Vt(62));if(t=t.style,r!=null){for(var i in r)!r.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var n in e)i=e[n],e.hasOwnProperty(n)&&r[n]!==i&&Boe(t,n,i)}else for(var o in e)e.hasOwnProperty(o)&&Boe(t,o,e[o])}function G$(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $Re=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),WRe=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function y8(t){return WRe.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Fm(){}var r$=null;function H$(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rw=null,$w=null;function Foe(t){var e=s2(t);if(e&&(t=e.stateNode)){var r=t[gu]||null;e:switch(t=e.stateNode,e.type){case"input":if(e$(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+hd(""+e)+'"][type="radio"]'),e=0;e<r.length;e++){var i=r[e];if(i!==t&&i.form===t.form){var n=i[gu]||null;if(!n)throw Error(Vt(90));e$(i,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(e=0;e<r.length;e++)i=r[e],i.form===t.form&&Aae(i)}break e;case"textarea":_ae(t,r.value,r.defaultValue);break e;case"select":e=r.value,e!=null&&jw(t,!!r.multiple,e,!1)}}}var gj=!1;function xae(t,e,r){if(gj)return t(e,r);gj=!0;try{var i=t(e);return i}finally{if(gj=!1,(Rw!==null||$w!==null)&&(_O(),Rw&&(e=Rw,t=$w,$w=Rw=null,Foe(e),t)))for(e=0;e<t.length;e++)Foe(t[e])}}function FM(t,e){var r=t.stateNode;if(r===null)return null;var i=r[gu]||null;if(i===null)return null;r=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Vt(231,e,typeof r));return r}var jm=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),i$=!1;if(jm)try{Sw={},Object.defineProperty(Sw,"passive",{get:function(){i$=!0}}),window.addEventListener("test",Sw,Sw),window.removeEventListener("test",Sw,Sw)}catch{i$=!1}var Sw,ay=null,q$=null,_8=null;function wae(){if(_8)return _8;var t,e=q$,r=e.length,i,n="value"in ay?ay.value:ay.textContent,o=n.length;for(t=0;t<r&&e[t]===n[t];t++);var s=r-t;for(i=1;i<=s&&e[r-i]===n[o-i];i++);return _8=n.slice(t,1<i?1-i:void 0)}function v8(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function n8(){return!0}function Noe(){return!1}function Au(t){function e(r,i,n,o,s){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?n8:Noe,this.isPropagationStopped=Noe,this}return Yo(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=n8)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=n8)},persist:function(){},isPersistent:n8}),e}var n1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lO=Au(n1),tE=Yo({},n1,{view:0,detail:0}),GRe=Au(tE),Aj,yj,dM,cO=Yo({},tE,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Y$,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==dM&&(dM&&t.type==="mousemove"?(Aj=t.screenX-dM.screenX,yj=t.screenY-dM.screenY):yj=Aj=0,dM=t),Aj)},movementY:function(t){return"movementY"in t?t.movementY:yj}}),zoe=Au(cO),HRe=Yo({},cO,{dataTransfer:0}),qRe=Au(HRe),YRe=Yo({},tE,{relatedTarget:0}),_j=Au(YRe),XRe=Yo({},n1,{animationName:0,elapsedTime:0,pseudoElement:0}),ZRe=Au(XRe),KRe=Yo({},n1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),QRe=Au(KRe),JRe=Yo({},n1,{data:0}),Uoe=Au(JRe),e8e={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t8e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r8e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i8e(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=r8e[t])?!!e[t]:!1}function Y$(){return i8e}var n8e=Yo({},tE,{key:function(t){if(t.key){var e=e8e[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=v8(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?t8e[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Y$,charCode:function(t){return t.type==="keypress"?v8(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?v8(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),o8e=Au(n8e),s8e=Yo({},cO,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Voe=Au(s8e),a8e=Yo({},tE,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Y$}),l8e=Au(a8e),c8e=Yo({},n1,{propertyName:0,elapsedTime:0,pseudoElement:0}),u8e=Au(c8e),h8e=Yo({},cO,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),d8e=Au(h8e),f8e=Yo({},n1,{newState:0,oldState:0}),p8e=Au(f8e),m8e=[9,13,27,32],X$=jm&&"CompositionEvent"in window,wM=null;jm&&"documentMode"in document&&(wM=document.documentMode);var g8e=jm&&"TextEvent"in window&&!wM,Sae=jm&&(!X$||wM&&8<wM&&11>=wM),joe=" ",$oe=!1;function Tae(t,e){switch(t){case"keyup":return m8e.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mae(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ow=!1;function A8e(t,e){switch(t){case"compositionend":return Mae(e);case"keypress":return e.which!==32?null:($oe=!0,joe);case"textInput":return t=e.data,t===joe&&$oe?null:t;default:return null}}function y8e(t,e){if(Ow)return t==="compositionend"||!X$&&Tae(t,e)?(t=wae(),_8=q$=ay=null,Ow=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Sae&&e.locale!=="ko"?null:e.data;default:return null}}var _8e={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Woe(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_8e[t.type]:e==="textarea"}function Eae(t,e,r,i){Rw?$w?$w.push(i):$w=[i]:Rw=i,e=eO(e,"onChange"),0<e.length&&(r=new lO("onChange","change",null,r,i),t.push({event:r,listeners:e}))}var SM=null,NM=null;function v8e(t){xce(t,0)}function uO(t){var e=vM(t);if(Aae(e))return t}function Goe(t,e){if(t==="change")return e}var Cae=!1;jm&&(jm?(s8="oninput"in document,s8||(vj=document.createElement("div"),vj.setAttribute("oninput","return;"),s8=typeof vj.oninput=="function"),o8=s8):o8=!1,Cae=o8&&(!document.documentMode||9<document.documentMode));var o8,s8,vj;function Hoe(){SM&&(SM.detachEvent("onpropertychange",Pae),NM=SM=null)}function Pae(t){if(t.propertyName==="value"&&uO(NM)){var e=[];Eae(e,NM,t,H$(t)),xae(v8e,e)}}function b8e(t,e,r){t==="focusin"?(Hoe(),SM=e,NM=r,SM.attachEvent("onpropertychange",Pae)):t==="focusout"&&Hoe()}function x8e(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uO(NM)}function w8e(t,e){if(t==="click")return uO(e)}function S8e(t,e){if(t==="input"||t==="change")return uO(e)}function T8e(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ph=typeof Object.is=="function"?Object.is:T8e;function zM(t,e){if(ph(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!Kj.call(e,n)||!ph(t[n],e[n]))return!1}return!0}function qoe(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yoe(t,e){var r=qoe(t);t=0;for(var i;r;){if(r.nodeType===3){if(i=t+r.textContent.length,t<=e&&i>=e)return{node:r,offset:e-t};t=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=qoe(r)}}function Iae(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Iae(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function kae(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=B8(t.document);e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=B8(t.document)}return e}function Z$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var M8e=jm&&"documentMode"in document&&11>=document.documentMode,Dw=null,n$=null,TM=null,o$=!1;function Xoe(t,e,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;o$||Dw==null||Dw!==B8(i)||(i=Dw,"selectionStart"in i&&Z$(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),TM&&zM(TM,i)||(TM=i,i=eO(n$,"onSelect"),0<i.length&&(e=new lO("onSelect","select",null,e,r),t.push({event:e,listeners:i}),e.target=Dw)))}function jv(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Lw={animationend:jv("Animation","AnimationEnd"),animationiteration:jv("Animation","AnimationIteration"),animationstart:jv("Animation","AnimationStart"),transitionrun:jv("Transition","TransitionRun"),transitionstart:jv("Transition","TransitionStart"),transitioncancel:jv("Transition","TransitionCancel"),transitionend:jv("Transition","TransitionEnd")},bj={},Rae={};jm&&(Rae=document.createElement("div").style,"AnimationEvent"in window||(delete Lw.animationend.animation,delete Lw.animationiteration.animation,delete Lw.animationstart.animation),"TransitionEvent"in window||delete Lw.transitionend.transition);function o1(t){if(bj[t])return bj[t];if(!Lw[t])return t;var e=Lw[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Rae)return bj[t]=e[r];return t}var Oae=o1("animationend"),Dae=o1("animationiteration"),Lae=o1("animationstart"),E8e=o1("transitionrun"),C8e=o1("transitionstart"),P8e=o1("transitioncancel"),Bae=o1("transitionend"),Fae=new Map,s$="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");s$.push("scrollEnd");function Pf(t,e){Fae.set(t,e),i1(e,[t])}var F8=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ad=[],Bw=0,K$=0;function hO(){for(var t=Bw,e=K$=Bw=0;e<t;){var r=ad[e];ad[e++]=null;var i=ad[e];ad[e++]=null;var n=ad[e];ad[e++]=null;var o=ad[e];if(ad[e++]=null,i!==null&&n!==null){var s=i.pending;s===null?n.next=n:(n.next=s.next,s.next=n),i.pending=n}o!==0&&Nae(r,n,o)}}function dO(t,e,r,i){ad[Bw++]=t,ad[Bw++]=e,ad[Bw++]=r,ad[Bw++]=i,K$|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function Q$(t,e,r,i){return dO(t,e,r,i),N8(t)}function s1(t,e){return dO(t,null,null,e),N8(t)}function Nae(t,e,r){t.lanes|=r;var i=t.alternate;i!==null&&(i.lanes|=r);for(var n=!1,o=t.return;o!==null;)o.childLanes|=r,i=o.alternate,i!==null&&(i.childLanes|=r),o.tag===22&&(t=o.stateNode,t===null||t._visibility&1||(n=!0)),t=o,o=o.return;return t.tag===3?(o=t.stateNode,n&&e!==null&&(n=31-dh(r),t=o.hiddenUpdates,i=t[n],i===null?t[n]=[e]:i.push(e),e.lane=r|536870912),o):null}function N8(t){if(50<DM)throw DM=0,E$=null,Error(Vt(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var Fw={};function I8e(t,e,r,i){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lh(t,e,r,i){return new I8e(t,e,r,i)}function J$(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zm(t,e){var r=t.alternate;return r===null?(r=lh(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&65011712,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function zae(t,e){t.flags&=65011714;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function b8(t,e,r,i,n,o){var s=0;if(i=t,typeof t=="function")J$(t)&&(s=1);else if(typeof t=="string")s=OOe(t,r,Zp.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case qj:return t=lh(31,r,e,n),t.elementType=qj,t.lanes=o,t;case Pw:return Yv(r.children,n,o,e);case nae:s=8,n|=24;break;case Wj:return t=lh(12,r,e,n|2),t.elementType=Wj,t.lanes=o,t;case Gj:return t=lh(13,r,e,n),t.elementType=Gj,t.lanes=o,t;case Hj:return t=lh(19,r,e,n),t.elementType=Hj,t.lanes=o,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Bm:s=10;break e;case oae:s=9;break e;case z$:s=11;break e;case U$:s=14;break e;case ey:s=16,i=null;break e}s=29,r=Error(Vt(130,t===null?"null":typeof t,"")),i=null}return e=lh(s,r,e,n),e.elementType=t,e.type=i,e.lanes=o,e}function Yv(t,e,r,i){return t=lh(7,t,i,e),t.lanes=r,t}function xj(t,e,r){return t=lh(6,t,null,e),t.lanes=r,t}function Uae(t){var e=lh(18,null,null,0);return e.stateNode=t,e}function wj(t,e,r){return e=lh(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Zoe=new WeakMap;function dd(t,e){if(typeof t=="object"&&t!==null){var r=Zoe.get(t);return r!==void 0?r:(e={value:t,source:e,stack:koe(e)},Zoe.set(t,e),e)}return{value:t,source:e,stack:koe(e)}}var Nw=[],zw=0,z8=null,UM=0,cd=[],ud=0,vy=null,qp=1,Yp="";function Dm(t,e){Nw[zw++]=UM,Nw[zw++]=z8,z8=t,UM=e}function Vae(t,e,r){cd[ud++]=qp,cd[ud++]=Yp,cd[ud++]=vy,vy=t;var i=qp;t=Yp;var n=32-dh(i)-1;i&=~(1<<n),r+=1;var o=32-dh(e)+n;if(30<o){var s=n-n%5;o=(i&(1<<s)-1).toString(32),i>>=s,n-=s,qp=1<<32-dh(e)+n|r<<n|i,Yp=o+t}else qp=1<<o|r<<n|i,Yp=t}function eW(t){t.return!==null&&(Dm(t,1),Vae(t,1,0))}function tW(t){for(;t===z8;)z8=Nw[--zw],Nw[zw]=null,UM=Nw[--zw],Nw[zw]=null;for(;t===vy;)vy=cd[--ud],cd[ud]=null,Yp=cd[--ud],cd[ud]=null,qp=cd[--ud],cd[ud]=null}function jae(t,e){cd[ud++]=qp,cd[ud++]=Yp,cd[ud++]=vy,qp=e.id,Yp=e.overflow,vy=t}var El=null,qo=null,yn=!1,dy=null,fd=!1,a$=Error(Vt(519));function by(t){var e=Error(Vt(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw VM(dd(e,t)),a$}function Koe(t){var e=t.stateNode,r=t.type,i=t.memoizedProps;switch(e[Ml]=t,e[gu]=i,r){case"dialog":an("cancel",e),an("close",e);break;case"iframe":case"object":case"embed":an("load",e);break;case"video":case"audio":for(r=0;r<GM.length;r++)an(GM[r],e);break;case"source":an("error",e);break;case"img":case"image":case"link":an("error",e),an("load",e);break;case"details":an("toggle",e);break;case"input":an("invalid",e),yae(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":an("invalid",e);break;case"textarea":an("invalid",e),vae(e,i.value,i.defaultValue,i.children)}r=i.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||e.textContent===""+r||i.suppressHydrationWarning===!0||Sce(e.textContent,r)?(i.popover!=null&&(an("beforetoggle",e),an("toggle",e)),i.onScroll!=null&&an("scroll",e),i.onScrollEnd!=null&&an("scrollend",e),i.onClick!=null&&(e.onclick=Fm),e=!0):e=!1,e||by(t,!0)}function Qoe(t){for(El=t.return;El;)switch(El.tag){case 5:case 31:case 13:fd=!1;return;case 27:case 3:fd=!0;return;default:El=El.return}}function Tw(t){if(t!==El)return!1;if(!yn)return Qoe(t),yn=!0,!1;var e=t.tag,r;if((r=e!==3&&e!==27)&&((r=e===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||R$(t.type,t.memoizedProps)),r=!r),r&&qo&&by(t),Qoe(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Vt(317));qo=Use(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Vt(317));qo=Use(t)}else e===27?(e=qo,Ty(t.type)?(t=B$,B$=null,qo=t):qo=e):qo=El?md(t.stateNode.nextSibling):null;return!0}function Qv(){qo=El=null,yn=!1}function Sj(){var t=dy;return t!==null&&(pu===null?pu=t:pu.push.apply(pu,t),dy=null),t}function VM(t){dy===null?dy=[t]:dy.push(t)}var l$=Kp(null),a1=null,Nm=null;function ry(t,e,r){Lo(l$,e._currentValue),e._currentValue=r}function Um(t){t._currentValue=l$.current,al(l$)}function c$(t,e,r){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===r)break;t=t.return}}function u$(t,e,r,i){var n=t.child;for(n!==null&&(n.return=t);n!==null;){var o=n.dependencies;if(o!==null){var s=n.child;o=o.firstContext;e:for(;o!==null;){var a=o;o=n;for(var u=0;u<e.length;u++)if(a.context===e[u]){o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),c$(o.return,r,t),i||(s=null);break e}o=a.next}}else if(n.tag===18){if(s=n.return,s===null)throw Error(Vt(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),c$(s,r,t),s=null}else s=n.child;if(s!==null)s.return=n;else for(s=n;s!==null;){if(s===t){s=null;break}if(n=s.sibling,n!==null){n.return=s.return,s=n;break}s=s.return}n=s}}function a2(t,e,r,i){t=null;for(var n=e,o=!1;n!==null;){if(!o){if((n.flags&524288)!==0)o=!0;else if((n.flags&262144)!==0)break}if(n.tag===10){var s=n.alternate;if(s===null)throw Error(Vt(387));if(s=s.memoizedProps,s!==null){var a=n.type;ph(n.pendingProps.value,s.value)||(t!==null?t.push(a):t=[a])}}else if(n===R8.current){if(s=n.alternate,s===null)throw Error(Vt(387));s.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(t!==null?t.push(qM):t=[qM])}n=n.return}t!==null&&u$(e,t,r,i),e.flags|=262144}function U8(t){for(t=t.firstContext;t!==null;){if(!ph(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Jv(t){a1=t,Nm=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Cl(t){return $ae(a1,t)}function a8(t,e){return a1===null&&Jv(t),$ae(t,e)}function $ae(t,e){var r=e._currentValue;if(e={context:e,memoizedValue:r,next:null},Nm===null){if(t===null)throw Error(Vt(308));Nm=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else Nm=Nm.next=e;return r}var k8e=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(r,i){t.push(i)}};this.abort=function(){e.aborted=!0,t.forEach(function(r){return r()})}},R8e=ja.unstable_scheduleCallback,O8e=ja.unstable_NormalPriority,va={$$typeof:Bm,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rW(){return{controller:new k8e,data:new Map,refCount:0}}function rE(t){t.refCount--,t.refCount===0&&R8e(O8e,function(){t.controller.abort()})}var MM=null,h$=0,Kw=0,Ww=null;function D8e(t,e){if(MM===null){var r=MM=[];h$=0,Kw=EW(),Ww={status:"pending",value:void 0,then:function(i){r.push(i)}}}return h$++,e.then(Joe,Joe),e}function Joe(){if(--h$===0&&MM!==null){Ww!==null&&(Ww.status="fulfilled");var t=MM;MM=null,Kw=0,Ww=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function L8e(t,e){var r=[],i={status:"pending",value:null,reason:null,then:function(n){r.push(n)}};return t.then(function(){i.status="fulfilled",i.value=e;for(var n=0;n<r.length;n++)(0,r[n])(e)},function(n){for(i.status="rejected",i.reason=n,n=0;n<r.length;n++)(0,r[n])(void 0)}),i}var ese=_i.S;_i.S=function(t,e){ice=uh(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&D8e(t,e),ese!==null&&ese(t,e)};var Xv=Kp(null);function iW(){var t=Xv.current;return t!==null?t:To.pooledCache}function x8(t,e){e===null?Lo(Xv,Xv.current):Lo(Xv,e.pool)}function Wae(){var t=iW();return t===null?null:{parent:va._currentValue,pool:t}}var l2=Error(Vt(460)),nW=Error(Vt(474)),fO=Error(Vt(542)),V8={then:function(){}};function tse(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Gae(t,e,r){switch(r=t[r],r===void 0?t.push(e):r!==e&&(e.then(Fm,Fm),e=r),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,ise(t),t;default:if(typeof e.status=="string")e.then(Fm,Fm);else{if(t=To,t!==null&&100<t.shellSuspendCounter)throw Error(Vt(482));t=e,t.status="pending",t.then(function(i){if(e.status==="pending"){var n=e;n.status="fulfilled",n.value=i}},function(i){if(e.status==="pending"){var n=e;n.status="rejected",n.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,ise(t),t}throw Zv=e,l2}}function Gv(t){try{var e=t._init;return e(t._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(Zv=r,l2):r}}var Zv=null;function rse(){if(Zv===null)throw Error(Vt(459));var t=Zv;return Zv=null,t}function ise(t){if(t===l2||t===fO)throw Error(Vt(483))}var Gw=null,jM=0;function l8(t){var e=jM;return jM+=1,Gw===null&&(Gw=[]),Gae(Gw,t,e)}function fM(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function c8(t,e){throw e.$$typeof===bRe?Error(Vt(525)):(t=Object.prototype.toString.call(e),Error(Vt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function Hae(t){function e(W,Z){if(t){var Y=W.deletions;Y===null?(W.deletions=[Z],W.flags|=16):Y.push(Z)}}function r(W,Z){if(!t)return null;for(;Z!==null;)e(W,Z),Z=Z.sibling;return null}function i(W){for(var Z=new Map;W!==null;)W.key!==null?Z.set(W.key,W):Z.set(W.index,W),W=W.sibling;return Z}function n(W,Z){return W=zm(W,Z),W.index=0,W.sibling=null,W}function o(W,Z,Y){return W.index=Y,t?(Y=W.alternate,Y!==null?(Y=Y.index,Y<Z?(W.flags|=67108866,Z):Y):(W.flags|=67108866,Z)):(W.flags|=1048576,Z)}function s(W){return t&&W.alternate===null&&(W.flags|=67108866),W}function a(W,Z,Y,ee){return Z===null||Z.tag!==6?(Z=xj(Y,W.mode,ee),Z.return=W,Z):(Z=n(Z,Y),Z.return=W,Z)}function u(W,Z,Y,ee){var ce=Y.type;return ce===Pw?m(W,Z,Y.props.children,ee,Y.key):Z!==null&&(Z.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===ey&&Gv(ce)===Z.type)?(Z=n(Z,Y.props),fM(Z,Y),Z.return=W,Z):(Z=b8(Y.type,Y.key,Y.props,null,W.mode,ee),fM(Z,Y),Z.return=W,Z)}function p(W,Z,Y,ee){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==Y.containerInfo||Z.stateNode.implementation!==Y.implementation?(Z=wj(Y,W.mode,ee),Z.return=W,Z):(Z=n(Z,Y.children||[]),Z.return=W,Z)}function m(W,Z,Y,ee,ce){return Z===null||Z.tag!==7?(Z=Yv(Y,W.mode,ee,ce),Z.return=W,Z):(Z=n(Z,Y),Z.return=W,Z)}function x(W,Z,Y){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=xj(""+Z,W.mode,Y),Z.return=W,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case JR:return Y=b8(Z.type,Z.key,Z.props,null,W.mode,Y),fM(Y,Z),Y.return=W,Y;case yM:return Z=wj(Z,W.mode,Y),Z.return=W,Z;case ey:return Z=Gv(Z),x(W,Z,Y)}if(_M(Z)||hM(Z))return Z=Yv(Z,W.mode,Y,null),Z.return=W,Z;if(typeof Z.then=="function")return x(W,l8(Z),Y);if(Z.$$typeof===Bm)return x(W,a8(W,Z),Y);c8(W,Z)}return null}function M(W,Z,Y,ee){var ce=Z!==null?Z.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return ce!==null?null:a(W,Z,""+Y,ee);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case JR:return Y.key===ce?u(W,Z,Y,ee):null;case yM:return Y.key===ce?p(W,Z,Y,ee):null;case ey:return Y=Gv(Y),M(W,Z,Y,ee)}if(_M(Y)||hM(Y))return ce!==null?null:m(W,Z,Y,ee,null);if(typeof Y.then=="function")return M(W,Z,l8(Y),ee);if(Y.$$typeof===Bm)return M(W,Z,a8(W,Y),ee);c8(W,Y)}return null}function k(W,Z,Y,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return W=W.get(Y)||null,a(Z,W,""+ee,ce);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case JR:return W=W.get(ee.key===null?Y:ee.key)||null,u(Z,W,ee,ce);case yM:return W=W.get(ee.key===null?Y:ee.key)||null,p(Z,W,ee,ce);case ey:return ee=Gv(ee),k(W,Z,Y,ee,ce)}if(_M(ee)||hM(ee))return W=W.get(Y)||null,m(Z,W,ee,ce,null);if(typeof ee.then=="function")return k(W,Z,Y,l8(ee),ce);if(ee.$$typeof===Bm)return k(W,Z,Y,a8(Z,ee),ce);c8(Z,ee)}return null}function F(W,Z,Y,ee){for(var ce=null,ge=null,Se=Z,ne=Z=0,pe=null;Se!==null&&ne<Y.length;ne++){Se.index>ne?(pe=Se,Se=null):pe=Se.sibling;var ue=M(W,Se,Y[ne],ee);if(ue===null){Se===null&&(Se=pe);break}t&&Se&&ue.alternate===null&&e(W,Se),Z=o(ue,Z,ne),ge===null?ce=ue:ge.sibling=ue,ge=ue,Se=pe}if(ne===Y.length)return r(W,Se),yn&&Dm(W,ne),ce;if(Se===null){for(;ne<Y.length;ne++)Se=x(W,Y[ne],ee),Se!==null&&(Z=o(Se,Z,ne),ge===null?ce=Se:ge.sibling=Se,ge=Se);return yn&&Dm(W,ne),ce}for(Se=i(Se);ne<Y.length;ne++)pe=k(Se,W,ne,Y[ne],ee),pe!==null&&(t&&pe.alternate!==null&&Se.delete(pe.key===null?ne:pe.key),Z=o(pe,Z,ne),ge===null?ce=pe:ge.sibling=pe,ge=pe);return t&&Se.forEach(function(Le){return e(W,Le)}),yn&&Dm(W,ne),ce}function j(W,Z,Y,ee){if(Y==null)throw Error(Vt(151));for(var ce=null,ge=null,Se=Z,ne=Z=0,pe=null,ue=Y.next();Se!==null&&!ue.done;ne++,ue=Y.next()){Se.index>ne?(pe=Se,Se=null):pe=Se.sibling;var Le=M(W,Se,ue.value,ee);if(Le===null){Se===null&&(Se=pe);break}t&&Se&&Le.alternate===null&&e(W,Se),Z=o(Le,Z,ne),ge===null?ce=Le:ge.sibling=Le,ge=Le,Se=pe}if(ue.done)return r(W,Se),yn&&Dm(W,ne),ce;if(Se===null){for(;!ue.done;ne++,ue=Y.next())ue=x(W,ue.value,ee),ue!==null&&(Z=o(ue,Z,ne),ge===null?ce=ue:ge.sibling=ue,ge=ue);return yn&&Dm(W,ne),ce}for(Se=i(Se);!ue.done;ne++,ue=Y.next())ue=k(Se,W,ne,ue.value,ee),ue!==null&&(t&&ue.alternate!==null&&Se.delete(ue.key===null?ne:ue.key),Z=o(ue,Z,ne),ge===null?ce=ue:ge.sibling=ue,ge=ue);return t&&Se.forEach(function(We){return e(W,We)}),yn&&Dm(W,ne),ce}function H(W,Z,Y,ee){if(typeof Y=="object"&&Y!==null&&Y.type===Pw&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case JR:e:{for(var ce=Y.key;Z!==null;){if(Z.key===ce){if(ce=Y.type,ce===Pw){if(Z.tag===7){r(W,Z.sibling),ee=n(Z,Y.props.children),ee.return=W,W=ee;break e}}else if(Z.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===ey&&Gv(ce)===Z.type){r(W,Z.sibling),ee=n(Z,Y.props),fM(ee,Y),ee.return=W,W=ee;break e}r(W,Z);break}else e(W,Z);Z=Z.sibling}Y.type===Pw?(ee=Yv(Y.props.children,W.mode,ee,Y.key),ee.return=W,W=ee):(ee=b8(Y.type,Y.key,Y.props,null,W.mode,ee),fM(ee,Y),ee.return=W,W=ee)}return s(W);case yM:e:{for(ce=Y.key;Z!==null;){if(Z.key===ce)if(Z.tag===4&&Z.stateNode.containerInfo===Y.containerInfo&&Z.stateNode.implementation===Y.implementation){r(W,Z.sibling),ee=n(Z,Y.children||[]),ee.return=W,W=ee;break e}else{r(W,Z);break}else e(W,Z);Z=Z.sibling}ee=wj(Y,W.mode,ee),ee.return=W,W=ee}return s(W);case ey:return Y=Gv(Y),H(W,Z,Y,ee)}if(_M(Y))return F(W,Z,Y,ee);if(hM(Y)){if(ce=hM(Y),typeof ce!="function")throw Error(Vt(150));return Y=ce.call(Y),j(W,Z,Y,ee)}if(typeof Y.then=="function")return H(W,Z,l8(Y),ee);if(Y.$$typeof===Bm)return H(W,Z,a8(W,Y),ee);c8(W,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,Z!==null&&Z.tag===6?(r(W,Z.sibling),ee=n(Z,Y),ee.return=W,W=ee):(r(W,Z),ee=xj(Y,W.mode,ee),ee.return=W,W=ee),s(W)):r(W,Z)}return function(W,Z,Y,ee){try{jM=0;var ce=H(W,Z,Y,ee);return Gw=null,ce}catch(Se){if(Se===l2||Se===fO)throw Se;var ge=lh(29,Se,null,W.mode);return ge.lanes=ee,ge.return=W,ge}finally{}}}var e1=Hae(!0),qae=Hae(!1),ty=!1;function oW(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function d$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function fy(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function py(t,e,r){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,(Fn&2)!==0){var n=i.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),i.pending=e,e=N8(t),Nae(t,null,r),e}return dO(t,i,e,r),N8(t)}function EM(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194048)!==0)){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,hae(t,r)}}function Tj(t,e){var r=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};o===null?n=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?n=o=e:o=o.next=e}else n=o=e;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}var f$=!1;function CM(){if(f$){var t=Ww;if(t!==null)throw t}}function PM(t,e,r,i){f$=!1;var n=t.updateQueue;ty=!1;var o=n.firstBaseUpdate,s=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var u=a,p=u.next;u.next=null,s===null?o=p:s.next=p,s=u;var m=t.alternate;m!==null&&(m=m.updateQueue,a=m.lastBaseUpdate,a!==s&&(a===null?m.firstBaseUpdate=p:a.next=p,m.lastBaseUpdate=u))}if(o!==null){var x=n.baseState;s=0,m=p=u=null,a=o;do{var M=a.lane&-536870913,k=M!==a.lane;if(k?(fn&M)===M:(i&M)===M){M!==0&&M===Kw&&(f$=!0),m!==null&&(m=m.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var F=t,j=a;M=e;var H=r;switch(j.tag){case 1:if(F=j.payload,typeof F=="function"){x=F.call(H,x,M);break e}x=F;break e;case 3:F.flags=F.flags&-65537|128;case 0:if(F=j.payload,M=typeof F=="function"?F.call(H,x,M):F,M==null)break e;x=Yo({},x,M);break e;case 2:ty=!0}}M=a.callback,M!==null&&(t.flags|=64,k&&(t.flags|=8192),k=n.callbacks,k===null?n.callbacks=[M]:k.push(M))}else k={lane:M,tag:a.tag,payload:a.payload,callback:a.callback,next:null},m===null?(p=m=k,u=x):m=m.next=k,s|=M;if(a=a.next,a===null){if(a=n.shared.pending,a===null)break;k=a,a=k.next,k.next=null,n.lastBaseUpdate=k,n.shared.pending=null}}while(!0);m===null&&(u=x),n.baseState=u,n.firstBaseUpdate=p,n.lastBaseUpdate=m,o===null&&(n.shared.lanes=0),wy|=s,t.lanes=s,t.memoizedState=x}}function Yae(t,e){if(typeof t!="function")throw Error(Vt(191,t));t.call(e)}function Xae(t,e){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)Yae(r[t],e)}var Qw=Kp(null),j8=Kp(0);function nse(t,e){t=Hm,Lo(j8,t),Lo(Qw,e),Hm=t|e.baseLanes}function p$(){Lo(j8,Hm),Lo(Qw,Qw.current)}function sW(){Hm=j8.current,al(Qw),al(j8)}var mh=Kp(null),pd=null;function iy(t){var e=t.alternate;Lo(Ks,Ks.current&1),Lo(mh,t),pd===null&&(e===null||Qw.current!==null||e.memoizedState!==null)&&(pd=t)}function m$(t){Lo(Ks,Ks.current),Lo(mh,t),pd===null&&(pd=t)}function Zae(t){t.tag===22?(Lo(Ks,Ks.current),Lo(mh,t),pd===null&&(pd=t)):ny(t)}function ny(){Lo(Ks,Ks.current),Lo(mh,mh.current)}function ah(t){al(mh),pd===t&&(pd=null),al(Ks)}var Ks=Kp(0);function $8(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||D$(r)||L$(r)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $m=0,Gi=null,Ao=null,ya=null,W8=!1,Hw=!1,t1=!1,G8=0,$M=0,qw=null,B8e=0;function Ps(){throw Error(Vt(321))}function aW(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ph(t[r],e[r]))return!1;return!0}function lW(t,e,r,i,n,o){return $m=o,Gi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_i.H=t===null||t.memoizedState===null?Ele:_W,t1=!1,o=r(i,n),t1=!1,Hw&&(o=Qae(e,r,i,n)),Kae(t),o}function Kae(t){_i.H=WM;var e=Ao!==null&&Ao.next!==null;if($m=0,ya=Ao=Gi=null,W8=!1,$M=0,qw=null,e)throw Error(Vt(300));t===null||ba||(t=t.dependencies,t!==null&&U8(t)&&(ba=!0))}function Qae(t,e,r,i){Gi=t;var n=0;do{if(Hw&&(qw=null),$M=0,Hw=!1,25<=n)throw Error(Vt(301));if(n+=1,ya=Ao=null,t.updateQueue!=null){var o=t.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}_i.H=Cle,o=e(r,i)}while(Hw);return o}function F8e(){var t=_i.H,e=t.useState()[0];return e=typeof e.then=="function"?iE(e):e,t=t.useState()[0],(Ao!==null?Ao.memoizedState:null)!==t&&(Gi.flags|=1024),e}function cW(){var t=G8!==0;return G8=0,t}function uW(t,e,r){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r}function hW(t){if(W8){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}W8=!1}$m=0,ya=Ao=Gi=null,Hw=!1,$M=G8=0,qw=null}function Oc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ya===null?Gi.memoizedState=ya=t:ya=ya.next=t,ya}function Qs(){if(Ao===null){var t=Gi.alternate;t=t!==null?t.memoizedState:null}else t=Ao.next;var e=ya===null?Gi.memoizedState:ya.next;if(e!==null)ya=e,Ao=t;else{if(t===null)throw Gi.alternate===null?Error(Vt(467)):Error(Vt(310));Ao=t,t={memoizedState:Ao.memoizedState,baseState:Ao.baseState,baseQueue:Ao.baseQueue,queue:Ao.queue,next:null},ya===null?Gi.memoizedState=ya=t:ya=ya.next=t}return ya}function pO(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function iE(t){var e=$M;return $M+=1,qw===null&&(qw=[]),t=Gae(qw,t,e),e=Gi,(ya===null?e.memoizedState:ya.next)===null&&(e=e.alternate,_i.H=e===null||e.memoizedState===null?Ele:_W),t}function mO(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return iE(t);if(t.$$typeof===Bm)return Cl(t)}throw Error(Vt(438,String(t)))}function dW(t){var e=null,r=Gi.updateQueue;if(r!==null&&(e=r.memoCache),e==null){var i=Gi.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(n){return n.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),r===null&&(r=pO(),Gi.updateQueue=r),r.memoCache=e,r=e.data[e.index],r===void 0)for(r=e.data[e.index]=Array(t),i=0;i<t;i++)r[i]=xRe;return e.index++,r}function Wm(t,e){return typeof e=="function"?e(t):e}function w8(t){var e=Qs();return fW(e,Ao,t)}function fW(t,e,r){var i=t.queue;if(i===null)throw Error(Vt(311));i.lastRenderedReducer=r;var n=t.baseQueue,o=i.pending;if(o!==null){if(n!==null){var s=n.next;n.next=o.next,o.next=s}e.baseQueue=n=o,i.pending=null}if(o=t.baseState,n===null)t.memoizedState=o;else{e=n.next;var a=s=null,u=null,p=e,m=!1;do{var x=p.lane&-536870913;if(x!==p.lane?(fn&x)===x:($m&x)===x){var M=p.revertLane;if(M===0)u!==null&&(u=u.next={lane:0,revertLane:0,gesture:null,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),x===Kw&&(m=!0);else if(($m&M)===M){p=p.next,M===Kw&&(m=!0);continue}else x={lane:0,revertLane:p.revertLane,gesture:null,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null},u===null?(a=u=x,s=o):u=u.next=x,Gi.lanes|=M,wy|=M;x=p.action,t1&&r(o,x),o=p.hasEagerState?p.eagerState:r(o,x)}else M={lane:x,revertLane:p.revertLane,gesture:p.gesture,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null},u===null?(a=u=M,s=o):u=u.next=M,Gi.lanes|=x,wy|=x;p=p.next}while(p!==null&&p!==e);if(u===null?s=o:u.next=a,!ph(o,t.memoizedState)&&(ba=!0,m&&(r=Ww,r!==null)))throw r;t.memoizedState=o,t.baseState=s,t.baseQueue=u,i.lastRenderedState=o}return n===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function Mj(t){var e=Qs(),r=e.queue;if(r===null)throw Error(Vt(311));r.lastRenderedReducer=t;var i=r.dispatch,n=r.pending,o=e.memoizedState;if(n!==null){r.pending=null;var s=n=n.next;do o=t(o,s.action),s=s.next;while(s!==n);ph(o,e.memoizedState)||(ba=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,i]}function Jae(t,e,r){var i=Gi,n=Qs(),o=yn;if(o){if(r===void 0)throw Error(Vt(407));r=r()}else r=e();var s=!ph((Ao||n).memoizedState,r);if(s&&(n.memoizedState=r,ba=!0),n=n.queue,pW(rle.bind(null,i,n,t),[t]),n.getSnapshot!==e||s||ya!==null&&ya.memoizedState.tag&1){if(i.flags|=2048,Jw(9,{destroy:void 0},tle.bind(null,i,n,r,e),null),To===null)throw Error(Vt(349));o||($m&127)!==0||ele(i,e,r)}return r}function ele(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Gi.updateQueue,e===null?(e=pO(),Gi.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function tle(t,e,r,i){e.value=r,e.getSnapshot=i,ile(e)&&nle(t)}function rle(t,e,r){return r(function(){ile(e)&&nle(t)})}function ile(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ph(t,r)}catch{return!0}}function nle(t){var e=s1(t,2);e!==null&&mu(e,t,2)}function g$(t){var e=Oc();if(typeof t=="function"){var r=t;if(t=r(),t1){sy(!0);try{r()}finally{sy(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wm,lastRenderedState:t},e}function ole(t,e,r,i){return t.baseState=r,fW(t,Ao,typeof i=="function"?i:Wm)}function N8e(t,e,r,i,n){if(AO(t))throw Error(Vt(485));if(t=e.action,t!==null){var o={payload:n,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(s){o.listeners.push(s)}};_i.T!==null?r(!0):o.isTransition=!1,i(o),r=e.pending,r===null?(o.next=e.pending=o,sle(e,o)):(o.next=r.next,e.pending=r.next=o)}}function sle(t,e){var r=e.action,i=e.payload,n=t.state;if(e.isTransition){var o=_i.T,s={};_i.T=s;try{var a=r(n,i),u=_i.S;u!==null&&u(s,a),ose(t,e,a)}catch(p){A$(t,e,p)}finally{o!==null&&s.types!==null&&(o.types=s.types),_i.T=o}}else try{o=r(n,i),ose(t,e,o)}catch(p){A$(t,e,p)}}function ose(t,e,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(i){sse(t,e,i)},function(i){return A$(t,e,i)}):sse(t,e,r)}function sse(t,e,r){e.status="fulfilled",e.value=r,ale(e),t.state=r,e=t.pending,e!==null&&(r=e.next,r===e?t.pending=null:(r=r.next,e.next=r,sle(t,r)))}function A$(t,e,r){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=r,ale(e),e=e.next;while(e!==i)}t.action=null}function ale(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function lle(t,e){return e}function ase(t,e){if(yn){var r=To.formState;if(r!==null){e:{var i=Gi;if(yn){if(qo){t:{for(var n=qo,o=fd;n.nodeType!==8;){if(!o){n=null;break t}if(n=md(n.nextSibling),n===null){n=null;break t}}o=n.data,n=o==="F!"||o==="F"?n:null}if(n){qo=md(n.nextSibling),i=n.data==="F!";break e}}by(i)}i=!1}i&&(e=r[0])}}return r=Oc(),r.memoizedState=r.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lle,lastRenderedState:e},r.queue=i,r=Sle.bind(null,Gi,i),i.dispatch=r,i=g$(!1),o=yW.bind(null,Gi,!1,i.queue),i=Oc(),n={state:e,dispatch:null,action:t,pending:null},i.queue=n,r=N8e.bind(null,Gi,n,o,r),n.dispatch=r,i.memoizedState=t,[e,r,!1]}function lse(t){var e=Qs();return cle(e,Ao,t)}function cle(t,e,r){if(e=fW(t,e,lle)[0],t=w8(Wm)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=iE(e)}catch(s){throw s===l2?fO:s}else i=e;e=Qs();var n=e.queue,o=n.dispatch;return r!==e.memoizedState&&(Gi.flags|=2048,Jw(9,{destroy:void 0},z8e.bind(null,n,r),null)),[i,o,t]}function z8e(t,e){t.action=e}function cse(t){var e=Qs(),r=Ao;if(r!==null)return cle(e,r,t);Qs(),e=e.memoizedState,r=Qs();var i=r.queue.dispatch;return r.memoizedState=t,[e,i,!1]}function Jw(t,e,r,i){return t={tag:t,create:r,deps:i,inst:e,next:null},e=Gi.updateQueue,e===null&&(e=pO(),Gi.updateQueue=e),r=e.lastEffect,r===null?e.lastEffect=t.next=t:(i=r.next,r.next=t,t.next=i,e.lastEffect=t),t}function ule(){return Qs().memoizedState}function S8(t,e,r,i){var n=Oc();Gi.flags|=t,n.memoizedState=Jw(1|e,{destroy:void 0},r,i===void 0?null:i)}function gO(t,e,r,i){var n=Qs();i=i===void 0?null:i;var o=n.memoizedState.inst;Ao!==null&&i!==null&&aW(i,Ao.memoizedState.deps)?n.memoizedState=Jw(e,o,r,i):(Gi.flags|=t,n.memoizedState=Jw(1|e,o,r,i))}function use(t,e){S8(8390656,8,t,e)}function pW(t,e){gO(2048,8,t,e)}function U8e(t){Gi.flags|=4;var e=Gi.updateQueue;if(e===null)e=pO(),Gi.updateQueue=e,e.events=[t];else{var r=e.events;r===null?e.events=[t]:r.push(t)}}function hle(t){var e=Qs().memoizedState;return U8e({ref:e,nextImpl:t}),function(){if((Fn&2)!==0)throw Error(Vt(440));return e.impl.apply(void 0,arguments)}}function dle(t,e){return gO(4,2,t,e)}function fle(t,e){return gO(4,4,t,e)}function ple(t,e){if(typeof e=="function"){t=t();var r=e(t);return function(){typeof r=="function"?r():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mle(t,e,r){r=r!=null?r.concat([t]):null,gO(4,4,ple.bind(null,e,t),r)}function mW(){}function gle(t,e){var r=Qs();e=e===void 0?null:e;var i=r.memoizedState;return e!==null&&aW(e,i[1])?i[0]:(r.memoizedState=[t,e],t)}function Ale(t,e){var r=Qs();e=e===void 0?null:e;var i=r.memoizedState;if(e!==null&&aW(e,i[1]))return i[0];if(i=t(),t1){sy(!0);try{t()}finally{sy(!1)}}return r.memoizedState=[i,e],i}function gW(t,e,r){return r===void 0||($m&1073741824)!==0&&(fn&261930)===0?t.memoizedState=e:(t.memoizedState=r,t=oce(),Gi.lanes|=t,wy|=t,r)}function yle(t,e,r,i){return ph(r,e)?r:Qw.current!==null?(t=gW(t,r,i),ph(t,e)||(ba=!0),t):($m&42)===0||($m&1073741824)!==0&&(fn&261930)===0?(ba=!0,t.memoizedState=r):(t=oce(),Gi.lanes|=t,wy|=t,e)}function _le(t,e,r,i,n){var o=Nn.p;Nn.p=o!==0&&8>o?o:8;var s=_i.T,a={};_i.T=a,yW(t,!1,e,r);try{var u=n(),p=_i.S;if(p!==null&&p(a,u),u!==null&&typeof u=="object"&&typeof u.then=="function"){var m=L8e(u,i);IM(t,e,m,fh(t))}else IM(t,e,i,fh(t))}catch(x){IM(t,e,{then:function(){},status:"rejected",reason:x},fh())}finally{Nn.p=o,s!==null&&a.types!==null&&(s.types=a.types),_i.T=s}}function V8e(){}function y$(t,e,r,i){if(t.tag!==5)throw Error(Vt(476));var n=vle(t).queue;_le(t,n,e,qv,r===null?V8e:function(){return ble(t),r(i)})}function vle(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:qv,baseState:qv,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wm,lastRenderedState:qv},next:null};var r={};return e.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wm,lastRenderedState:r},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function ble(t){var e=vle(t);e.next===null&&(e=t.alternate.memoizedState),IM(t,e.next.queue,{},fh())}function AW(){return Cl(qM)}function xle(){return Qs().memoizedState}function wle(){return Qs().memoizedState}function j8e(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var r=fh();t=fy(r);var i=py(e,t,r);i!==null&&(mu(i,e,r),EM(i,e,r)),e={cache:rW()},t.payload=e;return}e=e.return}}function $8e(t,e,r){var i=fh();r={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},AO(t)?Tle(e,r):(r=Q$(t,e,r,i),r!==null&&(mu(r,t,i),Mle(r,e,i)))}function Sle(t,e,r){var i=fh();IM(t,e,r,i)}function IM(t,e,r,i){var n={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(AO(t))Tle(e,n);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,r);if(n.hasEagerState=!0,n.eagerState=a,ph(a,s))return dO(t,e,n,0),To===null&&hO(),!1}catch{}finally{}if(r=Q$(t,e,n,i),r!==null)return mu(r,t,i),Mle(r,e,i),!0}return!1}function yW(t,e,r,i){if(i={lane:2,revertLane:EW(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},AO(t)){if(e)throw Error(Vt(479))}else e=Q$(t,r,i,2),e!==null&&mu(e,t,2)}function AO(t){var e=t.alternate;return t===Gi||e!==null&&e===Gi}function Tle(t,e){Hw=W8=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Mle(t,e,r){if((r&4194048)!==0){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,hae(t,r)}}var WM={readContext:Cl,use:mO,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useLayoutEffect:Ps,useInsertionEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useSyncExternalStore:Ps,useId:Ps,useHostTransitionStatus:Ps,useFormState:Ps,useActionState:Ps,useOptimistic:Ps,useMemoCache:Ps,useCacheRefresh:Ps};WM.useEffectEvent=Ps;var Ele={readContext:Cl,use:mO,useCallback:function(t,e){return Oc().memoizedState=[t,e===void 0?null:e],t},useContext:Cl,useEffect:use,useImperativeHandle:function(t,e,r){r=r!=null?r.concat([t]):null,S8(4194308,4,ple.bind(null,e,t),r)},useLayoutEffect:function(t,e){return S8(4194308,4,t,e)},useInsertionEffect:function(t,e){S8(4,2,t,e)},useMemo:function(t,e){var r=Oc();e=e===void 0?null:e;var i=t();if(t1){sy(!0);try{t()}finally{sy(!1)}}return r.memoizedState=[i,e],i},useReducer:function(t,e,r){var i=Oc();if(r!==void 0){var n=r(e);if(t1){sy(!0);try{r(e)}finally{sy(!1)}}}else n=e;return i.memoizedState=i.baseState=n,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},i.queue=t,t=t.dispatch=$8e.bind(null,Gi,t),[i.memoizedState,t]},useRef:function(t){var e=Oc();return t={current:t},e.memoizedState=t},useState:function(t){t=g$(t);var e=t.queue,r=Sle.bind(null,Gi,e);return e.dispatch=r,[t.memoizedState,r]},useDebugValue:mW,useDeferredValue:function(t,e){var r=Oc();return gW(r,t,e)},useTransition:function(){var t=g$(!1);return t=_le.bind(null,Gi,t.queue,!0,!1),Oc().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,r){var i=Gi,n=Oc();if(yn){if(r===void 0)throw Error(Vt(407));r=r()}else{if(r=e(),To===null)throw Error(Vt(349));(fn&127)!==0||ele(i,e,r)}n.memoizedState=r;var o={value:r,getSnapshot:e};return n.queue=o,use(rle.bind(null,i,o,t),[t]),i.flags|=2048,Jw(9,{destroy:void 0},tle.bind(null,i,o,r,e),null),r},useId:function(){var t=Oc(),e=To.identifierPrefix;if(yn){var r=Yp,i=qp;r=(i&~(1<<32-dh(i)-1)).toString(32)+r,e="_"+e+"R_"+r,r=G8++,0<r&&(e+="H"+r.toString(32)),e+="_"}else r=B8e++,e="_"+e+"r_"+r.toString(32)+"_";return t.memoizedState=e},useHostTransitionStatus:AW,useFormState:ase,useActionState:ase,useOptimistic:function(t){var e=Oc();e.memoizedState=e.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=r,e=yW.bind(null,Gi,!0,r),r.dispatch=e,[t,e]},useMemoCache:dW,useCacheRefresh:function(){return Oc().memoizedState=j8e.bind(null,Gi)},useEffectEvent:function(t){var e=Oc(),r={impl:t};return e.memoizedState=r,function(){if((Fn&2)!==0)throw Error(Vt(440));return r.impl.apply(void 0,arguments)}}},_W={readContext:Cl,use:mO,useCallback:gle,useContext:Cl,useEffect:pW,useImperativeHandle:mle,useInsertionEffect:dle,useLayoutEffect:fle,useMemo:Ale,useReducer:w8,useRef:ule,useState:function(){return w8(Wm)},useDebugValue:mW,useDeferredValue:function(t,e){var r=Qs();return yle(r,Ao.memoizedState,t,e)},useTransition:function(){var t=w8(Wm)[0],e=Qs().memoizedState;return[typeof t=="boolean"?t:iE(t),e]},useSyncExternalStore:Jae,useId:xle,useHostTransitionStatus:AW,useFormState:lse,useActionState:lse,useOptimistic:function(t,e){var r=Qs();return ole(r,Ao,t,e)},useMemoCache:dW,useCacheRefresh:wle};_W.useEffectEvent=hle;var Cle={readContext:Cl,use:mO,useCallback:gle,useContext:Cl,useEffect:pW,useImperativeHandle:mle,useInsertionEffect:dle,useLayoutEffect:fle,useMemo:Ale,useReducer:Mj,useRef:ule,useState:function(){return Mj(Wm)},useDebugValue:mW,useDeferredValue:function(t,e){var r=Qs();return Ao===null?gW(r,t,e):yle(r,Ao.memoizedState,t,e)},useTransition:function(){var t=Mj(Wm)[0],e=Qs().memoizedState;return[typeof t=="boolean"?t:iE(t),e]},useSyncExternalStore:Jae,useId:xle,useHostTransitionStatus:AW,useFormState:cse,useActionState:cse,useOptimistic:function(t,e){var r=Qs();return Ao!==null?ole(r,Ao,t,e):(r.baseState=t,[t,r.queue.dispatch])},useMemoCache:dW,useCacheRefresh:wle};Cle.useEffectEvent=hle;function Ej(t,e,r,i){e=t.memoizedState,r=r(i,e),r=r==null?e:Yo({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var _$={enqueueSetState:function(t,e,r){t=t._reactInternals;var i=fh(),n=fy(i);n.payload=e,r!=null&&(n.callback=r),e=py(t,n,i),e!==null&&(mu(e,t,i),EM(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var i=fh(),n=fy(i);n.tag=1,n.payload=e,r!=null&&(n.callback=r),e=py(t,n,i),e!==null&&(mu(e,t,i),EM(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=fh(),i=fy(r);i.tag=2,e!=null&&(i.callback=e),e=py(t,i,r),e!==null&&(mu(e,t,r),EM(e,t,r))}};function hse(t,e,r,i,n,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,o,s):e.prototype&&e.prototype.isPureReactComponent?!zM(r,i)||!zM(n,o):!0}function dse(t,e,r,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,i),e.state!==t&&_$.enqueueReplaceState(e,e.state,null)}function r1(t,e){var r=e;if("ref"in e){r={};for(var i in e)i!=="ref"&&(r[i]=e[i])}if(t=t.defaultProps){r===e&&(r=Yo({},r));for(var n in t)r[n]===void 0&&(r[n]=t[n])}return r}function Ple(t){F8(t)}function Ile(t){console.error(t)}function kle(t){F8(t)}function H8(t,e){try{var r=t.onUncaughtError;r(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function fse(t,e,r){try{var i=t.onCaughtError;i(r.value,{componentStack:r.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function v$(t,e,r){return r=fy(r),r.tag=3,r.payload={element:null},r.callback=function(){H8(t,e)},r}function Rle(t){return t=fy(t),t.tag=3,t}function Ole(t,e,r,i){var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var o=i.value;t.payload=function(){return n(o)},t.callback=function(){fse(e,r,i)}}var s=r.stateNode;s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){fse(e,r,i),typeof n!="function"&&(my===null?my=new Set([this]):my.add(this));var a=i.stack;this.componentDidCatch(i.value,{componentStack:a!==null?a:""})})}function W8e(t,e,r,i,n){if(r.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=r.alternate,e!==null&&a2(e,r,n,!0),r=mh.current,r!==null){switch(r.tag){case 31:case 13:return pd===null?K8():r.alternate===null&&Is===0&&(Is=3),r.flags&=-257,r.flags|=65536,r.lanes=n,i===V8?r.flags|=16384:(e=r.updateQueue,e===null?r.updateQueue=new Set([i]):e.add(i),Nj(t,i,n)),!1;case 22:return r.flags|=65536,i===V8?r.flags|=16384:(e=r.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},r.updateQueue=e):(r=e.retryQueue,r===null?e.retryQueue=new Set([i]):r.add(i)),Nj(t,i,n)),!1}throw Error(Vt(435,r.tag))}return Nj(t,i,n),K8(),!1}if(yn)return e=mh.current,e!==null?((e.flags&65536)===0&&(e.flags|=256),e.flags|=65536,e.lanes=n,i!==a$&&(t=Error(Vt(422),{cause:i}),VM(dd(t,r)))):(i!==a$&&(e=Error(Vt(423),{cause:i}),VM(dd(e,r))),t=t.current.alternate,t.flags|=65536,n&=-n,t.lanes|=n,i=dd(i,r),n=v$(t.stateNode,i,n),Tj(t,n),Is!==4&&(Is=2)),!1;var o=Error(Vt(520),{cause:i});if(o=dd(o,r),OM===null?OM=[o]:OM.push(o),Is!==4&&(Is=2),e===null)return!0;i=dd(i,r),r=e;do{switch(r.tag){case 3:return r.flags|=65536,t=n&-n,r.lanes|=t,t=v$(r.stateNode,i,t),Tj(r,t),!1;case 1:if(e=r.type,o=r.stateNode,(r.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||o!==null&&typeof o.componentDidCatch=="function"&&(my===null||!my.has(o))))return r.flags|=65536,n&=-n,r.lanes|=n,n=Rle(n),Ole(n,t,r,i),Tj(r,n),!1}r=r.return}while(r!==null);return!1}var vW=Error(Vt(461)),ba=!1;function Tl(t,e,r,i){e.child=t===null?qae(e,null,r,i):e1(e,t.child,r,i)}function pse(t,e,r,i,n){r=r.render;var o=e.ref;if("ref"in i){var s={};for(var a in i)a!=="ref"&&(s[a]=i[a])}else s=i;return Jv(e),i=lW(t,e,r,s,o,n),a=cW(),t!==null&&!ba?(uW(t,e,n),Gm(t,e,n)):(yn&&a&&eW(e),e.flags|=1,Tl(t,e,i,n),e.child)}function mse(t,e,r,i,n){if(t===null){var o=r.type;return typeof o=="function"&&!J$(o)&&o.defaultProps===void 0&&r.compare===null?(e.tag=15,e.type=o,Dle(t,e,o,i,n)):(t=b8(r.type,null,i,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!bW(t,n)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:zM,r(s,i)&&t.ref===e.ref)return Gm(t,e,n)}return e.flags|=1,t=zm(o,i),t.ref=e.ref,t.return=e,e.child=t}function Dle(t,e,r,i,n){if(t!==null){var o=t.memoizedProps;if(zM(o,i)&&t.ref===e.ref)if(ba=!1,e.pendingProps=i=o,bW(t,n))(t.flags&131072)!==0&&(ba=!0);else return e.lanes=t.lanes,Gm(t,e,n)}return b$(t,e,r,i,n)}function Lle(t,e,r,i){var n=i.children,o=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((e.flags&128)!==0){if(o=o!==null?o.baseLanes|r:r,t!==null){for(i=e.child=t.child,n=0;i!==null;)n=n|i.lanes|i.childLanes,i=i.sibling;i=n&~o}else i=0,e.child=null;return gse(t,e,o,r,i)}if((r&536870912)!==0)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&x8(e,o!==null?o.cachePool:null),o!==null?nse(e,o):p$(),Zae(e);else return i=e.lanes=536870912,gse(t,e,o!==null?o.baseLanes|r:r,r,i)}else o!==null?(x8(e,o.cachePool),nse(e,o),ny(e),e.memoizedState=null):(t!==null&&x8(e,null),p$(),ny(e));return Tl(t,e,n,r),e.child}function bM(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function gse(t,e,r,i,n){var o=iW();return o=o===null?null:{parent:va._currentValue,pool:o},e.memoizedState={baseLanes:r,cachePool:o},t!==null&&x8(e,null),p$(),Zae(e),t!==null&&a2(t,e,i,!0),e.childLanes=n,null}function T8(t,e){return e=q8({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function Ase(t,e,r){return e1(e,t.child,null,r),t=T8(e,e.pendingProps),t.flags|=2,ah(e),e.memoizedState=null,t}function G8e(t,e,r){var i=e.pendingProps,n=(e.flags&128)!==0;if(e.flags&=-129,t===null){if(yn){if(i.mode==="hidden")return t=T8(e,i),e.lanes=536870912,bM(null,t);if(m$(e),(t=qo)?(t=Ece(t,fd),t=t!==null&&t.data==="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:vy!==null?{id:qp,overflow:Yp}:null,retryLane:536870912,hydrationErrors:null},r=Uae(t),r.return=e,e.child=r,El=e,qo=null)):t=null,t===null)throw by(e);return e.lanes=536870912,null}return T8(e,i)}var o=t.memoizedState;if(o!==null){var s=o.dehydrated;if(m$(e),n)if(e.flags&256)e.flags&=-257,e=Ase(t,e,r);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(Vt(558));else if(ba||a2(t,e,r,!1),n=(r&t.childLanes)!==0,ba||n){if(i=To,i!==null&&(s=dae(i,r),s!==0&&s!==o.retryLane))throw o.retryLane=s,s1(t,s),mu(i,t,s),vW;K8(),e=Ase(t,e,r)}else t=o.treeContext,qo=md(s.nextSibling),El=e,yn=!0,dy=null,fd=!1,t!==null&&jae(e,t),e=T8(e,i),e.flags|=4096;return e}return t=zm(t.child,{mode:i.mode,children:i.children}),t.ref=e.ref,e.child=t,t.return=e,t}function M8(t,e){var r=e.ref;if(r===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(Vt(284));(t===null||t.ref!==r)&&(e.flags|=4194816)}}function b$(t,e,r,i,n){return Jv(e),r=lW(t,e,r,i,void 0,n),i=cW(),t!==null&&!ba?(uW(t,e,n),Gm(t,e,n)):(yn&&i&&eW(e),e.flags|=1,Tl(t,e,r,n),e.child)}function yse(t,e,r,i,n,o){return Jv(e),e.updateQueue=null,r=Qae(e,i,r,n),Kae(t),i=cW(),t!==null&&!ba?(uW(t,e,o),Gm(t,e,o)):(yn&&i&&eW(e),e.flags|=1,Tl(t,e,r,o),e.child)}function _se(t,e,r,i,n){if(Jv(e),e.stateNode===null){var o=Fw,s=r.contextType;typeof s=="object"&&s!==null&&(o=Cl(s)),o=new r(i,o),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=_$,e.stateNode=o,o._reactInternals=e,o=e.stateNode,o.props=i,o.state=e.memoizedState,o.refs={},oW(e),s=r.contextType,o.context=typeof s=="object"&&s!==null?Cl(s):Fw,o.state=e.memoizedState,s=r.getDerivedStateFromProps,typeof s=="function"&&(Ej(e,r,s,i),o.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(s=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),s!==o.state&&_$.enqueueReplaceState(o,o.state,null),PM(e,i,o,n),CM(),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(t===null){o=e.stateNode;var a=e.memoizedProps,u=r1(r,a);o.props=u;var p=o.context,m=r.contextType;s=Fw,typeof m=="object"&&m!==null&&(s=Cl(m));var x=r.getDerivedStateFromProps;m=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function",a=e.pendingProps!==a,m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a||p!==s)&&dse(e,o,i,s),ty=!1;var M=e.memoizedState;o.state=M,PM(e,i,o,n),CM(),p=e.memoizedState,a||M!==p||ty?(typeof x=="function"&&(Ej(e,r,x,i),p=e.memoizedState),(u=ty||hse(e,r,u,i,M,p,s))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=s,i=u):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,d$(t,e),s=e.memoizedProps,m=r1(r,s),o.props=m,x=e.pendingProps,M=o.context,p=r.contextType,u=Fw,typeof p=="object"&&p!==null&&(u=Cl(p)),a=r.getDerivedStateFromProps,(p=typeof a=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==x||M!==u)&&dse(e,o,i,u),ty=!1,M=e.memoizedState,o.state=M,PM(e,i,o,n),CM();var k=e.memoizedState;s!==x||M!==k||ty||t!==null&&t.dependencies!==null&&U8(t.dependencies)?(typeof a=="function"&&(Ej(e,r,a,i),k=e.memoizedState),(m=ty||hse(e,r,m,i,M,k,u)||t!==null&&t.dependencies!==null&&U8(t.dependencies))?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,k,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,k,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&M===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&M===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=k),o.props=i,o.state=k,o.context=u,i=m):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&M===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&M===t.memoizedState||(e.flags|=1024),i=!1)}return o=i,M8(t,e),i=(e.flags&128)!==0,o||i?(o=e.stateNode,r=i&&typeof r.getDerivedStateFromError!="function"?null:o.render(),e.flags|=1,t!==null&&i?(e.child=e1(e,t.child,null,n),e.child=e1(e,null,r,n)):Tl(t,e,r,n),e.memoizedState=o.state,t=e.child):t=Gm(t,e,n),t}function vse(t,e,r,i){return Qv(),e.flags|=256,Tl(t,e,r,i),e.child}var Cj={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pj(t){return{baseLanes:t,cachePool:Wae()}}function Ij(t,e,r){return t=t!==null?t.childLanes&~r:0,e&&(t|=ch),t}function Ble(t,e,r){var i=e.pendingProps,n=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=t!==null&&t.memoizedState===null?!1:(Ks.current&2)!==0),s&&(n=!0,e.flags&=-129),s=(e.flags&32)!==0,e.flags&=-33,t===null){if(yn){if(n?iy(e):ny(e),(t=qo)?(t=Ece(t,fd),t=t!==null&&t.data!=="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:vy!==null?{id:qp,overflow:Yp}:null,retryLane:536870912,hydrationErrors:null},r=Uae(t),r.return=e,e.child=r,El=e,qo=null)):t=null,t===null)throw by(e);return L$(t)?e.lanes=32:e.lanes=536870912,null}var a=i.children;return i=i.fallback,n?(ny(e),n=e.mode,a=q8({mode:"hidden",children:a},n),i=Yv(i,n,r,null),a.return=e,i.return=e,a.sibling=i,e.child=a,i=e.child,i.memoizedState=Pj(r),i.childLanes=Ij(t,s,r),e.memoizedState=Cj,bM(null,i)):(iy(e),x$(e,a))}var u=t.memoizedState;if(u!==null&&(a=u.dehydrated,a!==null)){if(o)e.flags&256?(iy(e),e.flags&=-257,e=kj(t,e,r)):e.memoizedState!==null?(ny(e),e.child=t.child,e.flags|=128,e=null):(ny(e),a=i.fallback,n=e.mode,i=q8({mode:"visible",children:i.children},n),a=Yv(a,n,r,null),a.flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,e1(e,t.child,null,r),i=e.child,i.memoizedState=Pj(r),i.childLanes=Ij(t,s,r),e.memoizedState=Cj,e=bM(null,i));else if(iy(e),L$(a)){if(s=a.nextSibling&&a.nextSibling.dataset,s)var p=s.dgst;s=p,i=Error(Vt(419)),i.stack="",i.digest=s,VM({value:i,source:null,stack:null}),e=kj(t,e,r)}else if(ba||a2(t,e,r,!1),s=(r&t.childLanes)!==0,ba||s){if(s=To,s!==null&&(i=dae(s,r),i!==0&&i!==u.retryLane))throw u.retryLane=i,s1(t,i),mu(s,t,i),vW;D$(a)||K8(),e=kj(t,e,r)}else D$(a)?(e.flags|=192,e.child=t.child,e=null):(t=u.treeContext,qo=md(a.nextSibling),El=e,yn=!0,dy=null,fd=!1,t!==null&&jae(e,t),e=x$(e,i.children),e.flags|=4096);return e}return n?(ny(e),a=i.fallback,n=e.mode,u=t.child,p=u.sibling,i=zm(u,{mode:"hidden",children:i.children}),i.subtreeFlags=u.subtreeFlags&65011712,p!==null?a=zm(p,a):(a=Yv(a,n,r,null),a.flags|=2),a.return=e,i.return=e,i.sibling=a,e.child=i,bM(null,i),i=e.child,a=t.child.memoizedState,a===null?a=Pj(r):(n=a.cachePool,n!==null?(u=va._currentValue,n=n.parent!==u?{parent:u,pool:u}:n):n=Wae(),a={baseLanes:a.baseLanes|r,cachePool:n}),i.memoizedState=a,i.childLanes=Ij(t,s,r),e.memoizedState=Cj,bM(t.child,i)):(iy(e),r=t.child,t=r.sibling,r=zm(r,{mode:"visible",children:i.children}),r.return=e,r.sibling=null,t!==null&&(s=e.deletions,s===null?(e.deletions=[t],e.flags|=16):s.push(t)),e.child=r,e.memoizedState=null,r)}function x$(t,e){return e=q8({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function q8(t,e){return t=lh(22,t,null,e),t.lanes=0,t}function kj(t,e,r){return e1(e,t.child,null,r),t=x$(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bse(t,e,r){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),c$(t.return,e,r)}function Rj(t,e,r,i,n,o){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n,treeForkCount:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=r,s.tailMode=n,s.treeForkCount=o)}function Fle(t,e,r){var i=e.pendingProps,n=i.revealOrder,o=i.tail;i=i.children;var s=Ks.current,a=(s&2)!==0;if(a?(s=s&1|2,e.flags|=128):s&=1,Lo(Ks,s),Tl(t,e,i,r),i=yn?UM:0,!a&&t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bse(t,r,e);else if(t.tag===19)bse(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(n){case"forwards":for(r=e.child,n=null;r!==null;)t=r.alternate,t!==null&&$8(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=e.child,e.child=null):(n=r.sibling,r.sibling=null),Rj(e,!1,n,r,o,i);break;case"backwards":case"unstable_legacy-backwards":for(r=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&$8(t)===null){e.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}Rj(e,!0,r,null,o,i);break;case"together":Rj(e,!1,null,null,void 0,i);break;default:e.memoizedState=null}return e.child}function Gm(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),wy|=e.lanes,(r&e.childLanes)===0)if(t!==null){if(a2(t,e,r,!1),(r&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(Vt(153));if(e.child!==null){for(t=e.child,r=zm(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=zm(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function bW(t,e){return(t.lanes&e)!==0?!0:(t=t.dependencies,!!(t!==null&&U8(t)))}function H8e(t,e,r){switch(e.tag){case 3:O8(e,e.stateNode.containerInfo),ry(e,va,t.memoizedState.cache),Qv();break;case 27:case 5:Zj(e);break;case 4:O8(e,e.stateNode.containerInfo);break;case 10:ry(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,m$(e),null;break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(iy(e),e.flags|=128,null):(r&e.child.childLanes)!==0?Ble(t,e,r):(iy(e),t=Gm(t,e,r),t!==null?t.sibling:null);iy(e);break;case 19:var n=(t.flags&128)!==0;if(i=(r&e.childLanes)!==0,i||(a2(t,e,r,!1),i=(r&e.childLanes)!==0),n){if(i)return Fle(t,e,r);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Lo(Ks,Ks.current),i)break;return null;case 22:return e.lanes=0,Lle(t,e,r,e.pendingProps);case 24:ry(e,va,t.memoizedState.cache)}return Gm(t,e,r)}function Nle(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps)ba=!0;else{if(!bW(t,r)&&(e.flags&128)===0)return ba=!1,H8e(t,e,r);ba=(t.flags&131072)!==0}else ba=!1,yn&&(e.flags&1048576)!==0&&Vae(e,UM,e.index);switch(e.lanes=0,e.tag){case 16:e:{var i=e.pendingProps;if(t=Gv(e.elementType),e.type=t,typeof t=="function")J$(t)?(i=r1(t,i),e.tag=1,e=_se(null,e,t,i,r)):(e.tag=0,e=b$(null,e,t,i,r));else{if(t!=null){var n=t.$$typeof;if(n===z$){e.tag=11,e=pse(null,e,t,i,r);break e}else if(n===U$){e.tag=14,e=mse(null,e,t,i,r);break e}}throw e=Yj(t)||t,Error(Vt(306,e,""))}}return e;case 0:return b$(t,e,e.type,e.pendingProps,r);case 1:return i=e.type,n=r1(i,e.pendingProps),_se(t,e,i,n,r);case 3:e:{if(O8(e,e.stateNode.containerInfo),t===null)throw Error(Vt(387));i=e.pendingProps;var o=e.memoizedState;n=o.element,d$(t,e),PM(e,i,null,r);var s=e.memoizedState;if(i=s.cache,ry(e,va,i),i!==o.cache&&u$(e,[va],r,!0),CM(),i=s.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:s.cache},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){e=vse(t,e,i,r);break e}else if(i!==n){n=dd(Error(Vt(424)),e),VM(n),e=vse(t,e,i,r);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(qo=md(t.firstChild),El=e,yn=!0,dy=null,fd=!0,r=qae(e,null,i,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(Qv(),i===n){e=Gm(t,e,r);break e}Tl(t,e,i,r)}e=e.child}return e;case 26:return M8(t,e),t===null?(r=$se(e.type,null,e.pendingProps,null))?e.memoizedState=r:yn||(r=e.type,t=e.pendingProps,i=tO(hy.current).createElement(r),i[Ml]=e,i[gu]=t,Pl(i,r,t),sl(i),e.stateNode=i):e.memoizedState=$se(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return Zj(e),t===null&&yn&&(i=e.stateNode=Cce(e.type,e.pendingProps,hy.current),El=e,fd=!0,n=qo,Ty(e.type)?(B$=n,qo=md(i.firstChild)):qo=n),Tl(t,e,e.pendingProps.children,r),M8(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&yn&&((n=i=qo)&&(i=vOe(i,e.type,e.pendingProps,fd),i!==null?(e.stateNode=i,El=e,qo=md(i.firstChild),fd=!1,n=!0):n=!1),n||by(e)),Zj(e),n=e.type,o=e.pendingProps,s=t!==null?t.memoizedProps:null,i=o.children,R$(n,o)?i=null:s!==null&&R$(n,s)&&(e.flags|=32),e.memoizedState!==null&&(n=lW(t,e,F8e,null,null,r),qM._currentValue=n),M8(t,e),Tl(t,e,i,r),e.child;case 6:return t===null&&yn&&((t=r=qo)&&(r=bOe(r,e.pendingProps,fd),r!==null?(e.stateNode=r,El=e,qo=null,t=!0):t=!1),t||by(e)),null;case 13:return Ble(t,e,r);case 4:return O8(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=e1(e,null,i,r):Tl(t,e,i,r),e.child;case 11:return pse(t,e,e.type,e.pendingProps,r);case 7:return Tl(t,e,e.pendingProps,r),e.child;case 8:return Tl(t,e,e.pendingProps.children,r),e.child;case 12:return Tl(t,e,e.pendingProps.children,r),e.child;case 10:return i=e.pendingProps,ry(e,e.type,i.value),Tl(t,e,i.children,r),e.child;case 9:return n=e.type._context,i=e.pendingProps.children,Jv(e),n=Cl(n),i=i(n),e.flags|=1,Tl(t,e,i,r),e.child;case 14:return mse(t,e,e.type,e.pendingProps,r);case 15:return Dle(t,e,e.type,e.pendingProps,r);case 19:return Fle(t,e,r);case 31:return G8e(t,e,r);case 22:return Lle(t,e,r,e.pendingProps);case 24:return Jv(e),i=Cl(va),t===null?(n=iW(),n===null&&(n=To,o=rW(),n.pooledCache=o,o.refCount++,o!==null&&(n.pooledCacheLanes|=r),n=o),e.memoizedState={parent:i,cache:n},oW(e),ry(e,va,n)):((t.lanes&r)!==0&&(d$(t,e),PM(e,null,null,r),CM()),n=t.memoizedState,o=e.memoizedState,n.parent!==i?(n={parent:i,cache:i},e.memoizedState=n,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=n),ry(e,va,i)):(i=o.cache,ry(e,va,i),i!==n.cache&&u$(e,[va],r,!0))),Tl(t,e,e.pendingProps.children,r),e.child;case 29:throw e.pendingProps}throw Error(Vt(156,e.tag))}function Im(t){t.flags|=4}function Oj(t,e,r,i,n){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(n&335544128)===n)if(t.stateNode.complete)t.flags|=8192;else if(lce())t.flags|=8192;else throw Zv=V8,nW}else t.flags&=-16777217}function xse(t,e){if(e.type!=="stylesheet"||(e.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!kce(e))if(lce())t.flags|=8192;else throw Zv=V8,nW}function u8(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?cae():536870912,t.lanes|=e,e2|=e)}function pM(t,e){if(!yn)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ho(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,i=0;if(e)for(var n=t.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&65011712,i|=n.flags&65011712,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=i,t.childLanes=r,e}function q8e(t,e,r){var i=e.pendingProps;switch(tW(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ho(e),null;case 1:return Ho(e),null;case 3:return r=e.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),Um(va),Yw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Tw(e)?Im(e):t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Sj())),Ho(e),null;case 26:var n=e.type,o=e.memoizedState;return t===null?(Im(e),o!==null?(Ho(e),xse(e,o)):(Ho(e),Oj(e,n,null,i,r))):o?o!==t.memoizedState?(Im(e),Ho(e),xse(e,o)):(Ho(e),e.flags&=-16777217):(t=t.memoizedProps,t!==i&&Im(e),Ho(e),Oj(e,n,t,i,r)),null;case 27:if(D8(e),r=hy.current,n=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Im(e);else{if(!i){if(e.stateNode===null)throw Error(Vt(166));return Ho(e),null}t=Zp.current,Tw(e)?Koe(e,t):(t=Cce(n,i,r),e.stateNode=t,Im(e))}return Ho(e),null;case 5:if(D8(e),n=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==i&&Im(e);else{if(!i){if(e.stateNode===null)throw Error(Vt(166));return Ho(e),null}if(o=Zp.current,Tw(e))Koe(e,o);else{var s=tO(hy.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":o=s.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof i.is=="string"?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?o.multiple=!0:i.size&&(o.size=i.size);break;default:o=typeof i.is=="string"?s.createElement(n,{is:i.is}):s.createElement(n)}}o[Ml]=e,o[gu]=i;e:for(s=e.child;s!==null;){if(s.tag===5||s.tag===6)o.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}e.stateNode=o;e:switch(Pl(o,n,i),n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Im(e)}}return Ho(e),Oj(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,r),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==i&&Im(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Vt(166));if(t=hy.current,Tw(e)){if(t=e.stateNode,r=e.memoizedProps,i=null,n=El,n!==null)switch(n.tag){case 27:case 5:i=n.memoizedProps}t[Ml]=e,t=!!(t.nodeValue===r||i!==null&&i.suppressHydrationWarning===!0||Sce(t.nodeValue,r)),t||by(e,!0)}else t=tO(t).createTextNode(i),t[Ml]=e,e.stateNode=t}return Ho(e),null;case 31:if(r=e.memoizedState,t===null||t.memoizedState!==null){if(i=Tw(e),r!==null){if(t===null){if(!i)throw Error(Vt(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Vt(557));t[Ml]=e}else Qv(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Ho(e),t=!1}else r=Sj(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),t=!0;if(!t)return e.flags&256?(ah(e),e):(ah(e),null);if((e.flags&128)!==0)throw Error(Vt(558))}return Ho(e),null;case 13:if(i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(n=Tw(e),i!==null&&i.dehydrated!==null){if(t===null){if(!n)throw Error(Vt(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Vt(317));n[Ml]=e}else Qv(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;Ho(e),n=!1}else n=Sj(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),n=!0;if(!n)return e.flags&256?(ah(e),e):(ah(e),null)}return ah(e),(e.flags&128)!==0?(e.lanes=r,e):(r=i!==null,t=t!==null&&t.memoizedState!==null,r&&(i=e.child,n=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(n=i.alternate.memoizedState.cachePool.pool),o=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),o!==n&&(i.flags|=2048)),r!==t&&r&&(e.child.flags|=8192),u8(e,e.updateQueue),Ho(e),null);case 4:return Yw(),t===null&&CW(e.stateNode.containerInfo),Ho(e),null;case 10:return Um(e.type),Ho(e),null;case 19:if(al(Ks),i=e.memoizedState,i===null)return Ho(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)pM(i,!1);else{if(Is!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(o=$8(t),o!==null){for(e.flags|=128,pM(i,!1),t=o.updateQueue,e.updateQueue=t,u8(e,t),e.subtreeFlags=0,t=r,r=e.child;r!==null;)zae(r,t),r=r.sibling;return Lo(Ks,Ks.current&1|2),yn&&Dm(e,i.treeForkCount),e.child}t=t.sibling}i.tail!==null&&uh()>X8&&(e.flags|=128,n=!0,pM(i,!1),e.lanes=4194304)}else{if(!n)if(t=$8(o),t!==null){if(e.flags|=128,n=!0,t=t.updateQueue,e.updateQueue=t,u8(e,t),pM(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!yn)return Ho(e),null}else 2*uh()-i.renderingStartTime>X8&&r!==536870912&&(e.flags|=128,n=!0,pM(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=uh(),t.sibling=null,r=Ks.current,Lo(Ks,n?r&1|2:r&1),yn&&Dm(e,i.treeForkCount),t):(Ho(e),null);case 22:case 23:return ah(e),sW(),i=e.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?(r&536870912)!==0&&(e.flags&128)===0&&(Ho(e),e.subtreeFlags&6&&(e.flags|=8192)):Ho(e),r=e.updateQueue,r!==null&&u8(e,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==r&&(e.flags|=2048),t!==null&&al(Xv),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),e.memoizedState.cache!==r&&(e.flags|=2048),Um(va),Ho(e),null;case 25:return null;case 30:return null}throw Error(Vt(156,e.tag))}function Y8e(t,e){switch(tW(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Um(va),Yw(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return D8(e),null;case 31:if(e.memoizedState!==null){if(ah(e),e.alternate===null)throw Error(Vt(340));Qv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(ah(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Vt(340));Qv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return al(Ks),null;case 4:return Yw(),null;case 10:return Um(e.type),null;case 22:case 23:return ah(e),sW(),t!==null&&al(Xv),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return Um(va),null;case 25:return null;default:return null}}function zle(t,e){switch(tW(e),e.tag){case 3:Um(va),Yw();break;case 26:case 27:case 5:D8(e);break;case 4:Yw();break;case 31:e.memoizedState!==null&&ah(e);break;case 13:ah(e);break;case 19:al(Ks);break;case 10:Um(e.type);break;case 22:case 23:ah(e),sW(),t!==null&&al(Xv);break;case 24:Um(va)}}function nE(t,e){try{var r=e.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var n=i.next;r=n;do{if((r.tag&t)===t){i=void 0;var o=r.create,s=r.inst;i=o(),s.destroy=i}r=r.next}while(r!==n)}}catch(a){no(e,e.return,a)}}function xy(t,e,r){try{var i=e.updateQueue,n=i!==null?i.lastEffect:null;if(n!==null){var o=n.next;i=o;do{if((i.tag&t)===t){var s=i.inst,a=s.destroy;if(a!==void 0){s.destroy=void 0,n=e;var u=r,p=a;try{p()}catch(m){no(n,u,m)}}}i=i.next}while(i!==o)}}catch(m){no(e,e.return,m)}}function Ule(t){var e=t.updateQueue;if(e!==null){var r=t.stateNode;try{Xae(e,r)}catch(i){no(t,t.return,i)}}}function Vle(t,e,r){r.props=r1(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(i){no(t,e,i)}}function kM(t,e){try{var r=t.ref;if(r!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof r=="function"?t.refCleanup=r(i):r.current=i}}catch(n){no(t,e,n)}}function Xp(t,e){var r=t.ref,i=t.refCleanup;if(r!==null)if(typeof i=="function")try{i()}catch(n){no(t,e,n)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(n){no(t,e,n)}else r.current=null}function jle(t){var e=t.type,r=t.memoizedProps,i=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":r.autoFocus&&i.focus();break e;case"img":r.src?i.src=r.src:r.srcSet&&(i.srcset=r.srcSet)}}catch(n){no(t,t.return,n)}}function Dj(t,e,r){try{var i=t.stateNode;pOe(i,t.type,r,e),i[gu]=e}catch(n){no(t,t.return,n)}}function $le(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ty(t.type)||t.tag===4}function Lj(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$le(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ty(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function w$(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(t,e):(e=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,e.appendChild(t),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Fm));else if(i!==4&&(i===27&&Ty(t.type)&&(r=t.stateNode,e=null),t=t.child,t!==null))for(w$(t,e,r),t=t.sibling;t!==null;)w$(t,e,r),t=t.sibling}function Y8(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(i!==4&&(i===27&&Ty(t.type)&&(r=t.stateNode),t=t.child,t!==null))for(Y8(t,e,r),t=t.sibling;t!==null;)Y8(t,e,r),t=t.sibling}function Wle(t){var e=t.stateNode,r=t.memoizedProps;try{for(var i=t.type,n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Pl(e,i,r),e[Ml]=t,e[gu]=r}catch(o){no(t,t.return,o)}}var Lm=!1,_a=!1,Bj=!1,wse=typeof WeakSet=="function"?WeakSet:Set,ol=null;function X8e(t,e){if(t=t.containerInfo,I$=oO,t=kae(t),Z$(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,a=-1,u=-1,p=0,m=0,x=t,M=null;t:for(;;){for(var k;x!==r||n!==0&&x.nodeType!==3||(a=s+n),x!==o||i!==0&&x.nodeType!==3||(u=s+i),x.nodeType===3&&(s+=x.nodeValue.length),(k=x.firstChild)!==null;)M=x,x=k;for(;;){if(x===t)break t;if(M===r&&++p===n&&(a=s),M===o&&++m===i&&(u=s),(k=x.nextSibling)!==null)break;x=M,M=x.parentNode}x=k}r=a===-1||u===-1?null:{start:a,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(k$={focusedElem:t,selectionRange:r},oO=!1,ol=e;ol!==null;)if(e=ol,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ol=t;else for(;ol!==null;){switch(e=ol,o=e.alternate,t=e.flags,e.tag){case 0:if((t&4)!==0&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(r=0;r<t.length;r++)n=t[r],n.ref.impl=n.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&o!==null){t=void 0,r=e,n=o.memoizedProps,o=o.memoizedState,i=r.stateNode;try{var F=r1(r.type,n);t=i.getSnapshotBeforeUpdate(F,o),i.__reactInternalSnapshotBeforeUpdate=t}catch(j){no(r,r.return,j)}}break;case 3:if((t&1024)!==0){if(t=e.stateNode.containerInfo,r=t.nodeType,r===9)O$(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":O$(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(Vt(163))}if(t=e.sibling,t!==null){t.return=e.return,ol=t;break}ol=e.return}}function Gle(t,e,r){var i=r.flags;switch(r.tag){case 0:case 11:case 15:Rm(t,r),i&4&&nE(5,r);break;case 1:if(Rm(t,r),i&4)if(t=r.stateNode,e===null)try{t.componentDidMount()}catch(s){no(r,r.return,s)}else{var n=r1(r.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(n,e,t.__reactInternalSnapshotBeforeUpdate)}catch(s){no(r,r.return,s)}}i&64&&Ule(r),i&512&&kM(r,r.return);break;case 3:if(Rm(t,r),i&64&&(t=r.updateQueue,t!==null)){if(e=null,r.child!==null)switch(r.child.tag){case 27:case 5:e=r.child.stateNode;break;case 1:e=r.child.stateNode}try{Xae(t,e)}catch(s){no(r,r.return,s)}}break;case 27:e===null&&i&4&&Wle(r);case 26:case 5:Rm(t,r),e===null&&i&4&&jle(r),i&512&&kM(r,r.return);break;case 12:Rm(t,r);break;case 31:Rm(t,r),i&4&&Yle(t,r);break;case 13:Rm(t,r),i&4&&Xle(t,r),i&64&&(t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(r=nOe.bind(null,r),xOe(t,r))));break;case 22:if(i=r.memoizedState!==null||Lm,!i){e=e!==null&&e.memoizedState!==null||_a,n=Lm;var o=_a;Lm=i,(_a=e)&&!o?Om(t,r,(r.subtreeFlags&8772)!==0):Rm(t,r),Lm=n,_a=o}break;case 30:break;default:Rm(t,r)}}function Hle(t){var e=t.alternate;e!==null&&(t.alternate=null,Hle(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&W$(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var is=null,fu=!1;function km(t,e,r){for(r=r.child;r!==null;)qle(t,e,r),r=r.sibling}function qle(t,e,r){if(hh&&typeof hh.onCommitFiberUnmount=="function")try{hh.onCommitFiberUnmount(KM,r)}catch{}switch(r.tag){case 26:_a||Xp(r,e),km(t,e,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:_a||Xp(r,e);var i=is,n=fu;Ty(r.type)&&(is=r.stateNode,fu=!1),km(t,e,r),LM(r.stateNode),is=i,fu=n;break;case 5:_a||Xp(r,e);case 6:if(i=is,n=fu,is=null,km(t,e,r),is=i,fu=n,is!==null)if(fu)try{(is.nodeType===9?is.body:is.nodeName==="HTML"?is.ownerDocument.body:is).removeChild(r.stateNode)}catch(o){no(r,e,o)}else try{is.removeChild(r.stateNode)}catch(o){no(r,e,o)}break;case 18:is!==null&&(fu?(t=is,Nse(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,r.stateNode),n2(t)):Nse(is,r.stateNode));break;case 4:i=is,n=fu,is=r.stateNode.containerInfo,fu=!0,km(t,e,r),is=i,fu=n;break;case 0:case 11:case 14:case 15:xy(2,r,e),_a||xy(4,r,e),km(t,e,r);break;case 1:_a||(Xp(r,e),i=r.stateNode,typeof i.componentWillUnmount=="function"&&Vle(r,e,i)),km(t,e,r);break;case 21:km(t,e,r);break;case 22:_a=(i=_a)||r.memoizedState!==null,km(t,e,r),_a=i;break;default:km(t,e,r)}}function Yle(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{n2(t)}catch(r){no(e,e.return,r)}}}function Xle(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{n2(t)}catch(r){no(e,e.return,r)}}function Z8e(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new wse),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new wse),e;default:throw Error(Vt(435,t.tag))}}function h8(t,e){var r=Z8e(t);e.forEach(function(i){if(!r.has(i)){r.add(i);var n=oOe.bind(null,t,i);i.then(n,n)}})}function hu(t,e){var r=e.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i],o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 27:if(Ty(a.type)){is=a.stateNode,fu=!1;break e}break;case 5:is=a.stateNode,fu=!1;break e;case 3:case 4:is=a.stateNode.containerInfo,fu=!0;break e}a=a.return}if(is===null)throw Error(Vt(160));qle(o,s,n),is=null,fu=!1,o=n.alternate,o!==null&&(o.return=null),n.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)Zle(e,t),e=e.sibling}var Cf=null;function Zle(t,e){var r=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:hu(e,t),du(t),i&4&&(xy(3,t,t.return),nE(3,t),xy(5,t,t.return));break;case 1:hu(e,t),du(t),i&512&&(_a||r===null||Xp(r,r.return)),i&64&&Lm&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?i:r.concat(i))));break;case 26:var n=Cf;if(hu(e,t),du(t),i&512&&(_a||r===null||Xp(r,r.return)),i&4){var o=r!==null?r.memoizedState:null;if(i=t.memoizedState,r===null)if(i===null)if(t.stateNode===null){e:{i=t.type,r=t.memoizedProps,n=n.ownerDocument||n;t:switch(i){case"title":o=n.getElementsByTagName("title")[0],(!o||o[eE]||o[Ml]||o.namespaceURI==="http://www.w3.org/2000/svg"||o.hasAttribute("itemprop"))&&(o=n.createElement(i),n.head.insertBefore(o,n.querySelector("head > title"))),Pl(o,i,r),o[Ml]=t,sl(o),i=o;break e;case"link":var s=Gse("link","href",n).get(i+(r.href||""));if(s){for(var a=0;a<s.length;a++)if(o=s[a],o.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&o.getAttribute("rel")===(r.rel==null?null:r.rel)&&o.getAttribute("title")===(r.title==null?null:r.title)&&o.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){s.splice(a,1);break t}}o=n.createElement(i),Pl(o,i,r),n.head.appendChild(o);break;case"meta":if(s=Gse("meta","content",n).get(i+(r.content||""))){for(a=0;a<s.length;a++)if(o=s[a],o.getAttribute("content")===(r.content==null?null:""+r.content)&&o.getAttribute("name")===(r.name==null?null:r.name)&&o.getAttribute("property")===(r.property==null?null:r.property)&&o.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&o.getAttribute("charset")===(r.charSet==null?null:r.charSet)){s.splice(a,1);break t}}o=n.createElement(i),Pl(o,i,r),n.head.appendChild(o);break;default:throw Error(Vt(468,i))}o[Ml]=t,sl(o),i=o}t.stateNode=i}else Hse(n,t.type,t.stateNode);else t.stateNode=Wse(n,i,t.memoizedProps);else o!==i?(o===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):o.count--,i===null?Hse(n,t.type,t.stateNode):Wse(n,i,t.memoizedProps)):i===null&&t.stateNode!==null&&Dj(t,t.memoizedProps,r.memoizedProps)}break;case 27:hu(e,t),du(t),i&512&&(_a||r===null||Xp(r,r.return)),r!==null&&i&4&&Dj(t,t.memoizedProps,r.memoizedProps);break;case 5:if(hu(e,t),du(t),i&512&&(_a||r===null||Xp(r,r.return)),t.flags&32){n=t.stateNode;try{Zw(n,"")}catch(F){no(t,t.return,F)}}i&4&&t.stateNode!=null&&(n=t.memoizedProps,Dj(t,n,r!==null?r.memoizedProps:n)),i&1024&&(Bj=!0);break;case 6:if(hu(e,t),du(t),i&4){if(t.stateNode===null)throw Error(Vt(162));i=t.memoizedProps,r=t.stateNode;try{r.nodeValue=i}catch(F){no(t,t.return,F)}}break;case 3:if(P8=null,n=Cf,Cf=rO(e.containerInfo),hu(e,t),Cf=n,du(t),i&4&&r!==null&&r.memoizedState.isDehydrated)try{n2(e.containerInfo)}catch(F){no(t,t.return,F)}Bj&&(Bj=!1,Kle(t));break;case 4:i=Cf,Cf=rO(t.stateNode.containerInfo),hu(e,t),du(t),Cf=i;break;case 12:hu(e,t),du(t);break;case 31:hu(e,t),du(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,h8(t,i)));break;case 13:hu(e,t),du(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(yO=uh()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,h8(t,i)));break;case 22:n=t.memoizedState!==null;var u=r!==null&&r.memoizedState!==null,p=Lm,m=_a;if(Lm=p||n,_a=m||u,hu(e,t),_a=m,Lm=p,du(t),i&8192)e:for(e=t.stateNode,e._visibility=n?e._visibility&-2:e._visibility|1,n&&(r===null||u||Lm||_a||Hv(t)),r=null,e=t;;){if(e.tag===5||e.tag===26){if(r===null){u=r=e;try{if(o=u.stateNode,n)s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none";else{a=u.stateNode;var x=u.memoizedProps.style,M=x!=null&&x.hasOwnProperty("display")?x.display:null;a.style.display=M==null||typeof M=="boolean"?"":(""+M).trim()}}catch(F){no(u,u.return,F)}}}else if(e.tag===6){if(r===null){u=e;try{u.stateNode.nodeValue=n?"":u.memoizedProps}catch(F){no(u,u.return,F)}}}else if(e.tag===18){if(r===null){u=e;try{var k=u.stateNode;n?zse(k,!0):zse(u.stateNode,!1)}catch(F){no(u,u.return,F)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;r===e&&(r=null),e=e.return}r===e&&(r=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=t.updateQueue,i!==null&&(r=i.retryQueue,r!==null&&(i.retryQueue=null,h8(t,r))));break;case 19:hu(e,t),du(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,h8(t,i)));break;case 30:break;case 21:break;default:hu(e,t),du(t)}}function du(t){var e=t.flags;if(e&2){try{for(var r,i=t.return;i!==null;){if($le(i)){r=i;break}i=i.return}if(r==null)throw Error(Vt(160));switch(r.tag){case 27:var n=r.stateNode,o=Lj(t);Y8(t,o,n);break;case 5:var s=r.stateNode;r.flags&32&&(Zw(s,""),r.flags&=-33);var a=Lj(t);Y8(t,a,s);break;case 3:case 4:var u=r.stateNode.containerInfo,p=Lj(t);w$(t,p,u);break;default:throw Error(Vt(161))}}catch(m){no(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Kle(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;Kle(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function Rm(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Gle(t,e.alternate,e),e=e.sibling}function Hv(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:xy(4,e,e.return),Hv(e);break;case 1:Xp(e,e.return);var r=e.stateNode;typeof r.componentWillUnmount=="function"&&Vle(e,e.return,r),Hv(e);break;case 27:LM(e.stateNode);case 26:case 5:Xp(e,e.return),Hv(e);break;case 22:e.memoizedState===null&&Hv(e);break;case 30:Hv(e);break;default:Hv(e)}t=t.sibling}}function Om(t,e,r){for(r=r&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,n=t,o=e,s=o.flags;switch(o.tag){case 0:case 11:case 15:Om(n,o,r),nE(4,o);break;case 1:if(Om(n,o,r),i=o,n=i.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(p){no(i,i.return,p)}if(i=o,n=i.updateQueue,n!==null){var a=i.stateNode;try{var u=n.shared.hiddenCallbacks;if(u!==null)for(n.shared.hiddenCallbacks=null,n=0;n<u.length;n++)Yae(u[n],a)}catch(p){no(i,i.return,p)}}r&&s&64&&Ule(o),kM(o,o.return);break;case 27:Wle(o);case 26:case 5:Om(n,o,r),r&&i===null&&s&4&&jle(o),kM(o,o.return);break;case 12:Om(n,o,r);break;case 31:Om(n,o,r),r&&s&4&&Yle(n,o);break;case 13:Om(n,o,r),r&&s&4&&Xle(n,o);break;case 22:o.memoizedState===null&&Om(n,o,r),kM(o,o.return);break;case 30:break;default:Om(n,o,r)}e=e.sibling}}function xW(t,e){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&rE(r))}function wW(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&rE(t))}function Ef(t,e,r,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Qle(t,e,r,i),e=e.sibling}function Qle(t,e,r,i){var n=e.flags;switch(e.tag){case 0:case 11:case 15:Ef(t,e,r,i),n&2048&&nE(9,e);break;case 1:Ef(t,e,r,i);break;case 3:Ef(t,e,r,i),n&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&rE(t)));break;case 12:if(n&2048){Ef(t,e,r,i),t=e.stateNode;try{var o=e.memoizedProps,s=o.id,a=o.onPostCommit;typeof a=="function"&&a(s,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(u){no(e,e.return,u)}}else Ef(t,e,r,i);break;case 31:Ef(t,e,r,i);break;case 13:Ef(t,e,r,i);break;case 23:break;case 22:o=e.stateNode,s=e.alternate,e.memoizedState!==null?o._visibility&2?Ef(t,e,r,i):RM(t,e):o._visibility&2?Ef(t,e,r,i):(o._visibility|=2,Ew(t,e,r,i,(e.subtreeFlags&10256)!==0||!1)),n&2048&&xW(s,e);break;case 24:Ef(t,e,r,i),n&2048&&wW(e.alternate,e);break;default:Ef(t,e,r,i)}}function Ew(t,e,r,i,n){for(n=n&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var o=t,s=e,a=r,u=i,p=s.flags;switch(s.tag){case 0:case 11:case 15:Ew(o,s,a,u,n),nE(8,s);break;case 23:break;case 22:var m=s.stateNode;s.memoizedState!==null?m._visibility&2?Ew(o,s,a,u,n):RM(o,s):(m._visibility|=2,Ew(o,s,a,u,n)),n&&p&2048&&xW(s.alternate,s);break;case 24:Ew(o,s,a,u,n),n&&p&2048&&wW(s.alternate,s);break;default:Ew(o,s,a,u,n)}e=e.sibling}}function RM(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var r=t,i=e,n=i.flags;switch(i.tag){case 22:RM(r,i),n&2048&&xW(i.alternate,i);break;case 24:RM(r,i),n&2048&&wW(i.alternate,i);break;default:RM(r,i)}e=e.sibling}}var xM=8192;function Mw(t,e,r){if(t.subtreeFlags&xM)for(t=t.child;t!==null;)Jle(t,e,r),t=t.sibling}function Jle(t,e,r){switch(t.tag){case 26:Mw(t,e,r),t.flags&xM&&t.memoizedState!==null&&DOe(r,Cf,t.memoizedState,t.memoizedProps);break;case 5:Mw(t,e,r);break;case 3:case 4:var i=Cf;Cf=rO(t.stateNode.containerInfo),Mw(t,e,r),Cf=i;break;case 22:t.memoizedState===null&&(i=t.alternate,i!==null&&i.memoizedState!==null?(i=xM,xM=16777216,Mw(t,e,r),xM=i):Mw(t,e,r));break;default:Mw(t,e,r)}}function ece(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function mM(t){var e=t.deletions;if((t.flags&16)!==0){if(e!==null)for(var r=0;r<e.length;r++){var i=e[r];ol=i,rce(i,t)}ece(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)tce(t),t=t.sibling}function tce(t){switch(t.tag){case 0:case 11:case 15:mM(t),t.flags&2048&&xy(9,t,t.return);break;case 3:mM(t);break;case 12:mM(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,E8(t)):mM(t);break;default:mM(t)}}function E8(t){var e=t.deletions;if((t.flags&16)!==0){if(e!==null)for(var r=0;r<e.length;r++){var i=e[r];ol=i,rce(i,t)}ece(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:xy(8,e,e.return),E8(e);break;case 22:r=e.stateNode,r._visibility&2&&(r._visibility&=-3,E8(e));break;default:E8(e)}t=t.sibling}}function rce(t,e){for(;ol!==null;){var r=ol;switch(r.tag){case 0:case 11:case 15:xy(8,r,e);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var i=r.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:rE(r.memoizedState.cache)}if(i=r.child,i!==null)i.return=r,ol=i;else e:for(r=t;ol!==null;){i=ol;var n=i.sibling,o=i.return;if(Hle(i),i===r){ol=null;break e}if(n!==null){n.return=o,ol=n;break e}ol=o}}}var K8e={getCacheForType:function(t){var e=Cl(va),r=e.data.get(t);return r===void 0&&(r=t(),e.data.set(t,r)),r},cacheSignal:function(){return Cl(va).controller.signal}},Q8e=typeof WeakMap=="function"?WeakMap:Map,Fn=0,To=null,ln=null,fn=0,io=0,sh=null,ly=!1,c2=!1,SW=!1,Hm=0,Is=0,wy=0,Kv=0,TW=0,ch=0,e2=0,OM=null,pu=null,S$=!1,yO=0,ice=0,X8=1/0,Z8=null,my=null,Va=0,gy=null,t2=null,Vm=0,T$=0,M$=null,nce=null,DM=0,E$=null;function fh(){return(Fn&2)!==0&&fn!==0?fn&-fn:_i.T!==null?EW():fae()}function oce(){if(ch===0)if((fn&536870912)===0||yn){var t=t8;t8<<=1,(t8&3932160)===0&&(t8=262144),ch=t}else ch=536870912;return t=mh.current,t!==null&&(t.flags|=32),ch}function mu(t,e,r){(t===To&&(io===2||io===9)||t.cancelPendingCommit!==null)&&(r2(t,0),cy(t,fn,ch,!1)),JM(t,r),((Fn&2)===0||t!==To)&&(t===To&&((Fn&2)===0&&(Kv|=r),Is===4&&cy(t,fn,ch,!1)),Qp(t))}function sce(t,e,r){if((Fn&6)!==0)throw Error(Vt(327));var i=!r&&(e&127)===0&&(e&t.expiredLanes)===0||QM(t,e),n=i?tOe(t,e):Fj(t,e,!0),o=i;do{if(n===0){c2&&!i&&cy(t,e,0,!1);break}else{if(r=t.current.alternate,o&&!J8e(r)){n=Fj(t,e,!1),o=!1;continue}if(n===2){if(o=e,t.errorRecoveryDisabledLanes&o)var s=0;else s=t.pendingLanes&-536870913,s=s!==0?s:s&536870912?536870912:0;if(s!==0){e=s;e:{var a=t;n=OM;var u=a.current.memoizedState.isDehydrated;if(u&&(r2(a,s).flags|=256),s=Fj(a,s,!1),s!==2){if(SW&&!u){a.errorRecoveryDisabledLanes|=o,Kv|=o,n=4;break e}o=pu,pu=n,o!==null&&(pu===null?pu=o:pu.push.apply(pu,o))}n=s}if(o=!1,n!==2)continue}}if(n===1){r2(t,0),cy(t,e,0,!0);break}e:{switch(i=t,o=n,o){case 0:case 1:throw Error(Vt(345));case 4:if((e&4194048)!==e)break;case 6:cy(i,e,ch,!ly);break e;case 2:pu=null;break;case 3:case 5:break;default:throw Error(Vt(329))}if((e&62914560)===e&&(n=yO+300-uh(),10<n)){if(cy(i,e,ch,!ly),aO(i,0,!0)!==0)break e;Vm=e,i.timeoutHandle=Mce(Sse.bind(null,i,r,pu,Z8,S$,e,ch,Kv,e2,ly,o,"Throttled",-0,0),n);break e}Sse(i,r,pu,Z8,S$,e,ch,Kv,e2,ly,o,null,-0,0)}}break}while(!0);Qp(t)}function Sse(t,e,r,i,n,o,s,a,u,p,m,x,M,k){if(t.timeoutHandle=-1,x=e.subtreeFlags,x&8192||(x&16785408)===16785408){x={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Fm},Jle(e,o,x);var F=(o&62914560)===o?yO-uh():(o&4194048)===o?ice-uh():0;if(F=LOe(x,F),F!==null){Vm=o,t.cancelPendingCommit=F(Mse.bind(null,t,e,o,r,i,n,s,a,u,m,x,null,M,k)),cy(t,o,s,!p);return}}Mse(t,e,o,r,i,n,s,a,u)}function J8e(t){for(var e=t;;){var r=e.tag;if((r===0||r===11||r===15)&&e.flags&16384&&(r=e.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var i=0;i<r.length;i++){var n=r[i],o=n.getSnapshot;n=n.value;try{if(!ph(o(),n))return!1}catch{return!1}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function cy(t,e,r,i){e&=~TW,e&=~Kv,t.suspendedLanes|=e,t.pingedLanes&=~e,i&&(t.warmLanes|=e),i=t.expirationTimes;for(var n=e;0<n;){var o=31-dh(n),s=1<<o;i[o]=-1,n&=~s}r!==0&&uae(t,r,e)}function _O(){return(Fn&6)===0?(oE(0,!1),!1):!0}function MW(){if(ln!==null){if(io===0)var t=ln.return;else t=ln,Nm=a1=null,hW(t),Gw=null,jM=0,t=ln;for(;t!==null;)zle(t.alternate,t),t=t.return;ln=null}}function r2(t,e){var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,AOe(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),Vm=0,MW(),To=t,ln=r=zm(t.current,null),fn=e,io=0,sh=null,ly=!1,c2=QM(t,e),SW=!1,e2=ch=TW=Kv=wy=Is=0,pu=OM=null,S$=!1,(e&8)!==0&&(e|=e&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=e;0<i;){var n=31-dh(i),o=1<<n;e|=t[n],i&=~o}return Hm=e,hO(),r}function ace(t,e){Gi=null,_i.H=WM,e===l2||e===fO?(e=rse(),io=3):e===nW?(e=rse(),io=4):io=e===vW?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,sh=e,ln===null&&(Is=1,H8(t,dd(e,t.current)))}function lce(){var t=mh.current;return t===null?!0:(fn&4194048)===fn?pd===null:(fn&62914560)===fn||(fn&536870912)!==0?t===pd:!1}function cce(){var t=_i.H;return _i.H=WM,t===null?WM:t}function uce(){var t=_i.A;return _i.A=K8e,t}function K8(){Is=4,ly||(fn&4194048)!==fn&&mh.current!==null||(c2=!0),(wy&134217727)===0&&(Kv&134217727)===0||To===null||cy(To,fn,ch,!1)}function Fj(t,e,r){var i=Fn;Fn|=2;var n=cce(),o=uce();(To!==t||fn!==e)&&(Z8=null,r2(t,e)),e=!1;var s=Is;e:do try{if(io!==0&&ln!==null){var a=ln,u=sh;switch(io){case 8:MW(),s=6;break e;case 3:case 2:case 9:case 6:mh.current===null&&(e=!0);var p=io;if(io=0,sh=null,Uw(t,a,u,p),r&&c2){s=0;break e}break;default:p=io,io=0,sh=null,Uw(t,a,u,p)}}eOe(),s=Is;break}catch(m){ace(t,m)}while(!0);return e&&t.shellSuspendCounter++,Nm=a1=null,Fn=i,_i.H=n,_i.A=o,ln===null&&(To=null,fn=0,hO()),s}function eOe(){for(;ln!==null;)hce(ln)}function tOe(t,e){var r=Fn;Fn|=2;var i=cce(),n=uce();To!==t||fn!==e?(Z8=null,X8=uh()+500,r2(t,e)):c2=QM(t,e);e:do try{if(io!==0&&ln!==null){e=ln;var o=sh;t:switch(io){case 1:io=0,sh=null,Uw(t,e,o,1);break;case 2:case 9:if(tse(o)){io=0,sh=null,Tse(e);break}e=function(){io!==2&&io!==9||To!==t||(io=7),Qp(t)},o.then(e,e);break e;case 3:io=7;break e;case 4:io=5;break e;case 7:tse(o)?(io=0,sh=null,Tse(e)):(io=0,sh=null,Uw(t,e,o,7));break;case 5:var s=null;switch(ln.tag){case 26:s=ln.memoizedState;case 5:case 27:var a=ln;if(s?kce(s):a.stateNode.complete){io=0,sh=null;var u=a.sibling;if(u!==null)ln=u;else{var p=a.return;p!==null?(ln=p,vO(p)):ln=null}break t}}io=0,sh=null,Uw(t,e,o,5);break;case 6:io=0,sh=null,Uw(t,e,o,6);break;case 8:MW(),Is=6;break e;default:throw Error(Vt(462))}}rOe();break}catch(m){ace(t,m)}while(!0);return Nm=a1=null,_i.H=i,_i.A=n,Fn=r,ln!==null?0:(To=null,fn=0,hO(),Is)}function rOe(){for(;ln!==null&&!TRe();)hce(ln)}function hce(t){var e=Nle(t.alternate,t,Hm);t.memoizedProps=t.pendingProps,e===null?vO(t):ln=e}function Tse(t){var e=t,r=e.alternate;switch(e.tag){case 15:case 0:e=yse(r,e,e.pendingProps,e.type,void 0,fn);break;case 11:e=yse(r,e,e.pendingProps,e.type.render,e.ref,fn);break;case 5:hW(e);default:zle(r,e),e=ln=zae(e,Hm),e=Nle(r,e,Hm)}t.memoizedProps=t.pendingProps,e===null?vO(t):ln=e}function Uw(t,e,r,i){Nm=a1=null,hW(e),Gw=null,jM=0;var n=e.return;try{if(W8e(t,n,e,r,fn)){Is=1,H8(t,dd(r,t.current)),ln=null;return}}catch(o){if(n!==null)throw ln=n,o;Is=1,H8(t,dd(r,t.current)),ln=null;return}e.flags&32768?(yn||i===1?t=!0:c2||(fn&536870912)!==0?t=!1:(ly=t=!0,(i===2||i===9||i===3||i===6)&&(i=mh.current,i!==null&&i.tag===13&&(i.flags|=16384))),dce(e,t)):vO(e)}function vO(t){var e=t;do{if((e.flags&32768)!==0){dce(e,ly);return}t=e.return;var r=q8e(e.alternate,e,Hm);if(r!==null){ln=r;return}if(e=e.sibling,e!==null){ln=e;return}ln=e=t}while(e!==null);Is===0&&(Is=5)}function dce(t,e){do{var r=Y8e(t.alternate,t);if(r!==null){r.flags&=32767,ln=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!e&&(t=t.sibling,t!==null)){ln=t;return}ln=t=r}while(t!==null);Is=6,ln=null}function Mse(t,e,r,i,n,o,s,a,u){t.cancelPendingCommit=null;do bO();while(Va!==0);if((Fn&6)!==0)throw Error(Vt(327));if(e!==null){if(e===t.current)throw Error(Vt(177));if(o=e.lanes|e.childLanes,o|=K$,LRe(t,r,o,s,a,u),t===To&&(ln=To=null,fn=0),t2=e,gy=t,Vm=r,T$=o,M$=n,nce=i,(e.subtreeFlags&10256)!==0||(e.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,sOe(L8,function(){return Ace(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(e.flags&13878)!==0,(e.subtreeFlags&13878)!==0||i){i=_i.T,_i.T=null,n=Nn.p,Nn.p=2,s=Fn,Fn|=4;try{X8e(t,e,r)}finally{Fn=s,Nn.p=n,_i.T=i}}Va=1,fce(),pce(),mce()}}function fce(){if(Va===1){Va=0;var t=gy,e=t2,r=(e.flags&13878)!==0;if((e.subtreeFlags&13878)!==0||r){r=_i.T,_i.T=null;var i=Nn.p;Nn.p=2;var n=Fn;Fn|=4;try{Zle(e,t);var o=k$,s=kae(t.containerInfo),a=o.focusedElem,u=o.selectionRange;if(s!==a&&a&&a.ownerDocument&&Iae(a.ownerDocument.documentElement,a)){if(u!==null&&Z$(a)){var p=u.start,m=u.end;if(m===void 0&&(m=p),"selectionStart"in a)a.selectionStart=p,a.selectionEnd=Math.min(m,a.value.length);else{var x=a.ownerDocument||document,M=x&&x.defaultView||window;if(M.getSelection){var k=M.getSelection(),F=a.textContent.length,j=Math.min(u.start,F),H=u.end===void 0?j:Math.min(u.end,F);!k.extend&&j>H&&(s=H,H=j,j=s);var W=Yoe(a,j),Z=Yoe(a,H);if(W&&Z&&(k.rangeCount!==1||k.anchorNode!==W.node||k.anchorOffset!==W.offset||k.focusNode!==Z.node||k.focusOffset!==Z.offset)){var Y=x.createRange();Y.setStart(W.node,W.offset),k.removeAllRanges(),j>H?(k.addRange(Y),k.extend(Z.node,Z.offset)):(Y.setEnd(Z.node,Z.offset),k.addRange(Y))}}}}for(x=[],k=a;k=k.parentNode;)k.nodeType===1&&x.push({element:k,left:k.scrollLeft,top:k.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<x.length;a++){var ee=x[a];ee.element.scrollLeft=ee.left,ee.element.scrollTop=ee.top}}oO=!!I$,k$=I$=null}finally{Fn=n,Nn.p=i,_i.T=r}}t.current=e,Va=2}}function pce(){if(Va===2){Va=0;var t=gy,e=t2,r=(e.flags&8772)!==0;if((e.subtreeFlags&8772)!==0||r){r=_i.T,_i.T=null;var i=Nn.p;Nn.p=2;var n=Fn;Fn|=4;try{Gle(t,e.alternate,e)}finally{Fn=n,Nn.p=i,_i.T=r}}Va=3}}function mce(){if(Va===4||Va===3){Va=0,MRe();var t=gy,e=t2,r=Vm,i=nce;(e.subtreeFlags&10256)!==0||(e.flags&10256)!==0?Va=5:(Va=0,t2=gy=null,gce(t,t.pendingLanes));var n=t.pendingLanes;if(n===0&&(my=null),$$(r),e=e.stateNode,hh&&typeof hh.onCommitFiberRoot=="function")try{hh.onCommitFiberRoot(KM,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=_i.T,n=Nn.p,Nn.p=2,_i.T=null;try{for(var o=t.onRecoverableError,s=0;s<i.length;s++){var a=i[s];o(a.value,{componentStack:a.stack})}}finally{_i.T=e,Nn.p=n}}(Vm&3)!==0&&bO(),Qp(t),n=t.pendingLanes,(r&261930)!==0&&(n&42)!==0?t===E$?DM++:(DM=0,E$=t):DM=0,oE(0,!1)}}function gce(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,rE(e)))}function bO(){return fce(),pce(),mce(),Ace()}function Ace(){if(Va!==5)return!1;var t=gy,e=T$;T$=0;var r=$$(Vm),i=_i.T,n=Nn.p;try{Nn.p=32>r?32:r,_i.T=null,r=M$,M$=null;var o=gy,s=Vm;if(Va=0,t2=gy=null,Vm=0,(Fn&6)!==0)throw Error(Vt(331));var a=Fn;if(Fn|=4,tce(o.current),Qle(o,o.current,s,r),Fn=a,oE(0,!1),hh&&typeof hh.onPostCommitFiberRoot=="function")try{hh.onPostCommitFiberRoot(KM,o)}catch{}return!0}finally{Nn.p=n,_i.T=i,gce(t,e)}}function Ese(t,e,r){e=dd(r,e),e=v$(t.stateNode,e,2),t=py(t,e,2),t!==null&&(JM(t,2),Qp(t))}function no(t,e,r){if(t.tag===3)Ese(t,t,r);else for(;e!==null;){if(e.tag===3){Ese(e,t,r);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(my===null||!my.has(i))){t=dd(r,t),r=Rle(2),i=py(e,r,2),i!==null&&(Ole(r,i,e,t),JM(i,2),Qp(i));break}}e=e.return}}function Nj(t,e,r){var i=t.pingCache;if(i===null){i=t.pingCache=new Q8e;var n=new Set;i.set(e,n)}else n=i.get(e),n===void 0&&(n=new Set,i.set(e,n));n.has(r)||(SW=!0,n.add(r),t=iOe.bind(null,t,e,r),e.then(t,t))}function iOe(t,e,r){var i=t.pingCache;i!==null&&i.delete(e),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,To===t&&(fn&r)===r&&(Is===4||Is===3&&(fn&62914560)===fn&&300>uh()-yO?(Fn&2)===0&&r2(t,0):TW|=r,e2===fn&&(e2=0)),Qp(t)}function yce(t,e){e===0&&(e=cae()),t=s1(t,e),t!==null&&(JM(t,e),Qp(t))}function nOe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),yce(t,r)}function oOe(t,e){var r=0;switch(t.tag){case 31:case 13:var i=t.stateNode,n=t.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(Vt(314))}i!==null&&i.delete(e),yce(t,r)}function sOe(t,e){return V$(t,e)}var Q8=null,Cw=null,C$=!1,J8=!1,zj=!1,uy=0;function Qp(t){t!==Cw&&t.next===null&&(Cw===null?Q8=Cw=t:Cw=Cw.next=t),J8=!0,C$||(C$=!0,lOe())}function oE(t,e){if(!zj&&J8){zj=!0;do for(var r=!1,i=Q8;i!==null;){if(!e)if(t!==0){var n=i.pendingLanes;if(n===0)var o=0;else{var s=i.suspendedLanes,a=i.pingedLanes;o=(1<<31-dh(42|t)+1)-1,o&=n&~(s&~a),o=o&201326741?o&201326741|1:o?o|2:0}o!==0&&(r=!0,Cse(i,o))}else o=fn,o=aO(i,i===To?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(o&3)===0||QM(i,o)||(r=!0,Cse(i,o));i=i.next}while(r);zj=!1}}function aOe(){_ce()}function _ce(){J8=C$=!1;var t=0;uy!==0&&gOe()&&(t=uy);for(var e=uh(),r=null,i=Q8;i!==null;){var n=i.next,o=vce(i,e);o===0?(i.next=null,r===null?Q8=n:r.next=n,n===null&&(Cw=r)):(r=i,(t!==0||(o&3)!==0)&&(J8=!0)),i=n}Va!==0&&Va!==5||oE(t,!1),uy!==0&&(uy=0)}function vce(t,e){for(var r=t.suspendedLanes,i=t.pingedLanes,n=t.expirationTimes,o=t.pendingLanes&-62914561;0<o;){var s=31-dh(o),a=1<<s,u=n[s];u===-1?((a&r)===0||(a&i)!==0)&&(n[s]=DRe(a,e)):u<=e&&(t.expiredLanes|=a),o&=~a}if(e=To,r=fn,r=aO(t,t===e?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,r===0||t===e&&(io===2||io===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&pj(i),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||QM(t,r)){if(e=r&-r,e===t.callbackPriority)return e;switch(i!==null&&pj(i),$$(r)){case 2:case 8:r=aae;break;case 32:r=L8;break;case 268435456:r=lae;break;default:r=L8}return i=bce.bind(null,t),r=V$(r,i),t.callbackPriority=e,t.callbackNode=r,e}return i!==null&&i!==null&&pj(i),t.callbackPriority=2,t.callbackNode=null,2}function bce(t,e){if(Va!==0&&Va!==5)return t.callbackNode=null,t.callbackPriority=0,null;var r=t.callbackNode;if(bO()&&t.callbackNode!==r)return null;var i=fn;return i=aO(t,t===To?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(sce(t,i,e),vce(t,uh()),t.callbackNode!=null&&t.callbackNode===r?bce.bind(null,t):null)}function Cse(t,e){if(bO())return null;sce(t,e,!0)}function lOe(){yOe(function(){(Fn&6)!==0?V$(sae,aOe):_ce()})}function EW(){if(uy===0){var t=Kw;t===0&&(t=e8,e8<<=1,(e8&261888)===0&&(e8=256)),uy=t}return uy}function Pse(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:y8(""+t)}function Ise(t,e){var r=e.ownerDocument.createElement("input");return r.name=e.name,r.value=e.value,t.id&&r.setAttribute("form",t.id),e.parentNode.insertBefore(r,e),t=new FormData(t),r.parentNode.removeChild(r),t}function cOe(t,e,r,i,n){if(e==="submit"&&r&&r.stateNode===n){var o=Pse((n[gu]||null).action),s=i.submitter;s&&(e=(e=s[gu]||null)?Pse(e.formAction):s.getAttribute("formAction"),e!==null&&(o=e,s=null));var a=new lO("action","action",null,i,n);t.push({event:a,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(uy!==0){var u=s?Ise(n,s):new FormData(n);y$(r,{pending:!0,data:u,method:n.method,action:o},null,u)}}else typeof o=="function"&&(a.preventDefault(),u=s?Ise(n,s):new FormData(n),y$(r,{pending:!0,data:u,method:n.method,action:o},o,u))},currentTarget:n}]})}}for(d8=0;d8<s$.length;d8++)f8=s$[d8],kse=f8.toLowerCase(),Rse=f8[0].toUpperCase()+f8.slice(1),Pf(kse,"on"+Rse);var f8,kse,Rse,d8;Pf(Oae,"onAnimationEnd");Pf(Dae,"onAnimationIteration");Pf(Lae,"onAnimationStart");Pf("dblclick","onDoubleClick");Pf("focusin","onFocus");Pf("focusout","onBlur");Pf(E8e,"onTransitionRun");Pf(C8e,"onTransitionStart");Pf(P8e,"onTransitionCancel");Pf(Bae,"onTransitionEnd");Xw("onMouseEnter",["mouseout","mouseover"]);Xw("onMouseLeave",["mouseout","mouseover"]);Xw("onPointerEnter",["pointerout","pointerover"]);Xw("onPointerLeave",["pointerout","pointerover"]);i1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));i1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));i1("onBeforeInput",["compositionend","keypress","textInput","paste"]);i1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));i1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));i1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var GM="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uOe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(GM));function xce(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var i=t[r],n=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],u=a.instance,p=a.currentTarget;if(a=a.listener,u!==o&&n.isPropagationStopped())break e;o=a,n.currentTarget=p;try{o(n)}catch(m){F8(m)}n.currentTarget=null,o=u}else for(s=0;s<i.length;s++){if(a=i[s],u=a.instance,p=a.currentTarget,a=a.listener,u!==o&&n.isPropagationStopped())break e;o=a,n.currentTarget=p;try{o(n)}catch(m){F8(m)}n.currentTarget=null,o=u}}}}function an(t,e){var r=e[Qj];r===void 0&&(r=e[Qj]=new Set);var i=t+"__bubble";r.has(i)||(wce(e,t,2,!1),r.add(i))}function Uj(t,e,r){var i=0;e&&(i|=4),wce(r,t,i,e)}var p8="_reactListening"+Math.random().toString(36).slice(2);function CW(t){if(!t[p8]){t[p8]=!0,pae.forEach(function(r){r!=="selectionchange"&&(uOe.has(r)||Uj(r,!1,t),Uj(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[p8]||(e[p8]=!0,Uj("selectionchange",!1,e))}}function wce(t,e,r,i){switch(Bce(e)){case 2:var n=NOe;break;case 8:n=zOe;break;default:n=RW}r=n.bind(null,e,r,t),n=void 0,!i$||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),i?n!==void 0?t.addEventListener(e,r,{capture:!0,passive:n}):t.addEventListener(e,r,!0):n!==void 0?t.addEventListener(e,r,{passive:n}):t.addEventListener(e,r,!1)}function Vj(t,e,r,i,n){var o=i;if((e&1)===0&&(e&2)===0&&i!==null)e:for(;;){if(i===null)return;var s=i.tag;if(s===3||s===4){var a=i.stateNode.containerInfo;if(a===n)break;if(s===4)for(s=i.return;s!==null;){var u=s.tag;if((u===3||u===4)&&s.stateNode.containerInfo===n)return;s=s.return}for(;a!==null;){if(s=kw(a),s===null)return;if(u=s.tag,u===5||u===6||u===26||u===27){i=o=s;continue e}a=a.parentNode}}i=i.return}xae(function(){var p=o,m=H$(r),x=[];e:{var M=Fae.get(t);if(M!==void 0){var k=lO,F=t;switch(t){case"keypress":if(v8(r)===0)break e;case"keydown":case"keyup":k=o8e;break;case"focusin":F="focus",k=_j;break;case"focusout":F="blur",k=_j;break;case"beforeblur":case"afterblur":k=_j;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=zoe;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=qRe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=l8e;break;case Oae:case Dae:case Lae:k=ZRe;break;case Bae:k=u8e;break;case"scroll":case"scrollend":k=GRe;break;case"wheel":k=d8e;break;case"copy":case"cut":case"paste":k=QRe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Voe;break;case"toggle":case"beforetoggle":k=p8e}var j=(e&4)!==0,H=!j&&(t==="scroll"||t==="scrollend"),W=j?M!==null?M+"Capture":null:M;j=[];for(var Z=p,Y;Z!==null;){var ee=Z;if(Y=ee.stateNode,ee=ee.tag,ee!==5&&ee!==26&&ee!==27||Y===null||W===null||(ee=FM(Z,W),ee!=null&&j.push(HM(Z,ee,Y))),H)break;Z=Z.return}0<j.length&&(M=new k(M,F,null,r,m),x.push({event:M,listeners:j}))}}if((e&7)===0){e:{if(M=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",M&&r!==r$&&(F=r.relatedTarget||r.fromElement)&&(kw(F)||F[o2]))break e;if((k||M)&&(M=m.window===m?m:(M=m.ownerDocument)?M.defaultView||M.parentWindow:window,k?(F=r.relatedTarget||r.toElement,k=p,F=F?kw(F):null,F!==null&&(H=ZM(F),j=F.tag,F!==H||j!==5&&j!==27&&j!==6)&&(F=null)):(k=null,F=p),k!==F)){if(j=zoe,ee="onMouseLeave",W="onMouseEnter",Z="mouse",(t==="pointerout"||t==="pointerover")&&(j=Voe,ee="onPointerLeave",W="onPointerEnter",Z="pointer"),H=k==null?M:vM(k),Y=F==null?M:vM(F),M=new j(ee,Z+"leave",k,r,m),M.target=H,M.relatedTarget=Y,ee=null,kw(m)===p&&(j=new j(W,Z+"enter",F,r,m),j.target=Y,j.relatedTarget=H,ee=j),H=ee,k&&F)t:{for(j=hOe,W=k,Z=F,Y=0,ee=W;ee;ee=j(ee))Y++;ee=0;for(var ce=Z;ce;ce=j(ce))ee++;for(;0<Y-ee;)W=j(W),Y--;for(;0<ee-Y;)Z=j(Z),ee--;for(;Y--;){if(W===Z||Z!==null&&W===Z.alternate){j=W;break t}W=j(W),Z=j(Z)}j=null}else j=null;k!==null&&Ose(x,M,k,j,!1),F!==null&&H!==null&&Ose(x,H,F,j,!0)}}e:{if(M=p?vM(p):window,k=M.nodeName&&M.nodeName.toLowerCase(),k==="select"||k==="input"&&M.type==="file")var ge=Goe;else if(Woe(M))if(Cae)ge=S8e;else{ge=x8e;var Se=b8e}else k=M.nodeName,!k||k.toLowerCase()!=="input"||M.type!=="checkbox"&&M.type!=="radio"?p&&G$(p.elementType)&&(ge=Goe):ge=w8e;if(ge&&(ge=ge(t,p))){Eae(x,ge,r,m);break e}Se&&Se(t,M,p),t==="focusout"&&p&&M.type==="number"&&p.memoizedProps.value!=null&&t$(M,"number",M.value)}switch(Se=p?vM(p):window,t){case"focusin":(Woe(Se)||Se.contentEditable==="true")&&(Dw=Se,n$=p,TM=null);break;case"focusout":TM=n$=Dw=null;break;case"mousedown":o$=!0;break;case"contextmenu":case"mouseup":case"dragend":o$=!1,Xoe(x,r,m);break;case"selectionchange":if(M8e)break;case"keydown":case"keyup":Xoe(x,r,m)}var ne;if(X$)e:{switch(t){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else Ow?Tae(t,r)&&(pe="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(pe="onCompositionStart");pe&&(Sae&&r.locale!=="ko"&&(Ow||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&Ow&&(ne=wae()):(ay=m,q$="value"in ay?ay.value:ay.textContent,Ow=!0)),Se=eO(p,pe),0<Se.length&&(pe=new Uoe(pe,t,null,r,m),x.push({event:pe,listeners:Se}),ne?pe.data=ne:(ne=Mae(r),ne!==null&&(pe.data=ne)))),(ne=g8e?A8e(t,r):y8e(t,r))&&(pe=eO(p,"onBeforeInput"),0<pe.length&&(Se=new Uoe("onBeforeInput","beforeinput",null,r,m),x.push({event:Se,listeners:pe}),Se.data=ne)),cOe(x,t,p,r,m)}xce(x,e)})}function HM(t,e,r){return{instance:t,listener:e,currentTarget:r}}function eO(t,e){for(var r=e+"Capture",i=[];t!==null;){var n=t,o=n.stateNode;if(n=n.tag,n!==5&&n!==26&&n!==27||o===null||(n=FM(t,r),n!=null&&i.unshift(HM(t,n,o)),n=FM(t,e),n!=null&&i.push(HM(t,n,o))),t.tag===3)return i;t=t.return}return[]}function hOe(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Ose(t,e,r,i,n){for(var o=e._reactName,s=[];r!==null&&r!==i;){var a=r,u=a.alternate,p=a.stateNode;if(a=a.tag,u!==null&&u===i)break;a!==5&&a!==26&&a!==27||p===null||(u=p,n?(p=FM(r,o),p!=null&&s.unshift(HM(r,p,u))):n||(p=FM(r,o),p!=null&&s.push(HM(r,p,u)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var dOe=/\r\n?/g,fOe=/\u0000|\uFFFD/g;function Dse(t){return(typeof t=="string"?t:""+t).replace(dOe,`
`).replace(fOe,"")}function Sce(t,e){return e=Dse(e),Dse(t)===e}function go(t,e,r,i,n,o){switch(r){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||Zw(t,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&Zw(t,""+i);break;case"className":i8(t,"class",i);break;case"tabIndex":i8(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":i8(t,r,i);break;case"style":bae(t,i,o);break;case"data":if(e!=="object"){i8(t,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||r!=="href")){t.removeAttribute(r);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(r);break}i=y8(""+i),t.setAttribute(r,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof o=="function"&&(r==="formAction"?(e!=="input"&&go(t,e,"name",n.name,n,null),go(t,e,"formEncType",n.formEncType,n,null),go(t,e,"formMethod",n.formMethod,n,null),go(t,e,"formTarget",n.formTarget,n,null)):(go(t,e,"encType",n.encType,n,null),go(t,e,"method",n.method,n,null),go(t,e,"target",n.target,n,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(r);break}i=y8(""+i),t.setAttribute(r,i);break;case"onClick":i!=null&&(t.onclick=Fm);break;case"onScroll":i!=null&&an("scroll",t);break;case"onScrollEnd":i!=null&&an("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Vt(61));if(r=i.__html,r!=null){if(n.children!=null)throw Error(Vt(60));t.innerHTML=r}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}r=y8(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(r,""+i):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":i===!0?t.setAttribute(r,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(r,i):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(r,i):t.removeAttribute(r);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(r):t.setAttribute(r,i);break;case"popover":an("beforetoggle",t),an("toggle",t),A8(t,"popover",i);break;case"xlinkActuate":Pm(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Pm(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Pm(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Pm(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Pm(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Pm(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Pm(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Pm(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Pm(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":A8(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=$Re.get(r)||r,A8(t,r,i))}}function P$(t,e,r,i,n,o){switch(r){case"style":bae(t,i,o);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Vt(61));if(r=i.__html,r!=null){if(n.children!=null)throw Error(Vt(60));t.innerHTML=r}}break;case"children":typeof i=="string"?Zw(t,i):(typeof i=="number"||typeof i=="bigint")&&Zw(t,""+i);break;case"onScroll":i!=null&&an("scroll",t);break;case"onScrollEnd":i!=null&&an("scrollend",t);break;case"onClick":i!=null&&(t.onclick=Fm);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!mae.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(n=r.endsWith("Capture"),e=r.slice(2,n?r.length-7:void 0),o=t[gu]||null,o=o!=null?o[r]:null,typeof o=="function"&&t.removeEventListener(e,o,n),typeof i=="function")){typeof o!="function"&&o!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(e,i,n);break e}r in t?t[r]=i:i===!0?t.setAttribute(r,""):A8(t,r,i)}}}function Pl(t,e,r){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":an("error",t),an("load",t);var i=!1,n=!1,o;for(o in r)if(r.hasOwnProperty(o)){var s=r[o];if(s!=null)switch(o){case"src":i=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Vt(137,e));default:go(t,e,o,s,r,null)}}n&&go(t,e,"srcSet",r.srcSet,r,null),i&&go(t,e,"src",r.src,r,null);return;case"input":an("invalid",t);var a=o=s=n=null,u=null,p=null;for(i in r)if(r.hasOwnProperty(i)){var m=r[i];if(m!=null)switch(i){case"name":n=m;break;case"type":s=m;break;case"checked":u=m;break;case"defaultChecked":p=m;break;case"value":o=m;break;case"defaultValue":a=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(Vt(137,e));break;default:go(t,e,i,m,r,null)}}yae(t,o,a,u,p,s,n,!1);return;case"select":an("invalid",t),i=s=o=null;for(n in r)if(r.hasOwnProperty(n)&&(a=r[n],a!=null))switch(n){case"value":o=a;break;case"defaultValue":s=a;break;case"multiple":i=a;default:go(t,e,n,a,r,null)}e=o,r=s,t.multiple=!!i,e!=null?jw(t,!!i,e,!1):r!=null&&jw(t,!!i,r,!0);return;case"textarea":an("invalid",t),o=n=i=null;for(s in r)if(r.hasOwnProperty(s)&&(a=r[s],a!=null))switch(s){case"value":i=a;break;case"defaultValue":n=a;break;case"children":o=a;break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(Vt(91));break;default:go(t,e,s,a,r,null)}vae(t,i,n,o);return;case"option":for(u in r)if(r.hasOwnProperty(u)&&(i=r[u],i!=null))switch(u){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:go(t,e,u,i,r,null)}return;case"dialog":an("beforetoggle",t),an("toggle",t),an("cancel",t),an("close",t);break;case"iframe":case"object":an("load",t);break;case"video":case"audio":for(i=0;i<GM.length;i++)an(GM[i],t);break;case"image":an("error",t),an("load",t);break;case"details":an("toggle",t);break;case"embed":case"source":case"link":an("error",t),an("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(p in r)if(r.hasOwnProperty(p)&&(i=r[p],i!=null))switch(p){case"children":case"dangerouslySetInnerHTML":throw Error(Vt(137,e));default:go(t,e,p,i,r,null)}return;default:if(G$(e)){for(m in r)r.hasOwnProperty(m)&&(i=r[m],i!==void 0&&P$(t,e,m,i,r,void 0));return}}for(a in r)r.hasOwnProperty(a)&&(i=r[a],i!=null&&go(t,e,a,i,r,null))}function pOe(t,e,r,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,o=null,s=null,a=null,u=null,p=null,m=null;for(k in r){var x=r[k];if(r.hasOwnProperty(k)&&x!=null)switch(k){case"checked":break;case"value":break;case"defaultValue":u=x;default:i.hasOwnProperty(k)||go(t,e,k,null,i,x)}}for(var M in i){var k=i[M];if(x=r[M],i.hasOwnProperty(M)&&(k!=null||x!=null))switch(M){case"type":o=k;break;case"name":n=k;break;case"checked":p=k;break;case"defaultChecked":m=k;break;case"value":s=k;break;case"defaultValue":a=k;break;case"children":case"dangerouslySetInnerHTML":if(k!=null)throw Error(Vt(137,e));break;default:k!==x&&go(t,e,M,k,i,x)}}e$(t,s,a,u,p,m,o,n);return;case"select":k=s=a=M=null;for(o in r)if(u=r[o],r.hasOwnProperty(o)&&u!=null)switch(o){case"value":break;case"multiple":k=u;default:i.hasOwnProperty(o)||go(t,e,o,null,i,u)}for(n in i)if(o=i[n],u=r[n],i.hasOwnProperty(n)&&(o!=null||u!=null))switch(n){case"value":M=o;break;case"defaultValue":a=o;break;case"multiple":s=o;default:o!==u&&go(t,e,n,o,i,u)}e=a,r=s,i=k,M!=null?jw(t,!!r,M,!1):!!i!=!!r&&(e!=null?jw(t,!!r,e,!0):jw(t,!!r,r?[]:"",!1));return;case"textarea":k=M=null;for(a in r)if(n=r[a],r.hasOwnProperty(a)&&n!=null&&!i.hasOwnProperty(a))switch(a){case"value":break;case"children":break;default:go(t,e,a,null,i,n)}for(s in i)if(n=i[s],o=r[s],i.hasOwnProperty(s)&&(n!=null||o!=null))switch(s){case"value":M=n;break;case"defaultValue":k=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(Vt(91));break;default:n!==o&&go(t,e,s,n,i,o)}_ae(t,M,k);return;case"option":for(var F in r)if(M=r[F],r.hasOwnProperty(F)&&M!=null&&!i.hasOwnProperty(F))switch(F){case"selected":t.selected=!1;break;default:go(t,e,F,null,i,M)}for(u in i)if(M=i[u],k=r[u],i.hasOwnProperty(u)&&M!==k&&(M!=null||k!=null))switch(u){case"selected":t.selected=M&&typeof M!="function"&&typeof M!="symbol";break;default:go(t,e,u,M,i,k)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var j in r)M=r[j],r.hasOwnProperty(j)&&M!=null&&!i.hasOwnProperty(j)&&go(t,e,j,null,i,M);for(p in i)if(M=i[p],k=r[p],i.hasOwnProperty(p)&&M!==k&&(M!=null||k!=null))switch(p){case"children":case"dangerouslySetInnerHTML":if(M!=null)throw Error(Vt(137,e));break;default:go(t,e,p,M,i,k)}return;default:if(G$(e)){for(var H in r)M=r[H],r.hasOwnProperty(H)&&M!==void 0&&!i.hasOwnProperty(H)&&P$(t,e,H,void 0,i,M);for(m in i)M=i[m],k=r[m],!i.hasOwnProperty(m)||M===k||M===void 0&&k===void 0||P$(t,e,m,M,i,k);return}}for(var W in r)M=r[W],r.hasOwnProperty(W)&&M!=null&&!i.hasOwnProperty(W)&&go(t,e,W,null,i,M);for(x in i)M=i[x],k=r[x],!i.hasOwnProperty(x)||M===k||M==null&&k==null||go(t,e,x,M,i,k)}function Lse(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function mOe(){if(typeof performance.getEntriesByType=="function"){for(var t=0,e=0,r=performance.getEntriesByType("resource"),i=0;i<r.length;i++){var n=r[i],o=n.transferSize,s=n.initiatorType,a=n.duration;if(o&&a&&Lse(s)){for(s=0,a=n.responseEnd,i+=1;i<r.length;i++){var u=r[i],p=u.startTime;if(p>a)break;var m=u.transferSize,x=u.initiatorType;m&&Lse(x)&&(u=u.responseEnd,s+=m*(u<a?1:(a-p)/(u-p)))}if(--i,e+=8*(o+s)/(n.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var I$=null,k$=null;function tO(t){return t.nodeType===9?t:t.ownerDocument}function Bse(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tce(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function R$(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jj=null;function gOe(){var t=window.event;return t&&t.type==="popstate"?t===jj?!1:(jj=t,!0):(jj=null,!1)}var Mce=typeof setTimeout=="function"?setTimeout:void 0,AOe=typeof clearTimeout=="function"?clearTimeout:void 0,Fse=typeof Promise=="function"?Promise:void 0,yOe=typeof queueMicrotask=="function"?queueMicrotask:typeof Fse<"u"?function(t){return Fse.resolve(null).then(t).catch(_Oe)}:Mce;function _Oe(t){setTimeout(function(){throw t})}function Ty(t){return t==="head"}function Nse(t,e){var r=e,i=0;do{var n=r.nextSibling;if(t.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"||r==="/&"){if(i===0){t.removeChild(n),n2(e);return}i--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")i++;else if(r==="html")LM(t.ownerDocument.documentElement);else if(r==="head"){r=t.ownerDocument.head,LM(r);for(var o=r.firstChild;o;){var s=o.nextSibling,a=o.nodeName;o[eE]||a==="SCRIPT"||a==="STYLE"||a==="LINK"&&o.rel.toLowerCase()==="stylesheet"||r.removeChild(o),o=s}}else r==="body"&&LM(t.ownerDocument.body);r=n}while(r);n2(e)}function zse(t,e){var r=t;t=0;do{var i=r.nextSibling;if(r.nodeType===1?e?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(e?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(t===0)break;t--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||t++;r=i}while(r)}function O$(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var r=e;switch(e=e.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":O$(r),W$(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function vOe(t,e,r,i){for(;t.nodeType===1;){var n=r;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[eE])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(o=t.getAttribute("rel"),o==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(o!==n.rel||t.getAttribute("href")!==(n.href==null||n.href===""?null:n.href)||t.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||t.getAttribute("title")!==(n.title==null?null:n.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(o=t.getAttribute("src"),(o!==(n.src==null?null:n.src)||t.getAttribute("type")!==(n.type==null?null:n.type)||t.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&o&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var o=n.name==null?null:""+n.name;if(n.type==="hidden"&&t.getAttribute("name")===o)return t}else return t;if(t=md(t.nextSibling),t===null)break}return null}function bOe(t,e,r){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=md(t.nextSibling),t===null))return null;return t}function Ece(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!e||(t=md(t.nextSibling),t===null))return null;return t}function D$(t){return t.data==="$?"||t.data==="$~"}function L$(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function xOe(t,e){var r=t.ownerDocument;if(t.data==="$~")t._reactRetry=e;else if(t.data!=="$?"||r.readyState!=="loading")e();else{var i=function(){e(),r.removeEventListener("DOMContentLoaded",i)};r.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function md(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return t}var B$=null;function Use(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"||r==="/&"){if(e===0)return md(t.nextSibling);e--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||e++}t=t.nextSibling}return null}function Vse(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(e===0)return t;e--}else r!=="/$"&&r!=="/&"||e++}t=t.previousSibling}return null}function Cce(t,e,r){switch(e=tO(r),t){case"html":if(t=e.documentElement,!t)throw Error(Vt(452));return t;case"head":if(t=e.head,!t)throw Error(Vt(453));return t;case"body":if(t=e.body,!t)throw Error(Vt(454));return t;default:throw Error(Vt(451))}}function LM(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);W$(t)}var gd=new Map,jse=new Set;function rO(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var qm=Nn.d;Nn.d={f:wOe,r:SOe,D:TOe,C:MOe,L:EOe,m:COe,X:IOe,S:POe,M:kOe};function wOe(){var t=qm.f(),e=_O();return t||e}function SOe(t){var e=s2(t);e!==null&&e.tag===5&&e.type==="form"?ble(e):qm.r(t)}var u2=typeof document>"u"?null:document;function Pce(t,e,r){var i=u2;if(i&&typeof e=="string"&&e){var n=hd(e);n='link[rel="'+t+'"][href="'+n+'"]',typeof r=="string"&&(n+='[crossorigin="'+r+'"]'),jse.has(n)||(jse.add(n),t={rel:t,crossOrigin:r,href:e},i.querySelector(n)===null&&(e=i.createElement("link"),Pl(e,"link",t),sl(e),i.head.appendChild(e)))}}function TOe(t){qm.D(t),Pce("dns-prefetch",t,null)}function MOe(t,e){qm.C(t,e),Pce("preconnect",t,e)}function EOe(t,e,r){qm.L(t,e,r);var i=u2;if(i&&t&&e){var n='link[rel="preload"][as="'+hd(e)+'"]';e==="image"&&r&&r.imageSrcSet?(n+='[imagesrcset="'+hd(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(n+='[imagesizes="'+hd(r.imageSizes)+'"]')):n+='[href="'+hd(t)+'"]';var o=n;switch(e){case"style":o=i2(t);break;case"script":o=h2(t)}gd.has(o)||(t=Yo({rel:"preload",href:e==="image"&&r&&r.imageSrcSet?void 0:t,as:e},r),gd.set(o,t),i.querySelector(n)!==null||e==="style"&&i.querySelector(sE(o))||e==="script"&&i.querySelector(aE(o))||(e=i.createElement("link"),Pl(e,"link",t),sl(e),i.head.appendChild(e)))}}function COe(t,e){qm.m(t,e);var r=u2;if(r&&t){var i=e&&typeof e.as=="string"?e.as:"script",n='link[rel="modulepreload"][as="'+hd(i)+'"][href="'+hd(t)+'"]',o=n;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=h2(t)}if(!gd.has(o)&&(t=Yo({rel:"modulepreload",href:t},e),gd.set(o,t),r.querySelector(n)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(aE(o)))return}i=r.createElement("link"),Pl(i,"link",t),sl(i),r.head.appendChild(i)}}}function POe(t,e,r){qm.S(t,e,r);var i=u2;if(i&&t){var n=Vw(i).hoistableStyles,o=i2(t);e=e||"default";var s=n.get(o);if(!s){var a={loading:0,preload:null};if(s=i.querySelector(sE(o)))a.loading=5;else{t=Yo({rel:"stylesheet",href:t,"data-precedence":e},r),(r=gd.get(o))&&PW(t,r);var u=s=i.createElement("link");sl(u),Pl(u,"link",t),u._p=new Promise(function(p,m){u.onload=p,u.onerror=m}),u.addEventListener("load",function(){a.loading|=1}),u.addEventListener("error",function(){a.loading|=2}),a.loading|=4,C8(s,e,i)}s={type:"stylesheet",instance:s,count:1,state:a},n.set(o,s)}}}function IOe(t,e){qm.X(t,e);var r=u2;if(r&&t){var i=Vw(r).hoistableScripts,n=h2(t),o=i.get(n);o||(o=r.querySelector(aE(n)),o||(t=Yo({src:t,async:!0},e),(e=gd.get(n))&&IW(t,e),o=r.createElement("script"),sl(o),Pl(o,"link",t),r.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(n,o))}}function kOe(t,e){qm.M(t,e);var r=u2;if(r&&t){var i=Vw(r).hoistableScripts,n=h2(t),o=i.get(n);o||(o=r.querySelector(aE(n)),o||(t=Yo({src:t,async:!0,type:"module"},e),(e=gd.get(n))&&IW(t,e),o=r.createElement("script"),sl(o),Pl(o,"link",t),r.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(n,o))}}function $se(t,e,r,i){var n=(n=hy.current)?rO(n):null;if(!n)throw Error(Vt(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(e=i2(r.href),r=Vw(n).hoistableStyles,i=r.get(e),i||(i={type:"style",instance:null,count:0,state:null},r.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=i2(r.href);var o=Vw(n).hoistableStyles,s=o.get(t);if(s||(n=n.ownerDocument||n,s={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},o.set(t,s),(o=n.querySelector(sE(t)))&&!o._p&&(s.instance=o,s.state.loading=5),gd.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},gd.set(t,r),o||ROe(n,t,r,s.state))),e&&i===null)throw Error(Vt(528,""));return s}if(e&&i!==null)throw Error(Vt(529,""));return null;case"script":return e=r.async,r=r.src,typeof r=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=h2(r),r=Vw(n).hoistableScripts,i=r.get(e),i||(i={type:"script",instance:null,count:0,state:null},r.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(Vt(444,t))}}function i2(t){return'href="'+hd(t)+'"'}function sE(t){return'link[rel="stylesheet"]['+t+"]"}function Ice(t){return Yo({},t,{"data-precedence":t.precedence,precedence:null})}function ROe(t,e,r,i){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=t.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),Pl(e,"link",r),sl(e),t.head.appendChild(e))}function h2(t){return'[src="'+hd(t)+'"]'}function aE(t){return"script[async]"+t}function Wse(t,e,r){if(e.count++,e.instance===null)switch(e.type){case"style":var i=t.querySelector('style[data-href~="'+hd(r.href)+'"]');if(i)return e.instance=i,sl(i),i;var n=Yo({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),sl(i),Pl(i,"style",n),C8(i,r.precedence,t),e.instance=i;case"stylesheet":n=i2(r.href);var o=t.querySelector(sE(n));if(o)return e.state.loading|=4,e.instance=o,sl(o),o;i=Ice(r),(n=gd.get(n))&&PW(i,n),o=(t.ownerDocument||t).createElement("link"),sl(o);var s=o;return s._p=new Promise(function(a,u){s.onload=a,s.onerror=u}),Pl(o,"link",i),e.state.loading|=4,C8(o,r.precedence,t),e.instance=o;case"script":return o=h2(r.src),(n=t.querySelector(aE(o)))?(e.instance=n,sl(n),n):(i=r,(n=gd.get(o))&&(i=Yo({},r),IW(i,n)),t=t.ownerDocument||t,n=t.createElement("script"),sl(n),Pl(n,"link",i),t.head.appendChild(n),e.instance=n);case"void":return null;default:throw Error(Vt(443,e.type))}else e.type==="stylesheet"&&(e.state.loading&4)===0&&(i=e.instance,e.state.loading|=4,C8(i,r.precedence,t));return e.instance}function C8(t,e,r){for(var i=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=i.length?i[i.length-1]:null,o=n,s=0;s<i.length;s++){var a=i[s];if(a.dataset.precedence===e)o=a;else if(o!==n)break}o?o.parentNode.insertBefore(t,o.nextSibling):(e=r.nodeType===9?r.head:r,e.insertBefore(t,e.firstChild))}function PW(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function IW(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var P8=null;function Gse(t,e,r){if(P8===null){var i=new Map,n=P8=new Map;n.set(r,i)}else n=P8,i=n.get(r),i||(i=new Map,n.set(r,i));if(i.has(t))return i;for(i.set(t,null),r=r.getElementsByTagName(t),n=0;n<r.length;n++){var o=r[n];if(!(o[eE]||o[Ml]||t==="link"&&o.getAttribute("rel")==="stylesheet")&&o.namespaceURI!=="http://www.w3.org/2000/svg"){var s=o.getAttribute(e)||"";s=t+s;var a=i.get(s);a?a.push(o):i.set(s,[o])}}return i}function Hse(t,e,r){t=t.ownerDocument||t,t.head.insertBefore(r,e==="title"?t.querySelector("head > title"):null)}function OOe(t,e,r){if(r===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function kce(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function DOe(t,e,r,i){if(r.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var n=i2(i.href),o=e.querySelector(sE(n));if(o){e=o._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(t.count++,t=iO.bind(t),e.then(t,t)),r.state.loading|=4,r.instance=o,sl(o);return}o=e.ownerDocument||e,i=Ice(i),(n=gd.get(n))&&PW(i,n),o=o.createElement("link"),sl(o);var s=o;s._p=new Promise(function(a,u){s.onload=a,s.onerror=u}),Pl(o,"link",i),r.instance=o}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(r,e),(e=r.state.preload)&&(r.state.loading&3)===0&&(t.count++,r=iO.bind(t),e.addEventListener("load",r),e.addEventListener("error",r))}}var $j=0;function LOe(t,e){return t.stylesheets&&t.count===0&&I8(t,t.stylesheets),0<t.count||0<t.imgCount?function(r){var i=setTimeout(function(){if(t.stylesheets&&I8(t,t.stylesheets),t.unsuspend){var o=t.unsuspend;t.unsuspend=null,o()}},6e4+e);0<t.imgBytes&&$j===0&&($j=62500*mOe());var n=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&I8(t,t.stylesheets),t.unsuspend)){var o=t.unsuspend;t.unsuspend=null,o()}},(t.imgBytes>$j?50:800)+e);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(i),clearTimeout(n)}}:null}function iO(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)I8(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var nO=null;function I8(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,nO=new Map,e.forEach(BOe,t),nO=null,iO.call(t))}function BOe(t,e){if(!(e.state.loading&4)){var r=nO.get(t);if(r)var i=r.get(null);else{r=new Map,nO.set(t,r);for(var n=t.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<n.length;o++){var s=n[o];(s.nodeName==="LINK"||s.getAttribute("media")!=="not all")&&(r.set(s.dataset.precedence,s),i=s)}i&&r.set(null,i)}n=e.instance,s=n.getAttribute("data-precedence"),o=r.get(s)||i,o===i&&r.set(null,n),r.set(s,n),this.count++,i=iO.bind(this),n.addEventListener("load",i),n.addEventListener("error",i),o?o.parentNode.insertBefore(n,o.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(n,t.firstChild)),e.state.loading|=4}}var qM={$$typeof:Bm,Provider:null,Consumer:null,_currentValue:qv,_currentValue2:qv,_threadCount:0};function FOe(t,e,r,i,n,o,s,a,u){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=mj(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mj(0),this.hiddenUpdates=mj(null),this.identifierPrefix=i,this.onUncaughtError=n,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=u,this.incompleteTransitions=new Map}function Rce(t,e,r,i,n,o,s,a,u,p,m,x){return t=new FOe(t,e,r,s,u,p,m,x,a),e=1,o===!0&&(e|=24),o=lh(3,null,null,e),t.current=o,o.stateNode=t,e=rW(),e.refCount++,t.pooledCache=e,e.refCount++,o.memoizedState={element:i,isDehydrated:r,cache:e},oW(o),t}function Oce(t){return t?(t=Fw,t):Fw}function Dce(t,e,r,i,n,o){n=Oce(n),i.context===null?i.context=n:i.pendingContext=n,i=fy(e),i.payload={element:r},o=o===void 0?null:o,o!==null&&(i.callback=o),r=py(t,i,e),r!==null&&(mu(r,t,e),EM(r,t,e))}function qse(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function kW(t,e){qse(t,e),(t=t.alternate)&&qse(t,e)}function Lce(t){if(t.tag===13||t.tag===31){var e=s1(t,67108864);e!==null&&mu(e,t,67108864),kW(t,67108864)}}function Yse(t){if(t.tag===13||t.tag===31){var e=fh();e=j$(e);var r=s1(t,e);r!==null&&mu(r,t,e),kW(t,e)}}var oO=!0;function NOe(t,e,r,i){var n=_i.T;_i.T=null;var o=Nn.p;try{Nn.p=2,RW(t,e,r,i)}finally{Nn.p=o,_i.T=n}}function zOe(t,e,r,i){var n=_i.T;_i.T=null;var o=Nn.p;try{Nn.p=8,RW(t,e,r,i)}finally{Nn.p=o,_i.T=n}}function RW(t,e,r,i){if(oO){var n=F$(i);if(n===null)Vj(t,e,i,sO,r),Xse(t,i);else if(VOe(n,t,e,r,i))i.stopPropagation();else if(Xse(t,i),e&4&&-1<UOe.indexOf(t)){for(;n!==null;){var o=s2(n);if(o!==null)switch(o.tag){case 3:if(o=o.stateNode,o.current.memoizedState.isDehydrated){var s=Wv(o.pendingLanes);if(s!==0){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var u=1<<31-dh(s);a.entanglements[1]|=u,s&=~u}Qp(o),(Fn&6)===0&&(X8=uh()+500,oE(0,!1))}}break;case 31:case 13:a=s1(o,2),a!==null&&mu(a,o,2),_O(),kW(o,2)}if(o=F$(i),o===null&&Vj(t,e,i,sO,r),o===n)break;n=o}n!==null&&i.stopPropagation()}else Vj(t,e,i,null,r)}}function F$(t){return t=H$(t),OW(t)}var sO=null;function OW(t){if(sO=null,t=kw(t),t!==null){var e=ZM(t);if(e===null)t=null;else{var r=e.tag;if(r===13){if(t=tae(e),t!==null)return t;t=null}else if(r===31){if(t=rae(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return sO=t,null}function Bce(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ERe()){case sae:return 2;case aae:return 8;case L8:case CRe:return 32;case lae:return 268435456;default:return 32}default:return 32}}var N$=!1,Ay=null,yy=null,_y=null,YM=new Map,XM=new Map,oy=[],UOe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Xse(t,e){switch(t){case"focusin":case"focusout":Ay=null;break;case"dragenter":case"dragleave":yy=null;break;case"mouseover":case"mouseout":_y=null;break;case"pointerover":case"pointerout":YM.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":XM.delete(e.pointerId)}}function gM(t,e,r,i,n,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:i,nativeEvent:o,targetContainers:[n]},e!==null&&(e=s2(e),e!==null&&Lce(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function VOe(t,e,r,i,n){switch(e){case"focusin":return Ay=gM(Ay,t,e,r,i,n),!0;case"dragenter":return yy=gM(yy,t,e,r,i,n),!0;case"mouseover":return _y=gM(_y,t,e,r,i,n),!0;case"pointerover":var o=n.pointerId;return YM.set(o,gM(YM.get(o)||null,t,e,r,i,n)),!0;case"gotpointercapture":return o=n.pointerId,XM.set(o,gM(XM.get(o)||null,t,e,r,i,n)),!0}return!1}function Fce(t){var e=kw(t.target);if(e!==null){var r=ZM(e);if(r!==null){if(e=r.tag,e===13){if(e=tae(r),e!==null){t.blockedOn=e,Roe(t.priority,function(){Yse(r)});return}}else if(e===31){if(e=rae(r),e!==null){t.blockedOn=e,Roe(t.priority,function(){Yse(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function k8(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=F$(t.nativeEvent);if(r===null){r=t.nativeEvent;var i=new r.constructor(r.type,r);r$=i,r.target.dispatchEvent(i),r$=null}else return e=s2(r),e!==null&&Lce(e),t.blockedOn=r,!1;e.shift()}return!0}function Zse(t,e,r){k8(t)&&r.delete(e)}function jOe(){N$=!1,Ay!==null&&k8(Ay)&&(Ay=null),yy!==null&&k8(yy)&&(yy=null),_y!==null&&k8(_y)&&(_y=null),YM.forEach(Zse),XM.forEach(Zse)}function m8(t,e){t.blockedOn===e&&(t.blockedOn=null,N$||(N$=!0,ja.unstable_scheduleCallback(ja.unstable_NormalPriority,jOe)))}var g8=null;function Kse(t){g8!==t&&(g8=t,ja.unstable_scheduleCallback(ja.unstable_NormalPriority,function(){g8===t&&(g8=null);for(var e=0;e<t.length;e+=3){var r=t[e],i=t[e+1],n=t[e+2];if(typeof i!="function"){if(OW(i||r)===null)continue;break}var o=s2(r);o!==null&&(t.splice(e,3),e-=3,y$(o,{pending:!0,data:n,method:r.method,action:i},i,n))}}))}function n2(t){function e(u){return m8(u,t)}Ay!==null&&m8(Ay,t),yy!==null&&m8(yy,t),_y!==null&&m8(_y,t),YM.forEach(e),XM.forEach(e);for(var r=0;r<oy.length;r++){var i=oy[r];i.blockedOn===t&&(i.blockedOn=null)}for(;0<oy.length&&(r=oy[0],r.blockedOn===null);)Fce(r),r.blockedOn===null&&oy.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(i=0;i<r.length;i+=3){var n=r[i],o=r[i+1],s=n[gu]||null;if(typeof o=="function")s||Kse(r);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(n=o,s=o[gu]||null)a=s.formAction;else if(OW(n)!==null)continue}else a=s.action;typeof a=="function"?r[i+1]=a:(r.splice(i,3),i-=3),Kse(r)}}}function Nce(){function t(o){o.canIntercept&&o.info==="react-transition"&&o.intercept({handler:function(){return new Promise(function(s){return n=s})},focusReset:"manual",scroll:"manual"})}function e(){n!==null&&(n(),n=null),i||setTimeout(r,20)}function r(){if(!i&&!navigation.transition){var o=navigation.currentEntry;o&&o.url!=null&&navigation.navigate(o.url,{state:o.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,n=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(r,100),function(){i=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),n!==null&&(n(),n=null)}}}function DW(t){this._internalRoot=t}xO.prototype.render=DW.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Vt(409));var r=e.current,i=fh();Dce(r,i,t,e,null,null)};xO.prototype.unmount=DW.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Dce(t.current,2,null,t,null,null),_O(),e[o2]=null}};function xO(t){this._internalRoot=t}xO.prototype.unstable_scheduleHydration=function(t){if(t){var e=fae();t={blockedOn:null,target:t,priority:e};for(var r=0;r<oy.length&&e!==0&&e<oy[r].priority;r++);oy.splice(r,0,t),r===0&&Fce(t)}};var Qse=Jse.version;if(Qse!=="19.2.0")throw Error(Vt(527,Qse,"19.2.0"));Nn.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Vt(188)):(t=Object.keys(t).join(","),Error(Vt(268,t)));return t=vRe(e),t=t!==null?iae(t):null,t=t===null?null:t.stateNode,t};var $Oe={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:_i,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(AM=__REACT_DEVTOOLS_GLOBAL_HOOK__,!AM.isDisabled&&AM.supportsFiber))try{KM=AM.inject($Oe),hh=AM}catch{}var AM;wO.createRoot=function(t,e){if(!eae(t))throw Error(Vt(299));var r=!1,i="",n=Ple,o=Ile,s=kle;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(n=e.onUncaughtError),e.onCaughtError!==void 0&&(o=e.onCaughtError),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Rce(t,1,!1,null,null,r,i,null,n,o,s,Nce),t[o2]=e.current,CW(t),new DW(e)};wO.hydrateRoot=function(t,e,r){if(!eae(t))throw Error(Vt(299));var i=!1,n="",o=Ple,s=Ile,a=kle,u=null;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onUncaughtError!==void 0&&(o=r.onUncaughtError),r.onCaughtError!==void 0&&(s=r.onCaughtError),r.onRecoverableError!==void 0&&(a=r.onRecoverableError),r.formState!==void 0&&(u=r.formState)),e=Rce(t,1,!0,e,r??null,i,n,u,o,s,a,Nce),e.context=Oce(null),r=e.current,i=fh(),i=j$(i),n=fy(i),n.callback=null,py(r,n,i),r=i,e.current.lanes=r,JM(e,r),Qp(e),t[o2]=e.current,CW(t),new xO(e)};wO.version="19.2.0"});var jce=nr((Bgt,Vce)=>{"use strict";function Uce(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Uce)}catch(t){console.error(t)}}Uce(),Vce.exports=zce()});var Zue=nr(XO=>{"use strict";var XDe=Symbol.for("react.transitional.element"),ZDe=Symbol.for("react.fragment");function Xue(t,e,r){var i=null;if(r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),"key"in e){r={};for(var n in e)n!=="key"&&(r[n]=e[n])}else r=e;return e=r.ref,{$$typeof:XDe,type:t,key:i,ref:e!==void 0?e:null,props:r}}XO.Fragment=ZDe;XO.jsx=Xue;XO.jsxs=Xue});var oo=nr((Yvt,Kue)=>{"use strict";Kue.exports=Zue()});var Que,ZO,DG=ve(()=>{"use client";Que=Tt($t(),1),ZO=(0,Que.createContext)({})});function Oy(t){let e=(0,Jue.useRef)(null);return e.current===null&&(e.current=t()),e.current}var Jue,CE=ve(()=>{"use client";Jue=Tt($t(),1)});var T2,KO=ve(()=>{T2=typeof window<"u"});var QO,JO,LG=ve(()=>{"use client";QO=Tt($t(),1);KO();JO=T2?QO.useLayoutEffect:QO.useEffect});var ehe,Dy,PE=ve(()=>{"use client";ehe=Tt($t(),1),Dy=(0,ehe.createContext)(null)});function the(t,e){t.indexOf(e)===-1&&t.push(e)}function rhe(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}var ihe=ve(()=>{});var _u,nhe=ve(()=>{_u=(t,e,r)=>r>e?e:r<t?t:r});var Jm,i0,BG=ve(()=>{Jm=()=>{},i0=()=>{}});var $a,ohe=ve(()=>{$a={}});var IE,she=ve(()=>{IE=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t)});function FG(t){return typeof t=="object"&&t!==null}var ahe=ve(()=>{});var kE,lhe=ve(()=>{kE=t=>/^0[^.\s]+$/u.test(t)});function m1(t){let e;return()=>(e===void 0&&(e=t()),e)}var che=ve(()=>{});var vh,eD=ve(()=>{vh=t=>t});var KDe,eg,uhe=ve(()=>{KDe=(t,e)=>r=>e(t(r)),eg=(...t)=>t.reduce(KDe)});var RE,hhe=ve(()=>{RE=(t,e,r)=>{let i=e-t;return i===0?1:(r-t)/i}});var g1,dhe=ve(()=>{ihe();g1=class{constructor(){this.subscriptions=[]}add(e){return the(this.subscriptions,e),()=>rhe(this.subscriptions,e)}notify(e,r,i){let n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](e,r,i);else for(let o=0;o<n;o++){let s=this.subscriptions[o];s&&s(e,r,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}});var Il,kl,fhe=ve(()=>{Il=t=>t*1e3,kl=t=>t/1e3});function OE(t,e){return e?t*(1e3/e):0}var phe=ve(()=>{});function eLe(t,e,r,i,n){let o,s,a=0;do s=e+(r-e)/2,o=mhe(s,i,n)-t,o>0?r=s:e=s;while(Math.abs(o)>QDe&&++a<JDe);return s}function Ly(t,e,r,i){if(t===e&&r===i)return vh;let n=o=>eLe(o,0,1,t,r);return o=>o===0||o===1?o:mhe(n(o),e,i)}var mhe,QDe,JDe,tD=ve(()=>{eD();mhe=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,QDe=1e-7,JDe=12});var rD,NG=ve(()=>{rD=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2});var iD,zG=ve(()=>{iD=t=>e=>1-t(1-e)});var nD,M2,DE,oD=ve(()=>{tD();NG();zG();nD=Ly(.33,1.53,.69,.99),M2=iD(nD),DE=rD(M2)});var LE,UG=ve(()=>{oD();LE=t=>(t*=2)<1?.5*M2(t):.5*(2-Math.pow(2,-10*(t-1)))});var BE,VG,FE,jG=ve(()=>{NG();zG();BE=t=>1-Math.sin(Math.acos(t)),VG=iD(BE),FE=rD(BE)});var $G,WG,NE,GG=ve(()=>{tD();$G=Ly(.42,0,1,1),WG=Ly(0,0,.58,1),NE=Ly(.42,0,.58,1)});var HG,ghe=ve(()=>{HG=t=>Array.isArray(t)&&typeof t[0]!="number"});var zE,qG=ve(()=>{zE=t=>Array.isArray(t)&&typeof t[0]=="number"});var Ahe,tLe,sD,yhe=ve(()=>{BG();eD();UG();oD();jG();tD();GG();qG();Ahe={linear:vh,easeIn:$G,easeInOut:NE,easeOut:WG,circIn:BE,circInOut:FE,circOut:VG,backIn:M2,backInOut:DE,backOut:nD,anticipate:LE},tLe=t=>typeof t=="string",sD=t=>{if(zE(t)){i0(t.length===4,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[e,r,i,n]=t;return Ly(e,r,i,n)}else if(tLe(t))return i0(Ahe[t]!==void 0,`Invalid easing type '${t}'`,"invalid-easing-type"),Ahe[t];return t}});var _n=ve(()=>{nhe();BG();ohe();she();ahe();lhe();che();eD();uhe();hhe();dhe();fhe();phe();UG();oD();jG();GG();qG();ghe();yhe()});var UE,_he=ve(()=>{UE=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"]});var E2,YG=ve(()=>{E2={value:null,addProjectionMetrics:null}});function vhe(t,e){let r=new Set,i=new Set,n=!1,o=!1,s=new WeakSet,a={delta:0,timestamp:0,isProcessing:!1},u=0;function p(x){s.has(x)&&(m.schedule(x),t()),u++,x(a)}let m={schedule:(x,M=!1,k=!1)=>{let j=k&&n?r:i;return M&&s.add(x),j.has(x)||j.add(x),x},cancel:x=>{i.delete(x),s.delete(x)},process:x=>{if(a=x,n){o=!0;return}n=!0,[r,i]=[i,r],r.forEach(p),e&&E2.value&&E2.value.frameloop[e].push(u),u=0,r.clear(),n=!1,o&&(o=!1,m.process(x))}};return m}var bhe=ve(()=>{YG()});function aD(t,e){let r=!1,i=!0,n={delta:0,timestamp:0,isProcessing:!1},o=()=>r=!0,s=UE.reduce((Y,ee)=>(Y[ee]=vhe(o,e?ee:void 0),Y),{}),{setup:a,read:u,resolveKeyframes:p,preUpdate:m,update:x,preRender:M,render:k,postRender:F}=s,j=()=>{let Y=$a.useManualTiming?n.timestamp:performance.now();r=!1,$a.useManualTiming||(n.delta=i?1e3/60:Math.max(Math.min(Y-n.timestamp,rLe),1)),n.timestamp=Y,n.isProcessing=!0,a.process(n),u.process(n),p.process(n),m.process(n),x.process(n),M.process(n),k.process(n),F.process(n),n.isProcessing=!1,r&&e&&(i=!1,t(j))},H=()=>{r=!0,i=!0,n.isProcessing||t(j)};return{schedule:UE.reduce((Y,ee)=>{let ce=s[ee];return Y[ee]=(ge,Se=!1,ne=!1)=>(r||H(),ce.schedule(ge,Se,ne)),Y},{}),cancel:Y=>{for(let ee=0;ee<UE.length;ee++)s[UE[ee]].cancel(Y)},state:n,steps:s}}var rLe,XG=ve(()=>{_n();_he();bhe();rLe=40});var xa,C2,A1,iLe,P2=ve(()=>{_n();XG();({schedule:xa,cancel:C2,state:A1,steps:iLe}=aD(typeof requestAnimationFrame<"u"?requestAnimationFrame:vh,!0))});function nLe(){lD=void 0}var lD,ul,I2=ve(()=>{_n();P2();ul={now:()=>(lD===void 0&&ul.set(A1.isProcessing||$a.useManualTiming?A1.timestamp:performance.now()),lD),set:t=>{lD=t,queueMicrotask(nLe)}}});var k2,ZG=ve(()=>{k2={layout:0,mainThread:0,waapi:0}});var xhe,VE,oLe,y1,sLe,jE=ve(()=>{xhe=t=>e=>typeof e=="string"&&e.startsWith(t),VE=xhe("--"),oLe=xhe("var(--"),y1=t=>oLe(t)?sLe.test(t.split("/*")[0].trim()):!1,sLe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu});var n0,tg,$E,By=ve(()=>{_n();n0={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},tg={...n0,transform:t=>_u(0,1,t)},$E={...n0,default:1}});var Fy,cD=ve(()=>{Fy=t=>Math.round(t*1e5)/1e5});var R2,uD=ve(()=>{R2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu});function whe(t){return t==null}var She=ve(()=>{});var The,Mhe=ve(()=>{The=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu});var O2,hD,dD=ve(()=>{uD();She();Mhe();O2=(t,e)=>r=>!!(typeof r=="string"&&The.test(r)&&r.startsWith(t)||e&&!whe(r)&&Object.prototype.hasOwnProperty.call(r,e)),hD=(t,e,r)=>i=>{if(typeof i!="string")return i;let[n,o,s,a]=i.match(R2);return{[t]:parseFloat(n),[e]:parseFloat(o),[r]:parseFloat(s),alpha:a!==void 0?parseFloat(a):1}}});var aLe,KG,o0,fD=ve(()=>{_n();By();cD();dD();aLe=t=>_u(0,255,t),KG={...n0,transform:t=>Math.round(aLe(t))},o0={test:O2("rgb","red"),parse:hD("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:i=1})=>"rgba("+KG.transform(t)+", "+KG.transform(e)+", "+KG.transform(r)+", "+Fy(tg.transform(i))+")"}});function lLe(t){let e="",r="",i="",n="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),i=t.substring(5,7),n=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),i=t.substring(3,4),n=t.substring(4,5),e+=e,r+=r,i+=i,n+=n),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:n?parseInt(n,16)/255:1}}var WE,QG=ve(()=>{fD();dD();WE={test:O2("#"),parse:lLe,transform:o0.transform}});var GE,Rf,rg,ri,JG,eH,pD,_1=ve(()=>{GE=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Rf=GE("deg"),rg=GE("%"),ri=GE("px"),JG=GE("vh"),eH=GE("vw"),pD={...rg,parse:t=>rg.parse(t)/100,transform:t=>rg.transform(t*100)}});var Ny,tH=ve(()=>{By();_1();cD();dD();Ny={test:O2("hsl","hue"),parse:hD("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:i=1})=>"hsla("+Math.round(t)+", "+rg.transform(Fy(e))+", "+rg.transform(Fy(r))+", "+Fy(tg.transform(i))+")"}});var ns,HE=ve(()=>{QG();tH();fD();ns={test:t=>o0.test(t)||WE.test(t)||Ny.test(t),parse:t=>o0.test(t)?o0.parse(t):Ny.test(t)?Ny.parse(t):WE.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?o0.transform(t):Ny.transform(t),getAnimatableNone:t=>{let e=ns.parse(t);return e.alpha=0,ns.transform(e)}}});var Ehe,Che=ve(()=>{Ehe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu});function cLe(t){return isNaN(t)&&typeof t=="string"&&(t.match(R2)?.length||0)+(t.match(Ehe)?.length||0)>0}function zy(t){let e=t.toString(),r=[],i={color:[],number:[],var:[]},n=[],o=0,a=e.replace(dLe,u=>(ns.test(u)?(i.color.push(o),n.push(khe),r.push(ns.parse(u))):u.startsWith(hLe)?(i.var.push(o),n.push(uLe),r.push(u)):(i.number.push(o),n.push(Ihe),r.push(parseFloat(u))),++o,Phe)).split(Phe);return{values:r,split:a,indexes:i,types:n}}function Rhe(t){return zy(t).values}function Ohe(t){let{split:e,types:r}=zy(t),i=e.length;return n=>{let o="";for(let s=0;s<i;s++)if(o+=e[s],n[s]!==void 0){let a=r[s];a===Ihe?o+=Fy(n[s]):a===khe?o+=ns.transform(n[s]):o+=n[s]}return o}}function pLe(t){let e=Rhe(t);return Ohe(t)(e.map(fLe))}var Ihe,khe,uLe,hLe,Phe,dLe,fLe,bh,Uy=ve(()=>{HE();Che();uD();cD();Ihe="number",khe="color",uLe="var",hLe="var(",Phe="${}",dLe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;fLe=t=>typeof t=="number"?0:ns.test(t)?ns.getAnimatableNone(t):t;bh={test:cLe,parse:Rhe,createTransformer:Ohe,getAnimatableNone:pLe}});function rH(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Dhe({hue:t,saturation:e,lightness:r,alpha:i}){t/=360,e/=100,r/=100;let n=0,o=0,s=0;if(!e)n=o=s=r;else{let a=r<.5?r*(1+e):r+e-r*e,u=2*r-a;n=rH(u,a,t+1/3),o=rH(u,a,t),s=rH(u,a,t-1/3)}return{red:Math.round(n*255),green:Math.round(o*255),blue:Math.round(s*255),alpha:i}}var Lhe=ve(()=>{});function D2(t,e){return r=>r>0?e:t}var iH=ve(()=>{});var Vy,qE=ve(()=>{Vy=(t,e,r)=>t+(e-t)*r});function Bhe(t){let e=gLe(t);if(Jm(!!e,`'${t}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!e)return!1;let r=e.parse(t);return e===Ny&&(r=Dhe(r)),r}var nH,mLe,gLe,oH,Fhe=ve(()=>{_n();QG();tH();Lhe();fD();iH();qE();nH=(t,e,r)=>{let i=t*t,n=r*(e*e-i)+i;return n<0?0:Math.sqrt(n)},mLe=[WE,o0,Ny],gLe=t=>mLe.find(e=>e.test(t));oH=(t,e)=>{let r=Bhe(t),i=Bhe(e);if(!r||!i)return D2(t,e);let n={...r};return o=>(n.red=nH(r.red,i.red,o),n.green=nH(r.green,i.green,o),n.blue=nH(r.blue,i.blue,o),n.alpha=Vy(r.alpha,i.alpha,o),o0.transform(n))}});function Nhe(t,e){return mD.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}var mD,zhe=ve(()=>{mD=new Set(["none","hidden"])});function ALe(t,e){return r=>Vy(t,e,r)}function gD(t){return typeof t=="number"?ALe:typeof t=="string"?y1(t)?D2:ns.test(t)?oH:vLe:Array.isArray(t)?Uhe:typeof t=="object"?ns.test(t)?oH:yLe:D2}function Uhe(t,e){let r=[...t],i=r.length,n=t.map((o,s)=>gD(o)(o,e[s]));return o=>{for(let s=0;s<i;s++)r[s]=n[s](o);return r}}function yLe(t,e){let r={...t,...e},i={};for(let n in r)t[n]!==void 0&&e[n]!==void 0&&(i[n]=gD(t[n])(t[n],e[n]));return n=>{for(let o in i)r[o]=i[o](n);return r}}function _Le(t,e){let r=[],i={color:0,var:0,number:0};for(let n=0;n<e.values.length;n++){let o=e.types[n],s=t.indexes[o][i[o]],a=t.values[s]??0;r[n]=a,i[o]++}return r}var vLe,Vhe=ve(()=>{_n();jE();HE();Uy();Fhe();iH();qE();zhe();vLe=(t,e)=>{let r=bh.createTransformer(e),i=zy(t),n=zy(e);return i.indexes.var.length===n.indexes.var.length&&i.indexes.color.length===n.indexes.color.length&&i.indexes.number.length>=n.indexes.number.length?mD.has(t)&&!n.values.length||mD.has(e)&&!i.values.length?Nhe(t,e):eg(Uhe(_Le(i,n),n.values),r):(Jm(!0,`Complex values '${t}' and '${e}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),D2(t,e))}});function AD(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Vy(t,e,r):gD(t)(t,e)}var sH=ve(()=>{Vhe();qE()});var jhe,$he=ve(()=>{I2();P2();jhe=t=>{let e=({timestamp:r})=>t(r);return{start:(r=!0)=>xa.update(e,r),stop:()=>C2(e),now:()=>A1.isProcessing?A1.timestamp:ul.now()}}});var yD,aH=ve(()=>{yD=(t,e,r=10)=>{let i="",n=Math.max(Math.round(e/r),2);for(let o=0;o<n;o++)i+=Math.round(t(o/(n-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`}});function L2(t){let e=0,r=50,i=t.next(e);for(;!i.done&&e<2e4;)e+=r,i=t.next(e);return e>=2e4?1/0:e}var _D=ve(()=>{});function Whe(t,e=100,r){let i=r({...t,keyframes:[0,e]}),n=Math.min(L2(i),2e4);return{type:"keyframes",ease:o=>i.next(n*o).value/e,duration:kl(n)}}var Ghe=ve(()=>{_n();_D()});function vD(t,e,r){let i=Math.max(e-bLe,0);return OE(r-t(i),e-i)}var bLe,cH=ve(()=>{_n();bLe=5});var Xo,uH=ve(()=>{Xo={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1}});function Hhe({duration:t=Xo.duration,bounce:e=Xo.bounce,velocity:r=Xo.velocity,mass:i=Xo.mass}){let n,o;Jm(t<=Il(Xo.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let s=1-e;s=_u(Xo.minDamping,Xo.maxDamping,s),t=_u(Xo.minDuration,Xo.maxDuration,kl(t)),s<1?(n=p=>{let m=p*s,x=m*t,M=m-r,k=bD(p,s),F=Math.exp(-x);return hH-M/k*F},o=p=>{let x=p*s*t,M=x*r+r,k=Math.pow(s,2)*Math.pow(p,2)*t,F=Math.exp(-x),j=bD(Math.pow(p,2),s);return(-n(p)+hH>0?-1:1)*((M-k)*F)/j}):(n=p=>{let m=Math.exp(-p*t),x=(p-r)*t+1;return-hH+m*x},o=p=>{let m=Math.exp(-p*t),x=(r-p)*(t*t);return m*x});let a=5/t,u=wLe(n,o,a);if(t=Il(t),isNaN(u))return{stiffness:Xo.stiffness,damping:Xo.damping,duration:t};{let p=Math.pow(u,2)*i;return{stiffness:p,damping:s*2*Math.sqrt(i*p),duration:t}}}function wLe(t,e,r){let i=r;for(let n=1;n<xLe;n++)i=i-t(i)/e(i);return i}function bD(t,e){return t*Math.sqrt(1-e*e)}var hH,xLe,qhe=ve(()=>{_n();uH();hH=.001;xLe=12});function Yhe(t,e){return e.some(r=>t[r]!==void 0)}function MLe(t){let e={velocity:Xo.velocity,stiffness:Xo.stiffness,damping:Xo.damping,mass:Xo.mass,isResolvedFromDuration:!1,...t};if(!Yhe(t,TLe)&&Yhe(t,SLe))if(t.visualDuration){let r=t.visualDuration,i=2*Math.PI/(r*1.2),n=i*i,o=2*_u(.05,1,1-(t.bounce||0))*Math.sqrt(n);e={...e,mass:Xo.mass,stiffness:n,damping:o}}else{let r=Hhe(t);e={...e,...r,mass:Xo.mass},e.isResolvedFromDuration=!0}return e}function B2(t=Xo.visualDuration,e=Xo.bounce){let r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t,{restSpeed:i,restDelta:n}=r,o=r.keyframes[0],s=r.keyframes[r.keyframes.length-1],a={done:!1,value:o},{stiffness:u,damping:p,mass:m,duration:x,velocity:M,isResolvedFromDuration:k}=MLe({...r,velocity:-kl(r.velocity||0)}),F=M||0,j=p/(2*Math.sqrt(u*m)),H=s-o,W=kl(Math.sqrt(u/m)),Z=Math.abs(H)<5;i||(i=Z?Xo.restSpeed.granular:Xo.restSpeed.default),n||(n=Z?Xo.restDelta.granular:Xo.restDelta.default);let Y;if(j<1){let ce=bD(W,j);Y=ge=>{let Se=Math.exp(-j*W*ge);return s-Se*((F+j*W*H)/ce*Math.sin(ce*ge)+H*Math.cos(ce*ge))}}else if(j===1)Y=ce=>s-Math.exp(-W*ce)*(H+(F+W*H)*ce);else{let ce=W*Math.sqrt(j*j-1);Y=ge=>{let Se=Math.exp(-j*W*ge),ne=Math.min(ce*ge,300);return s-Se*((F+j*W*H)*Math.sinh(ne)+ce*H*Math.cosh(ne))/ce}}let ee={calculatedDuration:k&&x||null,next:ce=>{let ge=Y(ce);if(k)a.done=ce>=x;else{let Se=ce===0?F:0;j<1&&(Se=ce===0?Il(F):vD(Y,ce,ge));let ne=Math.abs(Se)<=i,pe=Math.abs(s-ge)<=n;a.done=ne&&pe}return a.value=a.done?s:ge,a},toString:()=>{let ce=Math.min(L2(ee),2e4),ge=yD(Se=>ee.next(ce*Se).value,ce,30);return ce+"ms "+ge},toTransition:()=>{}};return ee}var SLe,TLe,dH=ve(()=>{_n();aH();_D();Ghe();cH();uH();qhe();SLe=["duration","bounce"],TLe=["stiffness","damping","mass"];B2.applyToOptions=t=>{let e=Whe(t,100,B2);return t.ease=e.ease,t.duration=Il(e.duration),t.type="keyframes",t}});function YE({keyframes:t,velocity:e=0,power:r=.8,timeConstant:i=325,bounceDamping:n=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:u,restDelta:p=.5,restSpeed:m}){let x=t[0],M={done:!1,value:x},k=ne=>a!==void 0&&ne<a||u!==void 0&&ne>u,F=ne=>a===void 0?u:u===void 0||Math.abs(a-ne)<Math.abs(u-ne)?a:u,j=r*e,H=x+j,W=s===void 0?H:s(H);W!==H&&(j=W-x);let Z=ne=>-j*Math.exp(-ne/i),Y=ne=>W+Z(ne),ee=ne=>{let pe=Z(ne),ue=Y(ne);M.done=Math.abs(pe)<=p,M.value=M.done?W:ue},ce,ge,Se=ne=>{k(M.value)&&(ce=ne,ge=B2({keyframes:[M.value,F(M.value)],velocity:vD(Y,ne,M.value),damping:n,stiffness:o,restDelta:p,restSpeed:m}))};return Se(0),{calculatedDuration:null,next:ne=>{let pe=!1;return!ge&&ce===void 0&&(pe=!0,ee(ne),Se(ne)),ce!==void 0&&ne>=ce?ge.next(ne-ce):(!pe&&ee(ne),M)}}}var fH=ve(()=>{dH();cH()});function ELe(t,e,r){let i=[],n=r||$a.mix||AD,o=t.length-1;for(let s=0;s<o;s++){let a=n(t[s],t[s+1]);if(e){let u=Array.isArray(e)?e[s]||vh:e;a=eg(u,a)}i.push(a)}return i}function Xhe(t,e,{clamp:r=!0,ease:i,mixer:n}={}){let o=t.length;if(i0(o===e.length,"Both input and output ranges must be the same length","range-length"),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];let s=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());let a=ELe(e,i,n),u=a.length,p=m=>{if(s&&m<t[0])return e[0];let x=0;if(u>1)for(;x<t.length-2&&!(m<t[x+1]);x++);let M=RE(t[x],t[x+1],m);return a[x](M)};return r?m=>p(_u(t[0],t[o-1],m)):p}var Zhe=ve(()=>{_n();sH()});function Khe(t,e){let r=t[t.length-1];for(let i=1;i<=e;i++){let n=RE(0,e,i);t.push(Vy(r,1,n))}}var Qhe=ve(()=>{_n();qE()});function Jhe(t){let e=[0];return Khe(e,t.length-1),e}var ede=ve(()=>{Qhe()});function tde(t,e){return t.map(r=>r*e)}var rde=ve(()=>{});function CLe(t,e){return t.map(()=>e||NE).splice(0,t.length-1)}function v1({duration:t=300,keyframes:e,times:r,ease:i="easeInOut"}){let n=HG(i)?i.map(sD):sD(i),o={done:!1,value:e[0]},s=tde(r&&r.length===e.length?r:Jhe(e),t),a=Xhe(s,e,{ease:Array.isArray(n)?n:CLe(e,n)});return{calculatedDuration:t,next:u=>(o.value=a(u),o.done=u>=t,o)}}var pH=ve(()=>{_n();Zhe();ede();rde()});function F2(t,{repeat:e,repeatType:r="loop"},i,n=1){let o=t.filter(PLe),a=n<0||e&&r!=="loop"&&e%2===1?0:o.length-1;return!a||i===void 0?o[a]:i}var PLe,xD=ve(()=>{PLe=t=>t!==null});function wD(t){typeof t.type=="string"&&(t.type=ILe[t.type])}var ILe,mH=ve(()=>{fH();pH();dH();ILe={decay:YE,inertia:YE,tween:v1,keyframes:v1,spring:B2}});var jy,SD=ve(()=>{jy=class{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}});var kLe,ig,TD=ve(()=>{_n();I2();ZG();sH();$he();fH();pH();_D();xD();mH();SD();kLe=t=>t/100,ig=class extends jy{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:r}=this.options;r&&r.updatedAt!==ul.now()&&this.tick(ul.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},k2.mainThread++,this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){let{options:e}=this;wD(e);let{type:r=v1,repeat:i=0,repeatDelay:n=0,repeatType:o,velocity:s=0}=e,{keyframes:a}=e,u=r||v1;u!==v1&&typeof a[0]!="number"&&(this.mixKeyframes=eg(kLe,AD(a[0],a[1])),a=[0,100]);let p=u({...e,keyframes:a});o==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...a].reverse(),velocity:-s})),p.calculatedDuration===null&&(p.calculatedDuration=L2(p));let{calculatedDuration:m}=p;this.calculatedDuration=m,this.resolvedDuration=m+n,this.totalDuration=this.resolvedDuration*(i+1)-n,this.generator=p}updateTime(e){let r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){let{generator:i,totalDuration:n,mixKeyframes:o,mirroredGenerator:s,resolvedDuration:a,calculatedDuration:u}=this;if(this.startTime===null)return i.next(0);let{delay:p=0,keyframes:m,repeat:x,repeatType:M,repeatDelay:k,type:F,onUpdate:j,finalKeyframe:H}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-n/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);let W=this.currentTime-p*(this.playbackSpeed>=0?1:-1),Z=this.playbackSpeed>=0?W<0:W>n;this.currentTime=Math.max(W,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let Y=this.currentTime,ee=i;if(x){let ne=Math.min(this.currentTime,n)/a,pe=Math.floor(ne),ue=ne%1;!ue&&ne>=1&&(ue=1),ue===1&&pe--,pe=Math.min(pe,x+1),!!(pe%2)&&(M==="reverse"?(ue=1-ue,k&&(ue-=k/a)):M==="mirror"&&(ee=s)),Y=_u(0,1,ue)*a}let ce=Z?{done:!1,value:m[0]}:ee.next(Y);o&&(ce.value=o(ce.value));let{done:ge}=ce;!Z&&u!==null&&(ge=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);let Se=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ge);return Se&&F!==YE&&(ce.value=F2(m,this.options,H,this.speed)),j&&j(ce.value),Se&&this.finish(),ce}then(e,r){return this.finished.then(e,r)}get duration(){return kl(this.calculatedDuration)}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+kl(e)}get time(){return kl(this.currentTime)}set time(e){e=Il(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ul.now());let r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=kl(this.currentTime))}play(){if(this.isStopped)return;let{driver:e=jhe,startTime:r}=this.options;this.driver||(this.driver=e(n=>this.tick(n))),this.options.onPlay?.();let i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=r??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ul.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,k2.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}});function ide(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}var nde=ve(()=>{});function XE(t){return t.includes("scale")?1:0}function ZE(t,e){if(!t||t==="none")return XE(e);let r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u),i,n;if(r)i=OLe,n=r;else{let a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=RLe,n=a}if(!n)return XE(e);let o=i[e],s=n[1].split(",").map(DLe);return typeof o=="function"?o(s):s[o]}function DLe(t){return parseFloat(t.trim())}var b1,gH,RLe,AH,ode,sde,ade,OLe,yH,_H=ve(()=>{b1=t=>t*180/Math.PI,gH=t=>{let e=b1(Math.atan2(t[1],t[0]));return AH(e)},RLe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:gH,rotateZ:gH,skewX:t=>b1(Math.atan(t[1])),skewY:t=>b1(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},AH=t=>(t=t%360,t<0&&(t+=360),t),ode=gH,sde=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),ade=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),OLe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:sde,scaleY:ade,scale:t=>(sde(t)+ade(t))/2,rotateX:t=>AH(b1(Math.atan2(t[6],t[5]))),rotateY:t=>AH(b1(Math.atan2(-t[2],t[0]))),rotateZ:ode,rotate:ode,skewX:t=>b1(Math.atan(t[4])),skewY:t=>b1(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};yH=(t,e)=>{let{transform:r="none"}=getComputedStyle(t);return ZE(r,e)}});var Of,xh,MD=ve(()=>{Of=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],xh=new Set(Of)});function lde(t){let e=[];return BLe.forEach(r=>{let i=t.getValue(r);i!==void 0&&(e.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),e}var vH,LLe,BLe,$y,bH=ve(()=>{_H();MD();By();_1();vH=t=>t===n0||t===ri,LLe=new Set(["x","y","z"]),BLe=Of.filter(t=>!LLe.has(t));$y={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>ZE(e,"x"),y:(t,{transform:e})=>ZE(e,"y")};$y.translateX=$y.x;$y.translateY=$y.y});function cde(){if(wH){let t=Array.from(x1).filter(i=>i.needsMeasurement),e=new Set(t.map(i=>i.element)),r=new Map;e.forEach(i=>{let n=lde(i);n.length&&(r.set(i,n),i.render())}),t.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();let n=r.get(i);n&&n.forEach(([o,s])=>{i.getValue(o)?.set(s)})}),t.forEach(i=>i.measureEndState()),t.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}wH=!1,xH=!1,x1.forEach(t=>t.complete(SH)),x1.clear()}function ude(){x1.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(wH=!0)})}function TH(){SH=!0,ude(),cde(),SH=!1}var x1,xH,wH,SH,ng,ED=ve(()=>{nde();bH();P2();x1=new Set,xH=!1,wH=!1,SH=!1;ng=class{constructor(e,r,i,n,o,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=i,this.motionValue=n,this.element=o,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(x1.add(this),xH||(xH=!0,xa.read(ude),xa.resolveKeyframes(cde))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:r,element:i,motionValue:n}=this;if(e[0]===null){let o=n?.get(),s=e[e.length-1];if(o!==void 0)e[0]=o;else if(i&&r){let a=i.readValue(r,s);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=s),n&&o===void 0&&n.set(e[0])}ide(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),x1.delete(this)}cancel(){this.state==="scheduled"&&(x1.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}});var hde,dde=ve(()=>{hde=t=>t.startsWith("--")});function fde(t,e,r){hde(e)?t.style.setProperty(e,r):t.style[e]=r}var pde=ve(()=>{dde()});var mde,gde=ve(()=>{_n();mde=m1(()=>window.ScrollTimeline!==void 0)});var Ade,yde=ve(()=>{Ade={}});function _de(t,e){let r=m1(t);return()=>Ade[e]??r()}var vde=ve(()=>{_n();yde()});var CD,MH=ve(()=>{vde();CD=_de(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing")});var w1,EH=ve(()=>{w1=([t,e,r,i])=>`cubic-bezier(${t}, ${e}, ${r}, ${i})`});var CH,bde=ve(()=>{EH();CH={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:w1([0,.65,.55,1]),circOut:w1([.55,0,1,.45]),backIn:w1([.31,.01,.66,-.59]),backOut:w1([.33,1.53,.69,.99])}});function PH(t,e){if(t)return typeof t=="function"?CD()?yD(t,e):"ease-out":zE(t)?w1(t):Array.isArray(t)?t.map(r=>PH(r,e)||CH.easeOut):CH[t]}var xde=ve(()=>{_n();MH();aH();EH();bde()});function wde(t,e,r,{delay:i=0,duration:n=300,repeat:o=0,repeatType:s="loop",ease:a="easeOut",times:u}={},p=void 0){let m={[e]:r};u&&(m.offset=u);let x=PH(a,n);Array.isArray(x)&&(m.easing=x),E2.value&&k2.waapi++;let M={delay:i,duration:n,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:o+1,direction:s==="reverse"?"alternate":"normal"};p&&(M.pseudoElement=p);let k=t.animate(m,M);return E2.value&&k.finished.finally(()=>{k2.waapi--}),k}var Sde=ve(()=>{ZG();YG();xde()});function PD(t){return typeof t=="function"&&"applyToOptions"in t}var IH=ve(()=>{});function Tde({type:t,...e}){return PD(t)&&CD()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}var Mde=ve(()=>{MH();IH()});var ID,Ede=ve(()=>{_n();pde();gde();xD();SD();Sde();Mde();ID=class extends jy{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;let{element:r,name:i,keyframes:n,pseudoElement:o,allowFlatten:s=!1,finalKeyframe:a,onComplete:u}=e;this.isPseudoElement=!!o,this.allowFlatten=s,this.options=e,i0(typeof e.type!="string",`Mini animate() doesn't support "type" as a string.`,"mini-spring");let p=Tde(e);this.animation=wde(r,i,n,p,o),p.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){let m=F2(n,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(m):fde(r,i,m),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){let e=this.animation.effect?.getComputedTiming?.().duration||0;return kl(Number(e))}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+kl(e)}get time(){return kl(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Il(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&mde()?(this.animation.timeline=e,vh):r(this)}}});function FLe(t){return t in Cde}function Pde(t){typeof t.ease=="string"&&FLe(t.ease)&&(t.ease=Cde[t.ease])}var Cde,Ide=ve(()=>{_n();Cde={anticipate:LE,backInOut:DE,circInOut:FE}});var kde,kD,Rde=ve(()=>{_n();TD();Ede();mH();Ide();kde=10,kD=class extends ID{constructor(e){Pde(e),wD(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){let{motionValue:r,onUpdate:i,onComplete:n,element:o,...s}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}let a=new ig({...s,autoplay:!1}),u=Il(this.finishedTime??this.time);r.setWithVelocity(a.sample(u-kde).value,a.sample(u).value,kde),a.stop()}}});var kH,Ode=ve(()=>{Uy();kH=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(bh.test(t)||t==="0")&&!t.startsWith("url("))});function NLe(t){let e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function Dde(t,e,r,i){let n=t[0];if(n===null)return!1;if(e==="display"||e==="visibility")return!0;let o=t[t.length-1],s=kH(n,e),a=kH(o,e);return Jm(s===a,`You are trying to animate ${e} from "${n}" to "${o}". "${s?o:n}" is not an animatable value.`,"value-not-animatable"),!s||!a?!1:NLe(t)||(r==="spring"||PD(r))&&i}var Lde=ve(()=>{_n();IH();Ode()});function N2(t){t.duration=0,t.type="keyframes"}var RH=ve(()=>{});function Bde(t){let{motionValue:e,name:r,repeatDelay:i,repeatType:n,damping:o,type:s}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:u,transformTemplate:p}=e.owner.getProps();return ULe()&&r&&zLe.has(r)&&(r!=="transform"||!p)&&!u&&!i&&n!=="mirror"&&o!==0&&s!=="inertia"}var zLe,ULe,Fde=ve(()=>{_n();zLe=new Set(["opacity","clipPath","filter","transform"]),ULe=m1(()=>Object.hasOwnProperty.call(Element.prototype,"animate"))});var VLe,KE,Nde=ve(()=>{_n();I2();TD();xD();ED();Rde();Lde();RH();SD();Fde();VLe=40,KE=class extends jy{constructor({autoplay:e=!0,delay:r=0,type:i="keyframes",repeat:n=0,repeatDelay:o=0,repeatType:s="loop",keyframes:a,name:u,motionValue:p,element:m,...x}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ul.now();let M={autoplay:e,delay:r,type:i,repeat:n,repeatDelay:o,repeatType:s,name:u,motionValue:p,element:m,...x},k=m?.KeyframeResolver||ng;this.keyframeResolver=new k(a,(F,j,H)=>this.onKeyframesResolved(F,j,M,!H),u,p,m),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,r,i,n){this.keyframeResolver=void 0;let{name:o,type:s,velocity:a,delay:u,isHandoff:p,onUpdate:m}=i;this.resolvedAt=ul.now(),Dde(e,o,s,a)||(($a.instantAnimations||!u)&&m?.(F2(e,i,r)),e[0]=e[e.length-1],N2(i),i.repeat=0);let M={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>VLe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...i,keyframes:e},k=!p&&Bde(M)?new kD({...M,element:M.motionValue.owner.current}):new ig(M);k.finished.then(()=>this.notifyFinished()).catch(vh),this.pendingTimeline&&(this.stopTimeline=k.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=k}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),TH()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}});function $Le(t){let e=jLe.exec(t);if(!e)return[,];let[,r,i,n]=e;return[`--${r??i}`,n]}function OH(t,e,r=1){i0(r<=WLe,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[i,n]=$Le(t);if(!i)return;let o=window.getComputedStyle(e).getPropertyValue(i);if(o){let s=o.trim();return IE(s)?parseFloat(s):s}return y1(n)?OH(n,e,r+1):n}var jLe,WLe,zde=ve(()=>{_n();jE();jLe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;WLe=4});function QE(t,e){return t?.[e]??t?.default??t}var Ude=ve(()=>{});var JE,DH=ve(()=>{MD();JE=new Set(["width","height","top","left","right","bottom",...Of])});var Vde,jde=ve(()=>{Vde={test:t=>t==="auto",parse:t=>t}});var RD,LH=ve(()=>{RD=t=>e=>e.test(t)});var BH,FH,NH=ve(()=>{jde();By();_1();LH();BH=[n0,ri,rg,Rf,eH,JG,Vde],FH=t=>BH.find(RD(t))});function $de(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||kE(t):!0}var Wde=ve(()=>{_n()});function HLe(t){let[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;let[i]=r.match(R2)||[];if(!i)return t;let n=r.replace(i,""),o=GLe.has(e)?1:0;return i!==r&&(o*=100),e+"("+o+n+")"}var GLe,qLe,eC,zH=ve(()=>{Uy();uD();GLe=new Set(["brightness","contrast","saturate","opacity"]);qLe=/\b([a-z-]*)\(.*?\)/gu,eC={...bh,getAnimatableNone:t=>{let e=t.match(qLe);return e?e.map(HLe).join(" "):t}}});var UH,Gde=ve(()=>{By();UH={...n0,transform:Math.round}});var Hde,qde=ve(()=>{By();_1();Hde={rotate:Rf,rotateX:Rf,rotateY:Rf,rotateZ:Rf,scale:$E,scaleX:$E,scaleY:$E,scaleZ:$E,skew:Rf,skewX:Rf,skewY:Rf,distance:ri,translateX:ri,translateY:ri,translateZ:ri,x:ri,y:ri,z:ri,perspective:ri,transformPerspective:ri,opacity:tg,originX:pD,originY:pD,originZ:ri}});var S1,VH=ve(()=>{Gde();By();_1();qde();S1={borderWidth:ri,borderTopWidth:ri,borderRightWidth:ri,borderBottomWidth:ri,borderLeftWidth:ri,borderRadius:ri,radius:ri,borderTopLeftRadius:ri,borderTopRightRadius:ri,borderBottomRightRadius:ri,borderBottomLeftRadius:ri,width:ri,maxWidth:ri,height:ri,maxHeight:ri,top:ri,right:ri,bottom:ri,left:ri,padding:ri,paddingTop:ri,paddingRight:ri,paddingBottom:ri,paddingLeft:ri,margin:ri,marginTop:ri,marginRight:ri,marginBottom:ri,marginLeft:ri,backgroundPositionX:ri,backgroundPositionY:ri,...Hde,zIndex:UH,fillOpacity:tg,strokeOpacity:tg,numOctaves:UH}});var Yde,tC,jH=ve(()=>{HE();zH();VH();Yde={...S1,color:ns,backgroundColor:ns,outlineColor:ns,fill:ns,stroke:ns,borderColor:ns,borderTopColor:ns,borderRightColor:ns,borderBottomColor:ns,borderLeftColor:ns,filter:eC,WebkitFilter:eC},tC=t=>Yde[t]});function rC(t,e){let r=tC(t);return r!==eC&&(r=bh),r.getAnimatableNone?r.getAnimatableNone(e):void 0}var $H=ve(()=>{Uy();zH();jH()});function Xde(t,e,r){let i=0,n;for(;i<t.length&&!n;){let o=t[i];typeof o=="string"&&!YLe.has(o)&&zy(o).values.length&&(n=t[i]),i++}if(n&&r)for(let o of e)t[o]=rC(r,n)}var YLe,Zde=ve(()=>{Uy();$H();YLe=new Set(["auto","none","0"])});var iC,Kde=ve(()=>{DH();NH();zde();jE();ED();Wde();Zde();bH();iC=class extends ng{constructor(e,r,i,n,o){super(e,r,i,n,o,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:r,name:i}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let p=e[u];if(typeof p=="string"&&(p=p.trim(),y1(p))){let m=OH(p,r.current);m!==void 0&&(e[u]=m),u===e.length-1&&(this.finalKeyframe=p)}}if(this.resolveNoneKeyframes(),!JE.has(i)||e.length!==2)return;let[n,o]=e,s=FH(n),a=FH(o);if(s!==a)if(vH(s)&&vH(a))for(let u=0;u<e.length;u++){let p=e[u];typeof p=="string"&&(e[u]=parseFloat(p))}else $y[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:r}=this,i=[];for(let n=0;n<e.length;n++)(e[n]===null||$de(e[n]))&&i.push(n);i.length&&Xde(e,i,r)}measureInitialState(){let{element:e,unresolvedKeyframes:r,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$y[i](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;let n=r[r.length-1];n!==void 0&&e.getValue(i,n).jump(n,!1)}measureEndState(){let{element:e,name:r,unresolvedKeyframes:i}=this;if(!e||!e.current)return;let n=e.getValue(r);n&&n.jump(this.measuredOrigin,!1);let o=i.length-1,s=i[o];i[o]=$y[r](e.measureViewportBox(),window.getComputedStyle(e.current)),s!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([a,u])=>{e.getValue(a).set(u)}),this.resolveNoneKeyframes()}}});function Qde(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let i=document;e&&(i=e.current);let n=r?.[t]??i.querySelectorAll(t);return n?Array.from(n):[]}return Array.from(t)}var Jde=ve(()=>{});var nC,efe=ve(()=>{nC=(t,e)=>e&&typeof t=="number"?e.transform(t):t});function oC(t){return FG(t)&&"offsetHeight"in t}var WH=ve(()=>{_n()});function Wy(t,e){return new OD(t,e)}var tfe,XLe,GH,OD,rfe=ve(()=>{_n();I2();P2();tfe=30,XLe=t=>!isNaN(parseFloat(t)),GH={current:void 0},OD=class{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{let n=ul.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=ul.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=XLe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new g1);let i=this.events[e].add(r);return e==="change"?()=>{i(),xa.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,i){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return GH.current&&GH.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){let e=ul.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>tfe)return 0;let r=Math.min(this.updatedAt-this.prevUpdatedAt,tfe);return OE(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}});var HH,ZLe,ife=ve(()=>{XG();({schedule:HH,cancel:ZLe}=aD(queueMicrotask,!1))});function DD(){return nfe.x||nfe.y}var nfe,qH=ve(()=>{nfe={x:!1,y:!1}});function LD(t,e){let r=Qde(t),i=new AbortController,n={passive:!0,...e,signal:i.signal};return[r,n,()=>i.abort()]}var YH=ve(()=>{Jde()});function ofe(t){return!(t.pointerType==="touch"||DD())}function XH(t,e,r={}){let[i,n,o]=LD(t,r),s=a=>{if(!ofe(a))return;let{target:u}=a,p=e(u,a);if(typeof p!="function"||!u)return;let m=x=>{ofe(x)&&(p(x),u.removeEventListener("pointerleave",m))};u.addEventListener("pointerleave",m,n)};return i.forEach(a=>{a.addEventListener("pointerenter",s,n)}),o}var sfe=ve(()=>{qH();YH()});var ZH,afe=ve(()=>{ZH=(t,e)=>e?t===e?!0:ZH(t,e.parentElement):!1});var lfe,cfe=ve(()=>{lfe=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1});function ufe(t){return KLe.has(t.tagName)||t.tabIndex!==-1}var KLe,hfe=ve(()=>{KLe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"])});var z2,KH=ve(()=>{z2=new WeakSet});function dfe(t){return e=>{e.key==="Enter"&&t(e)}}function QH(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}var ffe,pfe=ve(()=>{KH();ffe=(t,e)=>{let r=t.currentTarget;if(!r)return;let i=dfe(()=>{if(z2.has(r))return;QH(r,"down");let n=dfe(()=>{QH(r,"up")}),o=()=>QH(r,"cancel");r.addEventListener("keyup",n,e),r.addEventListener("blur",o,e)});r.addEventListener("keydown",i,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",i),e)}});function mfe(t){return lfe(t)&&!DD()}function JH(t,e,r={}){let[i,n,o]=LD(t,r),s=a=>{let u=a.currentTarget;if(!mfe(a))return;z2.add(u);let p=e(u,a),m=(k,F)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",M),z2.has(u)&&z2.delete(u),mfe(k)&&typeof p=="function"&&p(k,{success:F})},x=k=>{m(k,u===window||u===document||r.useGlobalTarget||ZH(u,k.target))},M=k=>{m(k,!1)};window.addEventListener("pointerup",x,n),window.addEventListener("pointercancel",M,n)};return i.forEach(a=>{(r.useGlobalTarget?window:a).addEventListener("pointerdown",s,n),oC(a)&&(a.addEventListener("focus",p=>ffe(p,n)),!ufe(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),o}var gfe=ve(()=>{WH();qH();afe();cfe();YH();hfe();pfe();KH()});var Zo,Afe=ve(()=>{Zo=t=>!!(t&&t.getVelocity)});var QLe,eq,yfe=ve(()=>{HE();Uy();NH();LH();QLe=[...BH,ns,bh],eq=t=>QLe.find(RD(t))});var os=ve(()=>{Nde();TD();Ude();jE();RH();Kde();ED();ife();I2();sfe();gfe();_H();DH();MD();WH();rfe();Uy();jH();VH();_1();$H();yfe();efe();Afe();P2()});var _fe,og,sC=ve(()=>{"use client";_fe=Tt($t(),1),og=(0,_fe.createContext)({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"})});function vfe(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function JLe(...t){return e=>{let r=!1,i=t.map(n=>{let o=vfe(n,e);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let n=0;n<i.length;n++){let o=i[n];typeof o=="function"?o():vfe(t[n],null)}}}}function xfe(...t){return bfe.useCallback(JLe(...t),t)}var bfe,wfe=ve(()=>{bfe=Tt($t(),1)});function Tfe({children:t,isPresent:e,anchorX:r,root:i}){let n=(0,sg.useId)(),o=(0,sg.useRef)(null),s=(0,sg.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=(0,sg.useContext)(og),u=xfe(o,t?.ref);return(0,sg.useInsertionEffect)(()=>{let{width:p,height:m,top:x,left:M,right:k}=s.current;if(e||!o.current||!p||!m)return;let F=r==="left"?`left: ${M}`:`right: ${k}`;o.current.dataset.motionPopId=n;let j=document.createElement("style");a&&(j.nonce=a);let H=i??document.head;return H.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${m}px !important;
            ${F}px !important;
            top: ${x}px !important;
          }
        `),()=>{H.contains(j)&&H.removeChild(j)}},[e]),(0,Sfe.jsx)(tq,{isPresent:e,childRef:o,sizeRef:s,children:BD.cloneElement(t,{ref:u})})}var Sfe,BD,sg,tq,Mfe=ve(()=>{"use client";Sfe=Tt(oo(),1);os();BD=Tt($t(),1),sg=Tt($t(),1);sC();wfe();tq=class extends BD.Component{getSnapshotBeforeUpdate(e){let r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){let i=r.offsetParent,n=oC(i)&&i.offsetWidth||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=n-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}});function e7e(){return new Map}var rq,Efe,aC,Cfe,Pfe=ve(()=>{"use client";rq=Tt(oo(),1),Efe=Tt($t(),1),aC=Tt($t(),1);PE();CE();Mfe();Cfe=({children:t,initial:e,isPresent:r,onExitComplete:i,custom:n,presenceAffectsLayout:o,mode:s,anchorX:a,root:u})=>{let p=Oy(e7e),m=(0,aC.useId)(),x=!0,M=(0,aC.useMemo)(()=>(x=!1,{id:m,initial:e,isPresent:r,custom:n,onExitComplete:k=>{p.set(k,!0);for(let F of p.values())if(!F)return;i&&i()},register:k=>(p.set(k,!1),()=>p.delete(k))}),[r,p,i]);return o&&x&&(M={...M}),(0,aC.useMemo)(()=>{p.forEach((k,F)=>p.set(F,!1))},[r]),Efe.useEffect(()=>{!r&&!p.size&&i&&i()},[r]),s==="popLayout"&&(t=(0,rq.jsx)(Tfe,{isPresent:r,anchorX:a,root:u,children:t})),(0,rq.jsx)(Dy.Provider,{value:M,children:t})}});function Ife(t=!0){let e=(0,Gy.useContext)(Dy);if(e===null)return[!0,null];let{isPresent:r,onExitComplete:i,register:n}=e,o=(0,Gy.useId)();(0,Gy.useEffect)(()=>{if(t)return n(o)},[t]);let s=(0,Gy.useCallback)(()=>t&&i&&i(o),[o,i,t]);return!r&&i?[!1,s]:[!0]}var Gy,kfe=ve(()=>{"use client";Gy=Tt($t(),1);PE()});function iq(t){let e=[];return FD.Children.forEach(t,r=>{(0,FD.isValidElement)(r)&&e.push(r)}),e}var FD,lC,Rfe=ve(()=>{FD=Tt($t(),1),lC=t=>t.key||""});var cC,s0,uC,Ofe=ve(()=>{"use client";cC=Tt(oo(),1),s0=Tt($t(),1);DG();CE();LG();Pfe();kfe();Rfe();uC=({children:t,custom:e,initial:r=!0,onExitComplete:i,presenceAffectsLayout:n=!0,mode:o="sync",propagate:s=!1,anchorX:a="left",root:u})=>{let[p,m]=Ife(s),x=(0,s0.useMemo)(()=>iq(t),[t]),M=s&&!p?[]:x.map(lC),k=(0,s0.useRef)(!0),F=(0,s0.useRef)(x),j=Oy(()=>new Map),[H,W]=(0,s0.useState)(x),[Z,Y]=(0,s0.useState)(x);JO(()=>{k.current=!1,F.current=x;for(let ge=0;ge<Z.length;ge++){let Se=lC(Z[ge]);M.includes(Se)?j.delete(Se):j.get(Se)!==!0&&j.set(Se,!1)}},[Z,M.length,M.join("-")]);let ee=[];if(x!==H){let ge=[...x];for(let Se=0;Se<Z.length;Se++){let ne=Z[Se],pe=lC(ne);M.includes(pe)||(ge.splice(Se,0,ne),ee.push(ne))}return o==="wait"&&ee.length&&(ge=ee),Y(iq(ge)),W(x),null}let{forceRender:ce}=(0,s0.useContext)(ZO);return(0,cC.jsx)(cC.Fragment,{children:Z.map(ge=>{let Se=lC(ge),ne=s&&!p?!1:x===Z||M.includes(Se),pe=()=>{if(j.has(Se))j.set(Se,!0);else return;let ue=!0;j.forEach(Le=>{Le||(ue=!1)}),ue&&(ce?.(),Y(F.current),s&&m?.(),i&&i())};return(0,cC.jsx)(Cfe,{isPresent:ne,initial:!k.current||r?void 0:!1,custom:e,presenceAffectsLayout:n,mode:o,root:u,onExitComplete:ne?void 0:pe,anchorX:a,children:ge},Se)})})}});var Dfe,U2,ND=ve(()=>{"use client";Dfe=Tt($t(),1),U2=(0,Dfe.createContext)({strict:!1})});var Lfe,ag,zD=ve(()=>{Lfe={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ag={};for(let t in Lfe)ag[t]={isEnabled:e=>Lfe[t].some(r=>!!e[r])}});function hC(t){for(let e in t)ag[e]={...ag[e],...t[e]}}var nq=ve(()=>{zD()});function dC({children:t,features:e,strict:r=!1}){let[,i]=(0,V2.useState)(!oq(e)),n=(0,V2.useRef)(void 0);if(!oq(e)){let{renderer:o,...s}=e;n.current=o,hC(s)}return(0,V2.useEffect)(()=>{oq(e)&&e().then(({renderer:o,...s})=>{hC(s),n.current=o,i(!0)})},[]),(0,Bfe.jsx)(U2.Provider,{value:{renderer:n.current,strict:r},children:t})}function oq(t){return typeof t=="function"}var Bfe,V2,Ffe=ve(()=>{"use client";Bfe=Tt(oo(),1),V2=Tt($t(),1);ND();nq()});function fC(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||t7e.has(t)}var t7e,Nfe=ve(()=>{t7e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"])});function sq(t){typeof t=="function"&&(zfe=e=>e.startsWith("on")?!fC(e):t(e))}function Ufe(t,e,r){let i={};for(let n in t)n==="values"&&typeof t.values=="object"||(zfe(n)||r===!0&&fC(n)||!e&&!fC(n)||t.draggable&&n.startsWith("onDrag"))&&(i[n]=t[n]);return i}var zfe,aq=ve(()=>{Nfe();zfe=t=>!fC(t);try{sq(XV("@emotion/is-prop-valid").default)}catch{}});function lq({children:t,isValidProp:e,...r}){e&&sq(e),r={...(0,UD.useContext)(og),...r},r.isStatic=Oy(()=>r.isStatic);let i=(0,UD.useMemo)(()=>r,[JSON.stringify(r.transition),r.transformPagePoint,r.reducedMotion]);return(0,Vfe.jsx)(og.Provider,{value:i,children:t})}var Vfe,UD,jfe=ve(()=>{"use client";Vfe=Tt(oo(),1),UD=Tt($t(),1);sC();aq();CE()});var $fe,Hy,pC=ve(()=>{"use client";$fe=Tt($t(),1),Hy=(0,$fe.createContext)({})});function qy(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}var mC=ve(()=>{});function lg(t){return typeof t=="string"||Array.isArray(t)}var gC=ve(()=>{});var VD,AC,jD=ve(()=>{VD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],AC=["initial",...VD]});function T1(t){return qy(t.animate)||AC.some(e=>lg(t[e]))}function $D(t){return!!(T1(t)||t.variants)}var WD=ve(()=>{mC();gC();jD()});function Wfe(t,e){if(T1(t)){let{initial:r,animate:i}=t;return{initial:r===!1||lg(r)?r:void 0,animate:lg(i)?i:void 0}}return t.inherit!==!1?e:{}}var Gfe=ve(()=>{WD();gC()});function qfe(t){let{initial:e,animate:r}=Wfe(t,(0,GD.useContext)(Hy));return(0,GD.useMemo)(()=>({initial:e,animate:r}),[Hfe(e),Hfe(r)])}function Hfe(t){return Array.isArray(t)?t.join(" "):t}var GD,Yfe=ve(()=>{"use client";GD=Tt($t(),1);pC();Gfe()});var Xfe,Zfe=ve(()=>{Xfe={}});function HD(t,{layout:e,layoutId:r}){return xh.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Xfe[t]||t==="opacity")}var cq=ve(()=>{os();Zfe()});function Kfe(t,e,r){let i="",n=!0;for(let o=0;o<i7e;o++){let s=Of[o],a=t[s];if(a===void 0)continue;let u=!0;if(typeof a=="number"?u=a===(s.startsWith("scale")?1:0):u=parseFloat(a)===0,!u||r){let p=nC(a,S1[s]);if(!u){n=!1;let m=r7e[s]||s;i+=`${m}(${p}) `}r&&(e[s]=p)}}return i=i.trim(),r?i=r(e,n?"":i):n&&(i="none"),i}var r7e,i7e,Qfe=ve(()=>{os();r7e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},i7e=Of.length});function j2(t,e,r){let{style:i,vars:n,transformOrigin:o}=t,s=!1,a=!1;for(let u in e){let p=e[u];if(xh.has(u)){s=!0;continue}else if(VE(u)){n[u]=p;continue}else{let m=nC(p,S1[u]);u.startsWith("origin")?(a=!0,o[u]=m):i[u]=m}}if(e.transform||(s||r?i.transform=Kfe(e,t.transform,r):i.transform&&(i.transform="none")),a){let{originX:u="50%",originY:p="50%",originZ:m=0}=o;i.transformOrigin=`${u} ${p} ${m}`}}var qD=ve(()=>{os();Qfe()});var $2,YD=ve(()=>{$2=()=>({style:{},transform:{},transformOrigin:{},vars:{}})});function uq(t,e,r){for(let i in e)!Zo(e[i])&&!HD(i,r)&&(t[i]=e[i])}function n7e({transformTemplate:t},e){return(0,Jfe.useMemo)(()=>{let r=$2();return j2(r,e,t),Object.assign({},r.vars,r.style)},[e])}function o7e(t,e){let r=t.style||{},i={};return uq(i,r,t),Object.assign(i,n7e(t,e)),i}function epe(t,e){let r={},i=o7e(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=i,r}var Jfe,hq=ve(()=>{"use client";os();Jfe=Tt($t(),1);cq();qD();YD()});function tpe(t,e,r=1,i=0,n=!0){t.pathLength=1;let o=n?s7e:a7e;t[o.offset]=ri.transform(-i);let s=ri.transform(e),a=ri.transform(r);t[o.array]=`${s} ${a}`}var s7e,a7e,rpe=ve(()=>{os();s7e={offset:"stroke-dashoffset",array:"stroke-dasharray"},a7e={offset:"strokeDashoffset",array:"strokeDasharray"}});function XD(t,{attrX:e,attrY:r,attrScale:i,pathLength:n,pathSpacing:o=1,pathOffset:s=0,...a},u,p,m){if(j2(t,a,p),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};let{attrs:x,style:M}=t;x.transform&&(M.transform=x.transform,delete x.transform),(M.transform||x.transformOrigin)&&(M.transformOrigin=x.transformOrigin??"50% 50%",delete x.transformOrigin),M.transform&&(M.transformBox=m?.transformBox??"fill-box",delete x.transformBox),e!==void 0&&(x.x=e),r!==void 0&&(x.y=r),i!==void 0&&(x.scale=i),n!==void 0&&tpe(x,n,o,s,!1)}var dq=ve(()=>{qD();rpe()});var ZD,fq=ve(()=>{YD();ZD=()=>({...$2(),attrs:{}})});var KD,pq=ve(()=>{KD=t=>typeof t=="string"&&t.toLowerCase()==="svg"});function npe(t,e,r,i){let n=(0,ipe.useMemo)(()=>{let o=ZD();return XD(o,e,KD(i),t.transformTemplate,t.style),{...o.attrs,style:{...o.style}}},[e]);if(t.style){let o={};uq(o,t.style,t),n.style={...o,...n.style}}return n}var ipe,ope=ve(()=>{"use client";ipe=Tt($t(),1);hq();dq();fq();pq()});var spe,ape=ve(()=>{spe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"]});function W2(t){return typeof t!="string"||t.includes("-")?!1:!!(spe.indexOf(t)>-1||/[A-Z]/u.test(t))}var QD=ve(()=>{ape()});function lpe(t,e,r,{latestValues:i},n,o=!1){let a=(W2(t)?npe:epe)(e,i,n,t),u=Ufe(e,typeof t=="string",o),p=t!==G2.Fragment?{...u,...a,ref:r}:{},{children:m}=e,x=(0,G2.useMemo)(()=>Zo(m)?m.get():m,[m]);return(0,G2.createElement)(t,{...p,children:x})}var G2,cpe=ve(()=>{"use client";os();G2=Tt($t(),1);hq();ope();aq();QD()});function upe(t){let e=[{},{}];return t?.values.forEach((r,i)=>{e[0][i]=r.get(),e[1][i]=r.getVelocity()}),e}function H2(t,e,r,i){if(typeof e=="function"){let[n,o]=upe(i);e=e(r!==void 0?r:t.custom,n,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){let[n,o]=upe(i);e=e(r!==void 0?r:t.custom,n,o)}return e}var JD=ve(()=>{});function hpe(t){return Zo(t)?t.get():t}var dpe=ve(()=>{os()});function l7e({scrapeMotionValuesFromProps:t,createRenderState:e},r,i,n){return{latestValues:c7e(r,i,n,t),renderState:e()}}function c7e(t,e,r,i){let n={},o=i(t,{});for(let M in o)n[M]=hpe(o[M]);let{initial:s,animate:a}=t,u=T1(t),p=$D(t);e&&p&&!u&&t.inherit!==!1&&(s===void 0&&(s=e.initial),a===void 0&&(a=e.animate));let m=r?r.initial===!1:!1;m=m||s===!1;let x=m?a:s;if(x&&typeof x!="boolean"&&!qy(x)){let M=Array.isArray(x)?x:[x];for(let k=0;k<M.length;k++){let F=H2(t,M[k]);if(F){let{transitionEnd:j,transition:H,...W}=F;for(let Z in W){let Y=W[Z];if(Array.isArray(Y)){let ee=m?Y.length-1:0;Y=Y[ee]}Y!==null&&(n[Z]=Y)}for(let Z in j)n[Z]=j[Z]}}}return n}var mq,eL,gq=ve(()=>{"use client";mq=Tt($t(),1);mC();pC();PE();WD();JD();CE();dpe();eL=t=>(e,r)=>{let i=(0,mq.useContext)(Hy),n=(0,mq.useContext)(Dy),o=()=>l7e(t,e,i,n);return r?o():Oy(o)}});function q2(t,e,r){let{style:i}=t,n={};for(let o in i)(Zo(i[o])||e.style&&Zo(e.style[o])||HD(o,t)||r?.getValue(o)?.liveStyle!==void 0)&&(n[o]=i[o]);return n}var tL=ve(()=>{os();cq()});var fpe,ppe=ve(()=>{"use client";gq();YD();tL();fpe=eL({scrapeMotionValuesFromProps:q2,createRenderState:$2})});function rL(t,e,r){let i=q2(t,e,r);for(let n in t)if(Zo(t[n])||Zo(e[n])){let o=Of.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[o]=t[n]}return i}var Aq=ve(()=>{os();tL()});var mpe,gpe=ve(()=>{"use client";gq();fq();Aq();mpe=eL({scrapeMotionValuesFromProps:rL,createRenderState:ZD})});var Ape,ype=ve(()=>{Ape=Symbol.for("motionComponentSymbol")});function iL(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}var yq=ve(()=>{});function vpe(t,e,r){return(0,_pe.useCallback)(i=>{i&&t.onMount&&t.onMount(i),e&&(i?e.mount(i):e.unmount()),r&&(typeof r=="function"?r(i):iL(r)&&(r.current=i))},[e])}var _pe,bpe=ve(()=>{"use client";_pe=Tt($t(),1);yq()});var Y2,nL=ve(()=>{Y2=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase()});var u7e,oL,_q=ve(()=>{nL();u7e="framerAppearId",oL="data-"+Y2(u7e)});var xpe,wpe,Spe=ve(()=>{"use client";xpe=Tt($t(),1),wpe=(0,xpe.createContext)({})});function Tpe(t,e,r,i,n){let{visualElement:o}=(0,vu.useContext)(Hy),s=(0,vu.useContext)(U2),a=(0,vu.useContext)(Dy),u=(0,vu.useContext)(og).reducedMotion,p=(0,vu.useRef)(null);i=i||s.renderer,!p.current&&i&&(p.current=i(t,{visualState:e,parent:o,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:u}));let m=p.current,x=(0,vu.useContext)(wpe);m&&!m.projection&&n&&(m.type==="html"||m.type==="svg")&&h7e(p.current,r,n,x);let M=(0,vu.useRef)(!1);(0,vu.useInsertionEffect)(()=>{m&&M.current&&m.update(r,a)});let k=r[oL],F=(0,vu.useRef)(!!k&&!window.MotionHandoffIsComplete?.(k)&&window.MotionHasOptimisedAnimation?.(k));return JO(()=>{m&&(M.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),F.current&&m.animationState&&m.animationState.animateChanges())}),(0,vu.useEffect)(()=>{m&&(!F.current&&m.animationState&&m.animationState.animateChanges(),F.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(k)}),F.current=!1),m.enteringChildren=void 0)}),m}function h7e(t,e,r,i){let{layoutId:n,layout:o,drag:s,dragConstraints:a,layoutScroll:u,layoutRoot:p,layoutCrossfade:m}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:Mpe(t.parent)),t.projection.setOptions({layoutId:n,layout:o,alwaysMeasureLayout:!!s||a&&iL(a),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:i,crossfade:m,layoutScroll:u,layoutRoot:p})}function Mpe(t){if(t)return t.options.allowProjection!==!1?t.projection:Mpe(t.parent)}var vu,Epe=ve(()=>{"use client";vu=Tt($t(),1);_q();ND();sC();pC();PE();Spe();yq();LG()});function aL(t,{forwardMotionProps:e=!1}={},r,i){r&&hC(r);let n=W2(t)?mpe:fpe;function o(a,u){let p,m={...(0,X2.useContext)(og),...a,layoutId:d7e(a)},{isStatic:x}=m,M=qfe(a),k=n(a,x);if(!x&&T2){f7e(m,r);let F=p7e(m);p=F.MeasureLayout,M.visualElement=Tpe(t,k,m,i,F.ProjectionNode)}return(0,sL.jsxs)(Hy.Provider,{value:M,children:[p&&M.visualElement?(0,sL.jsx)(p,{visualElement:M.visualElement,...m}):null,lpe(t,a,vpe(k,M.visualElement,u),k,x,e)]})}o.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;let s=(0,X2.forwardRef)(o);return s[Ape]=t,s}function d7e({layoutId:t}){let e=(0,X2.useContext)(ZO).id;return e&&t!==void 0?e+"-"+t:t}function f7e(t,e){let r=(0,X2.useContext)(U2).strict}function p7e(t){let{drag:e,layout:r}=ag;if(!e&&!r)return{};let i={...e,...r};return{MeasureLayout:e?.isEnabled(t)||r?.isEnabled(t)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}var sL,X2,Cpe=ve(()=>{"use client";sL=Tt(oo(),1),X2=Tt($t(),1);DG();ND();sC();pC();Yfe();cpe();QD();ppe();gpe();KO();zD();nq();ype();bpe();Epe()});function Ppe(t,e){if(typeof Proxy>"u")return aL;let r=new Map,i=(o,s)=>aL(o,s,t,e),n=(o,s)=>i(o,s);return new Proxy(n,{get:(o,s)=>s==="create"?i:(r.has(s)||r.set(s,aL(s,void 0,t,e)),r.get(s))})}var Ipe=ve(()=>{Cpe()});var yC,kpe=ve(()=>{Ipe();yC=Ppe()});function Rpe({top:t,left:e,right:r,bottom:i}){return{x:{min:e,max:r},y:{min:t,max:i}}}function Ope(t,e){if(!e)return t;let r=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}var Dpe=ve(()=>{});function Lpe(t,e){return Rpe(Ope(t.getBoundingClientRect(),e))}var Bpe=ve(()=>{Dpe()});var Fpe,lL,vq=ve(()=>{Fpe=()=>({min:0,max:0}),lL=()=>({x:Fpe(),y:Fpe()})});var _C,cL,bq=ve(()=>{_C={current:null},cL={current:!1}});function Npe(){if(cL.current=!0,!!T2)if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion)"),e=()=>_C.current=t.matches;t.addEventListener("change",e),e()}else _C.current=!1}var zpe=ve(()=>{KO();bq()});var Upe,Vpe=ve(()=>{Upe=new WeakMap});function jpe(t,e,r){for(let i in e){let n=e[i],o=r[i];if(Zo(n))t.addValue(i,n);else if(Zo(o))t.addValue(i,Wy(n,{owner:t}));else if(o!==n)if(t.hasValue(i)){let s=t.getValue(i);s.liveStyle===!0?s.jump(n):s.hasAnimated||s.set(n)}else{let s=t.getStaticValue(i);t.addValue(i,Wy(s!==void 0?s:n,{owner:t}))}}for(let i in r)e[i]===void 0&&t.removeValue(i);return e}var $pe=ve(()=>{os()});var Wpe,uL,Gpe=ve(()=>{os();_n();zD();vq();zpe();bq();Vpe();WD();$pe();JD();Wpe=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],uL=class{scrapeMotionValuesFromProps(e,r,i){return{}}constructor({parent:e,props:r,presenceContext:i,reducedMotionConfig:n,blockInitialAnimation:o,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ng,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let M=ul.now();this.renderScheduledAt<M&&(this.renderScheduledAt=M,xa.render(this.render,!1,!0))};let{latestValues:u,renderState:p}=s;this.latestValues=u,this.baseTarget={...u},this.initialValues=r.initial?{...u}:{},this.renderState=p,this.parent=e,this.props=r,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=n,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=T1(r),this.isVariantNode=$D(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:m,...x}=this.scrapeMotionValuesFromProps(r,{},this);for(let M in x){let k=x[M];u[M]!==void 0&&Zo(k)&&k.set(u[M])}}mount(e){this.current=e,Upe.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),cL.current||Npe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:_C.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),C2(this.notifyUpdate),C2(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(let e in this.events)this.events[e].clear();for(let e in this.features){let r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let i=xh.has(e);i&&this.onBindTransform&&this.onBindTransform();let n=r.on("change",s=>{this.latestValues[e]=s,this.props.onUpdate&&xa.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()}),o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{n(),o&&o(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ag){let r=ag[e];if(!r)continue;let{isEnabled:i,Feature:n}=r;if(!this.features[e]&&n&&i(this.props)&&(this.features[e]=new n(this)),this.features[e]){let o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):lL()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let i=0;i<Wpe.length;i++){let n=Wpe[i];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);let o="on"+n,s=e[o];s&&(this.propEventSubscriptions[n]=this.on(n,s))}this.prevMotionValues=jpe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){let i=this.values.get(e);r!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);let r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&r!==void 0&&(i=Wy(r===null?void 0:r,{owner:this}),this.addValue(e,i)),i}readValue(e,r){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(IE(i)||kE(i))?i=parseFloat(i):!eq(i)&&bh.test(r)&&(i=rC(e,r)),this.setBaseTarget(e,Zo(i)?i.get():i)),Zo(i)?i.get():i}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){let{initial:r}=this.props,i;if(typeof r=="string"||typeof r=="object"){let o=H2(this.props,r,this.presenceContext?.custom);o&&(i=o[e])}if(r&&i!==void 0)return i;let n=this.getBaseTargetFromProps(this.props,e);return n!==void 0&&!Zo(n)?n:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new g1),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){HH.render(this.render)}}});var Z2,xq=ve(()=>{os();Gpe();Z2=class extends uL{constructor(){super(...arguments),this.KeyframeResolver=iC}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:i}){delete r[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;Zo(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}});function hL(t,{style:e,vars:r},i,n){let o=t.style,s;for(s in e)o[s]=e[s];n?.applyProjectionStyles(o,i);for(s in r)o.setProperty(s,r[s])}var wq=ve(()=>{});function m7e(t){return window.getComputedStyle(t)}var dL,Hpe=ve(()=>{os();Bpe();xq();qD();wq();tL();dL=class extends Z2{constructor(){super(...arguments),this.type="html",this.renderInstance=hL}readValueFromInstance(e,r){if(xh.has(r))return this.projection?.isProjecting?XE(r):yH(e,r);{let i=m7e(e),n=(VE(r)?i.getPropertyValue(r):i[r])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(e,{transformPagePoint:r}){return Lpe(e,r)}build(e,r,i){j2(e,r,i.transformTemplate)}scrapeMotionValuesFromProps(e,r,i){return q2(e,r,i)}}});var fL,Sq=ve(()=>{fL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"])});function qpe(t,e,r,i){hL(t,e,void 0,i);for(let n in e.attrs)t.setAttribute(fL.has(n)?n:Y2(n),e.attrs[n])}var Ype=ve(()=>{nL();wq();Sq()});var pL,Xpe=ve(()=>{os();vq();xq();nL();dq();Sq();pq();Ype();Aq();pL=class extends Z2{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=lL}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(xh.has(r)){let i=tC(r);return i&&i.default||0}return r=fL.has(r)?r:Y2(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,i){return rL(e,r,i)}build(e,r,i){XD(e,r,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,r,i,n){qpe(e,r,i,n)}mount(e){this.isSVGTag=KD(e.tagName),super.mount(e)}}});var Zpe,Kpe,Qpe=ve(()=>{Zpe=Tt($t(),1);Hpe();Xpe();QD();Kpe=(t,e)=>W2(t)?new pL(e):new dL(e,{allowProjection:t!==Zpe.Fragment})});function a0(t,e,r){let i=t.getProps();return H2(i,e,r!==void 0?r:i.custom,t)}var vC=ve(()=>{JD()});var bC,Tq=ve(()=>{bC=t=>Array.isArray(t)});function g7e(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Wy(r))}function A7e(t){return bC(t)?t[t.length-1]||0:t}function Jpe(t,e){let r=a0(t,e),{transitionEnd:i={},transition:n={},...o}=r||{};o={...o,...i};for(let s in o){let a=A7e(o[s]);g7e(t,s,a)}}var e0e=ve(()=>{os();Tq();vC()});function t0e(t){return!!(Zo(t)&&t.add)}var r0e=ve(()=>{os()});function i0e(t,e){let r=t.getValue("willChange");if(t0e(r))return r.add(e);if(!r&&$a.WillChange){let i=new $a.WillChange("auto");t.addValue("willChange",i),i.add(e)}}var n0e=ve(()=>{_n();r0e()});function o0e(t){return t.props[oL]}var s0e=ve(()=>{_q()});function a0e(t,{repeat:e,repeatType:r="loop"},i){let n=t.filter(y7e),o=e&&r!=="loop"&&e%2===1?0:n.length-1;return!o||i===void 0?n[o]:i}var y7e,l0e=ve(()=>{y7e=t=>t!==null});var _7e,v7e,b7e,x7e,c0e,u0e=ve(()=>{os();_7e={type:"spring",stiffness:500,damping:25,restSpeed:10},v7e=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),b7e={type:"keyframes",duration:.8},x7e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},c0e=(t,{keyframes:e})=>e.length>2?b7e:xh.has(t)?t.startsWith("scale")?v7e(e[1]):_7e:x7e});function h0e({when:t,delay:e,delayChildren:r,staggerChildren:i,staggerDirection:n,repeat:o,repeatType:s,repeatDelay:a,from:u,elapsed:p,...m}){return!!Object.keys(m).length}var d0e=ve(()=>{});var f0e,p0e=ve(()=>{os();_n();l0e();u0e();d0e();f0e=(t,e,r,i={},n,o)=>s=>{let a=QE(i,t)||{},u=a.delay||i.delay||0,{elapsed:p=0}=i;p=p-Il(u);let m={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-p,onUpdate:M=>{e.set(M),a.onUpdate&&a.onUpdate(M)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:n};h0e(a)||Object.assign(m,c0e(t,m)),m.duration&&(m.duration=Il(m.duration)),m.repeatDelay&&(m.repeatDelay=Il(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let x=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(N2(m),m.delay===0&&(x=!0)),($a.instantAnimations||$a.skipAnimations)&&(x=!0,N2(m),m.delay=0),m.allowFlatten=!a.type&&!a.ease,x&&!o&&e.get()!==void 0){let M=a0e(m.keyframes,a);if(M!==void 0){xa.update(()=>{m.onUpdate(M),m.onComplete()});return}}return a.isSync?new ig(m):new KE(m)}});function w7e({protectedKeys:t,needsAnimating:e},r){let i=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,i}function mL(t,e,{delay:r=0,transitionOverride:i,type:n}={}){let{transition:o=t.getDefaultTransition(),transitionEnd:s,...a}=e;i&&(o=i);let u=[],p=n&&t.animationState&&t.animationState.getState()[n];for(let m in a){let x=t.getValue(m,t.latestValues[m]??null),M=a[m];if(M===void 0||p&&w7e(p,m))continue;let k={delay:r,...QE(o||{},m)},F=x.get();if(F!==void 0&&!x.isAnimating&&!Array.isArray(M)&&M===F&&!k.velocity)continue;let j=!1;if(window.MotionHandoffAnimation){let W=o0e(t);if(W){let Z=window.MotionHandoffAnimation(W,m,xa);Z!==null&&(k.startTime=Z,j=!0)}}i0e(t,m),x.start(f0e(m,x,M,t.shouldReduceMotion&&JE.has(m)?{type:!1}:k,t,j));let H=x.animation;H&&u.push(H)}return s&&Promise.all(u).then(()=>{xa.update(()=>{s&&Jpe(t,s)})}),u}var Mq=ve(()=>{os();e0e();n0e();s0e();p0e()});function gL(t,e,r,i=0,n=1){let o=Array.from(t).sort((p,m)=>p.sortNodePosition(m)).indexOf(e),s=t.size,a=(s-1)*i;return typeof r=="function"?r(o,s):n===1?o*i:a-o*i}var Eq=ve(()=>{});function AL(t,e,r={}){let i=a0(t,e,r.type==="exit"?t.presenceContext?.custom:void 0),{transition:n=t.getDefaultTransition()||{}}=i||{};r.transitionOverride&&(n=r.transitionOverride);let o=i?()=>Promise.all(mL(t,i,r)):()=>Promise.resolve(),s=t.variantChildren&&t.variantChildren.size?(u=0)=>{let{delayChildren:p=0,staggerChildren:m,staggerDirection:x}=n;return S7e(t,e,u,p,m,x,r)}:()=>Promise.resolve(),{when:a}=n;if(a){let[u,p]=a==="beforeChildren"?[o,s]:[s,o];return u().then(()=>p())}else return Promise.all([o(),s(r.delay)])}function S7e(t,e,r=0,i=0,n=0,o=1,s){let a=[];for(let u of t.variantChildren)u.notify("AnimationStart",e),a.push(AL(u,e,{...s,delay:r+(typeof i=="function"?0:i)+gL(t.variantChildren,u,i,n,o)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(a)}var m0e=ve(()=>{vC();Eq();Mq()});function g0e(t,e,r={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){let n=e.map(o=>AL(t,o,r));i=Promise.all(n)}else if(typeof e=="string")i=AL(t,e,r);else{let n=typeof e=="function"?a0(t,e,r.custom):e;i=Promise.all(mL(t,n,r))}return i.then(()=>{t.notify("AnimationComplete",e)})}var A0e=ve(()=>{vC();Mq();m0e()});function Cq(t,e){if(!Array.isArray(e))return!1;let r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}var y0e=ve(()=>{});function Pq(t){if(!t)return;if(!t.isControllingVariants){let r=t.parent?Pq(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}let e={};for(let r=0;r<T7e;r++){let i=AC[r],n=t.props[i];(lg(n)||n===!1)&&(e[i]=n)}return e}var T7e,_0e=ve(()=>{gC();jD();T7e=AC.length});function C7e(t){return e=>Promise.all(e.map(({animation:r,options:i})=>g0e(t,r,i)))}function b0e(t){let e=C7e(t),r=v0e(),i=!0,n=u=>(p,m)=>{let x=a0(t,m,u==="exit"?t.presenceContext?.custom:void 0);if(x){let{transition:M,transitionEnd:k,...F}=x;p={...p,...F,...k}}return p};function o(u){e=u(t)}function s(u){let{props:p}=t,m=Pq(t.parent)||{},x=[],M=new Set,k={},F=1/0;for(let H=0;H<E7e;H++){let W=M7e[H],Z=r[W],Y=p[W]!==void 0?p[W]:m[W],ee=lg(Y),ce=W===u?Z.isActive:null;ce===!1&&(F=H);let ge=Y===m[W]&&Y!==p[W]&&ee;if(ge&&i&&t.manuallyAnimateOnMount&&(ge=!1),Z.protectedKeys={...k},!Z.isActive&&ce===null||!Y&&!Z.prevProp||qy(Y)||typeof Y=="boolean")continue;let Se=P7e(Z.prevProp,Y),ne=Se||W===u&&Z.isActive&&!ge&&ee||H>F&&ee,pe=!1,ue=Array.isArray(Y)?Y:[Y],Le=ue.reduce(n(W),{});ce===!1&&(Le={});let{prevResolvedValues:We={}}=Z,ze={...We,...Le},rt=It=>{ne=!0,M.has(It)&&(pe=!0,M.delete(It)),Z.needsAnimating[It]=!0;let Bt=t.getValue(It);Bt&&(Bt.liveStyle=!1)};for(let It in ze){let Bt=Le[It],Qt=We[It];if(k.hasOwnProperty(It))continue;let hr=!1;bC(Bt)&&bC(Qt)?hr=!Cq(Bt,Qt):hr=Bt!==Qt,hr?Bt!=null?rt(It):M.add(It):Bt!==void 0&&M.has(It)?rt(It):Z.protectedKeys[It]=!0}Z.prevProp=Y,Z.prevResolvedValues=Le,Z.isActive&&(k={...k,...Le}),i&&t.blockInitialAnimation&&(ne=!1);let at=ge&&Se;ne&&(!at||pe)&&x.push(...ue.map(It=>{let Bt={type:W};if(typeof It=="string"&&i&&!at&&t.manuallyAnimateOnMount&&t.parent){let{parent:Qt}=t,hr=a0(Qt,It);if(Qt.enteringChildren&&hr){let{delayChildren:nt}=hr.transition||{};Bt.delay=gL(Qt.enteringChildren,t,nt)}}return{animation:It,options:Bt}}))}if(M.size){let H={};if(typeof p.initial!="boolean"){let W=a0(t,Array.isArray(p.initial)?p.initial[0]:p.initial);W&&W.transition&&(H.transition=W.transition)}M.forEach(W=>{let Z=t.getBaseTarget(W),Y=t.getValue(W);Y&&(Y.liveStyle=!0),H[W]=Z??null}),x.push({animation:H})}let j=!!x.length;return i&&(p.initial===!1||p.initial===p.animate)&&!t.manuallyAnimateOnMount&&(j=!1),i=!1,j?e(x):Promise.resolve()}function a(u,p){if(r[u].isActive===p)return Promise.resolve();t.variantChildren?.forEach(x=>x.animationState?.setActive(u,p)),r[u].isActive=p;let m=s(u);for(let x in r)r[x].protectedKeys={};return m}return{animateChanges:s,setActive:a,setAnimateFunction:o,getState:()=>r,reset:()=>{r=v0e()}}}function P7e(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Cq(e,t):!1}function M1(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function v0e(){return{animate:M1(!0),whileInView:M1(),whileHover:M1(),whileTap:M1(),whileDrag:M1(),whileFocus:M1(),exit:M1()}}var M7e,E7e,x0e=ve(()=>{A0e();Eq();mC();Tq();y0e();_0e();gC();vC();jD();M7e=[...VD].reverse(),E7e=VD.length});var bu,E1=ve(()=>{bu=class{constructor(e){this.isMounted=!1,this.node=e}update(){}}});var yL,w0e=ve(()=>{mC();x0e();E1();yL=class extends bu{constructor(e){super(e),e.animationState||(e.animationState=b0e(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();qy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}});var I7e,_L,S0e=ve(()=>{E1();I7e=0,_L=class extends bu{constructor(){super(...arguments),this.id=I7e++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;let n=this.node.animationState.setActive("exit",!e);r&&!e&&n.then(()=>{r(this.id)})}mount(){let{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}});var T0e,M0e=ve(()=>{w0e();S0e();T0e={animation:{Feature:yL},exit:{Feature:_L}}});function Iq(t,e,r,i={passive:!0}){return t.addEventListener(e,r,i),()=>t.removeEventListener(e,r)}var E0e=ve(()=>{});function vL(t){return{point:{x:t.pageX,y:t.pageY}}}var kq=ve(()=>{});function C0e(t,e,r){let{props:i}=t;t.animationState&&i.whileHover&&t.animationState.setActive("whileHover",r==="Start");let n="onHover"+r,o=i[n];o&&xa.postRender(()=>o(e,vL(e)))}var bL,P0e=ve(()=>{os();kq();E1();bL=class extends bu{mount(){let{current:e}=this.node;e&&(this.unmount=XH(e,(r,i)=>(C0e(this.node,i,"Start"),n=>C0e(this.node,n,"End"))))}unmount(){}}});var xL,I0e=ve(()=>{_n();E0e();E1();xL=class extends bu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=eg(Iq(this.node.current,"focus",()=>this.onFocus()),Iq(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}});function k0e(t,e,r){let{props:i}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&i.whileTap&&t.animationState.setActive("whileTap",r==="Start");let n="onTap"+(r==="End"?"":r),o=i[n];o&&xa.postRender(()=>o(e,vL(e)))}var wL,R0e=ve(()=>{os();kq();E1();wL=class extends bu{mount(){let{current:e}=this.node;e&&(this.unmount=JH(e,(r,i)=>(k0e(this.node,i,"Start"),(n,{success:o})=>k0e(this.node,n,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}});function O7e({root:t,...e}){let r=t||document;Rq.has(r)||Rq.set(r,{});let i=Rq.get(r),n=JSON.stringify(e);return i[n]||(i[n]=new IntersectionObserver(R7e,{root:t,...e})),i[n]}function O0e(t,e,r){let i=O7e(e);return Oq.set(t,r),i.observe(t),()=>{Oq.delete(t),i.unobserve(t)}}var Oq,Rq,k7e,R7e,D0e=ve(()=>{Oq=new WeakMap,Rq=new WeakMap,k7e=t=>{let e=Oq.get(t.target);e&&e(t)},R7e=t=>{t.forEach(k7e)}});function L7e({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}var D7e,SL,L0e=ve(()=>{E1();D0e();D7e={some:0,all:1},SL=class extends bu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:r,margin:i,amount:n="some",once:o}=e,s={root:r?r.current:void 0,rootMargin:i,threshold:typeof n=="number"?n:D7e[n]},a=u=>{let{isIntersecting:p}=u;if(this.isInView===p||(this.isInView=p,o&&!p&&this.hasEnteredView))return;p&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",p);let{onViewportEnter:m,onViewportLeave:x}=this.node.getProps(),M=p?m:x;M&&M(u)};return O0e(this.node.current,s,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;let{props:e,prevProps:r}=this.node;["amount","margin","root"].some(L7e(e,r))&&this.startObserver()}unmount(){}}});var B0e,F0e=ve(()=>{P0e();I0e();R0e();L0e();B0e={inView:{Feature:SL},tap:{Feature:wL},focus:{Feature:xL},hover:{Feature:bL}}});var Dq,N0e=ve(()=>{"use client";M0e();F0e();Qpe();Dq={renderer:Kpe,...T0e,...B0e}});var xC=ve(()=>{Ofe();Ffe();jfe();kpe();N0e();_n();_n();os()});var tY={};nl(tY,{default:()=>c9e});var c9e,rY=ve(()=>{"use client";xC();c9e=Dq});var fY=nr((GIt,kme)=>{var p9e="Expected a function",Pme=NaN,m9e="[object Symbol]",g9e=/^\s+|\s+$/g,A9e=/^[-+]0x[0-9a-f]+$/i,y9e=/^0b[01]+$/i,_9e=/^0o[0-7]+$/i,v9e=parseInt,b9e=typeof global=="object"&&global&&global.Object===Object&&global,x9e=typeof self=="object"&&self&&self.Object===Object&&self,w9e=b9e||x9e||Function("return this")(),S9e=Object.prototype,T9e=S9e.toString,M9e=Math.max,E9e=Math.min,hY=function(){return w9e.Date.now()};function C9e(t,e,r){var i,n,o,s,a,u,p=0,m=!1,x=!1,M=!0;if(typeof t!="function")throw new TypeError(p9e);e=Ime(e)||0,dY(r)&&(m=!!r.leading,x="maxWait"in r,o=x?M9e(Ime(r.maxWait)||0,e):o,M="trailing"in r?!!r.trailing:M);function k(ge){var Se=i,ne=n;return i=n=void 0,p=ge,s=t.apply(ne,Se),s}function F(ge){return p=ge,a=setTimeout(W,e),m?k(ge):s}function j(ge){var Se=ge-u,ne=ge-p,pe=e-Se;return x?E9e(pe,o-ne):pe}function H(ge){var Se=ge-u,ne=ge-p;return u===void 0||Se>=e||Se<0||x&&ne>=o}function W(){var ge=hY();if(H(ge))return Z(ge);a=setTimeout(W,j(ge))}function Z(ge){return a=void 0,M&&i?k(ge):(i=n=void 0,s)}function Y(){a!==void 0&&clearTimeout(a),p=0,i=u=n=a=void 0}function ee(){return a===void 0?s:Z(hY())}function ce(){var ge=hY(),Se=H(ge);if(i=arguments,n=this,u=ge,Se){if(a===void 0)return F(u);if(x)return a=setTimeout(W,e),k(u)}return a===void 0&&(a=setTimeout(W,e)),s}return ce.cancel=Y,ce.flush=ee,ce}function dY(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function P9e(t){return!!t&&typeof t=="object"}function I9e(t){return typeof t=="symbol"||P9e(t)&&T9e.call(t)==m9e}function Ime(t){if(typeof t=="number")return t;if(I9e(t))return Pme;if(dY(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=dY(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(g9e,"");var r=y9e.test(t);return r||_9e.test(t)?v9e(t.slice(2),r?2:8):A9e.test(t)?Pme:+t}kme.exports=C9e});var Bme=nr((HIt,Lme)=>{var Dme="Expected a function",Rme=NaN,k9e="[object Symbol]",R9e=/^\s+|\s+$/g,O9e=/^[-+]0x[0-9a-f]+$/i,D9e=/^0b[01]+$/i,L9e=/^0o[0-7]+$/i,B9e=parseInt,F9e=typeof global=="object"&&global&&global.Object===Object&&global,N9e=typeof self=="object"&&self&&self.Object===Object&&self,z9e=F9e||N9e||Function("return this")(),U9e=Object.prototype,V9e=U9e.toString,j9e=Math.max,$9e=Math.min,pY=function(){return z9e.Date.now()};function W9e(t,e,r){var i,n,o,s,a,u,p=0,m=!1,x=!1,M=!0;if(typeof t!="function")throw new TypeError(Dme);e=Ome(e)||0,FL(r)&&(m=!!r.leading,x="maxWait"in r,o=x?j9e(Ome(r.maxWait)||0,e):o,M="trailing"in r?!!r.trailing:M);function k(ge){var Se=i,ne=n;return i=n=void 0,p=ge,s=t.apply(ne,Se),s}function F(ge){return p=ge,a=setTimeout(W,e),m?k(ge):s}function j(ge){var Se=ge-u,ne=ge-p,pe=e-Se;return x?$9e(pe,o-ne):pe}function H(ge){var Se=ge-u,ne=ge-p;return u===void 0||Se>=e||Se<0||x&&ne>=o}function W(){var ge=pY();if(H(ge))return Z(ge);a=setTimeout(W,j(ge))}function Z(ge){return a=void 0,M&&i?k(ge):(i=n=void 0,s)}function Y(){a!==void 0&&clearTimeout(a),p=0,i=u=n=a=void 0}function ee(){return a===void 0?s:Z(pY())}function ce(){var ge=pY(),Se=H(ge);if(i=arguments,n=this,u=ge,Se){if(a===void 0)return F(u);if(x)return a=setTimeout(W,e),k(u)}return a===void 0&&(a=setTimeout(W,e)),s}return ce.cancel=Y,ce.flush=ee,ce}function G9e(t,e,r){var i=!0,n=!0;if(typeof t!="function")throw new TypeError(Dme);return FL(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),W9e(t,e,{leading:i,maxWait:e,trailing:n})}function FL(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function H9e(t){return!!t&&typeof t=="object"}function q9e(t){return typeof t=="symbol"||H9e(t)&&V9e.call(t)==k9e}function Ome(t){if(typeof t=="number")return t;if(q9e(t))return Rme;if(FL(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=FL(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(R9e,"");var r=D9e.test(t);return r||L9e.test(t)?B9e(t.slice(2),r?2:8):O9e.test(t)?Rme:+t}Lme.exports=G9e});var NL,iBe,zL,nBe,zme,_Y=ve(()=>{NL=globalThis,iBe=globalThis.document||{},zL=globalThis.process||{},nBe=globalThis.console,zme=globalThis.navigator||{}});function UL(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;let e=typeof navigator<"u"&&navigator.userAgent,r=t||e;return!!(r&&r.indexOf("Electron")>=0)}var vY=ve(()=>{});function Lc(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||UL()}var bY=ve(()=>{vY()});function xY(t){return!t&&!Lc()?"Node":UL(t)?"Electron":(t||zme.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}var Ume=ve(()=>{bY();vY();_Y()});var wY,Qy=ve(()=>{_Y();bY();Ume();wY="4.1.0"});function sBe(t){try{let e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch{return null}}var VL,Vme=ve(()=>{VL=class{constructor(e,r,i="sessionStorage"){this.storage=sBe(i),this.id=e,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){let r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let e={};if(this.storage){let r=this.storage.getItem(this.id);e=r?JSON.parse(r):{}}return Object.assign(this.config,e),this}}});function jme(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function $me(t,e=8){let r=Math.max(e-t.length,0);return`${" ".repeat(r)}${t}`}var Wme=ve(()=>{});function Gme(t){return typeof t!="string"?t:(t=t.toUpperCase(),jL[t]||jL.WHITE)}function Hme(t,e,r){return!Lc&&typeof t=="string"&&(e&&(t=`\x1B[${Gme(e)}m${t}\x1B[39m`),r&&(t=`\x1B[${Gme(r)+aBe}m${t}\x1B[49m`)),t}var jL,aBe,qme=ve(()=>{Qy();(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(jL||(jL={}));aBe=10});function Yme(t,e=["constructor"]){let r=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(r),n=t;for(let o of i){let s=n[o];typeof s=="function"&&(e.find(a=>o===a)||(n[o]=s.bind(t)))}}var Xme=ve(()=>{});function LC(t,e){if(!t)throw new Error(e||"Assertion failed")}var Zme=ve(()=>{});function F1(){let t;if(Lc()&&NL.performance)t=NL?.performance?.now?.();else if("hrtime"in zL){let e=zL?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}var Kme=ve(()=>{Qy()});function r3(){}function tge(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return LC(Number.isFinite(e)&&e>=0),e}function ege(t){let{logLevel:e,message:r}=t;t.logLevel=tge(e);let i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==r;);switch(typeof e){case"string":case"function":r!==void 0&&i.unshift(r),t.message=e;break;case"object":Object.assign(t,e);break;default:}typeof t.message=="function"&&(t.message=t.message());let n=typeof t.message;return LC(n==="string"||n==="object"),Object.assign(t,{args:i},t.opts)}function cBe(t,e,r){if(typeof e=="string"){let i=r.time?$me(jme(r.total)):"";e=r.time?`${t}: ${i}  ${e}`:`${t}: ${e}`,e=Hme(e,r.color,r.background)}return e}function uBe(t){for(let e in t)for(let r in t[e])return r||"untitled";return"empty"}var t3,lBe,Qme,Jme,wu,SY=ve(()=>{Qy();Vme();Wme();qme();Xme();Zme();Kme();t3={debug:Lc()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},lBe={enabled:!0,level:0};Qme={},Jme={once:!0},wu=class{constructor({id:e}={id:""}){this.VERSION=wY,this._startTs=F1(),this._deltaTs=F1(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new VL(`__probe-${this.id}__`,lBe),this.timeStamp(`${this.id} started`),Yme(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((F1()-this._startTs).toPrecision(10))}getDelta(){return Number((F1()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,r){this._storage.setConfiguration({[e]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,r){if(!e)throw new Error(r||"Assertion failed")}warn(e){return this._getLogFunction(0,e,t3.warn,arguments,Jme)}error(e){return this._getLogFunction(0,e,t3.error,arguments)}deprecated(e,r){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(e,r){return this.error(`\`${e}\` has been removed. Use \`${r}\` instead`)}probe(e,r){return this._getLogFunction(e,r,t3.log,arguments,{time:!0,once:!0})}log(e,r){return this._getLogFunction(e,r,t3.debug,arguments)}info(e,r){return this._getLogFunction(e,r,console.info,arguments)}once(e,r){return this._getLogFunction(e,r,t3.debug||t3.info,arguments,Jme)}table(e,r,i){return r?this._getLogFunction(e,r,console.table||r3,i&&[i],{tag:uBe(r)}):r3}time(e,r){return this._getLogFunction(e,r,console.time?console.time:console.info)}timeEnd(e,r){return this._getLogFunction(e,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,r){return this._getLogFunction(e,r,console.timeStamp||r3)}group(e,r,i={collapsed:!1}){let n=ege({logLevel:e,message:r,opts:i}),{collapsed:o}=i;return n.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,r,i={}){return this.group(e,r,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||r3)}withGroup(e,r,i){this.group(e,r)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=tge(e)}_getLogFunction(e,r,i,n,o){if(this._shouldLog(e)){o=ege({logLevel:e,message:r,args:n,opts:o}),i=i||o.method,LC(i),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=F1();let s=o.tag||o.message;if(o.once&&s)if(!Qme[s])Qme[s]=F1();else return r3;return r=cBe(this.id,o.message,o),i.bind(console,r,...o.args)}return r3}};wu.VERSION=wY});var rge=ve(()=>{globalThis.probe={}});var Dkt,BC=ve(()=>{SY();SY();rge();Dkt=new wu({id:"@probe.gl/log"})});function zC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){let e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}var zY=ve(()=>{});var z1,UY=ve(()=>{zY();z1=class{constructor(e,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=zC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(zC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}});var Su,hge=ve(()=>{UY();Su=class{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,r="count"){return this._getOrCreate({name:e,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(let e of Object.values(this.stats))e.reset();return this}forEach(e){for(let r of Object.values(this.stats))e(r)}getTable(){let e={};return this.forEach(r=>{e[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(r=>this._getOrCreate(r))}_getOrCreate(e){let{name:r,type:i}=e,n=this.stats[r];return n||(e instanceof z1?n=e:n=new z1(r,i),this.stats[r]=n),n}}});var n3=ve(()=>{hge();UY();zY()});var pX,e7,mX=ve(()=>{n3();pX=class{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Su({id:e})),this.stats.get(e)}},e7=new pX});var Pt,fg=ve(()=>{BC();Pt=new wu({id:"luma.gl"})});function t_(t="id"){gX[t]=gX[t]||1;let e=gX[t]++;return`${t}-${e}`}var gX,KC=ve(()=>{gX={}});function qFe(t,e){let r={...e};for(let i in t)t[i]!==void 0&&(r[i]=t[i]);return r}var Fi,Fc=ve(()=>{KC();Fi=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,r,i){if(!e)throw new Error("no device");this._device=e,this.props=qFe(r,i);let n=this.props.id!=="undefined"?this.props.id:t_(this[Symbol.toStringTag]);this.props.id=n,this.id=n,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(let e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){let e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(e,r=this[Symbol.toStringTag]){let i=this._device.statsManager.getStats("Resource Counts");i.get("GPU Memory").addCount(e),i.get(`${r} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){let r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){let e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${r}s Created`).incrementCount(),e.get(`${r}s Active`).incrementCount()}}});var vn,t7=ve(()=>{Fc();vn=class t extends Fi{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,r){let i={...r};(r.usage||0)&t.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data,super(e,i,t.defaultProps),this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,r,i){let n=ArrayBuffer.isView(e)?e.buffer:e,o=Math.min(e?e.byteLength:i,t.DEBUG_DATA_MAX_LENGTH);n===null?this.debugData=new ArrayBuffer(o):r===0&&i===n.byteLength?this.debugData=n.slice(0,o):this.debugData=n.slice(r,r+o)}static defaultProps={...Fi.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}}});function QC(t){let[e,r,i]=yX[t],n=t.includes("norm"),o=!n&&!t.startsWith("float"),s=t.startsWith("s");return{signedType:e,primitiveType:r,byteLength:i,normalized:n,integer:o,signed:s}}function AX(t){let e=t;switch(e){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return e}}function SAe(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}function W1(t){let e=ArrayBuffer.isView(t)?t.constructor:t;if(e===Uint8ClampedArray)return"uint8";let r=Object.values(yX).find(i=>e===i[4]);if(!r)throw new Error(e.name);return r[0]}function G1(t){let[,,,,e]=yX[t];return e}var yX,JC=ve(()=>{yX={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]}});function c3(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);let[r,i]=t.split("x"),n=r,o=i?parseInt(i):1,s=QC(n),a={type:n,components:o,byteLength:s.byteLength*o,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(a.webglOnly=!0),a}function TAe(t,e,r){let i=r?AX(t):t;switch(i){case"unorm8":return e===1?"unorm8":e===3?"unorm8x3-webgl":`${i}x${e}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(e===1||e===3)throw new Error(`size: ${e}`);return`${i}x${e}`;default:return e===1?i:`${i}x${e}`}}function _X(t,e,r){if(!e||e>4)throw new Error(`size ${e}`);let i=e,n=W1(t);return TAe(n,i,r)}function MAe(t){let e;switch(t.primitiveType){case"f32":e="float32";break;case"i32":e="sint32";break;case"u32":e="uint32";break;case"f16":return t.components<=2?"float16x2":"float16x4"}return t.components===1?e:`${e}x${t.components}`}var r7=ve(()=>{JC()});function SX(t){let e=QFe[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}var nc,yo,d0,YFe,i7,vX,n7,bX,XFe,xX,e5,wX,o7,EAe,ZFe,KFe,QFe,CAe=ve(()=>{nc="texture-compression-bc",yo="texture-compression-astc",d0="texture-compression-etc2",YFe="texture-compression-etc1-webgl",i7="texture-compression-pvrtc-webgl",vX="texture-compression-atc-webgl",n7="float32-renderable-webgl",bX="float16-renderable-webgl",XFe="rgb9e5ufloat-renderable-webgl",xX="snorm8-renderable-webgl",e5="norm16-renderable-webgl",wX="snorm16-renderable-webgl",o7="float32-filterable",EAe="float16-filterable-webgl";ZFe={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:xX},rg8snorm:{render:xX},"rgb8snorm-webgl":{},rgba8snorm:{render:xX},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:e5},rg16unorm:{render:e5},"rgb16unorm-webgl":{f:e5},rgba16unorm:{render:e5},r16snorm:{f:wX},rg16snorm:{render:wX},"rgb16snorm-webgl":{f:e5},rgba16snorm:{render:wX},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:bX,filter:"float16-filterable-webgl"},rg16float:{render:bX,filter:EAe},rgba16float:{render:bX,filter:EAe},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:n7,filter:o7},rg32float:{render:!1,filter:o7},"rgb32float-webgl":{render:n7,filter:o7},rgba32float:{render:n7,filter:o7},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:XFe},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:n7},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},KFe={"bc1-rgb-unorm-webgl":{f:nc},"bc1-rgb-unorm-srgb-webgl":{f:nc},"bc1-rgba-unorm":{f:nc},"bc1-rgba-unorm-srgb":{f:nc},"bc2-rgba-unorm":{f:nc},"bc2-rgba-unorm-srgb":{f:nc},"bc3-rgba-unorm":{f:nc},"bc3-rgba-unorm-srgb":{f:nc},"bc4-r-unorm":{f:nc},"bc4-r-snorm":{f:nc},"bc5-rg-unorm":{f:nc},"bc5-rg-snorm":{f:nc},"bc6h-rgb-ufloat":{f:nc},"bc6h-rgb-float":{f:nc},"bc7-rgba-unorm":{f:nc},"bc7-rgba-unorm-srgb":{f:nc},"etc2-rgb8unorm":{f:d0},"etc2-rgb8unorm-srgb":{f:d0},"etc2-rgb8a1unorm":{f:d0},"etc2-rgb8a1unorm-srgb":{f:d0},"etc2-rgba8unorm":{f:d0},"etc2-rgba8unorm-srgb":{f:d0},"eac-r11unorm":{f:d0},"eac-r11snorm":{f:d0},"eac-rg11unorm":{f:d0},"eac-rg11snorm":{f:d0},"astc-4x4-unorm":{f:yo},"astc-4x4-unorm-srgb":{f:yo},"astc-5x4-unorm":{f:yo},"astc-5x4-unorm-srgb":{f:yo},"astc-5x5-unorm":{f:yo},"astc-5x5-unorm-srgb":{f:yo},"astc-6x5-unorm":{f:yo},"astc-6x5-unorm-srgb":{f:yo},"astc-6x6-unorm":{f:yo},"astc-6x6-unorm-srgb":{f:yo},"astc-8x5-unorm":{f:yo},"astc-8x5-unorm-srgb":{f:yo},"astc-8x6-unorm":{f:yo},"astc-8x6-unorm-srgb":{f:yo},"astc-8x8-unorm":{f:yo},"astc-8x8-unorm-srgb":{f:yo},"astc-10x5-unorm":{f:yo},"astc-10x5-unorm-srgb":{f:yo},"astc-10x6-unorm":{f:yo},"astc-10x6-unorm-srgb":{f:yo},"astc-10x8-unorm":{f:yo},"astc-10x8-unorm-srgb":{f:yo},"astc-10x10-unorm":{f:yo},"astc-10x10-unorm-srgb":{f:yo},"astc-12x10-unorm":{f:yo},"astc-12x10-unorm-srgb":{f:yo},"astc-12x12-unorm":{f:yo},"astc-12x12-unorm-srgb":{f:yo},"pvrtc-rgb4unorm-webgl":{f:i7},"pvrtc-rgba4unorm-webgl":{f:i7},"pvrtc-rbg2unorm-webgl":{f:i7},"pvrtc-rgba2unorm-webgl":{f:i7},"etc1-rbg-unorm-webgl":{f:YFe},"atc-rgb-unorm-webgl":{f:vX},"atc-rgba-unorm-webgl":{f:vX},"atc-rgbai-unorm-webgl":{f:vX}},QFe={...ZFe,...KFe}});function PAe(t){let e=tNe(t);if(pg.isCompressed(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;let i=rNe(t);i&&(e.blockWidth=i.blockWidth,e.blockHeight=i.blockHeight)}let r=eNe.exec(t);if(r){let[,i,n,o,s,a]=r,u=`${o}${n}`,p=QC(u),m=p.byteLength*8,x=i.length,M=[m,x>=2?m:0,x>=3?m:0,x>=4?m:0];e={format:t,attachment:e.attachment,dataType:p.signedType,components:x,channels:i,integer:p.integer,signed:p.signed,normalized:p.normalized,bitsPerChannel:M,bytesPerPixel:p.byteLength*i.length,packed:e.packed,srgb:e.srgb},a==="-webgl"&&(e.webgl=!0),s==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function tNe(t){let e=SX(t),r=e.bytesPerPixel||1,i=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:r,bitsPerChannel:i,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function rNe(t){let r=/.*-(\d+)x(\d+)-.*/.exec(t);if(r){let[,i,n]=r;return{blockWidth:Number(i),blockHeight:Number(n)}}return null}var JFe,eNe,s7,pg,TX=ve(()=>{JC();CAe();JFe=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],eNe=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/,s7=class{getInfo(e){return PAe(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return JFe.some(r=>e.startsWith(r))}getCapabilities(e){let r=SX(e),i={format:e,create:r.f??!0,render:r.render??!0,filter:r.filter??!0,blend:r.blend??!0,store:r.store??!0},n=PAe(e),o=e.startsWith("depth")||e.startsWith("stencil"),s=n?.signed,a=n?.integer,u=n?.webgl;return i.render&&=!s,i.filter&&=!o&&!s&&!a&&!u,i}},pg=new s7});function IAe(t){return typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof VideoFrame<"u"&&t instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}function kAe(t){if(typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height};if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)return{width:t.naturalWidth,height:t.naturalHeight};if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)return{width:t.videoWidth,height:t.videoHeight};if(typeof VideoFrame<"u"&&t instanceof VideoFrame)return{width:t.displayWidth,height:t.displayHeight};throw new Error("Unknown image type")}var RAe=ve(()=>{});var t5,r5,Df,MX=ve(()=>{mX();fg();KC();t7();r7();TX();RAe();t5=class{},r5=class{features;disabledFeatures;constructor(e=[],r){this.features=new Set(e),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}},Df=class t{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,r)=>{},onResize:(e,r)=>{let[i,n]=e.getDevicePixelSize();Pt.log(1,`${e} resized => ${i}x${n}px`)()},onPositionChange:(e,r)=>{let[i,n]=e.getPosition();Pt.log(1,`${e} repositioned => ${i},${n}`)()},onVisibilityChange:e=>Pt.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,r)=>Pt.log(1,`${e} DPR changed ${r.oldRatio} => ${e.devicePixelRatio}`)(),debug:Pt.get("debug")||void 0,debugShaders:Pt.get("debug-shaders")||void 0,debugFramebuffers:!!Pt.get("debug-framebuffers"),debugFactories:!!Pt.get("debug-factories"),debugWebGL:!!Pt.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0};get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=e7;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...t.defaultProps,...e},this.id=this.props.id||t_(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return c3(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return pg.getInfo(e)}getTextureFormatCapabilities(e){let r=this._textureCaps[e];if(!r){let i=this._getDeviceTextureFormatCapabilities(e);r=this._getDeviceSpecificTextureFormatCapabilities(i),this._textureCaps[e]=r}return r}getMipLevelCount(e,r,i=1){let n=Math.max(e,r,i);return 1+Math.floor(Math.log2(n))}isExternalImage(e){return IAe(e)}getExternalImageSize(e){return kAe(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return pg.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,r,...i){return this.props.onError(e,r)?()=>{}:Pt.error(e.message,r,...i)}debug(){if(this.props.debug)debugger;else Pt.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',
or create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,r){throw new Error("not implemented")}readPixelsToBufferWebGL(e,r){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,r){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){let r=pg.getCapabilities(e),i=o=>(typeof o=="string"?this.features.has(o):o)??!0,n=i(r.create);return{format:e,create:n,render:n&&i(r.render),filter:n&&i(r.filter),blend:n&&i(r.blend),store:n&&i(r.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});let r={...e};if((e.usage||0)&vn.INDEX&&(e.indexType||(e.data instanceof Uint32Array?r.indexType="uint32":e.data instanceof Uint16Array&&(r.indexType="uint16")),!r.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return r}}});var iNe,OAe,EX,u3,DAe=ve(()=>{MX();mX();fg();iNe="set luma.log.level=1 (or higher) to trace rendering",OAe="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",EX=class t{static defaultProps={...Df.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=e7;log=Pt;VERSION="9.2.2";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw Pt.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),Pt.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");Pt.error("This version of luma.gl has already been initialized")()}Pt.log(1,`${this.VERSION} - ${iNe}`)(),globalThis.luma=this}async createDevice(e={}){let r={...t.defaultProps,...e},i=this.selectAdapter(r.type,r.adapters);if(!i)throw new Error(OAe);return r.waitForPageLoad&&await i.pageLoaded,await i.create(r)}async attachDevice(e,r){let i=this._getTypeFromHandle(e,r.adapters),n=i&&this.selectAdapter(i,r.adapters);if(!n)throw new Error(OAe);return await n?.attach?.(e,r)}registerAdapters(e){for(let r of e)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(e=[]){let r=this._getAdapterMap(e);return Array.from(r).map(([,i])=>i).filter(i=>i.isSupported?.()).map(i=>i.type)}getBestAvailableAdapterType(e=[]){let r=["webgpu","webgl","null"],i=this._getAdapterMap(e);for(let n of r)if(i.get(n)?.isSupported?.())return n;return null}selectAdapter(e,r=[]){let i=e;e==="best-available"&&(i=this.getBestAvailableAdapterType(r));let n=this._getAdapterMap(r);return i&&n.get(i)||null}enforceWebGL2(e=!0,r=[]){let n=this._getAdapterMap(r).get("webgl");n||Pt.warn("enforceWebGL2: webgl adapter not found")(),n?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(t.defaultProps,e)}_getAdapterMap(e=[]){let r=new Map(this.preregisteredAdapters);for(let i of e)r.set(i.type,i);return r}_getTypeFromHandle(e,r=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?Pt.warn("WebGL1 is not supported",e)():Pt.warn("Unknown handle type",e)(),null)}},u3=new EX});function sNe(){return a7||(oNe()||typeof window>"u"?a7=Promise.resolve():a7=new Promise(t=>window.addEventListener("load",()=>t()))),a7}var i5,nNe,oNe,a7,LAe=ve(()=>{Qy();i5=class{get pageLoaded(){return sNe()}},nNe=Lc()&&typeof document<"u",oNe=()=>nNe&&document.readyState==="complete",a7=null});function BAe(){let t,e;return{promise:new Promise((i,n)=>{t=i,e=n}),resolve:t,reject:e}}var FAe=ve(()=>{});function aNe(t){if(typeof t=="string"){let e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}return t||document.body}function lNe(t){let e=document.getElementById(t);if(!h3.isHTMLCanvas(e))throw new Error("Object is not a canvas element");return e}function cNe(t){let{width:e,height:r}=t,i=document.createElement("canvas");i.id=t_("lumagl-auto-created-canvas"),i.width=e||1,i.height=r||1,i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(r)?`${r}px`:"100%",t?.visible||(i.style.visibility="hidden");let n=aNe(t?.container||null);return n.insertBefore(i,n.firstChild),i}function uNe(t,e,r,i,n){let o=t,s=NAe(o[0],e,r),a=zAe(o[1],e,i,n),u=NAe(o[0]+1,e,r),p=u===r-1?u:u-1;u=zAe(o[1]+1,e,i,n);let m;return n?(u=u===0?u:u+1,m=a,a=u):m=u===i-1?u:u-1,{x:s,y:a,width:Math.max(p-s+1,1),height:Math.max(m-a+1,1)}}function NAe(t,e,r){return Math.min(Math.round(t*e),r-1)}function zAe(t,e,r,i){return i?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}var h3,UAe=ve(()=>{Qy();KC();FAe();h3=class t{static isHTMLCanvas(e){return typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=BAe();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...t.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,Lc()?e.canvas?typeof e.canvas=="string"?this.canvas=lNe(e.canvas):this.canvas=e.canvas:this.canvas=cNe(e):this.canvas={width:e.width||1,height:e.height||1},t.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):t.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],t.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(r=>this._handleIntersection(r)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(r=>this._handleResize(r));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){let e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,r){this.canvas.width=e,this.canvas.height=r,this.drawingBufferWidth=e,this.drawingBufferHeight=r}getDevicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}cssToDevicePixels(e,r=!0){let i=this.cssToDeviceRatio(),[n,o]=this.getDrawingBufferSize();return uNe(e,i,n,o,r)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){let[e,r]=this.getDevicePixelSize();return e/r}cssToDeviceRatio(){try{let[e]=this.getDrawingBufferSize(),[r]=this.getCSSSize();return r?e/r:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}_handleIntersection(e){let r=e.find(n=>n.target===this.canvas);if(!r)return;let i=r.isIntersecting;this.isVisible!==i&&(this.isVisible=i,this.device.props.onVisibilityChange(this))}_handleResize(e){let r=e.find(u=>u.target===this.canvas);if(!r)return;this.cssWidth=r.contentBoxSize[0].inlineSize,this.cssHeight=r.contentBoxSize[0].blockSize;let i=this.getDevicePixelSize(),n=r.devicePixelContentBoxSize?.[0].inlineSize||r.contentBoxSize[0].inlineSize*devicePixelRatio,o=r.devicePixelContentBoxSize?.[0].blockSize||r.contentBoxSize[0].blockSize*devicePixelRatio,[s,a]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(n,s)),this.devicePixelHeight=Math.max(1,Math.min(o,a)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:i})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels=="number"){let e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){let e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){let r=setInterval(()=>{this.destroyed?clearInterval(r):this.updatePosition()},e)}updatePosition(){let e=this.htmlCanvas?.getBoundingClientRect();if(e){let r=[e.left,e.top];if(this._position??=r,r[0]!==this._position[0]||r[1]!==this._position[1]){let n=this._position;this._position=r,this.device.props.onPositionChange?.(this,{oldPosition:n})}}}}});var Lf,CX=ve(()=>{Fc();Lf=class t extends Fi{static defaultProps={...Fi.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,r){r=t.normalizeProps(e,r),super(e,r,t.defaultProps)}static normalizeProps(e,r){return r}}});var hNe,ps,PX=ve(()=>{Fc();CX();fg();hNe={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"},ps=class t extends Fi{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,r){if(r=t.normalizeProps(e,r),super(e,r,t.defaultProps),this.dimension=this.props.dimension,this.baseDimension=hNe[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(e.isExternalImage(r.data)){let i=e.getExternalImageSize(r.data);this.width=i?.width||1,this.height=i?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&Pt.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof Lf?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,r){let i={...r},{width:n,height:o}=i;return typeof n=="number"&&(i.width=Math.max(1,Math.ceil(n))),typeof o=="number"&&(i.height=Math.max(1,Math.ceil(o))),i}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){let{width:r,height:i,depth:n}=this,o={...t.defaultCopyDataOptions,width:r,height:i,depth:n,...e},s=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!s.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return o.bytesPerRow=e.bytesPerRow||r*(s.bytesPerPixel||4),o.rowsPerImage=e.rowsPerImage||i,o}_normalizeCopyExternalImageOptions(e){let r=this.device.getExternalImageSize(e.image),i={...t.defaultCopyExternalImageOptions,...r,...e};return i.width=Math.min(i.width,this.width-i.x),i.height=Math.min(i.height,this.height-i.y),i}static defaultProps={...Fi.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:t.TEXTURE|t.RENDER_ATTACHMENT|t.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}}});var H1,VAe=ve(()=>{Fc();H1=class t extends Fi{get[Symbol.toStringTag](){return"TextureView"}constructor(e,r){super(e,r,t.defaultProps)}static defaultProps={...Fi.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}});function jAe(t,e,r){let i="",n=e.split(/\r?\n/),o=t.slice().sort((s,a)=>s.lineNum-a.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let a=1;a<=n.length;a++)for(i+=$Ae(n[a-1],a,r);o.length>s&&o[s].lineNum===a;){let u=o[s++];i+=IX(u,n,u.lineNum,{...r,inlineSource:!1})}for(;o.length>s;){let a=o[s++];i+=IX(a,[],0,{...r,inlineSource:!1})}return i;case"issues":case"no":for(let a of t)i+=IX(a,n,a.lineNum,{inlineSource:r?.showSourceCode!=="no"});return i}}function IX(t,e,r,i){if(i?.inlineSource){let o=dNe(e,r),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${o}${s}${t.type.toUpperCase()}: ${t.message}

`}let n=t.type==="error"?"red":"#8B4000";return i?.html?`<div class='luma-compiler-log-error' style="color:${n};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function dNe(t,e,r){let i="";for(let n=e-2;n<=e;n++){let o=t[n-1];o!==void 0&&(i+=$Ae(o,e,r))}return i}function $Ae(t,e,r){let i=r?.html?pNe(t):t;return`${fNe(String(e),4)}: ${i}${r?.html?"<br/>":`
`}`}function fNe(t,e){let r="";for(let i=t.length;i<e;++i)r+=" ";return r+t}function pNe(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}var WAe=ve(()=>{});function mNe(t){return gNe(t.source)||t.id||t_(`unnamed ${t.stage}-shader`)}function gNe(t,e="unnamed"){let i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return i?i[1]:e}var q1,GAe=ve(()=>{Fc();KC();WAe();q1=class t extends Fi{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,r){r={...r,debugShaders:r.debugShaders||e.props.debugShaders||"errors"},super(e,{id:mNe(r),...r},t.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){let e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break;case"warnings":case"always":break}let r=await this.getCompilationInfo();e==="warnings"&&r?.length===0||this._displayShaderLog(r,this.id)}_displayShaderLog(e,r){if(typeof document>"u"||!document?.createElement)return;let i=r,n=`${this.stage} shader "${i}"`,o=jAe(e,this.source,{showSourceCode:"all",html:!0}),s=this.getTranslatedSource();s&&(o+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);let a=document.createElement("Button");a.innerHTML=`
<h1>Compilation error in ${n}</h1><br /><br />
<code style="user-select:text;"><pre>
${o}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),a.onclick=()=>{let p=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(p)}}static defaultProps={...Fi.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}}});var Y1,HAe=ve(()=>{Fc();PX();fg();Y1=class t extends Fi{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,r={}){super(e,r,t.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){let r=this.colorAttachments.map(n=>n.texture.clone(e)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:i})}resize(e){let r=!e;if(e){let[i,n]=Array.isArray(e)?e:[e.width,e.height];r=r||n!==this.height||i!==this.width,this.width=i,this.height=n}r&&(Pt.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,i)=>{if(typeof r=="string"){let n=this.createColorTexture(r,i);return this.attachResource(n),n.view}return r instanceof ps?r.view:r});let e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){let r=this.createDepthStencilTexture(e);this.attachResource(r),this.depthStencilAttachment=r.view}else e instanceof ps?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:ps.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:ps.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){let n=this.colorAttachments[i].texture.clone({width:e,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=n.view,this.attachResource(n.view)}if(this.depthStencilAttachment){let i=this.depthStencilAttachment.texture.clone({width:e,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}static defaultProps={...Fi.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}});var Bf,qAe=ve(()=>{Fc();Bf=class t extends Fi{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,r){super(e,r,t.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...Fi.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}});var n5,YAe=ve(()=>{Fc();n5=class t extends Fi{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return"RenderPass"}constructor(e,r){r=t.normalizeProps(e,r),super(e,r,t.defaultProps)}static normalizeProps(e,r){return r}static defaultProps={...Fi.defaultProps,framebuffer:null,parameters:void 0,clearColor:t.defaultClearColor,clearColors:void 0,clearDepth:t.defaultClearDepth,clearStencil:t.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}});var d3,XAe=ve(()=>{Fc();d3=class t extends Fi{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,r){super(e,r,t.defaultProps),this.shaderLayout=r.shaderLayout}static defaultProps={...Fi.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}});var o5,ZAe=ve(()=>{Fc();o5=class t extends Fi{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,r){super(e,r,t.defaultProps)}static defaultProps={...Fi.defaultProps,measureExecutionTime:void 0}}});var s5,KAe=ve(()=>{Fc();s5=class t extends Fi{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,r){super(e,r,t.defaultProps)}static defaultProps={...Fi.defaultProps}}});function a5(t){return _Ne[t]}function kX(t){let[e,r]=yNe[t],i=e==="i32"||e==="u32",n=e!=="u32",o=ANe[e]*r;return{primitiveType:e,components:r,byteLength:o,integer:i,signed:n}}var ANe,yNe,_Ne,vNe,p7t,l7=ve(()=>{ANe={f32:4,f16:2,i32:4,u32:4},yNe={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},_Ne={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}},vNe={vec2i:"vec2<i32>",vec3i:"vec3<i32>",vec4i:"vec4<i32>",vec2u:"vec2<u32>",vec3u:"vec3<u32>",vec4u:"vec4<u32>",vec2f:"vec2<f32>",vec3f:"vec3<f32>",vec4f:"vec4<f32>",vec2h:"vec2<f16>",vec3h:"vec3<f16>",vec4h:"vec4<f16>"},p7t={...vNe,mat2x2f:"mat2x2<f32>",mat2x3f:"mat2x3<f32>",mat2x4f:"mat2x4<f32>",mat3x2f:"mat3x2<f32>",mat3x3f:"mat3x3<f32>",mat3x4f:"mat3x4<f32>",mat4x2f:"mat4x2<f32>",mat4x3f:"mat4x3<f32>",mat4x4f:"mat4x4<f32>",mat2x2i:"mat2x2<i32>",mat2x3i:"mat2x3<i32>",mat2x4i:"mat2x4<i32>",mat3x2i:"mat3x2<i32>",mat3x3i:"mat3x3<i32>",mat3x4i:"mat3x4<i32>",mat4x2i:"mat4x2<i32>",mat4x3i:"mat4x3<i32>",mat4x4i:"mat4x4<i32>",mat2x2u:"mat2x2<u32>",mat2x3u:"mat2x3<u32>",mat2x4u:"mat2x4<u32>",mat3x2u:"mat3x2<u32>",mat3x3u:"mat3x3<u32>",mat3x4u:"mat3x4<u32>",mat4x2u:"mat4x2<u32>",mat4x3u:"mat4x3<u32>",mat4x4u:"mat4x4<u32>",mat2x2h:"mat2x2<f16>",mat2x3h:"mat2x3<f16>",mat2x4h:"mat2x4<f16>",mat3x2h:"mat3x2<f16>",mat3x3h:"mat3x3<f16>",mat3x4h:"mat3x4<f16>",mat4x2h:"mat4x2<f16>",mat4x3h:"mat4x3<f16>",mat4x4h:"mat4x4<f16>"}});function c7(t,e){let r={};for(let i of t.attributes){let n=bNe(t,e,i.name);n&&(r[i.name]=n)}return r}function QAe(t,e,r=16){let i=c7(t,e),n=new Array(r).fill(null);for(let o of Object.values(i))n[o.location]=o;return n}function bNe(t,e,r){let i=xNe(t,r),n=wNe(e,r);if(!i)return null;let o=kX(i.type),s=MAe(o),a=n?.vertexFormat||s,u=c3(a);return{attributeName:n?.attributeName||i.name,bufferName:n?.bufferName||i.name,location:i.location,shaderType:i.type,primitiveType:o.primitiveType,shaderComponents:o.components,vertexFormat:a,bufferDataType:u.type,bufferComponents:u.components,normalized:u.normalized,integer:o.integer,stepMode:n?.stepMode||i.stepMode||"vertex",byteOffset:n?.byteOffset||0,byteStride:n?.byteStride||0}}function xNe(t,e){let r=t.attributes.find(i=>i.name===e);return r||Pt.warn(`shader layout attribute "${e}" not present in shader`),r||null}function wNe(t,e){SNe(t);let r=TNe(t,e);return r||(r=MNe(t,e),r)?r:(Pt.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function SNe(t){for(let e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&Pt.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function TNe(t,e){for(let r of t)if(r.format&&r.name===e)return{attributeName:r.name,bufferName:e,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function MNe(t,e){for(let r of t){let i=r.byteStride;if(typeof r.byteStride!="number")for(let o of r.attributes||[]){let s=c3(o.format);i+=s.byteLength}let n=r.attributes?.find(o=>o.attribute===e);if(n)return{attributeName:n.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:n.format,byteOffset:n.byteOffset,byteStride:i}}return null}var RX=ve(()=>{fg();l7();r7()});var l5,JAe=ve(()=>{RX();Fc();l5=class t extends Fi{static defaultProps={...Fi.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,r){super(e,r,t.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=QAe(r.shaderLayout,r.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,r){this.device.reportError(new Error("constant attributes not supported"),this)()}}});var c5,eye=ve(()=>{Fc();c5=class t extends Fi{static defaultProps={...Fi.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,r){super(e,r,t.defaultProps)}}});var u5,tye=ve(()=>{Fc();u5=class t extends Fi{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,r){super(e,r,t.defaultProps)}static defaultProps={...Fi.defaultProps,type:void 0,count:void 0}}});function OX(t){return(!u7||u7.byteLength<t)&&(u7=new ArrayBuffer(t)),u7}function DX(t,e){let r=OX(t.BYTES_PER_ELEMENT*e);return new t(r,0,e)}var u7,LX=ve(()=>{});function ENe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function f3(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":ENe(t)}var BX=ve(()=>{});var CNe,h7,rye=ve(()=>{JC();l7();LX();BX();fg();CNe=1024,h7=class{layout={};byteLength;constructor(e,r={}){let i=0;for(let[o,s]of Object.entries(e)){let a=a5(s),{type:u,components:p}=a,m=p*(r?.[o]??1);i=SAe(i,m);let x=i;i+=m,this.layout[o]={type:u,size:m,offset:x}}i+=(4-i%4)%4;let n=i*4;this.byteLength=Math.max(n,CNe)}getData(e){let r=OX(this.byteLength),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(let[n,o]of Object.entries(e)){let s=this.layout[n];if(!s){Pt.warn(`Supplied uniform value ${n} not present in uniform block layout`)();continue}let{type:a,size:u,offset:p}=s,m=i[a];if(u===1){if(typeof o!="number"&&typeof o!="boolean"){Pt.warn(`Supplied value for single component uniform ${n} is not a number: ${o}`)();continue}m[p]=Number(o)}else{if(!f3(o)){Pt.warn(`Supplied value for multi component / array uniform ${n} is not a numeric array: ${o}`)();continue}m.set(o,p)}}return new Uint8Array(r,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}});function iye(t,e,r=16){if(t!==e)return!1;let i=t,n=e;if(!f3(i))return!1;if(f3(n)&&i.length===n.length){for(let o=0;o<i.length;++o)if(n[o]!==i[o])return!1}return!0}function nye(t){return f3(t)?t.slice():t}var oye=ve(()=>{BX()});var d7,sye=ve(()=>{oye();d7=class{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){let r=e?.shaderLayout.bindings?.find(n=>n.type==="uniform"&&n.name===e?.name);if(!r)throw new Error(e?.name);let i=r;for(let n of i.uniforms||[])this.bindingLayout[n.name]=n}}setUniforms(e){for(let[r,i]of Object.entries(e))this._setUniform(r,i),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${i}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,r){iye(this.uniforms[e],r)||(this.uniforms[e]=nye(r),this.modifiedUniforms[e]=!0,this.modified=!0)}}});var h5,aye=ve(()=>{t7();fg();sye();rye();h5=class{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(let[r,i]of Object.entries(e)){let n=r,o=new h7(i.uniformTypes??{},i.uniformSizes??{});this.uniformBufferLayouts.set(n,o);let s=new d7({name:r});s.setUniforms(i.defaultUniforms||{}),this.uniformBlocks.set(n,s)}}destroy(){for(let e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(let[r,i]of Object.entries(e))this.uniformBlocks.get(r)?.setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){let r=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(r)}createUniformBuffer(e,r,i){i&&this.setUniforms(i);let n=this.getUniformBufferByteLength(r),o=e.createBuffer({usage:vn.UNIFORM|vn.COPY_DST,byteLength:n}),s=this.getUniformBufferData(r);return o.write(s),o}getManagedUniformBuffer(e,r){if(!this.uniformBuffers.get(r)){let i=this.getUniformBufferByteLength(r),n=e.createBuffer({usage:vn.UNIFORM|vn.COPY_DST,byteLength:i});this.uniformBuffers.set(r,n)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let e=!1;for(let r of this.uniformBlocks.keys()){let i=this.updateUniformBuffer(r);e||=i}return e&&Pt.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){let r=this.uniformBlocks.get(e),i=this.uniformBuffers.get(e),n=!1;if(i&&r?.needsRedraw){n||=r.needsRedraw;let o=this.getUniformBufferData(e);i=this.uniformBuffers.get(e),i?.write(o);let s=this.uniformBlocks.get(e)?.getAllUniforms();Pt.log(4,`Writing to uniform buffer ${String(e)}`,o,s)()}return n}}});var Vi=ve(()=>{DAe();LAe();MX();UAe();t7();PX();VAe();GAe();CX();HAe();qAe();YAe();XAe();ZAe();KAe();JAe();eye();tye();aye();JC();l7();r7();TX();fg();LX();RX()});var f_,Ove=ve(()=>{(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(f_||(f_={}))});var Dve=ve(()=>{Ove()});function Lve(t=!0){let e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(r,i){if(r==="webgl"||r==="experimental-webgl"){let n=this.originalGetContext("webgl2",i);return n instanceof HTMLElement&&oWe(n),n}return this.originalGetContext(r,i)}}function oWe(t){t.getExtension("EXT_color_buffer_float");let e={...tWe,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:rWe(t),OES_vertex_array_object:iWe(t),ANGLE_instanced_arrays:nWe(t)},r=t.getExtension;t.getExtension=function(n){let o=r.call(t,n);return o||(n in e?e[n]:null)};let i=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(i.apply(t)||[])?.concat(Object.keys(e))}}var tWe,rWe,iWe,nWe,Bve=ve(()=>{tWe={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},rWe=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),iWe=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),nWe=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}})});async function N9(t,e){let r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");let i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",t),e&&(i.id=e),new Promise((n,o)=>{i.onload=n,i.onerror=s=>o(new Error(`Unable to load script '${t}': ${s}`)),r.appendChild(i)})}var PK=ve(()=>{});async function Nve(t){if(!globalThis.SPECTOR)try{await N9(t.debugSpectorJSUrl||z9.debugSpectorJSUrl)}catch(e){Pt.warn(String(e))}}function zve(t){if(t={...z9,...t},!t.debugSpectorJS)return null;if(!Eh&&globalThis.SPECTOR&&!globalThis.luma?.spector){Pt.probe(sWe,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();let{Spector:e}=globalThis.SPECTOR;Eh=new e,globalThis.luma&&(globalThis.luma.spector=Eh)}if(!Eh)return null;if(Fve||(Fve=!0,Eh.spyCanvases(),Eh?.onCaptureStarted.add(e=>Pt.info("Spector capture started:",e)()),Eh?.onCapture.add(e=>{Pt.info("Spector capture complete:",e)(),Eh?.getResultUI(),Eh?.resultView.display(),Eh?.resultView.addCapture(e)})),t.gl){let e=t.gl,r=e.device;Eh?.startCapture(t.gl,500),e.device=r,new Promise(i=>setTimeout(i,2e3)).then(i=>{Pt.info("Spector capture stopped after 2 seconds")(),Eh?.stopCapture()})}return Eh}var sWe,Eh,Fve,z9,IK=ve(()=>{Vi();PK();sWe=1,Eh=null,Fve=!1,z9={debugSpectorJS:Pt.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0}});function Vve(t){return t.luma=t.luma||{},t.luma}async function jve(){Lc()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await N9(aWe))}function $ve(t,e={}){return e.debugWebGL||e.traceWebGL?cWe(t,e):lWe(t)}function lWe(t){let e=Vve(t);return e.realContext?e.realContext:t}function cWe(t,e){if(!globalThis.WebGLDebugUtils)return Pt.warn("webgl-debug not loaded")(),t;let r=Vve(t);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...f_,...t});let i=globalThis.WebGLDebugUtils.makeDebugContext(t,uWe.bind(null,e),hWe.bind(null,e));for(let s in f_)!(s in i)&&typeof f_[s]=="number"&&(i[s]=f_[s]);class n{}Object.setPrototypeOf(i,Object.getPrototypeOf(t)),Object.setPrototypeOf(n,i);let o=Object.create(n);return r.realContext=t,r.debugContext=o,o.debug=!0,o}function Uve(t,e){e=Array.from(e).map(i=>i===void 0?"undefined":i);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${t}(${r})`}function uWe(t,e,r,i){i=Array.from(i).map(a=>a===void 0?"undefined":a);let n=globalThis.WebGLDebugUtils.glEnumToString(e),o=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,i),s=`${n} in gl.${r}(${o})`;Pt.error(s)();debugger}function hWe(t,e,r){let i="";Pt.level>=1&&(i=Uve(e,r),t.traceWebGL&&Pt.log(1,i)());for(let n of r)if(n===void 0){i=i||Uve(e,r);debugger}}var aWe,kK=ve(()=>{Vi();Dve();Qy();PK();aWe="https://unpkg.com/webgl-debug@2.0.1/index.js"});function RK(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ls(t,e,r){return e[t]!==void 0?e[t]:r[t]}var oP,Sa,Wve,Ch,Gve,nP,Hve,qve,OK,v0,DK,Yve,LK=ve(()=>{oP={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Sa=(t,e,r)=>e?t.enable(r):t.disable(r),Wve=(t,e,r)=>t.hint(r,e),Ch=(t,e,r)=>t.pixelStorei(r,e),Gve=(t,e,r)=>{let i=r===36006?36009:36008;return t.bindFramebuffer(i,e)},nP=(t,e,r)=>{let n={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];t.bindBuffer(n,e)};Hve={3042:Sa,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Sa,2885:(t,e)=>t.cullFace(e),2929:Sa,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Sa,35723:Wve,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:Gve,36010:Gve,34964:nP,36662:nP,36663:nP,35053:nP,35055:nP,2886:(t,e)=>t.frontFace(e),33170:Wve,2849:(t,e)=>t.lineWidth(e),32823:Sa,32824:"polygonOffset",10752:"polygonOffset",35977:Sa,32926:Sa,32928:Sa,32938:"sampleCoverage",32939:"sampleCoverage",3089:Sa,3088:(t,e)=>t.scissor(...e),2960:Sa,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:Sa,10754:Sa,12288:Sa,12289:Sa,12290:Sa,12291:Sa,12292:Sa,12293:Sa,12294:Sa,12295:Sa,3333:Ch,3317:Ch,37440:Ch,37441:Ch,37443:Ch,3330:Ch,3332:Ch,3331:Ch,3314:Ch,32878:Ch,3316:Ch,3315:Ch,32877:Ch,framebuffer:(t,e)=>{let r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{let r=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...r)},blendFunc:(t,e)=>{let r=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...r)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=RK(e)?e:[e,e];let[r,i]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=RK(e)&&e.length===3?[...e,...e]:e;let[r,i,n,o,s,a]=e;t.stencilFuncSeparate(1028,r,i,n),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=RK(e)&&e.length===3?[...e,...e]:e;let[r,i,n,o,s,a]=e;t.stencilOpSeparate(1028,r,i,n),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};qve={blendEquation:(t,e,r)=>t.blendEquationSeparate(Ls(32777,e,r),Ls(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(Ls(32969,e,r),Ls(32968,e,r),Ls(32971,e,r),Ls(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(Ls(32824,e,r),Ls(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(Ls(32938,e,r),Ls(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,Ls(2962,e,r),Ls(2967,e,r),Ls(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,Ls(34816,e,r),Ls(36003,e,r),Ls(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,Ls(2964,e,r),Ls(2965,e,r),Ls(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,Ls(34817,e,r),Ls(34818,e,r),Ls(34819,e,r))},OK={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,r)=>t({36007:r}),bindTransformFeedback:(t,e,r)=>t({36389:r}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},bindBuffer:(t,e,r)=>{let i={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return i?t({[i]:r}):{valueChanged:!0}},blendColor:(t,e,r,i,n)=>t({32773:new Float32Array([e,r,i,n])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,i,n)=>t({32969:e,32968:r,32971:i,32970:n}),clearColor:(t,e,r,i,n)=>t({3106:new Float32Array([e,r,i,n])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,i,n)=>t({3107:[e,r,i,n]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,i,n)=>t({3088:new Int32Array([e,r,i,n])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[e===1028?2968:36005]:r}),stencilFunc:(t,e,r,i)=>t({2962:e,2967:r,2963:i,34816:e,36003:r,36004:i}),stencilFuncSeparate:(t,e,r,i,n)=>t({[e===1028?2962:34816]:r,[e===1028?2967:36003]:i,[e===1028?2963:36004]:n}),stencilOp:(t,e,r,i)=>t({2964:e,2965:r,2966:i,34817:e,34818:r,34819:i}),stencilOpSeparate:(t,e,r,i,n)=>t({[e===1028?2964:34817]:r,[e===1028?2965:34818]:i,[e===1028?2966:34819]:n}),viewport:(t,e,r,i,n)=>t({2978:[e,r,i,n]})},v0=(t,e)=>t.isEnabled(e),DK={3042:v0,2884:v0,2929:v0,3024:v0,32823:v0,32926:v0,32928:v0,3089:v0,2960:v0,35977:v0},Yve=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068])});function Hf(t,e){if(dWe(e))return;let r={};for(let n in e){let o=Number(n),s=Hve[n];s&&(typeof s=="string"?r[s]=!0:s(t,e[n],o))}let i=t.state&&t.state.cache;if(i)for(let n in r){let o=qve[n];o(t,e,i)}}function U9(t,e=oP){if(typeof e=="number"){let n=e,o=DK[n];return o?o(t,n):t.getParameter(n)}let r=Array.isArray(e)?e:Object.keys(e),i={};for(let n of r){let o=DK[n];i[n]=o?o(t,Number(n)):t.getParameter(Number(n))}return i}function Xve(t){Hf(t,oP)}function dWe(t){for(let e in t)return!1;return!0}var $3=ve(()=>{LK()});function Kve(t,e){if(t===e)return!0;if(Zve(t)&&Zve(e)&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function Zve(t){return Array.isArray(t)||ArrayBuffer.isView(t)}var Qve=ve(()=>{});function Jve(t,e){let r=t[e].bind(t);t[e]=function(n){if(n===void 0||Yve.has(n))return r(n);let o=qf.get(t);return n in o.cache||(o.cache[n]=r(n)),o.enable?o.cache[n]:r(n)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function fWe(t,e,r){if(!t[e])return;let i=t[e].bind(t);t[e]=function(...o){let s=qf.get(t),{valueChanged:a,oldValue:u}=r(s._updateCache,...o);return a&&i(...o),u},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function pWe(t){let e=t.useProgram.bind(t);t.useProgram=function(i){let n=qf.get(t);n.program!==i&&(e(i),n.program=i)}}var qf,BK=ve(()=>{$3();Qve();LK();qf=class{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,r){this.gl=e,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){let e=this.stateStack[this.stateStack.length-1];Hf(this.gl,e),this.stateStack.pop()}trackState(e,r){if(this.cache=r?.copyState?U9(e):Object.assign({},oP),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,pWe(e);for(let i in OK){let n=OK[i];fWe(e,i,n)}Jve(e,"getParameter"),Jve(e,"isEnabled")}_updateCache(e){let r=!1,i,n=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(let o in e){let s=e[o],a=this.cache[o];Kve(s,a)||(r=!0,i=a,n&&!(o in n)&&(n[o]=a),this.cache[o]=s)}return{valueChanged:r,oldValue:i}}}});function e1e(t,e,r){let i="",n={preserveDrawingBuffer:!0,...r},o=null;if(o||=t.getContext("webgl2",n),n.failIfMajorPerformanceCaveat&&(i||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!o&&!r.failIfMajorPerformanceCaveat&&(n.failIfMajorPerformanceCaveat=!1,o=t.getContext("webgl2",n),o.luma||={},o.luma.softwareRenderer=!0),o||(o=t.getContext("webgl",{}),o&&(o=null,i||="Your browser only supports WebGL1")),!o)throw i||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${i}`);let{onContextLost:s,onContextRestored:a}=e;return t.addEventListener("webglcontextlost",u=>s(u),!1),t.addEventListener("webglcontextrestored",u=>a(u),!1),o.luma||={},o}var t1e=ve(()=>{});function b0(t,e,r){return r[e]===void 0&&(r[e]=t.getExtension(e)||null),r[e]}var sP=ve(()=>{});function r1e(t,e){let r=t.getParameter(7936),i=t.getParameter(7937);b0(t,"WEBGL_debug_renderer_info",e);let n=e.WEBGL_debug_renderer_info,o=t.getParameter(n?n.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(n?n.UNMASKED_RENDERER_WEBGL:7937),a=o||r,u=s||i,p=t.getParameter(7938),m=i1e(a,u),x=mWe(a,u),M=gWe(a,u);return{type:"webgl",gpu:m,gpuType:M,gpuBackend:x,vendor:a,renderer:u,version:p,shadingLanguage:"glsl",shadingLanguageVersion:300}}function i1e(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function mWe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function gWe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(i1e(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}var n1e=ve(()=>{sP()});function V9(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}var FK=ve(()=>{});function a1e(t){return t in j9}function l1e(t,e,r){return(j9[e]||[]).every(n=>b0(t,n,r))}function c1e(t,e,r){let i=e.create,n=NK[e.format];return n?.gl===void 0&&(i=!1),n?.x&&(i=i&&!!b0(t,n.x,r)),{format:e.format,create:i&&e.create,render:i&&e.render,filter:i&&e.filter,blend:i&&e.blend,store:i&&e.store}}function $9(t){let e=NK[t],r=SWe(t),i=pg.getInfo(t);return i.compressed&&(e.dataFormat=r),{internalFormat:r,format:e?.dataFormat||wWe(i.channels,i.integer,i.normalized,r),type:i.dataType?V9(i.dataType):e?.types?.[0]||5121,compressed:i.compressed||!1}}function u1e(t){switch(pg.getInfo(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function wWe(t,e,r,i){if(i===6408||i===6407)return i;switch(t){case"r":return e&&!r?36244:6403;case"rg":return e&&!r?33320:33319;case"rgb":return e&&!r?36248:6407;case"rgba":return e&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function SWe(t){let r=NK[t]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${t}`);return r}var aP,lP,W3,G3,AWe,yWe,_We,vWe,bWe,o1e,s1e,xWe,j9,NK,H3=ve(()=>{Vi();sP();FK();aP="WEBGL_compressed_texture_s3tc",lP="WEBGL_compressed_texture_s3tc_srgb",W3="EXT_texture_compression_rgtc",G3="EXT_texture_compression_bptc",AWe="WEBGL_compressed_texture_etc",yWe="WEBGL_compressed_texture_astc",_We="WEBGL_compressed_texture_etc1",vWe="WEBGL_compressed_texture_pvrtc",bWe="WEBGL_compressed_texture_atc",o1e="EXT_texture_norm16",s1e="EXT_render_snorm",xWe="EXT_color_buffer_float",j9={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[s1e],"norm16-renderable-webgl":[o1e],"snorm16-renderable-webgl":[o1e,s1e],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[aP,lP,W3,G3],"texture-compression-bc5-webgl":[W3],"texture-compression-bc7-webgl":[G3],"texture-compression-etc2":[AWe],"texture-compression-astc":[yWe],"texture-compression-etc1-webgl":[_We],"texture-compression-pvrtc-webgl":[vWe],"texture-compression-atc-webgl":[bWe]};NK={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:xWe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:aP},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:lP},"bc1-rgba-unorm":{gl:33777,x:aP},"bc1-rgba-unorm-srgb":{gl:35916,x:lP},"bc2-rgba-unorm":{gl:33778,x:aP},"bc2-rgba-unorm-srgb":{gl:35918,x:lP},"bc3-rgba-unorm":{gl:33779,x:aP},"bc3-rgba-unorm-srgb":{gl:35919,x:lP},"bc4-r-unorm":{gl:36283,x:W3},"bc4-r-snorm":{gl:36284,x:W3},"bc5-rg-unorm":{gl:36285,x:W3},"bc5-rg-snorm":{gl:36286,x:W3},"bc6h-rgb-ufloat":{gl:36495,x:G3},"bc6h-rgb-float":{gl:36494,x:G3},"bc7-rgba-unorm":{gl:36492,x:G3},"bc7-rgba-unorm-srgb":{gl:36493,x:G3},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}}});var h1e,W9,d1e=ve(()=>{Vi();sP();H3();h1e={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"},W9=class extends r5{gl;extensions;testedFeatures=new Set;constructor(e,r,i){super([],i),this.gl=e,this.extensions=r,b0(e,"EXT_color_buffer_float",r)}*[Symbol.iterator](){let e=this.getFeatures();for(let r of e)this.has(r)&&(yield r);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),a1e(e)&&l1e(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){let e=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(let r of e)this.has(r)}getFeatures(){return[...Object.keys(h1e),...Object.keys(j9)]}getWebGLFeature(e){let r=h1e[e];return typeof r=="string"?!!b0(this.gl,r,this.extensions):!!r}}});var G9,f1e=ve(()=>{Vi();G9=class extends t5{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}});function TWe(t){return t<34069?t+34069:t}function MWe(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}var x0,H9=ve(()=>{Vi();H3();x0=class extends Y1{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,r){super(e,r);let i=r.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){let e=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){let i=this.colorAttachments[r];if(i){let n=36064+r;this._attachTextureView(n,i)}}if(this.depthStencilAttachment){let r=u1e(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){let r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${MWe(r)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,r){let{gl:i}=this.device,{texture:n}=r,o=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(i.bindTexture(n.glTarget,n.handle),n.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,e,n.handle,o,s);break;case 34067:let a=TWe(s);i.framebufferTexture2D(36160,e,a,n.handle,o);break;case 3553:i.framebufferTexture2D(36160,e,3553,n.handle,o);break;default:throw new Error("Illegal texture type")}i.bindTexture(n.glTarget,null)}}});var q9,p1e=ve(()=>{Vi();H9();q9=class extends h3{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,r){super(r),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new x0(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}});function m1e(t="id"){zK[t]=zK[t]||1;let e=zK[t]++;return`${t}-${e}`}var zK,g1e=ve(()=>{zK={}});function EWe(t){return t&vn.INDEX?34963:t&vn.VERTEX?34962:t&vn.UNIFORM?35345:34962}function CWe(t){return t&vn.INDEX||t&vn.VERTEX?35044:t&vn.UNIFORM?35048:35044}var Yf,Y9=ve(()=>{Vi();Yf=class extends vn{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,r={}){super(e,r),this.device=e,this.gl=this.device.gl;let i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=EWe(this.props.usage),this.glUsage=CWe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,r=0,i=e.byteLength+r){let n=this.glTarget;this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,i,this.glUsage),this.gl.bufferSubData(n,r,e),this.gl.bindBuffer(n,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(e,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(e){let r=e;e===0&&(r=new Float32Array(0));let i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,r=0){let i=ArrayBuffer.isView(e)?e:new Uint8Array(e),n=0,o=void 0,s=36663;this.gl.bindBuffer(s,this.handle),n!==0||o!==void 0?this.gl.bufferSubData(s,r,i,n,o):this.gl.bufferSubData(s,r,i),this.gl.bindBuffer(s,null),this._setDebugData(e,r,e.byteLength)}async mapAndWriteAsync(e,r=0,i=this.byteLength-r){let n=new ArrayBuffer(i);await e(n,"copied"),this.write(n,r)}async readAsync(e=0,r){return this.readSyncWebGL(e,r)}async mapAndReadAsync(e,r=0,i){let n=await this.readAsync(r,i);return await e(n.buffer,"copied")}readSyncWebGL(e=0,r){r=r??this.byteLength-e;let i=new Uint8Array(r),n=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,i,n,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,e,r),i}}});function y1e(t){let e=t.split(/\r?\n/),r=[];for(let i of e){if(i.length<=1)continue;let n=i.split(":");if(n.length===2){let[x,M]=n;r.push({message:M.trim(),type:A1e(x),lineNum:0,linePos:0});continue}let[o,s,a,...u]=n,p=parseInt(a,10);isNaN(p)&&(p=0);let m=parseInt(s,10);isNaN(m)&&(m=0),r.push({message:u.join(":").trim(),type:A1e(o),lineNum:p,linePos:m})}return r}function A1e(t){let e=["warning","error","info"],r=t.toLowerCase();return e.includes(r)?r:"info"}var _1e=ve(()=>{});var X9,v1e=ve(()=>{Vi();_1e();X9=class extends q1{device;handle;constructor(e,r){switch(super(e,r),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){let e=this.device.gl.getShaderInfoLog(this.handle);return e?y1e(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;let{gl:r}=this.device;if(r.shaderSource(this.handle,e),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}Pt.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Pt.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){let e=async n=>await new Promise(o=>setTimeout(o,n));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}let{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}});function x1e(t,e,r,i){if(RWe(e))return i(t);let n=t;n.pushState();try{return PWe(t,e),Hf(n.gl,r),i(t)}finally{n.popState()}}function PWe(t,e){let r=t,{gl:i}=r;if(e.cullMode)switch(e.cullMode){case"none":i.disable(2884);break;case"front":i.enable(2884),i.cullFace(1028);break;case"back":i.enable(2884),i.cullFace(1029);break}if(e.frontFace&&i.frontFace(fb("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&i.enable(34383),e.depthBias!==void 0&&(i.enable(32823),i.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){let o=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=fb("provokingVertex",e.provokingVertex,{first:36429,last:36430});o?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){let o=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=fb("polygonMode",e.polygonMode,{fill:6914,line:6913});o?.polygonModeWEBGL(1028,s),o?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&i.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&i.enable(12288),e.clipDistance1&&i.enable(12289),e.clipDistance2&&i.enable(12290),e.clipDistance3&&i.enable(12291),e.clipDistance4&&i.enable(12292),e.clipDistance5&&i.enable(12293),e.clipDistance6&&i.enable(12294),e.clipDistance7&&i.enable(12295)),e.depthWriteEnabled!==void 0&&i.depthMask(kWe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?i.enable(2929):i.disable(2929),i.depthFunc(K9("depthCompare",e.depthCompare))),e.stencilWriteMask){let n=e.stencilWriteMask;i.stencilMaskSeparate(1028,n),i.stencilMaskSeparate(1029,n)}if(e.stencilReadMask&&Pt.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){let n=e.stencilReadMask||4294967295,o=K9("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?i.enable(2960):i.disable(2960),i.stencilFuncSeparate(1028,o,0,n),i.stencilFuncSeparate(1029,o,0,n)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){let n=UK("stencilPassOperation",e.stencilPassOperation),o=UK("stencilFailOperation",e.stencilFailOperation),s=UK("stencilDepthFailOperation",e.stencilDepthFailOperation);i.stencilOpSeparate(1028,o,s,n),i.stencilOpSeparate(1029,o,s,n)}switch(e.blend){case!0:i.enable(3042);break;case!1:i.disable(3042);break;default:}if(e.blendColorOperation||e.blendAlphaOperation){let n=b1e("blendColorOperation",e.blendColorOperation||"add"),o=b1e("blendAlphaOperation",e.blendAlphaOperation||"add");i.blendEquationSeparate(n,o);let s=Z9("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=Z9("blendColorDstFactor",e.blendColorDstFactor||"zero"),u=Z9("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),p=Z9("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");i.blendFuncSeparate(s,a,u,p)}}function K9(t,e){return fb(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function UK(t,e){return fb(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function b1e(t,e){return fb(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Z9(t,e,r="color"){return fb(t,e,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:r==="color"?32769:32771,"one-minus-constant":r==="color"?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function IWe(t,e){return`Illegal parameter ${e} for ${t}`}function fb(t,e,r){if(!(e in r))throw new Error(IWe(t,e));return r[e]}function kWe(t,e){return e}function RWe(t){let e=!0;for(let r in t){e=!1;break}return e}var VK=ve(()=>{Vi();$3()});function Q9(t){let e={};return t.addressModeU&&(e[10242]=jK(t.addressModeU)),t.addressModeV&&(e[10243]=jK(t.addressModeV)),t.addressModeW&&(e[32882]=jK(t.addressModeW)),t.magFilter&&(e[10240]=$K(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=OWe(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=K9("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function jK(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function $K(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function OWe(t,e="none"){if(!e)return $K(t);switch(e){case"none":return $K(t);case"nearest":switch(t){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(t){case"nearest":return 9986;case"linear":return 9987}}}var WK=ve(()=>{VK()});var J9,w1e=ve(()=>{Vi();WK();J9=class extends Lf{device;handle;parameters;constructor(e,r){super(e,r),this.device=e,this.parameters=Q9(r),this.handle=r.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(let[r,i]of Object.entries(e)){let n=Number(r);switch(n){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,n,i);break;default:this.device.gl.samplerParameteri(this.handle,n,i);break}}}}});function p_(t,e,r){if(DWe(e))return r(t);let{nocatch:i=!0}=e,n=qf.get(t);n.push(),Hf(t,e);let o;if(i)o=r(t),n.pop();else try{o=r(t)}finally{n.pop()}return o}function DWe(t){for(let e in t)return!1;return!0}var eB=ve(()=>{$3();BK()});var w0,GK=ve(()=>{Vi();w0=class extends H1{device;gl;handle;texture;constructor(e,r){super(e,{...ps.defaultProps,...r}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}});function LWe(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866;case"cube-array":break}throw new Error(t)}function S1e(t,e,r){return e==="cube"?34069+r:t}var S0,tB=ve(()=>{Vi();H3();WK();eB();GK();S0=class extends ps{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,r){super(e,r),this.device=e,this.gl=this.device.gl;let i=$9(this.props.format);this.glTarget=LWe(this.props.dimension),this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);let{dimension:n,width:o,height:s,depth:a,mipLevels:u,glTarget:p,glInternalFormat:m}=this;switch(n){case"2d":case"cube":this.gl.texStorage2D(p,u,m,o,s);break;case"2d-array":case"3d":this.gl.texStorage3D(p,u,m,o,s,a);break;default:throw new Error(n)}this.gl.bindTexture(this.glTarget,null),this._initializeData(r.data),this.setSampler(this.props.sampler),this.view=new w0(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new w0(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);let r=Q9(this.sampler.props);this._setSamplerParameters(r)}copyImageData(e){let r=this._normalizeCopyImageDataOptions(e),i=r.data,{width:n,height:o,depth:s}=this,{mipLevel:a=0,byteOffset:u=0,x:p=0,y:m=0,z:x=0}=r,{glFormat:M,glType:k,compressed:F}=this,j=S1e(this.glTarget,this.dimension,s),H=this.compressed?{}:{3314:r.bytesPerRow,32878:r.rowsPerImage};this.gl.bindTexture(j,this.handle),p_(this.gl,H,()=>{switch(this.dimension){case"2d":case"cube":F?this.gl.compressedTexSubImage2D(j,a,p,m,n,o,M,i,u):this.gl.texSubImage2D(j,a,p,m,n,o,M,k,i,u);break;case"2d-array":case"3d":F?this.gl.compressedTexSubImage3D(j,a,p,m,x,n,o,s,M,i,u):this.gl.texSubImage3D(j,a,p,m,x,n,o,s,M,k,i,u);break;default:}}),this.gl.bindTexture(j,null)}copyExternalImage(e){let r=this._normalizeCopyExternalImageOptions(e);if(r.sourceX||r.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");let{glFormat:i,glType:n}=this,{image:o,depth:s,mipLevel:a,x:u,y:p,z:m,width:x,height:M}=r,k=S1e(this.glTarget,this.dimension,s),F=r.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),p_(this.gl,F,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(k,a,u,p,x,M,i,n,o);break;case"2d-array":case"3d":this.gl.texSubImage3D(k,a,u,p,m,x,M,s,i,n,o);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:r.width,height:r.height}}generateMipmapsWebGL(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(Pt.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(i){Pt.warn(`Error generating mipmap for ${this}: ${i.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){Pt.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(let[r,i]of Object.entries(e)){let n=Number(r),o=i;switch(n){case 33082:case 33083:this.gl.texParameterf(this.glTarget,n,o);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,n,o);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,n,o);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,n,o);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,n,o);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){let{gl:r}=this;return e!==void 0&&(this._textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,this.handle),e}_unbind(e){let{gl:r}=this;return e!==void 0&&(this._textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,null),e}}});function T1e(t){return FWe[t]}function rB(t){return BWe[t]}function M1e(t){return!!C1e[t]}function E1e(t){return C1e[t]}var BWe,C1e,FWe,HK=ve(()=>{BWe={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},C1e={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},FWe={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126}});function P1e(t,e){let r={attributes:[],bindings:[]};r.attributes=NWe(t,e);let i=VWe(t,e);for(let a of i){let u=a.uniforms.map(p=>({name:p.name,format:p.format,byteOffset:p.byteOffset,byteStride:p.byteStride,arrayLength:p.arrayLength}));r.bindings.push({type:"uniform",name:a.name,group:0,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:u})}let n=UWe(t,e),o=0;for(let a of n)if(M1e(a.type)){let{viewDimension:u,sampleType:p}=E1e(a.type);r.bindings.push({type:"texture",name:a.name,group:0,location:o,viewDimension:u,sampleType:p}),a.textureUnit=o,o+=1}n.length&&(r.uniforms=n);let s=zWe(t,e);return s?.length&&(r.varyings=s),r}function NWe(t,e){let r=[],i=t.getProgramParameter(e,35721);for(let n=0;n<i;n++){let o=t.getActiveAttrib(e,n);if(!o)throw new Error("activeInfo");let{name:s,type:a}=o,u=t.getAttribLocation(e,s);if(u>=0){let p=rB(a),m=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:u,stepMode:m,type:p})}}return r.sort((n,o)=>n.location-o.location),r}function zWe(t,e){let r=[],i=t.getProgramParameter(e,35971);for(let n=0;n<i;n++){let o=t.getTransformFeedbackVarying(e,n);if(!o)throw new Error("activeInfo");let{name:s,type:a,size:u}=o,p=rB(a),{type:m,components:x}=a5(p);r.push({location:n,name:s,type:m,size:u*x})}return r.sort((n,o)=>n.location-o.location),r}function UWe(t,e){let r=[],i=t.getProgramParameter(e,35718);for(let n=0;n<i;n++){let o=t.getActiveUniform(e,n);if(!o)throw new Error("activeInfo");let{name:s,size:a,type:u}=o,{name:p,isArray:m}=jWe(s),x=t.getUniformLocation(e,p),M={location:x,name:p,size:a,type:u,isArray:m};if(r.push(M),M.size>1)for(let k=0;k<M.size;k++){let F=`${p}[${k}]`;x=t.getUniformLocation(e,F);let j={...M,name:F,location:x};r.push(j)}}return r}function VWe(t,e){let r=(o,s)=>t.getActiveUniformBlockParameter(e,o,s),i=[],n=t.getProgramParameter(e,35382);for(let o=0;o<n;o++){let s={name:t.getActiveUniformBlockName(e,o)||"",location:r(o,35391),byteLength:r(o,35392),vertex:r(o,35396),fragment:r(o,35398),uniformCount:r(o,35394),uniforms:[]},a=r(o,35395)||[],u=t.getActiveUniforms(e,a,35383),p=t.getActiveUniforms(e,a,35384),m=t.getActiveUniforms(e,a,35387),x=t.getActiveUniforms(e,a,35388);for(let M=0;M<s.uniformCount;++M){let k=t.getActiveUniform(e,a[M]);if(!k)throw new Error("activeInfo");let F=rB(u[M]);s.uniforms.push({name:k.name,format:F,type:u[M],arrayLength:p[M],byteOffset:m[M],byteStride:x[M]})}i.push(s)}return i.sort((o,s)=>o.location-s.location),i}function jWe(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};let r=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}var I1e=ve(()=>{Vi();HK()});function k1e(t,e,r,i){let n=t,o=i;o===!0&&(o=1),o===!1&&(o=0);let s=typeof o=="number"?[o]:o;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof i!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,i);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return n.uniform1uiv(e,s,1);case 36294:return n.uniform2uiv(e,s,2);case 36295:return n.uniform3uiv(e,s,3);case 36296:return n.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return n.uniformMatrix2x3fv(e,!1,s);case 35686:return n.uniformMatrix2x4fv(e,!1,s);case 35687:return n.uniformMatrix3x2fv(e,!1,s);case 35688:return n.uniformMatrix3x4fv(e,!1,s);case 35689:return n.uniformMatrix4x2fv(e,!1,s);case 35690:return n.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}var R1e=ve(()=>{});function O1e(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function D1e(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}var qK=ve(()=>{});function $We(t,e){let r={...t,attributes:t.attributes.map(i=>({...i}))};for(let i of e?.attributes||[]){let n=r.attributes.find(o=>o.name===i.name);n?(n.type=i.type||n.type,n.stepMode=i.stepMode||n.stepMode):Pt.warn(`shader layout attribute ${i.name} not present in shader`)}return r}var L1e,iB,B1e=ve(()=>{Vi();I1e();VK();R1e();Y9();H9();tB();GK();qK();L1e=4,iB=class extends Bf{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,r){super(e,r),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=r.vs,this.fs=r.fs;let{varyings:i,bufferMode:n=35981}=r;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,n)),this._linkShaders(),Pt.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=P1e(this.device.gl,this.handle),Pt.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=r.shaderLayout?$We(this.introspectedLayout,r.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,r){for(let[i,n]of Object.entries(e)){let o=this.shaderLayout.bindings.find(s=>s.name===i)||this.shaderLayout.bindings.find(s=>s.name===`${i}Uniforms`);if(!o){let s=this.shaderLayout.bindings.map(a=>`"${a.name}"`).join(", ");r?.disableWarnings||Pt.warn(`No binding "${i}" in render pipeline "${this.id}", expected one of ${s}`,n)();continue}switch(n||Pt.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(n instanceof Yf)&&!(n.buffer instanceof Yf))throw new Error("buffer value");break;case"texture":if(!(n instanceof w0||n instanceof S0||n instanceof x0))throw new Error(`${this} Bad texture binding for ${i}`);break;case"sampler":Pt.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(o.type)}this.bindings[i]=n}}draw(e){let{renderPass:r,parameters:i=this.props.parameters,topology:n=this.props.topology,vertexArray:o,vertexCount:s,instanceCount:a,isInstanced:u=!1,firstVertex:p=0,transformFeedback:m}=e,x=O1e(n),M=!!o.indexBuffer,k=o.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return Pt.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return Pt.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),m&&m.begin(this.props.topology),this._applyBindings(),this._applyUniforms();let F=r;return x1e(this.device,i,F.glParameters,()=>{M&&u?this.device.gl.drawElementsInstanced(x,s||0,k,p,a||0):M?this.device.gl.drawElements(x,s||0,k,p):u?this.device.gl.drawArraysInstanced(x,p,s||0,a||0):this.device.gl.drawArrays(x,p,s||0),m&&m.end()}),o.unbindAfterRender(r),!0}async _linkShaders(){let{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Pt.time(L1e,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),Pt.timeEnd(L1e,`linkProgram for ${this.id}`)(),Pt.level,!this.device.features.has("compilation-status-async-webgl")){let i=this._getLinkStatus();this._reportLinkStatus(i);return}Pt.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Pt.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();let r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(e){switch(e){case"success":return;default:let r=e==="link-error"?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${r} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader();break;case"success":break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${r} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader();break;case"success":break}let i=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${r} during ${e}: ${i}`),this)(),this.device.debug()}}_getLinkStatus(){let{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")}async _waitForLinkComplete(){let e=async n=>await new Promise(o=>setTimeout(o,n));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}let{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(let r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(Pt.warn(`Binding ${r.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;let{gl:e}=this.device;e.useProgram(this.handle);let r=0,i=0;for(let n of this.shaderLayout.bindings){let o=this.bindings[n.name]||this.bindings[n.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${n.name} in ${this.id}`);switch(n.type){case"uniform":let{name:s}=n,a=e.getUniformBlockIndex(this.handle,s);if(a===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,i,a),o instanceof Yf?e.bindBufferBase(35345,i,o.handle):e.bindBufferRange(35345,i,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),i+=1;break;case"texture":if(!(o instanceof w0||o instanceof S0||o instanceof x0))throw new Error("texture");let u;if(o instanceof w0)u=o.texture;else if(o instanceof S0)u=o;else if(o instanceof x0&&o.colorAttachments[0]instanceof w0)Pt.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),u=o.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+r),e.bindTexture(u.glTarget,u.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${n.type}' not supported in WebGL`)}}}_applyUniforms(){for(let e of this.shaderLayout.uniforms||[]){let{name:r,location:i,type:n,textureUnit:o}=e,s=this.uniforms[r]??o;s!==void 0&&k1e(this.device.gl,i,n,s)}}}});function WWe(t,e){let r=e.sourceBuffer,i=e.destinationBuffer;t.gl.bindBuffer(36662,r.handle),t.gl.bindBuffer(36663,i.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function GWe(t,e){throw new Error("Not implemented")}function HWe(t,e){let{sourceTexture:r,mipLevel:i=0,aspect:n="all",width:o=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:a=0,origin:u=[0,0],destinationBuffer:p,byteOffset:m=0,bytesPerRow:x,rowsPerImage:M}=e;if(n!=="all")throw new Error("aspect not supported in WebGL");if(i!==0||a!==0||x||M)throw new Error("not implemented");let{framebuffer:k,destroyFramebuffer:F}=F1e(r),j;try{let H=p,W=o||k.width,Z=s||k.height,Y=$9(k.colorAttachments[0].texture.props.format),ee=Y.format,ce=Y.type;t.gl.bindBuffer(35051,H.handle),j=t.gl.bindFramebuffer(36160,k.handle),t.gl.readPixels(u[0],u[1],W,Z,ee,ce,m)}finally{t.gl.bindBuffer(35051,null),j!==void 0&&t.gl.bindFramebuffer(36160,j),F&&k.destroy()}}function qWe(t,e){let{sourceTexture:r,destinationMipLevel:i=0,origin:n=[0,0],destinationOrigin:o=[0,0],destinationTexture:s}=e,{width:a=e.destinationTexture.width,height:u=e.destinationTexture.height}=e,{framebuffer:p,destroyFramebuffer:m}=F1e(r),[x,M]=n,[k,F,j]=o,H=t.gl.bindFramebuffer(36160,p.handle),W,Z;if(s instanceof S0)W=s,a=Number.isFinite(a)?a:W.width,u=Number.isFinite(u)?u:W.height,W._bind(0),Z=W.glTarget;else throw new Error("invalid destination");switch(Z){case 3553:case 34067:t.gl.copyTexSubImage2D(Z,i,k,F,x,M,a,u);break;case 35866:case 32879:t.gl.copyTexSubImage3D(Z,i,k,F,j,x,M,a,u);break;default:}W&&W._unbind(),t.gl.bindFramebuffer(36160,H),m&&p.destroy()}function F1e(t){if(t instanceof ps){let{width:e,height:r,id:i}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${i}`,width:e,height:r,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}var nB,N1e=ve(()=>{Vi();tB();H3();nB=class extends s5{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(let r of e)switch(r.name){case"copy-buffer-to-buffer":WWe(this.device,r.options);break;case"copy-buffer-to-texture":GWe(this.device,r.options);break;case"copy-texture-to-buffer":HWe(this.device,r.options);break;case"copy-texture-to-texture":qWe(this.device,r.options);break;default:throw new Error(r.name)}}}});var YWe,oB,z1e=ve(()=>{Vi();eB();$3();YWe=[1,2,4,8],oB=class extends n5{device;handle=null;glParameters={};constructor(e,r){super(e,r),this.device=e;let i;if(!r?.parameters?.viewport)if(r?.framebuffer){let{width:o,height:s}=r.framebuffer;i=[0,0,o,s]}else{let[o,s]=e.getDefaultCanvasContext().getDrawingBufferSize();i=[0,0,o,s]}this.device.pushState(),this.setParameters({viewport:i,...this.props.parameters});let n=this.props.framebuffer;if(this.props.framebuffer&&n?.handle){let o=this.props.framebuffer.colorAttachments.map((s,a)=>36064+a);this.device.gl.drawBuffers(o)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){let r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(r.viewport=e.viewport.slice(0,4),r.depthRange=[e.viewport[4],e.viewport[5]]):r.viewport=e.viewport),e.scissorRect&&(r.scissorTest=!0,r.scissor=e.scissorRect),e.blendConstant&&(r.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),r[2967]=e.stencilReference),"colorMask"in e&&(r.colorMask=YWe.map(i=>!!(i&e.colorMask))),this.glParameters=r,Hf(this.device.gl,r)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){let e={...this.glParameters},r=0;this.props.clearColors&&this.props.clearColors.forEach((i,n)=>{i&&this.clearColorBuffer(n,i)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,e.clearStencil=this.props.clearStencil),r!==0&&p_(this.device.gl,e,()=>{this.device.gl.clear(r)})}clearColorBuffer(e=0,r=[0,0,0,0]){p_(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}});var cP,U1e=ve(()=>{Vi();N1e();z1e();cP=class extends o5{device;handle=null;commandBuffer;constructor(e,r){super(e,r),this.device=e,this.commandBuffer=new nB(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new oB(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,r,i){}}});function V1e(t){let{target:e,source:r,start:i=0,count:n=1}=t,o=r.length,s=n*o,a=0;for(let u=i;a<o;a++)e[u++]=r[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s);return t.target}var j1e=ve(()=>{});function XWe(t){return Array.isArray(t)?new Float32Array(t):t}function ZWe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}var sB,$1e=ve(()=>{Vi();Qy();FK();j1e();sB=class t extends l5{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return xY()==="Chrome"}constructor(e,r){super(e,r),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){let r=e;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(e,r){let i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");let{size:n,type:o,stride:s,offset:a,normalized:u,integer:p,divisor:m}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),p?this.device.gl.vertexAttribIPointer(e,n,o,s,a):this.device.gl.vertexAttribPointer(e,n,o,u,s,a),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,m||0),this.attributes[e]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,r){this._enable(e,!1),this.attributes[e]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){let r=this.attributes[e];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(e,r)}}_getAccessor(e){let r=this.attributeInfos[e];if(!r)throw new Error(`Unknown attribute location ${e}`);let i=V9(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(e,r=!0){let n=t.isConstantAttributeZeroSupported(this.device)||e!==0;(r||n)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,r){let i=XWe(r),n=i.byteLength*e,o=i.length*e;if(this.buffer&&n!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${n} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:n}),s||=!ZWe(i,this.bufferValue),s){let a=DX(r.constructor,o);V1e({target:a,source:i,start:0,count:o}),this.buffer.write(a),this.bufferValue=r}return this.buffer}}});function W1e(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}var aB,G1e=ve(()=>{Vi();lB();qK();aB=class extends c5{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,r){super(e,r),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(D1e(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(let r in e)this.setBuffer(r,e[r])})}setBuffer(e,r){let i=this._getVaryingIndex(e),{buffer:n,byteLength:o,byteOffset:s}=this._getBufferRange(r);if(i<0){this.unusedBuffers[e]=n,Pt.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[i]={buffer:n,byteLength:o,byteOffset:s},this.bindOnUse||this._bindBuffer(i,n,s,o)}getBuffer(e){if(W1e(e))return this.buffers[e]||null;let r=this._getVaryingIndex(e);return r>=0?this.buffers[r]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let r;return this._bound?r=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof Yf)return{buffer:e,byteOffset:0,byteLength:e.byteLength};let{buffer:r,byteOffset:i=0,byteLength:n=e.buffer.byteLength}=e;return{buffer:r,byteOffset:i,byteLength:n}}_getVaryingIndex(e){if(W1e(e))return Number(e);for(let r of this.layout.varyings||[])if(e===r.name)return r.location;return-1}_bindBuffers(){for(let e in this.buffers){let{buffer:r,byteLength:i,byteOffset:n}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),r,n,i)}}_unbindBuffers(){for(let e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,r,i=0,n){let o=r&&r.handle;!o||n===void 0?this.gl.bindBufferBase(35982,e,o):this.gl.bindBufferRange(35982,e,o,i,n)}}});var cB,H1e=ve(()=>{Vi();cB=class extends u5{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,r){if(super(e,r),this.device=e,r.count>1)throw new Error("WebGL QuerySet can only have one value");let i=this.device.gl.createQuery();if(!i)throw new Error("WebGL query not supported");this.handle=i,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;let e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,n)=>{let o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>e?(n("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}});function YK(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function q1e(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}var Y1e=ve(()=>{});function X1e(t){return KWe[t]}var KWe,Z1e=ve(()=>{KWe={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"}});function K1e(t,e){let{sourceX:r=0,sourceY:i=0,sourceAttachment:n=0}=e||{},{target:o=null,sourceWidth:s,sourceHeight:a,sourceDepth:u,sourceFormat:p,sourceType:m}=e||{},{framebuffer:x,deleteFramebuffer:M}=J1e(t),{gl:k,handle:F}=x;s||=x.width,a||=x.height;let j=x.colorAttachments[n]?.texture;if(!j)throw new Error(`Invalid framebuffer attachment ${n}`);u=j?.depth||1,p||=j?.glFormat||6408,m||=j?.glType||5121,o=JWe(o,m,p,s,a,u);let H=W1(o);m=m||T1e(H);let W=k.bindFramebuffer(36160,F);return k.readBuffer(36064+n),k.readPixels(r,i,s,a,p,m,o),k.readBuffer(36064),k.bindFramebuffer(36160,W||null),M&&x.destroy(),o}function Q1e(t,e){let{target:r,sourceX:i=0,sourceY:n=0,sourceFormat:o=6408,targetByteOffset:s=0}=e||{},{sourceWidth:a,sourceHeight:u,sourceType:p}=e||{},{framebuffer:m,deleteFramebuffer:x}=J1e(t);a=a||m.width,u=u||m.height;let M=m;p=p||5121;let k=r;if(!k){let j=YK(o),H=q1e(p),W=s+a*u*j*H;k=M.device.createBuffer({byteLength:W})}let F=t.device.createCommandEncoder();return F.copyTextureToBuffer({sourceTexture:t,width:a,height:u,origin:[i,n],destinationBuffer:k,byteOffset:s}),F.destroy(),x&&m.destroy(),k}function J1e(t){return t instanceof Y1?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:QWe(t),deleteFramebuffer:!0}}function QWe(t,e){let{device:r,width:i,height:n,id:o}=t;return r.createFramebuffer({...e,id:`framebuffer-for-${o}`,width:i,height:n,colorAttachments:[t]})}function JWe(t,e,r,i,n,o){if(t)return t;e||=5121;let s=X1e(e),a=G1(s),u=YK(r);return new a(i*n*u)}var ebe=ve(()=>{Vi();HK();Y1e();Z1e()});var XK={};nl(XK,{WebGLDevice:()=>pb});function eGe(t,e,r){switch(r.length){case 1:t.gl.vertexAttrib1fv(e,r);break;case 2:t.gl.vertexAttrib2fv(e,r);break;case 3:t.gl.vertexAttrib3fv(e,r);break;case 4:t.gl.vertexAttrib4fv(e,r);break;default:}}function tGe(t,e,r){t.gl.vertexAttribI4iv(e,r)}function rGe(t,e,r){t.gl.vertexAttribI4uiv(e,r)}function iGe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}var pb,uB=ve(()=>{Vi();BK();t1e();n1e();d1e();f1e();p1e();IK();kK();H3();g1e();Y9();v1e();w1e();tB();H9();B1e();U1e();$1e();G1e();H1e();ebe();$3();eB();sP();pb=class extends Df{type="webgl";handle;features;limits;info;canvasContext;preferredColorFormat="rgba8unorm";preferredDepthFormat="depth24plus";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){switch(e){case"unorm8x4-bgra":return!1;default:return!0}}constructor(e){super({...e,id:e.id||m1e("webgl-device")});let r=Df._getCanvasContextProps(e);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let i=r.canvas?.gl?.device;if(i)throw new Error(`WebGL context already attached to device ${i.id}`);this.canvasContext=new q9(this,r),this.lost=new Promise(m=>{this._resolveContextLost=m});let n={...e.webgl};r.alphaMode==="premultiplied"&&(n.premultipliedAlpha=!0),e.powerPreference!==void 0&&(n.powerPreference=e.powerPreference);let s=this.props._handle||e1e(this.canvasContext.canvas,{onContextLost:m=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:m=>console.log("WebGL context restored")},n);if(!s)throw new Error("WebGL context creation failed");if(i=s.device,i){if(e._reuseDevices)return Pt.log(1,`Not creating a new Device, instead returning a reference to Device ${i.id} already attached to WebGL context`,i)(),i._reused=!0,i;throw new Error(`WebGL context already attached to device ${i.id}`)}this.handle=s,this.gl=s,this.spectorJS=zve({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=r1e(this.gl,this._extensions),this.limits=new G9(this.gl),this.features=new W9(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new qf(this.gl,{log:(...m)=>Pt.log(1,...m)()}).trackState(this.gl,{copyState:!1});let u=e.debugWebGL||e.debug,p=e.debugWebGL;u&&(this.gl=$ve(this.gl,{debugWebGL:u,traceWebGL:p}),Pt.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(Pt.level=Math.max(Pt.level,1))),this.commandEncoder=new cP(this,{id:`${this}-command-encoder`})}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){let r=this._normalizeBufferProps(e);return new Yf(this,r)}createTexture(e){return new S0(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new J9(this,e)}createShader(e){return new X9(this,e)}createFramebuffer(e){return new x0(this,e)}createVertexArray(e){return new sB(this,e)}createTransformFeedback(e){return new aB(this,e)}createQuerySet(e){return new cB(this,e)}createRenderPipeline(e){return new iB(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(e={}){return new cP(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,r){return K1e(e,r)}readPixelsToBufferWebGL(e,r){return Q1e(e,r)}setParametersWebGL(e){Hf(this.gl,e)}getParametersWebGL(e){return U9(this.gl,e)}withParametersWebGL(e,r){return p_(this.gl,e,r)}resetWebGL(){Pt.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Xve(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return c1e(this.gl,e,this._extensions)}loseDevice(){let e=!1,i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(e=!0,i.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){qf.get(this.gl).push()}popState(){qf.get(this.gl).pop()}getGLKey(e,r){let i=Number(e);for(let n in this.gl)if(this.gl[n]===i)return`GL.${n}`;return r?.emptyIfUnknown?"":String(e)}getGLKeys(e){let r={emptyIfUnknown:!0};return Object.entries(e).reduce((i,[n,o])=>(i[`${n}:${this.getGLKey(n,r)}`]=`${o}:${this.getGLKey(o,r)}`,i),{})}setConstantAttributeWebGL(e,r){let i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);let n=this._constants[e];switch(n&&iGe(n,r)&&Pt.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=r,r.constructor){case Float32Array:eGe(this,e,r);break;case Int32Array:tGe(this,e,r);break;case Uint32Array:rGe(this,e,r);break;default:throw new Error("constant")}}getExtension(e){return b0(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,r,i){e.luma=r;let n={props:i.spector,id:i.spector.id};e.__SPECTOR_Metadata=n}}});function nGe(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}var hB,ZK,uP,tbe=ve(()=>{Vi();Bve();IK();kK();hB=1,ZK=class extends i5{type="webgl";constructor(){super(),Df.defaultProps={...Df.defaultProps,...z9}}enforceWebGL2(e){Lve(e)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext&&Pt.warn("WebGL1 is not supported",e)(),!1)}async attach(e,r={}){let{WebGLDevice:i}=await Promise.resolve().then(()=>(uB(),XK));if(e instanceof i)return e;if(e?.device instanceof i)return e.device;if(!nGe(e))throw new Error("Invalid WebGL2RenderingContext");let n=r.createCanvasContext===!0?{}:r.createCanvasContext;return new i({...r,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...n}})}async create(e={}){let{WebGLDevice:r}=await Promise.resolve().then(()=>(uB(),XK));Pt.groupCollapsed(hB,"WebGLDevice created")();try{let i=[];(e.debugWebGL||e.debug)&&i.push(jve()),e.debugSpectorJS&&i.push(Nve(e));let n=await Promise.allSettled(i);for(let a of n)a.status==="rejected"&&Pt.error(`Failed to initialize debug libraries ${a.reason}`)();let o=new r(e),s=`${o._reused?"Reusing":"Created"} device with WebGL2 ${o.props.debug?"debug ":""}context: ${o.info.vendor}, ${o.info.renderer} for canvas: ${o.canvasContext.id}`;return Pt.probe(hB,s)(),Pt.table(hB,o.info)(),o}finally{Pt.groupEnd(hB)()}}};uP=new ZK});var lB=ve(()=>{tbe();uB();Y9()});var f3e=nr((Pur,UJ)=>{"use strict";UJ.exports=QF;UJ.exports.default=QF;function QF(t,e,r){r=r||2;var i=e&&e.length,n=i?e[0]*r:t.length,o=u3e(t,0,n,r,!0),s=[];if(!o||o.next===o.prev)return s;var a,u,p,m,x,M,k;if(i&&(o=TZe(t,e,o,r)),t.length>80*r){a=p=t[0],u=m=t[1];for(var F=r;F<n;F+=r)x=t[F],M=t[F+1],x<a&&(a=x),M<u&&(u=M),x>p&&(p=x),M>m&&(m=M);k=Math.max(p-a,m-u),k=k!==0?32767/k:0}return xI(o,s,r,a,u,k,0),s}function u3e(t,e,r,i,n){var o,s;if(n===zJ(t,e,r,i)>0)for(o=e;o<r;o+=i)s=c3e(o,t[o],t[o+1],s);else for(o=r-i;o>=e;o-=i)s=c3e(o,t[o],t[o+1],s);return s&&JF(s,s.next)&&(SI(s),s=s.next),s}function Hb(t,e){if(!t)return t;e||(e=t);var r=t,i;do if(i=!1,!r.steiner&&(JF(r,r.next)||vs(r.prev,r,r.next)===0)){if(SI(r),r=e=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==e);return e}function xI(t,e,r,i,n,o,s){if(t){!s&&o&&IZe(t,i,n,o);for(var a=t,u,p;t.prev!==t.next;){if(u=t.prev,p=t.next,o?xZe(t,i,n,o):bZe(t)){e.push(u.i/r|0),e.push(t.i/r|0),e.push(p.i/r|0),SI(t),t=p.next,a=p.next;continue}if(t=p,t===a){s?s===1?(t=wZe(Hb(t),e,r),xI(t,e,r,i,n,o,2)):s===2&&SZe(t,e,r,i,n,o):xI(Hb(t),e,r,i,n,o,1);break}}}}function bZe(t){var e=t.prev,r=t,i=t.next;if(vs(e,r,i)>=0)return!1;for(var n=e.x,o=r.x,s=i.x,a=e.y,u=r.y,p=i.y,m=n<o?n<s?n:s:o<s?o:s,x=a<u?a<p?a:p:u<p?u:p,M=n>o?n>s?n:s:o>s?o:s,k=a>u?a>p?a:p:u>p?u:p,F=i.next;F!==e;){if(F.x>=m&&F.x<=M&&F.y>=x&&F.y<=k&&ZS(n,a,o,u,s,p,F.x,F.y)&&vs(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function xZe(t,e,r,i){var n=t.prev,o=t,s=t.next;if(vs(n,o,s)>=0)return!1;for(var a=n.x,u=o.x,p=s.x,m=n.y,x=o.y,M=s.y,k=a<u?a<p?a:p:u<p?u:p,F=m<x?m<M?m:M:x<M?x:M,j=a>u?a>p?a:p:u>p?u:p,H=m>x?m>M?m:M:x>M?x:M,W=FJ(k,F,e,r,i),Z=FJ(j,H,e,r,i),Y=t.prevZ,ee=t.nextZ;Y&&Y.z>=W&&ee&&ee.z<=Z;){if(Y.x>=k&&Y.x<=j&&Y.y>=F&&Y.y<=H&&Y!==n&&Y!==s&&ZS(a,m,u,x,p,M,Y.x,Y.y)&&vs(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,ee.x>=k&&ee.x<=j&&ee.y>=F&&ee.y<=H&&ee!==n&&ee!==s&&ZS(a,m,u,x,p,M,ee.x,ee.y)&&vs(ee.prev,ee,ee.next)>=0))return!1;ee=ee.nextZ}for(;Y&&Y.z>=W;){if(Y.x>=k&&Y.x<=j&&Y.y>=F&&Y.y<=H&&Y!==n&&Y!==s&&ZS(a,m,u,x,p,M,Y.x,Y.y)&&vs(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;ee&&ee.z<=Z;){if(ee.x>=k&&ee.x<=j&&ee.y>=F&&ee.y<=H&&ee!==n&&ee!==s&&ZS(a,m,u,x,p,M,ee.x,ee.y)&&vs(ee.prev,ee,ee.next)>=0)return!1;ee=ee.nextZ}return!0}function wZe(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!JF(n,o)&&h3e(n,i,i.next,o)&&wI(n,o)&&wI(o,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(o.i/r|0),SI(i),SI(i.next),i=t=o),i=i.next}while(i!==t);return Hb(i)}function SZe(t,e,r,i,n,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&OZe(s,a)){var u=d3e(s,a);s=Hb(s,s.next),u=Hb(u,u.next),xI(s,e,r,i,n,o,0),xI(u,e,r,i,n,o,0);return}a=a.next}s=s.next}while(s!==t)}function TZe(t,e,r,i){var n=[],o,s,a,u,p;for(o=0,s=e.length;o<s;o++)a=e[o]*i,u=o<s-1?e[o+1]*i:t.length,p=u3e(t,a,u,i,!1),p===p.next&&(p.steiner=!0),n.push(RZe(p));for(n.sort(MZe),o=0;o<n.length;o++)r=EZe(n[o],r);return r}function MZe(t,e){return t.x-e.x}function EZe(t,e){var r=CZe(t,e);if(!r)return e;var i=d3e(r,t);return Hb(i,i.next),Hb(r,r.next)}function CZe(t,e){var r=e,i=t.x,n=t.y,o=-1/0,s;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var a=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o&&(o=a,s=r.x<r.next.x?r:r.next,a===i))return s}r=r.next}while(r!==e);if(!s)return null;var u=s,p=s.x,m=s.y,x=1/0,M;r=s;do i>=r.x&&r.x>=p&&i!==r.x&&ZS(n<m?i:o,n,p,m,n<m?o:i,n,r.x,r.y)&&(M=Math.abs(n-r.y)/(i-r.x),wI(r,t)&&(M<x||M===x&&(r.x>s.x||r.x===s.x&&PZe(s,r)))&&(s=r,x=M)),r=r.next;while(r!==u);return s}function PZe(t,e){return vs(t.prev,t,e.prev)<0&&vs(e.next,t,t.next)<0}function IZe(t,e,r,i){var n=t;do n.z===0&&(n.z=FJ(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,kZe(n)}function kZe(t){var e,r,i,n,o,s,a,u,p=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,i=r,a=0,e=0;e<p&&(a++,i=i.nextZ,!!i);e++);for(u=p;a>0||u>0&&i;)a!==0&&(u===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,u--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,p*=2}while(s>1);return t}function FJ(t,e,r,i,n){return t=(t-r)*n|0,e=(e-i)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function RZe(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function ZS(t,e,r,i,n,o,s,a){return(n-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(r-s)*(e-a)&&(r-s)*(o-a)>=(n-s)*(i-a)}function OZe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!DZe(t,e)&&(wI(t,e)&&wI(e,t)&&LZe(t,e)&&(vs(t.prev,t,e.prev)||vs(t,e.prev,e))||JF(t,e)&&vs(t.prev,t,t.next)>0&&vs(e.prev,e,e.next)>0)}function vs(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function JF(t,e){return t.x===e.x&&t.y===e.y}function h3e(t,e,r,i){var n=KF(vs(t,e,r)),o=KF(vs(t,e,i)),s=KF(vs(r,i,t)),a=KF(vs(r,i,e));return!!(n!==o&&s!==a||n===0&&ZF(t,r,e)||o===0&&ZF(t,i,e)||s===0&&ZF(r,t,i)||a===0&&ZF(r,e,i))}function ZF(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function KF(t){return t>0?1:t<0?-1:0}function DZe(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&h3e(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function wI(t,e){return vs(t.prev,t,t.next)<0?vs(t,e,t.next)>=0&&vs(t,t.prev,e)>=0:vs(t,e,t.prev)<0||vs(t,t.next,e)<0}function LZe(t,e){var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i}function d3e(t,e){var r=new NJ(t.i,t.x,t.y),i=new NJ(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function c3e(t,e,r,i){var n=new NJ(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function SI(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function NJ(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}QF.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,s=Math.abs(zJ(t,0,o,r));if(n)for(var a=0,u=e.length;a<u;a++){var p=e[a]*r,m=a<u-1?e[a+1]*r:t.length;s-=Math.abs(zJ(t,p,m,r))}var x=0;for(a=0;a<i.length;a+=3){var M=i[a]*r,k=i[a+1]*r,F=i[a+2]*r;x+=Math.abs((t[M]-t[F])*(t[k+1]-t[M+1])-(t[M]-t[k])*(t[F+1]-t[M+1]))}return s===0&&x===0?0:Math.abs((x-s)/s)};function zJ(t,e,r,i){for(var n=0,o=e,s=r-i;o<r;o+=i)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}QF.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[n][o][s]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r}});var hee=nr((zTe,GI)=>{(function(t,e){typeof XV=="function"&&typeof GI=="object"&&GI&&GI.exports?GI.exports=e():(t.dcodeIO=t.dcodeIO||{}).Long=e()})(zTe,function(){"use strict";function t(pe,ue,Le){this.low=pe|0,this.high=ue|0,this.unsigned=!!Le}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function e(pe){return(pe&&pe.__isLong__)===!0}t.isLong=e;var r={},i={};function n(pe,ue){var Le,We,ze;return ue?(pe>>>=0,(ze=0<=pe&&pe<256)&&(We=i[pe],We)?We:(Le=s(pe,(pe|0)<0?-1:0,!0),ze&&(i[pe]=Le),Le)):(pe|=0,(ze=-128<=pe&&pe<128)&&(We=r[pe],We)?We:(Le=s(pe,pe<0?-1:0,!1),ze&&(r[pe]=Le),Le))}t.fromInt=n;function o(pe,ue){if(isNaN(pe)||!isFinite(pe))return ue?W:H;if(ue){if(pe<0)return W;if(pe>=k)return ge}else{if(pe<=-F)return Se;if(pe+1>=F)return ce}return pe<0?o(-pe,ue).neg():s(pe%M|0,pe/M|0,ue)}t.fromNumber=o;function s(pe,ue,Le){return new t(pe,ue,Le)}t.fromBits=s;var a=Math.pow;function u(pe,ue,Le){if(pe.length===0)throw Error("empty string");if(pe==="NaN"||pe==="Infinity"||pe==="+Infinity"||pe==="-Infinity")return H;if(typeof ue=="number"?(Le=ue,ue=!1):ue=!!ue,Le=Le||10,Le<2||36<Le)throw RangeError("radix");var We;if((We=pe.indexOf("-"))>0)throw Error("interior hyphen");if(We===0)return u(pe.substring(1),ue,Le).neg();for(var ze=o(a(Le,8)),rt=H,at=0;at<pe.length;at+=8){var Wt=Math.min(8,pe.length-at),It=parseInt(pe.substring(at,at+Wt),Le);if(Wt<8){var Bt=o(a(Le,Wt));rt=rt.mul(Bt).add(o(It))}else rt=rt.mul(ze),rt=rt.add(o(It))}return rt.unsigned=ue,rt}t.fromString=u;function p(pe){return pe instanceof t?pe:typeof pe=="number"?o(pe):typeof pe=="string"?u(pe):s(pe.low,pe.high,pe.unsigned)}t.fromValue=p;var m=65536,x=1<<24,M=m*m,k=M*M,F=k/2,j=n(x),H=n(0);t.ZERO=H;var W=n(0,!0);t.UZERO=W;var Z=n(1);t.ONE=Z;var Y=n(1,!0);t.UONE=Y;var ee=n(-1);t.NEG_ONE=ee;var ce=s(-1,2147483647,!1);t.MAX_VALUE=ce;var ge=s(-1,-1,!0);t.MAX_UNSIGNED_VALUE=ge;var Se=s(0,-2147483648,!1);t.MIN_VALUE=Se;var ne=t.prototype;return ne.toInt=function(){return this.unsigned?this.low>>>0:this.low},ne.toNumber=function(){return this.unsigned?(this.high>>>0)*M+(this.low>>>0):this.high*M+(this.low>>>0)},ne.toString=function(ue){if(ue=ue||10,ue<2||36<ue)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Se)){var Le=o(ue),We=this.div(Le),ze=We.mul(Le).sub(this);return We.toString(ue)+ze.toInt().toString(ue)}else return"-"+this.neg().toString(ue);for(var rt=o(a(ue,6),this.unsigned),at=this,Wt="";;){var It=at.div(rt),Bt=at.sub(It.mul(rt)).toInt()>>>0,Qt=Bt.toString(ue);if(at=It,at.isZero())return Qt+Wt;for(;Qt.length<6;)Qt="0"+Qt;Wt=""+Qt+Wt}},ne.getHighBits=function(){return this.high},ne.getHighBitsUnsigned=function(){return this.high>>>0},ne.getLowBits=function(){return this.low},ne.getLowBitsUnsigned=function(){return this.low>>>0},ne.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Se)?64:this.neg().getNumBitsAbs();for(var ue=this.high!=0?this.high:this.low,Le=31;Le>0&&(ue&1<<Le)==0;Le--);return this.high!=0?Le+33:Le+1},ne.isZero=function(){return this.high===0&&this.low===0},ne.isNegative=function(){return!this.unsigned&&this.high<0},ne.isPositive=function(){return this.unsigned||this.high>=0},ne.isOdd=function(){return(this.low&1)===1},ne.isEven=function(){return(this.low&1)===0},ne.equals=function(ue){return e(ue)||(ue=p(ue)),this.unsigned!==ue.unsigned&&this.high>>>31===1&&ue.high>>>31===1?!1:this.high===ue.high&&this.low===ue.low},ne.eq=ne.equals,ne.notEquals=function(ue){return!this.eq(ue)},ne.neq=ne.notEquals,ne.lessThan=function(ue){return this.comp(ue)<0},ne.lt=ne.lessThan,ne.lessThanOrEqual=function(ue){return this.comp(ue)<=0},ne.lte=ne.lessThanOrEqual,ne.greaterThan=function(ue){return this.comp(ue)>0},ne.gt=ne.greaterThan,ne.greaterThanOrEqual=function(ue){return this.comp(ue)>=0},ne.gte=ne.greaterThanOrEqual,ne.compare=function(ue){if(e(ue)||(ue=p(ue)),this.eq(ue))return 0;var Le=this.isNegative(),We=ue.isNegative();return Le&&!We?-1:!Le&&We?1:this.unsigned?ue.high>>>0>this.high>>>0||ue.high===this.high&&ue.low>>>0>this.low>>>0?-1:1:this.sub(ue).isNegative()?-1:1},ne.comp=ne.compare,ne.negate=function(){return!this.unsigned&&this.eq(Se)?Se:this.not().add(Z)},ne.neg=ne.negate,ne.add=function(ue){e(ue)||(ue=p(ue));var Le=this.high>>>16,We=this.high&65535,ze=this.low>>>16,rt=this.low&65535,at=ue.high>>>16,Wt=ue.high&65535,It=ue.low>>>16,Bt=ue.low&65535,Qt=0,hr=0,nt=0,Et=0;return Et+=rt+Bt,nt+=Et>>>16,Et&=65535,nt+=ze+It,hr+=nt>>>16,nt&=65535,hr+=We+Wt,Qt+=hr>>>16,hr&=65535,Qt+=Le+at,Qt&=65535,s(nt<<16|Et,Qt<<16|hr,this.unsigned)},ne.subtract=function(ue){return e(ue)||(ue=p(ue)),this.add(ue.neg())},ne.sub=ne.subtract,ne.multiply=function(ue){if(this.isZero()||(e(ue)||(ue=p(ue)),ue.isZero()))return H;if(this.eq(Se))return ue.isOdd()?Se:H;if(ue.eq(Se))return this.isOdd()?Se:H;if(this.isNegative())return ue.isNegative()?this.neg().mul(ue.neg()):this.neg().mul(ue).neg();if(ue.isNegative())return this.mul(ue.neg()).neg();if(this.lt(j)&&ue.lt(j))return o(this.toNumber()*ue.toNumber(),this.unsigned);var Le=this.high>>>16,We=this.high&65535,ze=this.low>>>16,rt=this.low&65535,at=ue.high>>>16,Wt=ue.high&65535,It=ue.low>>>16,Bt=ue.low&65535,Qt=0,hr=0,nt=0,Et=0;return Et+=rt*Bt,nt+=Et>>>16,Et&=65535,nt+=ze*Bt,hr+=nt>>>16,nt&=65535,nt+=rt*It,hr+=nt>>>16,nt&=65535,hr+=We*Bt,Qt+=hr>>>16,hr&=65535,hr+=ze*It,Qt+=hr>>>16,hr&=65535,hr+=rt*Wt,Qt+=hr>>>16,hr&=65535,Qt+=Le*Bt+We*It+ze*Wt+rt*at,Qt&=65535,s(nt<<16|Et,Qt<<16|hr,this.unsigned)},ne.mul=ne.multiply,ne.divide=function(ue){if(e(ue)||(ue=p(ue)),ue.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?W:H;var Le,We,ze;if(this.unsigned){if(ue.unsigned||(ue=ue.toUnsigned()),ue.gt(this))return W;if(ue.gt(this.shru(1)))return Y;ze=W}else{if(this.eq(Se)){if(ue.eq(Z)||ue.eq(ee))return Se;if(ue.eq(Se))return Z;var rt=this.shr(1);return Le=rt.div(ue).shl(1),Le.eq(H)?ue.isNegative()?Z:ee:(We=this.sub(ue.mul(Le)),ze=Le.add(We.div(ue)),ze)}else if(ue.eq(Se))return this.unsigned?W:H;if(this.isNegative())return ue.isNegative()?this.neg().div(ue.neg()):this.neg().div(ue).neg();if(ue.isNegative())return this.div(ue.neg()).neg();ze=H}for(We=this;We.gte(ue);){Le=Math.max(1,Math.floor(We.toNumber()/ue.toNumber()));for(var at=Math.ceil(Math.log(Le)/Math.LN2),Wt=at<=48?1:a(2,at-48),It=o(Le),Bt=It.mul(ue);Bt.isNegative()||Bt.gt(We);)Le-=Wt,It=o(Le,this.unsigned),Bt=It.mul(ue);It.isZero()&&(It=Z),ze=ze.add(It),We=We.sub(Bt)}return ze},ne.div=ne.divide,ne.modulo=function(ue){return e(ue)||(ue=p(ue)),this.sub(this.div(ue).mul(ue))},ne.mod=ne.modulo,ne.not=function(){return s(~this.low,~this.high,this.unsigned)},ne.and=function(ue){return e(ue)||(ue=p(ue)),s(this.low&ue.low,this.high&ue.high,this.unsigned)},ne.or=function(ue){return e(ue)||(ue=p(ue)),s(this.low|ue.low,this.high|ue.high,this.unsigned)},ne.xor=function(ue){return e(ue)||(ue=p(ue)),s(this.low^ue.low,this.high^ue.high,this.unsigned)},ne.shiftLeft=function(ue){return e(ue)&&(ue=ue.toInt()),(ue&=63)===0?this:ue<32?s(this.low<<ue,this.high<<ue|this.low>>>32-ue,this.unsigned):s(0,this.low<<ue-32,this.unsigned)},ne.shl=ne.shiftLeft,ne.shiftRight=function(ue){return e(ue)&&(ue=ue.toInt()),(ue&=63)===0?this:ue<32?s(this.low>>>ue|this.high<<32-ue,this.high>>ue,this.unsigned):s(this.high>>ue-32,this.high>=0?0:-1,this.unsigned)},ne.shr=ne.shiftRight,ne.shiftRightUnsigned=function(ue){if(e(ue)&&(ue=ue.toInt()),ue&=63,ue===0)return this;var Le=this.high;if(ue<32){var We=this.low;return s(We>>>ue|Le<<32-ue,Le>>>ue,this.unsigned)}else return ue===32?s(Le,0,this.unsigned):s(Le>>>ue-32,0,this.unsigned)},ne.shru=ne.shiftRightUnsigned,ne.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},ne.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},ne.toBytes=function(pe){return pe?this.toBytesLE():this.toBytesBE()},ne.toBytesLE=function(){var pe=this.high,ue=this.low;return[ue&255,ue>>>8&255,ue>>>16&255,ue>>>24&255,pe&255,pe>>>8&255,pe>>>16&255,pe>>>24&255]},ne.toBytesBE=function(){var pe=this.high,ue=this.low;return[pe>>>24&255,pe>>>16&255,pe>>>8&255,pe&255,ue>>>24&255,ue>>>16&255,ue>>>8&255,ue&255]},t})});var ite=nr(PT=>{"use strict";Object.defineProperty(PT,"__esModule",{value:!0});PT.DefaultSerializer=PT.extendSerializer=void 0;function ult(t,e){let r=t.deserialize.bind(t),i=t.serialize.bind(t);return{deserialize(n){return e.deserialize(n,r)},serialize(n){return e.serialize(n,i)}}}PT.extendSerializer=ult;var AEe={deserialize(t){return Object.assign(Error(t.message),{name:t.name,stack:t.stack})},serialize(t){return{__error_marker:"$$error",message:t.message,name:t.name,stack:t.stack}}},hlt=t=>t&&typeof t=="object"&&"__error_marker"in t&&t.__error_marker==="$$error";PT.DefaultSerializer={deserialize(t){return hlt(t)?AEe.deserialize(t):t},serialize(t){return t instanceof Error?AEe.serialize(t):t}}});var IT=nr($_=>{"use strict";Object.defineProperty($_,"__esModule",{value:!0});$_.serialize=$_.deserialize=$_.registerSerializer=void 0;var yEe=ite(),_z=yEe.DefaultSerializer;function dlt(t){_z=yEe.extendSerializer(_z,t)}$_.registerSerializer=dlt;function flt(t){return _z.deserialize(t)}$_.deserialize=flt;function plt(t){return _z.serialize(t)}$_.serialize=plt});var vEe=nr(kT=>{"use strict";Object.defineProperty(kT,"__esModule",{value:!0});kT.getBundleURL=kT.getBaseURL=void 0;var nte;function mlt(){return nte||(nte=glt()),nte}kT.getBundleURL=mlt;function glt(){try{throw new Error}catch(t){let e=(""+t.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(e)return _Ee(e[0])}return"/"}function _Ee(t){return(""+t).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}kT.getBaseURL=_Ee});var ste=nr(W_=>{"use strict";Object.defineProperty(W_,"__esModule",{value:!0});W_.isWorkerRuntime=W_.getWorkerImplementation=W_.defaultPoolSize=void 0;var bEe=vEe();W_.defaultPoolSize=typeof navigator<"u"&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;var xEe=t=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(t);function wEe(t){let e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Alt(){if(typeof Worker>"u")return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class t extends Worker{constructor(i,n){var o,s;typeof i=="string"&&n&&n._baseURL?i=new URL(i,n._baseURL):typeof i=="string"&&!xEe(i)&&bEe.getBundleURL().match(/^file:\/\//i)&&(i=new URL(i,bEe.getBundleURL().replace(/\/[^\/]+$/,"/")),(!((o=n?.CORSWorkaround)!==null&&o!==void 0)||o)&&(i=wEe(`importScripts(${JSON.stringify(i)});`))),typeof i=="string"&&xEe(i)&&(!((s=n?.CORSWorkaround)!==null&&s!==void 0)||s)&&(i=wEe(`importScripts(${JSON.stringify(i)});`)),super(i,n)}}class e extends t{constructor(i,n){let o=window.URL.createObjectURL(i);super(o,n)}static fromText(i,n){let o=new window.Blob([i],{type:"text/javascript"});return new e(o,n)}}return{blob:e,default:t}}var ote;function ylt(){return ote||(ote=Alt()),ote}W_.getWorkerImplementation=ylt;function _lt(){let t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)}W_.isWorkerRuntime=_lt});var TEe=nr((wgr,SEe)=>{var RT=1e3,OT=RT*60,DT=OT*60,ix=DT*24,vlt=ix*7,blt=ix*365.25;SEe.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return xlt(t);if(r==="number"&&isFinite(t))return e.long?Slt(t):wlt(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function xlt(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*blt;case"weeks":case"week":case"w":return r*vlt;case"days":case"day":case"d":return r*ix;case"hours":case"hour":case"hrs":case"hr":case"h":return r*DT;case"minutes":case"minute":case"mins":case"min":case"m":return r*OT;case"seconds":case"second":case"secs":case"sec":case"s":return r*RT;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function wlt(t){var e=Math.abs(t);return e>=ix?Math.round(t/ix)+"d":e>=DT?Math.round(t/DT)+"h":e>=OT?Math.round(t/OT)+"m":e>=RT?Math.round(t/RT)+"s":t+"ms"}function Slt(t){var e=Math.abs(t);return e>=ix?vz(t,e,ix,"day"):e>=DT?vz(t,e,DT,"hour"):e>=OT?vz(t,e,OT,"minute"):e>=RT?vz(t,e,RT,"second"):t+" ms"}function vz(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var EEe=nr((Sgr,MEe)=>{function Tlt(t){r.debug=r,r.default=r,r.coerce=u,r.disable=s,r.enable=n,r.enabled=a,r.humanize=TEe(),r.destroy=p,Object.keys(t).forEach(m=>{r[m]=t[m]}),r.names=[],r.skips=[],r.formatters={};function e(m){let x=0;for(let M=0;M<m.length;M++)x=(x<<5)-x+m.charCodeAt(M),x|=0;return r.colors[Math.abs(x)%r.colors.length]}r.selectColor=e;function r(m){let x,M=null,k,F;function j(...H){if(!j.enabled)return;let W=j,Z=Number(new Date),Y=Z-(x||Z);W.diff=Y,W.prev=x,W.curr=Z,x=Z,H[0]=r.coerce(H[0]),typeof H[0]!="string"&&H.unshift("%O");let ee=0;H[0]=H[0].replace(/%([a-zA-Z%])/g,(ge,Se)=>{if(ge==="%%")return"%";ee++;let ne=r.formatters[Se];if(typeof ne=="function"){let pe=H[ee];ge=ne.call(W,pe),H.splice(ee,1),ee--}return ge}),r.formatArgs.call(W,H),(W.log||r.log).apply(W,H)}return j.namespace=m,j.useColors=r.useColors(),j.color=r.selectColor(m),j.extend=i,j.destroy=r.destroy,Object.defineProperty(j,"enabled",{enumerable:!0,configurable:!1,get:()=>M!==null?M:(k!==r.namespaces&&(k=r.namespaces,F=r.enabled(m)),F),set:H=>{M=H}}),typeof r.init=="function"&&r.init(j),j}function i(m,x){let M=r(this.namespace+(typeof x>"u"?":":x)+m);return M.log=this.log,M}function n(m){r.save(m),r.namespaces=m,r.names=[],r.skips=[];let x=(typeof m=="string"?m:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let M of x)M[0]==="-"?r.skips.push(M.slice(1)):r.names.push(M)}function o(m,x){let M=0,k=0,F=-1,j=0;for(;M<m.length;)if(k<x.length&&(x[k]===m[M]||x[k]==="*"))x[k]==="*"?(F=k,j=M,k++):(M++,k++);else if(F!==-1)k=F+1,j++,M=j;else return!1;for(;k<x.length&&x[k]==="*";)k++;return k===x.length}function s(){let m=[...r.names,...r.skips.map(x=>"-"+x)].join(",");return r.enable(""),m}function a(m){for(let x of r.skips)if(o(m,x))return!1;for(let x of r.names)if(o(m,x))return!0;return!1}function u(m){return m instanceof Error?m.stack||m.message:m}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}MEe.exports=Tlt});var xz=nr((zu,bz)=>{zu.formatArgs=Elt;zu.save=Clt;zu.load=Plt;zu.useColors=Mlt;zu.storage=Ilt();zu.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();zu.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Mlt(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Elt(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+bz.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}zu.log=console.debug||console.log||(()=>{});function Clt(t){try{t?zu.storage.setItem("debug",t):zu.storage.removeItem("debug")}catch{}}function Plt(){let t;try{t=zu.storage.getItem("debug")||zu.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Ilt(){try{return localStorage}catch{}}bz.exports=EEe()(zu);var{formatters:klt}=bz.exports;klt.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var kk=nr(LT=>{"use strict";var Rlt=LT&&LT.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})};Object.defineProperty(LT,"__esModule",{value:!0});LT.AsyncSerialScheduler=void 0;var ate=class{constructor(e){this._baseObserver=e,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(e=>this._baseObserver.error(e))}error(e){this._baseObserver.error(e)}schedule(e){let r=Promise.all(this._pendingPromises),i=[],n=s=>i.push(s),o=Promise.resolve().then(()=>Rlt(this,void 0,void 0,function*(){yield r,yield e(n),this._pendingPromises.delete(o);for(let s of i)this._baseObserver.next(s)})).catch(s=>{this._pendingPromises.delete(o),this._baseObserver.error(s)});this._pendingPromises.add(o)}};LT.AsyncSerialScheduler=ate});var PEe=nr(CEe=>{"use strict";Object.defineProperty(CEe,"__esModule",{value:!0})});var lte=nr(Zc=>{"use strict";Object.defineProperty(Zc,"__esModule",{value:!0});Zc.registerObservableSymbol=Zc.getSymbol=Zc.hasSymbol=Zc.hasSymbols=void 0;var Olt=()=>typeof Symbol=="function";Zc.hasSymbols=Olt;var Dlt=t=>Zc.hasSymbols()&&!!Symbol[t];Zc.hasSymbol=Dlt;var Llt=t=>Zc.hasSymbol(t)?Symbol[t]:"@@"+t;Zc.getSymbol=Llt;function Blt(){Zc.hasSymbols()&&!Zc.hasSymbol("observable")&&(Symbol.observable=Symbol("observable"))}Zc.registerObservableSymbol=Blt;Zc.hasSymbol("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"))});var X0=nr(Jg=>{"use strict";Object.defineProperty(Jg,"__esModule",{value:!0});Jg.Observable=Jg.SubscriptionObserver=Jg.Subscription=void 0;PEe();var Ok=lte(),Flt=Ok.getSymbol("iterator"),ute=Ok.getSymbol("observable"),IEe=Ok.getSymbol("species");function Sz(t,e){let r=t[e];if(r!=null){if(typeof r!="function")throw new TypeError(r+" is not a function");return r}}function Rk(t){let e=t.constructor;return e!==void 0&&(e=e[IEe],e===null&&(e=void 0)),e!==void 0?e:nx}function Nlt(t){return t instanceof nx}function BT(t){BT.log?BT.log(t):setTimeout(()=>{throw t},0)}function wz(t){Promise.resolve().then(()=>{try{t()}catch(e){BT(e)}})}function kEe(t){let e=t._cleanup;if(e!==void 0&&(t._cleanup=void 0,!!e))try{if(typeof e=="function")e();else{let r=Sz(e,"unsubscribe");r&&r.call(e)}}catch(r){BT(r)}}function hte(t){t._observer=void 0,t._queue=void 0,t._state="closed"}function zlt(t){let e=t._queue;if(e){t._queue=void 0,t._state="ready";for(let r of e)if(REe(t,r.type,r.value),t._state==="closed")break}}function REe(t,e,r){t._state="running";let i=t._observer;try{let n=i?Sz(i,e):void 0;switch(e){case"next":n&&n.call(i,r);break;case"error":if(hte(t),n)n.call(i,r);else throw r;break;case"complete":hte(t),n&&n.call(i);break}}catch(n){BT(n)}t._state==="closed"?kEe(t):t._state==="running"&&(t._state="ready")}function cte(t,e,r){if(t._state!=="closed"){if(t._state==="buffering"){t._queue=t._queue||[],t._queue.push({type:e,value:r});return}if(t._state!=="ready"){t._state="buffering",t._queue=[{type:e,value:r}],wz(()=>zlt(t));return}REe(t,e,r)}}var Tz=class{constructor(e,r){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";let i=new Mz(this);try{this._cleanup=r.call(void 0,i)}catch(n){i.error(n)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(hte(this),kEe(this))}};Jg.Subscription=Tz;var Mz=class{constructor(e){this._subscription=e}get closed(){return this._subscription._state==="closed"}next(e){cte(this._subscription,"next",e)}error(e){cte(this._subscription,"error",e)}complete(){cte(this._subscription,"complete")}};Jg.SubscriptionObserver=Mz;var nx=class t{constructor(e){if(!(this instanceof t))throw new TypeError("Observable cannot be called as a function");if(typeof e!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,r,i){return(typeof e!="object"||e===null)&&(e={next:e,error:r,complete:i}),new Tz(e,this._subscriber)}pipe(e,...r){let i=this;for(let n of[e,...r])i=n(i);return i}tap(e,r,i){let n=typeof e!="object"||e===null?{next:e,error:r,complete:i}:e;return new t(o=>this.subscribe({next(s){n.next&&n.next(s),o.next(s)},error(s){n.error&&n.error(s),o.error(s)},complete(){n.complete&&n.complete(),o.complete()},start(s){n.start&&n.start(s)}}))}forEach(e){return new Promise((r,i)=>{if(typeof e!="function"){i(new TypeError(e+" is not a function"));return}function n(){o.unsubscribe(),r(void 0)}let o=this.subscribe({next(s){try{e(s,n)}catch(a){i(a),o.unsubscribe()}},error(s){i(s)},complete(){r(void 0)}})})}map(e){if(typeof e!="function")throw new TypeError(e+" is not a function");let r=Rk(this);return new r(i=>this.subscribe({next(n){let o=n;try{o=e(n)}catch(s){return i.error(s)}i.next(o)},error(n){i.error(n)},complete(){i.complete()}}))}filter(e){if(typeof e!="function")throw new TypeError(e+" is not a function");let r=Rk(this);return new r(i=>this.subscribe({next(n){try{if(!e(n))return}catch(o){return i.error(o)}i.next(n)},error(n){i.error(n)},complete(){i.complete()}}))}reduce(e,r){if(typeof e!="function")throw new TypeError(e+" is not a function");let i=Rk(this),n=arguments.length>1,o=!1,s=r;return new i(a=>this.subscribe({next(u){let p=!o;if(o=!0,!p||n)try{s=e(s,u)}catch(m){return a.error(m)}else s=u},error(u){a.error(u)},complete(){if(!o&&!n)return a.error(new TypeError("Cannot reduce an empty sequence"));a.next(s),a.complete()}}))}concat(...e){let r=Rk(this);return new r(i=>{let n,o=0;function s(a){n=a.subscribe({next(u){i.next(u)},error(u){i.error(u)},complete(){o===e.length?(n=void 0,i.complete()):s(r.from(e[o++]))}})}return s(this),()=>{n&&(n.unsubscribe(),n=void 0)}})}flatMap(e){if(typeof e!="function")throw new TypeError(e+" is not a function");let r=Rk(this);return new r(i=>{let n=[],o=this.subscribe({next(a){let u;if(e)try{u=e(a)}catch(m){return i.error(m)}else u=a;let p=r.from(u).subscribe({next(m){i.next(m)},error(m){i.error(m)},complete(){let m=n.indexOf(p);m>=0&&n.splice(m,1),s()}});n.push(p)},error(a){i.error(a)},complete(){s()}});function s(){o.closed&&n.length===0&&i.complete()}return()=>{n.forEach(a=>a.unsubscribe()),o.unsubscribe()}})}[(Symbol.observable,ute)](){return this}static from(e){let r=typeof this=="function"?this:t;if(e==null)throw new TypeError(e+" is not an object");let i=Sz(e,ute);if(i){let n=i.call(e);if(Object(n)!==n)throw new TypeError(n+" is not an object");return Nlt(n)&&n.constructor===r?n:new r(o=>n.subscribe(o))}if(Ok.hasSymbol("iterator")){let n=Sz(e,Flt);if(n)return new r(o=>{wz(()=>{if(!o.closed){for(let s of n.call(e))if(o.next(s),o.closed)return;o.complete()}})})}if(Array.isArray(e))return new r(n=>{wz(()=>{if(!n.closed){for(let o of e)if(n.next(o),n.closed)return;n.complete()}})});throw new TypeError(e+" is not observable")}static of(...e){let r=typeof this=="function"?this:t;return new r(i=>{wz(()=>{if(!i.closed){for(let n of e)if(i.next(n),i.closed)return;i.complete()}})})}static get[IEe](){return this}};Jg.Observable=nx;Ok.hasSymbols()&&Object.defineProperty(nx,Symbol("extensions"),{value:{symbol:ute,hostReportError:BT},configurable:!0});Jg.default=nx});var G_=nr(dte=>{"use strict";Object.defineProperty(dte,"__esModule",{value:!0});function Ult(t){typeof t=="function"?t():t&&typeof t.unsubscribe=="function"&&t.unsubscribe()}dte.default=Ult});var OEe=nr(Dk=>{"use strict";var Vlt=Dk&&Dk.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})};Object.defineProperty(Dk,"__esModule",{value:!0});var jlt=kk(),$lt=X0(),Wlt=G_();function Glt(t){return e=>new $lt.default(r=>{let i=new jlt.AsyncSerialScheduler(r),n=e.subscribe({complete(){i.complete()},error(o){i.error(o)},next(o){i.schedule(s=>Vlt(this,void 0,void 0,function*(){(yield t(o))&&s(o)}))}});return()=>Wlt.default(n)})}Dk.default=Glt});var LEe=nr(FT=>{"use strict";Object.defineProperty(FT,"__esModule",{value:!0});FT.isIterator=FT.isAsyncIterator=void 0;var DEe=lte();function Hlt(t){return t&&DEe.hasSymbol("asyncIterator")&&t[Symbol.asyncIterator]}FT.isAsyncIterator=Hlt;function qlt(t){return t&&DEe.hasSymbol("iterator")&&t[Symbol.iterator]}FT.isIterator=qlt});var FEe=nr(ox=>{"use strict";var Ylt=ox&&ox.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})},Xlt=ox&&ox.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(o){r[o]=t[o]&&function(s){return new Promise(function(a,u){s=t[o](s),n(a,u,s.done,s.value)})}}function n(o,s,a,u){Promise.resolve(u).then(function(p){o({value:p,done:a})},s)}};Object.defineProperty(ox,"__esModule",{value:!0});var Zlt=kk(),BEe=LEe(),Klt=X0(),Qlt=G_();function Jlt(t){return e=>new Klt.default(r=>{let i=new Zlt.AsyncSerialScheduler(r),n=e.subscribe({complete(){i.complete()},error(o){i.error(o)},next(o){i.schedule(s=>Ylt(this,void 0,void 0,function*(){var a,u;let p=yield t(o);if(BEe.isIterator(p)||BEe.isAsyncIterator(p))try{for(var m=Xlt(p),x;x=yield m.next(),!x.done;){let M=x.value;s(M)}}catch(M){a={error:M}}finally{try{x&&!x.done&&(u=m.return)&&(yield u.call(m))}finally{if(a)throw a.error}}else p.map(M=>s(M))}))}});return()=>Qlt.default(n)})}ox.default=Jlt});var NEe=nr(fte=>{"use strict";Object.defineProperty(fte,"__esModule",{value:!0});var ect=X0();function tct(t){return new ect.Observable(e=>{let r=0,i=setInterval(()=>{e.next(r++)},t);return()=>clearInterval(i)})}fte.default=tct});var zEe=nr(Lk=>{"use strict";var rct=Lk&&Lk.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})};Object.defineProperty(Lk,"__esModule",{value:!0});var ict=kk(),nct=X0(),oct=G_();function sct(t){return e=>new nct.default(r=>{let i=new ict.AsyncSerialScheduler(r),n=e.subscribe({complete(){i.complete()},error(o){i.error(o)},next(o){i.schedule(s=>rct(this,void 0,void 0,function*(){let a=yield t(o);s(a)}))}});return()=>oct.default(n)})}Lk.default=sct});var VEe=nr(pte=>{"use strict";Object.defineProperty(pte,"__esModule",{value:!0});var UEe=X0(),act=G_();function lct(...t){return t.length===0?UEe.Observable.from([]):new UEe.Observable(e=>{let r=0,i=t.map(o=>o.subscribe({error(s){e.error(s),n()},next(s){e.next(s)},complete(){++r===t.length&&(e.complete(),n())}})),n=()=>{i.forEach(o=>act.default(o))};return n})}pte.default=lct});var Ate=nr(gte=>{"use strict";Object.defineProperty(gte,"__esModule",{value:!0});var cct=X0(),mte=class extends cct.default{constructor(){super(e=>(this._observers.add(e),()=>this._observers.delete(e))),this._observers=new Set}next(e){for(let r of this._observers)r.next(e)}error(e){for(let r of this._observers)r.error(e)}complete(){for(let e of this._observers)e.complete()}};gte.default=mte});var jEe=nr(yte=>{"use strict";Object.defineProperty(yte,"__esModule",{value:!0});var uct=X0(),hct=Ate(),dct=G_();function fct(t){let e=new hct.default,r,i=0;return new uct.default(n=>{r||(r=t.subscribe(e));let o=e.subscribe(n);return i++,()=>{i--,o.unsubscribe(),i===0&&(dct.default(r),r=void 0)}})}yte.default=fct});var $Ee=nr(Bk=>{"use strict";var pct=Bk&&Bk.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})};Object.defineProperty(Bk,"__esModule",{value:!0});var mct=kk(),gct=X0(),Act=G_();function yct(t,e){return r=>new gct.default(i=>{let n,o=0,s=new mct.AsyncSerialScheduler(i),a=r.subscribe({complete(){s.complete()},error(u){s.error(u)},next(u){s.schedule(p=>pct(this,void 0,void 0,function*(){n=yield t(o===0?typeof e>"u"?u:e:n,u,o++),p(n)}))}});return()=>Act.default(a)})}Bk.default=yct});var WEe=nr(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.unsubscribe=js.Subject=js.scan=js.Observable=js.multicast=js.merge=js.map=js.interval=js.flatMap=js.filter=void 0;var _ct=OEe();Object.defineProperty(js,"filter",{enumerable:!0,get:function(){return _ct.default}});var vct=FEe();Object.defineProperty(js,"flatMap",{enumerable:!0,get:function(){return vct.default}});var bct=NEe();Object.defineProperty(js,"interval",{enumerable:!0,get:function(){return bct.default}});var xct=zEe();Object.defineProperty(js,"map",{enumerable:!0,get:function(){return xct.default}});var wct=VEe();Object.defineProperty(js,"merge",{enumerable:!0,get:function(){return wct.default}});var Sct=jEe();Object.defineProperty(js,"multicast",{enumerable:!0,get:function(){return Sct.default}});var Tct=X0();Object.defineProperty(js,"Observable",{enumerable:!0,get:function(){return Tct.default}});var Mct=$Ee();Object.defineProperty(js,"scan",{enumerable:!0,get:function(){return Mct.default}});var Ect=Ate();Object.defineProperty(js,"Subject",{enumerable:!0,get:function(){return Ect.default}});var Cct=G_();Object.defineProperty(js,"unsubscribe",{enumerable:!0,get:function(){return Cct.default}})});var Fk=nr((Ugr,GEe)=>{GEe.exports=WEe()});var HEe=nr(Ez=>{"use strict";Object.defineProperty(Ez,"__esModule",{value:!0});Ez.allSettled=void 0;function Pct(t){return Promise.all(t.map(e=>{let r=o=>({status:"fulfilled",value:o}),i=o=>({status:"rejected",reason:o}),n=Promise.resolve(e);try{return n.then(r,i)}catch(o){return Promise.reject(o)}}))}Ez.allSettled=Pct});var qEe=nr(Nk=>{"use strict";Object.defineProperty(Nk,"__esModule",{value:!0});Nk.PoolEventType=void 0;var Ict;(function(t){t.initialized="initialized",t.taskCanceled="taskCanceled",t.taskCompleted="taskCompleted",t.taskFailed="taskFailed",t.taskQueued="taskQueued",t.taskQueueDrained="taskQueueDrained",t.taskStart="taskStart",t.terminated="terminated"})(Ict=Nk.PoolEventType||(Nk.PoolEventType={}))});var zk=nr(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.$worker=Zd.$transferable=Zd.$terminate=Zd.$events=Zd.$errors=void 0;Zd.$errors=Symbol("thread.errors");Zd.$events=Symbol("thread.events");Zd.$terminate=Symbol("thread.terminate");Zd.$transferable=Symbol("thread.transferable");Zd.$worker=Symbol("thread.worker")});var vte=nr(Cz=>{"use strict";Object.defineProperty(Cz,"__esModule",{value:!0});Cz.Thread=void 0;var _te=zk();function YEe(t){throw Error(t)}Cz.Thread={errors(t){return t[_te.$errors]||YEe("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events(t){return t[_te.$events]||YEe("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate(t){return t[_te.$terminate]()}}});var QEe=nr(Kd=>{"use strict";var sx=Kd&&Kd.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})},kct=Kd&&Kd.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.Pool=Kd.Thread=Kd.PoolEventType=void 0;var Rct=kct(xz()),bte=Fk(),XEe=HEe(),Oct=ste(),Al=qEe();Object.defineProperty(Kd,"PoolEventType",{enumerable:!0,get:function(){return Al.PoolEventType}});var ZEe=vte();Object.defineProperty(Kd,"Thread",{enumerable:!0,get:function(){return ZEe.Thread}});var Dct=1;function Lct(t){let e=[];for(let r=0;r<t;r++)e.push(r);return e}function Bct(t){return new Promise(e=>setTimeout(e,t))}function Fct(t,e){return t.reduce((r,i)=>[...r,...e(i)],[])}function Nct(t){return t.replace(/\W/g," ").trim().replace(/\s+/g,"-")}function zct(t,e){return Lct(e).map(()=>({init:t(),runningTasks:[]}))}var Pz=class{constructor(e,r){this.eventSubject=new bte.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];let i=typeof r=="number"?{size:r}:r||{},{size:n=Oct.defaultPoolSize}=i;this.debug=Rct.default(`threads:pool:${Nct(i.name||String(Dct++))}`),this.options=i,this.workers=zct(e,n),this.eventObservable=bte.multicast(bte.Observable.from(this.eventSubject)),Promise.all(this.workers.map(o=>o.init)).then(()=>this.eventSubject.next({type:Al.PoolEventType.initialized,size:this.workers.length}),o=>{this.debug("Error while initializing pool worker:",o),this.eventSubject.error(o),this.initErrors.push(o)})}findIdlingWorker(){let{concurrency:e=1}=this.options;return this.workers.find(r=>r.runningTasks.length<e)}runPoolTask(e,r){return sx(this,void 0,void 0,function*(){let i=this.workers.indexOf(e)+1;this.debug(`Running task #${r.id} on worker #${i}...`),this.eventSubject.next({type:Al.PoolEventType.taskStart,taskID:r.id,workerID:i});try{let n=yield r.run(yield e.init);this.debug(`Task #${r.id} completed successfully`),this.eventSubject.next({type:Al.PoolEventType.taskCompleted,returnValue:n,taskID:r.id,workerID:i})}catch(n){this.debug(`Task #${r.id} failed`),this.eventSubject.next({type:Al.PoolEventType.taskFailed,taskID:r.id,error:n,workerID:i})}})}run(e,r){return sx(this,void 0,void 0,function*(){let i=sx(this,void 0,void 0,function*(){let n=()=>{e.runningTasks=e.runningTasks.filter(o=>o!==i)};yield Bct(0);try{yield this.runPoolTask(e,r)}finally{n(),this.isClosing||this.scheduleWork()}});e.runningTasks.push(i)})}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");let e=this.findIdlingWorker();if(!e)return;let r=this.taskQueue.shift();if(!r){this.debug("Task queue is empty"),this.eventSubject.next({type:Al.PoolEventType.taskQueueDrained});return}this.run(e,r)}taskCompletion(e){return new Promise((r,i)=>{let n=this.events().subscribe(o=>{o.type===Al.PoolEventType.taskCompleted&&o.taskID===e?(n.unsubscribe(),r(o.returnValue)):o.type===Al.PoolEventType.taskFailed&&o.taskID===e?(n.unsubscribe(),i(o.error)):o.type===Al.PoolEventType.terminated&&(n.unsubscribe(),i(Error("Pool has been terminated before task was run.")))})})}settled(e=!1){return sx(this,void 0,void 0,function*(){let r=()=>Fct(this.workers,o=>o.runningTasks),i=[],n=this.eventObservable.subscribe(o=>{o.type===Al.PoolEventType.taskFailed&&i.push(o.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):e&&this.taskQueue.length===0?(yield XEe.allSettled(r()),i):(yield new Promise((o,s)=>{let a=this.eventObservable.subscribe({next(u){u.type===Al.PoolEventType.taskQueueDrained&&(a.unsubscribe(),o(void 0))},error:s})}),yield XEe.allSettled(r()),n.unsubscribe(),i)})}completed(e=!1){return sx(this,void 0,void 0,function*(){let r=this.settled(e),i=new Promise((o,s)=>{let a=this.eventObservable.subscribe({next(u){u.type===Al.PoolEventType.taskQueueDrained?(a.unsubscribe(),o(r)):u.type===Al.PoolEventType.taskFailed&&(a.unsubscribe(),s(u.error))},error:s})}),n=yield Promise.race([r,i]);if(n.length>0)throw n[0]})}events(){return this.eventObservable}queue(e){let{maxQueuedJobs:r=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];let i=this.nextTaskID++,n=this.taskCompletion(i);n.catch(s=>{this.debug(`Task #${i} errored:`,s)});let o={id:i,run:e,cancel:()=>{this.taskQueue.indexOf(o)!==-1&&(this.taskQueue=this.taskQueue.filter(s=>s!==o),this.eventSubject.next({type:Al.PoolEventType.taskCanceled,taskID:o.id}))},then:n.then.bind(n)};if(this.taskQueue.length>=r)throw Error(`Maximum number of pool tasks queued. Refusing to queue another one.
This usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.`);return this.debug(`Queueing task #${o.id}...`),this.taskQueue.push(o),this.eventSubject.next({type:Al.PoolEventType.taskQueued,taskID:o.id}),this.scheduleWork(),o}terminate(e){return sx(this,void 0,void 0,function*(){this.isClosing=!0,e||(yield this.completed(!0)),this.eventSubject.next({type:Al.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(r=>sx(this,void 0,void 0,function*(){return ZEe.Thread.terminate(yield r.init)})))})}};Pz.EventType=Al.PoolEventType;function KEe(t,e){return new Pz(t,e)}KEe.EventType=Al.PoolEventType;Kd.Pool=KEe});var JEe=nr(Iz=>{"use strict";Object.defineProperty(Iz,"__esModule",{value:!0});Iz.createPromiseWithResolver=void 0;var Uct=()=>{};function Vct(){let t=!1,e,r=Uct;return[new Promise(o=>{t?o(e):r=o}),o=>{t=!0,e=o,r(e)}]}Iz.createPromiseWithResolver=Vct});var eCe=nr(Uk=>{"use strict";Object.defineProperty(Uk,"__esModule",{value:!0});Uk.WorkerEventType=void 0;var qgr=zk(),jct;(function(t){t.internalError="internalError",t.message="message",t.termination="termination"})(jct=Uk.WorkerEventType||(Uk.WorkerEventType={}))});var rCe=nr(kz=>{"use strict";Object.defineProperty(kz,"__esModule",{value:!0});kz.ObservablePromise=void 0;var $ct=Fk(),Wct=()=>{},Gct=t=>t,tCe=t=>Promise.resolve().then(t);function Hct(t){throw t}function qct(t){return t&&typeof t.then=="function"}var xte=class t extends $ct.Observable{constructor(e){super(r=>{let i=this,n=Object.assign(Object.assign({},r),{complete(){r.complete(),i.onCompletion()},error(o){r.error(o),i.onError(o)},next(o){r.next(o),i.onNext(o)}});try{return this.initHasRun=!0,e(n)}catch(o){n.error(o)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(let r of this.rejectionCallbacks)tCe(()=>r(e))}onCompletion(){this.state="fulfilled";for(let e of this.fulfillmentCallbacks)tCe(()=>e(this.firstValue))}then(e,r){let i=e||Gct,n=r||Hct,o=!1;return new Promise((s,a)=>{let u=m=>{if(!o){o=!0;try{s(n(m))}catch(x){a(x)}}},p=m=>{try{s(i(m))}catch(x){u(x)}};if(this.initHasRun||this.subscribe({error:u}),this.state==="fulfilled")return s(i(this.firstValue));if(this.state==="rejected")return o=!0,s(n(this.rejection));this.fulfillmentCallbacks.push(p),this.rejectionCallbacks.push(u)})}catch(e){return this.then(void 0,e)}finally(e){let r=e||Wct;return this.then(i=>(r(),i),()=>r())}static from(e){return qct(e)?new t(r=>{let i=o=>{r.next(o),r.complete()},n=o=>{r.error(o)};e.then(i,n)}):super.from(e)}};kz.ObservablePromise=xte});var Vk=nr(NT=>{"use strict";Object.defineProperty(NT,"__esModule",{value:!0});NT.Transfer=NT.isTransferDescriptor=void 0;var iCe=zk();function Yct(t){return!(!t||typeof t!="object")}function Xct(t){return t&&typeof t=="object"&&t[iCe.$transferable]}NT.isTransferDescriptor=Xct;function Zct(t,e){if(!e){if(!Yct(t))throw Error();e=[t]}return{[iCe.$transferable]:!0,send:t,transferables:e}}NT.Transfer=Zct});var wte=nr(H_=>{"use strict";Object.defineProperty(H_,"__esModule",{value:!0});H_.WorkerMessageType=H_.MasterMessageType=void 0;var Kct;(function(t){t.cancel="cancel",t.run="run"})(Kct=H_.MasterMessageType||(H_.MasterMessageType={}));var Qct;(function(t){t.error="error",t.init="init",t.result="result",t.running="running",t.uncaughtError="uncaughtError"})(Qct=H_.WorkerMessageType||(H_.WorkerMessageType={}))});var lCe=nr(q_=>{"use strict";var Jct=q_&&q_.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(q_,"__esModule",{value:!0});q_.createProxyModule=q_.createProxyFunction=void 0;var eut=Jct(xz()),oCe=Fk(),jk=IT(),nCe=rCe(),tut=Vk(),$k=wte(),sCe=eut.default("threads:master:messages"),rut=1,iut=t=>Array.from(new Set(t)),nut=t=>t&&t.type===$k.WorkerMessageType.error,out=t=>t&&t.type===$k.WorkerMessageType.result,sut=t=>t&&t.type===$k.WorkerMessageType.running;function aut(t,e){return new oCe.Observable(r=>{let i,n=(o=>{if(sCe("Message from worker:",o.data),!(!o.data||o.data.uid!==e)){if(sut(o.data))i=o.data.resultType;else if(out(o.data))i==="promise"?(typeof o.data.payload<"u"&&r.next(jk.deserialize(o.data.payload)),r.complete(),t.removeEventListener("message",n)):(o.data.payload&&r.next(jk.deserialize(o.data.payload)),o.data.complete&&(r.complete(),t.removeEventListener("message",n)));else if(nut(o.data)){let s=jk.deserialize(o.data.error);r.error(s),t.removeEventListener("message",n)}}});return t.addEventListener("message",n),()=>{if(i==="observable"||!i){let o={type:$k.MasterMessageType.cancel,uid:e};t.postMessage(o)}t.removeEventListener("message",n)}})}function lut(t){if(t.length===0)return{args:[],transferables:[]};let e=[],r=[];for(let i of t)tut.isTransferDescriptor(i)?(e.push(jk.serialize(i.send)),r.push(...i.transferables)):e.push(jk.serialize(i));return{args:e,transferables:r.length===0?r:iut(r)}}function aCe(t,e){return((...r)=>{let i=rut++,{args:n,transferables:o}=lut(r),s={type:$k.MasterMessageType.run,uid:i,method:e,args:n};sCe("Sending command to run function to worker:",s);try{t.postMessage(s,o)}catch(a){return nCe.ObservablePromise.from(Promise.reject(a))}return nCe.ObservablePromise.from(oCe.multicast(aut(t,i)))})}q_.createProxyFunction=aCe;function cut(t,e){let r={};for(let i of e)r[i]=aCe(t,i);return r}q_.createProxyModule=cut});var dCe=nr(Y_=>{"use strict";var Ste=Y_&&Y_.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})},uut=Y_&&Y_.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Y_,"__esModule",{value:!0});Y_.spawn=void 0;var Tte=uut(xz()),hut=Fk(),dut=IT(),fut=JEe(),Rz=zk(),Oz=eCe(),cCe=lCe(),put=Tte.default("threads:master:messages"),mut=Tte.default("threads:master:spawn"),hCe=Tte.default("threads:master:thread-utils"),gut=t=>t&&t.type==="init",Aut=t=>t&&t.type==="uncaughtError",yut=typeof process<"u"&&process.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(process.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function _ut(t,e,r){return Ste(this,void 0,void 0,function*(){let i,n=new Promise((s,a)=>{i=setTimeout(()=>a(Error(r)),e)}),o=yield Promise.race([t,n]);return clearTimeout(i),o})}function vut(t){return new Promise((e,r)=>{let i=(n=>{put("Message from worker before finishing initialization:",n.data),gut(n.data)?(t.removeEventListener("message",i),e(n.data)):Aut(n.data)&&(t.removeEventListener("message",i),r(dut.deserialize(n.data.error)))});t.addEventListener("message",i)})}function but(t,e){return new hut.Observable(r=>{let i=(o=>{let s={type:Oz.WorkerEventType.message,data:o.data};r.next(s)}),n=(o=>{hCe("Unhandled promise rejection event in thread:",o);let s={type:Oz.WorkerEventType.internalError,error:Error(o.reason)};r.next(s)});t.addEventListener("message",i),t.addEventListener("unhandledrejection",n),e.then(()=>{let o={type:Oz.WorkerEventType.termination};t.removeEventListener("message",i),t.removeEventListener("unhandledrejection",n),r.next(o),r.complete()})})}function xut(t){let[e,r]=fut.createPromiseWithResolver();return{terminate:()=>Ste(this,void 0,void 0,function*(){hCe("Terminating worker"),yield t.terminate(),r()}),termination:e}}function uCe(t,e,r,i){let n=r.filter(o=>o.type===Oz.WorkerEventType.internalError).map(o=>o.error);return Object.assign(t,{[Rz.$errors]:n,[Rz.$events]:r,[Rz.$terminate]:i,[Rz.$worker]:e})}function wut(t,e){return Ste(this,void 0,void 0,function*(){mut("Initializing new thread");let r=e&&e.timeout?e.timeout:yut,n=(yield _ut(vut(t),r,`Timeout: Did not receive an init message from worker after ${r}ms. Make sure the worker calls expose().`)).exposed,{termination:o,terminate:s}=xut(t),a=but(t,o);if(n.type==="function"){let u=cCe.createProxyFunction(t);return uCe(u,t,a,s)}else if(n.type==="module"){let u=cCe.createProxyModule(t,n.methods);return uCe(u,t,a,s)}else{let u=n.type;throw Error(`Worker init message states unexpected type of expose(): ${u}`)}})}Y_.spawn=wut});var fCe=nr(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.Worker=Uu.BlobWorker=Uu.isWorkerRuntime=Uu.Thread=Uu.spawn=Uu.Pool=void 0;var Mte=ste();Object.defineProperty(Uu,"isWorkerRuntime",{enumerable:!0,get:function(){return Mte.isWorkerRuntime}});var Sut=QEe();Object.defineProperty(Uu,"Pool",{enumerable:!0,get:function(){return Sut.Pool}});var Tut=dCe();Object.defineProperty(Uu,"spawn",{enumerable:!0,get:function(){return Tut.spawn}});var Mut=vte();Object.defineProperty(Uu,"Thread",{enumerable:!0,get:function(){return Mut.Thread}});Uu.BlobWorker=Mte.getWorkerImplementation().blob;Uu.Worker=Mte.getWorkerImplementation().default});var mCe=nr((tAr,pCe)=>{"use strict";pCe.exports=t=>t?typeof Symbol.observable=="symbol"&&typeof t[Symbol.observable]=="function"?t===t[Symbol.observable]():typeof t["@@observable"]=="function"?t===t["@@observable"]():!1:!1});var gCe=nr(Ete=>{"use strict";Object.defineProperty(Ete,"__esModule",{value:!0});var Eut=function(){let e=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!e)},Cut=function(e,r){self.postMessage(e,r)},Put=function(e){let r=n=>{e(n.data)},i=()=>{self.removeEventListener("message",r)};return self.addEventListener("message",r),i};Ete.default={isWorkerRuntime:Eut,postMessageToMaster:Cut,subscribeToMasterMessages:Put}});var wCe=nr(Vu=>{"use strict";var Iut=Vu&&Vu.__awaiter||function(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})},bCe=Vu&&Vu.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vu,"__esModule",{value:!0});Vu.expose=Vu.isWorkerRuntime=Vu.Transfer=Vu.registerSerializer=void 0;var kut=bCe(mCe()),X_=IT(),Rut=Vk(),Z_=wte(),zh=bCe(gCe()),Out=IT();Object.defineProperty(Vu,"registerSerializer",{enumerable:!0,get:function(){return Out.registerSerializer}});var Dut=Vk();Object.defineProperty(Vu,"Transfer",{enumerable:!0,get:function(){return Dut.Transfer}});Vu.isWorkerRuntime=zh.default.isWorkerRuntime;var ACe=!1,Wk=new Map,Lut=t=>t&&t.type===Z_.MasterMessageType.cancel,yCe=t=>t&&t.type===Z_.MasterMessageType.run,_Ce=t=>kut.default(t)||But(t);function But(t){return t&&typeof t=="object"&&typeof t.subscribe=="function"}function xCe(t){return Rut.isTransferDescriptor(t)?{payload:t.send,transferables:t.transferables}:{payload:t,transferables:void 0}}function Fut(){let t={type:Z_.WorkerMessageType.init,exposed:{type:"function"}};zh.default.postMessageToMaster(t)}function Nut(t){let e={type:Z_.WorkerMessageType.init,exposed:{type:"module",methods:t}};zh.default.postMessageToMaster(e)}function Cte(t,e){let{payload:r,transferables:i}=xCe(e),n={type:Z_.WorkerMessageType.error,uid:t,error:X_.serialize(r)};zh.default.postMessageToMaster(n,i)}function Pte(t,e,r){let{payload:i,transferables:n}=xCe(r),o={type:Z_.WorkerMessageType.result,uid:t,complete:e?!0:void 0,payload:i};zh.default.postMessageToMaster(o,n)}function zut(t,e){let r={type:Z_.WorkerMessageType.running,uid:t,resultType:e};zh.default.postMessageToMaster(r)}function Dz(t){try{let e={type:Z_.WorkerMessageType.uncaughtError,error:X_.serialize(t)};zh.default.postMessageToMaster(e)}catch(e){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,e,`
Original error:`,t)}}function vCe(t,e,r){return Iut(this,void 0,void 0,function*(){let i;try{i=e(...r)}catch(o){return Cte(t,o)}let n=_Ce(i)?"observable":"promise";if(zut(t,n),_Ce(i)){let o=i.subscribe(s=>Pte(t,!1,X_.serialize(s)),s=>{Cte(t,X_.serialize(s)),Wk.delete(t)},()=>{Pte(t,!0),Wk.delete(t)});Wk.set(t,o)}else try{let o=yield i;Pte(t,!0,X_.serialize(o))}catch(o){Cte(t,X_.serialize(o))}})}function Uut(t){if(!zh.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(ACe)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(ACe=!0,typeof t=="function")zh.default.subscribeToMasterMessages(e=>{yCe(e)&&!e.method&&vCe(e.uid,t,e.args.map(X_.deserialize))}),Fut();else if(typeof t=="object"&&t){zh.default.subscribeToMasterMessages(r=>{yCe(r)&&r.method&&vCe(r.uid,t[r.method],r.args.map(X_.deserialize))});let e=Object.keys(t).filter(r=>typeof t[r]=="function");Nut(e)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${t}`);zh.default.subscribeToMasterMessages(e=>{if(Lut(e)){let r=e.uid,i=Wk.get(r);i&&(i.unsubscribe(),Wk.delete(r))}})}Vu.expose=Uut;typeof self<"u"&&typeof self.addEventListener=="function"&&zh.default.isWorkerRuntime()&&(self.addEventListener("error",t=>{setTimeout(()=>Dz(t.error||t),250)}),self.addEventListener("unhandledrejection",t=>{let e=t.reason;e&&typeof e.message=="string"&&setTimeout(()=>Dz(e),250)}));typeof process<"u"&&typeof process.on=="function"&&zh.default.isWorkerRuntime()&&(process.on("uncaughtException",t=>{setTimeout(()=>Dz(t),250)}),process.on("unhandledRejection",t=>{t&&typeof t.message=="string"&&setTimeout(()=>Dz(t),250)}))});var SCe=nr(Kc=>{"use strict";var Vut=Kc&&Kc.__createBinding||(Object.create?(function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]})),jut=Kc&&Kc.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Vut(e,t,r)};Object.defineProperty(Kc,"__esModule",{value:!0});Kc.Transfer=Kc.DefaultSerializer=Kc.expose=Kc.registerSerializer=void 0;var $ut=IT();Object.defineProperty(Kc,"registerSerializer",{enumerable:!0,get:function(){return $ut.registerSerializer}});jut(fCe(),Kc);var Wut=wCe();Object.defineProperty(Kc,"expose",{enumerable:!0,get:function(){return Wut.expose}});var Gut=ite();Object.defineProperty(Kc,"DefaultSerializer",{enumerable:!0,get:function(){return Gut.DefaultSerializer}});var Hut=Vk();Object.defineProperty(Kc,"Transfer",{enumerable:!0,get:function(){return Hut.Transfer}})});var a5e=nr((are,lre)=>{(function(t,e){typeof are=="object"&&typeof lre<"u"?lre.exports=e():(t=typeof globalThis<"u"?globalThis:t||self,t.maplibregl=e())})(are,(function(){"use strict";var t={},e={};function r(n,o,s){if(e[n]=s,n==="index"){var a="var sharedModule = {}; ("+e.shared+")(sharedModule); ("+e.worker+")(sharedModule);",u={};return e.shared(u),e.index(t,u),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),t}}r("shared",["exports"],(function(n){"use strict";function o(d,c,h,_){return new(h||(h=Promise))((function(w,P){function R($){try{U(_.next($))}catch(q){P(q)}}function L($){try{U(_.throw($))}catch(q){P(q)}}function U($){var q;$.done?w($.value):(q=$.value,q instanceof h?q:new h((function(J){J(q)}))).then(R,L)}U((_=_.apply(d,c||[])).next())}))}function s(d,c){this.x=d,this.y=c}function a(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var u,p;typeof SuppressedError=="function"&&SuppressedError,s.prototype={clone(){return new s(this.x,this.y)},add(d){return this.clone()._add(d)},sub(d){return this.clone()._sub(d)},multByPoint(d){return this.clone()._multByPoint(d)},divByPoint(d){return this.clone()._divByPoint(d)},mult(d){return this.clone()._mult(d)},div(d){return this.clone()._div(d)},rotate(d){return this.clone()._rotate(d)},rotateAround(d,c){return this.clone()._rotateAround(d,c)},matMult(d){return this.clone()._matMult(d)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(d){return this.x===d.x&&this.y===d.y},dist(d){return Math.sqrt(this.distSqr(d))},distSqr(d){let c=d.x-this.x,h=d.y-this.y;return c*c+h*h},angle(){return Math.atan2(this.y,this.x)},angleTo(d){return Math.atan2(this.y-d.y,this.x-d.x)},angleWith(d){return this.angleWithSep(d.x,d.y)},angleWithSep(d,c){return Math.atan2(this.x*c-this.y*d,this.x*d+this.y*c)},_matMult(d){let c=d[2]*this.x+d[3]*this.y;return this.x=d[0]*this.x+d[1]*this.y,this.y=c,this},_add(d){return this.x+=d.x,this.y+=d.y,this},_sub(d){return this.x-=d.x,this.y-=d.y,this},_mult(d){return this.x*=d,this.y*=d,this},_div(d){return this.x/=d,this.y/=d,this},_multByPoint(d){return this.x*=d.x,this.y*=d.y,this},_divByPoint(d){return this.x/=d.x,this.y/=d.y,this},_unit(){return this._div(this.mag()),this},_perp(){let d=this.y;return this.y=this.x,this.x=-d,this},_rotate(d){let c=Math.cos(d),h=Math.sin(d),_=h*this.x+c*this.y;return this.x=c*this.x-h*this.y,this.y=_,this},_rotateAround(d,c){let h=Math.cos(d),_=Math.sin(d),w=c.y+_*(this.x-c.x)+h*(this.y-c.y);return this.x=c.x+h*(this.x-c.x)-_*(this.y-c.y),this.y=w,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:s},s.convert=function(d){if(d instanceof s)return d;if(Array.isArray(d))return new s(+d[0],+d[1]);if(d.x!==void 0&&d.y!==void 0)return new s(+d.x,+d.y);throw new Error("Expected [x, y] or {x, y} point format")};var m=(function(){if(p)return u;function d(c,h,_,w){this.cx=3*c,this.bx=3*(_-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(w-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=h,this.p2x=_,this.p2y=w}return p=1,u=d,d.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,h){if(h===void 0&&(h=1e-6),c<0)return 0;if(c>1)return 1;for(var _=c,w=0;w<8;w++){var P=this.sampleCurveX(_)-c;if(Math.abs(P)<h)return _;var R=this.sampleCurveDerivativeX(_);if(Math.abs(R)<1e-6)break;_-=P/R}var L=0,U=1;for(_=c,w=0;w<20&&(P=this.sampleCurveX(_),!(Math.abs(P-c)<h));w++)c>P?L=_:U=_,_=.5*(U-L)+L;return _},solve:function(c,h){return this.sampleCurveY(this.solveCurveX(c,h))}},u})(),x=a(m);let M,k;function F(){return M==null&&(M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),M}function j(){if(k==null&&(k=!1,F())){let c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let _=0;_<25;_++){let w=4*_;c.fillStyle=`rgb(${w},${w+1},${w+2})`,c.fillRect(_%5,Math.floor(_/5),1,1)}let h=c.getImageData(0,0,5,5).data;for(let _=0;_<100;_++)if(_%4!=3&&h[_]!==_){k=!0;break}}}return k||!1}var H=1e-6,W=typeof Float32Array<"u"?Float32Array:Array;function Z(){var d=new W(9);return W!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function Y(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function ee(){var d=new W(3);return W!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function ce(d){var c=d[0],h=d[1],_=d[2];return Math.sqrt(c*c+h*h+_*_)}function ge(d,c,h){var _=new W(3);return _[0]=d,_[1]=c,_[2]=h,_}function Se(d,c,h){return d[0]=c[0]+h[0],d[1]=c[1]+h[1],d[2]=c[2]+h[2],d}function ne(d,c,h){return d[0]=c[0]*h,d[1]=c[1]*h,d[2]=c[2]*h,d}function pe(d,c,h){var _=c[0],w=c[1],P=c[2],R=h[0],L=h[1],U=h[2];return d[0]=w*U-P*L,d[1]=P*R-_*U,d[2]=_*L-w*R,d}var ue,Le=ce;function We(d,c,h){var _=c[0],w=c[1],P=c[2],R=c[3];return d[0]=h[0]*_+h[4]*w+h[8]*P+h[12]*R,d[1]=h[1]*_+h[5]*w+h[9]*P+h[13]*R,d[2]=h[2]*_+h[6]*w+h[10]*P+h[14]*R,d[3]=h[3]*_+h[7]*w+h[11]*P+h[15]*R,d}function ze(){var d=new W(4);return W!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function rt(d,c,h,_){var w=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",P=Math.PI/360;c*=P,_*=P,h*=P;var R=Math.sin(c),L=Math.cos(c),U=Math.sin(h),$=Math.cos(h),q=Math.sin(_),J=Math.cos(_);switch(w){case"xyz":d[0]=R*$*J+L*U*q,d[1]=L*U*J-R*$*q,d[2]=L*$*q+R*U*J,d[3]=L*$*J-R*U*q;break;case"xzy":d[0]=R*$*J-L*U*q,d[1]=L*U*J-R*$*q,d[2]=L*$*q+R*U*J,d[3]=L*$*J+R*U*q;break;case"yxz":d[0]=R*$*J+L*U*q,d[1]=L*U*J-R*$*q,d[2]=L*$*q-R*U*J,d[3]=L*$*J+R*U*q;break;case"yzx":d[0]=R*$*J+L*U*q,d[1]=L*U*J+R*$*q,d[2]=L*$*q-R*U*J,d[3]=L*$*J-R*U*q;break;case"zxy":d[0]=R*$*J-L*U*q,d[1]=L*U*J+R*$*q,d[2]=L*$*q+R*U*J,d[3]=L*$*J-R*U*q;break;case"zyx":d[0]=R*$*J-L*U*q,d[1]=L*U*J+R*$*q,d[2]=L*$*q-R*U*J,d[3]=L*$*J+R*U*q;break;default:throw new Error("Unknown angle order "+w)}return d}function at(){var d=new W(2);return W!=Float32Array&&(d[0]=0,d[1]=0),d}function Wt(d,c){var h=new W(2);return h[0]=d,h[1]=c,h}ee(),ue=new W(4),W!=Float32Array&&(ue[0]=0,ue[1]=0,ue[2]=0,ue[3]=0),ee(),ge(1,0,0),ge(0,1,0),ze(),ze(),Z(),at();let It=8192;function Bt(d,c,h){return c*(It/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}function Qt(d,c){return(d%c+c)%c}function hr(d,c,h){return d*(1-h)+c*h}function nt(d){if(d<=0)return 0;if(d>=1)return 1;let c=d*d,h=c*d;return 4*(d<.5?h:3*(d-c)+h-.75)}function Et(d,c,h,_){let w=new x(d,c,h,_);return P=>w.solve(P)}let yr=Et(.25,.1,.25,1);function xr(d,c,h){return Math.min(h,Math.max(c,d))}function oi(d,c,h){let _=h-c,w=((d-c)%_+_)%_+c;return w===c?h:w}function jr(d,...c){for(let h of c)for(let _ in h)d[_]=h[_];return d}let zi=1;function on(d,c,h){let _={};for(let w in d)_[w]=c.call(this,d[w],w,d);return _}function Ki(d,c,h){let _={};for(let w in d)c.call(this,d[w],w,d)&&(_[w]=d[w]);return _}function hn(d){return Array.isArray(d)?d.map(hn):typeof d=="object"&&d?on(d,hn):d}let _l={};function xn(d){_l[d]||(typeof console<"u"&&console.warn(d),_l[d]=!0)}function dn(d,c,h){return(h.y-d.y)*(c.x-d.x)>(c.y-d.y)*(h.x-d.x)}function Pa(d){return typeof WorkerGlobalScope<"u"&&d!==void 0&&d instanceof WorkerGlobalScope}let vl=null;function cs(d){if(vl==null){let c=d.navigator?d.navigator.userAgent:null;vl=!!d.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return vl}function Ss(d){return typeof ImageBitmap<"u"&&d instanceof ImageBitmap}let Wl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Gl(d,c,h,_,w){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let P=new VideoFrame(d,{timestamp:0});try{let R=P?.format;if(!R||!R.startsWith("BGR")&&!R.startsWith("RGB"))throw new Error(`Unrecognized format ${R}`);let L=R.startsWith("BGR"),U=new Uint8ClampedArray(_*w*4);if(yield P.copyTo(U,(function($,q,J,oe,se){let le=4*Math.max(-q,0),ye=(Math.max(0,J)-J)*oe*4+le,we=4*oe,Re=Math.max(0,q),st=Math.max(0,J);return{rect:{x:Re,y:st,width:Math.min($.width,q+oe)-Re,height:Math.min($.height,J+se)-st},layout:[{offset:ye,stride:we}]}})(d,c,h,_,w)),L)for(let $=0;$<U.length;$+=4){let q=U[$];U[$]=U[$+2],U[$+2]=q}return U}finally{P.close()}}))}let _c,us;function $s(d,c,h,_){return d.addEventListener(c,h,_),{unsubscribe:()=>{d.removeEventListener(c,h,_)}}}function vc(d){return d*Math.PI/180}function bl(d){return d/Math.PI*180}let rm={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ia={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Hl="AbortError";function Je(){return new Error(Hl)}let he={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function fe(d){return he.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}let xe="global-dispatcher";class Ne extends Error{constructor(c,h,_,w){super(`AJAXError: ${h} (${c}): ${_}`),this.status=c,this.statusText=h,this.url=_,this.body=w}}let $e=()=>Pa(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,tt=function(d,c){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){let _=fe(d.url);if(_)return _(d,c);if(Pa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:xe},c)}if(!(/^file:/.test(h=d.url)||/^file:/.test($e())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(_,w){return o(this,void 0,void 0,(function*(){let P=new Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,cache:_.cache,referrer:$e(),signal:w.signal}),R,L;_.type!=="json"||P.headers.has("Accept")||P.headers.set("Accept","application/json");try{R=yield fetch(P)}catch($){throw new Ne(0,$.message,_.url,new Blob)}if(!R.ok){let $=yield R.blob();throw new Ne(R.status,R.statusText,_.url,$)}L=_.type==="arrayBuffer"||_.type==="image"?R.arrayBuffer():_.type==="json"?R.json():R.text();let U=yield L;if(w.signal.aborted)throw Je();return{data:U,cacheControl:R.headers.get("Cache-Control"),expires:R.headers.get("Expires")}}))})(d,c);if(Pa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:xe},c)}var h;return(function(_,w){return new Promise(((P,R)=>{var L;let U=new XMLHttpRequest;U.open(_.method||"GET",_.url,!0),_.type!=="arrayBuffer"&&_.type!=="image"||(U.responseType="arraybuffer");for(let $ in _.headers)U.setRequestHeader($,_.headers[$]);_.type==="json"&&(U.responseType="text",!((L=_.headers)===null||L===void 0)&&L.Accept||U.setRequestHeader("Accept","application/json")),U.withCredentials=_.credentials==="include",U.onerror=()=>{R(new Error(U.statusText))},U.onload=()=>{if(!w.signal.aborted)if((U.status>=200&&U.status<300||U.status===0)&&U.response!==null){let $=U.response;if(_.type==="json")try{$=JSON.parse(U.response)}catch(q){return void R(q)}P({data:$,cacheControl:U.getResponseHeader("Cache-Control"),expires:U.getResponseHeader("Expires")})}else{let $=new Blob([U.response],{type:U.getResponseHeader("Content-Type")});R(new Ne(U.status,U.statusText,_.url,$))}},w.signal.addEventListener("abort",(()=>{U.abort(),R(Je())})),U.send(_.body)}))})(d,c)};function yt(d){if(!d||d.indexOf("://")<=0||d.indexOf("data:image/")===0||d.indexOf("blob:")===0)return!0;let c=new URL(d),h=window.location;return c.protocol===h.protocol&&c.host===h.host}function it(d,c,h){h[d]&&h[d].indexOf(c)!==-1||(h[d]=h[d]||[],h[d].push(c))}function xt(d,c,h){if(h&&h[d]){let _=h[d].indexOf(c);_!==-1&&h[d].splice(_,1)}}class Ft{constructor(c,h={}){jr(this,h),this.type=c}}class Ct extends Ft{constructor(c,h={}){super("error",jr({error:c},h))}}class vr{on(c,h){return this._listeners=this._listeners||{},it(c,h,this._listeners),{unsubscribe:()=>{this.off(c,h)}}}off(c,h){return xt(c,h,this._listeners),xt(c,h,this._oneTimeListeners),this}once(c,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},it(c,h,this._oneTimeListeners),this):new Promise((_=>this.once(c,_)))}fire(c,h){typeof c=="string"&&(c=new Ft(c,h||{}));let _=c.type;if(this.listens(_)){c.target=this;let w=this._listeners&&this._listeners[_]?this._listeners[_].slice():[];for(let L of w)L.call(this,c);let P=this._oneTimeListeners&&this._oneTimeListeners[_]?this._oneTimeListeners[_].slice():[];for(let L of P)xt(_,L,this._oneTimeListeners),L.call(this,c);let R=this._eventedParent;R&&(jr(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),R.fire(c))}else c instanceof Ct&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,h){return this._eventedParent=c,this._eventedParentData=h,this}}var lt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Ei=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jn(d,c){let h={};for(let _ in d)_!=="ref"&&(h[_]=d[_]);return Ei.forEach((_=>{_ in c&&(h[_]=c[_])})),h}function wr(d,c){if(Array.isArray(d)){if(!Array.isArray(c)||d.length!==c.length)return!1;for(let h=0;h<d.length;h++)if(!wr(d[h],c[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&c!==null){if(typeof c!="object"||Object.keys(d).length!==Object.keys(c).length)return!1;for(let h in d)if(!wr(d[h],c[h]))return!1;return!0}return d===c}function di(d,c){d.push(c)}function rn(d,c,h){di(h,{command:"addSource",args:[d,c[d]]})}function Jo(d,c,h){di(c,{command:"removeSource",args:[d]}),h[d]=!0}function Lt(d,c,h,_){Jo(d,h,_),rn(d,c,h)}function Ws(d,c,h){let _;for(_ in d[h])if(Object.prototype.hasOwnProperty.call(d[h],_)&&_!=="data"&&!wr(d[h][_],c[h][_]))return!1;for(_ in c[h])if(Object.prototype.hasOwnProperty.call(c[h],_)&&_!=="data"&&!wr(d[h][_],c[h][_]))return!1;return!0}function ko(d,c,h,_,w,P){d=d||{},c=c||{};for(let R in d)Object.prototype.hasOwnProperty.call(d,R)&&(wr(d[R],c[R])||h.push({command:P,args:[_,R,c[R],w]}));for(let R in c)Object.prototype.hasOwnProperty.call(c,R)&&!Object.prototype.hasOwnProperty.call(d,R)&&(wr(d[R],c[R])||h.push({command:P,args:[_,R,c[R],w]}))}function Zn(d){return d.id}function Vo(d,c){return d[c.id]=c,d}class Ot{constructor(c,h,_,w){this.message=(c?`${c}: `:"")+_,w&&(this.identifier=w),h!=null&&h.__line__&&(this.line=h.__line__)}}function wo(d,...c){for(let h of c)for(let _ in h)d[_]=h[_];return d}class ka extends Error{constructor(c,h){super(h),this.message=h,this.key=c}}class tf{constructor(c,h=[]){this.parent=c,this.bindings={};for(let[_,w]of h)this.bindings[_]=w}concat(c){return new tf(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}let Ra={kind:"null"},Kt={kind:"number"},fi={kind:"string"},Si={kind:"boolean"},ql={kind:"color"},im={kind:"projectionDefinition"},Gu={kind:"object"},Kr={kind:"value"},rf={kind:"collator"},yp={kind:"formatted"},_p={kind:"padding"},nm={kind:"colorArray"},nf={kind:"numberArray"},om={kind:"resolvedImage"},Hu={kind:"variableAnchorOffsetCollection"};function Oa(d,c){return{kind:"array",itemType:d,N:c}}function Ii(d){if(d.kind==="array"){let c=Ii(d.itemType);return typeof d.N=="number"?`array<${c}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${c}>`}return d.kind}let k4=[Ra,Kt,fi,Si,ql,im,yp,Gu,Oa(Kr),_p,nf,nm,om,Hu];function vp(d,c){if(c.kind==="error")return null;if(d.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!vp(d.itemType,c.itemType))&&(typeof d.N!="number"||d.N===c.N))return null}else{if(d.kind===c.kind)return null;if(d.kind==="value"){for(let h of k4)if(!vp(h,c))return null}}return`Expected ${Ii(d)} but found ${Ii(c)} instead.`}function of(d,c){return c.some((h=>h.kind===d.kind))}function $h(d,c){return c.some((h=>h==="null"?d===null:h==="array"?Array.isArray(d):h==="object"?d&&!Array.isArray(d)&&typeof d=="object":h===typeof d))}function Wh(d,c){return d.kind==="array"&&c.kind==="array"?d.itemType.kind===c.itemType.kind&&typeof d.N=="number":d.kind===c.kind}let Rx=.96422,lv=.82521,cv=4/29,sf=6/29,Ox=3*sf*sf,R4=sf*sf*sf,O4=Math.PI/180,D4=180/Math.PI;function Dx(d){return(d%=360)<0&&(d+=360),d}function Lx([d,c,h,_]){let w,P,R=aA((.2225045*(d=uv(d))+.7168786*(c=uv(c))+.0606169*(h=uv(h)))/1);d===c&&c===h?w=P=R:(w=aA((.4360747*d+.3850649*c+.1430804*h)/Rx),P=aA((.0139322*d+.0971045*c+.7141733*h)/lv));let L=116*R-16;return[L<0?0:L,500*(w-R),200*(R-P),_]}function uv(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function aA(d){return d>R4?Math.pow(d,1/3):d/Ox+cv}function bp([d,c,h,_]){let w=(d+16)/116,P=isNaN(c)?w:w+c/500,R=isNaN(h)?w:w-h/200;return w=1*dv(w),P=Rx*dv(P),R=lv*dv(R),[hv(3.1338561*P-1.6168667*w-.4906146*R),hv(-.9787684*P+1.9161415*w+.033454*R),hv(.0719453*P-.2289914*w+1.4052427*R),_]}function hv(d){return(d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055)<0?0:d>1?1:d}function dv(d){return d>sf?d*d*d:Ox*(d-cv)}let sm=Object.hasOwn||function(d,c){return Object.prototype.hasOwnProperty.call(d,c)};function am(d,c){return sm(d,c)?d[c]:void 0}function lA(d){return parseInt(d.padEnd(2,d),16)/255}function Bx(d,c){return af(c?d/100:d,0,1)}function af(d,c,h){return Math.min(Math.max(c,d),h)}function fv(d){return!d.some(Number.isNaN)}let iu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function gi(d,c,h){return d+h*(c-d)}function bc(d,c,h){return d.map(((_,w)=>gi(_,c[w],h)))}class ci{constructor(c,h,_,w=1,P=!0){this.r=c,this.g=h,this.b=_,this.a=w,P||(this.r*=w,this.g*=w,this.b*=w,w||this.overwriteGetter("rgb",[c,h,_,w]))}static parse(c){if(c instanceof ci)return c;if(typeof c!="string")return;let h=(function(_){if((_=_.toLowerCase().trim())==="transparent")return[0,0,0,0];let w=am(iu,_);if(w){let[R,L,U]=w;return[R/255,L/255,U/255,1]}if(_.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(_)){let R=_.length<6?1:2,L=1;return[lA(_.slice(L,L+=R)),lA(_.slice(L,L+=R)),lA(_.slice(L,L+=R)),lA(_.slice(L,L+R)||"ff")]}if(_.startsWith("rgb")){let R=_.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(R){let[L,U,$,q,J,oe,se,le,ye,we,Re,st]=R,Ue=[q||" ",se||" ",we].join("");if(Ue==="  "||Ue==="  /"||Ue===",,"||Ue===",,,"){let Ge=[$,oe,ye].join(""),_t=Ge==="%%%"?100:Ge===""?255:0;if(_t){let Mt=[af(+U/_t,0,1),af(+J/_t,0,1),af(+le/_t,0,1),Re?Bx(+Re,st):1];if(fv(Mt))return Mt}}return}}let P=_.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(P){let[R,L,U,$,q,J,oe,se,le]=P,ye=[U||" ",q||" ",oe].join("");if(ye==="  "||ye==="  /"||ye===",,"||ye===",,,"){let we=[+L,af(+$,0,100),af(+J,0,100),se?Bx(+se,le):1];if(fv(we))return(function([Re,st,Ue,Ge]){function _t(Mt){let Ut=(Mt+Re/30)%12,ir=st*Math.min(Ue,1-Ue);return Ue-ir*Math.max(-1,Math.min(Ut-3,9-Ut,1))}return Re=Dx(Re),st/=100,Ue/=100,[_t(0),_t(8),_t(4),Ge]})(we)}}})(c);return h?new ci(...h,!1):void 0}get rgb(){let{r:c,g:h,b:_,a:w}=this,P=w||1/0;return this.overwriteGetter("rgb",[c/P,h/P,_/P,w])}get hcl(){return this.overwriteGetter("hcl",(function(c){let[h,_,w,P]=Lx(c),R=Math.sqrt(_*_+w*w);return[Math.round(1e4*R)?Dx(Math.atan2(w,_)*D4):NaN,R,h,P]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Lx(this.rgb))}overwriteGetter(c,h){return Object.defineProperty(this,c,{value:h}),h}toString(){let[c,h,_,w]=this.rgb;return`rgba(${[c,h,_].map((P=>Math.round(255*P))).join(",")},${w})`}static interpolate(c,h,_,w="rgb"){switch(w){case"rgb":{let[P,R,L,U]=bc(c.rgb,h.rgb,_);return new ci(P,R,L,U,!1)}case"hcl":{let[P,R,L,U]=c.hcl,[$,q,J,oe]=h.hcl,se,le;if(isNaN(P)||isNaN($))isNaN(P)?isNaN($)?se=NaN:(se=$,L!==1&&L!==0||(le=q)):(se=P,J!==1&&J!==0||(le=R));else{let Ue=$-P;$>P&&Ue>180?Ue-=360:$<P&&P-$>180&&(Ue+=360),se=P+_*Ue}let[ye,we,Re,st]=(function([Ue,Ge,_t,Mt]){return Ue=isNaN(Ue)?0:Ue*O4,bp([_t,Math.cos(Ue)*Ge,Math.sin(Ue)*Ge,Mt])})([se,le??gi(R,q,_),gi(L,J,_),gi(U,oe,_)]);return new ci(ye,we,Re,st,!1)}case"lab":{let[P,R,L,U]=bp(bc(c.lab,h.lab,_));return new ci(P,R,L,U,!1)}}}}ci.black=new ci(0,0,0,1),ci.white=new ci(1,1,1,1),ci.transparent=new ci(0,0,0,0),ci.red=new ci(1,0,0,1);class cA{constructor(c,h,_){this.sensitivity=c?h?"variant":"case":h?"accent":"base",this.locale=_,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,h){return this.collator.compare(c,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let Fx=["bottom","center","top"];class lm{constructor(c,h,_,w,P,R){this.text=c,this.image=h,this.scale=_,this.fontStack=w,this.textColor=P,this.verticalAlign=R}}class Gs{constructor(c){this.sections=c}static fromString(c){return new Gs([new lm(c,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((c=>c.text.length!==0||c.image&&c.image.name.length!==0))}static factory(c){return c instanceof Gs?c:Gs.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map((c=>c.text)).join("")}}class Ts{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Ts)return c;if(typeof c=="number")return new Ts([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(let h of c)if(typeof h!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new Ts(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,h,_){return new Ts(bc(c.values,h.values,_))}}class ca{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof ca)return c;if(typeof c=="number")return new ca([c]);if(Array.isArray(c)){for(let h of c)if(typeof h!="number")return;return new ca(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,h,_){return new ca(bc(c.values,h.values,_))}}class hs{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof hs)return c;if(typeof c=="string"){let _=ci.parse(c);return _?new hs([_]):void 0}if(!Array.isArray(c))return;let h=[];for(let _ of c){if(typeof _!="string")return;let w=ci.parse(_);if(!w)return;h.push(w)}return new hs(h)}toString(){return JSON.stringify(this.values)}static interpolate(c,h,_,w="rgb"){let P=[];if(c.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${c.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let R=0;R<c.values.length;R++)P.push(ci.interpolate(c.values[R],h.values[R],_,w));return new hs(P)}}class $n extends Error{constructor(c){super(c),this.name="RuntimeError"}toJSON(){return this.message}}let L4=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Hs{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Hs)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let h=0;h<c.length;h+=2){let _=c[h],w=c[h+1];if(typeof _!="string"||!L4.has(_)||!Array.isArray(w)||w.length!==2||typeof w[0]!="number"||typeof w[1]!="number")return}return new Hs(c)}}toString(){return JSON.stringify(this.values)}static interpolate(c,h,_){let w=c.values,P=h.values;if(w.length!==P.length)throw new $n(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${h.toString()}`);let R=[];for(let L=0;L<w.length;L+=2){if(w[L]!==P[L])throw new $n(`Cannot interpolate values containing mismatched anchors. from[${L}]: ${w[L]}, to[${L}]: ${P[L]}`);R.push(w[L]);let[U,$]=w[L+1],[q,J]=P[L+1];R.push([gi(U,q,_),gi($,J,_)])}return new Hs(R)}}class qs{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new qs({name:c,available:!1}):null}}class Ja{constructor(c,h,_){this.from=c,this.to=h,this.transition=_}static interpolate(c,h,_){return new Ja(c,h,_)}static parse(c){return c instanceof Ja?c:Array.isArray(c)&&c.length===3&&typeof c[0]=="string"&&typeof c[1]=="string"&&typeof c[2]=="number"?new Ja(c[0],c[1],c[2]):typeof c=="object"&&typeof c.from=="string"&&typeof c.to=="string"&&typeof c.transition=="number"?new Ja(c.from,c.to,c.transition):typeof c=="string"?new Ja(c,c,1):void 0}}function pv(d,c,h,_){return typeof d=="number"&&d>=0&&d<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof h=="number"&&h>=0&&h<=255?_===void 0||typeof _=="number"&&_>=0&&_<=1?null:`Invalid rgba value [${[d,c,h,_].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof _=="number"?[d,c,h,_]:[d,c,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function xp(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Ja||d instanceof ci||d instanceof cA||d instanceof Gs||d instanceof Ts||d instanceof ca||d instanceof hs||d instanceof Hs||d instanceof qs)return!0;if(Array.isArray(d)){for(let c of d)if(!xp(c))return!1;return!0}if(typeof d=="object"){for(let c in d)if(!xp(d[c]))return!1;return!0}return!1}function uo(d){if(d===null)return Ra;if(typeof d=="string")return fi;if(typeof d=="boolean")return Si;if(typeof d=="number")return Kt;if(d instanceof ci)return ql;if(d instanceof Ja)return im;if(d instanceof cA)return rf;if(d instanceof Gs)return yp;if(d instanceof Ts)return _p;if(d instanceof ca)return nf;if(d instanceof hs)return nm;if(d instanceof Hs)return Hu;if(d instanceof qs)return om;if(Array.isArray(d)){let c=d.length,h;for(let _ of d){let w=uo(_);if(h){if(h===w)continue;h=Kr;break}h=w}return Oa(h||Kr,c)}return Gu}function Mn(d){let c=typeof d;return d===null?"":c==="string"||c==="number"||c==="boolean"?String(d):d instanceof ci||d instanceof Ja||d instanceof Gs||d instanceof Ts||d instanceof ca||d instanceof hs||d instanceof Hs||d instanceof qs?d.toString():JSON.stringify(d)}class qu{constructor(c,h){this.type=c,this.value=h}static parse(c,h){if(c.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!xp(c[1]))return h.error("invalid value");let _=c[1],w=uo(_),P=h.expectedType;return w.kind!=="array"||w.N!==0||!P||P.kind!=="array"||typeof P.N=="number"&&P.N!==0||(w=P),new qu(w,_)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let $i={string:fi,number:Kt,boolean:Si,object:Gu};class zr{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let _,w=1,P=c[0];if(P==="array"){let L,U;if(c.length>2){let $=c[1];if(typeof $!="string"||!($ in $i)||$==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);L=$i[$],w++}else L=Kr;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return h.error('The length argument to "array" must be a positive integer literal',2);U=c[2],w++}_=Oa(L,U)}else{if(!$i[P])throw new Error(`Types doesn't contain name = ${P}`);_=$i[P]}let R=[];for(;w<c.length;w++){let L=h.parse(c[w],w,Kr);if(!L)return null;R.push(L)}return new zr(_,R)}evaluate(c){for(let h=0;h<this.args.length;h++){let _=this.args[h].evaluate(c);if(!vp(this.type,uo(_)))return _;if(h===this.args.length-1)throw new $n(`Expected value to be of type ${Ii(this.type)}, but found ${Ii(uo(_))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}let uA={"to-boolean":Si,"to-color":ql,"to-number":Kt,"to-string":fi};class ki{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let _=c[0];if(!uA[_])throw new Error(`Can't parse ${_} as it is not part of the known types`);if((_==="to-boolean"||_==="to-string")&&c.length!==2)return h.error("Expected one argument.");let w=uA[_],P=[];for(let R=1;R<c.length;R++){let L=h.parse(c[R],R,Kr);if(!L)return null;P.push(L)}return new ki(w,P)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let h,_;for(let w of this.args){if(h=w.evaluate(c),_=null,h instanceof ci)return h;if(typeof h=="string"){let P=c.parseColor(h);if(P)return P}else if(Array.isArray(h)&&(_=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:pv(h[0],h[1],h[2],h[3]),!_))return new ci(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new $n(_||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(let _ of this.args){h=_.evaluate(c);let w=Ts.parse(h);if(w)return w}throw new $n(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(let _ of this.args){h=_.evaluate(c);let w=ca.parse(h);if(w)return w}throw new $n(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(let _ of this.args){h=_.evaluate(c);let w=hs.parse(h);if(w)return w}throw new $n(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(let _ of this.args){h=_.evaluate(c);let w=Hs.parse(h);if(w)return w}throw new $n(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(let _ of this.args){if(h=_.evaluate(c),h===null)return 0;let w=Number(h);if(!isNaN(w))return w}throw new $n(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Gs.fromString(Mn(this.args[0].evaluate(c)));case"resolvedImage":return qs.fromString(Mn(this.args[0].evaluate(c)));case"projectionDefinition":return this.args[0].evaluate(c);default:return Mn(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}let mv=["Unknown","Point","LineString","Polygon"];class nu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?mv[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let h=this._parseColorCache.get(c);return h||(h=ci.parse(c),this._parseColorCache.set(c,h)),h}}class wp{constructor(c,h,_=[],w,P=new tf,R=[]){this.registry=c,this.path=_,this.key=_.map((L=>`[${L}]`)).join(""),this.scope=P,this.errors=R,this.expectedType=w,this._isConstant=h}parse(c,h,_,w,P={}){return h?this.concat(h,_,w)._parse(c,P):this._parse(c,P)}_parse(c,h){function _(w,P,R){return R==="assert"?new zr(P,[w]):R==="coerce"?new ki(P,[w]):w}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let w=c[0];if(typeof w!="string")return this.error(`Expression name must be a string, but found ${typeof w} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let P=this.registry[w];if(P){let R=P.parse(c,this);if(!R)return null;if(this.expectedType){let L=this.expectedType,U=R.type;if(L.kind!=="string"&&L.kind!=="number"&&L.kind!=="boolean"&&L.kind!=="object"&&L.kind!=="array"||U.kind!=="value"){if(L.kind==="projectionDefinition"&&["string","array"].includes(U.kind)||["color","formatted","resolvedImage"].includes(L.kind)&&["value","string"].includes(U.kind)||["padding","numberArray"].includes(L.kind)&&["value","number","array"].includes(U.kind)||L.kind==="colorArray"&&["value","string","array"].includes(U.kind)||L.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(U.kind))R=_(R,L,h.typeAnnotation||"coerce");else if(this.checkSubtype(L,U))return null}else R=_(R,L,h.typeAnnotation||"assert")}if(!(R instanceof qu)&&R.type.kind!=="resolvedImage"&&this._isConstant(R)){let L=new nu;try{R=new qu(R.type,R.evaluate(L))}catch(U){return this.error(U.message),null}}return R}return this.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,h,_){let w=typeof c=="number"?this.path.concat(c):this.path,P=_?this.scope.concat(_):this.scope;return new wp(this.registry,this._isConstant,w,h||null,P,this.errors)}error(c,...h){let _=`${this.key}${h.map((w=>`[${w}]`)).join("")}`;this.errors.push(new ka(_,c))}checkSubtype(c,h){let _=vp(c,h);return _&&this.error(_),_}}class lf{constructor(c,h){this.type=h.type,this.bindings=[].concat(c),this.result=h}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(let h of this.bindings)c(h[1]);c(this.result)}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);let _=[];for(let P=1;P<c.length-1;P+=2){let R=c[P];if(typeof R!="string")return h.error(`Expected string, but found ${typeof R} instead.`,P);if(/[^a-zA-Z0-9_]/.test(R))return h.error("Variable names must contain only alphanumeric characters or '_'.",P);let L=h.parse(c[P+1],P+1);if(!L)return null;_.push([R,L])}let w=h.parse(c[c.length-1],c.length-1,h.expectedType,_);return w?new lf(_,w):null}outputDefined(){return this.result.outputDefined()}}class cm{constructor(c,h){this.type=h.type,this.name=c,this.boundExpression=h}static parse(c,h){if(c.length!==2||typeof c[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");let _=c[1];return h.scope.has(_)?new cm(_,h.scope.get(_)):h.error(`Unknown variable "${_}". Make sure "${_}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class um{constructor(c,h,_){this.type=c,this.index=h,this.input=_}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);let _=h.parse(c[1],1,Kt),w=h.parse(c[2],2,Oa(h.expectedType||Kr));return _&&w?new um(w.type.itemType,_,w):null}evaluate(c){let h=this.index.evaluate(c),_=this.input.evaluate(c);if(h<0)throw new $n(`Array index out of bounds: ${h} < 0.`);if(h>=_.length)throw new $n(`Array index out of bounds: ${h} > ${_.length-1}.`);if(h!==Math.floor(h))throw new $n(`Array index must be an integer, but found ${h} instead.`);return _[h]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class Xt{constructor(c,h){this.type=Si,this.needle=c,this.haystack=h}static parse(c,h){if(c.length!==3)return h.error(`Expected 2 arguments, but found ${c.length-1} instead.`);let _=h.parse(c[1],1,Kr),w=h.parse(c[2],2,Kr);return _&&w?of(_.type,[Si,fi,Kt,Ra,Kr])?new Xt(_,w):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(_.type)} instead`):null}evaluate(c){let h=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(!_)return!1;if(!$h(h,["boolean","string","number","null"]))throw new $n(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(uo(h))} instead.`);if(!$h(_,["string","array"]))throw new $n(`Expected second argument to be of type array or string, but found ${Ii(uo(_))} instead.`);return _.indexOf(h)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class ur{constructor(c,h,_){this.type=Kt,this.needle=c,this.haystack=h,this.fromIndex=_}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${c.length-1} instead.`);let _=h.parse(c[1],1,Kr),w=h.parse(c[2],2,Kr);if(!_||!w)return null;if(!of(_.type,[Si,fi,Kt,Ra,Kr]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(_.type)} instead`);if(c.length===4){let P=h.parse(c[3],3,Kt);return P?new ur(_,w,P):null}return new ur(_,w)}evaluate(c){let h=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(!$h(h,["boolean","string","number","null"]))throw new $n(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(uo(h))} instead.`);let w;if(this.fromIndex&&(w=this.fromIndex.evaluate(c)),$h(_,["string"])){let P=_.indexOf(h,w);return P===-1?-1:[..._.slice(0,P)].length}if($h(_,["array"]))return _.indexOf(h,w);throw new $n(`Expected second argument to be of type array or string, but found ${Ii(uo(_))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class Ir{constructor(c,h,_,w,P,R){this.inputType=c,this.type=h,this.input=_,this.cases=w,this.outputs=P,this.otherwise=R}static parse(c,h){if(c.length<5)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return h.error("Expected an even number of arguments.");let _,w;h.expectedType&&h.expectedType.kind!=="value"&&(w=h.expectedType);let P={},R=[];for(let $=2;$<c.length-1;$+=2){let q=c[$],J=c[$+1];Array.isArray(q)||(q=[q]);let oe=h.concat($);if(q.length===0)return oe.error("Expected at least one branch label.");for(let le of q){if(typeof le!="number"&&typeof le!="string")return oe.error("Branch labels must be numbers or strings.");if(typeof le=="number"&&Math.abs(le)>Number.MAX_SAFE_INTEGER)return oe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof le=="number"&&Math.floor(le)!==le)return oe.error("Numeric branch labels must be integer values.");if(_){if(oe.checkSubtype(_,uo(le)))return null}else _=uo(le);if(P[String(le)]!==void 0)return oe.error("Branch labels must be unique.");P[String(le)]=R.length}let se=h.parse(J,$,w);if(!se)return null;w=w||se.type,R.push(se)}let L=h.parse(c[1],1,Kr);if(!L)return null;let U=h.parse(c[c.length-1],c.length-1,w);return U?L.type.kind!=="value"&&h.concat(1).checkSubtype(_,L.type)?null:new Ir(_,w,L,P,R,U):null}evaluate(c){let h=this.input.evaluate(c);return(uo(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))&&this.otherwise.outputDefined()}}class Di{constructor(c,h,_){this.type=c,this.branches=h,this.otherwise=_}static parse(c,h){if(c.length<4)return h.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return h.error("Expected an odd number of arguments.");let _;h.expectedType&&h.expectedType.kind!=="value"&&(_=h.expectedType);let w=[];for(let R=1;R<c.length-1;R+=2){let L=h.parse(c[R],R,Si);if(!L)return null;let U=h.parse(c[R+1],R+1,_);if(!U)return null;w.push([L,U]),_=_||U.type}let P=h.parse(c[c.length-1],c.length-1,_);if(!P)return null;if(!_)throw new Error("Can't infer output type");return new Di(_,w,P)}evaluate(c){for(let[h,_]of this.branches)if(h.evaluate(c))return _.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(let[h,_]of this.branches)c(h),c(_);c(this.otherwise)}outputDefined(){return this.branches.every((([c,h])=>h.outputDefined()))&&this.otherwise.outputDefined()}}class Qi{constructor(c,h,_,w){this.type=c,this.input=h,this.beginIndex=_,this.endIndex=w}static parse(c,h){if(c.length<=2||c.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${c.length-1} instead.`);let _=h.parse(c[1],1,Kr),w=h.parse(c[2],2,Kt);if(!_||!w)return null;if(!of(_.type,[Oa(Kr),fi,Kr]))return h.error(`Expected first argument to be of type array or string, but found ${Ii(_.type)} instead`);if(c.length===4){let P=h.parse(c[3],3,Kt);return P?new Qi(_.type,_,w,P):null}return new Qi(_.type,_,w)}evaluate(c){let h=this.input.evaluate(c),_=this.beginIndex.evaluate(c),w;if(this.endIndex&&(w=this.endIndex.evaluate(c)),$h(h,["string"]))return[...h].slice(_,w).join("");if($h(h,["array"]))return h.slice(_,w);throw new $n(`Expected first argument to be of type array or string, but found ${Ii(uo(h))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function Hi(d,c){let h=d.length-1,_,w,P=0,R=h,L=0;for(;P<=R;)if(L=Math.floor((P+R)/2),_=d[L],w=d[L+1],_<=c){if(L===h||c<w)return L;P=L+1}else{if(!(_>c))throw new $n("Input is not a number.");R=L-1}return 0}class Wn{constructor(c,h,_){this.type=c,this.input=h,this.labels=[],this.outputs=[];for(let[w,P]of _)this.labels.push(w),this.outputs.push(P)}static parse(c,h){if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");let _=h.parse(c[1],1,Kt);if(!_)return null;let w=[],P=null;h.expectedType&&h.expectedType.kind!=="value"&&(P=h.expectedType);for(let R=1;R<c.length;R+=2){let L=R===1?-1/0:c[R],U=c[R+1],$=R,q=R+1;if(typeof L!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(w.length&&w[w.length-1][0]>=L)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',$);let J=h.parse(U,q,P);if(!J)return null;P=P||J.type,w.push([L,J])}return new Wn(P,_,w)}evaluate(c){let h=this.labels,_=this.outputs;if(h.length===1)return _[0].evaluate(c);let w=this.input.evaluate(c);if(w<=h[0])return _[0].evaluate(c);let P=h.length;return w>=h[P-1]?_[P-1].evaluate(c):_[Hi(h,w)].evaluate(c)}eachChild(c){c(this.input);for(let h of this.outputs)c(h)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))}}function ou(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Yl,ho,Sp=(function(){if(ho)return Yl;function d(c,h,_,w){this.cx=3*c,this.bx=3*(_-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(w-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=h,this.p2x=_,this.p2y=w}return ho=1,Yl=d,d.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,h){if(h===void 0&&(h=1e-6),c<0)return 0;if(c>1)return 1;for(var _=c,w=0;w<8;w++){var P=this.sampleCurveX(_)-c;if(Math.abs(P)<h)return _;var R=this.sampleCurveDerivativeX(_);if(Math.abs(R)<1e-6)break;_-=P/R}var L=0,U=1;for(_=c,w=0;w<20&&(P=this.sampleCurveX(_),!(Math.abs(P-c)<h));w++)c>P?L=_:U=_,_=.5*(U-L)+L;return _},solve:function(c,h){return this.sampleCurveY(this.solveCurveX(c,h))}},Yl})(),cf=ou(Sp);class Ro{constructor(c,h,_,w,P){this.type=c,this.operator=h,this.interpolation=_,this.input=w,this.labels=[],this.outputs=[];for(let[R,L]of P)this.labels.push(R),this.outputs.push(L)}static interpolationFactor(c,h,_,w){let P=0;if(c.name==="exponential")P=xc(h,c.base,_,w);else if(c.name==="linear")P=xc(h,1,_,w);else if(c.name==="cubic-bezier"){let R=c.controlPoints;P=new cf(R[0],R[1],R[2],R[3]).solve(xc(h,1,_,w))}return P}static parse(c,h){let[_,w,P,...R]=c;if(!Array.isArray(w)||w.length===0)return h.error("Expected an interpolation type expression.",1);if(w[0]==="linear")w={name:"linear"};else if(w[0]==="exponential"){let $=w[1];if(typeof $!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:$}}else{if(w[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(w[0])}`,1,0);{let $=w.slice(1);if($.length!==4||$.some((q=>typeof q!="number"||q<0||q>1)))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:$}}}if(c.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(P=h.parse(P,2,Kt),!P)return null;let L=[],U=null;_!=="interpolate-hcl"&&_!=="interpolate-lab"||h.expectedType==nm?h.expectedType&&h.expectedType.kind!=="value"&&(U=h.expectedType):U=ql;for(let $=0;$<R.length;$+=2){let q=R[$],J=R[$+1],oe=$+3,se=$+4;if(typeof q!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',oe);if(L.length&&L[L.length-1][0]>=q)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',oe);let le=h.parse(J,se,U);if(!le)return null;U=U||le.type,L.push([q,le])}return Wh(U,Kt)||Wh(U,im)||Wh(U,ql)||Wh(U,_p)||Wh(U,nf)||Wh(U,nm)||Wh(U,Hu)||Wh(U,Oa(Kt))?new Ro(U,_,w,P,L):h.error(`Type ${Ii(U)} is not interpolatable.`)}evaluate(c){let h=this.labels,_=this.outputs;if(h.length===1)return _[0].evaluate(c);let w=this.input.evaluate(c);if(w<=h[0])return _[0].evaluate(c);let P=h.length;if(w>=h[P-1])return _[P-1].evaluate(c);let R=Hi(h,w),L=Ro.interpolationFactor(this.interpolation,w,h[R],h[R+1]),U=_[R].evaluate(c),$=_[R+1].evaluate(c);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return gi(U,$,L);case"color":return ci.interpolate(U,$,L);case"padding":return Ts.interpolate(U,$,L);case"colorArray":return hs.interpolate(U,$,L);case"numberArray":return ca.interpolate(U,$,L);case"variableAnchorOffsetCollection":return Hs.interpolate(U,$,L);case"array":return bc(U,$,L);case"projectionDefinition":return Ja.interpolate(U,$,L)}case"interpolate-hcl":switch(this.type.kind){case"color":return ci.interpolate(U,$,L,"hcl");case"colorArray":return hs.interpolate(U,$,L,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ci.interpolate(U,$,L,"lab");case"colorArray":return hs.interpolate(U,$,L,"lab")}}}eachChild(c){c(this.input);for(let h of this.outputs)c(h)}outputDefined(){return this.outputs.every((c=>c.outputDefined()))}}function xc(d,c,h,_){let w=_-h,P=d-h;return w===0?0:c===1?P/w:(Math.pow(c,P)-1)/(Math.pow(c,w)-1)}let Oo={color:ci.interpolate,number:gi,padding:Ts.interpolate,numberArray:ca.interpolate,colorArray:hs.interpolate,variableAnchorOffsetCollection:Hs.interpolate,array:bc};class Gh{constructor(c,h){this.type=c,this.args=h}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let _=null,w=h.expectedType;w&&w.kind!=="value"&&(_=w);let P=[];for(let L of c.slice(1)){let U=h.parse(L,1+P.length,_,void 0,{typeAnnotation:"omit"});if(!U)return null;_=_||U.type,P.push(U)}if(!_)throw new Error("No output type");let R=w&&P.some((L=>vp(w,L.type)));return new Gh(R?Kr:_,P)}evaluate(c){let h,_=null,w=0;for(let P of this.args)if(w++,_=P.evaluate(c),_&&_ instanceof qs&&!_.available&&(h||(h=_.name),_=null,w===this.args.length&&(_=h)),_!==null)break;return _}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every((c=>c.outputDefined()))}}function uf(d,c){return d==="=="||d==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function hA(d,c,h,_){return _.compare(c,h)===0}function Yu(d,c,h){let _=d!=="=="&&d!=="!=";return class s5e{constructor(P,R,L){this.type=Si,this.lhs=P,this.rhs=R,this.collator=L,this.hasUntypedArgument=P.type.kind==="value"||R.type.kind==="value"}static parse(P,R){if(P.length!==3&&P.length!==4)return R.error("Expected two or three arguments.");let L=P[0],U=R.parse(P[1],1,Kr);if(!U)return null;if(!uf(L,U.type))return R.concat(1).error(`"${L}" comparisons are not supported for type '${Ii(U.type)}'.`);let $=R.parse(P[2],2,Kr);if(!$)return null;if(!uf(L,$.type))return R.concat(2).error(`"${L}" comparisons are not supported for type '${Ii($.type)}'.`);if(U.type.kind!==$.type.kind&&U.type.kind!=="value"&&$.type.kind!=="value")return R.error(`Cannot compare types '${Ii(U.type)}' and '${Ii($.type)}'.`);_&&(U.type.kind==="value"&&$.type.kind!=="value"?U=new zr($.type,[U]):U.type.kind!=="value"&&$.type.kind==="value"&&($=new zr(U.type,[$])));let q=null;if(P.length===4){if(U.type.kind!=="string"&&$.type.kind!=="string"&&U.type.kind!=="value"&&$.type.kind!=="value")return R.error("Cannot use collator to compare non-string types.");if(q=R.parse(P[3],3,rf),!q)return null}return new s5e(U,$,q)}evaluate(P){let R=this.lhs.evaluate(P),L=this.rhs.evaluate(P);if(_&&this.hasUntypedArgument){let U=uo(R),$=uo(L);if(U.kind!==$.kind||U.kind!=="string"&&U.kind!=="number")throw new $n(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${U.kind}, ${$.kind}) instead.`)}if(this.collator&&!_&&this.hasUntypedArgument){let U=uo(R),$=uo(L);if(U.kind!=="string"||$.kind!=="string")return c(P,R,L)}return this.collator?h(P,R,L,this.collator.evaluate(P)):c(P,R,L)}eachChild(P){P(this.lhs),P(this.rhs),this.collator&&P(this.collator)}outputDefined(){return!0}}}let Tp=Yu("==",(function(d,c,h){return c===h}),hA),Hh=Yu("!=",(function(d,c,h){return c!==h}),(function(d,c,h,_){return!hA(0,c,h,_)})),el=Yu("<",(function(d,c,h){return c<h}),(function(d,c,h,_){return _.compare(c,h)<0})),Xu=Yu(">",(function(d,c,h){return c>h}),(function(d,c,h,_){return _.compare(c,h)>0})),vt=Yu("<=",(function(d,c,h){return c<=h}),(function(d,c,h,_){return _.compare(c,h)<=0})),Nt=Yu(">=",(function(d,c,h){return c>=h}),(function(d,c,h,_){return _.compare(c,h)>=0}));class sr{constructor(c,h,_){this.type=rf,this.locale=_,this.caseSensitive=c,this.diacriticSensitive=h}static parse(c,h){if(c.length!==2)return h.error("Expected one argument.");let _=c[1];if(typeof _!="object"||Array.isArray(_))return h.error("Collator options argument must be an object.");let w=h.parse(_["case-sensitive"]!==void 0&&_["case-sensitive"],1,Si);if(!w)return null;let P=h.parse(_["diacritic-sensitive"]!==void 0&&_["diacritic-sensitive"],1,Si);if(!P)return null;let R=null;return _.locale&&(R=h.parse(_.locale,1,fi),!R)?null:new sr(w,P,R)}evaluate(c){return new cA(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class zt{constructor(c,h,_,w,P){this.type=fi,this.number=c,this.locale=h,this.currency=_,this.minFractionDigits=w,this.maxFractionDigits=P}static parse(c,h){if(c.length!==3)return h.error("Expected two arguments.");let _=h.parse(c[1],1,Kt);if(!_)return null;let w=c[2];if(typeof w!="object"||Array.isArray(w))return h.error("NumberFormat options argument must be an object.");let P=null;if(w.locale&&(P=h.parse(w.locale,1,fi),!P))return null;let R=null;if(w.currency&&(R=h.parse(w.currency,1,fi),!R))return null;let L=null;if(w["min-fraction-digits"]&&(L=h.parse(w["min-fraction-digits"],1,Kt),!L))return null;let U=null;return w["max-fraction-digits"]&&(U=h.parse(w["max-fraction-digits"],1,Kt),!U)?null:new zt(_,P,R,L,U)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class A{constructor(c){this.type=yp,this.sections=c}static parse(c,h){if(c.length<2)return h.error("Expected at least one argument.");let _=c[1];if(!Array.isArray(_)&&typeof _=="object")return h.error("First argument must be an image or text section.");let w=[],P=!1;for(let R=1;R<=c.length-1;++R){let L=c[R];if(P&&typeof L=="object"&&!Array.isArray(L)){P=!1;let U=null;if(L["font-scale"]&&(U=h.parse(L["font-scale"],1,Kt),!U))return null;let $=null;if(L["text-font"]&&($=h.parse(L["text-font"],1,Oa(fi)),!$))return null;let q=null;if(L["text-color"]&&(q=h.parse(L["text-color"],1,ql),!q))return null;let J=null;if(L["vertical-align"]){if(typeof L["vertical-align"]=="string"&&!Fx.includes(L["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${L["vertical-align"]}' instead.`);if(J=h.parse(L["vertical-align"],1,fi),!J)return null}let oe=w[w.length-1];oe.scale=U,oe.font=$,oe.textColor=q,oe.verticalAlign=J}else{let U=h.parse(c[R],1,Kr);if(!U)return null;let $=U.type.kind;if($!=="string"&&$!=="value"&&$!=="null"&&$!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");P=!0,w.push({content:U,scale:null,font:null,textColor:null,verticalAlign:null})}}return new A(w)}evaluate(c){return new Gs(this.sections.map((h=>{let _=h.content.evaluate(c);return uo(_)===om?new lm("",_,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(c):null):new lm(Mn(_),null,h.scale?h.scale.evaluate(c):null,h.font?h.font.evaluate(c).join(","):null,h.textColor?h.textColor.evaluate(c):null,h.verticalAlign?h.verticalAlign.evaluate(c):null)})))}eachChild(c){for(let h of this.sections)c(h.content),h.scale&&c(h.scale),h.font&&c(h.font),h.textColor&&c(h.textColor),h.verticalAlign&&c(h.verticalAlign)}outputDefined(){return!1}}class wn{constructor(c){this.type=om,this.input=c}static parse(c,h){if(c.length!==2)return h.error("Expected two arguments.");let _=h.parse(c[1],1,fi);return _?new wn(_):h.error("No image name provided.")}evaluate(c){let h=this.input.evaluate(c),_=qs.fromString(h);return _&&c.availableImages&&(_.available=c.availableImages.indexOf(h)>-1),_}eachChild(c){c(this.input)}outputDefined(){return!1}}class sn{constructor(c){this.type=Kt,this.input=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);let _=h.parse(c[1],1);return _?_.type.kind!=="array"&&_.type.kind!=="string"&&_.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Ii(_.type)} instead.`):new sn(_):null}evaluate(c){let h=this.input.evaluate(c);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new $n(`Expected value to be of type string or array, but found ${Ii(uo(h))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}let de=8192;function Ms(d,c){let h=(180+d[0])/360,_=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,w=Math.pow(2,c.z);return[Math.round(h*w*de),Math.round(_*w*de)]}function Ys(d,c){let h=Math.pow(2,c.z);return[(w=(d[0]/de+c.x)/h,360*w-180),(_=(d[1]/de+c.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*_)*Math.PI/180))-90)];var _,w}function So(d,c){d[0]=Math.min(d[0],c[0]),d[1]=Math.min(d[1],c[1]),d[2]=Math.max(d[2],c[0]),d[3]=Math.max(d[3],c[1])}function qi(d,c){return!(d[0]<=c[0]||d[2]>=c[2]||d[1]<=c[1]||d[3]>=c[3])}function Kn(d,c,h){let _=d[0]-c[0],w=d[1]-c[1],P=d[0]-h[0],R=d[1]-h[1];return _*R-P*w==0&&_*P<=0&&w*R<=0}function jo(d,c,h,_){return(w=[_[0]-h[0],_[1]-h[1]])[0]*(P=[c[0]-d[0],c[1]-d[1]])[1]-w[1]*P[0]!=0&&!(!dm(d,c,h,_)||!dm(h,_,d,c));var w,P}function en(d,c,h){for(let _ of h)for(let w=0;w<_.length-1;++w)if(jo(d,c,_[w],_[w+1]))return!0;return!1}function Yi(d,c,h=!1){let _=!1;for(let L of c)for(let U=0;U<L.length-1;U++){if(Kn(d,L[U],L[U+1]))return h;(P=L[U])[1]>(w=d)[1]!=(R=L[U+1])[1]>w[1]&&w[0]<(R[0]-P[0])*(w[1]-P[1])/(R[1]-P[1])+P[0]&&(_=!_)}var w,P,R;return _}function hm(d,c){for(let h of c)if(Yi(d,h))return!0;return!1}function Nx(d,c){for(let h of d)if(!Yi(h,c))return!1;for(let h=0;h<d.length-1;++h)if(en(d[h],d[h+1],c))return!1;return!0}function zx(d,c){for(let h of c)if(Nx(d,h))return!0;return!1}function dm(d,c,h,_){let w=_[0]-h[0],P=_[1]-h[1],R=(d[0]-h[0])*P-w*(d[1]-h[1]),L=(c[0]-h[0])*P-w*(c[1]-h[1]);return R>0&&L<0||R<0&&L>0}function Da(d,c,h){let _=[];for(let w=0;w<d.length;w++){let P=[];for(let R=0;R<d[w].length;R++){let L=Ms(d[w][R],h);So(c,L),P.push(L)}_.push(P)}return _}function hf(d,c,h){let _=[];for(let w=0;w<d.length;w++){let P=Da(d[w],c,h);_.push(P)}return _}function wc(d,c,h,_){if(d[0]<h[0]||d[0]>h[2]){let w=.5*_,P=d[0]-h[0]>w?-_:h[0]-d[0]>w?_:0;P===0&&(P=d[0]-h[2]>w?-_:h[2]-d[0]>w?_:0),d[0]+=P}So(c,d)}function dA(d,c,h,_){let w=Math.pow(2,_.z)*de,P=[_.x*de,_.y*de],R=[];for(let L of d)for(let U of L){let $=[U.x+P[0],U.y+P[1]];wc($,c,h,w),R.push($)}return R}function Ux(d,c,h,_){let w=Math.pow(2,_.z)*de,P=[_.x*de,_.y*de],R=[];for(let U of d){let $=[];for(let q of U){let J=[q.x+P[0],q.y+P[1]];So(c,J),$.push(J)}R.push($)}if(c[2]-c[0]<=w/2){(L=c)[0]=L[1]=1/0,L[2]=L[3]=-1/0;for(let U of R)for(let $ of U)wc($,c,h,w)}var L;return R}class Es{constructor(c,h){this.type=Si,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(xp(c[1])){let _=c[1];if(_.type==="FeatureCollection"){let w=[];for(let P of _.features){let{type:R,coordinates:L}=P.geometry;R==="Polygon"&&w.push(L),R==="MultiPolygon"&&w.push(...L)}if(w.length)return new Es(_,{type:"MultiPolygon",coordinates:w})}else if(_.type==="Feature"){let w=_.geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new Es(_,_.geometry)}else if(_.type==="Polygon"||_.type==="MultiPolygon")return new Es(_,_)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return(function(h,_){let w=[1/0,1/0,-1/0,-1/0],P=[1/0,1/0,-1/0,-1/0],R=h.canonicalID();if(_.type==="Polygon"){let L=Da(_.coordinates,P,R),U=dA(h.geometry(),w,P,R);if(!qi(w,P))return!1;for(let $ of U)if(!Yi($,L))return!1}if(_.type==="MultiPolygon"){let L=hf(_.coordinates,P,R),U=dA(h.geometry(),w,P,R);if(!qi(w,P))return!1;for(let $ of U)if(!hm($,L))return!1}return!0})(c,this.geometries);if(c.geometryType()==="LineString")return(function(h,_){let w=[1/0,1/0,-1/0,-1/0],P=[1/0,1/0,-1/0,-1/0],R=h.canonicalID();if(_.type==="Polygon"){let L=Da(_.coordinates,P,R),U=Ux(h.geometry(),w,P,R);if(!qi(w,P))return!1;for(let $ of U)if(!Nx($,L))return!1}if(_.type==="MultiPolygon"){let L=hf(_.coordinates,P,R),U=Ux(h.geometry(),w,P,R);if(!qi(w,P))return!1;for(let $ of U)if(!zx($,L))return!1}return!0})(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let si=class{constructor(d=[],c=(h,_)=>h<_?-1:h>_?1:0){if(this.data=d,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;let d=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),d}peek(){return this.data[0]}_up(d){let{data:c,compare:h}=this,_=c[d];for(;d>0;){let w=d-1>>1,P=c[w];if(h(_,P)>=0)break;c[d]=P,d=w}c[d]=_}_down(d){let{data:c,compare:h}=this,_=this.length>>1,w=c[d];for(;d<_;){let P=1+(d<<1),R=P+1;if(R<this.length&&h(c[R],c[P])<0&&(P=R),h(c[P],w)>=0)break;c[d]=c[P],d=P}c[d]=w}};function be(d,c,h=0,_=d.length-1,w=Vx){for(;_>h;){if(_-h>600){let U=_-h+1,$=c-h+1,q=Math.log(U),J=.5*Math.exp(2*q/3),oe=.5*Math.sqrt(q*J*(U-J)/U)*($-U/2<0?-1:1);be(d,c,Math.max(h,Math.floor(c-$*J/U+oe)),Math.min(_,Math.floor(c+(U-$)*J/U+oe)),w)}let P=d[c],R=h,L=_;for(Ur(d,h,c),w(d[_],P)>0&&Ur(d,h,_);R<L;){for(Ur(d,R,L),R++,L--;w(d[R],P)<0;)R++;for(;w(d[L],P)>0;)L--}w(d[h],P)===0?Ur(d,h,L):(L++,Ur(d,L,_)),L<=c&&(h=L+1),c<=L&&(_=L-1)}}function Ur(d,c,h){let _=d[c];d[c]=d[h],d[h]=_}function Vx(d,c){return d<c?-1:d>c?1:0}function Mp(d,c){if(d.length<=1)return[d];let h=[],_,w;for(let P of d){let R=B4(P);R!==0&&(P.area=Math.abs(R),w===void 0&&(w=R<0),w===R<0?(_&&h.push(_),_=[P]):_.push(P))}if(_&&h.push(_),c>1)for(let P=0;P<h.length;P++)h[P].length<=c||(be(h[P],c,1,h[P].length-1,jx),h[P]=h[P].slice(0,c));return h}function jx(d,c){return c.area-d.area}function B4(d){let c=0;for(let h,_,w=0,P=d.length,R=P-1;w<P;R=w++)h=d[w],_=d[R],c+=(_.x-h.x)*(h.y+_.y);return c}let $x=1/298.257223563,me=$x*(2-$x),gv=Math.PI/180;class Av{constructor(c){let h=6378.137*gv*1e3,_=Math.cos(c*gv),w=1/(1-me*(1-_*_)),P=Math.sqrt(w);this.kx=h*P*_,this.ky=h*P*w*(1-me)}distance(c,h){let _=this.wrap(c[0]-h[0])*this.kx,w=(c[1]-h[1])*this.ky;return Math.sqrt(_*_+w*w)}pointOnLine(c,h){let _,w,P,R,L=1/0;for(let U=0;U<c.length-1;U++){let $=c[U][0],q=c[U][1],J=this.wrap(c[U+1][0]-$)*this.kx,oe=(c[U+1][1]-q)*this.ky,se=0;J===0&&oe===0||(se=(this.wrap(h[0]-$)*this.kx*J+(h[1]-q)*this.ky*oe)/(J*J+oe*oe),se>1?($=c[U+1][0],q=c[U+1][1]):se>0&&($+=J/this.kx*se,q+=oe/this.ky*se)),J=this.wrap(h[0]-$)*this.kx,oe=(h[1]-q)*this.ky;let le=J*J+oe*oe;le<L&&(L=le,_=$,w=q,P=U,R=se)}return{point:[_,w],index:P,t:Math.max(0,Math.min(1,R))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function Wx(d,c){return c[0]-d[0]}function fA(d){return d[1]-d[0]+1}function su(d,c){return d[1]>=d[0]&&d[1]<c}function yv(d,c){if(d[0]>d[1])return[null,null];let h=fA(d);if(c){if(h===2)return[d,null];let w=Math.floor(h/2);return[[d[0],d[0]+w],[d[0]+w,d[1]]]}if(h===1)return[d,null];let _=Math.floor(h/2)-1;return[[d[0],d[0]+_],[d[0]+_+1,d[1]]]}function pA(d,c){if(!su(c,d.length))return[1/0,1/0,-1/0,-1/0];let h=[1/0,1/0,-1/0,-1/0];for(let _=c[0];_<=c[1];++_)So(h,d[_]);return h}function mA(d){let c=[1/0,1/0,-1/0,-1/0];for(let h of d)for(let _ of h)So(c,_);return c}function _v(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function Ti(d,c,h){if(!_v(d)||!_v(c))return NaN;let _=0,w=0;return d[2]<c[0]&&(_=c[0]-d[2]),d[0]>c[2]&&(_=d[0]-c[2]),d[1]>c[3]&&(w=d[1]-c[3]),d[3]<c[1]&&(w=c[1]-d[3]),h.distance([0,0],[_,w])}function fo(d,c,h){let _=h.pointOnLine(c,d);return h.distance(d,_.point)}function vv(d,c,h,_,w){let P=Math.min(fo(d,[h,_],w),fo(c,[h,_],w)),R=Math.min(fo(h,[d,c],w),fo(_,[d,c],w));return Math.min(P,R)}function Gx(d,c,h,_,w){if(!su(c,d.length)||!su(_,h.length))return 1/0;let P=1/0;for(let R=c[0];R<c[1];++R){let L=d[R],U=d[R+1];for(let $=_[0];$<_[1];++$){let q=h[$],J=h[$+1];if(jo(L,U,q,J))return 0;P=Math.min(P,vv(L,U,q,J,w))}}return P}function F4(d,c,h,_,w){if(!su(c,d.length)||!su(_,h.length))return NaN;let P=1/0;for(let R=c[0];R<=c[1];++R)for(let L=_[0];L<=_[1];++L)if(P=Math.min(P,w.distance(d[R],h[L])),P===0)return P;return P}function bv(d,c,h){if(Yi(d,c,!0))return 0;let _=1/0;for(let w of c){let P=w[0],R=w[w.length-1];if(P!==R&&(_=Math.min(_,fo(d,[R,P],h)),_===0))return _;let L=h.pointOnLine(w,d);if(_=Math.min(_,h.distance(d,L.point)),_===0)return _}return _}function N4(d,c,h,_){if(!su(c,d.length))return NaN;for(let P=c[0];P<=c[1];++P)if(Yi(d[P],h,!0))return 0;let w=1/0;for(let P=c[0];P<c[1];++P){let R=d[P],L=d[P+1];for(let U of h)for(let $=0,q=U.length,J=q-1;$<q;J=$++){let oe=U[J],se=U[$];if(jo(R,L,oe,se))return 0;w=Math.min(w,vv(R,L,oe,se,_))}}return w}function xv(d,c){for(let h of d)for(let _ of h)if(Yi(_,c,!0))return!0;return!1}function z4(d,c,h,_=1/0){let w=mA(d),P=mA(c);if(_!==1/0&&Ti(w,P,h)>=_)return _;if(qi(w,P)){if(xv(d,c))return 0}else if(xv(c,d))return 0;let R=1/0;for(let L of d)for(let U=0,$=L.length,q=$-1;U<$;q=U++){let J=L[q],oe=L[U];for(let se of c)for(let le=0,ye=se.length,we=ye-1;le<ye;we=le++){let Re=se[we],st=se[le];if(jo(J,oe,Re,st))return 0;R=Math.min(R,vv(J,oe,Re,st,h))}}return R}function Hx(d,c,h,_,w,P){if(!P)return;let R=Ti(pA(_,P),w,h);R<c&&d.push([R,P,[0,0]])}function gA(d,c,h,_,w,P,R){if(!P||!R)return;let L=Ti(pA(_,P),pA(w,R),h);L<c&&d.push([L,P,R])}function In(d,c,h,_,w=1/0){let P=Math.min(_.distance(d[0],h[0][0]),w);if(P===0)return P;let R=new si([[0,[0,d.length-1],[0,0]]],Wx),L=mA(h);for(;R.length>0;){let U=R.pop();if(U[0]>=P)continue;let $=U[1],q=c?50:100;if(fA($)<=q){if(!su($,d.length))return NaN;if(c){let J=N4(d,$,h,_);if(isNaN(J)||J===0)return J;P=Math.min(P,J)}else for(let J=$[0];J<=$[1];++J){let oe=bv(d[J],h,_);if(P=Math.min(P,oe),P===0)return 0}}else{let J=yv($,c);Hx(R,P,_,d,L,J[0]),Hx(R,P,_,d,L,J[1])}}return P}function Ep(d,c,h,_,w,P=1/0){let R=Math.min(P,w.distance(d[0],h[0]));if(R===0)return R;let L=new si([[0,[0,d.length-1],[0,h.length-1]]],Wx);for(;L.length>0;){let U=L.pop();if(U[0]>=R)continue;let $=U[1],q=U[2],J=c?50:100,oe=_?50:100;if(fA($)<=J&&fA(q)<=oe){if(!su($,d.length)&&su(q,h.length))return NaN;let se;if(c&&_)se=Gx(d,$,h,q,w),R=Math.min(R,se);else if(c&&!_){let le=d.slice($[0],$[1]+1);for(let ye=q[0];ye<=q[1];++ye)if(se=fo(h[ye],le,w),R=Math.min(R,se),R===0)return R}else if(!c&&_){let le=h.slice(q[0],q[1]+1);for(let ye=$[0];ye<=$[1];++ye)if(se=fo(d[ye],le,w),R=Math.min(R,se),R===0)return R}else se=F4(d,$,h,q,w),R=Math.min(R,se)}else{let se=yv($,c),le=yv(q,_);gA(L,R,w,d,h,se[0],le[0]),gA(L,R,w,d,h,se[0],le[1]),gA(L,R,w,d,h,se[1],le[0]),gA(L,R,w,d,h,se[1],le[1])}}return R}function AA(d){return d.type==="MultiPolygon"?d.coordinates.map((c=>({type:"Polygon",coordinates:c}))):d.type==="MultiLineString"?d.coordinates.map((c=>({type:"LineString",coordinates:c}))):d.type==="MultiPoint"?d.coordinates.map((c=>({type:"Point",coordinates:c}))):[d]}class df{constructor(c,h){this.type=Kt,this.geojson=c,this.geometries=h}static parse(c,h){if(c.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(xp(c[1])){let _=c[1];if(_.type==="FeatureCollection")return new df(_,_.features.map((w=>AA(w.geometry))).flat());if(_.type==="Feature")return new df(_,AA(_.geometry));if("type"in _&&"coordinates"in _)return new df(_,AA(_))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return(function(h,_){let w=h.geometry(),P=w.flat().map((U=>Ys([U.x,U.y],h.canonical)));if(w.length===0)return NaN;let R=new Av(P[0][1]),L=1/0;for(let U of _){switch(U.type){case"Point":L=Math.min(L,Ep(P,!1,[U.coordinates],!1,R,L));break;case"LineString":L=Math.min(L,Ep(P,!1,U.coordinates,!0,R,L));break;case"Polygon":L=Math.min(L,In(P,!1,U.coordinates,R,L))}if(L===0)return L}return L})(c,this.geometries);if(c.geometryType()==="LineString")return(function(h,_){let w=h.geometry(),P=w.flat().map((U=>Ys([U.x,U.y],h.canonical)));if(w.length===0)return NaN;let R=new Av(P[0][1]),L=1/0;for(let U of _){switch(U.type){case"Point":L=Math.min(L,Ep(P,!0,[U.coordinates],!1,R,L));break;case"LineString":L=Math.min(L,Ep(P,!0,U.coordinates,!0,R,L));break;case"Polygon":L=Math.min(L,In(P,!0,U.coordinates,R,L))}if(L===0)return L}return L})(c,this.geometries);if(c.geometryType()==="Polygon")return(function(h,_){let w=h.geometry();if(w.length===0||w[0].length===0)return NaN;let P=Mp(w,0).map((U=>U.map(($=>$.map((q=>Ys([q.x,q.y],h.canonical))))))),R=new Av(P[0][0][0][1]),L=1/0;for(let U of _)for(let $ of P){switch(U.type){case"Point":L=Math.min(L,In([U.coordinates],!1,$,R,L));break;case"LineString":L=Math.min(L,In(U.coordinates,!0,$,R,L));break;case"Polygon":L=Math.min(L,z4($,U.coordinates,R,L))}if(L===0)return L}return L})(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class fm{constructor(c){this.type=Kr,this.key=c}static parse(c,h){if(c.length!==2)return h.error(`Expected 1 argument, but found ${c.length-1} instead.`);let _=c[1];return _==null?h.error("Global state property must be defined."):typeof _!="string"?h.error(`Global state property must be string, but found ${typeof c[1]} instead.`):new fm(_)}evaluate(c){var h;let _=(h=c.globals)===null||h===void 0?void 0:h.globalState;return _&&Object.keys(_).length!==0?am(_,this.key):null}eachChild(){}outputDefined(){return!1}}let Cp={"==":Tp,"!=":Hh,">":Xu,"<":el,">=":Nt,"<=":vt,array:zr,at:um,boolean:zr,case:Di,coalesce:Gh,collator:sr,format:A,image:wn,in:Xt,"index-of":ur,interpolate:Ro,"interpolate-hcl":Ro,"interpolate-lab":Ro,length:sn,let:lf,literal:qu,match:Ir,number:zr,"number-format":zt,object:zr,slice:Qi,step:Wn,string:zr,"to-boolean":ki,"to-color":ki,"to-number":ki,"to-string":ki,var:cm,within:Es,distance:df,"global-state":fm};class xl{constructor(c,h,_,w){this.name=c,this.type=h,this._evaluate=_,this.args=w}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,h){let _=c[0],w=xl.definitions[_];if(!w)return h.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0);let P=Array.isArray(w)?w[0]:w.type,R=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,L=R.filter((([$])=>!Array.isArray($)||$.length===c.length-1)),U=null;for(let[$,q]of L){U=new wp(h.registry,vA,h.path,null,h.scope);let J=[],oe=!1;for(let se=1;se<c.length;se++){let le=c[se],ye=Array.isArray($)?$[se-1]:$.type,we=U.parse(le,1+J.length,ye);if(!we){oe=!0;break}J.push(we)}if(!oe)if(Array.isArray($)&&$.length!==J.length)U.error(`Expected ${$.length} arguments, but found ${J.length} instead.`);else{for(let se=0;se<J.length;se++){let le=Array.isArray($)?$[se]:$.type,ye=J[se];U.concat(se+1).checkSubtype(le,ye.type)}if(U.errors.length===0)return new xl(_,P,q,J)}}if(L.length===1)h.errors.push(...U.errors);else{let $=(L.length?L:R).map((([J])=>{return oe=J,Array.isArray(oe)?`(${oe.map(Ii).join(", ")})`:`(${Ii(oe.type)}...)`;var oe})).join(" | "),q=[];for(let J=1;J<c.length;J++){let oe=h.parse(c[J],1+q.length);if(!oe)return null;q.push(Ii(oe.type))}h.error(`Expected arguments of type ${$}, but found (${q.join(", ")}) instead.`)}return null}static register(c,h){xl.definitions=h;for(let _ in h)c[_]=xl}}function yA(d,[c,h,_,w]){c=c.evaluate(d),h=h.evaluate(d),_=_.evaluate(d);let P=w?w.evaluate(d):1,R=pv(c,h,_,P);if(R)throw new $n(R);return new ci(c/255,h/255,_/255,P,!1)}function _A(d,c){return d in c}function wv(d,c){let h=c[d];return h===void 0?null:h}function ff(d){return{type:d}}function vA(d){if(d instanceof cm)return vA(d.boundExpression);if(d instanceof xl&&d.name==="error"||d instanceof sr||d instanceof Es||d instanceof df||d instanceof fm)return!1;let c=d instanceof ki||d instanceof zr,h=!0;return d.eachChild((_=>{h=c?h&&vA(_):h&&_ instanceof qu})),!!h&&pm(d)&&Pp(d,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function pm(d){if(d instanceof xl&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Es||d instanceof df)return!1;let c=!0;return d.eachChild((h=>{c&&!pm(h)&&(c=!1)})),c}function mm(d){if(d instanceof xl&&d.name==="feature-state")return!1;let c=!0;return d.eachChild((h=>{c&&!mm(h)&&(c=!1)})),c}function Pp(d,c){if(d instanceof xl&&c.indexOf(d.name)>=0)return!1;let h=!0;return d.eachChild((_=>{h&&!Pp(_,c)&&(h=!1)})),h}function bA(d){return{result:"success",value:d}}function Ip(d){return{result:"error",value:d}}function pf(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function Sv(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function xA(d){return!!d.expression&&d.expression.interpolated}function Li(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function kp(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)&&uo(d)===Gu}function U4(d){return d}function qx(d,c){let h=d.stops&&typeof d.stops[0][0]=="object",_=h||!(h||d.property!==void 0),w=d.type||(xA(c)?"exponential":"interval"),P=(function(q){switch(q.type){case"color":return ci.parse;case"padding":return Ts.parse;case"numberArray":return ca.parse;case"colorArray":return hs.parse;default:return null}})(c);if(P&&((d=wo({},d)).stops&&(d.stops=d.stops.map((q=>[q[0],P(q[1])]))),d.default=P(d.default?d.default:c.default)),d.colorSpace&&(R=d.colorSpace)!=="rgb"&&R!=="hcl"&&R!=="lab")throw new Error(`Unknown color space: "${d.colorSpace}"`);var R;let L=(function(q){switch(q){case"exponential":return wA;case"interval":return La;case"categorical":return qh;case"identity":return gm;default:throw new Error(`Unknown function type "${q}"`)}})(w),U,$;if(w==="categorical"){U=Object.create(null);for(let q of d.stops)U[q[0]]=q[1];$=typeof d.stops[0][0]}if(h){let q={},J=[];for(let le=0;le<d.stops.length;le++){let ye=d.stops[le],we=ye[0].zoom;q[we]===void 0&&(q[we]={zoom:we,type:d.type,property:d.property,default:d.default,stops:[]},J.push(we)),q[we].stops.push([ye[0].value,ye[1]])}let oe=[];for(let le of J)oe.push([q[le].zoom,qx(q[le],c)]);let se={name:"linear"};return{kind:"composite",interpolationType:se,interpolationFactor:Ro.interpolationFactor.bind(void 0,se),zoomStops:oe.map((le=>le[0])),evaluate:({zoom:le},ye)=>wA({stops:oe,base:d.base},c,le).evaluate(le,ye)}}if(_){let q=w==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:q,interpolationFactor:Ro.interpolationFactor.bind(void 0,q),zoomStops:d.stops.map((J=>J[0])),evaluate:({zoom:J})=>L(d,c,J,U,$)}}return{kind:"source",evaluate(q,J){let oe=J&&J.properties?J.properties[d.property]:void 0;return oe===void 0?es(d.default,c.default):L(d,c,oe,U,$)}}}function es(d,c,h){return d!==void 0?d:c!==void 0?c:h!==void 0?h:void 0}function qh(d,c,h,_,w){return es(typeof h===w?_[h]:void 0,d.default,c.default)}function La(d,c,h){if(Li(h)!=="number")return es(d.default,c.default);let _=d.stops.length;if(_===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[_-1][0])return d.stops[_-1][1];let w=Hi(d.stops.map((P=>P[0])),h);return d.stops[w][1]}function wA(d,c,h){let _=d.base!==void 0?d.base:1;if(Li(h)!=="number")return es(d.default,c.default);let w=d.stops.length;if(w===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[w-1][0])return d.stops[w-1][1];let P=Hi(d.stops.map((q=>q[0])),h),R=(function(q,J,oe,se){let le=se-oe,ye=q-oe;return le===0?0:J===1?ye/le:(Math.pow(J,ye)-1)/(Math.pow(J,le)-1)})(h,_,d.stops[P][0],d.stops[P+1][0]),L=d.stops[P][1],U=d.stops[P+1][1],$=Oo[c.type]||U4;return typeof L.evaluate=="function"?{evaluate(...q){let J=L.evaluate.apply(void 0,q),oe=U.evaluate.apply(void 0,q);if(J!==void 0&&oe!==void 0)return $(J,oe,R,d.colorSpace)}}:$(L,U,R,d.colorSpace)}function gm(d,c,h){switch(c.type){case"color":h=ci.parse(h);break;case"formatted":h=Gs.fromString(h.toString());break;case"resolvedImage":h=qs.fromString(h.toString());break;case"padding":h=Ts.parse(h);break;case"colorArray":h=hs.parse(h);break;case"numberArray":h=ca.parse(h);break;default:Li(h)===c.type||c.type==="enum"&&c.values[h]||(h=void 0)}return es(h,d.default,c.default)}xl.register(Cp,{error:[{kind:"error"},[fi],(d,[c])=>{throw new $n(c.evaluate(d))}],typeof:[fi,[Kr],(d,[c])=>Ii(uo(c.evaluate(d)))],"to-rgba":[Oa(Kt,4),[ql],(d,[c])=>{let[h,_,w,P]=c.evaluate(d).rgb;return[255*h,255*_,255*w,P]}],rgb:[ql,[Kt,Kt,Kt],yA],rgba:[ql,[Kt,Kt,Kt,Kt],yA],has:{type:Si,overloads:[[[fi],(d,[c])=>_A(c.evaluate(d),d.properties())],[[fi,Gu],(d,[c,h])=>_A(c.evaluate(d),h.evaluate(d))]]},get:{type:Kr,overloads:[[[fi],(d,[c])=>wv(c.evaluate(d),d.properties())],[[fi,Gu],(d,[c,h])=>wv(c.evaluate(d),h.evaluate(d))]]},"feature-state":[Kr,[fi],(d,[c])=>wv(c.evaluate(d),d.featureState||{})],properties:[Gu,[],d=>d.properties()],"geometry-type":[fi,[],d=>d.geometryType()],id:[Kr,[],d=>d.id()],zoom:[Kt,[],d=>d.globals.zoom],"heatmap-density":[Kt,[],d=>d.globals.heatmapDensity||0],elevation:[Kt,[],d=>d.globals.elevation||0],"line-progress":[Kt,[],d=>d.globals.lineProgress||0],accumulated:[Kr,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[Kt,ff(Kt),(d,c)=>{let h=0;for(let _ of c)h+=_.evaluate(d);return h}],"*":[Kt,ff(Kt),(d,c)=>{let h=1;for(let _ of c)h*=_.evaluate(d);return h}],"-":{type:Kt,overloads:[[[Kt,Kt],(d,[c,h])=>c.evaluate(d)-h.evaluate(d)],[[Kt],(d,[c])=>-c.evaluate(d)]]},"/":[Kt,[Kt,Kt],(d,[c,h])=>c.evaluate(d)/h.evaluate(d)],"%":[Kt,[Kt,Kt],(d,[c,h])=>c.evaluate(d)%h.evaluate(d)],ln2:[Kt,[],()=>Math.LN2],pi:[Kt,[],()=>Math.PI],e:[Kt,[],()=>Math.E],"^":[Kt,[Kt,Kt],(d,[c,h])=>Math.pow(c.evaluate(d),h.evaluate(d))],sqrt:[Kt,[Kt],(d,[c])=>Math.sqrt(c.evaluate(d))],log10:[Kt,[Kt],(d,[c])=>Math.log(c.evaluate(d))/Math.LN10],ln:[Kt,[Kt],(d,[c])=>Math.log(c.evaluate(d))],log2:[Kt,[Kt],(d,[c])=>Math.log(c.evaluate(d))/Math.LN2],sin:[Kt,[Kt],(d,[c])=>Math.sin(c.evaluate(d))],cos:[Kt,[Kt],(d,[c])=>Math.cos(c.evaluate(d))],tan:[Kt,[Kt],(d,[c])=>Math.tan(c.evaluate(d))],asin:[Kt,[Kt],(d,[c])=>Math.asin(c.evaluate(d))],acos:[Kt,[Kt],(d,[c])=>Math.acos(c.evaluate(d))],atan:[Kt,[Kt],(d,[c])=>Math.atan(c.evaluate(d))],min:[Kt,ff(Kt),(d,c)=>Math.min(...c.map((h=>h.evaluate(d))))],max:[Kt,ff(Kt),(d,c)=>Math.max(...c.map((h=>h.evaluate(d))))],abs:[Kt,[Kt],(d,[c])=>Math.abs(c.evaluate(d))],round:[Kt,[Kt],(d,[c])=>{let h=c.evaluate(d);return h<0?-Math.round(-h):Math.round(h)}],floor:[Kt,[Kt],(d,[c])=>Math.floor(c.evaluate(d))],ceil:[Kt,[Kt],(d,[c])=>Math.ceil(c.evaluate(d))],"filter-==":[Si,[fi,Kr],(d,[c,h])=>d.properties()[c.value]===h.value],"filter-id-==":[Si,[Kr],(d,[c])=>d.id()===c.value],"filter-type-==":[Si,[fi],(d,[c])=>d.geometryType()===c.value],"filter-<":[Si,[fi,Kr],(d,[c,h])=>{let _=d.properties()[c.value],w=h.value;return typeof _==typeof w&&_<w}],"filter-id-<":[Si,[Kr],(d,[c])=>{let h=d.id(),_=c.value;return typeof h==typeof _&&h<_}],"filter->":[Si,[fi,Kr],(d,[c,h])=>{let _=d.properties()[c.value],w=h.value;return typeof _==typeof w&&_>w}],"filter-id->":[Si,[Kr],(d,[c])=>{let h=d.id(),_=c.value;return typeof h==typeof _&&h>_}],"filter-<=":[Si,[fi,Kr],(d,[c,h])=>{let _=d.properties()[c.value],w=h.value;return typeof _==typeof w&&_<=w}],"filter-id-<=":[Si,[Kr],(d,[c])=>{let h=d.id(),_=c.value;return typeof h==typeof _&&h<=_}],"filter->=":[Si,[fi,Kr],(d,[c,h])=>{let _=d.properties()[c.value],w=h.value;return typeof _==typeof w&&_>=w}],"filter-id->=":[Si,[Kr],(d,[c])=>{let h=d.id(),_=c.value;return typeof h==typeof _&&h>=_}],"filter-has":[Si,[Kr],(d,[c])=>c.value in d.properties()],"filter-has-id":[Si,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Si,[Oa(fi)],(d,[c])=>c.value.indexOf(d.geometryType())>=0],"filter-id-in":[Si,[Oa(Kr)],(d,[c])=>c.value.indexOf(d.id())>=0],"filter-in-small":[Si,[fi,Oa(Kr)],(d,[c,h])=>h.value.indexOf(d.properties()[c.value])>=0],"filter-in-large":[Si,[fi,Oa(Kr)],(d,[c,h])=>(function(_,w,P,R){for(;P<=R;){let L=P+R>>1;if(w[L]===_)return!0;w[L]>_?R=L-1:P=L+1}return!1})(d.properties()[c.value],h.value,0,h.value.length-1)],all:{type:Si,overloads:[[[Si,Si],(d,[c,h])=>c.evaluate(d)&&h.evaluate(d)],[ff(Si),(d,c)=>{for(let h of c)if(!h.evaluate(d))return!1;return!0}]]},any:{type:Si,overloads:[[[Si,Si],(d,[c,h])=>c.evaluate(d)||h.evaluate(d)],[ff(Si),(d,c)=>{for(let h of c)if(h.evaluate(d))return!0;return!1}]]},"!":[Si,[Si],(d,[c])=>!c.evaluate(d)],"is-supported-script":[Si,[fi],(d,[c])=>{let h=d.globals&&d.globals.isSupportedScript;return!h||h(c.evaluate(d))}],upcase:[fi,[fi],(d,[c])=>c.evaluate(d).toUpperCase()],downcase:[fi,[fi],(d,[c])=>c.evaluate(d).toLowerCase()],concat:[fi,ff(Kr),(d,c)=>c.map((h=>Mn(h.evaluate(d)))).join("")],"resolved-locale":[fi,[rf],(d,[c])=>c.evaluate(d).resolvedLocale()]});class mf{constructor(c,h,_){this.expression=c,this._warningHistory={},this._evaluator=new nu,this._defaultValue=h?(function(w){if(w.type==="color"&&kp(w.default))return new ci(0,0,0,0);switch(w.type){case"color":return ci.parse(w.default)||null;case"padding":return Ts.parse(w.default)||null;case"numberArray":return ca.parse(w.default)||null;case"colorArray":return hs.parse(w.default)||null;case"variableAnchorOffsetCollection":return Hs.parse(w.default)||null;case"projectionDefinition":return Ja.parse(w.default)||null;default:return w.default===void 0?null:w.default}})(h):null,this._enumValues=h&&h.type==="enum"?h.values:null,this._globalState=_}evaluateWithoutErrorHandling(c,h,_,w,P,R){return this._globalState&&(c=Zu(c,this._globalState)),this._evaluator.globals=c,this._evaluator.feature=h,this._evaluator.featureState=_,this._evaluator.canonical=w,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=R,this.expression.evaluate(this._evaluator)}evaluate(c,h,_,w,P,R){this._globalState&&(c=Zu(c,this._globalState)),this._evaluator.globals=c,this._evaluator.feature=h||null,this._evaluator.featureState=_||null,this._evaluator.canonical=w,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=R||null;try{let L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new $n(`Expected value to be one of ${Object.keys(this._enumValues).map((U=>JSON.stringify(U))).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(L.message)),this._defaultValue}}}function SA(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in Cp}function TA(d,c,h){let _=new wp(Cp,vA,[],c?(function(P){let R={color:ql,string:fi,number:Kt,enum:fi,boolean:Si,formatted:yp,padding:_p,numberArray:nf,colorArray:nm,projectionDefinition:im,resolvedImage:om,variableAnchorOffsetCollection:Hu};return P.type==="array"?Oa(R[P.value]||Kr,P.length):R[P.type]})(c):void 0),w=_.parse(d,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return w?bA(new mf(w,c,h)):Ip(_.errors)}class MA{constructor(c,h,_){this.kind=c,this._styleExpression=h,this.isStateDependent=c!=="constant"&&!mm(h.expression),this.globalStateRefs=ym(h.expression),this._globalState=_}evaluateWithoutErrorHandling(c,h,_,w,P,R){return this._globalState&&(c=Zu(c,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(c,h,_,w,P,R)}evaluate(c,h,_,w,P,R){return this._globalState&&(c=Zu(c,this._globalState)),this._styleExpression.evaluate(c,h,_,w,P,R)}}class EA{constructor(c,h,_,w,P){this.kind=c,this.zoomStops=_,this._styleExpression=h,this.isStateDependent=c!=="camera"&&!mm(h.expression),this.globalStateRefs=ym(h.expression),this.interpolationType=w,this._globalState=P}evaluateWithoutErrorHandling(c,h,_,w,P,R){return this._globalState&&(c=Zu(c,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(c,h,_,w,P,R)}evaluate(c,h,_,w,P,R){return this._globalState&&(c=Zu(c,this._globalState)),this._styleExpression.evaluate(c,h,_,w,P,R)}interpolationFactor(c,h,_){return this.interpolationType?Ro.interpolationFactor(this.interpolationType,c,h,_):0}}function Am(d,c,h){let _=TA(d,c,h);if(_.result==="error")return _;let w=_.value.expression,P=pm(w);if(!P&&!pf(c))return Ip([new ka("","data expressions not supported")]);let R=Pp(w,["zoom"]);if(!R&&!Sv(c))return Ip([new ka("","zoom expressions not supported")]);let L=Rp(w);return L||R?L instanceof ka?Ip([L]):L instanceof Ro&&!xA(c)?Ip([new ka("",'"interpolate" expressions cannot be used with this property')]):bA(L?new EA(P?"camera":"composite",_.value,L.labels,L instanceof Ro?L.interpolation:void 0,h):new MA(P?"constant":"source",_.value,h)):Ip([new ka("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Sc{constructor(c,h){this._parameters=c,this._specification=h,wo(this,qx(this._parameters,this._specification))}static deserialize(c){return new Sc(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function Rp(d){let c=null;if(d instanceof lf)c=Rp(d.result);else if(d instanceof Gh){for(let h of d.args)if(c=Rp(h),c)break}else(d instanceof Wn||d instanceof Ro)&&d.input instanceof xl&&d.input.name==="zoom"&&(c=d);return c instanceof ka||d.eachChild((h=>{let _=Rp(h);_ instanceof ka?c=_:!c&&_?c=new ka("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&_&&c!==_&&(c=new ka("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),c}function ym(d,c=new Set){return d instanceof fm&&c.add(d.key),d.eachChild((h=>{ym(h,c)})),c}function Zu(d,c){let{zoom:h,heatmapDensity:_,elevation:w,lineProgress:P,isSupportedScript:R,accumulated:L}=d??{};return{zoom:h,heatmapDensity:_,elevation:w,lineProgress:P,isSupportedScript:R,accumulated:L,globalState:c}}function au(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(let c of d.slice(1))if(!au(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}let Ku={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gf(d,c){if(d==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};au(d)||(d=PA(d));let h=TA(d,Ku,c);if(h.result==="error")throw new Error(h.value.map((_=>`${_.key}: ${_.message}`)).join(", "));return{filter:(_,w,P)=>h.value.evaluate(_,w,{},P),needGeometry:CA(d),getGlobalStateRefs:()=>ym(h.value.expression)}}function Yx(d,c){return d<c?-1:d>c?1:0}function CA(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let c=1;c<d.length;c++)if(CA(d[c]))return!0;return!1}function PA(d){if(!d)return!0;let c=d[0];return d.length<=1?c!=="any":c==="=="?Tv(d[1],d[2],"=="):c==="!="?Op(Tv(d[1],d[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Tv(d[1],d[2],c):c==="any"?(h=d.slice(1),["any"].concat(h.map(PA))):c==="all"?["all"].concat(d.slice(1).map(PA)):c==="none"?["all"].concat(d.slice(1).map(PA).map(Op)):c==="in"?IA(d[1],d.slice(2)):c==="!in"?Op(IA(d[1],d.slice(2))):c==="has"?Mv(d[1]):c!=="!has"||Op(Mv(d[1]));var h}function Tv(d,c,h){switch(d){case"$type":return[`filter-type-${h}`,c];case"$id":return[`filter-id-${h}`,c];default:return[`filter-${h}`,d,c]}}function IA(d,c){if(c.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some((h=>typeof h!=typeof c[0]))?["filter-in-large",d,["literal",c.sort(Yx)]]:["filter-in-small",d,["literal",c]]}}function Mv(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Op(d){return["!",d]}function _m(d){let c=typeof d;if(c==="number"||c==="boolean"||c==="string"||d==null)return JSON.stringify(d);if(Array.isArray(d)){let w="[";for(let P of d)w+=`${_m(P)},`;return`${w}]`}let h=Object.keys(d).sort(),_="{";for(let w=0;w<h.length;w++)_+=`${JSON.stringify(h[w])}:${_m(d[h[w]])},`;return`${_}}`}function Ev(d){let c="";for(let h of Ei)c+=`/${_m(d[h])}`;return c}function kA(d){let c=d.value;return c?[new Ot(d.key,c,"constants have been deprecated as of v8")]:[]}function Qn(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Af(d){if(Array.isArray(d))return d.map(Af);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){let c={};for(let h in d)c[h]=Af(d[h]);return c}return Qn(d)}function Xl(d){let c=d.key,h=d.value,_=d.valueSpec||{},w=d.objectElementValidators||{},P=d.style,R=d.styleSpec,L=d.validateSpec,U=[],$=Li(h);if($!=="object")return[new Ot(c,h,`object expected, ${$} found`)];for(let q in h){let J=q.split(".")[0],oe=am(_,J)||_["*"],se;if(am(w,J))se=w[J];else if(am(_,J))se=L;else if(w["*"])se=w["*"];else{if(!_["*"]){U.push(new Ot(c,h[q],`unknown property "${q}"`));continue}se=L}U=U.concat(se({key:(c&&`${c}.`)+q,value:h[q],valueSpec:oe,style:P,styleSpec:R,object:h,objectKey:q,validateSpec:L},h))}for(let q in _)w[q]||_[q].required&&_[q].default===void 0&&h[q]===void 0&&U.push(new Ot(c,h,`missing required property "${q}"`));return U}function Dp(d){let c=d.value,h=d.valueSpec,_=d.style,w=d.styleSpec,P=d.key,R=d.arrayElementValidator||d.validateSpec;if(Li(c)!=="array")return[new Ot(P,c,`array expected, ${Li(c)} found`)];if(h.length&&c.length!==h.length)return[new Ot(P,c,`array length ${h.length} expected, length ${c.length} found`)];if(h["min-length"]&&c.length<h["min-length"])return[new Ot(P,c,`array length at least ${h["min-length"]} expected, length ${c.length} found`)];let L={type:h.value,values:h.values};w.$version<7&&(L.function=h.function),Li(h.value)==="object"&&(L=h.value);let U=[];for(let $=0;$<c.length;$++)U=U.concat(R({array:c,arrayIndex:$,value:c[$],valueSpec:L,validateSpec:d.validateSpec,style:_,styleSpec:w,key:`${P}[${$}]`}));return U}function RA(d){let c=d.key,h=d.value,_=d.valueSpec,w=Li(h);return w==="number"&&h!=h&&(w="NaN"),w!=="number"?[new Ot(c,h,`number expected, ${w} found`)]:"minimum"in _&&h<_.minimum?[new Ot(c,h,`${h} is less than the minimum value ${_.minimum}`)]:"maximum"in _&&h>_.maximum?[new Ot(c,h,`${h} is greater than the maximum value ${_.maximum}`)]:[]}function Xx(d){let c=d.valueSpec,h=Qn(d.value.type),_,w,P,R={},L=h!=="categorical"&&d.value.property===void 0,U=!L,$=Li(d.value.stops)==="array"&&Li(d.value.stops[0])==="array"&&Li(d.value.stops[0][0])==="object",q=Xl({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(se){if(h==="identity")return[new Ot(se.key,se.value,'identity function may not have a "stops" property')];let le=[],ye=se.value;return le=le.concat(Dp({key:se.key,value:ye,valueSpec:se.valueSpec,validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec,arrayElementValidator:J})),Li(ye)==="array"&&ye.length===0&&le.push(new Ot(se.key,ye,"array must have at least one stop")),le},default:function(se){return se.validateSpec({key:se.key,value:se.value,valueSpec:c,validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec})}}});return h==="identity"&&L&&q.push(new Ot(d.key,d.value,'missing required property "property"')),h==="identity"||d.value.stops||q.push(new Ot(d.key,d.value,'missing required property "stops"')),h==="exponential"&&d.valueSpec.expression&&!xA(d.valueSpec)&&q.push(new Ot(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(U&&!pf(d.valueSpec)?q.push(new Ot(d.key,d.value,"property functions not supported")):L&&!Sv(d.valueSpec)&&q.push(new Ot(d.key,d.value,"zoom functions not supported"))),h!=="categorical"&&!$||d.value.property!==void 0||q.push(new Ot(d.key,d.value,'"property" property is required')),q;function J(se){let le=[],ye=se.value,we=se.key;if(Li(ye)!=="array")return[new Ot(we,ye,`array expected, ${Li(ye)} found`)];if(ye.length!==2)return[new Ot(we,ye,`array length 2 expected, length ${ye.length} found`)];if($){if(Li(ye[0])!=="object")return[new Ot(we,ye,`object expected, ${Li(ye[0])} found`)];if(ye[0].zoom===void 0)return[new Ot(we,ye,"object stop key must have zoom")];if(ye[0].value===void 0)return[new Ot(we,ye,"object stop key must have value")];if(P&&P>Qn(ye[0].zoom))return[new Ot(we,ye[0].zoom,"stop zoom values must appear in ascending order")];Qn(ye[0].zoom)!==P&&(P=Qn(ye[0].zoom),w=void 0,R={}),le=le.concat(Xl({key:`${we}[0]`,value:ye[0],valueSpec:{zoom:{}},validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec,objectElementValidators:{zoom:RA,value:oe}}))}else le=le.concat(oe({key:`${we}[0]`,value:ye[0],validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec},ye));return SA(Af(ye[1]))?le.concat([new Ot(`${we}[1]`,ye[1],"expressions are not allowed in function stops.")]):le.concat(se.validateSpec({key:`${we}[1]`,value:ye[1],valueSpec:c,validateSpec:se.validateSpec,style:se.style,styleSpec:se.styleSpec}))}function oe(se,le){let ye=Li(se.value),we=Qn(se.value),Re=se.value!==null?se.value:le;if(_){if(ye!==_)return[new Ot(se.key,Re,`${ye} stop domain type must match previous stop domain type ${_}`)]}else _=ye;if(ye!=="number"&&ye!=="string"&&ye!=="boolean")return[new Ot(se.key,Re,"stop domain value must be a number, string, or boolean")];if(ye!=="number"&&h!=="categorical"){let st=`number expected, ${ye} found`;return pf(c)&&h===void 0&&(st+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ot(se.key,Re,st)]}return h!=="categorical"||ye!=="number"||isFinite(we)&&Math.floor(we)===we?h!=="categorical"&&ye==="number"&&w!==void 0&&we<w?[new Ot(se.key,Re,"stop domain values must appear in ascending order")]:(w=we,h==="categorical"&&we in R?[new Ot(se.key,Re,"stop domain values must be unique")]:(R[we]=!0,[])):[new Ot(se.key,Re,`integer expected, found ${we}`)]}}function Lp(d){let c=(d.expressionContext==="property"?Am:TA)(Af(d.value),d.valueSpec);if(c.result==="error")return c.value.map((_=>new Ot(`${d.key}${_.key}`,d.value,_.message)));let h=c.value.expression||c.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!h.outputDefined())return[new Ot(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!mm(h))return[new Ot(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!mm(h))return[new Ot(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!Pp(h,["zoom","feature-state"]))return[new Ot(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!pm(h))return[new Ot(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yh(d){let c=d.key,h=d.value,_=Li(h);return _!=="string"?[new Ot(c,h,`color expected, ${_} found`)]:ci.parse(String(h))?[]:[new Ot(c,h,`color expected, "${h}" found`)]}function Bp(d){let c=d.key,h=d.value,_=d.valueSpec,w=[];return Array.isArray(_.values)?_.values.indexOf(Qn(h))===-1&&w.push(new Ot(c,h,`expected one of [${_.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(_.values).indexOf(Qn(h))===-1&&w.push(new Ot(c,h,`expected one of [${Object.keys(_.values).join(", ")}], ${JSON.stringify(h)} found`)),w}function Xh(d){return au(Af(d.value))?Lp(wo({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Cv(d)}function Cv(d){let c=d.value,h=d.key;if(Li(c)!=="array")return[new Ot(h,c,`array expected, ${Li(c)} found`)];let _=d.styleSpec,w,P=[];if(c.length<1)return[new Ot(h,c,"filter array must have at least 1 element")];switch(P=P.concat(Bp({key:`${h}[0]`,value:c[0],valueSpec:_.filter_operator,style:d.style,styleSpec:d.styleSpec})),Qn(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&Qn(c[1])==="$type"&&P.push(new Ot(h,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&P.push(new Ot(h,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(w=Li(c[1]),w!=="string"&&P.push(new Ot(`${h}[1]`,c[1],`string expected, ${w} found`)));for(let R=2;R<c.length;R++)w=Li(c[R]),Qn(c[1])==="$type"?P=P.concat(Bp({key:`${h}[${R}]`,value:c[R],valueSpec:_.geometry_type,style:d.style,styleSpec:d.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&P.push(new Ot(`${h}[${R}]`,c[R],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let R=1;R<c.length;R++)P=P.concat(Cv({key:`${h}[${R}]`,value:c[R],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":w=Li(c[1]),c.length!==2?P.push(new Ot(h,c,`filter array for "${c[0]}" operator must have 2 elements`)):w!=="string"&&P.push(new Ot(`${h}[1]`,c[1],`string expected, ${w} found`))}return P}function Zh(d,c){let h=d.key,_=d.validateSpec,w=d.style,P=d.styleSpec,R=d.value,L=d.objectKey,U=P[`${c}_${d.layerType}`];if(!U)return[];let $=L.match(/^(.*)-transition$/);if(c==="paint"&&$&&U[$[1]]&&U[$[1]].transition)return _({key:h,value:R,valueSpec:P.transition,style:w,styleSpec:P});let q=d.valueSpec||U[L];if(!q)return[new Ot(h,R,`unknown property "${L}"`)];let J;if(Li(R)==="string"&&pf(q)&&!q.tokens&&(J=/^{([^}]+)}$/.exec(R)))return[new Ot(h,R,`"${L}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(J[1])} }\`.`)];let oe=[];return d.layerType==="symbol"&&(L==="text-field"&&w&&!w.glyphs&&oe.push(new Ot(h,R,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&kp(Af(R))&&Qn(R.type)==="identity"&&oe.push(new Ot(h,R,'"text-font" does not support identity functions'))),oe.concat(_({key:d.key,value:R,valueSpec:q,style:w,styleSpec:P,expressionContext:"property",propertyType:c,propertyKey:L}))}function Pv(d){return Zh(d,"paint")}function OA(d){return Zh(d,"layout")}function DA(d){let c=[],h=d.value,_=d.key,w=d.style,P=d.styleSpec;if(Li(h)!=="object")return[new Ot(_,h,`object expected, ${Li(h)} found`)];h.type||h.ref||c.push(new Ot(_,h,'either "type" or "ref" is required'));let R=Qn(h.type),L=Qn(h.ref);if(h.id){let U=Qn(h.id);for(let $=0;$<d.arrayIndex;$++){let q=w.layers[$];Qn(q.id)===U&&c.push(new Ot(_,h.id,`duplicate layer id "${h.id}", previously used at line ${q.id.__line__}`))}}if("ref"in h){let U;["type","source","source-layer","filter","layout"].forEach(($=>{$ in h&&c.push(new Ot(_,h[$],`"${$}" is prohibited for ref layers`))})),w.layers.forEach(($=>{Qn($.id)===L&&(U=$)})),U?U.ref?c.push(new Ot(_,h.ref,"ref cannot reference another ref layer")):R=Qn(U.type):c.push(new Ot(_,h.ref,`ref layer "${L}" not found`))}else if(R!=="background")if(h.source){let U=w.sources&&w.sources[h.source],$=U&&Qn(U.type);U?$==="vector"&&R==="raster"?c.push(new Ot(_,h.source,`layer "${h.id}" requires a raster source`)):$!=="raster-dem"&&R==="hillshade"||$!=="raster-dem"&&R==="color-relief"?c.push(new Ot(_,h.source,`layer "${h.id}" requires a raster-dem source`)):$==="raster"&&R!=="raster"?c.push(new Ot(_,h.source,`layer "${h.id}" requires a vector source`)):$!=="vector"||h["source-layer"]?$==="raster-dem"&&R!=="hillshade"&&R!=="color-relief"?c.push(new Ot(_,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):R!=="line"||!h.paint||!h.paint["line-gradient"]||$==="geojson"&&U.lineMetrics||c.push(new Ot(_,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new Ot(_,h,`layer "${h.id}" must specify a "source-layer"`)):c.push(new Ot(_,h.source,`source "${h.source}" not found`))}else c.push(new Ot(_,h,'missing required property "source"'));return c=c.concat(Xl({key:_,value:h,valueSpec:P.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${_}.type`,value:h.type,valueSpec:P.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:h,objectKey:"type"}),filter:Xh,layout:U=>Xl({layer:h,key:U.key,value:U.value,style:U.style,styleSpec:U.styleSpec,validateSpec:U.validateSpec,objectElementValidators:{"*":$=>OA(wo({layerType:R},$))}}),paint:U=>Xl({layer:h,key:U.key,value:U.value,style:U.style,styleSpec:U.styleSpec,validateSpec:U.validateSpec,objectElementValidators:{"*":$=>Pv(wo({layerType:R},$))}})}})),c}function Kh(d){let c=d.value,h=d.key,_=Li(c);return _!=="string"?[new Ot(h,c,`string expected, ${_} found`)]:[]}let yf={promoteId:function({key:d,value:c}){if(Li(c)==="string")return Kh({key:d,value:c});{let h=[];for(let _ in c)h.push(...Kh({key:`${d}.${_}`,value:c[_]}));return h}}};function LA(d){let c=d.value,h=d.key,_=d.styleSpec,w=d.style,P=d.validateSpec;if(!c.type)return[new Ot(h,c,'"type" is required')];let R=Qn(c.type),L;switch(R){case"vector":case"raster":return L=Xl({key:h,value:c,valueSpec:_[`source_${R.replace("-","_")}`],style:d.style,styleSpec:_,objectElementValidators:yf,validateSpec:P}),L;case"raster-dem":return L=(function(U){var $;let q=($=U.sourceName)!==null&&$!==void 0?$:"",J=U.value,oe=U.styleSpec,se=oe.source_raster_dem,le=U.style,ye=[],we=Li(J);if(J===void 0)return ye;if(we!=="object")return ye.push(new Ot("source_raster_dem",J,`object expected, ${we} found`)),ye;let Re=Qn(J.encoding)==="custom",st=["redFactor","greenFactor","blueFactor","baseShift"],Ue=U.value.encoding?`"${U.value.encoding}"`:"Default";for(let Ge in J)!Re&&st.includes(Ge)?ye.push(new Ot(Ge,J[Ge],`In "${q}": "${Ge}" is only valid when "encoding" is set to "custom". ${Ue} encoding found`)):se[Ge]?ye=ye.concat(U.validateSpec({key:Ge,value:J[Ge],valueSpec:se[Ge],validateSpec:U.validateSpec,style:le,styleSpec:oe})):ye.push(new Ot(Ge,J[Ge],`unknown property "${Ge}"`));return ye})({sourceName:h,value:c,style:d.style,styleSpec:_,validateSpec:P}),L;case"geojson":if(L=Xl({key:h,value:c,valueSpec:_.source_geojson,style:w,styleSpec:_,validateSpec:P,objectElementValidators:yf}),c.cluster)for(let U in c.clusterProperties){let[$,q]=c.clusterProperties[U],J=typeof $=="string"?[$,["accumulated"],["get",U]]:$;L.push(...Lp({key:`${h}.${U}.map`,value:q,expressionContext:"cluster-map"})),L.push(...Lp({key:`${h}.${U}.reduce`,value:J,expressionContext:"cluster-reduce"}))}return L;case"video":return Xl({key:h,value:c,valueSpec:_.source_video,style:w,validateSpec:P,styleSpec:_});case"image":return Xl({key:h,value:c,valueSpec:_.source_image,style:w,validateSpec:P,styleSpec:_});case"canvas":return[new Ot(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bp({key:`${h}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function BA(d){let c=d.value,h=d.styleSpec,_=h.light,w=d.style,P=[],R=Li(c);if(c===void 0)return P;if(R!=="object")return P=P.concat([new Ot("light",c,`object expected, ${R} found`)]),P;for(let L in c){let U=L.match(/^(.*)-transition$/);P=P.concat(U&&_[U[1]]&&_[U[1]].transition?d.validateSpec({key:L,value:c[L],valueSpec:h.transition,validateSpec:d.validateSpec,style:w,styleSpec:h}):_[L]?d.validateSpec({key:L,value:c[L],valueSpec:_[L],validateSpec:d.validateSpec,style:w,styleSpec:h}):[new Ot(L,c[L],`unknown property "${L}"`)])}return P}function FA(d){let c=d.value,h=d.styleSpec,_=h.sky,w=d.style,P=Li(c);if(c===void 0)return[];if(P!=="object")return[new Ot("sky",c,`object expected, ${P} found`)];let R=[];for(let L in c)R=R.concat(_[L]?d.validateSpec({key:L,value:c[L],valueSpec:_[L],style:w,styleSpec:h}):[new Ot(L,c[L],`unknown property "${L}"`)]);return R}function Fp(d){let c=d.value,h=d.styleSpec,_=h.terrain,w=d.style,P=[],R=Li(c);if(c===void 0)return P;if(R!=="object")return P=P.concat([new Ot("terrain",c,`object expected, ${R} found`)]),P;for(let L in c)P=P.concat(_[L]?d.validateSpec({key:L,value:c[L],valueSpec:_[L],validateSpec:d.validateSpec,style:w,styleSpec:h}):[new Ot(L,c[L],`unknown property "${L}"`)]);return P}function En(d){let c=[],h=d.value,_=d.key;if(Array.isArray(h)){let w=[],P=[];for(let R in h)h[R].id&&w.includes(h[R].id)&&c.push(new Ot(_,h,`all the sprites' ids must be unique, but ${h[R].id} is duplicated`)),w.push(h[R].id),h[R].url&&P.includes(h[R].url)&&c.push(new Ot(_,h,`all the sprites' URLs must be unique, but ${h[R].url} is duplicated`)),P.push(h[R].url),c=c.concat(Xl({key:`${_}[${R}]`,value:h[R],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return c}return Kh({key:_,value:h})}function Zx(d){return c=d.value,c&&c.constructor===Object?[]:[new Ot(d.key,d.value,`object expected, ${Li(d.value)} found`)];var c}let _f={"*":()=>[],array:Dp,boolean:function(d){let c=d.value,h=d.key,_=Li(c);return _!=="boolean"?[new Ot(h,c,`boolean expected, ${_} found`)]:[]},number:RA,color:Yh,constants:kA,enum:Bp,filter:Xh,function:Xx,layer:DA,object:Xl,source:LA,light:BA,sky:FA,terrain:Fp,projection:function(d){let c=d.value,h=d.styleSpec,_=h.projection,w=d.style,P=Li(c);if(c===void 0)return[];if(P!=="object")return[new Ot("projection",c,`object expected, ${P} found`)];let R=[];for(let L in c)R=R.concat(_[L]?d.validateSpec({key:L,value:c[L],valueSpec:_[L],style:w,styleSpec:h}):[new Ot(L,c[L],`unknown property "${L}"`)]);return R},projectionDefinition:function(d){let c=d.key,h=d.value;h=h instanceof String?h.valueOf():h;let _=Li(h);return _!=="array"||(function(w){return Array.isArray(w)&&w.length===3&&typeof w[0]=="string"&&typeof w[1]=="string"&&typeof w[2]=="number"})(h)||(function(w){return!!["interpolate","step","literal"].includes(w[0])})(h)?["array","string"].includes(_)?[]:[new Ot(c,h,`projection expected, invalid type "${_}" found`)]:[new Ot(c,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:Kh,formatted:function(d){return Kh(d).length===0?[]:Lp(d)},resolvedImage:function(d){return Kh(d).length===0?[]:Lp(d)},padding:function(d){let c=d.key,h=d.value;if(Li(h)==="array"){if(h.length<1||h.length>4)return[new Ot(c,h,`padding requires 1 to 4 values; ${h.length} values found`)];let _={type:"number"},w=[];for(let P=0;P<h.length;P++)w=w.concat(d.validateSpec({key:`${c}[${P}]`,value:h[P],validateSpec:d.validateSpec,valueSpec:_}));return w}return RA({key:c,value:h,valueSpec:{}})},numberArray:function(d){let c=d.key,h=d.value;if(Li(h)==="array"){let _={type:"number"};if(h.length<1)return[new Ot(c,h,"array length at least 1 expected, length 0 found")];let w=[];for(let P=0;P<h.length;P++)w=w.concat(d.validateSpec({key:`${c}[${P}]`,value:h[P],validateSpec:d.validateSpec,valueSpec:_}));return w}return RA({key:c,value:h,valueSpec:{}})},colorArray:function(d){let c=d.key,h=d.value;if(Li(h)==="array"){if(h.length<1)return[new Ot(c,h,"array length at least 1 expected, length 0 found")];let _=[];for(let w=0;w<h.length;w++)_=_.concat(Yh({key:`${c}[${w}]`,value:h[w]}));return _}return Yh({key:c,value:h})},variableAnchorOffsetCollection:function(d){let c=d.key,h=d.value,_=Li(h),w=d.styleSpec;if(_!=="array"||h.length<1||h.length%2!=0)return[new Ot(c,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let P=[];for(let R=0;R<h.length;R+=2)P=P.concat(Bp({key:`${c}[${R}]`,value:h[R],valueSpec:w.layout_symbol["text-anchor"]})),P=P.concat(Dp({key:`${c}[${R+1}]`,value:h[R+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:w}));return P},sprite:En,state:Zx};function Qu(d){let c=d.value,h=d.valueSpec,_=d.styleSpec;return d.validateSpec=Qu,h.expression&&kp(Qn(c))?Xx(d):h.expression&&SA(Af(c))?Lp(d):h.type&&_f[h.type]?_f[h.type](d):Xl(wo({},d,{valueSpec:h.type?_[h.type]:h}))}function tl(d){let c=d.value,h=d.key,_=Kh(d);return _.length||(c.indexOf("{fontstack}")===-1&&_.push(new Ot(h,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&_.push(new Ot(h,c,'"glyphs" url must include a "{range}" token'))),_}function ua(d,c=lt){let h=[];return h=h.concat(Qu({key:"",value:d,valueSpec:c.$root,styleSpec:c,style:d,validateSpec:Qu,objectElementValidators:{glyphs:tl,"*":()=>[]}})),d.constants&&(h=h.concat(kA({key:"constants",value:d.constants}))),Kx(h)}function Zl(d){return function(c){return d(Object.assign({},c,{validateSpec:Qu}))}}function Kx(d){return[].concat(d).sort(((c,h)=>c.line-h.line))}function po(d){return function(...c){return Kx(d.apply(this,c))}}ua.source=po(Zl(LA)),ua.sprite=po(Zl(En)),ua.glyphs=po(Zl(tl)),ua.light=po(Zl(BA)),ua.sky=po(Zl(FA)),ua.terrain=po(Zl(Fp)),ua.state=po(Zl(Zx)),ua.layer=po(Zl(DA)),ua.filter=po(Zl(Xh)),ua.paintProperty=po(Zl(Pv)),ua.layoutProperty=po(Zl(OA));let Kl=ua,Qh=Kl.light,Iv=Kl.sky,kv=Kl.paintProperty,Rv=Kl.layoutProperty;function wl(d,c){let h=!1;if(c&&c.length)for(let _ of c)d.fire(new Ct(new Error(_.message))),h=!0;return h}class Tc{constructor(c,h,_){let w=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;let R=new Int32Array(this.arrayBuffer);c=R[0],this.d=(h=R[1])+2*(_=R[2]);for(let U=0;U<this.d*this.d;U++){let $=R[3+U],q=R[3+U+1];w.push($===q?null:R.subarray($,q))}let L=R[3+w.length+1];this.keys=R.subarray(R[3+w.length],L),this.bboxes=R.subarray(L),this.insert=this._insertReadonly}else{this.d=h+2*_;for(let R=0;R<this.d*this.d;R++)w.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=c,this.padding=_,this.scale=h/c,this.uid=0;let P=_/h*c;this.min=-P,this.max=c+P}insert(c,h,_,w,P){this._forEachCell(h,_,w,P,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(w),this.bboxes.push(P)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,h,_,w,P,R){this.cells[P].push(R)}query(c,h,_,w,P){let R=this.min,L=this.max;if(c<=R&&h<=R&&L<=_&&L<=w&&!P)return Array.prototype.slice.call(this.keys);{let U=[];return this._forEachCell(c,h,_,w,this._queryCell,U,{},P),U}}_queryCell(c,h,_,w,P,R,L,U){let $=this.cells[P];if($!==null){let q=this.keys,J=this.bboxes;for(let oe=0;oe<$.length;oe++){let se=$[oe];if(L[se]===void 0){let le=4*se;(U?U(J[le+0],J[le+1],J[le+2],J[le+3]):c<=J[le+2]&&h<=J[le+3]&&_>=J[le+0]&&w>=J[le+1])?(L[se]=!0,R.push(q[se])):L[se]=!1}}}}_forEachCell(c,h,_,w,P,R,L,U){let $=this._convertToCellCoord(c),q=this._convertToCellCoord(h),J=this._convertToCellCoord(_),oe=this._convertToCellCoord(w);for(let se=$;se<=J;se++)for(let le=q;le<=oe;le++){let ye=this.d*le+se;if((!U||U(this._convertFromCellCoord(se),this._convertFromCellCoord(le),this._convertFromCellCoord(se+1),this._convertFromCellCoord(le+1)))&&P.call(this,c,h,_,w,ye,R,L,U))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let c=this.cells,h=3+this.cells.length+1+1,_=0;for(let R=0;R<this.cells.length;R++)_+=this.cells[R].length;let w=new Int32Array(h+_+this.keys.length+this.bboxes.length);w[0]=this.extent,w[1]=this.n,w[2]=this.padding;let P=h;for(let R=0;R<c.length;R++){let L=c[R];w[3+R]=P,w.set(L,P),P+=L.length}return w[3+c.length]=P,w.set(this.keys,P),P+=this.keys.length,w[3+c.length+1]=P,w.set(this.bboxes,P),P+=this.bboxes.length,w.buffer}static serialize(c,h){let _=c.toArrayBuffer();return h&&h.push(_),{buffer:_}}static deserialize(c){return new Tc(c.buffer)}}let Mc={};function ar(d,c,h={}){if(Mc[d])throw new Error(`${d} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:d,writeable:!1}),Mc[d]={klass:c,omit:h.omit||[],shallow:h.shallow||[]}}ar("Object",Object),ar("Set",Set),ar("TransferableGridIndex",Tc),ar("Color",ci),ar("Error",Error),ar("AJAXError",Ne),ar("ResolvedImage",qs),ar("StylePropertyFunction",Sc),ar("StyleExpression",mf,{omit:["_evaluator"]}),ar("ZoomDependentExpression",EA),ar("ZoomConstantExpression",MA),ar("CompoundExpression",xl,{omit:["_evaluate"]});for(let d in Cp)Cp[d]._classRegistryKey||ar(`Expression_${d}`,Cp[d]);function Jh(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function Ql(d){return d.$name||d.constructor._classRegistryKey}function Qx(d){return!(function(c){if(c===null||typeof c!="object")return!1;let h=Ql(c);return!(!h||h==="Object")})(d)&&(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||Jh(d)||Ss(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function Np(d,c){if(Qx(d))return(Jh(d)||Ss(d))&&c&&c.push(d),ArrayBuffer.isView(d)&&c&&c.push(d.buffer),d instanceof ImageData&&c&&c.push(d.data.buffer),d;if(Array.isArray(d)){let P=[];for(let R of d)P.push(Np(R,c));return P}if(typeof d!="object")throw new Error("can't serialize object of type "+typeof d);let h=Ql(d);if(!h)throw new Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!Mc[h])throw new Error(`${h} is not registered.`);let{klass:_}=Mc[h],w=_.serialize?_.serialize(d,c):{};if(_.serialize){if(c&&w===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let P in d){if(!d.hasOwnProperty(P)||Mc[h].omit.indexOf(P)>=0)continue;let R=d[P];w[P]=Mc[h].shallow.indexOf(P)>=0?R:Np(R,c)}d instanceof Error&&(w.message=d.message)}if(w.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(w.$name=h),w}function ed(d){if(Qx(d))return d;if(Array.isArray(d))return d.map(ed);if(typeof d!="object")throw new Error("can't deserialize object of type "+typeof d);let c=Ql(d)||"Object";if(!Mc[c])throw new Error(`can't deserialize unregistered class ${c}`);let{klass:h}=Mc[c];if(!h)throw new Error(`can't deserialize unregistered class ${c}`);if(h.deserialize)return h.deserialize(d);let _=Object.create(h.prototype);for(let w of Object.keys(d)){if(w==="$name")continue;let P=d[w];_[w]=Mc[c].shallow.indexOf(w)>=0?P:ed(P)}return _}class vm{constructor(){this.first=!0}update(c,h){let _=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=_,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=_,!0):(this.lastFloorZoom>_?(this.lastIntegerZoom=_+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<_&&(this.lastIntegerZoom=_,this.lastIntegerZoomTime=h),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=_,!0))}}let Ri={"Latin-1 Supplement":d=>d>=128&&d<=255,"Hangul Jamo":d=>d>=4352&&d<=4607,Khmer:d=>d>=6016&&d<=6143,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Kanbun:d=>d>=12688&&d<=12703,"CJK Strokes":d=>d>=12736&&d<=12783,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Hangul Syllables":d=>d>=44032&&d<=55215,"Private Use Area":d=>d>=57344&&d<=63743,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519};function zp(d){for(let c of d)if(ha(c.charCodeAt(0)))return!0;return!1}function NA(d){for(let c of d)if(!Up(c.charCodeAt(0)))return!1;return!0}function bm(d){let c=d.map((h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}})).filter((h=>h));return new RegExp(c.join("|"),"u")}let zA=bm(["Arab","Dupl","Mong","Ougr","Syrc"]);function Up(d){return!zA.test(String.fromCodePoint(d))}let Ju=bm(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ha(d){return!(d!==746&&d!==747&&(d<4352||!(Ri["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||Ri["CJK Compatibility"](d)||Ri["CJK Strokes"](d)||!(!Ri["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||Ri["Enclosed CJK Letters and Months"](d)||Ri["Ideographic Description Characters"](d)||Ri.Kanbun(d)||Ri.Katakana(d)&&d!==12540||!(!Ri["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!Ri["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||Ri["Vertical Forms"](d)||Ri["Yijing Hexagram Symbols"](d)||/\p{sc=Cans}/u.test(String.fromCodePoint(d))||/\p{sc=Hang}/u.test(String.fromCodePoint(d))||Ju.test(String.fromCodePoint(d)))))}function Jx(d){return!(ha(d)||(function(c){return!!(Ri["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||Ri["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||Ri["Letterlike Symbols"](c)||Ri["Number Forms"](c)||Ri["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||Ri["Control Pictures"](c)&&c!==9251||Ri["Optical Character Recognition"](c)||Ri["Enclosed Alphanumerics"](c)||Ri["Geometric Shapes"](c)||Ri["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||Ri["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Ri["CJK Symbols and Punctuation"](c)||Ri.Katakana(c)||Ri["Private Use Area"](c)||Ri["CJK Compatibility Forms"](c)||Ri["Small Form Variants"](c)||Ri["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)})(d))}let Vp=bm(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ew(d){return Vp.test(String.fromCodePoint(d))}function tw(d,c){return!(!c&&ew(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||Ri.Khmer(d))}function V4(d){for(let c of d)if(ew(c.charCodeAt(0)))return!0;return!1}let lu=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus,this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(lu.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping,this.processBidirectionalText=d.processBidirectionalText,this.processStyledBidirectionalText=d.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,c){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(d.pluginStatus!=="loading")return this.setState(d),d;let h=d.pluginURL,_=new Promise((P=>{this.loadScriptResolve=P}));c(h);let w=new Promise((P=>setTimeout((()=>P()),this.TIMEOUT)));if(yield Promise.race([_,w]),this.isParsed()){let P={pluginStatus:"loaded",pluginURL:h};return this.setState(P),P}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)}))}};class Cn{constructor(c,h){this.isSupportedScript=j4,this.zoom=c,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new vm,this.transition=h.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vm,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let c=this.zoom,h=c-Math.floor(c),_=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*_}:{fromScale:.5,toScale:1,t:1-(1-_)*h}}}function j4(d){return(function(c,h){for(let _ of c)if(!tw(_.charCodeAt(0),h))return!1;return!0})(d,lu.getRTLTextPluginStatus()==="loaded")}class UA{constructor(c,h,_){this.property=c,this.value=h,this.expression=(function(w,P,R){if(kp(w))return new Sc(w,P);if(SA(w)){let L=Am(w,P,R);if(L.result==="error")throw new Error(L.value.map((U=>`${U.key}: ${U.message}`)).join(", "));return L.value}{let L=w;return P.type==="color"&&typeof w=="string"?L=ci.parse(w):P.type!=="padding"||typeof w!="number"&&!Array.isArray(w)?P.type!=="numberArray"||typeof w!="number"&&!Array.isArray(w)?P.type!=="colorArray"||typeof w!="string"&&!Array.isArray(w)?P.type==="variableAnchorOffsetCollection"&&Array.isArray(w)?L=Hs.parse(w):P.type==="projectionDefinition"&&typeof w=="string"&&(L=Ja.parse(w)):L=hs.parse(w):L=ca.parse(w):L=Ts.parse(w),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>L}}})(h===void 0?c.specification.default:h,c.specification,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(c,h,_){return this.property.possiblyEvaluate(this,c,h,_)}}class vf{constructor(c,h){this.property=c,this.value=new UA(c,void 0,h)}transitioned(c,h){return new xm(this.property,this.value,h,jr({},c.transition,this.transition),c.now)}untransitioned(){return new xm(this.property,this.value,null,{},0)}}class VA{constructor(c,h){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues),this._globalState=h}getValue(c){return hn(this._values[c].value.value)}setValue(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new vf(this._values[c].property,this._globalState)),this._values[c].value=new UA(this._values[c].property,h===null?void 0:hn(h),this._globalState)}getTransition(c){return hn(this._values[c].transition)}setTransition(c,h){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new vf(this._values[c].property,this._globalState)),this._values[c].transition=hn(h)||void 0}serialize(){let c={};for(let h of Object.keys(this._values)){let _=this.getValue(h);_!==void 0&&(c[h]=_);let w=this.getTransition(h);w!==void 0&&(c[`${h}-transition`]=w)}return c}transitioned(c,h){let _=new Ov(this._properties);for(let w of Object.keys(this._values))_._values[w]=this._values[w].transitioned(c,h._values[w]);return _}untransitioned(){let c=new Ov(this._properties);for(let h of Object.keys(this._values))c._values[h]=this._values[h].untransitioned();return c}}class xm{constructor(c,h,_,w,P){this.property=c,this.value=h,this.begin=P+w.delay||0,this.end=this.begin+w.duration||0,c.specification.transition&&(w.delay||w.duration)&&(this.prior=_)}possiblyEvaluate(c,h,_){let w=c.now||0,P=this.value.possiblyEvaluate(c,h,_),R=this.prior;if(R){if(w>this.end)return this.prior=null,P;if(this.value.isDataDriven())return this.prior=null,P;if(w<this.begin)return R.possiblyEvaluate(c,h,_);{let L=(w-this.begin)/(this.end-this.begin);return this.property.interpolate(R.possiblyEvaluate(c,h,_),P,nt(L))}}return P}}class Ov{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,h,_){let w=new jp(this._properties);for(let P of Object.keys(this._values))w._values[P]=this._values[P].possiblyEvaluate(c,h,_);return w}hasTransition(){for(let c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class jA{constructor(c,h){this._properties=c,this._values=Object.create(c.defaultPropertyValues),this._globalState=h}hasValue(c){return this._values[c].value!==void 0}getValue(c){return hn(this._values[c].value)}setValue(c,h){this._values[c]=new UA(this._values[c].property,h===null?void 0:hn(h),this._globalState)}serialize(){let c={};for(let h of Object.keys(this._values)){let _=this.getValue(h);_!==void 0&&(c[h]=_)}return c}possiblyEvaluate(c,h,_){let w=new jp(this._properties);for(let P of Object.keys(this._values))w._values[P]=this._values[P].possiblyEvaluate(c,h,_);return w}}class cu{constructor(c,h,_){this.property=c,this.value=h,this.parameters=_}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,h,_,w){return this.property.evaluate(this.value,this.parameters,c,h,_,w)}}class jp{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class _r{constructor(c){this.specification=c}possiblyEvaluate(c,h){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(h)}interpolate(c,h,_){let w=Oo[this.specification.type];return w?w(c,h,_):c}}class Lr{constructor(c,h){this.specification=c,this.overrides=h}possiblyEvaluate(c,h,_,w){return new cu(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(h,null,{},_,w)}:c.expression,h)}interpolate(c,h,_){if(c.value.kind!=="constant"||h.value.kind!=="constant")return c;if(c.value.value===void 0||h.value.value===void 0)return new cu(this,{kind:"constant",value:void 0},c.parameters);let w=Oo[this.specification.type];if(w){let P=w(c.value.value,h.value.value,_);return new cu(this,{kind:"constant",value:P},c.parameters)}return c}evaluate(c,h,_,w,P,R){return c.kind==="constant"?c.value:c.evaluate(h,_,w,P,R)}}class $p extends Lr{possiblyEvaluate(c,h,_,w){if(c.value===void 0)return new cu(this,{kind:"constant",value:void 0},h);if(c.expression.kind==="constant"){let P=c.expression.evaluate(h,null,{},_,w),R=c.property.specification.type==="resolvedImage"&&typeof P!="string"?P.name:P,L=this._calculate(R,R,R,h);return new cu(this,{kind:"constant",value:L},h)}if(c.expression.kind==="camera"){let P=this._calculate(c.expression.evaluate({zoom:h.zoom-1}),c.expression.evaluate({zoom:h.zoom}),c.expression.evaluate({zoom:h.zoom+1}),h);return new cu(this,{kind:"constant",value:P},h)}return new cu(this,c.expression,h)}evaluate(c,h,_,w,P,R){if(c.kind==="source"){let L=c.evaluate(h,_,w,P,R);return this._calculate(L,L,L,h)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(h.zoom)-1},_,w),c.evaluate({zoom:Math.floor(h.zoom)},_,w),c.evaluate({zoom:Math.floor(h.zoom)+1},_,w),h):c.value}_calculate(c,h,_,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:_,to:h}}interpolate(c){return c}}class $A{constructor(c){this.specification=c}possiblyEvaluate(c,h,_,w){if(c.value!==void 0){if(c.expression.kind==="constant"){let P=c.expression.evaluate(h,null,{},_,w);return this._calculate(P,P,P,h)}return this._calculate(c.expression.evaluate(new Cn(Math.floor(h.zoom-1),h)),c.expression.evaluate(new Cn(Math.floor(h.zoom),h)),c.expression.evaluate(new Cn(Math.floor(h.zoom+1),h)),h)}}_calculate(c,h,_,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:c,to:h}:{from:_,to:h}}interpolate(c){return c}}class wm{constructor(c){this.specification=c}possiblyEvaluate(c,h,_,w){return!!c.expression.evaluate(h,null,{},_,w)}interpolate(){return!1}}class da{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let h in c){let _=c[h];_.specification.overridable&&this.overridableProperties.push(h);let w=this.defaultPropertyValues[h]=new UA(_,void 0,void 0),P=this.defaultTransitionablePropertyValues[h]=new vf(_,void 0);this.defaultTransitioningPropertyValues[h]=P.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=w.possiblyEvaluate({})}}}ar("DataDrivenProperty",Lr),ar("DataConstantProperty",_r),ar("CrossFadedDataDrivenProperty",$p),ar("CrossFadedProperty",$A),ar("ColorRampProperty",wm);let uu="-transition";class Jl extends vr{constructor(c,h,_){if(super(),this.id=c.id,this.type=c.type,this._globalState=_,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter,this._featureFilter=gf(c.filter,_)),h.layout&&(this._unevaluatedLayout=new jA(h.layout,_)),h.paint)){this._transitionablePaint=new VA(h.paint,_);for(let w in c.paint)this.setPaintProperty(w,c.paint[w],{validate:!1});for(let w in c.layout)this.setLayoutProperty(w,c.layout[w],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new jp(h.paint)}}setFilter(c){this.filter=c,this._featureFilter=gf(c,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}getLayoutAffectingGlobalStateRefs(){let c=new Set;if(this._unevaluatedLayout)for(let h in this._unevaluatedLayout._values){let _=this._unevaluatedLayout._values[h];for(let w of _.getGlobalStateRefs())c.add(w)}for(let h of this._featureFilter.getGlobalStateRefs())c.add(h);return c}getPaintAffectingGlobalStateRefs(){var c;let h=new globalThis.Map;if(this._transitionablePaint)for(let _ in this._transitionablePaint._values){let w=this._transitionablePaint._values[_].value;for(let P of w.getGlobalStateRefs()){let R=(c=h.get(P))!==null&&c!==void 0?c:[];R.push({name:_,value:w.value}),h.set(P,R)}}return h}setLayoutProperty(c,h,_={}){h!=null&&this._validate(Rv,`layers.${this.id}.layout.${c}`,c,h,_)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,h):this.visibility=h)}getPaintProperty(c){return c.endsWith(uu)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,h,_={}){if(h!=null&&this._validate(kv,`layers.${this.id}.paint.${c}`,c,h,_))return!1;if(c.endsWith(uu))return this._transitionablePaint.setTransition(c.slice(0,-11),h||void 0),!1;{let w=this._transitionablePaint._values[c],P=w.property.specification["property-type"]==="cross-faded-data-driven",R=w.value.isDataDriven(),L=w.value;this._transitionablePaint.setValue(c,h),this._handleSpecialPaintPropertyUpdate(c);let U=this._transitionablePaint._values[c].value;return U.isDataDriven()||R||P||this._handleOverridablePaintPropertyUpdate(c,L,U)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,h,_){return!1}isHidden(c,h=!1){return!!(this.minzoom&&c<(h?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,h){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,h)}serialize(){let c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),Ki(c,((h,_)=>!(h===void 0||_==="layout"&&!Object.keys(h).length||_==="paint"&&!Object.keys(h).length)))}_validate(c,h,_,w,P={}){return(!P||P.validate!==!1)&&wl(this,c.call(Kl,{key:h,layerType:this.type,objectKey:_,value:w,styleSpec:lt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let c in this.paint._values){let h=this.paint.get(c);if(h instanceof cu&&pf(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}let rw;var $4={get paint(){return rw=rw||new da({"raster-opacity":new _r(lt.paint_raster["raster-opacity"]),"raster-hue-rotate":new _r(lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new _r(lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new _r(lt.paint_raster["raster-brightness-max"]),"raster-saturation":new _r(lt.paint_raster["raster-saturation"]),"raster-contrast":new _r(lt.paint_raster["raster-contrast"]),"raster-resampling":new _r(lt.paint_raster["raster-resampling"]),"raster-fade-duration":new _r(lt.paint_raster["raster-fade-duration"])})}};class Wp extends Jl{constructor(c,h){super(c,$4,h)}}let W4={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Sm{constructor(c,h){this._structArray=c,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,h){return c._trim(),h&&(c.isTransferred=!0,h.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){let h=Object.create(this.prototype);return h.arrayBuffer=c.arrayBuffer,h.length=c.length,h.capacity=c.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Jn(d,c=1){let h=0,_=0;return{members:d.map((w=>{let P=W4[w.type].BYTES_PER_ELEMENT,R=h=iw(h,Math.max(c,P)),L=w.components||1;return _=Math.max(_,P),h+=P*L,{name:w.name,type:w.type,components:L,offset:R}})),size:iw(h,Math.max(_,c)),alignment:c}}function iw(d,c){return Math.ceil(d/c)*c}class td extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h){let _=this.length;return this.resize(_+1),this.emplace(_,c,h)}emplace(c,h,_){let w=2*c;return this.int16[w+0]=h,this.int16[w+1]=_,c}}td.prototype.bytesPerElement=4,ar("StructArrayLayout2i4",td);class Ec extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_){let w=this.length;return this.resize(w+1),this.emplace(w,c,h,_)}emplace(c,h,_,w){let P=3*c;return this.int16[P+0]=h,this.int16[P+1]=_,this.int16[P+2]=w,c}}Ec.prototype.bytesPerElement=6,ar("StructArrayLayout3i6",Ec);class WA extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_,w){let P=this.length;return this.resize(P+1),this.emplace(P,c,h,_,w)}emplace(c,h,_,w,P){let R=4*c;return this.int16[R+0]=h,this.int16[R+1]=_,this.int16[R+2]=w,this.int16[R+3]=P,c}}WA.prototype.bytesPerElement=8,ar("StructArrayLayout4i8",WA);class Tm extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R){let L=this.length;return this.resize(L+1),this.emplace(L,c,h,_,w,P,R)}emplace(c,h,_,w,P,R,L){let U=6*c;return this.int16[U+0]=h,this.int16[U+1]=_,this.int16[U+2]=w,this.int16[U+3]=P,this.int16[U+4]=R,this.int16[U+5]=L,c}}Tm.prototype.bytesPerElement=12,ar("StructArrayLayout2i4i12",Tm);class rd extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R){let L=this.length;return this.resize(L+1),this.emplace(L,c,h,_,w,P,R)}emplace(c,h,_,w,P,R,L){let U=4*c,$=8*c;return this.int16[U+0]=h,this.int16[U+1]=_,this.uint8[$+4]=w,this.uint8[$+5]=P,this.uint8[$+6]=R,this.uint8[$+7]=L,c}}rd.prototype.bytesPerElement=8,ar("StructArrayLayout2i4ub8",rd);class id extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h){let _=this.length;return this.resize(_+1),this.emplace(_,c,h)}emplace(c,h,_){let w=2*c;return this.float32[w+0]=h,this.float32[w+1]=_,c}}id.prototype.bytesPerElement=8,ar("StructArrayLayout2f8",id);class bf extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R,L,U,$,q){let J=this.length;return this.resize(J+1),this.emplace(J,c,h,_,w,P,R,L,U,$,q)}emplace(c,h,_,w,P,R,L,U,$,q,J){let oe=10*c;return this.uint16[oe+0]=h,this.uint16[oe+1]=_,this.uint16[oe+2]=w,this.uint16[oe+3]=P,this.uint16[oe+4]=R,this.uint16[oe+5]=L,this.uint16[oe+6]=U,this.uint16[oe+7]=$,this.uint16[oe+8]=q,this.uint16[oe+9]=J,c}}bf.prototype.bytesPerElement=20,ar("StructArrayLayout10ui20",bf);class nd extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R,L,U){let $=this.length;return this.resize($+1),this.emplace($,c,h,_,w,P,R,L,U)}emplace(c,h,_,w,P,R,L,U,$){let q=8*c;return this.uint16[q+0]=h,this.uint16[q+1]=_,this.uint16[q+2]=w,this.uint16[q+3]=P,this.uint16[q+4]=R,this.uint16[q+5]=L,this.uint16[q+6]=U,this.uint16[q+7]=$,c}}nd.prototype.bytesPerElement=16,ar("StructArrayLayout8ui16",nd);class eh extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R,L,U,$,q,J,oe){let se=this.length;return this.resize(se+1),this.emplace(se,c,h,_,w,P,R,L,U,$,q,J,oe)}emplace(c,h,_,w,P,R,L,U,$,q,J,oe,se){let le=12*c;return this.int16[le+0]=h,this.int16[le+1]=_,this.int16[le+2]=w,this.int16[le+3]=P,this.uint16[le+4]=R,this.uint16[le+5]=L,this.uint16[le+6]=U,this.uint16[le+7]=$,this.int16[le+8]=q,this.int16[le+9]=J,this.int16[le+10]=oe,this.int16[le+11]=se,c}}eh.prototype.bytesPerElement=24,ar("StructArrayLayout4i4ui4i24",eh);class GA extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,_){let w=this.length;return this.resize(w+1),this.emplace(w,c,h,_)}emplace(c,h,_,w){let P=3*c;return this.float32[P+0]=h,this.float32[P+1]=_,this.float32[P+2]=w,c}}GA.prototype.bytesPerElement=12,ar("StructArrayLayout3f12",GA);class xf extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){let h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint32[1*c+0]=h,c}}xf.prototype.bytesPerElement=4,ar("StructArrayLayout1ul4",xf);class od extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R,L,U,$){let q=this.length;return this.resize(q+1),this.emplace(q,c,h,_,w,P,R,L,U,$)}emplace(c,h,_,w,P,R,L,U,$,q){let J=10*c,oe=5*c;return this.int16[J+0]=h,this.int16[J+1]=_,this.int16[J+2]=w,this.int16[J+3]=P,this.int16[J+4]=R,this.int16[J+5]=L,this.uint32[oe+3]=U,this.uint16[J+8]=$,this.uint16[J+9]=q,c}}od.prototype.bytesPerElement=20,ar("StructArrayLayout6i1ul2ui20",od);class Dv extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R){let L=this.length;return this.resize(L+1),this.emplace(L,c,h,_,w,P,R)}emplace(c,h,_,w,P,R,L){let U=6*c;return this.int16[U+0]=h,this.int16[U+1]=_,this.int16[U+2]=w,this.int16[U+3]=P,this.int16[U+4]=R,this.int16[U+5]=L,c}}Dv.prototype.bytesPerElement=12,ar("StructArrayLayout2i2i2i12",Dv);class Lv extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P){let R=this.length;return this.resize(R+1),this.emplace(R,c,h,_,w,P)}emplace(c,h,_,w,P,R){let L=4*c,U=8*c;return this.float32[L+0]=h,this.float32[L+1]=_,this.float32[L+2]=w,this.int16[U+6]=P,this.int16[U+7]=R,c}}Lv.prototype.bytesPerElement=16,ar("StructArrayLayout2f1f2i16",Lv);class HA extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R){let L=this.length;return this.resize(L+1),this.emplace(L,c,h,_,w,P,R)}emplace(c,h,_,w,P,R,L){let U=16*c,$=4*c,q=8*c;return this.uint8[U+0]=h,this.uint8[U+1]=_,this.float32[$+1]=w,this.float32[$+2]=P,this.int16[q+6]=R,this.int16[q+7]=L,c}}HA.prototype.bytesPerElement=16,ar("StructArrayLayout2ub2f2i16",HA);class qA extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,_){let w=this.length;return this.resize(w+1),this.emplace(w,c,h,_)}emplace(c,h,_,w){let P=3*c;return this.uint16[P+0]=h,this.uint16[P+1]=_,this.uint16[P+2]=w,c}}qA.prototype.bytesPerElement=6,ar("StructArrayLayout3ui6",qA);class C extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re){let st=this.length;return this.resize(st+1),this.emplace(st,c,h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re)}emplace(c,h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re,st){let Ue=24*c,Ge=12*c,_t=48*c;return this.int16[Ue+0]=h,this.int16[Ue+1]=_,this.uint16[Ue+2]=w,this.uint16[Ue+3]=P,this.uint32[Ge+2]=R,this.uint32[Ge+3]=L,this.uint32[Ge+4]=U,this.uint16[Ue+10]=$,this.uint16[Ue+11]=q,this.uint16[Ue+12]=J,this.float32[Ge+7]=oe,this.float32[Ge+8]=se,this.uint8[_t+36]=le,this.uint8[_t+37]=ye,this.uint8[_t+38]=we,this.uint32[Ge+10]=Re,this.int16[Ue+22]=st,c}}C.prototype.bytesPerElement=48,ar("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",C);class l extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re,st,Ue,Ge,_t,Mt,Ut,ir,Zt,er,Er,Jt){let tr=this.length;return this.resize(tr+1),this.emplace(tr,c,h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re,st,Ue,Ge,_t,Mt,Ut,ir,Zt,er,Er,Jt)}emplace(c,h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re,st,Ue,Ge,_t,Mt,Ut,ir,Zt,er,Er,Jt,tr){let Rt=32*c,Vr=16*c;return this.int16[Rt+0]=h,this.int16[Rt+1]=_,this.int16[Rt+2]=w,this.int16[Rt+3]=P,this.int16[Rt+4]=R,this.int16[Rt+5]=L,this.int16[Rt+6]=U,this.int16[Rt+7]=$,this.uint16[Rt+8]=q,this.uint16[Rt+9]=J,this.uint16[Rt+10]=oe,this.uint16[Rt+11]=se,this.uint16[Rt+12]=le,this.uint16[Rt+13]=ye,this.uint16[Rt+14]=we,this.uint16[Rt+15]=Re,this.uint16[Rt+16]=st,this.uint16[Rt+17]=Ue,this.uint16[Rt+18]=Ge,this.uint16[Rt+19]=_t,this.uint16[Rt+20]=Mt,this.uint16[Rt+21]=Ut,this.uint16[Rt+22]=ir,this.uint32[Vr+12]=Zt,this.float32[Vr+13]=er,this.float32[Vr+14]=Er,this.uint16[Rt+30]=Jt,this.uint16[Rt+31]=tr,c}}l.prototype.bytesPerElement=64,ar("StructArrayLayout8i15ui1ul2f2ui64",l);class f extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){let h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.float32[1*c+0]=h,c}}f.prototype.bytesPerElement=4,ar("StructArrayLayout1f4",f);class v extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,_){let w=this.length;return this.resize(w+1),this.emplace(w,c,h,_)}emplace(c,h,_,w){let P=3*c;return this.uint16[6*c+0]=h,this.float32[P+1]=_,this.float32[P+2]=w,c}}v.prototype.bytesPerElement=12,ar("StructArrayLayout1ui2f12",v);class S extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h,_){let w=this.length;return this.resize(w+1),this.emplace(w,c,h,_)}emplace(c,h,_,w){let P=4*c;return this.uint32[2*c+0]=h,this.uint16[P+2]=_,this.uint16[P+3]=w,c}}S.prototype.bytesPerElement=8,ar("StructArrayLayout1ul2ui8",S);class I extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,h){let _=this.length;return this.resize(_+1),this.emplace(_,c,h)}emplace(c,h,_){let w=2*c;return this.uint16[w+0]=h,this.uint16[w+1]=_,c}}I.prototype.bytesPerElement=4,ar("StructArrayLayout2ui4",I);class D extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){let h=this.length;return this.resize(h+1),this.emplace(h,c)}emplace(c,h){return this.uint16[1*c+0]=h,c}}D.prototype.bytesPerElement=2,ar("StructArrayLayout1ui2",D);class z extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,h,_,w){let P=this.length;return this.resize(P+1),this.emplace(P,c,h,_,w)}emplace(c,h,_,w,P){let R=4*c;return this.float32[R+0]=h,this.float32[R+1]=_,this.float32[R+2]=w,this.float32[R+3]=P,c}}z.prototype.bytesPerElement=16,ar("StructArrayLayout4f16",z);class V extends Sm{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new s(this.anchorPointX,this.anchorPointY)}}V.prototype.size=20;class X extends od{get(c){return new V(this,c)}}ar("CollisionBoxArray",X);class Q extends Sm{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Q.prototype.size=48;class ie extends C{get(c){return new Q(this,c)}}ar("PlacedSymbolArray",ie);class re extends Sm{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}re.prototype.size=64;class ae extends l{get(c){return new re(this,c)}}ar("SymbolInstanceArray",ae);class Ae extends f{getoffsetX(c){return this.float32[1*c+0]}}ar("GlyphOffsetArray",Ae);class Te extends Ec{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}ar("SymbolLineVertexArray",Te);class Me extends Sm{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Me.prototype.size=12;class Ce extends v{get(c){return new Me(this,c)}}ar("TextAnchorOffsetArray",Ce);class De extends Sm{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}De.prototype.size=8;class Ve extends S{get(c){return new De(this,c)}}ar("FeatureIndexArray",Ve);class Oe extends td{}class je extends td{}class He extends td{}class Be extends Tm{}class et extends rd{}class Ke extends id{}class ct extends bf{}class Ye extends nd{}class gt extends eh{}class Gt extends GA{}class Ht extends xf{}class kt extends Dv{}class pr extends HA{}class Ar extends qA{}class Wi extends I{}let An=Jn([{name:"a_pos",components:2,type:"Int16"}],4),{members:kn}=An;class St{constructor(c=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=c}prepareSegment(c,h,_,w){let P=this.segments[this.segments.length-1];return c>St.MAX_VERTEX_ARRAY_LENGTH&&xn(`Max vertices per segment is ${St.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${St.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!P||P.vertexLength+c>St.MAX_VERTEX_ARRAY_LENGTH||P.sortKey!==w?this.createNewSegment(h,_,w):P}createNewSegment(c,h,_){let w={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return _!==void 0&&(w.sortKey=_),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(w),w}getOrCreateLatestSegment(c,h,_){return this.prepareSegment(0,c,h,_)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let c of this.segments)for(let h in c.vaos)c.vaos[h].destroy()}static simpleSegment(c,h,_,w){return new St([{vertexOffset:c,primitiveOffset:h,vertexLength:_,primitiveLength:w,vaos:{},sortKey:0}])}}function Dt(d,c){return 256*(d=xr(Math.floor(d),0,255))+xr(Math.floor(c),0,255)}St.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ar("SegmentVector",St);let ts=Jn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),eo=Jn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var $o,to,Gn,ro={exports:{}},th={exports:{}},Ba={exports:{}},g=(function(){if(Gn)return ro.exports;Gn=1;var d=($o||($o=1,th.exports=function(h,_){var w,P,R,L,U,$,q,J;for(P=h.length-(w=3&h.length),R=_,U=3432918353,$=461845907,J=0;J<P;)q=255&h.charCodeAt(J)|(255&h.charCodeAt(++J))<<8|(255&h.charCodeAt(++J))<<16|(255&h.charCodeAt(++J))<<24,++J,R=27492+(65535&(L=5*(65535&(R=(R^=q=(65535&(q=(q=(65535&q)*U+(((q>>>16)*U&65535)<<16)&4294967295)<<15|q>>>17))*$+(((q>>>16)*$&65535)<<16)&4294967295)<<13|R>>>19))+((5*(R>>>16)&65535)<<16)&4294967295))+((58964+(L>>>16)&65535)<<16);switch(q=0,w){case 3:q^=(255&h.charCodeAt(J+2))<<16;case 2:q^=(255&h.charCodeAt(J+1))<<8;case 1:R^=q=(65535&(q=(q=(65535&(q^=255&h.charCodeAt(J)))*U+(((q>>>16)*U&65535)<<16)&4294967295)<<15|q>>>17))*$+(((q>>>16)*$&65535)<<16)&4294967295}return R^=h.length,R=2246822507*(65535&(R^=R>>>16))+((2246822507*(R>>>16)&65535)<<16)&4294967295,R=3266489909*(65535&(R^=R>>>13))+((3266489909*(R>>>16)&65535)<<16)&4294967295,(R^=R>>>16)>>>0}),th.exports),c=(to||(to=1,Ba.exports=function(h,_){for(var w,P=h.length,R=_^P,L=0;P>=4;)w=1540483477*(65535&(w=255&h.charCodeAt(L)|(255&h.charCodeAt(++L))<<8|(255&h.charCodeAt(++L))<<16|(255&h.charCodeAt(++L))<<24))+((1540483477*(w>>>16)&65535)<<16),R=1540483477*(65535&R)+((1540483477*(R>>>16)&65535)<<16)^(w=1540483477*(65535&(w^=w>>>24))+((1540483477*(w>>>16)&65535)<<16)),P-=4,++L;switch(P){case 3:R^=(255&h.charCodeAt(L+2))<<16;case 2:R^=(255&h.charCodeAt(L+1))<<8;case 1:R=1540483477*(65535&(R^=255&h.charCodeAt(L)))+((1540483477*(R>>>16)&65535)<<16)}return R=1540483477*(65535&(R^=R>>>13))+((1540483477*(R>>>16)&65535)<<16),(R^=R>>>15)>>>0}),Ba.exports);return ro.exports=d,ro.exports.murmur3=d,ro.exports.murmur2=c,ro.exports})(),y=a(g);class b{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,h,_,w){this.ids.push(T(c)),this.positions.push(h,_,w)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let h=T(c),_=0,w=this.ids.length-1;for(;_<w;){let R=_+w>>1;this.ids[R]>=h?w=R:_=R+1}let P=[];for(;this.ids[_]===h;)P.push({index:this.positions[3*_],start:this.positions[3*_+1],end:this.positions[3*_+2]}),_++;return P}static serialize(c,h){let _=new Float64Array(c.ids),w=new Uint32Array(c.positions);return E(_,w,0,_.length-1),h&&h.push(_.buffer,w.buffer),{ids:_,positions:w}}static deserialize(c){let h=new b;return h.ids=c.ids,h.positions=c.positions,h.indexed=!0,h}}function T(d){let c=+d;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:y(String(d))}function E(d,c,h,_){for(;h<_;){let w=d[h+_>>1],P=h-1,R=_+1;for(;;){do P++;while(d[P]<w);do R--;while(d[R]>w);if(P>=R)break;O(d,P,R),O(c,3*P,3*R),O(c,3*P+1,3*R+1),O(c,3*P+2,3*R+2)}R-h<_-R?(E(d,c,h,R),h=R+1):(E(d,c,R+1,_),_=R)}}function O(d,c,h){let _=d[c];d[c]=d[h],d[h]=_}ar("FeaturePositionMap",b);class B{constructor(c,h){this.gl=c.gl,this.location=h}}class N extends B{constructor(c,h){super(c,h),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class G extends B{constructor(c,h){super(c,h),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class K extends B{constructor(c,h){super(c,h),this.current=ci.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}let te=new Float32Array(16);function _e(d){return[Dt(255*d.r,255*d.g),Dt(255*d.b,255*d.a)]}class Ee{constructor(c,h,_){this.value=c,this.uniformNames=h.map((w=>`u_${w}`)),this.type=_}setUniform(c,h,_){c.set(_.constantOr(this.value))}getBinding(c,h,_){return this.type==="color"?new K(c,h):new N(c,h)}}class ke{constructor(c,h){this.uniformNames=h.map((_=>`u_${_}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=c.tlbr}setConstantDashPositions(c,h){this.dashTo=[0,c.y,c.height,c.width],this.dashFrom=[0,h.y,h.height,h.width]}setUniform(c,h,_,w){let P=null;w==="u_pattern_to"?P=this.patternTo:w==="u_pattern_from"?P=this.patternFrom:w==="u_dasharray_to"?P=this.dashTo:w==="u_dasharray_from"?P=this.dashFrom:w==="u_pixel_ratio_to"?P=this.pixelRatioTo:w==="u_pixel_ratio_from"&&(P=this.pixelRatioFrom),P!==null&&c.set(P)}getBinding(c,h,_){return _.substr(0,9)==="u_pattern"||_.substr(0,12)==="u_dasharray_"?new G(c,h):new N(c,h)}}class Ie{constructor(c,h,_,w){this.expression=c,this.type=_,this.maxValue=0,this.paintVertexAttributes=h.map((P=>({name:`a_${P}`,type:"Float32",components:_==="color"?2:1,offset:0}))),this.paintVertexArray=new w}populatePaintArray(c,h,_){let w=this.paintVertexArray.length,P=this.expression.evaluate(new Cn(0,_),h,{},_.canonical,[],_.formattedSection);this.paintVertexArray.resize(c),this._setPaintValue(w,c,P)}updatePaintArray(c,h,_,w,P){let R=this.expression.evaluate(new Cn(0,P),_,w);this._setPaintValue(c,h,R)}_setPaintValue(c,h,_){if(this.type==="color"){let w=_e(_);for(let P=c;P<h;P++)this.paintVertexArray.emplace(P,w[0],w[1])}else{for(let w=c;w<h;w++)this.paintVertexArray.emplace(w,_);this.maxValue=Math.max(this.maxValue,Math.abs(_))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qe{constructor(c,h,_,w,P,R){this.expression=c,this.uniformNames=h.map((L=>`u_${L}_t`)),this.type=_,this.useIntegerZoom=w,this.zoom=P,this.maxValue=0,this.paintVertexAttributes=h.map((L=>({name:`a_${L}`,type:"Float32",components:_==="color"?4:2,offset:0}))),this.paintVertexArray=new R}populatePaintArray(c,h,_){let w=this.expression.evaluate(new Cn(this.zoom,_),h,{},_.canonical,[],_.formattedSection),P=this.expression.evaluate(new Cn(this.zoom+1,_),h,{},_.canonical,[],_.formattedSection),R=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(R,c,w,P)}updatePaintArray(c,h,_,w,P){let R=this.expression.evaluate(new Cn(this.zoom,P),_,w),L=this.expression.evaluate(new Cn(this.zoom+1,P),_,w);this._setPaintValue(c,h,R,L)}_setPaintValue(c,h,_,w){if(this.type==="color"){let P=_e(_),R=_e(w);for(let L=c;L<h;L++)this.paintVertexArray.emplace(L,P[0],P[1],R[0],R[1])}else{for(let P=c;P<h;P++)this.paintVertexArray.emplace(P,_,w);this.maxValue=Math.max(this.maxValue,Math.abs(_),Math.abs(w))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,h){let _=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,w=xr(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);c.set(w)}getBinding(c,h,_){return new N(c,h)}}class ot{constructor(c,h,_,w,P,R){this.expression=c,this.type=h,this.useIntegerZoom=_,this.zoom=w,this.layerId=R,this.zoomInPaintVertexArray=new P,this.zoomOutPaintVertexArray=new P}populatePaintArray(c,h,_){let w=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(w,c,this.getPositionIds(h),_)}updatePaintArray(c,h,_,w,P){this._setPaintValues(c,h,this.getPositionIds(_),P)}_setPaintValues(c,h,_,w){let P=this.getPositions(w);if(!P||!_)return;let R=P[_.min],L=P[_.mid],U=P[_.max];if(R&&L&&U)for(let $=c;$<h;$++)this.emplace(this.zoomInPaintVertexArray,$,L,R),this.emplace(this.zoomOutPaintVertexArray,$,L,U)}upload(c){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){let h=this.getVertexAttributes();this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,h,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,h,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class wt extends ot{getPositions(c){return c.imagePositions}getPositionIds(c){return c.patterns&&c.patterns[this.layerId]}getVertexAttributes(){return ts.members}emplace(c,h,_,w){c.emplace(h,_.tlbr[0],_.tlbr[1],_.tlbr[2],_.tlbr[3],w.tlbr[0],w.tlbr[1],w.tlbr[2],w.tlbr[3],_.pixelRatio,w.pixelRatio)}}class At extends ot{getPositions(c){return c.dashPositions}getPositionIds(c){return c.dashes&&c.dashes[this.layerId]}getVertexAttributes(){return eo.members}emplace(c,h,_,w){c.emplace(h,0,_.y,_.height,_.width,0,w.y,w.height,w.width)}}class ut{constructor(c,h,_){this.binders={},this._buffers=[];let w=[];for(let P in c.paint._values){if(!_(P))continue;let R=c.paint.get(P);if(!(R instanceof cu&&pf(R.property.specification)))continue;let L=Yt(P,c.type),U=R.value,$=R.property.specification.type,q=R.property.useIntegerZoom,J=R.property.specification["property-type"],oe=J==="cross-faded"||J==="cross-faded-data-driven";if(U.kind==="constant")this.binders[P]=oe?new ke(U.value,L):new Ee(U.value,L,$),w.push(`/u_${P}`);else if(U.kind==="source"||oe){let se=Mr(P,$,"source");this.binders[P]=oe?P==="line-dasharray"?new At(U,$,q,h,se,c.id):new wt(U,$,q,h,se,c.id):new Ie(U,L,$,se),w.push(`/a_${P}`)}else{let se=Mr(P,$,"composite");this.binders[P]=new qe(U,L,$,q,h,se),w.push(`/z_${P}`)}}this.cacheKey=w.sort().join("")}getMaxValue(c){let h=this.binders[c];return h instanceof Ie||h instanceof qe?h.maxValue:0}populatePaintArrays(c,h,_){for(let w in this.binders){let P=this.binders[w];(P instanceof Ie||P instanceof qe||P instanceof ot)&&P.populatePaintArray(c,h,_)}}setConstantPatternPositions(c,h){for(let _ in this.binders){let w=this.binders[_];w instanceof ke&&w.setConstantPatternPositions(c,h)}}setConstantDashPositions(c,h){for(let _ in this.binders){let w=this.binders[_];w instanceof ke&&w.setConstantDashPositions(c,h)}}updatePaintArrays(c,h,_,w,P){let R=!1;for(let L in c){let U=h.getPositions(L);for(let $ of U){let q=_.feature($.index);for(let J in this.binders){let oe=this.binders[J];if((oe instanceof Ie||oe instanceof qe||oe instanceof ot)&&oe.expression.isStateDependent===!0){let se=w.paint.get(J);oe.expression=se.value,oe.updatePaintArray($.start,$.end,q,c[L],P),R=!0}}}}return R}defines(){let c=[];for(let h in this.binders){let _=this.binders[h];(_ instanceof Ee||_ instanceof ke)&&c.push(..._.uniformNames.map((w=>`#define HAS_UNIFORM_${w}`)))}return c}getBinderAttributes(){let c=[];for(let h in this.binders){let _=this.binders[h];if(_ instanceof Ie||_ instanceof qe)for(let w=0;w<_.paintVertexAttributes.length;w++)c.push(_.paintVertexAttributes[w].name);else if(_ instanceof ot){let w=_.getVertexAttributes();for(let P of w)c.push(P.name)}}return c}getBinderUniforms(){let c=[];for(let h in this.binders){let _=this.binders[h];if(_ instanceof Ee||_ instanceof ke||_ instanceof qe)for(let w of _.uniformNames)c.push(w)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,h){let _=[];for(let w in this.binders){let P=this.binders[w];if(P instanceof Ee||P instanceof ke||P instanceof qe){for(let R of P.uniformNames)if(h[R]){let L=P.getBinding(c,h[R],R);_.push({name:R,property:w,binding:L})}}}return _}setUniforms(c,h,_,w){for(let{name:P,property:R,binding:L}of h)this.binders[R].setUniform(L,w,_.get(R),P)}updatePaintBuffers(c){this._buffers=[];for(let h in this.binders){let _=this.binders[h];if(c&&_ instanceof ot){let w=c.fromScale===2?_.zoomInPaintVertexBuffer:_.zoomOutPaintVertexBuffer;w&&this._buffers.push(w)}else(_ instanceof Ie||_ instanceof qe)&&_.paintVertexBuffer&&this._buffers.push(_.paintVertexBuffer)}}upload(c){for(let h in this.binders){let _=this.binders[h];(_ instanceof Ie||_ instanceof qe||_ instanceof ot)&&_.upload(c)}this.updatePaintBuffers()}destroy(){for(let c in this.binders){let h=this.binders[c];(h instanceof Ie||h instanceof qe||h instanceof ot)&&h.destroy()}}}class Xe{constructor(c,h,_=()=>!0){this.programConfigurations={};for(let w of c)this.programConfigurations[w.id]=new ut(w,h,_);this.needsUpload=!1,this._featureMap=new b,this._bufferOffset=0}populatePaintArrays(c,h,_,w){for(let P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(c,h,w);h.id!==void 0&&this._featureMap.add(h.id,_,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,h,_,w){for(let P of _)this.needsUpload=this.programConfigurations[P.id].updatePaintArrays(c,this._featureMap,h,P,w)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(let h in this.programConfigurations)this.programConfigurations[h].upload(c);this.needsUpload=!1}}destroy(){for(let c in this.programConfigurations)this.programConfigurations[c].destroy()}}function Yt(d,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[d]||[d.replace(`${c}-`,"").replace(/-/g,"_")]}function Mr(d,c,h){let _={color:{source:id,composite:z},number:{source:f,composite:id}},w=(function(P){return{"line-pattern":{source:ct,composite:ct},"fill-pattern":{source:ct,composite:ct},"fill-extrusion-pattern":{source:ct,composite:ct},"line-dasharray":{source:Ye,composite:Ye}}[P]})(d);return w&&w[h]||_[c][h]}ar("ConstantBinder",Ee),ar("CrossFadedConstantBinder",ke),ar("SourceExpressionBinder",Ie),ar("CrossFadedPatternBinder",wt),ar("CrossFadedDasharrayBinder",At),ar("CompositeExpressionBinder",qe),ar("ProgramConfiguration",ut,{omit:["_buffers"]}),ar("ProgramConfigurationSet",Xe);let dr=Math.pow(2,14)-1,Qr=-dr-1;function Nr(d){let c=It/d.extent,h=d.loadGeometry();for(let _=0;_<h.length;_++){let w=h[_];for(let P=0;P<w.length;P++){let R=w[P],L=Math.round(R.x*c),U=Math.round(R.y*c);R.x=xr(L,Qr,dr),R.y=xr(U,Qr,dr),(L<R.x||L>R.x+1||U<R.y||U>R.y+1)&&xn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Ai(d,c){return{type:d.type,id:d.id,properties:d.properties,geometry:c?Nr(d):[]}}let Wr=-32768;function kr(d,c,h,_,w){d.emplaceBack(Wr+8*c+_,Wr+8*h+w)}class qt{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=c.index,this.hasDependencies=!1,this.layoutVertexArray=new je,this.indexArray=new Ar,this.segments=new St,this.programConfigurations=new Xe(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(c,h,_){let w=this.layers[0],P=[],R=null,L=!1,U=w.type==="heatmap";if(w.type==="circle"){let q=w;R=q.layout.get("circle-sort-key"),L=!R.isConstant(),U=U||q.paint.get("circle-pitch-alignment")==="map"}let $=U?h.subdivisionGranularity.circle:1;for(let{feature:q,id:J,index:oe,sourceLayerIndex:se}of c){let le=this.layers[0]._featureFilter.needGeometry,ye=Ai(q,le);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),ye,_))continue;let we=L?R.evaluate(ye,{},_):void 0,Re={id:J,properties:q.properties,type:q.type,sourceLayerIndex:se,index:oe,geometry:le?ye.geometry:Nr(q),patterns:{},sortKey:we};P.push(Re)}L&&P.sort(((q,J)=>q.sortKey-J.sortKey));for(let q of P){let{geometry:J,index:oe,sourceLayerIndex:se}=q,le=c[oe].feature;this.addFeature(q,J,oe,_,$),h.featureIndex.insert(le,J,oe,se,this.index)}}update(c,h,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:_})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,kn),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,h,_,w,P=1){let R;switch(P){case 1:R=[0,7];break;case 3:R=[0,2,5,7];break;case 5:R=[0,1,3,4,6,7];break;case 7:R=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${P}; valid values are 1, 3, 5, 7.`)}let L=R.length;for(let U of h)for(let $ of U){let q=$.x,J=$.y;if(q<0||q>=It||J<0||J>=It)continue;let oe=this.segments.prepareSegment(L*L,this.layoutVertexArray,this.indexArray,c.sortKey),se=oe.vertexLength;for(let le=0;le<L;le++)for(let ye=0;ye<L;ye++)kr(this.layoutVertexArray,q,J,R[ye],R[le]);for(let le=0;le<L-1;le++)for(let ye=0;ye<L-1;ye++){let we=se+le*L+ye,Re=se+(le+1)*L+ye;this.indexArray.emplaceBack(we,Re+1,we+1),this.indexArray.emplaceBack(we,Re,Re+1)}oe.vertexLength+=L*L,oe.primitiveLength+=(L-1)*(L-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{imagePositions:{},canonical:w})}}function Ci(d,c){for(let h=0;h<d.length;h++)if(nw(c,d[h]))return!0;for(let h=0;h<c.length;h++)if(nw(d,c[h]))return!0;return!!Fa(d,c)}function Sn(d,c,h){return!!nw(d,c)||!!dV(c,d,h)}function yi(d,c){if(d.length===1)return Sie(c,d[0]);for(let h=0;h<c.length;h++){let _=c[h];for(let w=0;w<_.length;w++)if(nw(d,_[w]))return!0}for(let h=0;h<d.length;h++)if(Sie(c,d[h]))return!0;for(let h=0;h<c.length;h++)if(Fa(d,c[h]))return!0;return!1}function Bn(d,c,h){if(d.length>1){if(Fa(d,c))return!0;for(let _=0;_<c.length;_++)if(dV(c[_],d,h))return!0}for(let _=0;_<d.length;_++)if(dV(d[_],c,h))return!0;return!1}function Fa(d,c){if(d.length===0||c.length===0)return!1;for(let h=0;h<d.length-1;h++){let _=d[h],w=d[h+1];for(let P=0;P<c.length-1;P++)if(CR(_,w,c[P],c[P+1]))return!0}return!1}function CR(d,c,h,_){return dn(d,h,_)!==dn(c,h,_)&&dn(d,c,h)!==dn(d,c,_)}function dV(d,c,h){let _=h*h;if(c.length===1)return d.distSqr(c[0])<_;for(let w=1;w<c.length;w++)if(wie(d,c[w-1],c[w])<_)return!0;return!1}function wie(d,c,h){let _=c.distSqr(h);if(_===0)return d.distSqr(c);let w=((d.x-c.x)*(h.x-c.x)+(d.y-c.y)*(h.y-c.y))/_;return d.distSqr(w<0?c:w>1?h:h.sub(c)._mult(w)._add(c))}function Sie(d,c){let h,_,w,P=!1;for(let R=0;R<d.length;R++){h=d[R];for(let L=0,U=h.length-1;L<h.length;U=L++)_=h[L],w=h[U],_.y>c.y!=w.y>c.y&&c.x<(w.x-_.x)*(c.y-_.y)/(w.y-_.y)+_.x&&(P=!P)}return P}function nw(d,c){let h=!1;for(let _=0,w=d.length-1;_<d.length;w=_++){let P=d[_],R=d[w];P.y>c.y!=R.y>c.y&&c.x<(R.x-P.x)*(c.y-P.y)/(R.y-P.y)+P.x&&(h=!h)}return h}function rIe(d,c,h){let _=h[0],w=h[2];if(d.x<_.x&&c.x<_.x||d.x>w.x&&c.x>w.x||d.y<_.y&&c.y<_.y||d.y>w.y&&c.y>w.y)return!1;let P=dn(d,c,h[0]);return P!==dn(d,c,h[1])||P!==dn(d,c,h[2])||P!==dn(d,c,h[3])}function ow(d,c,h){let _=c.paint.get(d).value;return _.kind==="constant"?_.value:h.programConfigurations.get(c.id).getMaxValue(d)}function PR(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function IR(d,c,h,_,w){if(!c[0]&&!c[1])return d;let P=s.convert(c)._mult(w);h==="viewport"&&P._rotate(-_);let R=[];for(let L=0;L<d.length;L++)R.push(d[L].sub(P));return R}function iIe({queryGeometry:d,size:c},h){return Sn(d,h,c)}function nIe({queryGeometry:d,size:c,transform:h,unwrappedTileID:_,getElevation:w},P){return Sn(d,P,c*(h.projectTileCoordinates(P.x,P.y,_,w).signedDistanceFromCamera/h.cameraToCenterDistance))}function oIe({queryGeometry:d,size:c,transform:h,unwrappedTileID:_,getElevation:w},P){let R=h.projectTileCoordinates(P.x,P.y,_,w).signedDistanceFromCamera,L=c*(h.cameraToCenterDistance/R);return Sn(d,fV(P,h,_,w),L)}function sIe({queryGeometry:d,size:c,transform:h,unwrappedTileID:_,getElevation:w},P){return Sn(d,fV(P,h,_,w),c)}function Tie({queryGeometry:d,size:c,transform:h,unwrappedTileID:_,getElevation:w,pitchAlignment:P="map",pitchScale:R="map"},L){let U=P==="map"?R==="map"?iIe:nIe:R==="map"?oIe:sIe,$={queryGeometry:d,size:c,transform:h,unwrappedTileID:_,getElevation:w};for(let q of L)for(let J of q)if(U($,J))return!0;return!1}function fV(d,c,h,_){let w=c.projectTileCoordinates(d.x,d.y,h,_).point;return new s((.5*w.x+.5)*c.width,(.5*-w.y+.5)*c.height)}let Mie,Eie;ar("CircleBucket",qt,{omit:["layers"]});var aIe={get paint(){return Eie=Eie||new da({"circle-radius":new Lr(lt.paint_circle["circle-radius"]),"circle-color":new Lr(lt.paint_circle["circle-color"]),"circle-blur":new Lr(lt.paint_circle["circle-blur"]),"circle-opacity":new Lr(lt.paint_circle["circle-opacity"]),"circle-translate":new _r(lt.paint_circle["circle-translate"]),"circle-translate-anchor":new _r(lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new _r(lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new _r(lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Lr(lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Lr(lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Lr(lt.paint_circle["circle-stroke-opacity"])})},get layout(){return Mie=Mie||new da({"circle-sort-key":new Lr(lt.layout_circle["circle-sort-key"])})}};class lIe extends Jl{constructor(c,h){super(c,aIe,h)}createBucket(c){return new qt(c)}queryRadius(c){let h=c;return ow("circle-radius",this,h)+ow("circle-stroke-width",this,h)+PR(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:_,geometry:w,transform:P,pixelsToTileUnits:R,unwrappedTileID:L,getElevation:U}){let $=IR(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-P.bearingInRadians,R),q=this.paint.get("circle-radius").evaluate(h,_)+this.paint.get("circle-stroke-width").evaluate(h,_),J=this.paint.get("circle-pitch-scale"),oe=this.paint.get("circle-pitch-alignment"),se,le;return oe==="map"?(se=$,le=q*R):(se=(function(ye,we,Re,st){return ye.map((Ue=>fV(Ue,we,Re,st)))})($,P,L,U),le=q),Tie({queryGeometry:se,size:le,transform:P,unwrappedTileID:L,getElevation:U,pitchAlignment:oe,pitchScale:J},w)}}class Cie extends qt{}let Pie;ar("HeatmapBucket",Cie,{omit:["layers"]});var cIe={get paint(){return Pie=Pie||new da({"heatmap-radius":new Lr(lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Lr(lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new _r(lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wm(lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new _r(lt.paint_heatmap["heatmap-opacity"])})}};function pV(d,{width:c,height:h},_,w){if(w){if(w instanceof Uint8ClampedArray)w=new Uint8Array(w.buffer);else if(w.length!==c*h*_)throw new RangeError(`mismatched image size. expected: ${w.length} but got: ${c*h*_}`)}else w=new Uint8Array(c*h*_);return d.width=c,d.height=h,d.data=w,d}function Iie(d,{width:c,height:h},_){if(c===d.width&&h===d.height)return;let w=pV({},{width:c,height:h},_);mV(d,w,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,c),height:Math.min(d.height,h)},_),d.width=c,d.height=h,d.data=w.data}function mV(d,c,h,_,w,P){if(w.width===0||w.height===0)return c;if(w.width>d.width||w.height>d.height||h.x>d.width-w.width||h.y>d.height-w.height)throw new RangeError("out of range source coordinates for image copy");if(w.width>c.width||w.height>c.height||_.x>c.width-w.width||_.y>c.height-w.height)throw new RangeError("out of range destination coordinates for image copy");let R=d.data,L=c.data;if(R===L)throw new Error("srcData equals dstData, so image is already copied");for(let U=0;U<w.height;U++){let $=((h.y+U)*d.width+h.x)*P,q=((_.y+U)*c.width+_.x)*P;for(let J=0;J<w.width*P;J++)L[q+J]=R[$+J]}return c}class G4{constructor(c,h){pV(this,c,1,h)}resize(c){Iie(this,c,1)}clone(){return new G4({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,_,w,P){mV(c,h,_,w,P,1)}}class Cc{constructor(c,h){pV(this,c,4,h)}resize(c){Iie(this,c,4)}replace(c,h){h?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new Cc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,h,_,w,P){mV(c,h,_,w,P,4)}setPixel(c,h,_){let w=4*(c*this.width+h);this.data[w+0]=Math.round(255*_.r/_.a),this.data[w+1]=Math.round(255*_.g/_.a),this.data[w+2]=Math.round(255*_.b/_.a),this.data[w+3]=Math.round(255*_.a)}}function kie(d){let c={},h=d.resolution||256,_=d.clips?d.clips.length:1,w=d.image||new Cc({width:h,height:_});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);let P=(R,L,U)=>{c[d.evaluationKey]=U;let $=d.expression.evaluate(c);w.setPixel(R/4/h,L/4,$)};if(d.clips)for(let R=0,L=0;R<_;++R,L+=4*h)for(let U=0,$=0;U<h;U++,$+=4){let q=U/(h-1),{start:J,end:oe}=d.clips[R];P(L,$,J*(1-q)+oe*q)}else for(let R=0,L=0;R<h;R++,L+=4)P(0,L,R/(h-1));return w}ar("AlphaImage",G4),ar("RGBAImage",Cc);let gV="big-fb";class uIe extends Jl{createBucket(c){return new Cie(c)}constructor(c,h){super(c,cIe,h),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kie({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(gV)&&this.heatmapFbos.delete(gV)}queryRadius(c){return ow("heatmap-radius",this,c)}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:_,geometry:w,transform:P,pixelsToTileUnits:R,unwrappedTileID:L,getElevation:U}){return Tie({queryGeometry:c,size:this.paint.get("heatmap-radius").evaluate(h,_)*R,transform:P,unwrappedTileID:L,getElevation:U},w)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Rie;var hIe={get paint(){return Rie=Rie||new da({"hillshade-illumination-direction":new _r(lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new _r(lt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new _r(lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new _r(lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new _r(lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new _r(lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new _r(lt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new _r(lt.paint_hillshade["hillshade-method"])})}};class dIe extends Jl{constructor(c,h){super(c,hIe,h),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let c=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,_=this.paint.get("hillshade-highlight-color").values,w=this.paint.get("hillshade-shadow-color").values,P=Math.max(c.length,h.length,_.length,w.length);c=c.concat(Array(P-c.length).fill(c.at(-1))),h=h.concat(Array(P-h.length).fill(h.at(-1))),_=_.concat(Array(P-_.length).fill(_.at(-1))),w=w.concat(Array(P-w.length).fill(w.at(-1)));let R=h.map(vc);return{directionRadians:c.map(vc),altitudeRadians:R,shadowColor:w,highlightColor:_}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Oie;var fIe={get paint(){return Oie=Oie||new da({"color-relief-opacity":new _r(lt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new wm(lt["paint_color-relief"]["color-relief-color"])})}};class AV{constructor(c,h,_,w){this.context=c,this.format=_,this.texture=c.gl.createTexture(),this.update(h,w)}update(c,h,_){let{width:w,height:P}=c,R=!(this.size&&this.size[0]===w&&this.size[1]===P||_),{context:L}=this,{gl:U}=L;if(this.useMipmap=!!(h&&h.useMipmap),U.bindTexture(U.TEXTURE_2D,this.texture),L.pixelStoreUnpackFlipY.set(!1),L.pixelStoreUnpack.set(1),L.pixelStoreUnpackPremultiplyAlpha.set(this.format===U.RGBA&&(!h||h.premultiply!==!1)),R)this.size=[w,P],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||Ss(c)?U.texImage2D(U.TEXTURE_2D,0,this.format,this.format,U.UNSIGNED_BYTE,c):U.texImage2D(U.TEXTURE_2D,0,this.format,w,P,0,this.format,U.UNSIGNED_BYTE,c.data);else{let{x:$,y:q}=_||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||Ss(c)?U.texSubImage2D(U.TEXTURE_2D,0,$,q,U.RGBA,U.UNSIGNED_BYTE,c):U.texSubImage2D(U.TEXTURE_2D,0,$,q,w,P,U.RGBA,U.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&U.generateMipmap(U.TEXTURE_2D),L.pixelStoreUnpackFlipY.setDefault(),L.pixelStoreUnpack.setDefault(),L.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(c,h,_){let{context:w}=this,{gl:P}=w;P.bindTexture(P.TEXTURE_2D,this.texture),_!==P.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(_=P.LINEAR),c!==this.filter&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,c),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,_||c),this.filter=c),h!==this.wrap&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,h),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class Die{constructor(c,h,_,w=1,P=1,R=1,L=0){if(this.uid=c,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(_&&!["mapbox","terrarium","custom"].includes(_))return void xn(`"${_}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;let U=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),_){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=w,this.greenFactor=P,this.blueFactor=R,this.baseShift=L;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let $=0;$<U;$++)this.data[this._idx(-1,$)]=this.data[this._idx(0,$)],this.data[this._idx(U,$)]=this.data[this._idx(U-1,$)],this.data[this._idx($,-1)]=this.data[this._idx($,0)],this.data[this._idx($,U)]=this.data[this._idx($,U-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(U,-1)]=this.data[this._idx(U-1,0)],this.data[this._idx(-1,U)]=this.data[this._idx(0,U-1)],this.data[this._idx(U,U)]=this.data[this._idx(U-1,U-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let $=0;$<U;$++)for(let q=0;q<U;q++){let J=this.get($,q);J>this.max&&(this.max=J),J<this.min&&(this.min=J)}}get(c,h){let _=new Uint8Array(this.data.buffer),w=4*this._idx(c,h);return this.unpack(_[w],_[w+1],_[w+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,h){if(c<-1||c>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(c+1)}unpack(c,h,_){return c*this.redFactor+h*this.greenFactor+_*this.blueFactor-this.baseShift}pack(c){return Lie(c,this.getUnpackVector())}getPixels(){return new Cc({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,h,_){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let w=h*this.dim,P=h*this.dim+this.dim,R=_*this.dim,L=_*this.dim+this.dim;switch(h){case-1:w=P-1;break;case 1:P=w+1}switch(_){case-1:R=L-1;break;case 1:L=R+1}let U=-h*this.dim,$=-_*this.dim;for(let q=R;q<L;q++)for(let J=w;J<P;J++)this.data[this._idx(J,q)]=c.data[this._idx(J+U,q+$)]}}function Lie(d,c){let h=c[0],_=c[1],w=c[2],P=c[3],R=Math.min(h,_,w),L=Math.round((d+P)/R);return{r:Math.floor(L*R/h)%256,g:Math.floor(L*R/_)%256,b:Math.floor(L*R/w)%256}}ar("DEMData",Die);class pIe extends Jl{constructor(c,h){super(c,fIe,h)}_createColorRamp(c){let h={elevationStops:[],colorStops:[]},_=this._transitionablePaint._values["color-relief-color"].value.expression;if(_ instanceof MA&&_._styleExpression.expression instanceof Ro){this.colorRampExpression=_;let R=_._styleExpression.expression;h.elevationStops=R.labels,h.colorStops=[];for(let L of h.elevationStops)h.colorStops.push(R.evaluate({globals:{elevation:L}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[ci.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=c)return h;let w={elevationStops:[],colorStops:[]},P=(h.elevationStops.length-1)/(c-1);for(let R=0;R<h.elevationStops.length-.5;R+=P)w.elevationStops.push(h.elevationStops[Math.round(R)]),w.colorStops.push(h.colorStops[Math.round(R)]);return xn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),w}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(c,h,_){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;let w=this._createColorRamp(h),P=new Cc({width:w.colorStops.length,height:1}),R=new Cc({width:w.colorStops.length,height:1});for(let L=0;L<w.elevationStops.length;L++){let U=Lie(w.elevationStops[L],_);R.setPixel(0,L,new ci(U.r/255,U.g/255,U.b/255,1)),P.setPixel(0,L,w.colorStops[L])}return this.colorRampTextures={elevationTexture:new AV(c,R,c.gl.RGBA),colorTexture:new AV(c,P,c.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}let mIe=Jn([{name:"a_pos",components:2,type:"Int16"}],4),{members:gIe}=mIe;function kR(d,c,h){let _=h.patternDependencies,w=!1;for(let P of c){let R=P.paint.get(`${d}-pattern`);R.isConstant()||(w=!0);let L=R.constantOr(null);L&&(w=!0,_[L.to]=!0,_[L.from]=!0)}return w}function yV(d,c,h,_,w){let{zoom:P}=_,R=w.patternDependencies;for(let L of c){let U=L.paint.get(`${d}-pattern`).value;if(U.kind!=="constant"){let $=U.evaluate({zoom:P-1},h,{},w.availableImages),q=U.evaluate({zoom:P},h,{},w.availableImages),J=U.evaluate({zoom:P+1},h,{},w.availableImages);$=$&&$.name?$.name:$,q=q&&q.name?q.name:q,J=J&&J.name?J.name:J,R[$]=!0,R[q]=!0,R[J]=!0,h.patterns[L.id]={min:$,mid:q,max:J}}}return h}function Bie(d,c,h,_,w){let P;if(w===(function(R,L,U,$){let q=0;for(let J=L,oe=U-$;J<U;J+=$)q+=(R[oe]-R[J])*(R[J+1]+R[oe+1]),oe=J;return q})(d,c,h,_)>0)for(let R=c;R<h;R+=_)P=Uie(R/_|0,d[R],d[R+1],P);else for(let R=h-_;R>=c;R-=_)P=Uie(R/_|0,d[R],d[R+1],P);return P&&sw(P,P.next)&&(X4(P),P=P.next),P}function Bv(d,c){if(!d)return d;c||(c=d);let h,_=d;do if(h=!1,_.steiner||!sw(_,_.next)&&ds(_.prev,_,_.next)!==0)_=_.next;else{if(X4(_),_=c=_.prev,_===_.next)break;h=!0}while(h||_!==c);return c}function H4(d,c,h,_,w,P,R){if(!d)return;!R&&P&&(function(U,$,q,J){let oe=U;do oe.z===0&&(oe.z=_V(oe.x,oe.y,$,q,J)),oe.prevZ=oe.prev,oe.nextZ=oe.next,oe=oe.next;while(oe!==U);oe.prevZ.nextZ=null,oe.prevZ=null,(function(se){let le,ye=1;do{let we,Re=se;se=null;let st=null;for(le=0;Re;){le++;let Ue=Re,Ge=0;for(let Mt=0;Mt<ye&&(Ge++,Ue=Ue.nextZ,Ue);Mt++);let _t=ye;for(;Ge>0||_t>0&&Ue;)Ge!==0&&(_t===0||!Ue||Re.z<=Ue.z)?(we=Re,Re=Re.nextZ,Ge--):(we=Ue,Ue=Ue.nextZ,_t--),st?st.nextZ=we:se=we,we.prevZ=st,st=we;Re=Ue}st.nextZ=null,ye*=2}while(le>1)})(oe)})(d,_,w,P);let L=d;for(;d.prev!==d.next;){let U=d.prev,$=d.next;if(P?yIe(d,_,w,P):AIe(d))c.push(U.i,d.i,$.i),X4(d),d=$.next,L=$.next;else if((d=$)===L){R?R===1?H4(d=_Ie(Bv(d),c),c,h,_,w,P,2):R===2&&vIe(d,c,h,_,w,P):H4(Bv(d),c,h,_,w,P,1);break}}}function AIe(d){let c=d.prev,h=d,_=d.next;if(ds(c,h,_)>=0)return!1;let w=c.x,P=h.x,R=_.x,L=c.y,U=h.y,$=_.y,q=Math.min(w,P,R),J=Math.min(L,U,$),oe=Math.max(w,P,R),se=Math.max(L,U,$),le=_.next;for(;le!==c;){if(le.x>=q&&le.x<=oe&&le.y>=J&&le.y<=se&&q4(w,L,P,U,R,$,le.x,le.y)&&ds(le.prev,le,le.next)>=0)return!1;le=le.next}return!0}function yIe(d,c,h,_){let w=d.prev,P=d,R=d.next;if(ds(w,P,R)>=0)return!1;let L=w.x,U=P.x,$=R.x,q=w.y,J=P.y,oe=R.y,se=Math.min(L,U,$),le=Math.min(q,J,oe),ye=Math.max(L,U,$),we=Math.max(q,J,oe),Re=_V(se,le,c,h,_),st=_V(ye,we,c,h,_),Ue=d.prevZ,Ge=d.nextZ;for(;Ue&&Ue.z>=Re&&Ge&&Ge.z<=st;){if(Ue.x>=se&&Ue.x<=ye&&Ue.y>=le&&Ue.y<=we&&Ue!==w&&Ue!==R&&q4(L,q,U,J,$,oe,Ue.x,Ue.y)&&ds(Ue.prev,Ue,Ue.next)>=0||(Ue=Ue.prevZ,Ge.x>=se&&Ge.x<=ye&&Ge.y>=le&&Ge.y<=we&&Ge!==w&&Ge!==R&&q4(L,q,U,J,$,oe,Ge.x,Ge.y)&&ds(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;Ue&&Ue.z>=Re;){if(Ue.x>=se&&Ue.x<=ye&&Ue.y>=le&&Ue.y<=we&&Ue!==w&&Ue!==R&&q4(L,q,U,J,$,oe,Ue.x,Ue.y)&&ds(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.prevZ}for(;Ge&&Ge.z<=st;){if(Ge.x>=se&&Ge.x<=ye&&Ge.y>=le&&Ge.y<=we&&Ge!==w&&Ge!==R&&q4(L,q,U,J,$,oe,Ge.x,Ge.y)&&ds(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function _Ie(d,c){let h=d;do{let _=h.prev,w=h.next.next;!sw(_,w)&&Nie(_,h,h.next,w)&&Y4(_,w)&&Y4(w,_)&&(c.push(_.i,h.i,w.i),X4(h),X4(h.next),h=d=w),h=h.next}while(h!==d);return Bv(h)}function vIe(d,c,h,_,w,P){let R=d;do{let L=R.next.next;for(;L!==R.prev;){if(R.i!==L.i&&TIe(R,L)){let U=zie(R,L);return R=Bv(R,R.next),U=Bv(U,U.next),H4(R,c,h,_,w,P,0),void H4(U,c,h,_,w,P,0)}L=L.next}R=R.next}while(R!==d)}function bIe(d,c){let h=d.x-c.x;return h===0&&(h=d.y-c.y,h===0)&&(h=(d.next.y-d.y)/(d.next.x-d.x)-(c.next.y-c.y)/(c.next.x-c.x)),h}function xIe(d,c){let h=(function(w,P){let R=P,L=w.x,U=w.y,$,q=-1/0;if(sw(w,R))return R;do{if(sw(w,R.next))return R.next;if(U<=R.y&&U>=R.next.y&&R.next.y!==R.y){let ye=R.x+(U-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(ye<=L&&ye>q&&(q=ye,$=R.x<R.next.x?R:R.next,ye===L))return $}R=R.next}while(R!==P);if(!$)return null;let J=$,oe=$.x,se=$.y,le=1/0;R=$;do{if(L>=R.x&&R.x>=oe&&L!==R.x&&Fie(U<se?L:q,U,oe,se,U<se?q:L,U,R.x,R.y)){let ye=Math.abs(U-R.y)/(L-R.x);Y4(R,w)&&(ye<le||ye===le&&(R.x>$.x||R.x===$.x&&wIe($,R)))&&($=R,le=ye)}R=R.next}while(R!==J);return $})(d,c);if(!h)return c;let _=zie(h,d);return Bv(_,_.next),Bv(h,h.next)}function wIe(d,c){return ds(d.prev,d,c.prev)<0&&ds(c.next,d,d.next)<0}function _V(d,c,h,_,w){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-h)*w|0)|d<<8))|d<<4))|d<<2))|d<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-_)*w|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function SIe(d){let c=d,h=d;do(c.x<h.x||c.x===h.x&&c.y<h.y)&&(h=c),c=c.next;while(c!==d);return h}function Fie(d,c,h,_,w,P,R,L){return(w-R)*(c-L)>=(d-R)*(P-L)&&(d-R)*(_-L)>=(h-R)*(c-L)&&(h-R)*(P-L)>=(w-R)*(_-L)}function q4(d,c,h,_,w,P,R,L){return!(d===R&&c===L)&&Fie(d,c,h,_,w,P,R,L)}function TIe(d,c){return d.next.i!==c.i&&d.prev.i!==c.i&&!(function(h,_){let w=h;do{if(w.i!==h.i&&w.next.i!==h.i&&w.i!==_.i&&w.next.i!==_.i&&Nie(w,w.next,h,_))return!0;w=w.next}while(w!==h);return!1})(d,c)&&(Y4(d,c)&&Y4(c,d)&&(function(h,_){let w=h,P=!1,R=(h.x+_.x)/2,L=(h.y+_.y)/2;do w.y>L!=w.next.y>L&&w.next.y!==w.y&&R<(w.next.x-w.x)*(L-w.y)/(w.next.y-w.y)+w.x&&(P=!P),w=w.next;while(w!==h);return P})(d,c)&&(ds(d.prev,d,c.prev)||ds(d,c.prev,c))||sw(d,c)&&ds(d.prev,d,d.next)>0&&ds(c.prev,c,c.next)>0)}function ds(d,c,h){return(c.y-d.y)*(h.x-c.x)-(c.x-d.x)*(h.y-c.y)}function sw(d,c){return d.x===c.x&&d.y===c.y}function Nie(d,c,h,_){let w=OR(ds(d,c,h)),P=OR(ds(d,c,_)),R=OR(ds(h,_,d)),L=OR(ds(h,_,c));return w!==P&&R!==L||!(w!==0||!RR(d,h,c))||!(P!==0||!RR(d,_,c))||!(R!==0||!RR(h,d,_))||!(L!==0||!RR(h,c,_))}function RR(d,c,h){return c.x<=Math.max(d.x,h.x)&&c.x>=Math.min(d.x,h.x)&&c.y<=Math.max(d.y,h.y)&&c.y>=Math.min(d.y,h.y)}function OR(d){return d>0?1:d<0?-1:0}function Y4(d,c){return ds(d.prev,d,d.next)<0?ds(d,c,d.next)>=0&&ds(d,d.prev,c)>=0:ds(d,c,d.prev)<0||ds(d,d.next,c)<0}function zie(d,c){let h=vV(d.i,d.x,d.y),_=vV(c.i,c.x,c.y),w=d.next,P=c.prev;return d.next=c,c.prev=d,h.next=w,w.prev=h,_.next=h,h.prev=_,P.next=_,_.prev=P,_}function Uie(d,c,h,_){let w=vV(d,c,h);return _?(w.next=_.next,w.prev=_,_.next.prev=w,_.next=w):(w.prev=w,w.next=w),w}function X4(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function vV(d,c,h){return{i:d,x:c,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class aw{constructor(c,h){if(h>c)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=c,this._minGranularity=h}getGranularityForZoomLevel(c){return Math.max(Math.floor(this._baseZoomGranularity/(1<<c)),this._minGranularity,1)}}class DR{constructor(c){this.fill=c.fill,this.line=c.line,this.tile=c.tile,this.stencil=c.stencil,this.circle=c.circle}}DR.noSubdivision=new DR({fill:new aw(0,0),line:new aw(0,0),tile:new aw(0,0),stencil:new aw(0,0),circle:1}),ar("SubdivisionGranularityExpression",aw),ar("SubdivisionGranularitySetting",DR);let lw=-32768,Z4=32767;class MIe{constructor(c,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=c,this._granularityCellSize=It/c,this._canonical=h}_getKey(c,h){return(c+=32768)<<16|h+32768}_vertexToIndex(c,h){if(c<-32768||h<-32768||c>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");let _=0|Math.round(c),w=0|Math.round(h),P=this._getKey(_,w);if(this._vertexDictionary.has(P))return this._vertexDictionary.get(P);let R=this._vertexBuffer.length/2;return this._vertexDictionary.set(P,R),this._vertexBuffer.push(_,w),R}_subdivideTrianglesScanline(c){if(this._granularity<2)return(function(w,P){let R=[];for(let L=0;L<P.length;L+=3){let U=P[L],$=P[L+1],q=P[L+2],J=w[2*U],oe=w[2*U+1];(w[2*$]-J)*(w[2*q+1]-oe)-(w[2*$+1]-oe)*(w[2*q]-J)>0?(R.push(U),R.push(q),R.push($)):(R.push(U),R.push($),R.push(q))}return R})(this._vertexBuffer,c);let h=[],_=c.length;for(let w=0;w<_;w+=3){let P=[c[w+0],c[w+1],c[w+2]],R=[this._vertexBuffer[2*c[w+0]+0],this._vertexBuffer[2*c[w+0]+1],this._vertexBuffer[2*c[w+1]+0],this._vertexBuffer[2*c[w+1]+1],this._vertexBuffer[2*c[w+2]+0],this._vertexBuffer[2*c[w+2]+1]],L=1/0,U=1/0,$=-1/0,q=-1/0;for(let ye=0;ye<3;ye++){let we=R[2*ye],Re=R[2*ye+1];L=Math.min(L,we),$=Math.max($,we),U=Math.min(U,Re),q=Math.max(q,Re)}if(L===$||U===q)continue;let J=Math.floor(L/this._granularityCellSize),oe=Math.ceil($/this._granularityCellSize),se=Math.floor(U/this._granularityCellSize),le=Math.ceil(q/this._granularityCellSize);if(J!==oe||se!==le)for(let ye=se;ye<le;ye++){let we=this._scanlineGenerateVertexRingForCellRow(ye,R,P);EIe(this._vertexBuffer,we,h)}else h.push(...P)}return h}_scanlineGenerateVertexRingForCellRow(c,h,_){let w=c*this._granularityCellSize,P=w+this._granularityCellSize,R=[];for(let L=0;L<3;L++){let U=h[2*L],$=h[2*L+1],q=h[2*(L+1)%6],J=h[(2*(L+1)+1)%6],oe=h[2*(L+2)%6],se=h[(2*(L+2)+1)%6],le=q-U,ye=J-$,we=le===0,Re=ye===0,st=(w-$)/ye,Ue=(P-$)/ye,Ge=Math.min(st,Ue),_t=Math.max(st,Ue);if(!Re&&(Ge>=1||_t<=0)||Re&&($<w||$>P)){J>=w&&J<=P&&R.push(_[(L+1)%3]);continue}!Re&&Ge>0&&R.push(this._vertexToIndex(U+le*Ge,$+ye*Ge));let Mt=U+le*Math.max(Ge,0),Ut=U+le*Math.min(_t,1);we||this._generateIntraEdgeVertices(R,U,$,q,J,Mt,Ut),!Re&&_t<1&&R.push(this._vertexToIndex(U+le*_t,$+ye*_t)),(Re||J>=w&&J<=P)&&R.push(_[(L+1)%3]),!Re&&(J<=w||J>=P)&&this._generateInterEdgeVertices(R,U,$,q,J,oe,se,Ut,w,P)}return R}_generateIntraEdgeVertices(c,h,_,w,P,R,L){let U=w-h,$=P-_,q=$===0,J=q?Math.min(h,w):Math.min(R,L),oe=q?Math.max(h,w):Math.max(R,L),se=Math.floor(J/this._granularityCellSize)+1,le=Math.ceil(oe/this._granularityCellSize)-1;if(q?h<w:R<L)for(let ye=se;ye<=le;ye++){let we=ye*this._granularityCellSize;c.push(this._vertexToIndex(we,_+$*(we-h)/U))}else for(let ye=le;ye>=se;ye--){let we=ye*this._granularityCellSize;c.push(this._vertexToIndex(we,_+$*(we-h)/U))}}_generateInterEdgeVertices(c,h,_,w,P,R,L,U,$,q){let J=P-_,oe=R-w,se=L-P,le=($-P)/se,ye=(q-P)/se,we=Math.min(le,ye),Re=Math.max(le,ye),st=w+oe*we,Ue=Math.floor(Math.min(st,U)/this._granularityCellSize)+1,Ge=Math.ceil(Math.max(st,U)/this._granularityCellSize)-1,_t=U<st,Mt=se===0;if(Mt&&(L===$||L===q))return;if(Mt||we>=1||Re<=0){let ir=_-L,Zt=R+(h-R)*Math.min(($-L)/ir,(q-L)/ir);Ue=Math.floor(Math.min(Zt,U)/this._granularityCellSize)+1,Ge=Math.ceil(Math.max(Zt,U)/this._granularityCellSize)-1,_t=U<Zt}let Ut=J>0?q:$;if(_t)for(let ir=Ue;ir<=Ge;ir++)c.push(this._vertexToIndex(ir*this._granularityCellSize,Ut));else for(let ir=Ge;ir>=Ue;ir--)c.push(this._vertexToIndex(ir*this._granularityCellSize,Ut))}_generateOutline(c){let h=[];for(let _ of c){let w=Fv(_,this._granularity,!0),P=this._pointArrayToIndices(w),R=[];for(let L=1;L<P.length;L++)R.push(P[L-1]),R.push(P[L]);h.push(R)}return h}_handlePoles(c){let h=!1,_=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(_=!0)),(h||_)&&this._fillPoles(c,h,_)}_ensureNoPoleVertices(){let c=this._vertexBuffer;for(let h=0;h<c.length;h+=2){let _=c[h+1];_===lw&&(c[h+1]=-32767),_===Z4&&(c[h+1]=32766)}}_generatePoleQuad(c,h,_,w,P,R){w>P!=(R===lw)?(c.push(h),c.push(_),c.push(this._vertexToIndex(w,R)),c.push(_),c.push(this._vertexToIndex(P,R)),c.push(this._vertexToIndex(w,R))):(c.push(_),c.push(h),c.push(this._vertexToIndex(w,R)),c.push(this._vertexToIndex(P,R)),c.push(_),c.push(this._vertexToIndex(w,R)))}_fillPoles(c,h,_){let w=this._vertexBuffer,P=It,R=c.length;for(let L=2;L<R;L+=3){let U=c[L-2],$=c[L-1],q=c[L],J=w[2*U],oe=w[2*U+1],se=w[2*$],le=w[2*$+1],ye=w[2*q],we=w[2*q+1];h&&(oe===0&&le===0&&this._generatePoleQuad(c,U,$,J,se,lw),le===0&&we===0&&this._generatePoleQuad(c,$,q,se,ye,lw),we===0&&oe===0&&this._generatePoleQuad(c,q,U,ye,J,lw)),_&&(oe===P&&le===P&&this._generatePoleQuad(c,U,$,J,se,Z4),le===P&&we===P&&this._generatePoleQuad(c,$,q,se,ye,Z4),we===P&&oe===P&&this._generatePoleQuad(c,q,U,ye,J,Z4))}}_initializeVertices(c){for(let h=0;h<c.length;h+=2)this._vertexToIndex(c[h],c[h+1])}subdividePolygonInternal(c,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:_,holeIndices:w}=(function(L){let U=[],$=[];for(let q of L)if(q.length!==0){q!==L[0]&&U.push($.length/2);for(let J=0;J<q.length;J++)$.push(q[J].x),$.push(q[J].y)}return{flattened:$,holeIndices:U}})(c),P;this._initializeVertices(_);try{let L=(function($,q,J=2){let oe=q&&q.length,se=oe?q[0]*J:$.length,le=Bie($,0,se,J,!0),ye=[];if(!le||le.next===le.prev)return ye;let we,Re,st;if(oe&&(le=(function(Ue,Ge,_t,Mt){let Ut=[];for(let ir=0,Zt=Ge.length;ir<Zt;ir++){let er=Bie(Ue,Ge[ir]*Mt,ir<Zt-1?Ge[ir+1]*Mt:Ue.length,Mt,!1);er===er.next&&(er.steiner=!0),Ut.push(SIe(er))}Ut.sort(bIe);for(let ir=0;ir<Ut.length;ir++)_t=xIe(Ut[ir],_t);return _t})($,q,le,J)),$.length>80*J){we=$[0],Re=$[1];let Ue=we,Ge=Re;for(let _t=J;_t<se;_t+=J){let Mt=$[_t],Ut=$[_t+1];Mt<we&&(we=Mt),Ut<Re&&(Re=Ut),Mt>Ue&&(Ue=Mt),Ut>Ge&&(Ge=Ut)}st=Math.max(Ue-we,Ge-Re),st=st!==0?32767/st:0}return H4(le,ye,J,we,Re,st,0),ye})(_,w),U=this._convertIndices(_,L);P=this._subdivideTrianglesScanline(U)}catch(L){console.error(L)}let R=[];return h&&(R=this._generateOutline(c)),this._ensureNoPoleVertices(),this._handlePoles(P),{verticesFlattened:this._vertexBuffer,indicesTriangles:P,indicesLineList:R}}_convertIndices(c,h){let _=[];for(let w=0;w<h.length;w++)_.push(this._vertexToIndex(c[2*h[w]],c[2*h[w]+1]));return _}_pointArrayToIndices(c){let h=[];for(let _=0;_<c.length;_++){let w=c[_];h.push(this._vertexToIndex(w.x,w.y))}return h}}function Vie(d,c,h,_=!0){return new MIe(h,c).subdividePolygonInternal(d,_)}function Fv(d,c,h=!1){if(!d||d.length<1)return[];if(d.length<2)return[];let _=d[0],w=d[d.length-1],P=h&&(_.x!==w.x||_.y!==w.y);if(c<2)return P?[...d,d[0]]:[...d];let R=Math.floor(It/c),L=[];L.push(new s(d[0].x,d[0].y));let U=d.length,$=P?U:U-1;for(let q=0;q<$;q++){let J=d[q],oe=q<U-1?d[q+1]:d[0],se=J.x,le=J.y,ye=oe.x,we=oe.y,Re=se!==ye,st=le!==we;if(!Re&&!st)continue;let Ue=ye-se,Ge=we-le,_t=Math.abs(Ue),Mt=Math.abs(Ge),Ut=se,ir=le;for(;;){let er=Ue>0?(Math.floor(Ut/R)+1)*R:(Math.ceil(Ut/R)-1)*R,Er=Ge>0?(Math.floor(ir/R)+1)*R:(Math.ceil(ir/R)-1)*R,Jt=Math.abs(Ut-er),tr=Math.abs(ir-Er),Rt=Math.abs(Ut-ye),Vr=Math.abs(ir-we),Jr=Re?Jt/_t:Number.POSITIVE_INFINITY,Rr=st?tr/Mt:Number.POSITIVE_INFINITY;if((Rt<=Jt||!Re)&&(Vr<=tr||!st))break;if(Jr<Rr&&Re||!st){Ut=er,ir+=Ge*Jr;let br=new s(Ut,Math.round(ir));L[L.length-1].x===br.x&&L[L.length-1].y===br.y||L.push(br)}else{Ut+=Ue*Rr,ir=Er;let br=new s(Math.round(Ut),ir);L[L.length-1].x===br.x&&L[L.length-1].y===br.y||L.push(br)}}let Zt=new s(ye,we);L[L.length-1].x===Zt.x&&L[L.length-1].y===Zt.y||L.push(Zt)}return L}function EIe(d,c,h){if(c.length===0)throw new Error("Subdivision vertex ring is empty.");let _=0,w=d[2*c[0]];for(let U=1;U<c.length;U++){let $=d[2*c[U]];$<w&&(w=$,_=U)}let P=c.length,R=_,L=(R+1)%P;for(;;){let U=R-1>=0?R-1:P-1,$=(L+1)%P,q=d[2*c[U]],J=d[2*c[$]],oe=d[2*c[R]],se=d[2*c[R]+1],le=d[2*c[L]+1],ye=!1;if(q<J)ye=!0;else if(q>J)ye=!1;else{let we=le-se,Re=-(d[2*c[L]]-oe),st=se<le?1:-1;((q-oe)*we+(d[2*c[U]+1]-se)*Re)*st>((J-oe)*we+(d[2*c[$]+1]-se)*Re)*st&&(ye=!0)}if(ye){let we=c[U],Re=c[R],st=c[L];we!==Re&&we!==st&&Re!==st&&h.push(st,Re,we),R--,R<0&&(R=P-1)}else{let we=c[$],Re=c[R],st=c[L];we!==Re&&we!==st&&Re!==st&&h.push(st,Re,we),L++,L>=P&&(L=0)}if(U===$)break}}function jie(d,c,h,_,w,P,R,L,U){let $=w.length/2,q=R&&L&&U;if($<St.MAX_VERTEX_ARRAY_LENGTH){let J=c.prepareSegment($,h,_),oe=J.vertexLength;for(let ye=0;ye<P.length;ye+=3)_.emplaceBack(oe+P[ye],oe+P[ye+1],oe+P[ye+2]);let se,le;J.vertexLength+=$,J.primitiveLength+=P.length/3,q&&(le=R.prepareSegment($,h,L),se=le.vertexLength,le.vertexLength+=$);for(let ye=0;ye<w.length;ye+=2)d(w[ye],w[ye+1]);if(q)for(let ye=0;ye<U.length;ye++){let we=U[ye];for(let Re=1;Re<we.length;Re+=2)L.emplaceBack(se+we[Re-1],se+we[Re]);le.primitiveLength+=we.length/2}}else(function(J,oe,se,le,ye,we){let Re=[];for(let Mt=0;Mt<le.length/2;Mt++)Re.push(-1);let st={count:0},Ue=0,Ge=J.getOrCreateLatestSegment(oe,se),_t=Ge.vertexLength;for(let Mt=2;Mt<ye.length;Mt+=3){let Ut=ye[Mt-2],ir=ye[Mt-1],Zt=ye[Mt],er=Re[Ut]<Ue,Er=Re[ir]<Ue,Jt=Re[Zt]<Ue;Ge.vertexLength+((er?1:0)+(Er?1:0)+(Jt?1:0))>St.MAX_VERTEX_ARRAY_LENGTH&&(Ge=J.createNewSegment(oe,se),Ue=st.count,er=!0,Er=!0,Jt=!0,_t=0);let tr=K4(Re,le,we,st,Ut,er,Ge),Rt=K4(Re,le,we,st,ir,Er,Ge),Vr=K4(Re,le,we,st,Zt,Jt,Ge);se.emplaceBack(_t+tr-Ue,_t+Rt-Ue,_t+Vr-Ue),Ge.primitiveLength++}})(c,h,_,w,P,d),q&&(function(J,oe,se,le,ye,we){let Re=[];for(let Mt=0;Mt<le.length/2;Mt++)Re.push(-1);let st={count:0},Ue=0,Ge=J.getOrCreateLatestSegment(oe,se),_t=Ge.vertexLength;for(let Mt=0;Mt<ye.length;Mt++){let Ut=ye[Mt];for(let ir=1;ir<ye[Mt].length;ir+=2){let Zt=Ut[ir-1],er=Ut[ir],Er=Re[Zt]<Ue,Jt=Re[er]<Ue;Ge.vertexLength+((Er?1:0)+(Jt?1:0))>St.MAX_VERTEX_ARRAY_LENGTH&&(Ge=J.createNewSegment(oe,se),Ue=st.count,Er=!0,Jt=!0,_t=0);let tr=K4(Re,le,we,st,Zt,Er,Ge),Rt=K4(Re,le,we,st,er,Jt,Ge);se.emplaceBack(_t+tr-Ue,_t+Rt-Ue),Ge.primitiveLength++}}})(R,h,L,w,U,d),c.forceNewSegmentOnNextPrepare(),R?.forceNewSegmentOnNextPrepare()}function K4(d,c,h,_,w,P,R){if(P){let L=_.count;return h(c[2*w],c[2*w+1]),d[w]=_.count,_.count++,R.vertexLength++,L}return d[w]}class bV{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=c.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new He,this.indexArray=new Ar,this.indexArray2=new Wi,this.programConfigurations=new Xe(c.layers,c.zoom),this.segments=new St,this.segments2=new St,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(c,h,_){this.hasDependencies=kR("fill",this.layers,h);let w=this.layers[0].layout.get("fill-sort-key"),P=!w.isConstant(),R=[];for(let{feature:L,id:U,index:$,sourceLayerIndex:q}of c){let J=this.layers[0]._featureFilter.needGeometry,oe=Ai(L,J);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),oe,_))continue;let se=P?w.evaluate(oe,{},_,h.availableImages):void 0,le={id:U,properties:L.properties,type:L.type,sourceLayerIndex:q,index:$,geometry:J?oe.geometry:Nr(L),patterns:{},sortKey:se};R.push(le)}P&&R.sort(((L,U)=>L.sortKey-U.sortKey));for(let L of R){let{geometry:U,index:$,sourceLayerIndex:q}=L;if(this.hasDependencies){let J=yV("fill",this.layers,L,{zoom:this.zoom},h);this.patternFeatures.push(J)}else this.addFeature(L,U,$,_,{},h.subdivisionGranularity);h.featureIndex.insert(c[$].feature,U,$,q,this.index)}}update(c,h,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:_})}addFeatures(c,h,_){for(let w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,h,_,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,gIe),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,h,_,w,P,R){for(let L of Mp(h,500)){let U=Vie(L,w,R.fill.getGranularityForZoomLevel(w.z)),$=this.layoutVertexArray;jie(((q,J)=>{$.emplaceBack(q,J)}),this.segments,this.layoutVertexArray,this.indexArray,U.verticesFlattened,U.indicesTriangles,this.segments2,this.indexArray2,U.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{imagePositions:P,canonical:w})}}let $ie,Wie;ar("FillBucket",bV,{omit:["layers","patternFeatures"]});var CIe={get paint(){return Wie=Wie||new da({"fill-antialias":new _r(lt.paint_fill["fill-antialias"]),"fill-opacity":new Lr(lt.paint_fill["fill-opacity"]),"fill-color":new Lr(lt.paint_fill["fill-color"]),"fill-outline-color":new Lr(lt.paint_fill["fill-outline-color"]),"fill-translate":new _r(lt.paint_fill["fill-translate"]),"fill-translate-anchor":new _r(lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new $p(lt.paint_fill["fill-pattern"])})},get layout(){return $ie=$ie||new da({"fill-sort-key":new Lr(lt.layout_fill["fill-sort-key"])})}};class PIe extends Jl{constructor(c,h){super(c,CIe,h)}recalculate(c,h){super.recalculate(c,h);let _=this.paint._values["fill-outline-color"];_.value.kind==="constant"&&_.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new bV(c)}queryRadius(){return PR(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:c,geometry:h,transform:_,pixelsToTileUnits:w}){return yi(IR(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-_.bearingInRadians,w),h)}isTileClipped(){return!0}}let IIe=Jn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),kIe=Jn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:RIe}=IIe;class cw{constructor(c,h,_,w,P){this.properties={},this.extent=_,this.type=0,this.id=void 0,this._pbf=c,this._geometry=-1,this._keys=w,this._values=P,c.readFields(OIe,this,h)}loadGeometry(){let c=this._pbf;c.pos=this._geometry;let h=c.readVarint()+c.pos,_=[],w,P=1,R=0,L=0,U=0;for(;c.pos<h;){if(R<=0){let $=c.readVarint();P=7&$,R=$>>3}if(R--,P===1||P===2)L+=c.readSVarint(),U+=c.readSVarint(),P===1&&(w&&_.push(w),w=[]),w&&w.push(new s(L,U));else{if(P!==7)throw new Error(`unknown command ${P}`);w&&w.push(w[0].clone())}}return w&&_.push(w),_}bbox(){let c=this._pbf;c.pos=this._geometry;let h=c.readVarint()+c.pos,_=1,w=0,P=0,R=0,L=1/0,U=-1/0,$=1/0,q=-1/0;for(;c.pos<h;){if(w<=0){let J=c.readVarint();_=7&J,w=J>>3}if(w--,_===1||_===2)P+=c.readSVarint(),R+=c.readSVarint(),P<L&&(L=P),P>U&&(U=P),R<$&&($=R),R>q&&(q=R);else if(_!==7)throw new Error(`unknown command ${_}`)}return[L,$,U,q]}toGeoJSON(c,h,_){let w=this.extent*Math.pow(2,_),P=this.extent*c,R=this.extent*h,L=this.loadGeometry();function U(oe){return[360*(oe.x+P)/w-180,360/Math.PI*Math.atan(Math.exp((1-2*(oe.y+R)/w)*Math.PI))-90]}function $(oe){return oe.map(U)}let q;if(this.type===1){let oe=[];for(let le of L)oe.push(le[0]);let se=$(oe);q=oe.length===1?{type:"Point",coordinates:se[0]}:{type:"MultiPoint",coordinates:se}}else if(this.type===2){let oe=L.map($);q=oe.length===1?{type:"LineString",coordinates:oe[0]}:{type:"MultiLineString",coordinates:oe}}else{if(this.type!==3)throw new Error("unknown feature type");{let oe=(function(le){let ye=le.length;if(ye<=1)return[le];let we=[],Re,st;for(let Ue=0;Ue<ye;Ue++){let Ge=DIe(le[Ue]);Ge!==0&&(st===void 0&&(st=Ge<0),st===Ge<0?(Re&&we.push(Re),Re=[le[Ue]]):Re&&Re.push(le[Ue]))}return Re&&we.push(Re),we})(L),se=[];for(let le of oe)se.push(le.map($));q=se.length===1?{type:"Polygon",coordinates:se[0]}:{type:"MultiPolygon",coordinates:se}}}let J={type:"Feature",geometry:q,properties:this.properties};return this.id!=null&&(J.id=this.id),J}}function OIe(d,c,h){d===1?c.id=h.readVarint():d===2?(function(_,w){let P=_.readVarint()+_.pos;for(;_.pos<P;){let R=w._keys[_.readVarint()],L=w._values[_.readVarint()];w.properties[R]=L}})(h,c):d===3?c.type=h.readVarint():d===4&&(c._geometry=h.pos)}function DIe(d){let c=0;for(let h,_,w=0,P=d.length,R=P-1;w<P;R=w++)h=d[w],_=d[R],c+=(_.x-h.x)*(h.y+_.y);return c}cw.types=["Unknown","Point","LineString","Polygon"];class Gie{constructor(c,h){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(LIe,this,h),this.length=this._features.length}feature(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];let h=this._pbf.readVarint()+this._pbf.pos;return new cw(this._pbf,h,this.extent,this._keys,this._values)}}function LIe(d,c,h){d===15?c.version=h.readVarint():d===1?c.name=h.readString():d===5?c.extent=h.readVarint():d===2?c._features.push(h.pos):d===3?c._keys.push(h.readString()):d===4&&c._values.push((function(_){let w=null,P=_.readVarint()+_.pos;for(;_.pos<P;){let R=_.readVarint()>>3;w=R===1?_.readString():R===2?_.readFloat():R===3?_.readDouble():R===4?_.readVarint64():R===5?_.readVarint():R===6?_.readSVarint():R===7?_.readBoolean():null}if(w==null)throw new Error("unknown feature value");return w})(h))}class Hie{constructor(c,h){this.layers=c.readFields(BIe,{},h)}}function BIe(d,c,h){if(d===3){let _=new Gie(h,h.readVarint()+h.pos);_.length&&(c[_.name]=_)}}let xV=Math.pow(2,13);function Q4(d,c,h,_,w,P,R,L){d.emplaceBack(c,h,2*Math.floor(_*xV)+R,w*xV*2,P*xV*2,Math.round(L))}class wV{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=c.index,this.hasDependencies=!1,this.layoutVertexArray=new Be,this.centroidVertexArray=new Oe,this.indexArray=new Ar,this.programConfigurations=new Xe(c.layers,c.zoom),this.segments=new St,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(c,h,_){this.features=[],this.hasDependencies=kR("fill-extrusion",this.layers,h);for(let{feature:w,id:P,index:R,sourceLayerIndex:L}of c){let U=this.layers[0]._featureFilter.needGeometry,$=Ai(w,U);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),$,_))continue;let q={id:P,sourceLayerIndex:L,index:R,geometry:U?$.geometry:Nr(w),properties:w.properties,type:w.type,patterns:{}};this.hasDependencies?this.features.push(yV("fill-extrusion",this.layers,q,{zoom:this.zoom},h)):this.addFeature(q,q.geometry,R,_,{},h.subdivisionGranularity),h.featureIndex.insert(w,q.geometry,R,L,this.index,!0)}}addFeatures(c,h,_){for(let w of this.features){let{geometry:P}=w;this.addFeature(w,P,w.index,h,_,c.subdivisionGranularity)}}update(c,h,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:_})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,RIe),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,kIe.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,h,_,w,P,R){for(let L of Mp(h,500)){let U={x:0,y:0,sampleCount:0},$=this.layoutVertexArray.length;this.processPolygon(U,w,c,L,R);let q=this.layoutVertexArray.length-$,J=Math.floor(U.x/U.sampleCount),oe=Math.floor(U.y/U.sampleCount);for(let se=0;se<q;se++)this.centroidVertexArray.emplaceBack(J,oe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{imagePositions:P,canonical:w})}processPolygon(c,h,_,w,P){if(w.length<1||qie(w[0]))return;for(let J of w)J.length!==0&&FIe(c,J);let R={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},L=P.fill.getGranularityForZoomLevel(h.z),U=cw.types[_.type]==="Polygon";for(let J of w){if(J.length===0||qie(J))continue;let oe=Fv(J,L,U);this._generateSideFaces(oe,R)}if(!U)return;let $=Vie(w,h,L,!1),q=this.layoutVertexArray;jie(((J,oe)=>{Q4(q,J,oe,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,$.verticesFlattened,$.indicesTriangles)}_generateSideFaces(c,h){let _=0;for(let w=1;w<c.length;w++){let P=c[w],R=c[w-1];if(NIe(P,R))continue;h.segment.vertexLength+4>St.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let L=P.sub(R)._perp()._unit(),U=R.dist(P);_+U>32768&&(_=0),Q4(this.layoutVertexArray,P.x,P.y,L.x,L.y,0,0,_),Q4(this.layoutVertexArray,P.x,P.y,L.x,L.y,0,1,_),_+=U,Q4(this.layoutVertexArray,R.x,R.y,L.x,L.y,0,0,_),Q4(this.layoutVertexArray,R.x,R.y,L.x,L.y,0,1,_);let $=h.segment.vertexLength;this.indexArray.emplaceBack($,$+2,$+1),this.indexArray.emplaceBack($+1,$+2,$+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function FIe(d,c){for(let h=0;h<c.length;h++){let _=c[h];h===c.length-1&&c[0].x===_.x&&c[0].y===_.y||(d.x+=_.x,d.y+=_.y,d.sampleCount++)}}function NIe(d,c){return d.x===c.x&&(d.x<0||d.x>It)||d.y===c.y&&(d.y<0||d.y>It)}function qie(d){return d.every((c=>c.x<0))||d.every((c=>c.x>It))||d.every((c=>c.y<0))||d.every((c=>c.y>It))}let Yie;ar("FillExtrusionBucket",wV,{omit:["layers","features"]});var zIe={get paint(){return Yie=Yie||new da({"fill-extrusion-opacity":new _r(lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Lr(lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new _r(lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new _r(lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $p(lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Lr(lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Lr(lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new _r(lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class UIe extends Jl{constructor(c,h){super(c,zIe,h)}createBucket(c){return new wV(c)}queryRadius(){return PR(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:_,geometry:w,transform:P,pixelsToTileUnits:R,pixelPosMatrix:L}){let U=IR(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-P.bearingInRadians,R),$=this.paint.get("fill-extrusion-height").evaluate(h,_),q=this.paint.get("fill-extrusion-base").evaluate(h,_),J=(function(se,le){let ye=[];for(let we of se){let Re=[we.x,we.y,0,1];We(Re,Re,le),ye.push(new s(Re[0]/Re[3],Re[1]/Re[3]))}return ye})(U,L),oe=(function(se,le,ye,we){let Re=[],st=[],Ue=we[8]*le,Ge=we[9]*le,_t=we[10]*le,Mt=we[11]*le,Ut=we[8]*ye,ir=we[9]*ye,Zt=we[10]*ye,er=we[11]*ye;for(let Er of se){let Jt=[],tr=[];for(let Rt of Er){let Vr=Rt.x,Jr=Rt.y,Rr=we[0]*Vr+we[4]*Jr+we[12],br=we[1]*Vr+we[5]*Jr+we[13],Xi=we[2]*Vr+we[6]*Jr+we[14],Wo=we[3]*Vr+we[7]*Jr+we[15],Xs=Xi+_t,il=Wo+Mt,ih=Rr+Ut,Pc=br+ir,Na=Xi+Zt,Do=Wo+er,pa=new s((Rr+Ue)/il,(br+Ge)/il);pa.z=Xs/il,Jt.push(pa);let za=new s(ih/Do,Pc/Do);za.z=Na/Do,tr.push(za)}Re.push(Jt),st.push(tr)}return[Re,st]})(w,q,$,L);return(function(se,le,ye){let we=1/0;yi(ye,le)&&(we=Xie(ye,le[0]));for(let Re=0;Re<le.length;Re++){let st=le[Re],Ue=se[Re];for(let Ge=0;Ge<st.length-1;Ge++){let _t=st[Ge],Mt=[_t,st[Ge+1],Ue[Ge+1],Ue[Ge],_t];Ci(ye,Mt)&&(we=Math.min(we,Xie(ye,Mt)))}}return we!==1/0&&we})(oe[0],oe[1],J)}}function J4(d,c){return d.x*c.x+d.y*c.y}function Xie(d,c){if(d.length===1){let h=0,_=c[h++],w;for(;!w||_.equals(w);)if(w=c[h++],!w)return 1/0;for(;h<c.length;h++){let P=c[h],R=d[0],L=w.sub(_),U=P.sub(_),$=R.sub(_),q=J4(L,L),J=J4(L,U),oe=J4(U,U),se=J4($,L),le=J4($,U),ye=q*oe-J*J,we=(oe*se-J*le)/ye,Re=(q*le-J*se)/ye,st=_.z*(1-we-Re)+w.z*we+P.z*Re;if(isFinite(st))return st}return 1/0}{let h=1/0;for(let _ of c)h=Math.min(h,_.z);return h}}let VIe=Jn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:jIe}=VIe,$Ie=Jn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:WIe}=$Ie,GIe=Math.cos(Math.PI/180*37.5),Zie=Math.pow(2,14)/.5;class SV{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=c.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((h=>{this.gradients[h.id]={}})),this.layoutVertexArray=new et,this.layoutVertexArray2=new Ke,this.indexArray=new Ar,this.programConfigurations=new Xe(c.layers,c.zoom),this.segments=new St,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(c,h,_){this.hasDependencies=kR("line",this.layers,h)||this.hasLineDasharray(this.layers);let w=this.layers[0].layout.get("line-sort-key"),P=!w.isConstant(),R=[];for(let{feature:L,id:U,index:$,sourceLayerIndex:q}of c){let J=this.layers[0]._featureFilter.needGeometry,oe=Ai(L,J);if(!this.layers[0]._featureFilter.filter(new Cn(this.zoom),oe,_))continue;let se=P?w.evaluate(oe,{},_):void 0,le={id:U,properties:L.properties,type:L.type,sourceLayerIndex:q,index:$,geometry:J?oe.geometry:Nr(L),patterns:{},dashes:{},sortKey:se};R.push(le)}P&&R.sort(((L,U)=>L.sortKey-U.sortKey));for(let L of R){let{geometry:U,index:$,sourceLayerIndex:q}=L;this.hasDependencies?(kR("line",this.layers,h)?yV("line",this.layers,L,{zoom:this.zoom},h):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,L,this.zoom,h),this.patternFeatures.push(L)):this.addFeature(L,U,$,_,{},{},h.subdivisionGranularity),h.featureIndex.insert(c[$].feature,U,$,q,this.index)}}update(c,h,_,w){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,h,this.stateDependentLayers,{imagePositions:_,dashPositions:w})}addFeatures(c,h,_,w){for(let P of this.patternFeatures)this.addFeature(P,P.geometry,P.index,h,_,w,c.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,WIe)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,jIe),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,h,_,w,P,R,L){let U=this.layers[0].layout,$=U.get("line-join").evaluate(c,{}),q=U.get("line-cap"),J=U.get("line-miter-limit"),oe=U.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(let se of h)this.addLine(se,c,$,q,J,oe,w,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{imagePositions:P,dashPositions:R,canonical:w})}addLine(c,h,_,w,P,R,L,U){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,c=Fv(c,L?U.line.getGranularityForZoomLevel(L.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ue=0;Ue<c.length-1;Ue++)this.totalDistance+=c[Ue].dist(c[Ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let $=cw.types[h.type]==="Polygon",q=c.length;for(;q>=2&&c[q-1].equals(c[q-2]);)q--;let J=0;for(;J<q-1&&c[J].equals(c[J+1]);)J++;if(q<($?3:2))return;_==="bevel"&&(P=1.05);let oe=this.overscaling<=16?122880/(512*this.overscaling):0,se=this.segments.prepareSegment(10*q,this.layoutVertexArray,this.indexArray),le,ye,we,Re,st;this.e1=this.e2=-1,$&&(le=c[q-2],st=c[J].sub(le)._unit()._perp());for(let Ue=J;Ue<q;Ue++){if(we=Ue===q-1?$?c[J+1]:void 0:c[Ue+1],we&&c[Ue].equals(we))continue;st&&(Re=st),le&&(ye=le),le=c[Ue],st=we?we.sub(le)._unit()._perp():Re,Re=Re||st;let Ge=Re.add(st);Ge.x===0&&Ge.y===0||Ge._unit();let _t=Re.x*st.x+Re.y*st.y,Mt=Ge.x*st.x+Ge.y*st.y,Ut=Mt!==0?1/Mt:1/0,ir=2*Math.sqrt(2-2*Mt),Zt=Mt<GIe&&ye&&we,er=Re.x*st.y-Re.y*st.x>0;if(Zt&&Ue>J){let tr=le.dist(ye);if(tr>2*oe){let Rt=le.sub(le.sub(ye)._mult(oe/tr)._round());this.updateDistance(ye,Rt),this.addCurrentVertex(Rt,Re,0,0,se),ye=Rt}}let Er=ye&&we,Jt=Er?_:$?"butt":w;if(Er&&Jt==="round"&&(Ut<R?Jt="miter":Ut<=2&&(Jt="fakeround")),Jt==="miter"&&Ut>P&&(Jt="bevel"),Jt==="bevel"&&(Ut>2&&(Jt="flipbevel"),Ut<P&&(Jt="miter")),ye&&this.updateDistance(ye,le),Jt==="miter")Ge._mult(Ut),this.addCurrentVertex(le,Ge,0,0,se);else if(Jt==="flipbevel"){if(Ut>100)Ge=st.mult(-1);else{let tr=Ut*Re.add(st).mag()/Re.sub(st).mag();Ge._perp()._mult(tr*(er?-1:1))}this.addCurrentVertex(le,Ge,0,0,se),this.addCurrentVertex(le,Ge.mult(-1),0,0,se)}else if(Jt==="bevel"||Jt==="fakeround"){let tr=-Math.sqrt(Ut*Ut-1),Rt=er?tr:0,Vr=er?0:tr;if(ye&&this.addCurrentVertex(le,Re,Rt,Vr,se),Jt==="fakeround"){let Jr=Math.round(180*ir/Math.PI/20);for(let Rr=1;Rr<Jr;Rr++){let br=Rr/Jr;if(br!==.5){let Wo=br-.5;br+=br*Wo*(br-1)*((1.0904+_t*(_t*(3.55645-1.43519*_t)-3.2452))*Wo*Wo+(.848013+_t*(.215638*_t-1.06021)))}let Xi=st.sub(Re)._mult(br)._add(Re)._unit()._mult(er?-1:1);this.addHalfVertex(le,Xi.x,Xi.y,!1,er,0,se)}}we&&this.addCurrentVertex(le,st,-Rt,-Vr,se)}else if(Jt==="butt")this.addCurrentVertex(le,Ge,0,0,se);else if(Jt==="square"){let tr=ye?1:-1;this.addCurrentVertex(le,Ge,tr,tr,se)}else Jt==="round"&&(ye&&(this.addCurrentVertex(le,Re,0,0,se),this.addCurrentVertex(le,Re,1,1,se,!0)),we&&(this.addCurrentVertex(le,st,-1,-1,se,!0),this.addCurrentVertex(le,st,0,0,se)));if(Zt&&Ue<q-1){let tr=le.dist(we);if(tr>2*oe){let Rt=le.add(we.sub(le)._mult(oe/tr)._round());this.updateDistance(le,Rt),this.addCurrentVertex(Rt,st,0,0,se),le=Rt}}}}addCurrentVertex(c,h,_,w,P,R=!1){let L=h.y*w-h.x,U=-h.y-h.x*w;this.addHalfVertex(c,h.x+h.y*_,h.y-h.x*_,R,!1,_,P),this.addHalfVertex(c,L,U,R,!0,-w,P),this.distance>Zie/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,h,_,w,P,R))}addHalfVertex({x:c,y:h},_,w,P,R,L,U){let $=.5*(this.lineClips?this.scaledDistance*(Zie-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c<<1)+(P?1:0),(h<<1)+(R?1:0),Math.round(63*_)+128,Math.round(63*w)+128,1+(L===0?0:L<0?-1:1)|(63&$)<<2,$>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let q=U.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,q,this.e2),U.primitiveLength++),R?this.e2=q:this.e1=q}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,h){this.distance+=c.dist(h),this.updateScaledDistance()}hasLineDasharray(c){for(let h of c){let _=h.paint.get("line-dasharray");if(_&&!_.isConstant())return!0}return!1}addLineDashDependencies(c,h,_,w){for(let P of c){let R=P.paint.get("line-dasharray");if(!R||R.value.kind==="constant")continue;let L=P.layout.get("line-cap")==="round",U={dasharray:R.value.evaluate({zoom:_-1},h,{}),round:L},$={dasharray:R.value.evaluate({zoom:_},h,{}),round:L},q={dasharray:R.value.evaluate({zoom:_+1},h,{}),round:L},J=`${U.dasharray.join(",")},${U.round}`,oe=`${$.dasharray.join(",")},${$.round}`,se=`${q.dasharray.join(",")},${q.round}`;w.dashDependencies[J]=U,w.dashDependencies[oe]=$,w.dashDependencies[se]=q,h.dashes[P.id]={min:J,mid:oe,max:se}}}}let Kie,Qie;ar("LineBucket",SV,{omit:["layers","patternFeatures"]});var Jie={get paint(){return Qie=Qie||new da({"line-opacity":new Lr(lt.paint_line["line-opacity"]),"line-color":new Lr(lt.paint_line["line-color"]),"line-translate":new _r(lt.paint_line["line-translate"]),"line-translate-anchor":new _r(lt.paint_line["line-translate-anchor"]),"line-width":new Lr(lt.paint_line["line-width"]),"line-gap-width":new Lr(lt.paint_line["line-gap-width"]),"line-offset":new Lr(lt.paint_line["line-offset"]),"line-blur":new Lr(lt.paint_line["line-blur"]),"line-dasharray":new $p(lt.paint_line["line-dasharray"]),"line-pattern":new $p(lt.paint_line["line-pattern"]),"line-gradient":new wm(lt.paint_line["line-gradient"])})},get layout(){return Kie=Kie||new da({"line-cap":new _r(lt.layout_line["line-cap"]),"line-join":new Lr(lt.layout_line["line-join"]),"line-miter-limit":new _r(lt.layout_line["line-miter-limit"]),"line-round-limit":new _r(lt.layout_line["line-round-limit"]),"line-sort-key":new Lr(lt.layout_line["line-sort-key"])})}};class HIe extends Lr{possiblyEvaluate(c,h){return h=new Cn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(c,h)}evaluate(c,h,_,w){return h=jr({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(c,h,_,w)}}let LR;class qIe extends Jl{constructor(c,h){super(c,Jie,h),this.gradientVersion=0,LR||(LR=new HIe(Jie.paint.properties["line-width"].specification),LR.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){let h=this.gradientExpression();this.stepInterpolant=!!(function(_){return _._styleExpression!==void 0})(h)&&h._styleExpression.expression instanceof Wn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,h){super.recalculate(c,h),this.paint._values["line-floorwidth"]=LR.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new SV(c)}queryRadius(c){let h=c,_=ene(ow("line-width",this,h),ow("line-gap-width",this,h)),w=ow("line-offset",this,h);return _/2+Math.abs(w)+PR(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:c,feature:h,featureState:_,geometry:w,transform:P,pixelsToTileUnits:R}){let L=IR(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-P.bearingInRadians,R),U=R/2*ene(this.paint.get("line-width").evaluate(h,_),this.paint.get("line-gap-width").evaluate(h,_)),$=this.paint.get("line-offset").evaluate(h,_);return $&&(w=(function(q,J){let oe=[];for(let se=0;se<q.length;se++){let le=q[se],ye=[];for(let we=0;we<le.length;we++){let Re=le[we-1],st=le[we],Ue=le[we+1],Ge=we===0?new s(0,0):st.sub(Re)._unit()._perp(),_t=we===le.length-1?new s(0,0):Ue.sub(st)._unit()._perp(),Mt=Ge._add(_t)._unit(),Ut=Mt.x*_t.x+Mt.y*_t.y;Ut!==0&&Mt._mult(1/Ut),ye.push(Mt._mult(J)._add(st))}oe.push(ye)}return oe})(w,$*R)),(function(q,J,oe){for(let se=0;se<J.length;se++){let le=J[se];if(q.length>=3){for(let ye=0;ye<le.length;ye++)if(nw(q,le[ye]))return!0}if(Bn(q,le,oe))return!0}return!1})(L,w,U)}isTileClipped(){return!0}}function ene(d,c){return c>0?c+2*d:d}let YIe=Jn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),XIe=Jn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Jn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let ZIe=Jn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Jn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let tne=Jn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),KIe=Jn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function QIe(d,c,h){return d.sections.forEach((_=>{_.text=(function(w,P,R){let L=P.layout.get("text-transform").evaluate(R,{});return L==="uppercase"?w=w.toLocaleUpperCase():L==="lowercase"&&(w=w.toLocaleLowerCase()),lu.applyArabicShaping&&(w=lu.applyArabicShaping(w)),w})(_.text,c,h)})),d}Jn([{name:"triangle",components:3,type:"Uint16"}]),Jn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Jn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Jn([{type:"Float32",name:"offsetX"}]),Jn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Jn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let eM={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var fa=24;let TV=4294967296,rne=1/TV,ine=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class MV{constructor(c=new Uint8Array(16)){this.buf=ArrayBuffer.isView(c)?c:new Uint8Array(c),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(c,h,_=this.length){for(;this.pos<_;){let w=this.readVarint(),P=w>>3,R=this.pos;this.type=7&w,c(P,h,this),this.pos===R&&this.skip(w)}return h}readMessage(c,h){return this.readFields(c,h,this.readVarint()+this.pos)}readFixed32(){let c=this.dataView.getUint32(this.pos,!0);return this.pos+=4,c}readSFixed32(){let c=this.dataView.getInt32(this.pos,!0);return this.pos+=4,c}readFixed64(){let c=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*TV;return this.pos+=8,c}readSFixed64(){let c=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*TV;return this.pos+=8,c}readFloat(){let c=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,c}readDouble(){let c=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,c}readVarint(c){let h=this.buf,_,w;return w=h[this.pos++],_=127&w,w<128?_:(w=h[this.pos++],_|=(127&w)<<7,w<128?_:(w=h[this.pos++],_|=(127&w)<<14,w<128?_:(w=h[this.pos++],_|=(127&w)<<21,w<128?_:(w=h[this.pos],_|=(15&w)<<28,(function(P,R,L){let U=L.buf,$,q;if(q=U[L.pos++],$=(112&q)>>4,q<128||(q=U[L.pos++],$|=(127&q)<<3,q<128)||(q=U[L.pos++],$|=(127&q)<<10,q<128)||(q=U[L.pos++],$|=(127&q)<<17,q<128)||(q=U[L.pos++],$|=(127&q)<<24,q<128)||(q=U[L.pos++],$|=(1&q)<<31,q<128))return uw(P,$,R);throw new Error("Expected varint not more than 10 bytes")})(_,c,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){let c=this.readVarint();return c%2==1?(c+1)/-2:c/2}readBoolean(){return!!this.readVarint()}readString(){let c=this.readVarint()+this.pos,h=this.pos;return this.pos=c,c-h>=12&&ine?ine.decode(this.buf.subarray(h,c)):(function(_,w,P){let R="",L=w;for(;L<P;){let U=_[L],$,q,J,oe=null,se=U>239?4:U>223?3:U>191?2:1;if(L+se>P)break;se===1?U<128&&(oe=U):se===2?($=_[L+1],(192&$)==128&&(oe=(31&U)<<6|63&$,oe<=127&&(oe=null))):se===3?($=_[L+1],q=_[L+2],(192&$)==128&&(192&q)==128&&(oe=(15&U)<<12|(63&$)<<6|63&q,(oe<=2047||oe>=55296&&oe<=57343)&&(oe=null))):se===4&&($=_[L+1],q=_[L+2],J=_[L+3],(192&$)==128&&(192&q)==128&&(192&J)==128&&(oe=(15&U)<<18|(63&$)<<12|(63&q)<<6|63&J,(oe<=65535||oe>=1114112)&&(oe=null))),oe===null?(oe=65533,se=1):oe>65535&&(oe-=65536,R+=String.fromCharCode(oe>>>10&1023|55296),oe=56320|1023&oe),R+=String.fromCharCode(oe),L+=se}return R})(this.buf,h,c)}readBytes(){let c=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,c);return this.pos=c,h}readPackedVarint(c=[],h){let _=this.readPackedEnd();for(;this.pos<_;)c.push(this.readVarint(h));return c}readPackedSVarint(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readSVarint());return c}readPackedBoolean(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readBoolean());return c}readPackedFloat(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readFloat());return c}readPackedDouble(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readDouble());return c}readPackedFixed32(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readFixed32());return c}readPackedSFixed32(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readSFixed32());return c}readPackedFixed64(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readFixed64());return c}readPackedSFixed64(c=[]){let h=this.readPackedEnd();for(;this.pos<h;)c.push(this.readSFixed64());return c}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(c){let h=7&c;if(h===0)for(;this.buf[this.pos++]>127;);else if(h===2)this.pos=this.readVarint()+this.pos;else if(h===5)this.pos+=4;else{if(h!==1)throw new Error(`Unimplemented type: ${h}`);this.pos+=8}}writeTag(c,h){this.writeVarint(c<<3|h)}realloc(c){let h=this.length||16;for(;h<this.pos+c;)h*=2;if(h!==this.length){let _=new Uint8Array(h);_.set(this.buf),this.buf=_,this.dataView=new DataView(_.buffer),this.length=h}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeSFixed32(c){this.realloc(4),this.dataView.setInt32(this.pos,c,!0),this.pos+=4}writeFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*rne),!0),this.pos+=8}writeSFixed64(c){this.realloc(8),this.dataView.setInt32(this.pos,-1&c,!0),this.dataView.setInt32(this.pos+4,Math.floor(c*rne),!0),this.pos+=8}writeVarint(c){(c=+c||0)>268435455||c<0?(function(h,_){let w,P;if(h>=0?(w=h%4294967296|0,P=h/4294967296|0):(w=~(-h%4294967296),P=~(-h/4294967296),4294967295^w?w=w+1|0:(w=0,P=P+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");_.realloc(10),(function(R,L,U){U.buf[U.pos++]=127&R|128,R>>>=7,U.buf[U.pos++]=127&R|128,R>>>=7,U.buf[U.pos++]=127&R|128,R>>>=7,U.buf[U.pos++]=127&R|128,U.buf[U.pos]=127&(R>>>=7)})(w,0,_),(function(R,L){let U=(7&R)<<4;L.buf[L.pos++]|=U|((R>>>=3)?128:0),R&&(L.buf[L.pos++]=127&R|((R>>>=7)?128:0),R&&(L.buf[L.pos++]=127&R|((R>>>=7)?128:0),R&&(L.buf[L.pos++]=127&R|((R>>>=7)?128:0),R&&(L.buf[L.pos++]=127&R|((R>>>=7)?128:0),R&&(L.buf[L.pos++]=127&R)))))})(P,_)})(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))}writeSVarint(c){this.writeVarint(c<0?2*-c-1:2*c)}writeBoolean(c){this.writeVarint(+c)}writeString(c){c=String(c),this.realloc(4*c.length),this.pos++;let h=this.pos;this.pos=(function(w,P,R){for(let L,U,$=0;$<P.length;$++){if(L=P.charCodeAt($),L>55295&&L<57344){if(!U){L>56319||$+1===P.length?(w[R++]=239,w[R++]=191,w[R++]=189):U=L;continue}if(L<56320){w[R++]=239,w[R++]=191,w[R++]=189,U=L;continue}L=U-55296<<10|L-56320|65536,U=null}else U&&(w[R++]=239,w[R++]=191,w[R++]=189,U=null);L<128?w[R++]=L:(L<2048?w[R++]=L>>6|192:(L<65536?w[R++]=L>>12|224:(w[R++]=L>>18|240,w[R++]=L>>12&63|128),w[R++]=L>>6&63|128),w[R++]=63&L|128)}return R})(this.buf,c,this.pos);let _=this.pos-h;_>=128&&nne(h,_,this),this.pos=h-1,this.writeVarint(_),this.pos+=_}writeFloat(c){this.realloc(4),this.dataView.setFloat32(this.pos,c,!0),this.pos+=4}writeDouble(c){this.realloc(8),this.dataView.setFloat64(this.pos,c,!0),this.pos+=8}writeBytes(c){let h=c.length;this.writeVarint(h),this.realloc(h);for(let _=0;_<h;_++)this.buf[this.pos++]=c[_]}writeRawMessage(c,h){this.pos++;let _=this.pos;c(h,this);let w=this.pos-_;w>=128&&nne(_,w,this),this.pos=_-1,this.writeVarint(w),this.pos+=w}writeMessage(c,h,_){this.writeTag(c,2),this.writeRawMessage(h,_)}writePackedVarint(c,h){h.length&&this.writeMessage(c,JIe,h)}writePackedSVarint(c,h){h.length&&this.writeMessage(c,eke,h)}writePackedBoolean(c,h){h.length&&this.writeMessage(c,ike,h)}writePackedFloat(c,h){h.length&&this.writeMessage(c,tke,h)}writePackedDouble(c,h){h.length&&this.writeMessage(c,rke,h)}writePackedFixed32(c,h){h.length&&this.writeMessage(c,nke,h)}writePackedSFixed32(c,h){h.length&&this.writeMessage(c,oke,h)}writePackedFixed64(c,h){h.length&&this.writeMessage(c,ske,h)}writePackedSFixed64(c,h){h.length&&this.writeMessage(c,ake,h)}writeBytesField(c,h){this.writeTag(c,2),this.writeBytes(h)}writeFixed32Field(c,h){this.writeTag(c,5),this.writeFixed32(h)}writeSFixed32Field(c,h){this.writeTag(c,5),this.writeSFixed32(h)}writeFixed64Field(c,h){this.writeTag(c,1),this.writeFixed64(h)}writeSFixed64Field(c,h){this.writeTag(c,1),this.writeSFixed64(h)}writeVarintField(c,h){this.writeTag(c,0),this.writeVarint(h)}writeSVarintField(c,h){this.writeTag(c,0),this.writeSVarint(h)}writeStringField(c,h){this.writeTag(c,2),this.writeString(h)}writeFloatField(c,h){this.writeTag(c,5),this.writeFloat(h)}writeDoubleField(c,h){this.writeTag(c,1),this.writeDouble(h)}writeBooleanField(c,h){this.writeVarintField(c,+h)}}function uw(d,c,h){return h?4294967296*c+(d>>>0):4294967296*(c>>>0)+(d>>>0)}function nne(d,c,h){let _=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));h.realloc(_);for(let w=h.pos-1;w>=d;w--)h.buf[w+_]=h.buf[w]}function JIe(d,c){for(let h=0;h<d.length;h++)c.writeVarint(d[h])}function eke(d,c){for(let h=0;h<d.length;h++)c.writeSVarint(d[h])}function tke(d,c){for(let h=0;h<d.length;h++)c.writeFloat(d[h])}function rke(d,c){for(let h=0;h<d.length;h++)c.writeDouble(d[h])}function ike(d,c){for(let h=0;h<d.length;h++)c.writeBoolean(d[h])}function nke(d,c){for(let h=0;h<d.length;h++)c.writeFixed32(d[h])}function oke(d,c){for(let h=0;h<d.length;h++)c.writeSFixed32(d[h])}function ske(d,c){for(let h=0;h<d.length;h++)c.writeFixed64(d[h])}function ake(d,c){for(let h=0;h<d.length;h++)c.writeSFixed64(d[h])}function lke(d,c,h){d===1&&h.readMessage(cke,c)}function cke(d,c,h){if(d===3){let{id:_,bitmap:w,width:P,height:R,left:L,top:U,advance:$}=h.readMessage(uke,{});c.push({id:_,bitmap:new G4({width:P+6,height:R+6},w),metrics:{width:P,height:R,left:L,top:U,advance:$}})}}function uke(d,c,h){d===1?c.id=h.readVarint():d===2?c.bitmap=h.readBytes():d===3?c.width=h.readVarint():d===4?c.height=h.readVarint():d===5?c.left=h.readSVarint():d===6?c.top=h.readSVarint():d===7&&(c.advance=h.readVarint())}function one(d){let c=0,h=0;for(let R of d)c+=R.w*R.h,h=Math.max(h,R.w);d.sort(((R,L)=>L.h-R.h));let _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),h),h:1/0}],w=0,P=0;for(let R of d)for(let L=_.length-1;L>=0;L--){let U=_[L];if(!(R.w>U.w||R.h>U.h)){if(R.x=U.x,R.y=U.y,P=Math.max(P,R.y+R.h),w=Math.max(w,R.x+R.w),R.w===U.w&&R.h===U.h){let $=_.pop();$&&L<_.length&&(_[L]=$)}else R.h===U.h?(U.x+=R.w,U.w-=R.w):R.w===U.w?(U.y+=R.h,U.h-=R.h):(_.push({x:U.x+R.w,y:U.y,w:U.w-R.w,h:R.h}),U.y+=R.h,U.h-=R.h);break}}return{w,h:P,fill:c/(w*P)||0}}class EV{constructor(c,{pixelRatio:h,version:_,stretchX:w,stretchY:P,content:R,textFitWidth:L,textFitHeight:U}){this.paddedRect=c,this.pixelRatio=h,this.stretchX=w,this.stretchY=P,this.content=R,this.version=_,this.textFitWidth=L,this.textFitHeight=U}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class sne{constructor(c,h){let _={},w={};this.haveRenderCallbacks=[];let P=[];this.addImages(c,_,P),this.addImages(h,w,P);let{w:R,h:L}=one(P),U=new Cc({width:R||1,height:L||1});for(let $ in c){let q=c[$],J=_[$].paddedRect;Cc.copy(q.data,U,{x:0,y:0},{x:J.x+1,y:J.y+1},q.data)}for(let $ in h){let q=h[$],J=w[$].paddedRect,oe=J.x+1,se=J.y+1,le=q.data.width,ye=q.data.height;Cc.copy(q.data,U,{x:0,y:0},{x:oe,y:se},q.data),Cc.copy(q.data,U,{x:0,y:ye-1},{x:oe,y:se-1},{width:le,height:1}),Cc.copy(q.data,U,{x:0,y:0},{x:oe,y:se+ye},{width:le,height:1}),Cc.copy(q.data,U,{x:le-1,y:0},{x:oe-1,y:se},{width:1,height:ye}),Cc.copy(q.data,U,{x:0,y:0},{x:oe+le,y:se},{width:1,height:ye})}this.image=U,this.iconPositions=_,this.patternPositions=w}addImages(c,h,_){for(let w in c){let P=c[w],R={x:0,y:0,w:P.data.width+2,h:P.data.height+2};_.push(R),h[w]=new EV(R,P),P.hasRenderCallback&&this.haveRenderCallbacks.push(w)}}patchUpdatedImages(c,h){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let _ in c.updatedImages)this.patchUpdatedImage(this.iconPositions[_],c.getImage(_),h),this.patchUpdatedImage(this.patternPositions[_],c.getImage(_),h)}patchUpdatedImage(c,h,_){if(!c||!h||c.version===h.version)return;c.version=h.version;let[w,P]=c.tl;_.update(h.data,void 0,{x:w,y:P})}}var YA;ar("ImagePosition",EV),ar("ImageAtlas",sne),n.ao=void 0,(YA=n.ao||(n.ao={}))[YA.none=0]="none",YA[YA.horizontal=1]="horizontal",YA[YA.vertical=2]="vertical",YA[YA.horizontalOnly=3]="horizontalOnly";class tM{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(c,h,_){let w=new tM;return w.scale=c||1,w.fontStack=h,w.verticalAlign=_||"bottom",w}static forImage(c,h){let _=new tM;return _.imageName=c,_.verticalAlign=h||"bottom",_}}class hw{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,h){let _=new hw;for(let w=0;w<c.sections.length;w++){let P=c.sections[w];P.image?_.addImageSection(P):_.addTextSection(P,h)}return _}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=(function(c){let h="";for(let _=0;_<c.length;_++){let w=c.charCodeAt(_+1)||null,P=c.charCodeAt(_-1)||null;h+=w&&Jx(w)&&!eM[c[_+1]]||P&&Jx(P)&&!eM[c[_-1]]||!eM[c[_]]?c[_]:eM[c[_]]}return h})(this.text)}trim(){let c=0;for(let _=0;_<this.text.length&&FR[this.text.charCodeAt(_)];_++)c++;let h=this.text.length;for(let _=this.text.length-1;_>=0&&_>=c&&FR[this.text.charCodeAt(_)];_--)h--;this.text=this.text.substring(c,h),this.sectionIndex=this.sectionIndex.slice(c,h)}substring(c,h){let _=new hw;return _.text=this.text.substring(c,h),_.sectionIndex=this.sectionIndex.slice(c,h),_.sections=this.sections,_}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((c,h)=>Math.max(c,this.sections[h].scale)),0)}getMaxImageSize(c){let h=0,_=0;for(let w=0;w<this.length();w++){let P=this.getSection(w);if(P.imageName){let R=c[P.imageName];if(!R)continue;let L=R.displaySize;h=Math.max(h,L[0]),_=Math.max(_,L[1])}}return{maxImageWidth:h,maxImageHeight:_}}addTextSection(c,h){this.text+=c.text,this.sections.push(tM.forText(c.scale,c.fontStack||h,c.verticalAlign));let _=this.sections.length-1;for(let w=0;w<c.text.length;++w)this.sectionIndex.push(_)}addImageSection(c){let h=c.image?c.image.name:"";if(h.length===0)return void xn("Can't add FormattedSection with an empty image.");let _=this.getNextImageSectionCharCode();_?(this.text+=String.fromCharCode(_),this.sections.push(tM.forImage(h,c.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):xn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function BR(d,c,h,_,w,P,R,L,U,$,q,J,oe,se,le){let ye=hw.fromFeature(d,w),we;J===n.ao.vertical&&ye.verticalizePunctuation();let{processBidirectionalText:Re,processStyledBidirectionalText:st}=lu;if(Re&&ye.sections.length===1){we=[];let _t=Re(ye.toString(),CV(ye,$,P,c,_,se));for(let Mt of _t){let Ut=new hw;Ut.text=Mt,Ut.sections=ye.sections;for(let ir=0;ir<Mt.length;ir++)Ut.sectionIndex.push(0);we.push(Ut)}}else if(st){we=[];let _t=st(ye.text,ye.sectionIndex,CV(ye,$,P,c,_,se));for(let Mt of _t){let Ut=new hw;Ut.text=Mt[0],Ut.sectionIndex=Mt[1],Ut.sections=ye.sections,we.push(Ut)}}else we=(function(_t,Mt){let Ut=[],ir=_t.text,Zt=0;for(let er of Mt)Ut.push(_t.substring(Zt,er)),Zt=er;return Zt<ir.length&&Ut.push(_t.substring(Zt,ir.length)),Ut})(ye,CV(ye,$,P,c,_,se));let Ue=[],Ge={positionedLines:Ue,text:ye.toString(),top:q[1],bottom:q[1],left:q[0],right:q[0],writingMode:J,iconsInText:!1,verticalizable:!1};return(function(_t,Mt,Ut,ir,Zt,er,Er,Jt,tr,Rt,Vr,Jr){let Rr=0,br=0,Xi=0,Wo=0,Xs=Jt==="right"?1:Jt==="left"?0:.5,il=fa/Jr,ih=0;for(let Do of Zt){Do.trim();let pa=Do.getMaxScale(),za={positionedGlyphs:[],lineOffset:0};_t.positionedLines[ih]=za;let Ua=za.positionedGlyphs,ec=0;if(!Do.length()){br+=er,++ih;continue}let nh=pke(ir,Do,il);for(let Ic=0;Ic<Do.length();Ic++){let Zs=Do.getSection(Ic),ga=Do.getSectionIndex(Ic),Aa=Do.getCharCode(Ic),Cs=mke(tr,Vr,Aa),mo;if(Zs.imageName){if(_t.iconsInText=!0,Zs.scale=Zs.scale*il,mo=Ake(Zs,Cs,pa,nh,ir),!mo)continue;ec=Math.max(ec,mo.imageOffset)}else if(mo=gke(Zs,Aa,Cs,nh,Mt,Ut),!mo)continue;let{rect:wf,metrics:mw,baselineOffset:Sf}=mo;Ua.push({glyph:Aa,imageName:Zs.imageName,x:Rr,y:br+Sf+-17,vertical:Cs,scale:Zs.scale,fontStack:Zs.fontStack,sectionIndex:ga,metrics:mw,rect:wf}),Cs?(_t.verticalizable=!0,Rr+=(Zs.imageName?mw.advance:fa)*Zs.scale+Rt):Rr+=mw.advance*Zs.scale+Rt}Ua.length!==0&&(Xi=Math.max(Rr-Rt,Xi),yke(Ua,0,Ua.length-1,Xs)),Rr=0,za.lineOffset=Math.max(ec,(pa-1)*fa);let ma=er*pa+ec;br+=ma,Wo=Math.max(ma,Wo),++ih}let{horizontalAlign:Pc,verticalAlign:Na}=PV(Er);(function(Do,pa,za,Ua,ec,nh,ma,Ic,Zs){let ga=(pa-za)*ec,Aa=0;Aa=nh!==ma?-Ic*Ua- -17:-Ua*Zs*ma+.5*ma;for(let Cs of Do)for(let mo of Cs.positionedGlyphs)mo.x+=ga,mo.y+=Aa})(_t.positionedLines,Xs,Pc,Na,Xi,Wo,er,br,Zt.length),_t.top+=-Na*br,_t.bottom=_t.top+br,_t.left+=-Pc*Xi,_t.right=_t.left+Xi})(Ge,c,h,_,we,R,L,U,J,$,oe,le),!(function(_t){for(let Mt of _t)if(Mt.positionedGlyphs.length!==0)return!1;return!0})(Ue)&&Ge}let FR={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hke={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},dke={40:!0};function ane(d,c,h,_,w,P){if(c.imageName){let R=_[c.imageName];return R?R.displaySize[0]*c.scale*fa/P+w:0}{let R=h[c.fontStack],L=R&&R[d];return L?L.metrics.advance*c.scale+w:0}}function lne(d,c,h,_){let w=Math.pow(d-c,2);return _?d<c?w/2:2*w:w+Math.abs(h)*h}function fke(d,c,h){let _=0;return d===10&&(_-=1e4),h&&(_+=150),d!==40&&d!==65288||(_+=50),c!==41&&c!==65289||(_+=50),_}function cne(d,c,h,_,w,P){let R=null,L=lne(c,h,w,P);for(let U of _){let $=lne(c-U.x,h,w,P)+U.badness;$<=L&&(R=U,L=$)}return{index:d,x:c,priorBreak:R,badness:L}}function une(d){return d?une(d.priorBreak).concat(d.index):[]}function CV(d,c,h,_,w,P){if(!d)return[];let R=[],L=(function(J,oe,se,le,ye,we){let Re=0;for(let st=0;st<J.length();st++){let Ue=J.getSection(st);Re+=ane(J.getCharCode(st),Ue,le,ye,oe,we)}return Re/Math.max(1,Math.ceil(Re/se))})(d,c,h,_,w,P),U=d.text.indexOf("\u200B")>=0,$=0;for(let J=0;J<d.length();J++){let oe=d.getSection(J),se=d.getCharCode(J);if(FR[se]||($+=ane(se,oe,_,w,c,P)),J<d.length()-1){let le=!((q=se)<11904)&&(!!Ri["CJK Compatibility Forms"](q)||!!Ri["CJK Compatibility"](q)||!!Ri["CJK Strokes"](q)||!!Ri["CJK Symbols and Punctuation"](q)||!!Ri["Enclosed CJK Letters and Months"](q)||!!Ri["Halfwidth and Fullwidth Forms"](q)||!!Ri["Ideographic Description Characters"](q)||!!Ri["Vertical Forms"](q)||Ju.test(String.fromCodePoint(q)));(hke[se]||le||oe.imageName||J!==d.length()-2&&dke[d.getCharCode(J+1)])&&R.push(cne(J+1,$,L,R,fke(se,d.getCharCode(J+1),le&&U),!1))}}var q;return une(cne(d.length(),$,L,R,0,!0))}function PV(d){let c=.5,h=.5;switch(d){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:c,verticalAlign:h}}function pke(d,c,h){let _=c.getMaxScale()*fa,{maxImageWidth:w,maxImageHeight:P}=c.getMaxImageSize(d),R=Math.max(_,P*h);return{verticalLineContentWidth:Math.max(_,w*h),horizontalLineContentHeight:R}}function hne(d){switch(d){case"top":return 0;case"center":return .5;default:return 1}}function mke(d,c,h){return!(d===n.ao.horizontal||!c&&!ha(h)||c&&(FR[h]||(_=h,/\p{sc=Arab}/u.test(String.fromCodePoint(_)))));var _}function gke(d,c,h,_,w,P){let R=P[d.fontStack],L=(function($,q,J,oe){if($&&$.rect)return $;let se=q[J.fontStack],le=se&&se[oe];return le?{rect:null,metrics:le.metrics}:null})(R&&R[c],w,d,c);if(L===null)return null;let U;if(h)U=_.verticalLineContentWidth-d.scale*fa;else{let $=hne(d.verticalAlign);U=(_.horizontalLineContentHeight-d.scale*fa)*$}return{rect:L.rect,metrics:L.metrics,baselineOffset:U}}function Ake(d,c,h,_,w){let P=w[d.imageName];if(!P)return null;let R=P.paddedRect,L=P.displaySize,U={width:L[0],height:L[1],left:1,top:-3,advance:c?L[1]:L[0]},$;if(c)$=_.verticalLineContentWidth-L[1]*d.scale;else{let q=hne(d.verticalAlign);$=(_.horizontalLineContentHeight-L[1]*d.scale)*q}return{rect:R,metrics:U,baselineOffset:$,imageOffset:(c?L[0]:L[1])*d.scale-fa*h}}function yke(d,c,h,_){if(_===0)return;let w=d[h],P=(d[h].x+w.metrics.advance*w.scale)*_;for(let R=c;R<=h;R++)d[R].x-=P}function _ke(d,c,h){let{horizontalAlign:_,verticalAlign:w}=PV(h),P=c[0]-d.displaySize[0]*_,R=c[1]-d.displaySize[1]*w;return{image:d,top:R,bottom:R+d.displaySize[1],left:P,right:P+d.displaySize[0]}}function dne(d){var c,h;let _=d.left,w=d.top,P=d.right-_,R=d.bottom-w,L=(c=d.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",U=(h=d.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",$=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if(U==="proportional"){if(L==="stretchOnly"&&P/R<$||L==="proportional"){let q=Math.ceil(R*$);_*=q/P,P=q}}else if(L==="proportional"&&U==="stretchOnly"&&$!==0&&P/R>$){let q=Math.ceil(P/$);w*=q/R,R=q}return{x1:_,y1:w,x2:_+P,y2:w+R}}function fne(d,c,h,_,w,P){let R=d.image,L;if(R.content){let we=R.content,Re=R.pixelRatio||1;L=[we[0]/Re,we[1]/Re,R.displaySize[0]-we[2]/Re,R.displaySize[1]-we[3]/Re]}let U=c.left*P,$=c.right*P,q,J,oe,se;h==="width"||h==="both"?(se=w[0]+U-_[3],J=w[0]+$+_[1]):(se=w[0]+(U+$-R.displaySize[0])/2,J=se+R.displaySize[0]);let le=c.top*P,ye=c.bottom*P;return h==="height"||h==="both"?(q=w[1]+le-_[0],oe=w[1]+ye+_[2]):(q=w[1]+(le+ye-R.displaySize[1])/2,oe=q+R.displaySize[1]),{image:R,top:q,right:J,bottom:oe,left:se,collisionPadding:L}}let Mm=128,XA=32640;function pne(d,c){let{expression:h}=c;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Cn(d+1))};if(h.kind==="source")return{kind:"source"};{let{zoomStops:_,interpolationType:w}=h,P=0;for(;P<_.length&&_[P]<=d;)P++;P=Math.max(0,P-1);let R=P;for(;R<_.length&&_[R]<d+1;)R++;R=Math.min(_.length-1,R);let L=_[P],U=_[R];return h.kind==="composite"?{kind:"composite",minZoom:L,maxZoom:U,interpolationType:w}:{kind:"camera",minZoom:L,maxZoom:U,minSize:h.evaluate(new Cn(L)),maxSize:h.evaluate(new Cn(U)),interpolationType:w}}}function IV(d,c,h){let _="never",w=d.get(c);return w?_=w:d.get(h)&&(_="always"),_}let vke=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function NR(d,c,h,_,w,P,R,L,U,$,q,J,oe){let se=L?Math.min(XA,Math.round(L[0])):0,le=L?Math.min(XA,Math.round(L[1])):0;d.emplaceBack(c,h,Math.round(32*_),Math.round(32*w),P,R,(se<<1)+(U?1:0),le,16*$,16*q,256*J,256*oe)}function kV(d,c,h){d.emplaceBack(c.x,c.y,h),d.emplaceBack(c.x,c.y,h),d.emplaceBack(c.x,c.y,h),d.emplaceBack(c.x,c.y,h)}function bke(d){for(let c of d.sections)if(V4(c.text))return!0;return!1}class RV{constructor(c){this.layoutVertexArray=new gt,this.indexArray=new Ar,this.programConfigurations=c,this.segments=new St,this.dynamicLayoutVertexArray=new Gt,this.opacityVertexArray=new Ht,this.hasVisibleVertices=!1,this.placedSymbolArray=new ie}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,h,_,w){this.isEmpty()||(_&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,YIe.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,XIe.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,vke,!0),this.opacityVertexBuffer.itemSize=1),(_||w)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ar("SymbolBuffers",RV);class OV{constructor(c,h,_){this.layoutVertexArray=new c,this.layoutAttributes=h,this.indexArray=new _,this.segments=new St,this.collisionVertexArray=new pr}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,ZIe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ar("CollisionBuffers",OV);class dw{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=cs(globalThis)?Math.min(c.overscaling,128):c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map((R=>R.id)),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pne(this.zoom,h["text-size"]),this.iconSizeData=pne(this.zoom,h["icon-size"]);let _=this.layers[0].layout,w=_.get("symbol-sort-key"),P=_.get("symbol-z-order");this.canOverlap=IV(_,"text-overlap","text-allow-overlap")!=="never"||IV(_,"icon-overlap","icon-allow-overlap")!=="never"||_.get("text-ignore-placement")||_.get("icon-ignore-placement"),this.sortFeaturesByKey=P!=="viewport-y"&&!w.isConstant(),this.sortFeaturesByY=(P==="viewport-y"||P==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,_.get("symbol-placement")==="point"&&(this.writingModes=_.get("text-writing-mode").map((R=>n.ao[R]))),this.stateDependentLayerIds=this.layers.filter((R=>R.isStateDependent())).map((R=>R.id)),this.sourceID=c.sourceID}createArrays(){this.text=new RV(new Xe(this.layers,this.zoom,(c=>/^text/.test(c)))),this.icon=new RV(new Xe(this.layers,this.zoom,(c=>/^icon/.test(c)))),this.glyphOffsetArray=new Ae,this.lineVertexArray=new Te,this.symbolInstances=new ae,this.textAnchorOffsets=new Ce}calculateGlyphDependencies(c,h,_,w,P){for(let R=0;R<c.length;R++)if(h[c.charCodeAt(R)]=!0,(_||w)&&P){let L=eM[c.charAt(R)];L&&(h[L.charCodeAt(0)]=!0)}}populate(c,h,_){let w=this.layers[0],P=w.layout,R=P.get("text-font"),L=P.get("text-field"),U=P.get("icon-image"),$=(L.value.kind!=="constant"||L.value.value instanceof Gs&&!L.value.value.isEmpty()||L.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),q=U.value.kind!=="constant"||!!U.value.value||Object.keys(U.parameters).length>0,J=P.get("symbol-sort-key");if(this.features=[],!$&&!q)return;let oe=h.iconDependencies,se=h.glyphDependencies,le=h.availableImages,ye=new Cn(this.zoom);for(let{feature:we,id:Re,index:st,sourceLayerIndex:Ue}of c){let Ge=w._featureFilter.needGeometry,_t=Ai(we,Ge);if(!w._featureFilter.filter(ye,_t,_))continue;let Mt,Ut;if(Ge||(_t.geometry=Nr(we)),$){let Zt=w.getValueAndResolveTokens("text-field",_t,_,le),er=Gs.factory(Zt),Er=this.hasRTLText=this.hasRTLText||bke(er);(!Er||lu.getRTLTextPluginStatus()==="unavailable"||Er&&lu.isParsed())&&(Mt=QIe(er,w,_t))}if(q){let Zt=w.getValueAndResolveTokens("icon-image",_t,_,le);Ut=Zt instanceof qs?Zt:qs.fromString(Zt)}if(!Mt&&!Ut)continue;let ir=this.sortFeaturesByKey?J.evaluate(_t,{},_):void 0;if(this.features.push({id:Re,text:Mt,icon:Ut,index:st,sourceLayerIndex:Ue,geometry:_t.geometry,properties:we.properties,type:cw.types[we.type],sortKey:ir}),Ut&&(oe[Ut.name]=!0),Mt){let Zt=R.evaluate(_t,{},_).join(","),er=P.get("text-rotation-alignment")!=="viewport"&&P.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(n.ao.vertical)>=0;for(let Er of Mt.sections)if(Er.image)oe[Er.image.name]=!0;else{let Jt=zp(Mt.toString()),tr=Er.fontStack||Zt,Rt=se[tr]=se[tr]||{};this.calculateGlyphDependencies(Er.text,Rt,er,this.allowVerticalPlacement,Jt)}}}P.get("symbol-placement")==="line"&&(this.features=(function(we){let Re={},st={},Ue=[],Ge=0;function _t(Zt){Ue.push(we[Zt]),Ge++}function Mt(Zt,er,Er){let Jt=st[Zt];return delete st[Zt],st[er]=Jt,Ue[Jt].geometry[0].pop(),Ue[Jt].geometry[0]=Ue[Jt].geometry[0].concat(Er[0]),Jt}function Ut(Zt,er,Er){let Jt=Re[er];return delete Re[er],Re[Zt]=Jt,Ue[Jt].geometry[0].shift(),Ue[Jt].geometry[0]=Er[0].concat(Ue[Jt].geometry[0]),Jt}function ir(Zt,er,Er){let Jt=Er?er[0][er[0].length-1]:er[0][0];return`${Zt}:${Jt.x}:${Jt.y}`}for(let Zt=0;Zt<we.length;Zt++){let er=we[Zt],Er=er.geometry,Jt=er.text?er.text.toString():null;if(!Jt){_t(Zt);continue}let tr=ir(Jt,Er),Rt=ir(Jt,Er,!0);if(tr in st&&Rt in Re&&st[tr]!==Re[Rt]){let Vr=Ut(tr,Rt,Er),Jr=Mt(tr,Rt,Ue[Vr].geometry);delete Re[tr],delete st[Rt],st[ir(Jt,Ue[Jr].geometry,!0)]=Jr,Ue[Vr].geometry=null}else tr in st?Mt(tr,Rt,Er):Rt in Re?Ut(tr,Rt,Er):(_t(Zt),Re[tr]=Ge-1,st[Rt]=Ge-1)}return Ue.filter((Zt=>Zt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((we,Re)=>we.sortKey-Re.sortKey))}update(c,h,_){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,h,this.layers,{imagePositions:_}),this.icon.programConfigurations.updatePaintArrays(c,h,this.layers,{imagePositions:_}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,h){let _=this.lineVertexArray.length;if(c.segment!==void 0){let w=c.dist(h[c.segment+1]),P=c.dist(h[c.segment]),R={};for(let L=c.segment+1;L<h.length;L++)R[L]={x:h[L].x,y:h[L].y,tileUnitDistanceFromAnchor:w},L<h.length-1&&(w+=h[L+1].dist(h[L]));for(let L=c.segment||0;L>=0;L--)R[L]={x:h[L].x,y:h[L].y,tileUnitDistanceFromAnchor:P},L>0&&(P+=h[L-1].dist(h[L]));for(let L=0;L<h.length;L++){let U=R[L];this.lineVertexArray.emplaceBack(U.x,U.y,U.tileUnitDistanceFromAnchor)}}return{lineStartIndex:_,lineLength:this.lineVertexArray.length-_}}addSymbols(c,h,_,w,P,R,L,U,$,q,J,oe){let se=c.indexArray,le=c.layoutVertexArray,ye=c.segments.prepareSegment(4*h.length,le,se,this.canOverlap?R.sortKey:void 0),we=this.glyphOffsetArray.length,Re=ye.vertexLength,st=this.allowVerticalPlacement&&L===n.ao.vertical?Math.PI/2:0,Ue=R.text&&R.text.sections;for(let Ge=0;Ge<h.length;Ge++){let{tl:_t,tr:Mt,bl:Ut,br:ir,tex:Zt,pixelOffsetTL:er,pixelOffsetBR:Er,minFontScaleX:Jt,minFontScaleY:tr,glyphOffset:Rt,isSDF:Vr,sectionIndex:Jr}=h[Ge],Rr=ye.vertexLength,br=Rt[1];NR(le,U.x,U.y,_t.x,br+_t.y,Zt.x,Zt.y,_,Vr,er.x,er.y,Jt,tr),NR(le,U.x,U.y,Mt.x,br+Mt.y,Zt.x+Zt.w,Zt.y,_,Vr,Er.x,er.y,Jt,tr),NR(le,U.x,U.y,Ut.x,br+Ut.y,Zt.x,Zt.y+Zt.h,_,Vr,er.x,Er.y,Jt,tr),NR(le,U.x,U.y,ir.x,br+ir.y,Zt.x+Zt.w,Zt.y+Zt.h,_,Vr,Er.x,Er.y,Jt,tr),kV(c.dynamicLayoutVertexArray,U,st),se.emplaceBack(Rr,Rr+2,Rr+1),se.emplaceBack(Rr+1,Rr+2,Rr+3),ye.vertexLength+=4,ye.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),Ge!==h.length-1&&Jr===h[Ge+1].sectionIndex||c.programConfigurations.populatePaintArrays(le.length,R,R.index,{imagePositions:{},canonical:oe,formattedSection:Ue&&Ue[Jr]})}c.placedSymbolArray.emplaceBack(U.x,U.y,we,this.glyphOffsetArray.length-we,Re,$,q,U.segment,_?_[0]:0,_?_[1]:0,w[0],w[1],L,0,!1,0,J)}_addCollisionDebugVertex(c,h,_,w,P,R){return h.emplaceBack(0,0),c.emplaceBack(_.x,_.y,w,P,Math.round(R.x),Math.round(R.y))}addCollisionDebugVertices(c,h,_,w,P,R,L){let U=P.segments.prepareSegment(4,P.layoutVertexArray,P.indexArray),$=U.vertexLength,q=P.layoutVertexArray,J=P.collisionVertexArray,oe=L.anchorX,se=L.anchorY;this._addCollisionDebugVertex(q,J,R,oe,se,new s(c,h)),this._addCollisionDebugVertex(q,J,R,oe,se,new s(_,h)),this._addCollisionDebugVertex(q,J,R,oe,se,new s(_,w)),this._addCollisionDebugVertex(q,J,R,oe,se,new s(c,w)),U.vertexLength+=4;let le=P.indexArray;le.emplaceBack($,$+1),le.emplaceBack($+1,$+2),le.emplaceBack($+2,$+3),le.emplaceBack($+3,$),U.primitiveLength+=4}addDebugCollisionBoxes(c,h,_,w){for(let P=c;P<h;P++){let R=this.collisionBoxArray.get(P);this.addCollisionDebugVertices(R.x1,R.y1,R.x2,R.y2,w?this.textCollisionBox:this.iconCollisionBox,R.anchorPoint,_)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new OV(kt,tne.members,Wi),this.iconCollisionBox=new OV(kt,tne.members,Wi);for(let c=0;c<this.symbolInstances.length;c++){let h=this.symbolInstances.get(c);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(c,h,_,w,P,R,L,U,$){let q={};for(let J=h;J<_;J++){let oe=c.get(J);q.textBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},q.textFeatureIndex=oe.featureIndex;break}for(let J=w;J<P;J++){let oe=c.get(J);q.verticalTextBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},q.verticalTextFeatureIndex=oe.featureIndex;break}for(let J=R;J<L;J++){let oe=c.get(J);q.iconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},q.iconFeatureIndex=oe.featureIndex;break}for(let J=U;J<$;J++){let oe=c.get(J);q.verticalIconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},q.verticalIconFeatureIndex=oe.featureIndex;break}return q}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){let _=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,_.textBoxStartIndex,_.textBoxEndIndex,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_.iconBoxStartIndex,_.iconBoxEndIndex,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,h){let _=c.placedSymbolArray.get(h),w=_.vertexStartIndex+4*_.numGlyphs;for(let P=_.vertexStartIndex;P<w;P+=4)c.indexArray.emplaceBack(P,P+2,P+1),c.indexArray.emplaceBack(P+1,P+2,P+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let h=Math.sin(c),_=Math.cos(c),w=[],P=[],R=[];for(let L=0;L<this.symbolInstances.length;++L){R.push(L);let U=this.symbolInstances.get(L);w.push(0|Math.round(h*U.anchorX+_*U.anchorY)),P.push(U.featureIndex)}return R.sort(((L,U)=>w[L]-w[U]||P[U]-P[L])),R}addToSortKeyRanges(c,h){let _=this.sortKeyRanges[this.sortKeyRanges.length-1];_&&_.sortKey===h?_.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let h of this.symbolInstanceIndexes){let _=this.symbolInstances.get(h);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach(((w,P,R)=>{w>=0&&R.indexOf(w)===P&&this.addIndicesForPlacedSymbol(this.text,w)})),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let mne,gne;ar("SymbolBucket",dw,{omit:["layers","collisionBoxArray","features","compareText"]}),dw.MAX_GLYPHS=65535,dw.addDynamicAttributes=kV;var DV={get paint(){return gne=gne||new da({"icon-opacity":new Lr(lt.paint_symbol["icon-opacity"]),"icon-color":new Lr(lt.paint_symbol["icon-color"]),"icon-halo-color":new Lr(lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Lr(lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Lr(lt.paint_symbol["icon-halo-blur"]),"icon-translate":new _r(lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new _r(lt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Lr(lt.paint_symbol["text-opacity"]),"text-color":new Lr(lt.paint_symbol["text-color"],{runtimeType:ql,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Lr(lt.paint_symbol["text-halo-color"]),"text-halo-width":new Lr(lt.paint_symbol["text-halo-width"]),"text-halo-blur":new Lr(lt.paint_symbol["text-halo-blur"]),"text-translate":new _r(lt.paint_symbol["text-translate"]),"text-translate-anchor":new _r(lt.paint_symbol["text-translate-anchor"])})},get layout(){return mne=mne||new da({"symbol-placement":new _r(lt.layout_symbol["symbol-placement"]),"symbol-spacing":new _r(lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new _r(lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Lr(lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new _r(lt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new _r(lt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new _r(lt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new _r(lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new _r(lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new _r(lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Lr(lt.layout_symbol["icon-size"]),"icon-text-fit":new _r(lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _r(lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Lr(lt.layout_symbol["icon-image"]),"icon-rotate":new Lr(lt.layout_symbol["icon-rotate"]),"icon-padding":new Lr(lt.layout_symbol["icon-padding"]),"icon-keep-upright":new _r(lt.layout_symbol["icon-keep-upright"]),"icon-offset":new Lr(lt.layout_symbol["icon-offset"]),"icon-anchor":new Lr(lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new _r(lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new _r(lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new _r(lt.layout_symbol["text-rotation-alignment"]),"text-field":new Lr(lt.layout_symbol["text-field"]),"text-font":new Lr(lt.layout_symbol["text-font"]),"text-size":new Lr(lt.layout_symbol["text-size"]),"text-max-width":new Lr(lt.layout_symbol["text-max-width"]),"text-line-height":new _r(lt.layout_symbol["text-line-height"]),"text-letter-spacing":new Lr(lt.layout_symbol["text-letter-spacing"]),"text-justify":new Lr(lt.layout_symbol["text-justify"]),"text-radial-offset":new Lr(lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new _r(lt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Lr(lt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Lr(lt.layout_symbol["text-anchor"]),"text-max-angle":new _r(lt.layout_symbol["text-max-angle"]),"text-writing-mode":new _r(lt.layout_symbol["text-writing-mode"]),"text-rotate":new Lr(lt.layout_symbol["text-rotate"]),"text-padding":new _r(lt.layout_symbol["text-padding"]),"text-keep-upright":new _r(lt.layout_symbol["text-keep-upright"]),"text-transform":new Lr(lt.layout_symbol["text-transform"]),"text-offset":new Lr(lt.layout_symbol["text-offset"]),"text-allow-overlap":new _r(lt.layout_symbol["text-allow-overlap"]),"text-overlap":new _r(lt.layout_symbol["text-overlap"]),"text-ignore-placement":new _r(lt.layout_symbol["text-ignore-placement"]),"text-optional":new _r(lt.layout_symbol["text-optional"])})}};class Ane{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:Ra,this.defaultValue=c}evaluate(c){if(c.formattedSection){let h=this.defaultValue.property.overrides;if(h&&h.hasOverride(c.formattedSection))return h.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ar("FormatSectionOverride",Ane,{omit:["defaultValue"]});class zR extends Jl{constructor(c,h){super(c,DV,h)}recalculate(c,h){if(super.recalculate(c,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let _=this.layout.get("text-writing-mode");if(_){let w=[];for(let P of _)w.indexOf(P)<0&&w.push(P);this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,h,_,w){let P=this.layout.get(c).evaluate(h,{},_,w),R=this._unevaluatedLayout._values[c];return R.isDataDriven()||SA(R.value)||!P?P:(function(L,U){return U.replace(/{([^{}]+)}/g,(($,q)=>L&&q in L?String(L[q]):""))})(h.properties,P)}createBucket(c){return new dw(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let c of DV.paint.overridableProperties){if(!zR.hasPaintOverride(this.layout,c))continue;let h=this.paint.get(c),_=new Ane(h),w=new mf(_,h.property.specification),P=null;P=h.value.kind==="constant"||h.value.kind==="source"?new MA("source",w):new EA("composite",w,h.value.zoomStops),this.paint._values[c]=new cu(h.property,P,h.parameters)}}_handleOverridablePaintPropertyUpdate(c,h,_){return!(!this.layout||h.isDataDriven()||_.isDataDriven())&&zR.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,h){let _=c.get("text-field"),w=DV.paint.properties[h],P=!1,R=L=>{for(let U of L)if(w.overrides&&w.overrides.hasOverride(U))return void(P=!0)};if(_.value.kind==="constant"&&_.value.value instanceof Gs)R(_.value.value.sections);else if(_.value.kind==="source"||_.value.kind==="composite"){let L=$=>{P||($ instanceof qu&&uo($.value)===yp?R($.value.sections):$ instanceof A?R($.sections):$.eachChild(L))},U=_.value;U._styleExpression&&L(U._styleExpression.expression)}return P}}let yne;var xke={get paint(){return yne=yne||new da({"background-color":new _r(lt.paint_background["background-color"]),"background-pattern":new $A(lt.paint_background["background-pattern"]),"background-opacity":new _r(lt.paint_background["background-opacity"])})}};class wke extends Jl{constructor(c,h){super(c,xke,h)}}class Ske extends Jl{constructor(c,h){super(c,{},h),this.onAdd=_=>{this.implementation.onAdd&&this.implementation.onAdd(_,_.painter.context.gl)},this.onRemove=_=>{this.implementation.onRemove&&this.implementation.onRemove(_,_.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Tke{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let Mke={once:!0},LV=63710088e-1;class ZA{constructor(c,h){if(isNaN(c)||isNaN(h))throw new Error(`Invalid LngLat object: (${c}, ${h})`);if(this.lng=+c,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ZA(oi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){let h=Math.PI/180,_=this.lat*h,w=c.lat*h,P=Math.sin(_)*Math.sin(w)+Math.cos(_)*Math.cos(w)*Math.cos((c.lng-this.lng)*h);return LV*Math.acos(Math.min(P,1))}static convert(c){if(c instanceof ZA)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new ZA(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new ZA(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let _ne=2*Math.PI*LV;function vne(d){return _ne*Math.cos(d*Math.PI/180)}function bne(d){return(180+d)/360}function xne(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function wne(d,c){return d/vne(c)}function BV(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function Sne(d,c){return d*vne(BV(c))}class rM{constructor(c,h,_=0){this.x=+c,this.y=+h,this.z=+_}static fromLngLat(c,h=0){let _=ZA.convert(c);return new rM(bne(_.lng),xne(_.lat),wne(h,_.lat))}toLngLat(){return new ZA(360*this.x-180,BV(this.y))}toAltitude(){return Sne(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/_ne*(c=BV(this.y),1/Math.cos(c*Math.PI/180));var c}}function Tne(d,c,h){var _=2*Math.PI*6378137/256/Math.pow(2,h);return[d*_-2*Math.PI*6378137/2,c*_-2*Math.PI*6378137/2]}class FV{constructor(c,h,_){if(!(function(w,P,R){return!(w<0||w>25||R<0||R>=Math.pow(2,w)||P<0||P>=Math.pow(2,w))})(c,h,_))throw new Error(`x=${h}, y=${_}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=h,this.y=_,this.key=fw(0,c,c,h,_)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,h,_){let w=(R=this.y,L=this.z,U=Tne(256*(P=this.x),256*(R=Math.pow(2,L)-R-1),L),$=Tne(256*(P+1),256*(R+1),L),U[0]+","+U[1]+","+$[0]+","+$[1]);var P,R,L,U,$;let q=(function(J,oe,se){let le,ye="";for(let we=J;we>0;we--)le=1<<we-1,ye+=(oe&le?1:0)+(se&le?2:0);return ye})(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(_==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,q).replace(/{bbox-epsg-3857}/g,w)}isChildOf(c){let h=this.z-c.z;return h>0&&c.x===this.x>>h&&c.y===this.y>>h}getTilePoint(c){let h=Math.pow(2,this.z);return new s((c.x*h-this.x)*It,(c.y*h-this.y)*It)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Mne{constructor(c,h){this.wrap=c,this.canonical=h,this.key=fw(c,h.z,h.z,h.x,h.y)}}class rh{constructor(c,h,_,w,P){if(this.terrainRttPosMatrix32f=null,c<_)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${_}`);this.overscaledZ=c,this.wrap=h,this.canonical=new FV(_,+w,+P),this.key=fw(h,c,_,w,P)}clone(){return new rh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);let h=this.canonical.z-c;return c>this.canonical.z?new rh(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new rh(c,this.wrap,c,this.canonical.x>>h,this.canonical.y>>h)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(c,h){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);let _=this.canonical.z-c;return c>this.canonical.z?fw(this.wrap*+h,c,this.canonical.z,this.canonical.x,this.canonical.y):fw(this.wrap*+h,c,c,this.canonical.x>>_,this.canonical.y>>_)}isChildOf(c){if(c.wrap!==this.wrap||this.overscaledZ-c.overscaledZ<=0)return!1;if(c.overscaledZ===0)return this.overscaledZ>0;let h=this.canonical.z-c.canonical.z;return!(h<0)&&c.canonical.x===this.canonical.x>>h&&c.canonical.y===this.canonical.y>>h}children(c){if(this.overscaledZ>=c)return[new rh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let h=this.canonical.z+1,_=2*this.canonical.x,w=2*this.canonical.y;return[new rh(h,this.wrap,h,_,w),new rh(h,this.wrap,h,_+1,w),new rh(h,this.wrap,h,_,w+1),new rh(h,this.wrap,h,_+1,w+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new rh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new rh(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Mne(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new rM(c.x-this.wrap,c.y))}}function fw(d,c,h,_,w){(d*=2)<0&&(d=-1*d-1);let P=1<<h;return(P*P*d+P*w+_).toString(36)+h.toString(36)+c.toString(36)}function iM(d,c){return c?d.properties[c]:d.id}ar("CanonicalTileID",FV),ar("OverscaledTileID",rh,{omit:["terrainRttPosMatrix32f"]});class Nv{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(c){return this.minX=Math.min(this.minX,c.x),this.minY=Math.min(this.minY,c.y),this.maxX=Math.max(this.maxX,c.x),this.maxY=Math.max(this.maxY,c.y),this}expandBy(c){return this.minX-=c,this.minY-=c,this.maxX+=c,this.maxY+=c,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(c){return this.expandBy(-c)}map(c){let h=new Nv;return h.extend(c(new s(this.minX,this.minY))),h.extend(c(new s(this.maxX,this.minY))),h.extend(c(new s(this.minX,this.maxY))),h.extend(c(new s(this.maxX,this.maxY))),h}static fromPoints(c){let h=new Nv;for(let _ of c)h.extend(_);return h}contains(c){return c.x>=this.minX&&c.x<=this.maxX&&c.y>=this.minY&&c.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(c){return!this.empty()&&!c.empty()&&c.minX>=this.minX&&c.maxX<=this.maxX&&c.minY>=this.minY&&c.maxY<=this.maxY}intersects(c){return!this.empty()&&!c.empty()&&c.minX<=this.maxX&&c.maxX>=this.minX&&c.minY<=this.maxY&&c.maxY>=this.minY}}class Ene{constructor(c){this._stringToNumber={},this._numberToString=[];for(let h=0;h<c.length;h++){let _=c[h];this._stringToNumber[_]=h,this._numberToString[h]=_}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class Cne{constructor(c,h,_,w,P){this.type="Feature",this._vectorTileFeature=c,c._z=h,c._x=_,c._y=w,this.properties=c.properties,this.id=P}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){let c={geometry:this.geometry};for(let h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(c[h]=this[h]);return c}}class Pne{constructor(c,h){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Tc(It,16,0),this.grid3D=new Tc(It,16,0),this.featureIndexArray=new Ve,this.promoteId=h}insert(c,h,_,w,P,R){let L=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(_,w,P);let U=R?this.grid3D:this.grid;for(let $=0;$<h.length;$++){let q=h[$],J=[1/0,1/0,-1/0,-1/0];for(let oe=0;oe<q.length;oe++){let se=q[oe];J[0]=Math.min(J[0],se.x),J[1]=Math.min(J[1],se.y),J[2]=Math.max(J[2],se.x),J[3]=Math.max(J[3],se.y)}J[0]<It&&J[1]<It&&J[2]>=0&&J[3]>=0&&U.insert(L,J[0],J[1],J[2],J[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Hie(new MV(this.rawTileData)).layers,this.sourceLayerCoder=new Ene(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,h,_,w){this.loadVTLayers();let P=c.params,R=It/c.tileSize/c.scale,L=gf(P.filter,P.globalState),U=c.queryGeometry,$=c.queryPadding*R,q=Nv.fromPoints(U),J=this.grid.query(q.minX-$,q.minY-$,q.maxX+$,q.maxY+$),oe=Nv.fromPoints(c.cameraQueryGeometry).expandBy($),se=this.grid3D.query(oe.minX,oe.minY,oe.maxX,oe.maxY,((we,Re,st,Ue)=>(function(Ge,_t,Mt,Ut,ir){for(let er of Ge)if(_t<=er.x&&Mt<=er.y&&Ut>=er.x&&ir>=er.y)return!0;let Zt=[new s(_t,Mt),new s(_t,ir),new s(Ut,ir),new s(Ut,Mt)];if(Ge.length>2){for(let er of Zt)if(nw(Ge,er))return!0}for(let er=0;er<Ge.length-1;er++)if(rIe(Ge[er],Ge[er+1],Zt))return!0;return!1})(c.cameraQueryGeometry,we-$,Re-$,st+$,Ue+$)));for(let we of se)J.push(we);J.sort(Eke);let le={},ye;for(let we=0;we<J.length;we++){let Re=J[we];if(Re===ye)continue;ye=Re;let st=this.featureIndexArray.get(Re),Ue=null;this.loadMatchingFeature(le,st.bucketIndex,st.sourceLayerIndex,st.featureIndex,L,P.layers,P.availableImages,h,_,w,((Ge,_t,Mt)=>(Ue||(Ue=Nr(Ge)),_t.queryIntersectsFeature({queryGeometry:U,feature:Ge,featureState:Mt,geometry:Ue,zoom:this.z,transform:c.transform,pixelsToTileUnits:R,pixelPosMatrix:c.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:c.getElevation}))))}return le}loadMatchingFeature(c,h,_,w,P,R,L,U,$,q,J){let oe=this.bucketLayerIDs[h];if(R&&!oe.some((we=>R.has(we))))return;let se=this.sourceLayerCoder.decode(_),le=this.vtLayers[se].feature(w);if(P.needGeometry){let we=Ai(le,!0);if(!P.filter(new Cn(this.tileID.overscaledZ),we,this.tileID.canonical))return}else if(!P.filter(new Cn(this.tileID.overscaledZ),le))return;let ye=this.getId(le,se);for(let we=0;we<oe.length;we++){let Re=oe[we];if(R&&!R.has(Re))continue;let st=U[Re];if(!st)continue;let Ue={};ye&&q&&(Ue=q.getState(st.sourceLayer||"_geojsonTileLayer",ye));let Ge=jr({},$[Re]);Ge.paint=Ine(Ge.paint,st.paint,le,Ue,L),Ge.layout=Ine(Ge.layout,st.layout,le,Ue,L);let _t=!J||J(le,st,Ue);if(!_t)continue;let Mt=new Cne(le,this.z,this.x,this.y,ye);Mt.layer=Ge;let Ut=c[Re];Ut===void 0&&(Ut=c[Re]=[]),Ut.push({featureIndex:w,feature:Mt,intersectionZ:_t})}}lookupSymbolFeatures(c,h,_,w,P,R,L,U){let $={};this.loadVTLayers();let q=gf(P.filterSpec,P.globalState);for(let J of c)this.loadMatchingFeature($,_,w,J,q,R,L,U,h);return $}hasLayer(c){for(let h of this.bucketLayerIDs)for(let _ of h)if(c===_)return!0;return!1}getId(c,h){var _;let w=c.id;return this.promoteId&&(w=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof w=="boolean"&&(w=Number(w)),w===void 0&&(!((_=c.properties)===null||_===void 0)&&_.cluster)&&this.promoteId&&(w=Number(c.properties.cluster_id))),w}}function Ine(d,c,h,_,w){return on(d,((P,R)=>{let L=c instanceof jp?c.get(R):null;return L&&L.evaluate?L.evaluate(h,_,w):L}))}function Eke(d,c){return c-d}function kne(d,c,h,_,w){let P=[];for(let R=0;R<d.length;R++){let L=d[R],U;for(let $=0;$<L.length-1;$++){let q=L[$],J=L[$+1];q.x<c&&J.x<c||(q.x<c?q=new s(c,q.y+(c-q.x)/(J.x-q.x)*(J.y-q.y))._round():J.x<c&&(J=new s(c,q.y+(c-q.x)/(J.x-q.x)*(J.y-q.y))._round()),q.y<h&&J.y<h||(q.y<h?q=new s(q.x+(h-q.y)/(J.y-q.y)*(J.x-q.x),h)._round():J.y<h&&(J=new s(q.x+(h-q.y)/(J.y-q.y)*(J.x-q.x),h)._round()),q.x>=_&&J.x>=_||(q.x>=_?q=new s(_,q.y+(_-q.x)/(J.x-q.x)*(J.y-q.y))._round():J.x>=_&&(J=new s(_,q.y+(_-q.x)/(J.x-q.x)*(J.y-q.y))._round()),q.y>=w&&J.y>=w||(q.y>=w?q=new s(q.x+(w-q.y)/(J.y-q.y)*(J.x-q.x),w)._round():J.y>=w&&(J=new s(q.x+(w-q.y)/(J.y-q.y)*(J.x-q.x),w)._round()),U&&q.equals(U[U.length-1])||(U=[q],P.push(U)),U.push(J)))))}}return P}ar("FeatureIndex",Pne,{omit:["rawTileData","sourceLayerCoder"]});class KA extends s{constructor(c,h,_,w){super(c,h),this.angle=_,w!==void 0&&(this.segment=w)}clone(){return new KA(this.x,this.y,this.angle,this.segment)}}function Rne(d,c,h,_,w){if(c.segment===void 0||h===0)return!0;let P=c,R=c.segment+1,L=0;for(;L>-h/2;){if(R--,R<0)return!1;L-=d[R].dist(P),P=d[R]}L+=d[R].dist(d[R+1]),R++;let U=[],$=0;for(;L<h/2;){let q=d[R],J=d[R+1];if(!J)return!1;let oe=d[R-1].angleTo(q)-q.angleTo(J);for(oe=Math.abs((oe+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:L,angleDelta:oe}),$+=oe;L-U[0].distance>_;)$-=U.shift().angleDelta;if($>w)return!1;R++,L+=q.dist(J)}return!0}function One(d){let c=0;for(let h=0;h<d.length-1;h++)c+=d[h].dist(d[h+1]);return c}function Dne(d,c,h){return d?.6*c*h:0}function Lne(d,c){return Math.max(d?d.right-d.left:0,c?c.right-c.left:0)}function Cke(d,c,h,_,w,P){let R=Dne(h,w,P),L=Lne(h,_)*P,U=0,$=One(d)/2;for(let q=0;q<d.length-1;q++){let J=d[q],oe=d[q+1],se=J.dist(oe);if(U+se>$){let le=($-U)/se,ye=Oo.number(J.x,oe.x,le),we=Oo.number(J.y,oe.y,le),Re=new KA(ye,we,oe.angleTo(J),q);return Re._round(),!R||Rne(d,Re,L,R,c)?Re:void 0}U+=se}}function Pke(d,c,h,_,w,P,R,L,U){let $=Dne(_,P,R),q=Lne(_,w),J=q*R,oe=d[0].x===0||d[0].x===U||d[0].y===0||d[0].y===U;return c-J<c/4&&(c=J+c/4),Bne(d,oe?c/2*L%c:(q/2+2*P)*R*L%c,c,$,h,J,oe,!1,U)}function Bne(d,c,h,_,w,P,R,L,U){let $=P/2,q=One(d),J=0,oe=c-h,se=[];for(let le=0;le<d.length-1;le++){let ye=d[le],we=d[le+1],Re=ye.dist(we),st=we.angleTo(ye);for(;oe+h<J+Re;){oe+=h;let Ue=(oe-J)/Re,Ge=Oo.number(ye.x,we.x,Ue),_t=Oo.number(ye.y,we.y,Ue);if(Ge>=0&&Ge<U&&_t>=0&&_t<U&&oe-$>=0&&oe+$<=q){let Mt=new KA(Ge,_t,st,le);Mt._round(),_&&!Rne(d,Mt,P,_,w)||se.push(Mt)}}J+=Re}return L||se.length||R||(se=Bne(d,J/2,h,_,w,P,R,!0,U)),se}function Fne(d,c,h,_){let w=[],P=d.image,R=P.pixelRatio,L=P.paddedRect.w-2,U=P.paddedRect.h-2,$={x1:d.left,y1:d.top,x2:d.right,y2:d.bottom},q=P.stretchX||[[0,L]],J=P.stretchY||[[0,U]],oe=(Rt,Vr)=>Rt+Vr[1]-Vr[0],se=q.reduce(oe,0),le=J.reduce(oe,0),ye=L-se,we=U-le,Re=0,st=se,Ue=0,Ge=le,_t=0,Mt=ye,Ut=0,ir=we;if(P.content&&_){let Rt=P.content,Vr=Rt[2]-Rt[0],Jr=Rt[3]-Rt[1];(P.textFitWidth||P.textFitHeight)&&($=dne(d)),Re=UR(q,0,Rt[0]),Ue=UR(J,0,Rt[1]),st=UR(q,Rt[0],Rt[2]),Ge=UR(J,Rt[1],Rt[3]),_t=Rt[0]-Re,Ut=Rt[1]-Ue,Mt=Vr-st,ir=Jr-Ge}let Zt=$.x1,er=$.y1,Er=$.x2-Zt,Jt=$.y2-er,tr=(Rt,Vr,Jr,Rr)=>{let br=VR(Rt.stretch-Re,st,Er,Zt),Xi=jR(Rt.fixed-_t,Mt,Rt.stretch,se),Wo=VR(Vr.stretch-Ue,Ge,Jt,er),Xs=jR(Vr.fixed-Ut,ir,Vr.stretch,le),il=VR(Jr.stretch-Re,st,Er,Zt),ih=jR(Jr.fixed-_t,Mt,Jr.stretch,se),Pc=VR(Rr.stretch-Ue,Ge,Jt,er),Na=jR(Rr.fixed-Ut,ir,Rr.stretch,le),Do=new s(br,Wo),pa=new s(il,Wo),za=new s(il,Pc),Ua=new s(br,Pc),ec=new s(Xi/R,Xs/R),nh=new s(ih/R,Na/R),ma=c*Math.PI/180;if(ma){let ga=Math.sin(ma),Aa=Math.cos(ma),Cs=[Aa,-ga,ga,Aa];Do._matMult(Cs),pa._matMult(Cs),Ua._matMult(Cs),za._matMult(Cs)}let Ic=Rt.stretch+Rt.fixed,Zs=Vr.stretch+Vr.fixed;return{tl:Do,tr:pa,bl:Ua,br:za,tex:{x:P.paddedRect.x+1+Ic,y:P.paddedRect.y+1+Zs,w:Jr.stretch+Jr.fixed-Ic,h:Rr.stretch+Rr.fixed-Zs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ec,pixelOffsetBR:nh,minFontScaleX:Mt/R/Er,minFontScaleY:ir/R/Jt,isSDF:h}};if(_&&(P.stretchX||P.stretchY)){let Rt=Nne(q,ye,se),Vr=Nne(J,we,le);for(let Jr=0;Jr<Rt.length-1;Jr++){let Rr=Rt[Jr],br=Rt[Jr+1];for(let Xi=0;Xi<Vr.length-1;Xi++)w.push(tr(Rr,Vr[Xi],br,Vr[Xi+1]))}}else w.push(tr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:L+1},{fixed:0,stretch:U+1}));return w}function UR(d,c,h){let _=0;for(let w of d)_+=Math.max(c,Math.min(h,w[1]))-Math.max(c,Math.min(h,w[0]));return _}function Nne(d,c,h){let _=[{fixed:-1,stretch:0}];for(let[w,P]of d){let R=_[_.length-1];_.push({fixed:w-R.stretch,stretch:R.stretch}),_.push({fixed:w-R.stretch,stretch:R.stretch+(P-w)})}return _.push({fixed:c+1,stretch:h}),_}function VR(d,c,h,_){return d/c*h+_}function jR(d,c,h,_){return d-c*h/_}ar("Anchor",KA);class $R{constructor(c,h,_,w,P,R,L,U,$,q){var J;if(this.boxStartIndex=c.length,$){let oe=R.top,se=R.bottom,le=R.collisionPadding;le&&(oe-=le[1],se+=le[3]);let ye=se-oe;ye>0&&(ye=Math.max(10,ye),this.circleDiameter=ye)}else{let oe=!((J=R.image)===null||J===void 0)&&J.content&&(R.image.textFitWidth||R.image.textFitHeight)?dne(R):{x1:R.left,y1:R.top,x2:R.right,y2:R.bottom};oe.y1=oe.y1*L-U[0],oe.y2=oe.y2*L+U[2],oe.x1=oe.x1*L-U[3],oe.x2=oe.x2*L+U[1];let se=R.collisionPadding;if(se&&(oe.x1-=se[0]*L,oe.y1-=se[1]*L,oe.x2+=se[2]*L,oe.y2+=se[3]*L),q){let le=new s(oe.x1,oe.y1),ye=new s(oe.x2,oe.y1),we=new s(oe.x1,oe.y2),Re=new s(oe.x2,oe.y2),st=q*Math.PI/180;le._rotate(st),ye._rotate(st),we._rotate(st),Re._rotate(st),oe.x1=Math.min(le.x,ye.x,we.x,Re.x),oe.x2=Math.max(le.x,ye.x,we.x,Re.x),oe.y1=Math.min(le.y,ye.y,we.y,Re.y),oe.y2=Math.max(le.y,ye.y,we.y,Re.y)}c.emplaceBack(h.x,h.y,oe.x1,oe.y1,oe.x2,oe.y2,_,w,P)}this.boxEndIndex=c.length}}class Ike{constructor(c=[],h=(_,w)=>_<w?-1:_>w?1:0){if(this.data=c,this.length=this.data.length,this.compare=h,this.length>0)for(let _=(this.length>>1)-1;_>=0;_--)this._down(_)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;let c=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),c}peek(){return this.data[0]}_up(c){let{data:h,compare:_}=this,w=h[c];for(;c>0;){let P=c-1>>1,R=h[P];if(_(w,R)>=0)break;h[c]=R,c=P}h[c]=w}_down(c){let{data:h,compare:_}=this,w=this.length>>1,P=h[c];for(;c<w;){let R=1+(c<<1),L=R+1;if(L<this.length&&_(h[L],h[R])<0&&(R=L),_(h[R],P)>=0)break;h[c]=h[R],c=R}h[c]=P}}function kke(d,c=1,h=!1){let _=Nv.fromPoints(d[0]),w=Math.min(_.width(),_.height()),P=w/2,R=new Ike([],Rke),{minX:L,minY:U,maxX:$,maxY:q}=_;if(w===0)return new s(L,U);for(let se=L;se<$;se+=w)for(let le=U;le<q;le+=w)R.push(new pw(se+P,le+P,P,d));let J=(function(se){let le=0,ye=0,we=0,Re=se[0];for(let st=0,Ue=Re.length,Ge=Ue-1;st<Ue;Ge=st++){let _t=Re[st],Mt=Re[Ge],Ut=_t.x*Mt.y-Mt.x*_t.y;ye+=(_t.x+Mt.x)*Ut,we+=(_t.y+Mt.y)*Ut,le+=3*Ut}return new pw(ye/le,we/le,0,se)})(d),oe=R.length;for(;R.length;){let se=R.pop();(se.d>J.d||!J.d)&&(J=se,h&&console.log("found best %d after %d probes",Math.round(1e4*se.d)/1e4,oe)),se.max-J.d<=c||(P=se.h/2,R.push(new pw(se.p.x-P,se.p.y-P,P,d)),R.push(new pw(se.p.x+P,se.p.y-P,P,d)),R.push(new pw(se.p.x-P,se.p.y+P,P,d)),R.push(new pw(se.p.x+P,se.p.y+P,P,d)),oe+=4)}return h&&(console.log(`num probes: ${oe}`),console.log(`best distance: ${J.d}`)),J.p}function Rke(d,c){return c.max-d.max}function pw(d,c,h,_){this.p=new s(d,c),this.h=h,this.d=(function(w,P){let R=!1,L=1/0;for(let U=0;U<P.length;U++){let $=P[U];for(let q=0,J=$.length,oe=J-1;q<J;oe=q++){let se=$[q],le=$[oe];se.y>w.y!=le.y>w.y&&w.x<(le.x-se.x)*(w.y-se.y)/(le.y-se.y)+se.x&&(R=!R),L=Math.min(L,wie(w,se,le))}}return(R?1:-1)*Math.sqrt(L)})(this.p,_),this.max=this.d+this.h*Math.SQRT2}var rl;n.aE=void 0,(rl=n.aE||(n.aE={}))[rl.center=1]="center",rl[rl.left=2]="left",rl[rl.right=3]="right",rl[rl.top=4]="top",rl[rl.bottom=5]="bottom",rl[rl["top-left"]=6]="top-left",rl[rl["top-right"]=7]="top-right",rl[rl["bottom-left"]=8]="bottom-left",rl[rl["bottom-right"]=9]="bottom-right";let NV=Number.POSITIVE_INFINITY;function zne(d,c){return c[1]!==NV?(function(h,_,w){let P=0,R=0;switch(_=Math.abs(_),w=Math.abs(w),h){case"top-right":case"top-left":case"top":R=w-7;break;case"bottom-right":case"bottom-left":case"bottom":R=7-w}switch(h){case"top-right":case"bottom-right":case"right":P=-_;break;case"top-left":case"bottom-left":case"left":P=_}return[P,R]})(d,c[0],c[1]):(function(h,_){let w=0,P=0;_<0&&(_=0);let R=_/Math.SQRT2;switch(h){case"top-right":case"top-left":P=R-7;break;case"bottom-right":case"bottom-left":P=7-R;break;case"bottom":P=7-_;break;case"top":P=_-7}switch(h){case"top-right":case"bottom-right":w=-R;break;case"top-left":case"bottom-left":w=R;break;case"left":w=_;break;case"right":w=-_}return[w,P]})(d,c[0])}function Une(d,c,h){var _;let w=d.layout,P=(_=w.get("text-variable-anchor-offset"))===null||_===void 0?void 0:_.evaluate(c,{},h);if(P){let L=P.values,U=[];for(let $=0;$<L.length;$+=2){let q=U[$]=L[$],J=L[$+1].map((oe=>oe*fa));q.startsWith("top")?J[1]-=7:q.startsWith("bottom")&&(J[1]+=7),U[$+1]=J}return new Hs(U)}let R=w.get("text-variable-anchor");if(R){let L;L=d._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[w.get("text-radial-offset").evaluate(c,{},h)*fa,NV]:w.get("text-offset").evaluate(c,{},h).map(($=>$*fa));let U=[];for(let $ of R)U.push($,zne($,L));return new Hs(U)}return null}function zV(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Oke(d,c,h,_,w,P,R,L,U,$,q,J){let oe=P.textMaxSize.evaluate(c,{});oe===void 0&&(oe=R);let se=d.layers[0].layout,le=se.get("icon-offset").evaluate(c,{},q),ye=jne(h.horizontal),we=R/24,Re=d.tilePixelRatio*we,st=d.tilePixelRatio*oe/24,Ue=d.tilePixelRatio*L,Ge=d.tilePixelRatio*se.get("symbol-spacing"),_t=se.get("text-padding")*d.tilePixelRatio,Mt=(function(Jr,Rr,br,Xi=1){let Wo=Jr.get("icon-padding").evaluate(Rr,{},br),Xs=Wo&&Wo.values;return[Xs[0]*Xi,Xs[1]*Xi,Xs[2]*Xi,Xs[3]*Xi]})(se,c,q,d.tilePixelRatio),Ut=se.get("text-max-angle")/180*Math.PI,ir=se.get("text-rotation-alignment")!=="viewport"&&se.get("symbol-placement")!=="point",Zt=se.get("icon-rotation-alignment")==="map"&&se.get("symbol-placement")!=="point",er=se.get("symbol-placement"),Er=Ge/2,Jt=se.get("icon-text-fit"),tr;_&&Jt!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(tr=fne(_,h.vertical,Jt,se.get("icon-text-fit-padding"),le,we)),ye&&(_=fne(_,ye,Jt,se.get("icon-text-fit-padding"),le,we)));let Rt=q?J.line.getGranularityForZoomLevel(q.z):1,Vr=(Jr,Rr)=>{Rr.x<0||Rr.x>=It||Rr.y<0||Rr.y>=It||(function(br,Xi,Wo,Xs,il,ih,Pc,Na,Do,pa,za,Ua,ec,nh,ma,Ic,Zs,ga,Aa,Cs,mo,wf,mw,Sf,Bke){let gw=br.addToLineVertexArray(Xi,Wo),zv,Aw,yw,_w,Hne=0,qne=0,Yne=0,Xne=0,qV=-1,YV=-1,Em={},Zne=y("");if(br.allowVerticalPlacement&&Xs.vertical){let Sl=Na.layout.get("text-rotate").evaluate(mo,{},Sf)+90;yw=new $R(Do,Xi,pa,za,Ua,Xs.vertical,ec,nh,ma,Sl),Pc&&(_w=new $R(Do,Xi,pa,za,Ua,Pc,Zs,ga,ma,Sl))}if(il){let Sl=Na.layout.get("icon-rotate").evaluate(mo,{}),oh=Na.layout.get("icon-text-fit")!=="none",Uv=Fne(il,Sl,mw,oh),Mf=Pc?Fne(Pc,Sl,mw,oh):void 0;Aw=new $R(Do,Xi,pa,za,Ua,il,Zs,ga,!1,Sl),Hne=4*Uv.length;let Vv=br.iconSizeData,Gp=null;Vv.kind==="source"?(Gp=[Mm*Na.layout.get("icon-size").evaluate(mo,{})],Gp[0]>XA&&xn(`${br.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Vv.kind==="composite"&&(Gp=[Mm*wf.compositeIconSizes[0].evaluate(mo,{},Sf),Mm*wf.compositeIconSizes[1].evaluate(mo,{},Sf)],(Gp[0]>XA||Gp[1]>XA)&&xn(`${br.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),br.addSymbols(br.icon,Uv,Gp,Cs,Aa,mo,n.ao.none,Xi,gw.lineStartIndex,gw.lineLength,-1,Sf),qV=br.icon.placedSymbolArray.length-1,Mf&&(qne=4*Mf.length,br.addSymbols(br.icon,Mf,Gp,Cs,Aa,mo,n.ao.vertical,Xi,gw.lineStartIndex,gw.lineLength,-1,Sf),YV=br.icon.placedSymbolArray.length-1)}let Kne=Object.keys(Xs.horizontal);for(let Sl of Kne){let oh=Xs.horizontal[Sl];if(!zv){Zne=y(oh.text);let Mf=Na.layout.get("text-rotate").evaluate(mo,{},Sf);zv=new $R(Do,Xi,pa,za,Ua,oh,ec,nh,ma,Mf)}let Uv=oh.positionedLines.length===1;if(Yne+=Vne(br,Xi,oh,ih,Na,ma,mo,Ic,gw,Xs.vertical?n.ao.horizontal:n.ao.horizontalOnly,Uv?Kne:[Sl],Em,qV,wf,Sf),Uv)break}Xs.vertical&&(Xne+=Vne(br,Xi,Xs.vertical,ih,Na,ma,mo,Ic,gw,n.ao.vertical,["vertical"],Em,YV,wf,Sf));let Fke=zv?zv.boxStartIndex:br.collisionBoxArray.length,Nke=zv?zv.boxEndIndex:br.collisionBoxArray.length,zke=yw?yw.boxStartIndex:br.collisionBoxArray.length,Uke=yw?yw.boxEndIndex:br.collisionBoxArray.length,Vke=Aw?Aw.boxStartIndex:br.collisionBoxArray.length,jke=Aw?Aw.boxEndIndex:br.collisionBoxArray.length,$ke=_w?_w.boxStartIndex:br.collisionBoxArray.length,Wke=_w?_w.boxEndIndex:br.collisionBoxArray.length,Tf=-1,GR=(Sl,oh)=>Sl&&Sl.circleDiameter?Math.max(Sl.circleDiameter,oh):oh;Tf=GR(zv,Tf),Tf=GR(yw,Tf),Tf=GR(Aw,Tf),Tf=GR(_w,Tf);let Qne=Tf>-1?1:0;Qne&&(Tf*=Bke/fa),br.glyphOffsetArray.length>=dw.MAX_GLYPHS&&xn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mo.sortKey!==void 0&&br.addToSortKeyRanges(br.symbolInstances.length,mo.sortKey);let Gke=Une(Na,mo,Sf),[Hke,qke]=(function(Sl,oh){let Uv=Sl.length,Mf=oh?.values;if(Mf?.length>0)for(let Vv=0;Vv<Mf.length;Vv+=2){let Gp=Mf[Vv+1];Sl.emplaceBack(n.aE[Mf[Vv]],Gp[0],Gp[1])}return[Uv,Sl.length]})(br.textAnchorOffsets,Gke);br.symbolInstances.emplaceBack(Xi.x,Xi.y,Em.right>=0?Em.right:-1,Em.center>=0?Em.center:-1,Em.left>=0?Em.left:-1,Em.vertical||-1,qV,YV,Zne,Fke,Nke,zke,Uke,Vke,jke,$ke,Wke,pa,Yne,Xne,Hne,qne,Qne,0,ec,Tf,Hke,qke)})(d,Rr,Jr,h,_,w,tr,d.layers[0],d.collisionBoxArray,c.index,c.sourceLayerIndex,d.index,Re,[_t,_t,_t,_t],ir,U,Ue,Mt,Zt,le,c,P,$,q,R)};if(er==="line")for(let Jr of kne(c.geometry,0,0,It,It)){let Rr=Fv(Jr,Rt),br=Pke(Rr,Ge,Ut,h.vertical||ye,_,24,st,d.overscaling,It);for(let Xi of br)ye&&Dke(d,ye.text,Er,Xi)||Vr(Rr,Xi)}else if(er==="line-center"){for(let Jr of c.geometry)if(Jr.length>1){let Rr=Fv(Jr,Rt),br=Cke(Rr,Ut,h.vertical||ye,_,24,st);br&&Vr(Rr,br)}}else if(c.type==="Polygon")for(let Jr of Mp(c.geometry,0)){let Rr=kke(Jr,16);Vr(Fv(Jr[0],Rt,!0),new KA(Rr.x,Rr.y,0))}else if(c.type==="LineString")for(let Jr of c.geometry){let Rr=Fv(Jr,Rt);Vr(Rr,new KA(Rr[0].x,Rr[0].y,0))}else if(c.type==="Point")for(let Jr of c.geometry)for(let Rr of Jr)Vr([Rr],new KA(Rr.x,Rr.y,0))}function Vne(d,c,h,_,w,P,R,L,U,$,q,J,oe,se,le){let ye=(function(st,Ue,Ge,_t,Mt,Ut,ir,Zt){let er=_t.layout.get("text-rotate").evaluate(Ut,{})*Math.PI/180,Er=[];for(let Jt of Ue.positionedLines)for(let tr of Jt.positionedGlyphs){if(!tr.rect)continue;let Rt=tr.rect||{},Vr=4,Jr=!0,Rr=1,br=0,Xi=(Mt||Zt)&&tr.vertical,Wo=tr.metrics.advance*tr.scale/2;if(Zt&&Ue.verticalizable&&(br=Jt.lineOffset/2-(tr.imageName?-(fa-tr.metrics.width*tr.scale)/2:(tr.scale-1)*fa)),tr.imageName){let ga=ir[tr.imageName];Jr=ga.sdf,Rr=ga.pixelRatio,Vr=1/Rr}let Xs=Mt?[tr.x+Wo,tr.y]:[0,0],il=Mt?[0,0]:[tr.x+Wo+Ge[0],tr.y+Ge[1]-br],ih=[0,0];Xi&&(ih=il,il=[0,0]);let Pc=tr.metrics.isDoubleResolution?2:1,Na=(tr.metrics.left-Vr)*tr.scale-Wo+il[0],Do=(-tr.metrics.top-Vr)*tr.scale+il[1],pa=Na+Rt.w/Pc*tr.scale/Rr,za=Do+Rt.h/Pc*tr.scale/Rr,Ua=new s(Na,Do),ec=new s(pa,Do),nh=new s(Na,za),ma=new s(pa,za);if(Xi){let ga=new s(-Wo,Wo- -17),Aa=-Math.PI/2,Cs=12-Wo,mo=new s(22-Cs,-(tr.imageName?Cs:0)),wf=new s(...ih);Ua._rotateAround(Aa,ga)._add(mo)._add(wf),ec._rotateAround(Aa,ga)._add(mo)._add(wf),nh._rotateAround(Aa,ga)._add(mo)._add(wf),ma._rotateAround(Aa,ga)._add(mo)._add(wf)}if(er){let ga=Math.sin(er),Aa=Math.cos(er),Cs=[Aa,-ga,ga,Aa];Ua._matMult(Cs),ec._matMult(Cs),nh._matMult(Cs),ma._matMult(Cs)}let Ic=new s(0,0),Zs=new s(0,0);Er.push({tl:Ua,tr:ec,bl:nh,br:ma,tex:Rt,writingMode:Ue.writingMode,glyphOffset:Xs,sectionIndex:tr.sectionIndex,isSDF:Jr,pixelOffsetTL:Ic,pixelOffsetBR:Zs,minFontScaleX:0,minFontScaleY:0})}return Er})(0,h,L,w,P,R,_,d.allowVerticalPlacement),we=d.textSizeData,Re=null;we.kind==="source"?(Re=[Mm*w.layout.get("text-size").evaluate(R,{})],Re[0]>XA&&xn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):we.kind==="composite"&&(Re=[Mm*se.compositeTextSizes[0].evaluate(R,{},le),Mm*se.compositeTextSizes[1].evaluate(R,{},le)],(Re[0]>XA||Re[1]>XA)&&xn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),d.addSymbols(d.text,ye,Re,L,P,R,$,c,U.lineStartIndex,U.lineLength,oe,le);for(let st of q)J[st]=d.text.placedSymbolArray.length-1;return 4*ye.length}function jne(d){for(let c in d)return d[c];return null}function Dke(d,c,h,_){let w=d.compareText;if(c in w){let P=w[c];for(let R=P.length-1;R>=0;R--)if(_.dist(P[R])<h)return!0}else w[c]=[];return w[c].push(_),!1}let $ne=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class UV{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[h,_]=new Uint8Array(c,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");let w=_>>4;if(w!==1)throw new Error(`Got v${w} data when expected v1.`);let P=$ne[15&_];if(!P)throw new Error("Unrecognized array type.");let[R]=new Uint16Array(c,2,1),[L]=new Uint32Array(c,4,1);return new UV(L,R,P,c)}constructor(c,h=64,_=Float64Array,w){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=_,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;let P=$ne.indexOf(this.ArrayType),R=2*c*this.ArrayType.BYTES_PER_ELEMENT,L=c*this.IndexArrayType.BYTES_PER_ELEMENT,U=(8-L%8)%8;if(P<0)throw new Error(`Unexpected typed array class: ${_}.`);w&&w instanceof ArrayBuffer?(this.data=w,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+L+U,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+R+L+U),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+L+U,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+P]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=c)}add(c,h){let _=this._pos>>1;return this.ids[_]=_,this.coords[this._pos++]=c,this.coords[this._pos++]=h,_}finish(){let c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return VV(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,h,_,w){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:P,coords:R,nodeSize:L}=this,U=[0,P.length-1,0],$=[];for(;U.length;){let q=U.pop()||0,J=U.pop()||0,oe=U.pop()||0;if(J-oe<=L){for(let we=oe;we<=J;we++){let Re=R[2*we],st=R[2*we+1];Re>=c&&Re<=_&&st>=h&&st<=w&&$.push(P[we])}continue}let se=oe+J>>1,le=R[2*se],ye=R[2*se+1];le>=c&&le<=_&&ye>=h&&ye<=w&&$.push(P[se]),(q===0?c<=le:h<=ye)&&(U.push(oe),U.push(se-1),U.push(1-q)),(q===0?_>=le:w>=ye)&&(U.push(se+1),U.push(J),U.push(1-q))}return $}within(c,h,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:w,coords:P,nodeSize:R}=this,L=[0,w.length-1,0],U=[],$=_*_;for(;L.length;){let q=L.pop()||0,J=L.pop()||0,oe=L.pop()||0;if(J-oe<=R){for(let we=oe;we<=J;we++)Gne(P[2*we],P[2*we+1],c,h)<=$&&U.push(w[we]);continue}let se=oe+J>>1,le=P[2*se],ye=P[2*se+1];Gne(le,ye,c,h)<=$&&U.push(w[se]),(q===0?c-_<=le:h-_<=ye)&&(L.push(oe),L.push(se-1),L.push(1-q)),(q===0?c+_>=le:h+_>=ye)&&(L.push(se+1),L.push(J),L.push(1-q))}return U}}function VV(d,c,h,_,w,P){if(w-_<=h)return;let R=_+w>>1;Wne(d,c,R,_,w,P),VV(d,c,h,_,R-1,1-P),VV(d,c,h,R+1,w,1-P)}function Wne(d,c,h,_,w,P){for(;w>_;){if(w-_>600){let $=w-_+1,q=h-_+1,J=Math.log($),oe=.5*Math.exp(2*J/3),se=.5*Math.sqrt(J*oe*($-oe)/$)*(q-$/2<0?-1:1);Wne(d,c,h,Math.max(_,Math.floor(h-q*oe/$+se)),Math.min(w,Math.floor(h+($-q)*oe/$+se)),P)}let R=c[2*h+P],L=_,U=w;for(nM(d,c,_,h),c[2*w+P]>R&&nM(d,c,_,w);L<U;){for(nM(d,c,L,U),L++,U--;c[2*L+P]<R;)L++;for(;c[2*U+P]>R;)U--}c[2*_+P]===R?nM(d,c,_,U):(U++,nM(d,c,U,w)),U<=h&&(_=U+1),h<=U&&(w=U-1)}}function nM(d,c,h,_){jV(d,h,_),jV(c,2*h,2*_),jV(c,2*h+1,2*_+1)}function jV(d,c,h){let _=d[c];d[c]=d[h],d[h]=_}function Gne(d,c,h,_){let w=d-h,P=c-_;return w*w+P*P}var $V;n.cx=void 0,($V=n.cx||(n.cx={})).create="create",$V.load="load",$V.fullLoad="fullLoad";let WR=null,oM=[],WV=1e3/60,GV="loadTime",HV="fullLoadTime",Lke={mark(d){performance.mark(d)},frame(d){let c=d;WR!=null&&oM.push(c-WR),WR=c},clearMetrics(){WR=null,oM=[],performance.clearMeasures(GV),performance.clearMeasures(HV);for(let d in n.cx)performance.clearMarks(n.cx[d])},getPerformanceMetrics(){performance.measure(GV,n.cx.create,n.cx.load),performance.measure(HV,n.cx.create,n.cx.fullLoad);let d=performance.getEntriesByName(GV)[0].duration,c=performance.getEntriesByName(HV)[0].duration,h=oM.length,_=1/(oM.reduce(((P,R)=>P+R),0)/h/1e3),w=oM.filter((P=>P>WV)).reduce(((P,R)=>P+(R-WV)/WV),0);return{loadTime:d,fullLoadTime:c,fps:_,percentDroppedFrames:w/(h+w)*100,totalFrames:h}}};n.$=It,n.A=W,n.B=function([d,c,h]){return c+=90,c*=Math.PI/180,h*=Math.PI/180,{x:d*Math.cos(c)*Math.sin(h),y:d*Math.sin(c)*Math.sin(h),z:d*Math.cos(h)}},n.C=Oo,n.D=_r,n.E=vr,n.F=Cn,n.G=Iv,n.H=cs,n.I=EV,n.J=class{constructor(d,c){this.target=d,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Tke((()=>this.process())),this.subscription=$s(this.target,"message",(h=>this.receive(h)),!1),this.globalScope=Pa(self)?d:window}registerMessageHandler(d,c){this.messageHandlers[d]=c}sendAsync(d,c){return new Promise(((h,_)=>{let w=Math.round(1e18*Math.random()).toString(36).substring(0,10),P=c?$s(c.signal,"abort",(()=>{P?.unsubscribe(),delete this.resolveRejects[w];let U={id:w,type:"<cancel>",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId};this.target.postMessage(U)}),Mke):null;this.resolveRejects[w]={resolve:U=>{P?.unsubscribe(),h(U)},reject:U=>{P?.unsubscribe(),_(U)}};let R=[],L=Object.assign(Object.assign({},d),{id:w,sourceMapId:this.mapId,origin:location.origin,data:Np(d.data,R)});this.target.postMessage(L,{transfer:R})}))}receive(d){let c=d.data,h=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[h];let _=this.abortControllers[h];return delete this.abortControllers[h],void(_&&_.abort())}if(Pa(self)||c.mustQueue)return this.tasks[h]=c,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,c)}}process(){if(this.taskQueue.length===0)return;let d=this.taskQueue.shift(),c=this.tasks[d];delete this.tasks[d],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(d,c)}processTask(d,c){return o(this,void 0,void 0,(function*(){if(c.type==="<response>"){let w=this.resolveRejects[d];return delete this.resolveRejects[d],w?void(c.error?w.reject(ed(c.error)):w.resolve(ed(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(d,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let h=ed(c.data),_=new AbortController;this.abortControllers[d]=_;try{let w=yield this.messageHandlers[c.type](c.sourceMapId,h,_);this.completeTask(d,null,w)}catch(w){this.completeTask(d,w)}}))}completeTask(d,c,h){let _=[];delete this.abortControllers[d];let w={id:d,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?Np(c):null,data:Np(h,_)};this.target.postMessage(w,{transfer:_})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},n.K=xe,n.L=function(){var d=new W(16);return W!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d},n.M=function(d,c,h){var _,w,P,R,L,U,$,q,J,oe,se,le,ye=h[0],we=h[1],Re=h[2];return c===d?(d[12]=c[0]*ye+c[4]*we+c[8]*Re+c[12],d[13]=c[1]*ye+c[5]*we+c[9]*Re+c[13],d[14]=c[2]*ye+c[6]*we+c[10]*Re+c[14],d[15]=c[3]*ye+c[7]*we+c[11]*Re+c[15]):(w=c[1],P=c[2],R=c[3],L=c[4],U=c[5],$=c[6],q=c[7],J=c[8],oe=c[9],se=c[10],le=c[11],d[0]=_=c[0],d[1]=w,d[2]=P,d[3]=R,d[4]=L,d[5]=U,d[6]=$,d[7]=q,d[8]=J,d[9]=oe,d[10]=se,d[11]=le,d[12]=_*ye+L*we+J*Re+c[12],d[13]=w*ye+U*we+oe*Re+c[13],d[14]=P*ye+$*we+se*Re+c[14],d[15]=R*ye+q*we+le*Re+c[15]),d},n.N=function(d,c,h){var _=h[0],w=h[1],P=h[2];return d[0]=c[0]*_,d[1]=c[1]*_,d[2]=c[2]*_,d[3]=c[3]*_,d[4]=c[4]*w,d[5]=c[5]*w,d[6]=c[6]*w,d[7]=c[7]*w,d[8]=c[8]*P,d[9]=c[9]*P,d[10]=c[10]*P,d[11]=c[11]*P,d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15],d},n.O=function(d,c,h){var _=c[0],w=c[1],P=c[2],R=c[3],L=c[4],U=c[5],$=c[6],q=c[7],J=c[8],oe=c[9],se=c[10],le=c[11],ye=c[12],we=c[13],Re=c[14],st=c[15],Ue=h[0],Ge=h[1],_t=h[2],Mt=h[3];return d[0]=Ue*_+Ge*L+_t*J+Mt*ye,d[1]=Ue*w+Ge*U+_t*oe+Mt*we,d[2]=Ue*P+Ge*$+_t*se+Mt*Re,d[3]=Ue*R+Ge*q+_t*le+Mt*st,d[4]=(Ue=h[4])*_+(Ge=h[5])*L+(_t=h[6])*J+(Mt=h[7])*ye,d[5]=Ue*w+Ge*U+_t*oe+Mt*we,d[6]=Ue*P+Ge*$+_t*se+Mt*Re,d[7]=Ue*R+Ge*q+_t*le+Mt*st,d[8]=(Ue=h[8])*_+(Ge=h[9])*L+(_t=h[10])*J+(Mt=h[11])*ye,d[9]=Ue*w+Ge*U+_t*oe+Mt*we,d[10]=Ue*P+Ge*$+_t*se+Mt*Re,d[11]=Ue*R+Ge*q+_t*le+Mt*st,d[12]=(Ue=h[12])*_+(Ge=h[13])*L+(_t=h[14])*J+(Mt=h[15])*ye,d[13]=Ue*w+Ge*U+_t*oe+Mt*we,d[14]=Ue*P+Ge*$+_t*se+Mt*Re,d[15]=Ue*R+Ge*q+_t*le+Mt*st,d},n.P=s,n.Q=function(d,c){let h={};for(let _=0;_<c.length;_++){let w=c[_];w in d&&(h[w]=d[w])}return h},n.R=Cc,n.S=ZA,n.T=AV,n.U=xne,n.V=bne,n.W=F,n.X=j,n.Y=Gl,n.Z=rh,n._=o,n.a=he,n.a$=Le,n.a0=function(d,c){var h,_,w,P,R;if(!d)return c??{};if(!c)return d;let L=Object.assign({},d);if(c.removeAll&&(L={removeAll:!0}),c.remove){let U=new Set(c.remove);L.add&&(L.add=L.add.filter((q=>!U.has(q.id)))),L.update&&(L.update=L.update.filter((q=>!U.has(q.id))));let $=new Set(((h=d.add)!==null&&h!==void 0?h:[]).map((q=>q.id)));c.remove=c.remove.filter((q=>!$.has(q)))}if(c.remove){let U=new Set(L.remove?L.remove.concat(c.remove):c.remove);L.remove=Array.from(U.values())}if(c.add){let U=L.add?L.add.concat(c.add):c.add,$=new Map(U.map((q=>[q.id,q])));L.add=Array.from($.values())}if(c.update){let U=new Map((_=L.update)===null||_===void 0?void 0:_.map(($=>[$.id,$])));for(let $ of c.update){let q=(w=U.get($.id))!==null&&w!==void 0?w:{id:$.id};$.newGeometry&&(q.newGeometry=$.newGeometry),$.addOrUpdateProperties&&(q.addOrUpdateProperties=((P=q.addOrUpdateProperties)!==null&&P!==void 0?P:[]).concat($.addOrUpdateProperties)),$.removeProperties&&(q.removeProperties=((R=q.removeProperties)!==null&&R!==void 0?R:[]).concat($.removeProperties)),$.removeAllProperties&&(q.removeAllProperties=!0),U.set($.id,q)}L.update=Array.from(U.values())}return L.remove&&L.add&&(L.remove=L.remove.filter((U=>L.add.findIndex(($=>$.id===U))===-1))),L},n.a1=rM,n.a2=Nv,n.a3=25,n.a4=FV,n.a5=d=>{let c=window.document.createElement("video");return c.muted=!0,new Promise((h=>{c.onloadstart=()=>{h(c)};for(let _ of d){let w=window.document.createElement("source");yt(_)||(c.crossOrigin="Anonymous"),w.src=_,c.appendChild(w)}}))},n.a6=Ot,n.a7=function(){return zi++},n.a8=X,n.a9=dw,n.aA=function(d){let c=1/0,h=1/0,_=-1/0,w=-1/0;for(let P of d)c=Math.min(c,P.x),h=Math.min(h,P.y),_=Math.max(_,P.x),w=Math.max(w,P.y);return[c,h,_,w]},n.aB=fa,n.aC=Bt,n.aD=function(d,c,h,_,w=!1){if(!h[0]&&!h[1])return[0,0];let P=w?_==="map"?-d.bearingInRadians:0:_==="viewport"?d.bearingInRadians:0;if(P){let R=Math.sin(P),L=Math.cos(P);h=[h[0]*L-h[1]*R,h[0]*R+h[1]*L]}return[w?h[0]:Bt(c,h[0],d.zoom),w?h[1]:Bt(c,h[1],d.zoom)]},n.aF=IV,n.aG=zV,n.aH=PV,n.aI=UV,n.aJ=Jn,n.aK=DR,n.aL=Oe,n.aM=St,n.aN=Ar,n.aO=oi,n.aP=bl,n.aQ=Sne,n.aR=ne,n.aS=Se,n.aT=function(d){var c=new W(3);return c[0]=d[0],c[1]=d[1],c[2]=d[2],c},n.aU=function(d,c,h){return d[0]=c[0]-h[0],d[1]=c[1]-h[1],d[2]=c[2]-h[2],d},n.aV=function(d,c){var h=c[0],_=c[1],w=c[2],P=h*h+_*_+w*w;return P>0&&(P=1/Math.sqrt(P)),d[0]=c[0]*P,d[1]=c[1]*P,d[2]=c[2]*P,d},n.aW=pe,n.aX=function(d,c){return d[0]*c[0]+d[1]*c[1]+d[2]*c[2]},n.aY=function(d,c,h){return d[0]=c[0]*h[0],d[1]=c[1]*h[1],d[2]=c[2]*h[2],d[3]=c[3]*h[3],d},n.aZ=ce,n.a_=function(d,c,h){let _=c[0]*h[0]+c[1]*h[1]+c[2]*h[2];return _===0?null:(-(d[0]*h[0]+d[1]*h[1]+d[2]*h[2])-h[3])/_},n.aa=gf,n.ab=Ai,n.ac=Cne,n.ad=function(d){let c={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((h,_,w,P)=>{let R=w||P;return c[_]=!R||R.toLowerCase(),""})),c["max-age"]){let h=parseInt(c["max-age"],10);isNaN(h)?delete c["max-age"]:c["max-age"]=h}return c},n.ae=xr,n.af=85.051129,n.ag=vc,n.ah=function(d){return Math.pow(2,d)},n.ai=Y,n.aj=wne,n.ak=function(d){return Math.log(d)/Math.LN2},n.al=function(d){var c=d[0],h=d[1];return c*c+h*h},n.am=function(d){if(!d.length)return new Set;let c=Math.max(...d.map((U=>U.canonical.z))),h=1/0,_=-1/0,w=1/0,P=-1/0,R=[];for(let U of d){let{x:$,y:q,z:J}=U.canonical,oe=Math.pow(2,c-J),se=$*oe,le=q*oe;R.push({id:U,x:se,y:le}),se<h&&(h=se),se>_&&(_=se),le<w&&(w=le),le>P&&(P=le)}let L=new Set;for(let U of R)U.x!==h&&U.x!==_&&U.y!==w&&U.y!==P||L.add(U.id);return L},n.an=function(d,c){let h=0,_=0;if(d.kind==="constant")_=d.layoutSize;else if(d.kind!=="source"){let{interpolationType:w,minZoom:P,maxZoom:R}=d,L=w?xr(Ro.interpolationFactor(w,c,P,R),0,1):0;d.kind==="camera"?_=Oo.number(d.minSize,d.maxSize,L):h=L}return{uSizeT:h,uSize:_}},n.ap=function(d,{uSize:c,uSizeT:h},{lowerSize:_,upperSize:w}){return d.kind==="source"?_/Mm:d.kind==="composite"?Oo.number(_/Mm,w/Mm,h):c},n.aq=function(d,c){var h=c[0],_=c[1],w=c[2],P=c[3],R=c[4],L=c[5],U=c[6],$=c[7],q=c[8],J=c[9],oe=c[10],se=c[11],le=c[12],ye=c[13],we=c[14],Re=c[15],st=h*L-_*R,Ue=h*U-w*R,Ge=h*$-P*R,_t=_*U-w*L,Mt=_*$-P*L,Ut=w*$-P*U,ir=q*ye-J*le,Zt=q*we-oe*le,er=q*Re-se*le,Er=J*we-oe*ye,Jt=J*Re-se*ye,tr=oe*Re-se*we,Rt=st*tr-Ue*Jt+Ge*Er+_t*er-Mt*Zt+Ut*ir;return Rt?(d[0]=(L*tr-U*Jt+$*Er)*(Rt=1/Rt),d[1]=(w*Jt-_*tr-P*Er)*Rt,d[2]=(ye*Ut-we*Mt+Re*_t)*Rt,d[3]=(oe*Mt-J*Ut-se*_t)*Rt,d[4]=(U*er-R*tr-$*Zt)*Rt,d[5]=(h*tr-w*er+P*Zt)*Rt,d[6]=(we*Ge-le*Ut-Re*Ue)*Rt,d[7]=(q*Ut-oe*Ge+se*Ue)*Rt,d[8]=(R*Jt-L*er+$*ir)*Rt,d[9]=(_*er-h*Jt-P*ir)*Rt,d[10]=(le*Mt-ye*Ge+Re*st)*Rt,d[11]=(J*Ge-q*Mt-se*st)*Rt,d[12]=(L*Zt-R*Er-U*ir)*Rt,d[13]=(h*Er-_*Zt+w*ir)*Rt,d[14]=(ye*Ue-le*_t-we*st)*Rt,d[15]=(q*_t-J*Ue+oe*st)*Rt,d):null},n.ar=at,n.as=function(d){var c=d[0],h=d[1];return Math.sqrt(c*c+h*h)},n.at=function(d){return d[0]=0,d[1]=0,d},n.au=function(d,c,h){return d[0]=c[0]*h,d[1]=c[1]*h,d},n.av=kV,n.aw=We,n.ax=function(d,c,h,_){let w=c.y-d.y,P=c.x-d.x,R=_.y-h.y,L=_.x-h.x,U=R*P-L*w;if(U===0)return null;let $=(L*(d.y-h.y)-R*(d.x-h.x))/U;return new s(d.x+$*P,d.y+$*w)},n.ay=kne,n.az=Ci,n.b=Ss,n.b$=class extends B{constructor(d,c){super(d,c),this.current=new Array}set(d){if(d!=this.current){this.current=d;let c=new Float32Array(d);this.gl.uniform1fv(this.location,c)}}},n.b0=function(d,c,h){return d[0]=c[0]*h,d[1]=c[1]*h,d[2]=c[2]*h,d[3]=c[3]*h,d},n.b1=function(d,c){return d[0]*c[0]+d[1]*c[1]+d[2]*c[2]+d[3]},n.b2=Mne,n.b3=fw,n.b4=function(d,c,h,_,w){var P=1/Math.tan(c/2);if(d[0]=P/h,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=P,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,w!=null&&w!==1/0){var R=1/(_-w);d[10]=(w+_)*R,d[14]=2*w*_*R}else d[10]=-1,d[14]=-2*_;return d},n.b5=function(d){var c=new W(16);return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],c},n.b6=function(d,c,h){var _=Math.sin(h),w=Math.cos(h),P=c[0],R=c[1],L=c[2],U=c[3],$=c[4],q=c[5],J=c[6],oe=c[7];return c!==d&&(d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]),d[0]=P*w+$*_,d[1]=R*w+q*_,d[2]=L*w+J*_,d[3]=U*w+oe*_,d[4]=$*w-P*_,d[5]=q*w-R*_,d[6]=J*w-L*_,d[7]=oe*w-U*_,d},n.b7=function(d,c,h){var _=Math.sin(h),w=Math.cos(h),P=c[4],R=c[5],L=c[6],U=c[7],$=c[8],q=c[9],J=c[10],oe=c[11];return c!==d&&(d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]),d[4]=P*w+$*_,d[5]=R*w+q*_,d[6]=L*w+J*_,d[7]=U*w+oe*_,d[8]=$*w-P*_,d[9]=q*w-R*_,d[10]=J*w-L*_,d[11]=oe*w-U*_,d},n.b8=function(){let d=new Float32Array(16);return Y(d),d},n.b9=function(){let d=new Float64Array(16);return Y(d),d},n.bA=function(d,c){let h=Qt(d,360),_=Qt(c,360),w=_-h,P=_>h?w-360:w+360;return Math.abs(w)<Math.abs(P)?w:P},n.bB=function(d){return d[0]=0,d[1]=0,d[2]=0,d},n.bC=function(d,c,h,_){let w=Math.sqrt(d*d+c*c),P=Math.sqrt(h*h+_*_);d/=w,c/=w,h/=P,_/=P;let R=Math.acos(d*h+c*_);return-c*h+d*_>0?R:-R},n.bD=function(d,c){let h=Qt(d,2*Math.PI),_=Qt(c,2*Math.PI);return Math.min(Math.abs(h-_),Math.abs(h-_+2*Math.PI),Math.abs(h-_-2*Math.PI))},n.bE=function(){let d={},c=lt.$version;for(let h in lt.$root){let _=lt.$root[h];if(_.required){let w=null;w=h==="version"?c:_.type==="array"?[]:{},w!=null&&(d[h]=w)}}return d},n.bF=vm,n.bG=$e,n.bH=function d(c,h){if(Array.isArray(c)){if(!Array.isArray(h)||c.length!==h.length)return!1;for(let _=0;_<c.length;_++)if(!d(c[_],h[_]))return!1;return!0}if(typeof c=="object"&&c!==null&&h!==null){if(typeof h!="object"||Object.keys(c).length!==Object.keys(h).length)return!1;for(let _ in c)if(!d(c[_],h[_]))return!1;return!0}return c===h},n.bI=function(d){d=d.slice();let c=Object.create(null);for(let h=0;h<d.length;h++)c[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=jn(d[h],c[d[h].ref]));return d},n.bJ=function(d,c){if(d.type==="custom")return new Ske(d,c);switch(d.type){case"background":return new wke(d,c);case"circle":return new lIe(d,c);case"color-relief":return new pIe(d,c);case"fill":return new PIe(d,c);case"fill-extrusion":return new UIe(d,c);case"heatmap":return new uIe(d,c);case"hillshade":return new dIe(d,c);case"line":return new qIe(d,c);case"raster":return new Wp(d,c);case"symbol":return new zR(d,c)}},n.bK=d=>d.type==="raster",n.bL=hn,n.bM=function(d,c){if(!d)return[{command:"setStyle",args:[c]}];let h=[];try{if(!wr(d.version,c.version))return[{command:"setStyle",args:[c]}];wr(d.center,c.center)||h.push({command:"setCenter",args:[c.center]}),wr(d.state,c.state)||h.push({command:"setGlobalState",args:[c.state]}),wr(d.centerAltitude,c.centerAltitude)||h.push({command:"setCenterAltitude",args:[c.centerAltitude]}),wr(d.zoom,c.zoom)||h.push({command:"setZoom",args:[c.zoom]}),wr(d.bearing,c.bearing)||h.push({command:"setBearing",args:[c.bearing]}),wr(d.pitch,c.pitch)||h.push({command:"setPitch",args:[c.pitch]}),wr(d.roll,c.roll)||h.push({command:"setRoll",args:[c.roll]}),wr(d.sprite,c.sprite)||h.push({command:"setSprite",args:[c.sprite]}),wr(d.glyphs,c.glyphs)||h.push({command:"setGlyphs",args:[c.glyphs]}),wr(d.transition,c.transition)||h.push({command:"setTransition",args:[c.transition]}),wr(d.light,c.light)||h.push({command:"setLight",args:[c.light]}),wr(d.terrain,c.terrain)||h.push({command:"setTerrain",args:[c.terrain]}),wr(d.sky,c.sky)||h.push({command:"setSky",args:[c.sky]}),wr(d.projection,c.projection)||h.push({command:"setProjection",args:[c.projection]});let _={},w=[];(function(R,L,U,$){let q;for(q in L=L||{},R=R||{})Object.prototype.hasOwnProperty.call(R,q)&&(Object.prototype.hasOwnProperty.call(L,q)||Jo(q,U,$));for(q in L)Object.prototype.hasOwnProperty.call(L,q)&&(Object.prototype.hasOwnProperty.call(R,q)?wr(R[q],L[q])||(R[q].type==="geojson"&&L[q].type==="geojson"&&Ws(R,L,q)?di(U,{command:"setGeoJSONSourceData",args:[q,L[q].data]}):Lt(q,L,U,$)):rn(q,L,U))})(d.sources,c.sources,w,_);let P=[];d.layers&&d.layers.forEach((R=>{"source"in R&&_[R.source]?h.push({command:"removeLayer",args:[R.id]}):P.push(R)})),h=h.concat(w),(function(R,L,U){L=L||[];let $=(R=R||[]).map(Zn),q=L.map(Zn),J=R.reduce(Vo,{}),oe=L.reduce(Vo,{}),se=$.slice(),le=Object.create(null),ye,we,Re,st,Ue;for(let Ge=0,_t=0;Ge<$.length;Ge++)ye=$[Ge],Object.prototype.hasOwnProperty.call(oe,ye)?_t++:(di(U,{command:"removeLayer",args:[ye]}),se.splice(se.indexOf(ye,_t),1));for(let Ge=0,_t=0;Ge<q.length;Ge++)ye=q[q.length-1-Ge],se[se.length-1-Ge]!==ye&&(Object.prototype.hasOwnProperty.call(J,ye)?(di(U,{command:"removeLayer",args:[ye]}),se.splice(se.lastIndexOf(ye,se.length-_t),1)):_t++,st=se[se.length-Ge],di(U,{command:"addLayer",args:[oe[ye],st]}),se.splice(se.length-Ge,0,ye),le[ye]=!0);for(let Ge=0;Ge<q.length;Ge++)if(ye=q[Ge],we=J[ye],Re=oe[ye],!le[ye]&&!wr(we,Re))if(wr(we.source,Re.source)&&wr(we["source-layer"],Re["source-layer"])&&wr(we.type,Re.type)){for(Ue in ko(we.layout,Re.layout,U,ye,null,"setLayoutProperty"),ko(we.paint,Re.paint,U,ye,null,"setPaintProperty"),wr(we.filter,Re.filter)||di(U,{command:"setFilter",args:[ye,Re.filter]}),wr(we.minzoom,Re.minzoom)&&wr(we.maxzoom,Re.maxzoom)||di(U,{command:"setLayerZoomRange",args:[ye,Re.minzoom,Re.maxzoom]}),we)Object.prototype.hasOwnProperty.call(we,Ue)&&Ue!=="layout"&&Ue!=="paint"&&Ue!=="filter"&&Ue!=="metadata"&&Ue!=="minzoom"&&Ue!=="maxzoom"&&(Ue.indexOf("paint.")===0?ko(we[Ue],Re[Ue],U,ye,Ue.slice(6),"setPaintProperty"):wr(we[Ue],Re[Ue])||di(U,{command:"setLayerProperty",args:[ye,Ue,Re[Ue]]}));for(Ue in Re)Object.prototype.hasOwnProperty.call(Re,Ue)&&!Object.prototype.hasOwnProperty.call(we,Ue)&&Ue!=="layout"&&Ue!=="paint"&&Ue!=="filter"&&Ue!=="metadata"&&Ue!=="minzoom"&&Ue!=="maxzoom"&&(Ue.indexOf("paint.")===0?ko(we[Ue],Re[Ue],U,ye,Ue.slice(6),"setPaintProperty"):wr(we[Ue],Re[Ue])||di(U,{command:"setLayerProperty",args:[ye,Ue,Re[Ue]]}))}else di(U,{command:"removeLayer",args:[ye]}),st=se[se.lastIndexOf(ye)+1],di(U,{command:"addLayer",args:[Re,st]})})(P,c.layers,h)}catch(_){console.warn("Unable to compute style diff:",_),h=[{command:"setStyle",args:[c]}]}return h},n.bN=function(d){let c=[],h=d.id;return h===void 0&&c.push({message:`layers.${h}: missing required property "id"`}),d.render===void 0&&c.push({message:`layers.${h}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&c.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),c},n.bO=on,n.bP=Ki,n.bQ=class extends B{constructor(d,c){super(d,c),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},n.bR=K,n.bS=class extends B{constructor(d,c){super(d,c),this.current=te}set(d){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let c=1;c<16;c++)if(d[c]!==this.current[c]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}},n.bT=G,n.bU=class extends B{constructor(d,c){super(d,c),this.current=[0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2]))}},n.bV=class extends B{constructor(d,c){super(d,c),this.current=[0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1]))}},n.bW=Z,n.bX=function(d,c){var h=Math.sin(c),_=Math.cos(c);return d[0]=_,d[1]=h,d[2]=0,d[3]=-h,d[4]=_,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},n.bY=function(d,c,h){var _=c[0],w=c[1],P=c[2];return d[0]=_*h[0]+w*h[3]+P*h[6],d[1]=_*h[1]+w*h[4]+P*h[7],d[2]=_*h[2]+w*h[5]+P*h[8],d},n.bZ=function(d,c,h,_,w,P,R){var L=1/(c-h),U=1/(_-w),$=1/(P-R);return d[0]=-2*L,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*U,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*$,d[11]=0,d[12]=(c+h)*L,d[13]=(w+_)*U,d[14]=(R+P)*$,d[15]=1,d},n.b_=class extends B{constructor(d,c){super(d,c),this.current=new Array}set(d){if(d!=this.current){this.current=d;let c=new Float32Array(4*d.length);for(let h=0;h<d.length;h++)c[4*h]=d[h].r,c[4*h+1]=d[h].g,c[4*h+2]=d[h].b,c[4*h+3]=d[h].a;this.gl.uniform4fv(this.location,c)}}},n.ba=function(){return new Float64Array(16)},n.bb=function(d,c,h){let _=new Float64Array(4);return rt(_,d,c-90,h),_},n.bc=function(d,c,h,_){var w,P,R,L,U,$=c[0],q=c[1],J=c[2],oe=c[3],se=h[0],le=h[1],ye=h[2],we=h[3];return(P=$*se+q*le+J*ye+oe*we)<0&&(P=-P,se=-se,le=-le,ye=-ye,we=-we),1-P>H?(w=Math.acos(P),R=Math.sin(w),L=Math.sin((1-_)*w)/R,U=Math.sin(_*w)/R):(L=1-_,U=_),d[0]=L*$+U*se,d[1]=L*q+U*le,d[2]=L*J+U*ye,d[3]=L*oe+U*we,d},n.bd=function(d){let c=new Float64Array(9);var h,_,w,P,R,L,U,$,q,J,oe,se,le,ye,we,Re,st,Ue;J=(w=(_=d)[0])*(U=w+w),oe=(P=_[1])*U,le=(R=_[2])*U,ye=R*($=P+P),Re=(L=_[3])*U,st=L*$,Ue=L*(q=R+R),(h=c)[0]=1-(se=P*$)-(we=R*q),h[3]=oe-Ue,h[6]=le+st,h[1]=oe+Ue,h[4]=1-J-we,h[7]=ye-Re,h[2]=le-st,h[5]=ye+Re,h[8]=1-J-se;let Ge=bl(-Math.asin(xr(c[2],-1,1))),_t,Mt;return Math.hypot(c[5],c[8])<.001?(_t=0,Mt=-bl(Math.atan2(c[3],c[4]))):(_t=bl(c[5]===0&&c[8]===0?0:Math.atan2(c[5],c[8])),Mt=bl(c[1]===0&&c[0]===0?0:Math.atan2(c[1],c[0]))),{roll:_t,pitch:Ge+90,bearing:Mt}},n.be=function(d,c){return d.roll==c.roll&&d.pitch==c.pitch&&d.bearing==c.bearing},n.bf=ci,n.bg=N,n.bh=lw,n.bi=Z4,n.bj=aw,n.bk=hr,n.bl=nt,n.bm=Ja,n.bn=function(d,c,h,_,w){return hr(_,w,xr((d-c)/(h-c),0,1))},n.bo=Qt,n.bp=function(){return new Float64Array(3)},n.bq=function(d,c,h,_){return d[0]=c[0]+h[0]*_,d[1]=c[1]+h[1]*_,d[2]=c[2]+h[2]*_,d},n.br=rt,n.bs=function(d,c,h){var _=h[0],w=h[1],P=h[2],R=h[3],L=c[0],U=c[1],$=c[2],q=w*$-P*U,J=P*L-_*$,oe=_*U-w*L;return d[0]=L+R*(q+=q)+w*(oe+=oe)-P*(J+=J),d[1]=U+R*J+P*q-_*oe,d[2]=$+R*oe+_*J-w*q,d},n.bt=function(d,c,h){let _=(w=[d[0],d[1],d[2],c[0],c[1],c[2],h[0],h[1],h[2]])[0]*((q=w[8])*(R=w[4])-(L=w[5])*($=w[7]))+w[1]*(-q*(P=w[3])+L*(U=w[6]))+w[2]*($*P-R*U);var w,P,R,L,U,$,q;if(_===0)return null;let J=pe([],[c[0],c[1],c[2]],[h[0],h[1],h[2]]),oe=pe([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),se=pe([],[d[0],d[1],d[2]],[c[0],c[1],c[2]]),le=ne([],J,-d[3]);return Se(le,le,ne([],oe,-c[3])),Se(le,le,ne([],se,-h[3])),ne(le,le,1/_),le},n.bu=LV,n.bv=function(){return new Float64Array(4)},n.bw=function(d,c,h,_){var w=[],P=[];return w[0]=c[0]-h[0],w[1]=c[1]-h[1],w[2]=c[2]-h[2],P[0]=w[0]*Math.cos(_)-w[1]*Math.sin(_),P[1]=w[0]*Math.sin(_)+w[1]*Math.cos(_),P[2]=w[2],d[0]=P[0]+h[0],d[1]=P[1]+h[1],d[2]=P[2]+h[2],d},n.bx=function(d,c,h,_){var w=[],P=[];return w[0]=c[0]-h[0],w[1]=c[1]-h[1],w[2]=c[2]-h[2],P[0]=w[0],P[1]=w[1]*Math.cos(_)-w[2]*Math.sin(_),P[2]=w[1]*Math.sin(_)+w[2]*Math.cos(_),d[0]=P[0]+h[0],d[1]=P[1]+h[1],d[2]=P[2]+h[2],d},n.by=function(d,c,h,_){var w=[],P=[];return w[0]=c[0]-h[0],w[1]=c[1]-h[1],w[2]=c[2]-h[2],P[0]=w[2]*Math.sin(_)+w[0]*Math.cos(_),P[1]=w[1],P[2]=w[2]*Math.cos(_)-w[0]*Math.sin(_),d[0]=P[0]+h[0],d[1]=P[1]+h[1],d[2]=P[2]+h[2],d},n.bz=function(d,c,h){var _=Math.sin(h),w=Math.cos(h),P=c[0],R=c[1],L=c[2],U=c[3],$=c[8],q=c[9],J=c[10],oe=c[11];return c!==d&&(d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15]),d[0]=P*w-$*_,d[1]=R*w-q*_,d[2]=L*w-J*_,d[3]=U*w-oe*_,d[8]=P*_+$*w,d[9]=R*_+q*w,d[10]=L*_+J*w,d[11]=U*_+oe*w,d},n.c=Je,n.c0=class extends Lv{},n.c1=KIe,n.c2=class extends qA{},n.c3=gV,n.c4=function(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))},n.c5=kie,n.c6=function(d,c,h){var _=c[0],w=c[1],P=c[2],R=h[3]*_+h[7]*w+h[11]*P+h[15];return d[0]=(h[0]*_+h[4]*w+h[8]*P+h[12])/(R=R||1),d[1]=(h[1]*_+h[5]*w+h[9]*P+h[13])/R,d[2]=(h[2]*_+h[6]*w+h[10]*P+h[14])/R,d},n.c7=class extends WA{},n.c8=class extends D{},n.c9=function(d,c){return d[0]===c[0]&&d[1]===c[1]&&d[2]===c[2]&&d[3]===c[3]&&d[4]===c[4]&&d[5]===c[5]&&d[6]===c[6]&&d[7]===c[7]&&d[8]===c[8]&&d[9]===c[9]&&d[10]===c[10]&&d[11]===c[11]&&d[12]===c[12]&&d[13]===c[13]&&d[14]===c[14]&&d[15]===c[15]},n.cA=function(d,c){he.REGISTERED_PROTOCOLS[d]=c},n.cB=function(d){delete he.REGISTERED_PROTOCOLS[d]},n.cC=function(d,c){let h={};for(let w=0;w<d.length;w++){let P=c&&c[d[w].id]||Ev(d[w]);c&&(c[d[w].id]=P);let R=h[P];R||(R=h[P]=[]),R.push(d[w])}let _=[];for(let w in h)_.push(h[w]);return _},n.cD=ar,n.cE=Ene,n.cF=Pne,n.cG=sne,n.cH=function(d){d.bucket.createArrays(),d.bucket.tilePixelRatio=It/(512*d.bucket.overscaling),d.bucket.compareText={},d.bucket.iconsNeedLinear=!1;let c=d.bucket.layers[0],h=c.layout,_=c._unevaluatedLayout._values,w={layoutIconSize:_["icon-size"].possiblyEvaluate(new Cn(d.bucket.zoom+1),d.canonical),layoutTextSize:_["text-size"].possiblyEvaluate(new Cn(d.bucket.zoom+1),d.canonical),textMaxSize:_["text-size"].possiblyEvaluate(new Cn(18))};if(d.bucket.textSizeData.kind==="composite"){let{minZoom:$,maxZoom:q}=d.bucket.textSizeData;w.compositeTextSizes=[_["text-size"].possiblyEvaluate(new Cn($),d.canonical),_["text-size"].possiblyEvaluate(new Cn(q),d.canonical)]}if(d.bucket.iconSizeData.kind==="composite"){let{minZoom:$,maxZoom:q}=d.bucket.iconSizeData;w.compositeIconSizes=[_["icon-size"].possiblyEvaluate(new Cn($),d.canonical),_["icon-size"].possiblyEvaluate(new Cn(q),d.canonical)]}let P=h.get("text-line-height")*fa,R=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",L=h.get("text-keep-upright"),U=h.get("text-size");for(let $ of d.bucket.features){let q=h.get("text-font").evaluate($,{},d.canonical).join(","),J=U.evaluate($,{},d.canonical),oe=w.layoutTextSize.evaluate($,{},d.canonical),se=w.layoutIconSize.evaluate($,{},d.canonical),le={horizontal:{},vertical:void 0},ye=$.text,we,Re=[0,0];if(ye){let Ge=ye.toString(),_t=h.get("text-letter-spacing").evaluate($,{},d.canonical)*fa,Mt=NA(Ge)?_t:0,Ut=h.get("text-anchor").evaluate($,{},d.canonical),ir=Une(c,$,d.canonical);if(!ir){let Jt=h.get("text-radial-offset").evaluate($,{},d.canonical);Re=Jt?zne(Ut,[Jt*fa,NV]):h.get("text-offset").evaluate($,{},d.canonical).map((tr=>tr*fa))}let Zt=R?"center":h.get("text-justify").evaluate($,{},d.canonical),er=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate($,{},d.canonical)*fa:1/0,Er=()=>{d.bucket.allowVerticalPlacement&&zp(Ge)&&(le.vertical=BR(ye,d.glyphMap,d.glyphPositions,d.imagePositions,q,er,P,Ut,"left",Mt,Re,n.ao.vertical,!0,oe,J))};if(!R&&ir){let Jt=new Set;if(Zt==="auto")for(let Rt=0;Rt<ir.values.length;Rt+=2)Jt.add(zV(ir.values[Rt]));else Jt.add(Zt);let tr=!1;for(let Rt of Jt)if(!le.horizontal[Rt])if(tr)le.horizontal[Rt]=le.horizontal[0];else{let Vr=BR(ye,d.glyphMap,d.glyphPositions,d.imagePositions,q,er,P,"center",Rt,Mt,Re,n.ao.horizontal,!1,oe,J);Vr&&(le.horizontal[Rt]=Vr,tr=Vr.positionedLines.length===1)}Er()}else{Zt==="auto"&&(Zt=zV(Ut));let Jt=BR(ye,d.glyphMap,d.glyphPositions,d.imagePositions,q,er,P,Ut,Zt,Mt,Re,n.ao.horizontal,!1,oe,J);Jt&&(le.horizontal[Zt]=Jt),Er(),zp(Ge)&&R&&L&&(le.vertical=BR(ye,d.glyphMap,d.glyphPositions,d.imagePositions,q,er,P,Ut,Zt,Mt,Re,n.ao.vertical,!1,oe,J))}}let st=!1;if($.icon&&$.icon.name){let Ge=d.imageMap[$.icon.name];Ge&&(we=_ke(d.imagePositions[$.icon.name],h.get("icon-offset").evaluate($,{},d.canonical),h.get("icon-anchor").evaluate($,{},d.canonical)),st=!!Ge.sdf,d.bucket.sdfIcons===void 0?d.bucket.sdfIcons=st:d.bucket.sdfIcons!==st&&xn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ge.pixelRatio!==d.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(d.bucket.iconsNeedLinear=!0))}let Ue=jne(le.horizontal)||le.vertical;d.bucket.iconsInText=!!Ue&&Ue.iconsInText,(Ue||we)&&Oke(d.bucket,$,le,we,d.imageMap,w,oe,se,Re,st,d.canonical,d.subdivisionGranularity)}d.showCollisionBoxes&&d.bucket.generateCollisionDebugBuffers()},n.cI=bV,n.cJ=wV,n.cK=SV,n.cL=Hie,n.cM=MV,n.cN=class{constructor(d){this._marks={start:[d.url,"start"].join("#"),end:[d.url,"end"].join("#"),measure:d.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let d=performance.getEntriesByName(this._marks.measure);return d.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),d=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),d}},n.cO=function(d,c,h,_,w){return o(this,void 0,void 0,(function*(){if(j())try{return yield Gl(d,c,h,_,w)}catch{}return(function(P,R,L,U,$){let q=P.width,J=P.height;_c&&us||(_c=new OffscreenCanvas(q,J),us=_c.getContext("2d",{willReadFrequently:!0})),_c.width=q,_c.height=J,us.drawImage(P,0,0,q,J);let oe=us.getImageData(R,L,U,$);return us.clearRect(0,0,q,J),oe.data})(d,c,h,_,w)}))},n.cP=Die,n.cQ=a,n.cR=Gie,n.cS=cw,n.cT=TA,n.cU=function(d,c){let h=new Map;if(d!=null)if(d.type==="Feature")h.set(iM(d,c),d);else for(let _ of d.features)h.set(iM(_,c),_);return h},n.cV=function(d,c){if(d==null)return!0;if(d.type==="Feature")return iM(d,c)!=null;if(d.type==="FeatureCollection"){let h=new Set;for(let _ of d.features){let w=iM(_,c);if(w==null||h.has(w))return!1;h.add(w)}return!0}return!1},n.cW=function(d,c,h){var _,w,P,R;if(c.removeAll&&d.clear(),c.remove)for(let L of c.remove)d.delete(L);if(c.add)for(let L of c.add){let U=iM(L,h);U!=null&&d.set(U,L)}if(c.update)for(let L of c.update){let U=d.get(L.id);if(U==null)continue;let $=!L.removeAllProperties&&(((_=L.removeProperties)===null||_===void 0?void 0:_.length)>0||((w=L.addOrUpdateProperties)===null||w===void 0?void 0:w.length)>0);if((L.newGeometry||L.removeAllProperties||$)&&(U=Object.assign({},U),d.set(L.id,U),$&&(U.properties=Object.assign({},U.properties))),L.newGeometry&&(U.geometry=L.newGeometry),L.removeAllProperties)U.properties={};else if(((P=L.removeProperties)===null||P===void 0?void 0:P.length)>0)for(let q of L.removeProperties)Object.prototype.hasOwnProperty.call(U.properties,q)&&delete U.properties[q];if(((R=L.addOrUpdateProperties)===null||R===void 0?void 0:R.length)>0)for(let{key:q,value:J}of L.addOrUpdateProperties)U.properties[q]=J}},n.cX=lu,n.ca=function(d,c){var h=d[0],_=d[1],w=d[2],P=d[3],R=d[4],L=d[5],U=d[6],$=d[7],q=d[8],J=d[9],oe=d[10],se=d[11],le=d[12],ye=d[13],we=d[14],Re=d[15],st=c[0],Ue=c[1],Ge=c[2],_t=c[3],Mt=c[4],Ut=c[5],ir=c[6],Zt=c[7],er=c[8],Er=c[9],Jt=c[10],tr=c[11],Rt=c[12],Vr=c[13],Jr=c[14],Rr=c[15];return Math.abs(h-st)<=H*Math.max(1,Math.abs(h),Math.abs(st))&&Math.abs(_-Ue)<=H*Math.max(1,Math.abs(_),Math.abs(Ue))&&Math.abs(w-Ge)<=H*Math.max(1,Math.abs(w),Math.abs(Ge))&&Math.abs(P-_t)<=H*Math.max(1,Math.abs(P),Math.abs(_t))&&Math.abs(R-Mt)<=H*Math.max(1,Math.abs(R),Math.abs(Mt))&&Math.abs(L-Ut)<=H*Math.max(1,Math.abs(L),Math.abs(Ut))&&Math.abs(U-ir)<=H*Math.max(1,Math.abs(U),Math.abs(ir))&&Math.abs($-Zt)<=H*Math.max(1,Math.abs($),Math.abs(Zt))&&Math.abs(q-er)<=H*Math.max(1,Math.abs(q),Math.abs(er))&&Math.abs(J-Er)<=H*Math.max(1,Math.abs(J),Math.abs(Er))&&Math.abs(oe-Jt)<=H*Math.max(1,Math.abs(oe),Math.abs(Jt))&&Math.abs(se-tr)<=H*Math.max(1,Math.abs(se),Math.abs(tr))&&Math.abs(le-Rt)<=H*Math.max(1,Math.abs(le),Math.abs(Rt))&&Math.abs(ye-Vr)<=H*Math.max(1,Math.abs(ye),Math.abs(Vr))&&Math.abs(we-Jr)<=H*Math.max(1,Math.abs(we),Math.abs(Jr))&&Math.abs(Re-Rr)<=H*Math.max(1,Math.abs(Re),Math.abs(Rr))},n.cb=function(d,c){return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d[9]=c[9],d[10]=c[10],d[11]=c[11],d[12]=c[12],d[13]=c[13],d[14]=c[14],d[15]=c[15],d},n.cc=d=>d.type==="symbol",n.cd=d=>d.type==="circle",n.ce=d=>d.type==="heatmap",n.cf=d=>d.type==="line",n.cg=d=>d.type==="fill",n.ch=d=>d.type==="fill-extrusion",n.ci=d=>d.type==="hillshade",n.cj=d=>d.type==="color-relief",n.ck=d=>d.type==="background",n.cl=d=>d.type==="custom",n.cm=Et,n.cn=function(d,c,h){let _=Wt(c.x-h.x,c.y-h.y),w=Wt(d.x-h.x,d.y-h.y);var P,R;return bl(Math.atan2(_[0]*w[1]-_[1]*w[0],(P=_)[0]*(R=w)[0]+P[1]*R[1]))},n.co=yr,n.cp=function(d,c){return Ia[c]&&(d instanceof MouseEvent||d instanceof WheelEvent)},n.cq=function(d,c){return rm[c]&&"touches"in d},n.cr=function(d){return rm[d]||Ia[d]},n.cs=function(d,c,h){var _=c[0],w=c[1];return d[0]=h[0]*_+h[4]*w+h[12],d[1]=h[1]*_+h[5]*w+h[13],d},n.ct=function(d,c){let{x:h,y:_}=rM.fromLngLat(c);return!(d<0||d>25||_<0||_>=1||h<0||h>=1)},n.cu=function(d,c){return d[0]=c[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=c[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=c[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},n.cv=class extends Ec{},n.cw=Lke,n.cy=function(d){return d.message===Hl},n.cz=Ne,n.d=yt,n.e=jr,n.f=d=>o(void 0,void 0,void 0,(function*(){if(d.byteLength===0)return createImageBitmap(new ImageData(1,1));let c=new Blob([new Uint8Array(d)],{type:"image/png"});try{return createImageBitmap(c)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),n.g=fe,n.h=d=>new Promise(((c,h)=>{let _=new Image;_.onload=()=>{c(_),URL.revokeObjectURL(_.src),_.onload=null,window.requestAnimationFrame((()=>{_.src=Wl}))},_.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let w=new Blob([new Uint8Array(d)],{type:"image/png"});_.src=d.byteLength?URL.createObjectURL(w):Wl})),n.i=Pa,n.j=(d,c)=>tt(jr(d,{type:"json"}),c),n.k=Ct,n.l=Ft,n.m=tt,n.n=(d,c)=>tt(jr(d,{type:"arrayBuffer"}),c),n.o=function(d){return new MV(d).readFields(lke,[])},n.p=one,n.q=G4,n.r=da,n.s=$s,n.t=VA,n.u=Ri,n.v=lt,n.w=xn,n.x=Qh,n.y=wl,n.z=Kl})),r("worker",["./shared"],(function(n){"use strict";class o{constructor(he,fe){this.keyCache={},he&&this.replace(he,fe)}replace(he,fe){this._layerConfigs={},this._layers={},this.update(he,[],fe)}update(he,fe,xe){for(let $e of he){this._layerConfigs[$e.id]=$e;let tt=this._layers[$e.id]=n.bJ($e,xe);tt._featureFilter=n.aa(tt.filter,xe),this.keyCache[$e.id]&&delete this.keyCache[$e.id]}for(let $e of fe)delete this.keyCache[$e],delete this._layerConfigs[$e],delete this._layers[$e];this.familiesBySource={};let Ne=n.cC(Object.values(this._layerConfigs),this.keyCache);for(let $e of Ne){let tt=$e.map((vr=>this._layers[vr.id])),yt=tt[0];if(yt.visibility==="none")continue;let it=yt.source||"",xt=this.familiesBySource[it];xt||(xt=this.familiesBySource[it]={});let Ft=yt.sourceLayer||"_geojsonTileLayer",Ct=xt[Ft];Ct||(Ct=xt[Ft]=[]),Ct.push(tt)}}}class s{constructor(he){let fe={},xe=[];for(let yt in he){let it=he[yt],xt=fe[yt]={};for(let Ft in it){let Ct=it[+Ft];if(!Ct||Ct.bitmap.width===0||Ct.bitmap.height===0)continue;let vr={x:0,y:0,w:Ct.bitmap.width+2,h:Ct.bitmap.height+2};xe.push(vr),xt[Ft]={rect:vr,metrics:Ct.metrics}}}let{w:Ne,h:$e}=n.p(xe),tt=new n.q({width:Ne||1,height:$e||1});for(let yt in he){let it=he[yt];for(let xt in it){let Ft=it[+xt];if(!Ft||Ft.bitmap.width===0||Ft.bitmap.height===0)continue;let Ct=fe[yt][xt].rect;n.q.copy(Ft.bitmap,tt,{x:0,y:0},{x:Ct.x+1,y:Ct.y+1},Ft.bitmap)}}this.image=tt,this.positions=fe}}n.cD("GlyphAtlas",s);class a{constructor(he){this.tileID=new n.Z(he.tileID.overscaledZ,he.tileID.wrap,he.tileID.canonical.z,he.tileID.canonical.x,he.tileID.canonical.y),this.uid=he.uid,this.zoom=he.zoom,this.pixelRatio=he.pixelRatio,this.tileSize=he.tileSize,this.source=he.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=he.showCollisionBoxes,this.collectResourceTiming=!!he.collectResourceTiming,this.returnDependencies=!!he.returnDependencies,this.promoteId=he.promoteId,this.inFlightDependencies=[]}parse(he,fe,xe,Ne,$e){return n._(this,void 0,void 0,(function*(){this.status="parsing",this.data=he,this.collisionBoxArray=new n.a8;let tt=new n.cE(Object.keys(he.layers).sort()),yt=new n.cF(this.tileID,this.promoteId);yt.bucketLayerIDs=[];let it={},xt={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:xe,subdivisionGranularity:$e},Ft=fe.familiesBySource[this.source];for(let Ot in Ft){let wo=he.layers[Ot];if(!wo)continue;wo.version===1&&n.w(`Vector tile source "${this.source}" layer "${Ot}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let ka=tt.encode(Ot),tf=[];for(let Ra=0;Ra<wo.length;Ra++){let Kt=wo.feature(Ra),fi=yt.getId(Kt,Ot);tf.push({feature:Kt,id:fi,index:Ra,sourceLayerIndex:ka})}for(let Ra of Ft[Ot]){let Kt=Ra[0];Kt.source!==this.source&&n.w(`layer.source = ${Kt.source} does not equal this.source = ${this.source}`),Kt.isHidden(this.zoom,!0)||(u(Ra,this.zoom,xe),(it[Kt.id]=Kt.createBucket({index:yt.bucketLayerIDs.length,layers:Ra,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ka,sourceID:this.source})).populate(tf,xt,this.tileID.canonical),yt.bucketLayerIDs.push(Ra.map((fi=>fi.id))))}}let Ct=n.bO(xt.glyphDependencies,(Ot=>Object.keys(Ot).map(Number)));this.inFlightDependencies.forEach((Ot=>Ot?.abort())),this.inFlightDependencies=[];let vr=Promise.resolve({});if(Object.keys(Ct).length){let Ot=new AbortController;this.inFlightDependencies.push(Ot),vr=Ne.sendAsync({type:"GG",data:{stacks:Ct,source:this.source,tileID:this.tileID,type:"glyphs"}},Ot)}let lt=Object.keys(xt.iconDependencies),Ei=Promise.resolve({});if(lt.length){let Ot=new AbortController;this.inFlightDependencies.push(Ot),Ei=Ne.sendAsync({type:"GI",data:{icons:lt,source:this.source,tileID:this.tileID,type:"icons"}},Ot)}let jn=Object.keys(xt.patternDependencies),wr=Promise.resolve({});if(jn.length){let Ot=new AbortController;this.inFlightDependencies.push(Ot),wr=Ne.sendAsync({type:"GI",data:{icons:jn,source:this.source,tileID:this.tileID,type:"patterns"}},Ot)}let di=xt.dashDependencies,rn=Promise.resolve({});if(Object.keys(di).length){let Ot=new AbortController;this.inFlightDependencies.push(Ot),rn=Ne.sendAsync({type:"GDA",data:{dashes:di}},Ot)}let[Jo,Lt,Ws,ko]=yield Promise.all([vr,Ei,wr,rn]),Zn=new s(Jo),Vo=new n.cG(Lt,Ws);for(let Ot in it){let wo=it[Ot];wo instanceof n.a9?(u(wo.layers,this.zoom,xe),n.cH({bucket:wo,glyphMap:Jo,glyphPositions:Zn.positions,imageMap:Lt,imagePositions:Vo.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:xt.subdivisionGranularity})):wo.hasDependencies&&(wo instanceof n.cI||wo instanceof n.cJ||wo instanceof n.cK)&&(u(wo.layers,this.zoom,xe),wo.addFeatures(xt,this.tileID.canonical,Vo.patternPositions,ko))}return this.status="done",{buckets:Object.values(it).filter((Ot=>!Ot.isEmpty())),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Zn.image,imageAtlas:Vo,dashPositions:ko,glyphMap:this.returnDependencies?Jo:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?Zn.positions:null}}))}}function u(Je,he,fe){let xe=new n.F(he);for(let Ne of Je)Ne.recalculate(xe,fe)}class p{constructor(he,fe,xe){this.actor=he,this.layerIndex=fe,this.availableImages=xe,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(he,fe){return n._(this,void 0,void 0,(function*(){let xe=yield n.n(he.request,fe);try{return{vectorTile:new n.cL(new n.cM(xe.data)),rawData:xe.data,cacheControl:xe.cacheControl,expires:xe.expires}}catch(Ne){let $e=new Uint8Array(xe.data),tt=`Unable to parse the tile at ${he.request.url}, `;throw tt+=$e[0]===31&&$e[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ne.message}`,new Error(tt)}}))}loadTile(he){return n._(this,void 0,void 0,(function*(){let fe=he.uid,xe=!!(he&&he.request&&he.request.collectResourceTiming)&&new n.cN(he.request),Ne=new a(he);this.loading[fe]=Ne;let $e=new AbortController;Ne.abort=$e;try{let tt=yield this.loadVectorTile(he,$e);if(delete this.loading[fe],!tt)return null;let yt=tt.rawData,it={};tt.expires&&(it.expires=tt.expires),tt.cacheControl&&(it.cacheControl=tt.cacheControl);let xt={};if(xe){let Ct=xe.finish();Ct&&(xt.resourceTiming=JSON.parse(JSON.stringify(Ct)))}Ne.vectorTile=tt.vectorTile;let Ft=Ne.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,he.subdivisionGranularity);this.loaded[fe]=Ne,this.fetching[fe]={rawTileData:yt,cacheControl:it,resourceTiming:xt};try{let Ct=yield Ft;return n.e({rawTileData:yt.slice(0)},Ct,it,xt)}finally{delete this.fetching[fe]}}catch(tt){throw delete this.loading[fe],Ne.status="done",this.loaded[fe]=Ne,tt}}))}reloadTile(he){return n._(this,void 0,void 0,(function*(){let fe=he.uid;if(!this.loaded||!this.loaded[fe])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let xe=this.loaded[fe];if(xe.showCollisionBoxes=he.showCollisionBoxes,xe.status==="parsing"){let Ne=yield xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,he.subdivisionGranularity),$e;if(this.fetching[fe]){let{rawTileData:tt,cacheControl:yt,resourceTiming:it}=this.fetching[fe];delete this.fetching[fe],$e=n.e({rawTileData:tt.slice(0)},Ne,yt,it)}else $e=Ne;return $e}if(xe.status==="done"&&xe.vectorTile)return xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,he.subdivisionGranularity)}))}abortTile(he){return n._(this,void 0,void 0,(function*(){let fe=this.loading,xe=he.uid;fe&&fe[xe]&&fe[xe].abort&&(fe[xe].abort.abort(),delete fe[xe])}))}removeTile(he){return n._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[he.uid]&&delete this.loaded[he.uid]}))}}class m{constructor(){this.loaded={}}loadTile(he){return n._(this,void 0,void 0,(function*(){let{uid:fe,encoding:xe,rawImageData:Ne,redFactor:$e,greenFactor:tt,blueFactor:yt,baseShift:it}=he,xt=Ne.width+2,Ft=Ne.height+2,Ct=n.b(Ne)?new n.R({width:xt,height:Ft},yield n.cO(Ne,-1,-1,xt,Ft)):Ne,vr=new n.cP(fe,Ct,xe,$e,tt,yt,it);return this.loaded=this.loaded||{},this.loaded[fe]=vr,vr}))}removeTile(he){let fe=this.loaded,xe=he.uid;fe&&fe[xe]&&delete fe[xe]}}var x,M,k=(function(){if(M)return x;function Je(fe,xe){if(fe.length!==0){he(fe[0],xe);for(var Ne=1;Ne<fe.length;Ne++)he(fe[Ne],!xe)}}function he(fe,xe){for(var Ne=0,$e=0,tt=0,yt=fe.length,it=yt-1;tt<yt;it=tt++){var xt=(fe[tt][0]-fe[it][0])*(fe[it][1]+fe[tt][1]),Ft=Ne+xt;$e+=Math.abs(Ne)>=Math.abs(xt)?Ne-Ft+xt:xt-Ft+Ne,Ne=Ft}Ne+$e>=0!=!!xe&&fe.reverse()}return M=1,x=function fe(xe,Ne){var $e,tt=xe&&xe.type;if(tt==="FeatureCollection")for($e=0;$e<xe.features.length;$e++)fe(xe.features[$e],Ne);else if(tt==="GeometryCollection")for($e=0;$e<xe.geometries.length;$e++)fe(xe.geometries[$e],Ne);else if(tt==="Feature")fe(xe.geometry,Ne);else if(tt==="Polygon")Je(xe.coordinates,Ne);else if(tt==="MultiPolygon")for($e=0;$e<xe.coordinates.length;$e++)Je(xe.coordinates[$e],Ne);return xe}})(),F=n.cQ(k);class j extends n.cS{constructor(he,fe){super(new n.cM,0,fe,[],[]),this.feature=he,this.type=he.type,this.properties=he.tags?he.tags:{},"id"in he&&(typeof he.id=="string"?this.id=parseInt(he.id,10):typeof he.id!="number"||isNaN(he.id)||(this.id=he.id))}loadGeometry(){let he=[],fe=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(let xe of fe){let Ne=[];for(let $e of xe)Ne.push(new n.P($e[0],$e[1]));he.push(Ne)}return he}}class H extends n.cR{constructor(he,fe){super(new n.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=fe?fe.version:1,this.extent=fe?fe.extent:4096,this.length=he.length,this.features=he}feature(he){return new j(this.features[he],this.extent)}}function W(Je,he){he.writeVarintField(15,Je.version||1),he.writeStringField(1,Je.name||""),he.writeVarintField(5,Je.extent||4096);let fe={keys:[],values:[],keycache:{},valuecache:{}};for(let $e=0;$e<Je.length;$e++)fe.feature=Je.feature($e),he.writeMessage(2,Z,fe);let xe=fe.keys;for(let $e of xe)he.writeStringField(3,$e);let Ne=fe.values;for(let $e of Ne)he.writeMessage(4,Se,$e)}function Z(Je,he){if(!Je.feature)return;let fe=Je.feature;fe.id!==void 0&&he.writeVarintField(1,fe.id),he.writeMessage(2,Y,Je),he.writeVarintField(3,fe.type),he.writeMessage(4,ge,fe)}function Y(Je,he){for(let fe in Je.feature?.properties){let xe=Je.feature.properties[fe],Ne=Je.keycache[fe];if(xe===null)continue;Ne===void 0&&(Je.keys.push(fe),Ne=Je.keys.length-1,Je.keycache[fe]=Ne),he.writeVarint(Ne),typeof xe!="string"&&typeof xe!="boolean"&&typeof xe!="number"&&(xe=JSON.stringify(xe));let $e=typeof xe+":"+xe,tt=Je.valuecache[$e];tt===void 0&&(Je.values.push(xe),tt=Je.values.length-1,Je.valuecache[$e]=tt),he.writeVarint(tt)}}function ee(Je,he){return(he<<3)+(7&Je)}function ce(Je){return Je<<1^Je>>31}function ge(Je,he){let fe=Je.loadGeometry(),xe=Je.type,Ne=0,$e=0;for(let tt of fe){let yt=1;xe===1&&(yt=tt.length),he.writeVarint(ee(1,yt));let it=xe===3?tt.length-1:tt.length;for(let xt=0;xt<it;xt++){xt===1&&xe!==1&&he.writeVarint(ee(2,it-1));let Ft=tt[xt].x-Ne,Ct=tt[xt].y-$e;he.writeVarint(ce(Ft)),he.writeVarint(ce(Ct)),Ne+=Ft,$e+=Ct}Je.type===3&&he.writeVarint(ee(7,1))}}function Se(Je,he){let fe=typeof Je;fe==="string"?he.writeStringField(1,Je):fe==="boolean"?he.writeBooleanField(7,Je):fe==="number"&&(Je%1!=0?he.writeDoubleField(3,Je):Je<0?he.writeSVarintField(6,Je):he.writeVarintField(5,Je))}let ne={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Je=>Je},pe=Math.fround||(ue=new Float32Array(1),Je=>(ue[0]=+Je,ue[0]));var ue;class Le{constructor(he){this.options=Object.assign(Object.create(ne),he),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(he){let{log:fe,minZoom:xe,maxZoom:Ne}=this.options;fe&&console.time("total time");let $e=`prepare ${he.length} points`;fe&&console.time($e),this.points=he;let tt=[];for(let it=0;it<he.length;it++){let xt=he[it];if(!xt.geometry)continue;let[Ft,Ct]=xt.geometry.coordinates,vr=pe(rt(Ft)),lt=pe(at(Ct));tt.push(vr,lt,1/0,it,-1,1),this.options.reduce&&tt.push(0)}let yt=this.trees[Ne+1]=this._createTree(tt);fe&&console.timeEnd($e);for(let it=Ne;it>=xe;it--){let xt=+Date.now();yt=this.trees[it]=this._createTree(this._cluster(yt,it)),fe&&console.log("z%d: %d clusters in %dms",it,yt.numItems,+Date.now()-xt)}return fe&&console.timeEnd("total time"),this}getClusters(he,fe){let xe=((he[0]+180)%360+360)%360-180,Ne=Math.max(-90,Math.min(90,he[1])),$e=he[2]===180?180:((he[2]+180)%360+360)%360-180,tt=Math.max(-90,Math.min(90,he[3]));if(he[2]-he[0]>=360)xe=-180,$e=180;else if(xe>$e){let Ct=this.getClusters([xe,Ne,180,tt],fe),vr=this.getClusters([-180,Ne,$e,tt],fe);return Ct.concat(vr)}let yt=this.trees[this._limitZoom(fe)],it=yt.range(rt(xe),at(tt),rt($e),at(Ne)),xt=yt.data,Ft=[];for(let Ct of it){let vr=this.stride*Ct;Ft.push(xt[vr+5]>1?We(xt,vr,this.clusterProps):this.points[xt[vr+3]])}return Ft}getChildren(he){let fe=this._getOriginId(he),xe=this._getOriginZoom(he),Ne="No cluster with the specified id.",$e=this.trees[xe];if(!$e)throw new Error(Ne);let tt=$e.data;if(fe*this.stride>=tt.length)throw new Error(Ne);let yt=this.options.radius/(this.options.extent*Math.pow(2,xe-1)),it=$e.within(tt[fe*this.stride],tt[fe*this.stride+1],yt),xt=[];for(let Ft of it){let Ct=Ft*this.stride;tt[Ct+4]===he&&xt.push(tt[Ct+5]>1?We(tt,Ct,this.clusterProps):this.points[tt[Ct+3]])}if(xt.length===0)throw new Error(Ne);return xt}getLeaves(he,fe,xe){let Ne=[];return this._appendLeaves(Ne,he,fe=fe||10,xe=xe||0,0),Ne}getTile(he,fe,xe){let Ne=this.trees[this._limitZoom(he)],$e=Math.pow(2,he),{extent:tt,radius:yt}=this.options,it=yt/tt,xt=(xe-it)/$e,Ft=(xe+1+it)/$e,Ct={features:[]};return this._addTileFeatures(Ne.range((fe-it)/$e,xt,(fe+1+it)/$e,Ft),Ne.data,fe,xe,$e,Ct),fe===0&&this._addTileFeatures(Ne.range(1-it/$e,xt,1,Ft),Ne.data,$e,xe,$e,Ct),fe===$e-1&&this._addTileFeatures(Ne.range(0,xt,it/$e,Ft),Ne.data,-1,xe,$e,Ct),Ct.features.length?Ct:null}getClusterExpansionZoom(he){let fe=this._getOriginZoom(he)-1;for(;fe<=this.options.maxZoom;){let xe=this.getChildren(he);if(fe++,xe.length!==1)break;he=xe[0].properties.cluster_id}return fe}_appendLeaves(he,fe,xe,Ne,$e){let tt=this.getChildren(fe);for(let yt of tt){let it=yt.properties;if(it&&it.cluster?$e+it.point_count<=Ne?$e+=it.point_count:$e=this._appendLeaves(he,it.cluster_id,xe,Ne,$e):$e<Ne?$e++:he.push(yt),he.length===xe)break}return $e}_createTree(he){let fe=new n.aI(he.length/this.stride|0,this.options.nodeSize,Float32Array);for(let xe=0;xe<he.length;xe+=this.stride)fe.add(he[xe],he[xe+1]);return fe.finish(),fe.data=he,fe}_addTileFeatures(he,fe,xe,Ne,$e,tt){for(let yt of he){let it=yt*this.stride,xt=fe[it+5]>1,Ft,Ct,vr;if(xt)Ft=ze(fe,it,this.clusterProps),Ct=fe[it],vr=fe[it+1];else{let jn=this.points[fe[it+3]];Ft=jn.properties;let[wr,di]=jn.geometry.coordinates;Ct=rt(wr),vr=at(di)}let lt={type:1,geometry:[[Math.round(this.options.extent*(Ct*$e-xe)),Math.round(this.options.extent*(vr*$e-Ne))]],tags:Ft},Ei;Ei=xt||this.options.generateId?fe[it+3]:this.points[fe[it+3]].id,Ei!==void 0&&(lt.id=Ei),tt.features.push(lt)}}_limitZoom(he){return Math.max(this.options.minZoom,Math.min(Math.floor(+he),this.options.maxZoom+1))}_cluster(he,fe){let{radius:xe,extent:Ne,reduce:$e,minPoints:tt}=this.options,yt=xe/(Ne*Math.pow(2,fe)),it=he.data,xt=[],Ft=this.stride;for(let Ct=0;Ct<it.length;Ct+=Ft){if(it[Ct+2]<=fe)continue;it[Ct+2]=fe;let vr=it[Ct],lt=it[Ct+1],Ei=he.within(it[Ct],it[Ct+1],yt),jn=it[Ct+5],wr=jn;for(let di of Ei){let rn=di*Ft;it[rn+2]>fe&&(wr+=it[rn+5])}if(wr>jn&&wr>=tt){let di,rn=vr*jn,Jo=lt*jn,Lt=-1,Ws=(Ct/Ft<<5)+(fe+1)+this.points.length;for(let ko of Ei){let Zn=ko*Ft;if(it[Zn+2]<=fe)continue;it[Zn+2]=fe;let Vo=it[Zn+5];rn+=it[Zn]*Vo,Jo+=it[Zn+1]*Vo,it[Zn+4]=Ws,$e&&(di||(di=this._map(it,Ct,!0),Lt=this.clusterProps.length,this.clusterProps.push(di)),$e(di,this._map(it,Zn)))}it[Ct+4]=Ws,xt.push(rn/wr,Jo/wr,1/0,Ws,-1,wr),$e&&xt.push(Lt)}else{for(let di=0;di<Ft;di++)xt.push(it[Ct+di]);if(wr>1)for(let di of Ei){let rn=di*Ft;if(!(it[rn+2]<=fe)){it[rn+2]=fe;for(let Jo=0;Jo<Ft;Jo++)xt.push(it[rn+Jo])}}}}return xt}_getOriginId(he){return he-this.points.length>>5}_getOriginZoom(he){return(he-this.points.length)%32}_map(he,fe,xe){if(he[fe+5]>1){let tt=this.clusterProps[he[fe+6]];return xe?Object.assign({},tt):tt}let Ne=this.points[he[fe+3]].properties,$e=this.options.map(Ne);return xe&&$e===Ne?Object.assign({},$e):$e}}function We(Je,he,fe){return{type:"Feature",id:Je[he+3],properties:ze(Je,he,fe),geometry:{type:"Point",coordinates:[(xe=Je[he],360*(xe-.5)),Wt(Je[he+1])]}};var xe}function ze(Je,he,fe){let xe=Je[he+5],Ne=xe>=1e4?`${Math.round(xe/1e3)}k`:xe>=1e3?Math.round(xe/100)/10+"k":xe,$e=Je[he+6],tt=$e===-1?{}:Object.assign({},fe[$e]);return Object.assign(tt,{cluster:!0,cluster_id:Je[he+3],point_count:xe,point_count_abbreviated:Ne})}function rt(Je){return Je/360+.5}function at(Je){let he=Math.sin(Je*Math.PI/180),fe=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return fe<0?0:fe>1?1:fe}function Wt(Je){let he=(180-360*Je)*Math.PI/180;return 360*Math.atan(Math.exp(he))/Math.PI-90}function It(Je,he,fe,xe){let Ne=xe,$e=he+(fe-he>>1),tt,yt=fe-he,it=Je[he],xt=Je[he+1],Ft=Je[fe],Ct=Je[fe+1];for(let vr=he+3;vr<fe;vr+=3){let lt=Bt(Je[vr],Je[vr+1],it,xt,Ft,Ct);if(lt>Ne)tt=vr,Ne=lt;else if(lt===Ne){let Ei=Math.abs(vr-$e);Ei<yt&&(tt=vr,yt=Ei)}}Ne>xe&&(tt-he>3&&It(Je,he,tt,xe),Je[tt+2]=Ne,fe-tt>3&&It(Je,tt,fe,xe))}function Bt(Je,he,fe,xe,Ne,$e){let tt=Ne-fe,yt=$e-xe;if(tt!==0||yt!==0){let it=((Je-fe)*tt+(he-xe)*yt)/(tt*tt+yt*yt);it>1?(fe=Ne,xe=$e):it>0&&(fe+=tt*it,xe+=yt*it)}return tt=Je-fe,yt=he-xe,tt*tt+yt*yt}function Qt(Je,he,fe,xe){let Ne={id:Je??null,type:he,geometry:fe,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(he==="Point"||he==="MultiPoint"||he==="LineString")hr(Ne,fe);else if(he==="Polygon")hr(Ne,fe[0]);else if(he==="MultiLineString")for(let $e of fe)hr(Ne,$e);else if(he==="MultiPolygon")for(let $e of fe)hr(Ne,$e[0]);return Ne}function hr(Je,he){for(let fe=0;fe<he.length;fe+=3)Je.minX=Math.min(Je.minX,he[fe]),Je.minY=Math.min(Je.minY,he[fe+1]),Je.maxX=Math.max(Je.maxX,he[fe]),Je.maxY=Math.max(Je.maxY,he[fe+1])}function nt(Je,he,fe,xe){if(!he.geometry)return;let Ne=he.geometry.coordinates;if(Ne&&Ne.length===0)return;let $e=he.geometry.type,tt=Math.pow(fe.tolerance/((1<<fe.maxZoom)*fe.extent),2),yt=[],it=he.id;if(fe.promoteId?it=he.properties[fe.promoteId]:fe.generateId&&(it=xe||0),$e==="Point")Et(Ne,yt);else if($e==="MultiPoint")for(let xt of Ne)Et(xt,yt);else if($e==="LineString")yr(Ne,yt,tt,!1);else if($e==="MultiLineString"){if(fe.lineMetrics){for(let xt of Ne)yt=[],yr(xt,yt,tt,!1),Je.push(Qt(it,"LineString",yt,he.properties));return}xr(Ne,yt,tt,!1)}else if($e==="Polygon")xr(Ne,yt,tt,!0);else{if($e!=="MultiPolygon"){if($e==="GeometryCollection"){for(let xt of he.geometry.geometries)nt(Je,{id:it,geometry:xt,properties:he.properties},fe,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let xt of Ne){let Ft=[];xr(xt,Ft,tt,!0),yt.push(Ft)}}Je.push(Qt(it,$e,yt,he.properties))}function Et(Je,he){he.push(oi(Je[0]),jr(Je[1]),0)}function yr(Je,he,fe,xe){let Ne,$e,tt=0;for(let it=0;it<Je.length;it++){let xt=oi(Je[it][0]),Ft=jr(Je[it][1]);he.push(xt,Ft,0),it>0&&(tt+=xe?(Ne*Ft-xt*$e)/2:Math.sqrt(Math.pow(xt-Ne,2)+Math.pow(Ft-$e,2))),Ne=xt,$e=Ft}let yt=he.length-3;he[2]=1,It(he,0,yt,fe),he[yt+2]=1,he.size=Math.abs(tt),he.start=0,he.end=he.size}function xr(Je,he,fe,xe){for(let Ne=0;Ne<Je.length;Ne++){let $e=[];yr(Je[Ne],$e,fe,xe),he.push($e)}}function oi(Je){return Je/360+.5}function jr(Je){let he=Math.sin(Je*Math.PI/180),fe=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return fe<0?0:fe>1?1:fe}function zi(Je,he,fe,xe,Ne,$e,tt,yt){if(xe/=he,$e>=(fe/=he)&&tt<xe)return Je;if(tt<fe||$e>=xe)return null;let it=[];for(let xt of Je){let Ft=xt.geometry,Ct=xt.type,vr=Ne===0?xt.minX:xt.minY,lt=Ne===0?xt.maxX:xt.maxY;if(vr>=fe&&lt<xe){it.push(xt);continue}if(lt<fe||vr>=xe)continue;let Ei=[];if(Ct==="Point"||Ct==="MultiPoint")on(Ft,Ei,fe,xe,Ne);else if(Ct==="LineString")Ki(Ft,Ei,fe,xe,Ne,!1,yt.lineMetrics);else if(Ct==="MultiLineString")_l(Ft,Ei,fe,xe,Ne,!1);else if(Ct==="Polygon")_l(Ft,Ei,fe,xe,Ne,!0);else if(Ct==="MultiPolygon")for(let jn of Ft){let wr=[];_l(jn,wr,fe,xe,Ne,!0),wr.length&&Ei.push(wr)}if(Ei.length){if(yt.lineMetrics&&Ct==="LineString"){for(let jn of Ei)it.push(Qt(xt.id,Ct,jn,xt.tags));continue}Ct!=="LineString"&&Ct!=="MultiLineString"||(Ei.length===1?(Ct="LineString",Ei=Ei[0]):Ct="MultiLineString"),Ct!=="Point"&&Ct!=="MultiPoint"||(Ct=Ei.length===3?"Point":"MultiPoint"),it.push(Qt(xt.id,Ct,Ei,xt.tags))}}return it.length?it:null}function on(Je,he,fe,xe,Ne){for(let $e=0;$e<Je.length;$e+=3){let tt=Je[$e+Ne];tt>=fe&&tt<=xe&&xn(he,Je[$e],Je[$e+1],Je[$e+2])}}function Ki(Je,he,fe,xe,Ne,$e,tt){let yt=hn(Je),it=Ne===0?dn:Pa,xt,Ft,Ct=Je.start;for(let wr=0;wr<Je.length-3;wr+=3){let di=Je[wr],rn=Je[wr+1],Jo=Je[wr+2],Lt=Je[wr+3],Ws=Je[wr+4],ko=Ne===0?di:rn,Zn=Ne===0?Lt:Ws,Vo=!1;tt&&(xt=Math.sqrt(Math.pow(di-Lt,2)+Math.pow(rn-Ws,2))),ko<fe?Zn>fe&&(Ft=it(yt,di,rn,Lt,Ws,fe),tt&&(yt.start=Ct+xt*Ft)):ko>xe?Zn<xe&&(Ft=it(yt,di,rn,Lt,Ws,xe),tt&&(yt.start=Ct+xt*Ft)):xn(yt,di,rn,Jo),Zn<fe&&ko>=fe&&(Ft=it(yt,di,rn,Lt,Ws,fe),Vo=!0),Zn>xe&&ko<=xe&&(Ft=it(yt,di,rn,Lt,Ws,xe),Vo=!0),!$e&&Vo&&(tt&&(yt.end=Ct+xt*Ft),he.push(yt),yt=hn(Je)),tt&&(Ct+=xt)}let vr=Je.length-3,lt=Je[vr],Ei=Je[vr+1],jn=Ne===0?lt:Ei;jn>=fe&&jn<=xe&&xn(yt,lt,Ei,Je[vr+2]),vr=yt.length-3,$e&&vr>=3&&(yt[vr]!==yt[0]||yt[vr+1]!==yt[1])&&xn(yt,yt[0],yt[1],yt[2]),yt.length&&he.push(yt)}function hn(Je){let he=[];return he.size=Je.size,he.start=Je.start,he.end=Je.end,he}function _l(Je,he,fe,xe,Ne,$e){for(let tt of Je)Ki(tt,he,fe,xe,Ne,$e,!1)}function xn(Je,he,fe,xe){Je.push(he,fe,xe)}function dn(Je,he,fe,xe,Ne,$e){let tt=($e-he)/(xe-he);return xn(Je,$e,fe+(Ne-fe)*tt,1),tt}function Pa(Je,he,fe,xe,Ne,$e){let tt=($e-fe)/(Ne-fe);return xn(Je,he+(xe-he)*tt,$e,1),tt}function vl(Je,he){let fe=[];for(let xe=0;xe<Je.length;xe++){let Ne=Je[xe],$e=Ne.type,tt;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")tt=cs(Ne.geometry,he);else if($e==="MultiLineString"||$e==="Polygon"){tt=[];for(let yt of Ne.geometry)tt.push(cs(yt,he))}else if($e==="MultiPolygon"){tt=[];for(let yt of Ne.geometry){let it=[];for(let xt of yt)it.push(cs(xt,he));tt.push(it)}}fe.push(Qt(Ne.id,$e,tt,Ne.tags))}return fe}function cs(Je,he){let fe=[];fe.size=Je.size,Je.start!==void 0&&(fe.start=Je.start,fe.end=Je.end);for(let xe=0;xe<Je.length;xe+=3)fe.push(Je[xe]+he,Je[xe+1],Je[xe+2]);return fe}function Ss(Je,he){if(Je.transformed)return Je;let fe=1<<Je.z,xe=Je.x,Ne=Je.y;for(let $e of Je.features){let tt=$e.geometry,yt=$e.type;if($e.geometry=[],yt===1)for(let it=0;it<tt.length;it+=2)$e.geometry.push(Wl(tt[it],tt[it+1],he,fe,xe,Ne));else for(let it=0;it<tt.length;it++){let xt=[];for(let Ft=0;Ft<tt[it].length;Ft+=2)xt.push(Wl(tt[it][Ft],tt[it][Ft+1],he,fe,xe,Ne));$e.geometry.push(xt)}}return Je.transformed=!0,Je}function Wl(Je,he,fe,xe,Ne,$e){return[Math.round(fe*(Je*xe-Ne)),Math.round(fe*(he*xe-$e))]}function Gl(Je,he,fe,xe,Ne){let $e=he===Ne.maxZoom?0:Ne.tolerance/((1<<he)*Ne.extent),tt={features:[],numPoints:0,numSimplified:0,numFeatures:Je.length,source:null,x:fe,y:xe,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let yt of Je)_c(tt,yt,$e,Ne);return tt}function _c(Je,he,fe,xe){let Ne=he.geometry,$e=he.type,tt=[];if(Je.minX=Math.min(Je.minX,he.minX),Je.minY=Math.min(Je.minY,he.minY),Je.maxX=Math.max(Je.maxX,he.maxX),Je.maxY=Math.max(Je.maxY,he.maxY),$e==="Point"||$e==="MultiPoint")for(let yt=0;yt<Ne.length;yt+=3)tt.push(Ne[yt],Ne[yt+1]),Je.numPoints++,Je.numSimplified++;else if($e==="LineString")us(tt,Ne,Je,fe,!1,!1);else if($e==="MultiLineString"||$e==="Polygon")for(let yt=0;yt<Ne.length;yt++)us(tt,Ne[yt],Je,fe,$e==="Polygon",yt===0);else if($e==="MultiPolygon")for(let yt=0;yt<Ne.length;yt++){let it=Ne[yt];for(let xt=0;xt<it.length;xt++)us(tt,it[xt],Je,fe,!0,xt===0)}if(tt.length){let yt=he.tags||null;if($e==="LineString"&&xe.lineMetrics){yt={};for(let xt in he.tags)yt[xt]=he.tags[xt];yt.mapbox_clip_start=Ne.start/Ne.size,yt.mapbox_clip_end=Ne.end/Ne.size}let it={geometry:tt,type:$e==="Polygon"||$e==="MultiPolygon"?3:$e==="LineString"||$e==="MultiLineString"?2:1,tags:yt};he.id!==null&&(it.id=he.id),Je.features.push(it)}}function us(Je,he,fe,xe,Ne,$e){let tt=xe*xe;if(xe>0&&he.size<(Ne?tt:xe))return void(fe.numPoints+=he.length/3);let yt=[];for(let it=0;it<he.length;it+=3)(xe===0||he[it+2]>tt)&&(fe.numSimplified++,yt.push(he[it],he[it+1])),fe.numPoints++;Ne&&(function(it,xt){let Ft=0;for(let Ct=0,vr=it.length,lt=vr-2;Ct<vr;lt=Ct,Ct+=2)Ft+=(it[Ct]-it[lt])*(it[Ct+1]+it[lt+1]);if(Ft>0===xt)for(let Ct=0,vr=it.length;Ct<vr/2;Ct+=2){let lt=it[Ct],Ei=it[Ct+1];it[Ct]=it[vr-2-Ct],it[Ct+1]=it[vr-1-Ct],it[vr-2-Ct]=lt,it[vr-1-Ct]=Ei}})(yt,$e),Je.push(yt)}let $s={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class vc{constructor(he,fe){let xe=(fe=this.options=(function($e,tt){for(let yt in tt)$e[yt]=tt[yt];return $e})(Object.create($s),fe)).debug;if(xe&&console.time("preprocess data"),fe.maxZoom<0||fe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(fe.promoteId&&fe.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ne=(function($e,tt){let yt=[];if($e.type==="FeatureCollection")for(let it=0;it<$e.features.length;it++)nt(yt,$e.features[it],tt,it);else nt(yt,$e.type==="Feature"?$e:{geometry:$e},tt);return yt})(he,fe);this.tiles={},this.tileCoords=[],xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",fe.indexMaxZoom,fe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=(function($e,tt){let yt=tt.buffer/tt.extent,it=$e,xt=zi($e,1,-1-yt,yt,0,-1,2,tt),Ft=zi($e,1,1-yt,2+yt,0,-1,2,tt);return(xt||Ft)&&(it=zi($e,1,-yt,1+yt,0,-1,2,tt)||[],xt&&(it=vl(xt,1).concat(it)),Ft&&(it=it.concat(vl(Ft,-1)))),it})(Ne,fe),Ne.length&&this.splitTile(Ne,0,0,0),xe&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(he,fe,xe,Ne,$e,tt,yt){let it=[he,fe,xe,Ne],xt=this.options,Ft=xt.debug;for(;it.length;){Ne=it.pop(),xe=it.pop(),fe=it.pop(),he=it.pop();let Ct=1<<fe,vr=bl(fe,xe,Ne),lt=this.tiles[vr];if(!lt&&(Ft>1&&console.time("creation"),lt=this.tiles[vr]=Gl(he,fe,xe,Ne,xt),this.tileCoords.push({z:fe,x:xe,y:Ne}),Ft)){Ft>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",fe,xe,Ne,lt.numFeatures,lt.numPoints,lt.numSimplified),console.timeEnd("creation"));let Vo=`z${fe}`;this.stats[Vo]=(this.stats[Vo]||0)+1,this.total++}if(lt.source=he,$e==null){if(fe===xt.indexMaxZoom||lt.numPoints<=xt.indexMaxPoints)continue}else{if(fe===xt.maxZoom||fe===$e)continue;if($e!=null){let Vo=$e-fe;if(xe!==tt>>Vo||Ne!==yt>>Vo)continue}}if(lt.source=null,he.length===0)continue;Ft>1&&console.time("clipping");let Ei=.5*xt.buffer/xt.extent,jn=.5-Ei,wr=.5+Ei,di=1+Ei,rn=null,Jo=null,Lt=null,Ws=null,ko=zi(he,Ct,xe-Ei,xe+wr,0,lt.minX,lt.maxX,xt),Zn=zi(he,Ct,xe+jn,xe+di,0,lt.minX,lt.maxX,xt);he=null,ko&&(rn=zi(ko,Ct,Ne-Ei,Ne+wr,1,lt.minY,lt.maxY,xt),Jo=zi(ko,Ct,Ne+jn,Ne+di,1,lt.minY,lt.maxY,xt),ko=null),Zn&&(Lt=zi(Zn,Ct,Ne-Ei,Ne+wr,1,lt.minY,lt.maxY,xt),Ws=zi(Zn,Ct,Ne+jn,Ne+di,1,lt.minY,lt.maxY,xt),Zn=null),Ft>1&&console.timeEnd("clipping"),it.push(rn||[],fe+1,2*xe,2*Ne),it.push(Jo||[],fe+1,2*xe,2*Ne+1),it.push(Lt||[],fe+1,2*xe+1,2*Ne),it.push(Ws||[],fe+1,2*xe+1,2*Ne+1)}}getTile(he,fe,xe){he=+he,fe=+fe,xe=+xe;let Ne=this.options,{extent:$e,debug:tt}=Ne;if(he<0||he>24)return null;let yt=1<<he,it=bl(he,fe=fe+yt&yt-1,xe);if(this.tiles[it])return Ss(this.tiles[it],$e);tt>1&&console.log("drilling down to z%d-%d-%d",he,fe,xe);let xt,Ft=he,Ct=fe,vr=xe;for(;!xt&&Ft>0;)Ft--,Ct>>=1,vr>>=1,xt=this.tiles[bl(Ft,Ct,vr)];return xt&&xt.source?(tt>1&&(console.log("found parent tile z%d-%d-%d",Ft,Ct,vr),console.time("drilling down")),this.splitTile(xt.source,Ft,Ct,vr,he,fe,xe),tt>1&&console.timeEnd("drilling down"),this.tiles[it]?Ss(this.tiles[it],$e):null):null}}function bl(Je,he,fe){return 32*((1<<Je)*fe+he)+Je}class rm extends p{constructor(he,fe,xe,Ne=Ia){super(he,fe,xe),this._dataUpdateable=new Map,this._createGeoJSONIndex=Ne}loadVectorTile(he,fe){return n._(this,void 0,void 0,(function*(){let xe=he.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let Ne=this._geoJSONIndex.getTile(xe.z,xe.x,xe.y);if(!Ne)return null;let $e=new H(Ne.features,{version:2,extent:n.$}),tt=(function(yt){let it=new n.cM;return(function(xt,Ft){for(let Ct in xt.layers)Ft.writeMessage(3,W,xt.layers[Ct])})(yt,it),it.finish()})($e);return tt.byteOffset===0&&tt.byteLength===tt.buffer.byteLength||(tt=new Uint8Array(tt)),{vectorTile:$e,rawData:tt.buffer}}))}loadData(he){return n._(this,void 0,void 0,(function*(){var fe;(fe=this._pendingRequest)===null||fe===void 0||fe.abort();let xe=!!(he&&he.request&&he.request.collectResourceTiming)&&new n.cN(he.request);this._pendingRequest=new AbortController;try{(!this._pendingData||he.request||he.data||he.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(he,this._pendingRequest));let Ne=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Ne,he),this.loaded={};let $e={data:Ne};if(xe){let tt=xe.finish();tt&&($e.resourceTiming={},$e.resourceTiming[he.source]=JSON.parse(JSON.stringify(tt)))}return $e}catch(Ne){if(delete this._pendingRequest,n.cy(Ne))return{abandoned:!0};throw Ne}}))}getData(){return n._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(he){let fe=this.loaded;return fe&&fe[he.uid]?super.reloadTile(he):this.loadTile(he)}loadAndProcessGeoJSON(he,fe){return n._(this,void 0,void 0,(function*(){let xe=yield this.loadGeoJSON(he,fe);if(delete this._pendingRequest,typeof xe!="object")throw new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`);if(F(xe,!0),he.filter){let Ne=n.cT(he.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map((tt=>`${tt.key}: ${tt.message}`)).join(", "));xe={type:"FeatureCollection",features:xe.features.filter((tt=>Ne.value.evaluate({zoom:0},tt)))}}return xe}))}loadGeoJSON(he,fe){return n._(this,void 0,void 0,(function*(){let{promoteId:xe}=he;if(he.request){let Ne=yield n.j(he.request,fe);return this._dataUpdateable=n.cV(Ne.data,xe)?n.cU(Ne.data,xe):void 0,Ne.data}if(typeof he.data=="string")try{let Ne=JSON.parse(he.data);return this._dataUpdateable=n.cV(Ne,xe)?n.cU(Ne,xe):void 0,Ne}catch{throw new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`)}if(!he.dataDiff)throw new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${he.source}`);return n.cW(this._dataUpdateable,he.dataDiff,xe),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(he){return n._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(he){return this._geoJSONIndex.getClusterExpansionZoom(he.clusterId)}getClusterChildren(he){return this._geoJSONIndex.getChildren(he.clusterId)}getClusterLeaves(he){return this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset)}}function Ia(Je,he){return he.cluster?new Le((function({superclusterOptions:fe,clusterProperties:xe}){if(!xe||!fe)return fe;let Ne={},$e={},tt={accumulated:null,zoom:0},yt={properties:null},it=Object.keys(xe);for(let xt of it){let[Ft,Ct]=xe[xt],vr=n.cT(Ct),lt=n.cT(typeof Ft=="string"?[Ft,["accumulated"],["get",xt]]:Ft);Ne[xt]=vr.value,$e[xt]=lt.value}return fe.map=xt=>{yt.properties=xt;let Ft={};for(let Ct of it)Ft[Ct]=Ne[Ct].evaluate(tt,yt);return Ft},fe.reduce=(xt,Ft)=>{yt.properties=Ft;for(let Ct of it)tt.accumulated=xt[Ct],xt[Ct]=$e[Ct].evaluate(tt,yt)},fe})(he)).load(Je.features):(function(fe,xe){return new vc(fe,xe)})(Je,he.geojsonVtOptions)}class Hl{constructor(he){this.self=he,this.actor=new n.J(he),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(fe,xe)=>{if(this.externalWorkerSourceTypes[fe])throw new Error(`Worker source with name "${fe}" already registered.`);this.externalWorkerSourceTypes[fe]=xe},this.self.addProtocol=n.cA,this.self.removeProtocol=n.cB,this.self.registerRTLTextPlugin=fe=>{n.cX.setMethods(fe)},this.actor.registerMessageHandler("LDT",((fe,xe)=>this._getDEMWorkerSource(fe,xe.source).loadTile(xe))),this.actor.registerMessageHandler("RDT",((fe,xe)=>n._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(fe,xe.source).removeTile(xe)})))),this.actor.registerMessageHandler("GCEZ",((fe,xe)=>n._(this,void 0,void 0,(function*(){return this._getWorkerSource(fe,xe.type,xe.source).getClusterExpansionZoom(xe)})))),this.actor.registerMessageHandler("GCC",((fe,xe)=>n._(this,void 0,void 0,(function*(){return this._getWorkerSource(fe,xe.type,xe.source).getClusterChildren(xe)})))),this.actor.registerMessageHandler("GCL",((fe,xe)=>n._(this,void 0,void 0,(function*(){return this._getWorkerSource(fe,xe.type,xe.source).getClusterLeaves(xe)})))),this.actor.registerMessageHandler("LD",((fe,xe)=>this._getWorkerSource(fe,xe.type,xe.source).loadData(xe))),this.actor.registerMessageHandler("GD",((fe,xe)=>this._getWorkerSource(fe,xe.type,xe.source).getData())),this.actor.registerMessageHandler("LT",((fe,xe)=>this._getWorkerSource(fe,xe.type,xe.source).loadTile(xe))),this.actor.registerMessageHandler("RT",((fe,xe)=>this._getWorkerSource(fe,xe.type,xe.source).reloadTile(xe))),this.actor.registerMessageHandler("AT",((fe,xe)=>this._getWorkerSource(fe,xe.type,xe.source).abortTile(xe))),this.actor.registerMessageHandler("RMT",((fe,xe)=>this._getWorkerSource(fe,xe.type,xe.source).removeTile(xe))),this.actor.registerMessageHandler("RS",((fe,xe)=>n._(this,void 0,void 0,(function*(){if(!this.workerSources[fe]||!this.workerSources[fe][xe.type]||!this.workerSources[fe][xe.type][xe.source])return;let Ne=this.workerSources[fe][xe.type][xe.source];delete this.workerSources[fe][xe.type][xe.source],Ne.removeSource!==void 0&&Ne.removeSource(xe)})))),this.actor.registerMessageHandler("RM",(fe=>n._(this,void 0,void 0,(function*(){delete this.layerIndexes[fe],delete this.availableImages[fe],delete this.workerSources[fe],delete this.demWorkerSources[fe],this.globalStates.delete(fe)})))),this.actor.registerMessageHandler("SR",((fe,xe)=>n._(this,void 0,void 0,(function*(){this.referrer=xe})))),this.actor.registerMessageHandler("SRPS",((fe,xe)=>this._syncRTLPluginState(fe,xe))),this.actor.registerMessageHandler("IS",((fe,xe)=>n._(this,void 0,void 0,(function*(){this.self.importScripts(xe)})))),this.actor.registerMessageHandler("SI",((fe,xe)=>this._setImages(fe,xe))),this.actor.registerMessageHandler("UL",((fe,xe)=>n._(this,void 0,void 0,(function*(){this._getLayerIndex(fe).update(xe.layers,xe.removedIds,this._getGlobalState(fe))})))),this.actor.registerMessageHandler("UGS",((fe,xe)=>n._(this,void 0,void 0,(function*(){let Ne=this._getGlobalState(fe);for(let $e in xe)Ne[$e]=xe[$e]})))),this.actor.registerMessageHandler("SL",((fe,xe)=>n._(this,void 0,void 0,(function*(){this._getLayerIndex(fe).replace(xe,this._getGlobalState(fe))}))))}_getGlobalState(he){let fe=this.globalStates.get(he);return fe||(fe={},this.globalStates.set(he,fe)),fe}_setImages(he,fe){return n._(this,void 0,void 0,(function*(){this.availableImages[he]=fe;for(let xe in this.workerSources[he]){let Ne=this.workerSources[he][xe];for(let $e in Ne)Ne[$e].availableImages=fe}}))}_syncRTLPluginState(he,fe){return n._(this,void 0,void 0,(function*(){return yield n.cX.syncState(fe,this.self.importScripts)}))}_getAvailableImages(he){let fe=this.availableImages[he];return fe||(fe=[]),fe}_getLayerIndex(he){let fe=this.layerIndexes[he];return fe||(fe=this.layerIndexes[he]=new o),fe}_getWorkerSource(he,fe,xe){if(this.workerSources[he]||(this.workerSources[he]={}),this.workerSources[he][fe]||(this.workerSources[he][fe]={}),!this.workerSources[he][fe][xe]){let Ne={sendAsync:($e,tt)=>($e.targetMapId=he,this.actor.sendAsync($e,tt))};switch(fe){case"vector":this.workerSources[he][fe][xe]=new p(Ne,this._getLayerIndex(he),this._getAvailableImages(he));break;case"geojson":this.workerSources[he][fe][xe]=new rm(Ne,this._getLayerIndex(he),this._getAvailableImages(he));break;default:this.workerSources[he][fe][xe]=new this.externalWorkerSourceTypes[fe](Ne,this._getLayerIndex(he),this._getAvailableImages(he))}}return this.workerSources[he][fe][xe]}_getDEMWorkerSource(he,fe){return this.demWorkerSources[he]||(this.demWorkerSources[he]={}),this.demWorkerSources[he][fe]||(this.demWorkerSources[he][fe]=new m),this.demWorkerSources[he][fe]}}return n.i(self)&&(self.worker=new Hl(self)),Hl})),r("index",["exports","./shared"],(function(n,o){"use strict";var s="5.10.0";function a(){var C=new o.A(4);return o.A!=Float32Array&&(C[1]=0,C[2]=0),C[0]=1,C[3]=1,C}let u,p,m={frame(C,l,f){let v=requestAnimationFrame((I=>{S(),l(I)})),{unsubscribe:S}=o.s(C.signal,"abort",(()=>{S(),cancelAnimationFrame(v),f(o.c())}),!1)},frameAsync(C){return new Promise(((l,f)=>{this.frame(C,l,f)}))},getImageData(C,l=0){return this.getImageCanvasContext(C).getImageData(-l,-l,C.width+2*l,C.height+2*l)},getImageCanvasContext(C){let l=window.document.createElement("canvas"),f=l.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return l.width=C.width,l.height=C.height,f.drawImage(C,0,0,C.width,C.height),f},resolveURL:C=>(u||(u=document.createElement("a")),u.href=C,u.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(p==null&&(p=matchMedia("(prefers-reduced-motion: reduce)")),p.matches)}},x=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(C){this._frozenAt=C}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function M(){return x.getCurrentTime()}class k{static testProp(l){if(!k.docStyle)return l[0];for(let f=0;f<l.length;f++)if(l[f]in k.docStyle)return l[f];return l[0]}static create(l,f,v){let S=window.document.createElement(l);return f!==void 0&&(S.className=f),v&&v.appendChild(S),S}static createNS(l,f){return window.document.createElementNS(l,f)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(l,f){l.style[k.transformProp]=f}static addEventListener(l,f,v,S={}){l.addEventListener(f,v,"passive"in S?S:S.capture)}static removeEventListener(l,f,v,S={}){l.removeEventListener(f,v,"passive"in S?S:S.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",k.suppressClickInternal,!0)}),0)}static getScale(l){let f=l.getBoundingClientRect();return{x:f.width/l.offsetWidth||1,y:f.height/l.offsetHeight||1,boundingClientRect:f}}static getPoint(l,f,v){let S=f.boundingClientRect;return new o.P((v.clientX-S.left)/f.x-l.clientLeft,(v.clientY-S.top)/f.y-l.clientTop)}static mousePos(l,f){let v=k.getScale(l);return k.getPoint(l,v,f)}static touchPos(l,f){let v=[],S=k.getScale(l);for(let I=0;I<f.length;I++)v.push(k.getPoint(l,S,f[I]));return v}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}static sanitize(l){let f=new DOMParser().parseFromString(l,"text/html").body||document.createElement("body"),v=f.querySelectorAll("script");for(let S of v)S.remove();return k.clean(f),f.innerHTML}static isPossiblyDangerous(l,f){let v=f.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(l)||!v.includes("javascript:")&&!v.includes("data:"))||!!l.startsWith("on")||void 0}static clean(l){let f=l.children;for(let v of f)k.removeAttributes(v),k.clean(v)}static removeAttributes(l){for(let{name:f,value:v}of l.attributes)k.isPossiblyDangerous(f,v)&&l.removeAttribute(f)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);let F={supported:!1,testSupport:function(C){!W&&H&&(Z?Y(C):j=C)}},j,H,W=!1,Z=!1;function Y(C){let l=C.createTexture();C.bindTexture(C.TEXTURE_2D,l);try{if(C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,H),C.isContextLost())return;F.supported=!0}catch{}C.deleteTexture(l),W=!0}var ee;typeof document<"u"&&(H=document.createElement("img"),H.onload=()=>{j&&Y(j),j=null,Z=!0},H.onerror=()=>{W=!0,j=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(C){let l,f,v,S;C.resetRequestQueue=()=>{l=[],f=0,v=0,S={}},C.addThrottleControl=V=>{let X=v++;return S[X]=V,X},C.removeThrottleControl=V=>{delete S[V],D()},C.getImage=(V,X,Q=!0)=>new Promise(((ie,re)=>{F.supported&&(V.headers||(V.headers={}),V.headers.accept="image/webp,*/*"),o.e(V,{type:"image"}),l.push({abortController:X,requestParameters:V,supportImageRefresh:Q,state:"queued",onError:ae=>{re(ae)},onSuccess:ae=>{ie(ae)}}),D()}));let I=V=>o._(this,void 0,void 0,(function*(){V.state="running";let{requestParameters:X,supportImageRefresh:Q,onError:ie,onSuccess:re,abortController:ae}=V,Ae=Q===!1&&!o.i(self)&&!o.g(X.url)&&(!X.headers||Object.keys(X.headers).reduce(((Ce,De)=>Ce&&De==="accept"),!0));f++;let Te=Ae?z(X,ae):o.m(X,ae);try{let Ce=yield Te;delete V.abortController,V.state="completed",Ce.data instanceof HTMLImageElement||o.b(Ce.data)?re(Ce):Ce.data&&re({data:yield(Me=Ce.data,typeof createImageBitmap=="function"?o.f(Me):o.h(Me)),cacheControl:Ce.cacheControl,expires:Ce.expires})}catch(Ce){delete V.abortController,ie(Ce)}finally{f--,D()}var Me})),D=()=>{let V=(()=>{for(let X of Object.keys(S))if(S[X]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let X=f;X<V&&l.length>0;X++){let Q=l.shift();Q.abortController.signal.aborted?X--:I(Q)}},z=(V,X)=>new Promise(((Q,ie)=>{let re=new Image,ae=V.url,Ae=V.credentials;Ae&&Ae==="include"?re.crossOrigin="use-credentials":(Ae&&Ae==="same-origin"||!o.d(ae))&&(re.crossOrigin="anonymous"),X.signal.addEventListener("abort",(()=>{re.src="",ie(o.c())})),re.fetchPriority="high",re.onload=()=>{re.onerror=re.onload=null,Q({data:re})},re.onerror=()=>{re.onerror=re.onload=null,X.signal.aborted||ie(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},re.src=ae}))})(ee||(ee={})),ee.resetRequestQueue();class ce{constructor(l){this._transformRequestFn=l??null}transformRequest(l,f){return this._transformRequestFn&&this._transformRequestFn(l,f)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function ge(C){let l=[];if(typeof C=="string")l.push({id:"default",url:C});else if(C&&C.length>0){let f=[];for(let{id:v,url:S}of C){let I=`${v}${S}`;f.indexOf(I)===-1&&(f.push(I),l.push({id:v,url:S}))}}return l}function Se(C,l,f){try{let v=new URL(C);return v.pathname+=`${l}${f}`,v.toString()}catch{throw new Error(`Invalid sprite URL "${C}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ne(C){let{userImage:l}=C;return!!(l&&l.render&&l.render())&&(C.data.replace(new Uint8Array(l.data.buffer)),!0)}class pe extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(let{ids:f,promiseResolve:v}of this.requestors)v(this._getImagesForIds(f));this.requestors=[]}}getImage(l){let f=this.images[l];if(f&&!f.data&&f.spriteData){let v=f.spriteData;f.data=new o.R({width:v.width,height:v.height},v.context.getImageData(v.x,v.y,v.width,v.height).data),f.spriteData=null}return f}addImage(l,f){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,f)&&(this.images[l]=f)}_validate(l,f){let v=!0,S=f.data||f.spriteData;return this._validateStretch(f.stretchX,S&&S.width)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "stretchX" value`))),v=!1),this._validateStretch(f.stretchY,S&&S.height)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "stretchY" value`))),v=!1),this._validateContent(f.content,f)||(this.fire(new o.k(new Error(`Image "${l}" has invalid "content" value`))),v=!1),v}_validateStretch(l,f){if(!l)return!0;let v=0;for(let S of l){if(S[0]<v||S[1]<S[0]||f<S[1])return!1;v=S[1]}return!0}_validateContent(l,f){if(!l)return!0;if(l.length!==4)return!1;let v=f.spriteData,S=v&&v.width||f.data.width,I=v&&v.height||f.data.height;return!(l[0]<0||S<l[0]||l[1]<0||I<l[1]||l[2]<0||S<l[2]||l[3]<0||I<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,f,v=!0){let S=this.getImage(l);if(v&&(S.data.width!==f.data.width||S.data.height!==f.data.height))throw new Error(`size mismatch between old image (${S.data.width}x${S.data.height}) and new image (${f.data.width}x${f.data.height}).`);f.version=S.version+1,this.images[l]=f,this.updatedImages[l]=!0}removeImage(l){let f=this.images[l];delete this.images[l],delete this.patterns[l],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise(((f,v)=>{let S=!0;if(!this.isLoaded())for(let I of l)this.images[I]||(S=!1);this.isLoaded()||S?f(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:f})}))}_getImagesForIds(l){let f={};for(let v of l){let S=this.getImage(v);S||(this.fire(new o.l("styleimagemissing",{id:v})),S=this.getImage(v)),S?f[v]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,textFitWidth:S.textFitWidth,textFitHeight:S.textFitHeight,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:o.w(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return f}getPixelSize(){let{width:l,height:f}=this.atlasImage;return{width:l,height:f}}getPattern(l){let f=this.patterns[l],v=this.getImage(l);if(!v)return null;if(f&&f.position.version===v.version)return f.position;if(f)f.position.version=v.version;else{let S={w:v.data.width+2,h:v.data.height+2,x:0,y:0},I=new o.I(S,v);this.patterns[l]={bin:S,position:I}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){let f=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(l,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){let l=[];for(let I in this.patterns)l.push(this.patterns[I].bin);let{w:f,h:v}=o.p(l),S=this.atlasImage;S.resize({width:f||1,height:v||1});for(let I in this.patterns){let{bin:D}=this.patterns[I],z=D.x+1,V=D.y+1,X=this.getImage(I).data,Q=X.width,ie=X.height;o.R.copy(X,S,{x:0,y:0},{x:z,y:V},{width:Q,height:ie}),o.R.copy(X,S,{x:0,y:ie-1},{x:z,y:V-1},{width:Q,height:1}),o.R.copy(X,S,{x:0,y:0},{x:z,y:V+ie},{width:Q,height:1}),o.R.copy(X,S,{x:Q-1,y:0},{x:z-1,y:V},{width:1,height:ie}),o.R.copy(X,S,{x:0,y:0},{x:z+Q,y:V},{width:1,height:ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(let f of l){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;let v=this.getImage(f);v||o.w(`Image with ID: "${f}" was not found`),ne(v)&&this.updateImage(f,v)}}}let ue=1e20;function Le(C,l,f,v,S,I,D,z,V){for(let X=l;X<l+v;X++)We(C,f*I+X,I,S,D,z,V);for(let X=f;X<f+S;X++)We(C,X*I+l,1,v,D,z,V)}function We(C,l,f,v,S,I,D){I[0]=0,D[0]=-ue,D[1]=ue,S[0]=C[l];for(let z=1,V=0,X=0;z<v;z++){S[z]=C[l+z*f];let Q=z*z;do{let ie=I[V];X=(S[z]-S[ie]+Q-ie*ie)/(z-ie)/2}while(X<=D[V]&&--V>-1);V++,I[V]=z,D[V]=X,D[V+1]=ue}for(let z=0,V=0;z<v;z++){for(;D[V+1]<z;)V++;let X=I[V],Q=z-X;C[l+z*f]=S[X]+Q*Q}}class ze{constructor(l,f,v){this.requestManager=l,this.localIdeographFontFamily=f,this.entries={},this.lang=v}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,(function*(){let f=[];for(let I in l)for(let D of l[I])f.push(this._getAndCacheGlyphsPromise(I,D));let v=yield Promise.all(f),S={};for(let{stack:I,id:D,glyph:z}of v)S[I]||(S[I]={}),S[I][D]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return S}))}_getAndCacheGlyphsPromise(l,f){return o._(this,void 0,void 0,(function*(){let v=this.entries[l];v||(v=this.entries[l]={glyphs:{},requests:{},ranges:{}});let S=v.glyphs[f];if(S!==void 0)return{stack:l,id:f,glyph:S};if(S=this._tinySDF(v,l,f),S)return v.glyphs[f]=S,{stack:l,id:f,glyph:S};let I=Math.floor(f/256);if(256*I>65535)throw new Error("glyphs > 65535 not supported");if(v.ranges[I])return{stack:l,id:f,glyph:S};if(!this.url)throw new Error("glyphsUrl is not set");if(!v.requests[I]){let z=ze.loadGlyphRange(l,I,this.url,this.requestManager);v.requests[I]=z}let D=yield v.requests[I];for(let z in D)this._doesCharSupportLocalGlyph(+z)||(v.glyphs[+z]=D[+z]);return v.ranges[I]=!0,{stack:l,id:f,glyph:D[f]||null}}))}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(l))||o.u["CJK Unified Ideographs"](l)||o.u["Hangul Syllables"](l)||o.u.Hiragana(l)||o.u.Katakana(l)||o.u["CJK Symbols and Punctuation"](l)||o.u["Halfwidth and Fullwidth Forms"](l))}_tinySDF(l,f,v){let S=this.localIdeographFontFamily;if(!S||!this._doesCharSupportLocalGlyph(v))return;let I=l.tinySDF;if(!I){let z="400";/bold/i.test(f)?z="900":/medium/i.test(f)?z="500":/light/i.test(f)&&(z="200"),I=l.tinySDF=new ze.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:S,fontWeight:z})}let D=I.draw(String.fromCharCode(v));return{id:v,bitmap:new o.q({width:D.width||60,height:D.height||60},D.data),metrics:{width:D.glyphWidth/2||24,height:D.glyphHeight/2||24,left:D.glyphLeft/2+.5||0,top:D.glyphTop/2-27.5||-8,advance:D.glyphAdvance/2||24,isDoubleResolution:!0}}}}ze.loadGlyphRange=function(C,l,f,v){return o._(this,void 0,void 0,(function*(){let S=256*l,I=S+255,D=v.transformRequest(f.replace("{fontstack}",C).replace("{range}",`${S}-${I}`),"Glyphs"),z=yield o.n(D,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${l}, ${S}-${I}`);let V={};for(let X of o.o(z.data))V[X.id]=X;return V}))},ze.TinySDF=class{constructor({fontSize:C=24,buffer:l=3,radius:f=8,cutoff:v=.25,fontFamily:S="sans-serif",fontWeight:I="normal",fontStyle:D="normal",lang:z=null}={}){this.buffer=l,this.cutoff=v,this.radius=f,this.lang=z;let V=this.size=C+4*l,X=this._createCanvas(V),Q=this.ctx=X.getContext("2d",{willReadFrequently:!0});Q.font=`${D} ${I} ${C}px ${S}`,Q.textBaseline="alphabetic",Q.textAlign="left",Q.fillStyle="black",this.gridOuter=new Float64Array(V*V),this.gridInner=new Float64Array(V*V),this.f=new Float64Array(V),this.z=new Float64Array(V+1),this.v=new Uint16Array(V)}_createCanvas(C){let l=document.createElement("canvas");return l.width=l.height=C,l}draw(C){let{width:l,actualBoundingBoxAscent:f,actualBoundingBoxDescent:v,actualBoundingBoxLeft:S,actualBoundingBoxRight:I}=this.ctx.measureText(C),D=Math.ceil(f),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(I-S))),V=Math.min(this.size-this.buffer,D+Math.ceil(v)),X=z+2*this.buffer,Q=V+2*this.buffer,ie=Math.max(X*Q,0),re=new Uint8ClampedArray(ie),ae={data:re,width:X,height:Q,glyphWidth:z,glyphHeight:V,glyphTop:D,glyphLeft:0,glyphAdvance:l};if(z===0||V===0)return ae;let{ctx:Ae,buffer:Te,gridInner:Me,gridOuter:Ce}=this;this.lang&&(Ae.lang=this.lang),Ae.clearRect(Te,Te,z,V),Ae.fillText(C,Te,Te+D);let De=Ae.getImageData(Te,Te,z,V);Ce.fill(ue,0,ie),Me.fill(0,0,ie);for(let Ve=0;Ve<V;Ve++)for(let Oe=0;Oe<z;Oe++){let je=De.data[4*(Ve*z+Oe)+3]/255;if(je===0)continue;let He=(Ve+Te)*X+Oe+Te;if(je===1)Ce[He]=0,Me[He]=ue;else{let Be=.5-je;Ce[He]=Be>0?Be*Be:0,Me[He]=Be<0?Be*Be:0}}Le(Ce,0,0,X,Q,X,this.f,this.v,this.z),Le(Me,Te,Te,z,V,X,this.f,this.v,this.z);for(let Ve=0;Ve<ie;Ve++){let Oe=Math.sqrt(Ce[Ve])-Math.sqrt(Me[Ve]);re[Ve]=Math.round(255-255*(Oe/this.radius+this.cutoff))}return ae}};class rt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,f){return o.B(l.expression.evaluate(f))}interpolate(l,f,v){return{x:o.C.number(l.x,f.x,v),y:o.C.number(l.y,f.y,v),z:o.C.number(l.z,f.z,v)}}}let at;class Wt extends o.E{constructor(l){super(),at=at||new o.r({anchor:new o.D(o.v.light.anchor),position:new rt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.t(at,void 0),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,f={}){if(!this._validate(o.x,l,f))for(let v in l){let S=l[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),S):this._transitionable.setValue(v,S)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,v){return(!v||v.validate!==!1)&&o.y(this,l.call(o.z,{value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}let It=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class Bt extends o.E{constructor(l){super(),this._transitionable=new o.t(It,void 0),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0))}setSky(l,f={}){if(!this._validate(o.G,l,f)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let v in l){let S=l[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),S):this._transitionable.setValue(v,S)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,f,v={}){return v?.validate!==!1&&o.y(this,l.call(o.z,o.e({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class Qt{constructor(l,f){this.width=l,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,f){let v=l.join(",")+String(f);return this.dashEntry[v]||(this.dashEntry[v]=this.addDash(l,f)),this.dashEntry[v]}getDashRanges(l,f,v){let S=[],I=l.length%2==1?-l[l.length-1]*v:0,D=l[0]*v,z=!0;S.push({left:I,right:D,isDash:z,zeroLength:l[0]===0});let V=l[0];for(let X=1;X<l.length;X++){z=!z;let Q=l[X];I=V*v,V+=Q,D=V*v,S.push({left:I,right:D,isDash:z,zeroLength:Q===0})}return S}addRoundDash(l,f,v){let S=f/2;for(let I=-v;I<=v;I++){let D=this.width*(this.nextRow+v+I),z=0,V=l[z];for(let X=0;X<this.width;X++){X/V.right>1&&(V=l[++z]);let Q=Math.abs(X-V.left),ie=Math.abs(X-V.right),re=Math.min(Q,ie),ae,Ae=I/v*(S+1);if(V.isDash){let Te=S-Math.abs(Ae);ae=Math.sqrt(re*re+Te*Te)}else ae=S-Math.sqrt(re*re+Ae*Ae);this.data[D+X]=Math.max(0,Math.min(255,ae+128))}}}addRegularDash(l){for(let z=l.length-1;z>=0;--z){let V=l[z],X=l[z+1];V.zeroLength?l.splice(z,1):X&&X.isDash===V.isDash&&(X.left=V.left,l.splice(z,1))}let f=l[0],v=l[l.length-1];f.isDash===v.isDash&&(f.left=v.left-this.width,v.right=f.right+this.width);let S=this.width*this.nextRow,I=0,D=l[I];for(let z=0;z<this.width;z++){z/D.right>1&&(D=l[++I]);let V=Math.abs(z-D.left),X=Math.abs(z-D.right),Q=Math.min(V,X);this.data[S+z]=Math.max(0,Math.min(255,(D.isDash?Q:-Q)+128))}}addDash(l,f){let v=f?7:0,S=2*v+1;if(this.nextRow+S>this.height)return o.w("LineAtlas out of space"),null;let I=0;for(let z=0;z<l.length;z++)I+=l[z];if(I!==0){let z=this.width/I,V=this.getDashRanges(l,this.width,z);f?this.addRoundDash(V,z,v):this.addRegularDash(V)}let D={y:this.nextRow+v,height:2*v,width:I};return this.nextRow+=S,this.dirty=!0,D}bind(l){let f=l.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))}}let hr="maplibre_preloaded_worker_pool";class nt{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<nt.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach((f=>{f.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[hr]}numActive(){return Object.keys(this.active).length}}let Et=Math.floor(m.hardwareConcurrency/2),yr,xr;function oi(){return yr||(yr=new nt),yr}nt.workerCount=o.H(globalThis)?Math.max(Math.min(Et,3),1):1;class jr{constructor(l,f){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=f;let v=this.workerPool.acquire(f);for(let S=0;S<v.length;S++){let I=new o.J(v[S],f);I.name=`Worker ${S}`,this.actors.push(I)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,f){let v=[];for(let S of this.actors)v.push(S.sendAsync({type:l,data:f}));return Promise.all(v)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach((f=>{f.remove()})),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,f){for(let v of this.actors)v.registerMessageHandler(l,f)}}function zi(){return xr||(xr=new jr(oi(),o.K),xr.registerMessageHandler("GR",((C,l,f)=>o.m(l,f)))),xr}function on(C,l){let f=o.L();return o.M(f,f,[1,1,0]),o.N(f,f,[.5*C.width,.5*C.height,1]),C.calculatePosMatrix?o.O(f,f,C.calculatePosMatrix(l.toUnwrapped())):f}function Ki(C,l,f,v,S,I,D){var z;let V=(function(re,ae,Ae){if(re)for(let Te of re){let Me=ae[Te];if(Me&&Me.source===Ae&&Me.type==="fill-extrusion")return!0}else for(let Te in ae){let Me=ae[Te];if(Me.source===Ae&&Me.type==="fill-extrusion")return!0}return!1})((z=S?.layers)!==null&&z!==void 0?z:null,l,C.id),X=I.maxPitchScaleFactor(),Q=C.tilesIn(v,X,V);Q.sort(hn);let ie=[];for(let re of Q)ie.push({wrappedTileID:re.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(l,f,C._state,re.queryGeometry,re.cameraQueryGeometry,re.scale,S,I,X,on(C.transform,re.tileID),D?(ae,Ae)=>D(re.tileID,ae,Ae):void 0)});return(function(re,ae){for(let Ae in re)for(let Te of re[Ae])_l(Te,ae);return re})((function(re){let ae={},Ae={};for(let Te of re){let Me=Te.queryResults,Ce=Te.wrappedTileID,De=Ae[Ce]=Ae[Ce]||{};for(let Ve in Me){let Oe=Me[Ve],je=De[Ve]=De[Ve]||{},He=ae[Ve]=ae[Ve]||[];for(let Be of Oe)je[Be.featureIndex]||(je[Be.featureIndex]=!0,He.push(Be))}}return ae})(ie),C)}function hn(C,l){let f=C.tileID,v=l.tileID;return f.overscaledZ-v.overscaledZ||f.canonical.y-v.canonical.y||f.wrap-v.wrap||f.canonical.x-v.canonical.x}function _l(C,l){let f=C.feature,v=l.getFeatureState(f.layer["source-layer"],f.id);f.source=f.layer.source,f.layer["source-layer"]&&(f.sourceLayer=f.layer["source-layer"]),f.state=v}function xn(C,l,f){return o._(this,void 0,void 0,(function*(){let v=C;if(C.url?v=(yield o.j(l.transformRequest(C.url,"Source"),f)).data:yield m.frameAsync(f),!v)return null;let S=o.Q(o.e(v,C),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in v&&v.vector_layers&&(S.vectorLayerIds=v.vector_layers.map((I=>I.id))),S}))}class dn{constructor(l,f){l&&(f?this.setSouthWest(l).setNorthEast(f):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.S?new o.S(l.lng,l.lat):o.S.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.S?new o.S(l.lng,l.lat):o.S.convert(l),this}extend(l){let f=this._sw,v=this._ne,S,I;if(l instanceof o.S)S=l,I=l;else{if(!(l instanceof dn))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(dn.convert(l)):this.extend(o.S.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.S.convert(l)):this;if(S=l._sw,I=l._ne,!S||!I)return this}return f||v?(f.lng=Math.min(S.lng,f.lng),f.lat=Math.min(S.lat,f.lat),v.lng=Math.max(I.lng,v.lng),v.lat=Math.max(I.lat,v.lat)):(this._sw=new o.S(S.lng,S.lat),this._ne=new o.S(I.lng,I.lat)),this}getCenter(){return new o.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.S(this.getWest(),this.getNorth())}getSouthEast(){return new o.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){let{lng:f,lat:v}=o.S.convert(l),S=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(S=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&S}static convert(l){return l instanceof dn?l:l&&new dn(l)}static fromLngLat(l,f=0){let v=360*f/40075017,S=v/Math.cos(Math.PI/180*l.lat);return new dn(new o.S(l.lng-S,l.lat-v),new o.S(l.lng+S,l.lat+v))}adjustAntiMeridian(){let l=new o.S(this._sw.lng,this._sw.lat),f=new o.S(this._ne.lng,this._ne.lat);return new dn(l,l.lng>f.lng?new o.S(f.lng+360,f.lat):f)}}class Pa{constructor(l,f,v){this.bounds=dn.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=v||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){let f=Math.pow(2,l.z),v=Math.floor(o.V(this.bounds.getWest())*f),S=Math.floor(o.U(this.bounds.getNorth())*f),I=Math.ceil(o.V(this.bounds.getEast())*f),D=Math.ceil(o.U(this.bounds.getSouth())*f);return l.x>=v&&l.x<I&&l.y>=S&&l.y<D}}class vl extends o.E{constructor(l,f,v,S){if(super(),this.id=l,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.Q(f,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let l=yield xn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new Pa(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this._loaded=!0,this.fire(new o.k(l))}}))}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(f,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};v.request.collectResourceTiming=this._collectResourceTiming;let S="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise(((I,D)=>{l.reloadPromise={resolve:I,reject:D}}))}else l.actor=this.dispatcher.getActor(),S="LT";l.abortController=new AbortController;try{let I=yield l.actor.sendAsync({type:S,data:v},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,I)}catch(I){if(delete l.abortController,l.aborted)return;if(I&&I.status!==404)throw I;this._afterTileLoadWorkerResponse(l,null)}}))}_afterTileLoadWorkerResponse(l,f){if(f&&f.resourceTiming&&(l.resourceTiming=f.resourceTiming),f&&this.map._refreshExpiredTiles&&l.setExpiryData(f),l.loadVectorData(f,this.map.painter),l.reloadPromise){let v=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(v.resolve).catch(v.reject)}}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class cs extends o.E{constructor(l,f,v,S){super(),this.id=l,this.dispatcher=v,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},f),o.e(this,o.Q(f,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(l=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let f=yield xn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,f&&(o.e(this,f),f.bounds&&(this.tileBounds=new Pa(f.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:l})))}catch(f){this._tileJSONRequest=null,this._loaded=!0,this.fire(new o.k(f))}}))}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load(!0)}setTiles(l){return this.setSourceProperty((()=>{this._options.tiles=l})),this}setUrl(l){return this.setSourceProperty((()=>{this.url=l,this._options.url=l})),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{let v=yield ee.getImage(this.map._requestManager.transformRequest(f,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(v&&v.data){this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&l.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});let S=this.map.painter.context,I=S.gl,D=v.data;l.texture=this.map.painter.getTileTexture(D.width),l.texture?l.texture.update(D,{useMipmap:!0}):(l.texture=new o.T(S,D,I.RGBA,{useMipmap:!0}),l.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(v){if(delete l.abortController,l.aborted)l.state="unloaded";else if(v)throw l.state="errored",v}}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)}))}hasTransition(){return!1}}class Ss extends cs{constructor(l,f,v,S){super(l,f,v,S),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox",this.redFactor=f.redFactor,this.greenFactor=f.greenFactor,this.blueFactor=f.blueFactor,this.baseShift=f.baseShift}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v=this.map._requestManager.transformRequest(f,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{let S=yield ee.getImage(v,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(S&&S.data){let I=S.data;this.map._refreshExpiredTiles&&(S.cacheControl||S.expires)&&l.setExpiryData({cacheControl:S.cacheControl,expires:S.expires});let D=o.b(I)&&o.W()?I:yield this.readImageNow(I),z={type:this.type,uid:l.uid,source:this.id,rawImageData:D,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();let V=yield l.actor.sendAsync({type:"LDT",data:z});l.dem=V,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(S){if(delete l.abortController,l.aborted)l.state="unloaded";else if(S)throw l.state="errored",S}}))}readImageNow(l){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.X()){let f=l.width+2,v=l.height+2;try{return new o.R({width:f,height:v},yield o.Y(l,-1,-1,f,v))}catch{}}return m.getImageData(l,1)}))}_getNeighboringTiles(l){let f=l.canonical,v=Math.pow(2,f.z),S=(f.x-1+v)%v,I=f.x===0?l.wrap-1:l.wrap,D=(f.x+1+v)%v,z=f.x+1===v?l.wrap+1:l.wrap,V={};return V[new o.Z(l.overscaledZ,I,f.z,S,f.y).key]={backfilled:!1},V[new o.Z(l.overscaledZ,z,f.z,D,f.y).key]={backfilled:!1},f.y>0&&(V[new o.Z(l.overscaledZ,I,f.z,S,f.y-1).key]={backfilled:!1},V[new o.Z(l.overscaledZ,l.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},V[new o.Z(l.overscaledZ,z,f.z,D,f.y-1).key]={backfilled:!1}),f.y+1<v&&(V[new o.Z(l.overscaledZ,I,f.z,S,f.y+1).key]={backfilled:!1},V[new o.Z(l.overscaledZ,l.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},V[new o.Z(l.overscaledZ,z,f.z,D,f.y+1).key]={backfilled:!1}),V}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))}))}}class Wl extends o.E{constructor(l,f,v,S){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:f.data},this.actor=v.getActor(),this.setEventedParent(S),this._data=f.data,this._options=o.e({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId,f.clusterMaxZoom!==void 0&&this.maxzoom<=f.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${f.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(f.buffer!==void 0?f.buffer:128),tolerance:this._pixelsToTileUnits(f.tolerance!==void 0?f.tolerance:.375),extent:o.$,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(f.clusterMaxZoom),minPoints:Math.max(2,f.clusterMinPoints||2),extent:o.$,radius:this._pixelsToTileUnits(f.clusterRadius||50),log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(l){return l*(o.$/this.tileSize)}_getClusterMaxZoom(l){let f=l?Math.round(l):this.maxzoom-1;return Number.isInteger(l)||l===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${l}" rounded to "${f}"`),f}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._pendingWorkerUpdate={data:l},this._updateWorkerData(),this}updateData(l){return this._pendingWorkerUpdate.diff=o.a0(this._pendingWorkerUpdate.diff,l),this._updateWorkerData(),this}getData(){return o._(this,void 0,void 0,(function*(){let l=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})}))}getCoordinatesFromGeometry(l){return l.type==="GeometryCollection"?l.geometries.map((f=>f.coordinates)).flat(1/0):l.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,(function*(){let l=new dn,f=yield this.getData(),v;switch(f.type){case"FeatureCollection":v=f.features.map((S=>this.getCoordinatesFromGeometry(S.geometry))).flat(1/0);break;case"Feature":v=this.getCoordinatesFromGeometry(f.geometry);break;default:v=this.getCoordinatesFromGeometry(f)}if(v.length==0)return l;for(let S=0;S<v.length-1;S+=2)l.extend([v[S],v[S+1]]);return l}))}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(l.clusterRadius)),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(l.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,f,v){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:f,offset:v}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);let{data:l,diff:f}=this._pendingWorkerUpdate,v=o.e({type:this.type},this.workerOptions);l?(typeof l=="string"?(v.request=this.map._requestManager.transformRequest(m.resolveURL(l),"Source"),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(l),this._pendingWorkerUpdate.data=void 0):f&&(v.dataDiff=f,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{let S=yield this.actor.sendAsync({type:"LD",data:v});if(this._isUpdatingWorker=!1,this._removed||S.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));this._data=S.data;let I=null;S.resourceTiming&&S.resourceTiming[this.id]&&(I=S.resourceTiming[this.id].slice(0));let D={dataType:"source"};this._collectResourceTiming&&I&&I.length>0&&o.e(D,{resourceTiming:I}),this.fire(new o.l("data",Object.assign(Object.assign({},D),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},D),{sourceDataType:"content"})))}catch(S){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(S))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(l){return o._(this,void 0,void 0,(function*(){let f=l.actor?"RT":"LT";l.actor=this.actor;let v={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.abortController=new AbortController;let S=yield this.actor.sendAsync({type:f,data:v},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(S,this.map.painter,f==="RT")}))}abortTile(l){return o._(this,void 0,void 0,(function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0}))}unloadTile(l){return o._(this,void 0,void 0,(function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Gl extends o.E{constructor(l,f,v,S){super(),this.flippedWindingOrder=!1,this.id=l,this.dispatcher=v,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=f}load(l){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let f=yield ee.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,f&&f.data&&(this.image=f.data,l&&(this.coordinates=l),this._finishLoading())}catch(f){this._request=null,this._loaded=!0,this.fire(new o.k(f))}}))}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;let f=l.map(o.a1.fromLngLat);var v;return this.tileID=(function(S){let I=o.a2.fromPoints(S),D=I.width(),z=I.height(),V=Math.max(D,z),X=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),Q=Math.pow(2,X);return new o.a4(X,Math.floor((I.minX+I.maxX)/2*Q),Math.floor((I.minY+I.maxY)/2*Q))})(f),this.terrainTileRanges=this._getOverlappingTileRanges(f),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=f.map((S=>this.tileID.getTilePoint(S)._round())),this.flippedWindingOrder=((v=this.tileCoords)[1].x-v[0].x)*(v[2].y-v[0].y)-(v[1].y-v[0].y)*(v[2].x-v[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let l=this.map.painter.context,f=l.gl;this.texture||(this.texture=new o.T(l,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let v=!1;for(let S in this.tiles){let I=this.tiles[S];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture,v=!0)}v&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(l){let{minX:f,minY:v,maxX:S,maxY:I}=o.a2.fromPoints(l),D={};for(let z=0;z<=o.a3;z++){let V=Math.pow(2,z),X=Math.floor(f*V),Q=Math.floor(v*V),ie=Math.floor(S*V),re=Math.floor(I*V);D[z]={minTileX:X,minTileY:Q,maxTileX:ie,maxTileY:re}}return D}}class _c extends Gl{constructor(l,f,v,S){super(l,f,v,S),this.roundZoom=!0,this.type="video",this.options=f}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;let l=this.options;this.urls=[];for(let f of l.urls)this.urls.push(this.map._requestManager.transformRequest(f,"Source").url);try{let f=yield o.a5(this.urls);if(this._loaded=!0,!f)return;this.video=f,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(f){this.fire(new o.k(f))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){let f=this.video.seekable;l<f.start(0)||l>f.end(0)?this.fire(new o.k(new o.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let l=this.map.painter.context,f=l.gl;this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(l,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));let v=!1;for(let S in this.tiles){let I=this.tiles[S];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture,v=!0)}v&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class us extends Gl{constructor(l,f,v,S){super(l,f,v,S),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some((I=>!Array.isArray(I)||I.length!==2||I.some((D=>typeof D!="number"))))||this.fire(new o.k(new o.a6(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a6(`sources.${l}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new o.k(new o.a6(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a6(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a6(`sources.${l}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let f=this.map.painter.context,v=f.gl;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(f,this.canvas,v.RGBA,{premultiply:!0});let S=!1;for(let I in this.tiles){let D=this.tiles[I];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture,S=!0)}S&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}let $s={},vc=C=>{switch(C){case"geojson":return Wl;case"image":return Gl;case"raster":return cs;case"raster-dem":return Ss;case"vector":return vl;case"video":return _c;case"canvas":return us}return $s[C]},bl="RTLPluginLoaded";class rm extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=zi()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch((f=>{throw this.status="error",f}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,(function*(f,v=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=m.resolveURL(f),!this.url)throw new Error(`requested url ${f} is invalid`);if(this.status==="unavailable"){if(!v)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(bl))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ia=null;function Hl(){return Ia||(Ia=new rm),Ia}var Je,he;(function(C){C[C.Base=0]="Base",C[C.Parent=1]="Parent"})(Je||(Je={})),(function(C){C[C.Departing=0]="Departing",C[C.Incoming=1]="Incoming"})(he||(he={}));class fe{constructor(l,f){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=l,this.uid=o.a7(),this.uses=0,this.tileSize=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(l){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(l||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:l,fadingDirection:f,fadingParentID:v,fadeEndTime:S}){this.resetFadeLogic(),this.fadingRole=l,this.fadingDirection=f,this.fadingParentID=v,this.fadeEndTime=S}setSelfFadeLogic(l){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=l}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=M(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,f,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=(function(S,I){let D={};if(!I)return D;for(let z of S){let V=z.layerIds.map((X=>I.getLayer(X))).filter(Boolean);if(V.length!==0){z.layers=V,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map((X=>V.filter((Q=>Q.id===X))[0])));for(let X of V)D[X.id]=z}}return D})(l.buckets,f?.style),this.hasSymbolBuckets=!1;for(let S in this.buckets){let I=this.buckets[S];if(I instanceof o.a9){if(this.hasSymbolBuckets=!0,!v)break;I.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let S in this.buckets){let I=this.buckets[S];if(I instanceof o.a9&&I.hasRTLText){this.hasRTLText=!0,Hl().lazyLoad();break}}this.queryPadding=0;for(let S in this.buckets){let I=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,f.style.getLayer(S).queryRadius(I))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),this.dashPositions=l.dashPositions}else this.collisionBoxArray=new o.a8}unloadVectorData(){for(let l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(let v in this.buckets){let S=this.buckets[v];S.uploadPending()&&S.upload(l)}let f=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(l,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(l,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,f,v,S,I,D,z,V,X,Q,ie){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:S,cameraQueryGeometry:I,scale:D,tileSize:this.tileSize,pixelPosMatrix:Q,transform:V,params:z,queryPadding:this.queryPadding*X,getElevation:ie},l,f,v):{}}querySourceFeatures(l,f){let v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;let S=v.loadVTLayers(),I=f&&f.sourceLayer?f.sourceLayer:"",D=S._geojsonTileLayer||S[I];if(!D)return;let z=o.aa(f?.filter,f?.globalState),{z:V,x:X,y:Q}=this.tileID.canonical,ie={z:V,x:X,y:Q};for(let re=0;re<D.length;re++){let ae=D.feature(re);if(z.needGeometry){let Me=o.ab(ae,!0);if(!z.filter(new o.F(this.tileID.overscaledZ),Me,this.tileID.canonical))continue}else if(!z.filter(new o.F(this.tileID.overscaledZ),ae))continue;let Ae=v.getId(ae,I),Te=new o.ac(ae,V,X,Q,Ae);Te.tile=ie,l.push(Te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){let f=this.expirationTime;if(l.cacheControl){let v=o.ad(l.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){let v=Date.now(),S=!1;if(this.expirationTime>v)S=!1;else if(f)if(this.expirationTime<f)S=!0;else{let I=this.expirationTime-f;I?this.expirationTime=v+Math.max(I,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,f){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;let v=this.latestFeatureIndex.loadVTLayers();for(let S in this.buckets){if(!f.style.hasLayer(S))continue;let I=this.buckets[S],D=I.layers[0].sourceLayer||"_geojsonTileLayer",z=v[D],V=l[D];if(!z||!V||Object.keys(V).length===0)continue;I.update(V,z,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});let X=f&&f.style&&f.style.getLayer(S);X&&(this.queryPadding=Math.max(this.queryPadding,X.queryRadius(I)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<M()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(l){this.symbolFadeHoldUntil=M()+l}setDependencies(l,f){let v={};for(let S of f)v[S]=!0;this.dependencies[l]=v}hasDependency(l,f){for(let v of l){let S=this.dependencies[v];if(S){for(let I of f)if(S[I])return!0}}return!1}}class xe{constructor(l,f){this.max=l,this.onRemove=f,this.reset()}reset(){for(let l in this.data)for(let f of this.data[l])f.timeout&&clearTimeout(f.timeout),this.onRemove(f.value);return this.data={},this.order=[],this}add(l,f,v){let S=l.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);let I={value:f,timeout:void 0};if(v!==void 0&&(I.timeout=setTimeout((()=>{this.remove(l,I)}),v)),this.data[S].push(I),this.order.push(S),this.order.length>this.max){let D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){let f=this.data[l].shift();return f.timeout&&clearTimeout(f.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),f.value}getByKey(l){let f=this.data[l];return f?f[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,f){if(!this.has(l))return this;let v=l.wrapped().key,S=f===void 0?0:this.data[v].indexOf(f),I=this.data[v][S];return this.data[v].splice(S,1),I.timeout&&clearTimeout(I.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(I.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){let f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}filter(l){let f=[];for(let v in this.data)for(let S of this.data[v])l(S.value)||f.push(S);for(let v of f)this.remove(v.value.tileID,v)}}class Ne{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,f,v){let S=String(f);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][S]=this.stateChanges[l][S]||{},o.e(this.stateChanges[l][S],v),this.deletedStates[l]===null){this.deletedStates[l]={};for(let I in this.state[l])I!==S&&(this.deletedStates[l][I]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][S]===null){this.deletedStates[l][S]={};for(let I in this.state[l][S])v[I]||(this.deletedStates[l][S][I]=null)}else for(let I in v)this.deletedStates[l]&&this.deletedStates[l][S]&&this.deletedStates[l][S][I]===null&&delete this.deletedStates[l][S][I]}removeFeatureState(l,f,v){if(this.deletedStates[l]===null)return;let S=String(f);if(this.deletedStates[l]=this.deletedStates[l]||{},v&&f!==void 0)this.deletedStates[l][S]!==null&&(this.deletedStates[l][S]=this.deletedStates[l][S]||{},this.deletedStates[l][S][v]=null);else if(f!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][S])for(v in this.deletedStates[l][S]={},this.stateChanges[l][S])this.deletedStates[l][S][v]=null;else this.deletedStates[l][S]=null;else this.deletedStates[l]=null}getState(l,f){let v=String(f),S=o.e({},(this.state[l]||{})[v],(this.stateChanges[l]||{})[v]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){let I=this.deletedStates[l][f];if(I===null)return{};for(let D in I)delete S[D]}return S}initializeTileState(l,f){l.setFeatureState(this.state,f)}coalesceChanges(l,f){let v={};for(let S in this.stateChanges){this.state[S]=this.state[S]||{};let I={};for(let D in this.stateChanges[S])this.state[S][D]||(this.state[S][D]={}),o.e(this.state[S][D],this.stateChanges[S][D]),I[D]=this.state[S][D];v[S]=I}for(let S in this.deletedStates){this.state[S]=this.state[S]||{};let I={};if(this.deletedStates[S]===null)for(let D in this.state[S])I[D]={},this.state[S][D]={};else for(let D in this.deletedStates[S]){if(this.deletedStates[S][D]===null)this.state[S][D]={};else for(let z of Object.keys(this.deletedStates[S][D]))delete this.state[S][D][z];I[D]=this.state[S][D]}v[S]=v[S]||{},o.e(v[S],I)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(let S in l)l[S].setFeatureState(v,f)}}let $e=89.25;function tt(C,l){let f=o.ae(l.lat,-o.af,o.af);return new o.P(o.V(l.lng)*C,o.U(f)*C)}function yt(C,l){return new o.a1(l.x/C,l.y/C).toLngLat()}function it(C){return C.cameraToCenterDistance*Math.min(.85*Math.tan(o.ag(90-C.pitch)),Math.tan(o.ag($e-C.pitch)))}function xt(C,l){let f=C.canonical,v=l/o.ah(f.z),S=f.x+Math.pow(2,f.z)*C.wrap,I=o.ai(new Float64Array(16));return o.M(I,I,[S*v,f.y*v,0]),o.N(I,I,[v/o.$,v/o.$,1]),I}function Ft(C,l,f,v,S){let I=o.a1.fromLngLat(C,l),D=S*o.aj(1,C.lat),z=D*Math.cos(o.ag(f)),V=Math.sqrt(D*D-z*z),X=V*Math.sin(o.ag(-v)),Q=V*Math.cos(o.ag(-v));return new o.a1(I.x+X,I.y+Q,I.z+z)}function Ct(C,l,f){let v=l.intersectsFrustum(C);if(!f||v===0)return v;let S=l.intersectsPlane(f);return S===0?0:v===2&&S===2?2:1}function vr(C,l,f){let v=0,S=(f-l)/10;for(let I=0;I<10;I++)v+=S*Math.pow(Math.cos(l+(I+.5)/10*(f-l)),C);return v}function lt(C,l){return function(f,v,S,I,D){let z=2*((C-1)/o.ak(Math.cos(o.ag($e-D))/Math.cos(o.ag($e)))-1),V=Math.acos(S/I),X=2*vr(z-1,0,o.ag(D/2)),Q=Math.min(o.ag($e),V+o.ag(D/2)),ie=vr(z-1,Math.min(Q,V-o.ag(D/2)),Q),re=Math.atan(v/S),ae=Math.hypot(v,S),Ae=f;return Ae+=o.ak(I/ae/Math.max(.5,Math.cos(o.ag(D/2)))),Ae+=z*o.ak(Math.cos(re))/2,Ae-=o.ak(Math.max(1,ie/X/l))/2,Ae}}let Ei=lt(9.314,3);function jn(C,l){let f=(l.roundZoom?Math.round:Math.floor)(C.zoom+o.ak(C.tileSize/l.tileSize));return Math.max(0,f)}function wr(C,l){let f=C.getCameraFrustum(),v=C.getClippingPlane(),S=C.screenPointToMercatorCoordinate(C.getCameraPoint()),I=o.a1.fromLngLat(C.center,C.elevation);S.z=I.z+Math.cos(C.pitchInRadians)*C.cameraToCenterDistance/C.worldSize;let D=C.getCoveringTilesDetailsProvider(),z=D.allowVariableZoom(C,l),V=jn(C,l),X=l.minzoom||0,Q=l.maxzoom!==void 0?l.maxzoom:C.maxZoom,ie=Math.min(Math.max(0,V),Q),re=Math.pow(2,ie),ae=[re*S.x,re*S.y,0],Ae=[re*I.x,re*I.y,0],Te=Math.hypot(I.x-S.x,I.y-S.y),Me=Math.abs(I.z-S.z),Ce=Math.hypot(Te,Me),De=je=>({zoom:0,x:0,y:0,wrap:je,fullyVisible:!1}),Ve=[],Oe=[];if(C.renderWorldCopies&&D.allowWorldCopies())for(let je=1;je<=3;je++)Ve.push(De(-je)),Ve.push(De(je));for(Ve.push(De(0));Ve.length>0;){let je=Ve.pop(),He=je.x,Be=je.y,et=je.fullyVisible,Ke={x:He,y:Be,z:je.zoom},ct=D.getTileBoundingVolume(Ke,je.wrap,C.elevation,l);if(!et){let Ht=Ct(f,ct,v);if(Ht===0)continue;et=Ht===2}let Ye=D.distanceToTile2d(S.x,S.y,Ke,ct),gt=V;z&&(gt=(l.calculateTileZoom||Ei)(C.zoom+o.ak(C.tileSize/l.tileSize),Ye,Me,Ce,C.fov)),gt=(l.roundZoom?Math.round:Math.floor)(gt),gt=Math.max(0,gt);let Gt=Math.min(gt,Q);if(je.wrap=D.getWrap(I,Ke,je.wrap),je.zoom>=Gt){if(je.zoom<X)continue;let Ht=ie-je.zoom,kt=ae[0]-.5-(He<<Ht),pr=ae[1]-.5-(Be<<Ht),Ar=l.reparseOverscaled?Math.max(je.zoom,gt):je.zoom;Oe.push({tileID:new o.Z(je.zoom===Q?Ar:je.zoom,je.wrap,je.zoom,He,Be),distanceSq:o.al([Ae[0]-.5-He,Ae[1]-.5-Be]),tileDistanceToCamera:Math.sqrt(kt*kt+pr*pr)})}else for(let Ht=0;Ht<4;Ht++)Ve.push({zoom:je.zoom+1,x:(He<<1)+Ht%2,y:(Be<<1)+(Ht>>1),wrap:je.wrap,fullyVisible:et})}return Oe.sort(((je,He)=>je.distanceSq-He.distanceSq)).map((je=>je.tileID))}let di=o.a2.fromPoints([new o.P(0,0),new o.P(o.$,o.$)]);class rn extends o.E{constructor(l,f,v){super(),this.id=l,this.dispatcher=v,this.on("data",(S=>this._dataHandler(S))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((S,I,D,z)=>{let V=new(vc(I.type))(S,I,D,z);if(V.id!==S)throw new Error(`Expected Source id to be ${S} instead of ${V.id}`);return V})(l,f,v,this),this._tiles={},this._cache=new xe(0,(S=>this._unloadTile(S))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Ne,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let l in this._tiles){let f=this._tiles[l];if(f.state!=="loaded"&&f.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,f,v){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,f,v)}catch(S){l.state="errored",S.status!==404?this._source.fire(new o.k(S,{tile:l})):this.update(this.transform,this.terrain)}}))}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.l("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let f in this._tiles){let v=this._tiles[f];v.upload(l),v.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((l=>l.tileID)).sort(Jo).map((l=>l.key))}getRenderableIds(l){let f=[];for(let v in this._tiles)this._isIdRenderable(v,l)&&f.push(this._tiles[v]);return l?f.sort(((v,S)=>{let I=v.tileID,D=S.tileID,z=new o.P(I.canonical.x,I.canonical.y)._rotate(-this.transform.bearingInRadians),V=new o.P(D.canonical.x,D.canonical.y)._rotate(-this.transform.bearingInRadians);return I.overscaledZ-D.overscaledZ||V.y-z.y||V.x-z.x})).map((v=>v.tileID.key)):f.map((v=>v.tileID)).sort(Jo).map((v=>v.key))}hasRenderableParent(l){let f=l.overscaledZ-1;if(f>=this._source.minzoom){let v=this._getLoadedTile(l.scaledTo(f));if(v)return this._isIdRenderable(v.tileID.key)}return!1}_isIdRenderable(l,f=!1){var v;return(v=this._tiles[l])===null||v===void 0?void 0:v.isRenderable(f)}reload(l){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let f in this._tiles)l?this._reloadTile(f,"expired"):this._tiles[f].state!=="errored"&&this._reloadTile(f,"reloading")}}_reloadTile(l,f){return o._(this,void 0,void 0,(function*(){let v=this._tiles[l];v&&(v.state!=="loading"&&(v.state=f),yield this._loadTile(v,l,f))}))}_tileLoaded(l,f,v){l.timeAdded=M(),v==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(f,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){let f=this.getRenderableIds();for(let S=0;S<f.length;S++){let I=f[S];if(l.neighboringTiles&&l.neighboringTiles[I]){let D=this.getTileByID(I);v(l,D),v(D,l)}}function v(S,I){S.needsHillshadePrepare=!0,S.needsTerrainPrepare=!0;let D=I.tileID.canonical.x-S.tileID.canonical.x,z=I.tileID.canonical.y-S.tileID.canonical.y,V=Math.pow(2,S.tileID.canonical.z),X=I.tileID.key;D===0&&z===0||Math.abs(z)>1||(Math.abs(D)>1&&(Math.abs(D+V)===1?D+=V:Math.abs(D-V)===1&&(D-=V)),I.dem&&S.dem&&(S.dem.backfillBorder(I.dem,D,z),S.neighboringTiles&&S.neighboringTiles[X]&&(S.neighboringTiles[X].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,f){let v=Object.values(l),S=this._getLoadedDescendents(v),I={};for(let D of v){let z=S[D.key];if(!z?.length){I[D.key]=D;continue}let V=D.overscaledZ+rn.maxUnderzooming,X=z.filter((re=>re.tileID.overscaledZ<=V));if(!X.length){I[D.key]=D;continue}let Q=Math.min(...X.map((re=>re.tileID.overscaledZ))),ie=X.filter((re=>re.tileID.overscaledZ===Q)).map((re=>re.tileID));for(let re of ie)f[re.key]=re;this._areDescendentsComplete(ie,Q,D.overscaledZ)||(I[D.key]=D)}return I}_getLoadedDescendents(l){var f;let v={};for(let S in this._tiles){let I=this._tiles[S];if(I.hasData())for(let D of l)I.tileID.isChildOf(D)&&(v[f=D.key]||(v[f]=[])).push(I)}return v}_areDescendentsComplete(l,f,v){return l.length===1&&l[0].isOverscaled()?l[0].overscaledZ===f:Math.pow(4,f-v)===l.length}_getLoadedTile(l){let f=this._tiles[l.key];return f?.hasData()?f:null}updateCacheSize(l){let f=Math.ceil(l.width/this._source.tileSize)+1,v=Math.ceil(l.height/this._source.tileSize)+1,S=Math.floor(f*v*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(I)}handleWrapJump(l){let f=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,f){let v={};for(let S in this._tiles){let I=this._tiles[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+f),v[I.tileID.key]=I}this._tiles=v,this._resetTileReloadTimers()}}update(l,f){if(!this._sourceLoaded||this._paused)return;let v;this.transform=l,this.terrain=f,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?v=l.getVisibleUnwrappedCoordinates(this._source.tileID).map((V=>new o.Z(V.canonical.z,V.wrap,V.canonical.z,V.canonical.x,V.canonical.y))):(v=wr(l,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:f,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(v=v.filter((V=>this._source.hasTile(V))))):v=[],this.usedForTerrain&&(v=this._addTerrainIdealTiles(v));let S=v.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let I=jn(l,this._source),D=this._updateRetainedTiles(v,I),z=Lt(this._source.type);z&&this._rasterFadeDuration>0&&!f&&this._updateFadingTiles(v,D),z?this._cleanUpRasterTiles(D):this._cleanUpVectorTiles(D)}_cleanUpRasterTiles(l){for(let f in this._tiles)l[f]||this._removeTile(f)}_cleanUpVectorTiles(l){for(let f in this._tiles){let v=this._tiles[f];l[f]?v.clearSymbolFadeHold():v.hasSymbolBuckets?v.holdingForSymbolFade()?v.symbolFadeFinished()&&this._removeTile(f):v.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(f)}}_addTerrainIdealTiles(l){let f=[];for(let v of l)if(v.canonical.z>this._source.minzoom){let S=v.scaledTo(v.canonical.z-1);f.push(S);let I=v.scaledTo(Math.max(this._source.minzoom,Math.min(v.canonical.z,5)));f.push(I)}return l.concat(f)}releaseSymbolFadeTiles(){for(let l in this._tiles)this._tiles[l].holdingForSymbolFade()&&this._removeTile(l)}_updateRetainedTiles(l,f){var v;let S={},I={},D=Math.max(f-rn.maxOverzooming,this._source.minzoom),z={};for(let V of l){let X=this._addTile(V);S[V.key]=V,X.hasData()||(z[V.key]=V)}z=this._retainLoadedChildren(z,S);for(let V in z){let X=z[V],Q=this._tiles[V],ie=Q?.wasRequested();for(let re=X.overscaledZ-1;re>=D;--re){let ae=X.scaledTo(re);if(I[ae.key])break;if(I[ae.key]=!0,Q=this.getTile(ae),!Q&&ie&&(Q=this._addTile(ae)),Q){let Ae=Q.hasData();if((Ae||!(!((v=this.map)===null||v===void 0)&&v.cancelPendingTileRequestsWhileZooming)||ie)&&(S[ae.key]=ae),ie=Q.wasRequested(),Ae)break}}}return S}_updateFadingTiles(l,f){let v=M(),S=o.am(l);for(let I of l){let D=this._tiles[I.key];D.fadingDirection!==he.Departing&&D.fadeOpacity!==0||D.resetFadeLogic(),this._updateFadingAncestor(D,f,v)||this._updateFadingDescendents(D,f,v)||this._updateFadingEdge(D,S,v)||D.resetFadeLogic()}}_updateFadingAncestor(l,f,v){if(!l.hasData())return!1;let{tileID:S,fadingRole:I,fadingDirection:D,fadingParentID:z}=l;if(I===Je.Base&&D===he.Incoming&&z)return f[z.key]=z,!0;let V=Math.max(S.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let X=S.overscaledZ-1;X>=V;X--){let Q=S.scaledTo(X),ie=this._getLoadedTile(Q);if(ie)return l.setCrossFadeLogic({fadingRole:Je.Base,fadingDirection:he.Incoming,fadingParentID:ie.tileID,fadeEndTime:v+this._rasterFadeDuration}),ie.setCrossFadeLogic({fadingRole:Je.Parent,fadingDirection:he.Departing,fadeEndTime:v+this._rasterFadeDuration}),f[Q.key]=Q,!0}return!1}_updateFadingDescendents(l,f,v){if(!l.hasData())return!1;let S=l.tileID.children(this._source.maxzoom),I=this._updateFadingChildren(l,S,f,v);if(I)return!0;for(let D of S){let z=D.children(this._source.maxzoom);this._updateFadingChildren(l,z,f,v)&&(I=!0)}return I}_updateFadingChildren(l,f,v,S){if(f[0].overscaledZ>=this._source.maxzoom)return!1;let I=!1;for(let D of f){let z=this._getLoadedTile(D);if(!z)continue;let{fadingRole:V,fadingDirection:X,fadingParentID:Q}=z;V===Je.Base&&X===he.Departing&&Q||(z.setCrossFadeLogic({fadingRole:Je.Base,fadingDirection:he.Departing,fadingParentID:l.tileID,fadeEndTime:S+this._rasterFadeDuration}),l.setCrossFadeLogic({fadingRole:Je.Parent,fadingDirection:he.Incoming,fadeEndTime:S+this._rasterFadeDuration})),v[D.key]=D,I=!0}return I}_updateFadingEdge(l,f,v){let S=l.tileID;return!!l.selfFading||!l.hasData()&&!!f.has(S)&&(l.setSelfFadeLogic(v+this._rasterFadeDuration),!0)}_addTile(l){let f=this._tiles[l.key];if(f)return f;f=this._cache.getAndRemove(l),f&&(f.resetFadeLogic(),this._setTileReloadTimer(l.key,f),f.tileID=l,this._state.initializeTileState(f,this.map?this.map.painter:null));let v=f;return f||(f=new fe(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(f,l.key,f.state)),f.uses++,this._tiles[l.key]=f,v||this._source.fire(new o.l("dataloading",{tile:f,coord:f.tileID,dataType:"source"})),f}_setTileReloadTimer(l,f){this._clearTileReloadTimer(l);let v=f.getExpiryTimeout();v&&(this._timers[l]=setTimeout((()=>{this._reloadTile(l,"expired"),delete this._timers[l]}),v))}_clearTileReloadTimer(l){let f=this._timers[l];f&&(clearTimeout(f),delete this._timers[l])}_resetTileReloadTimers(){for(let l in this._timers)clearTimeout(this._timers[l]),delete this._timers[l];for(let l in this._tiles)this._setTileReloadTimer(l,this._tiles[l])}refreshTiles(l){for(let f in this._tiles)(this._isIdRenderable(f)||this._tiles[f].state=="errored")&&l.some((v=>v.equals(this._tiles[f].tileID.canonical)))&&this._reloadTile(f,"expired")}_removeTile(l){let f=this._tiles[l];f&&(f.uses--,delete this._tiles[l],this._clearTileReloadTimer(l),f.uses>0||(f.hasData()&&f.state!=="reloading"?this._cache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}_dataHandler(l){l.dataType==="source"&&(l.sourceDataType!=="metadata"?l.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(l.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,f,v){let S=[],I=this.transform;if(!I)return S;let D=I.getCoveringTilesDetailsProvider().allowWorldCopies(),z=v?I.getCameraQueryGeometry(l):l,V=ae=>I.screenPointToMercatorCoordinate(ae,this.terrain),X=this.transformBbox(l,V,!D),Q=this.transformBbox(z,V,!D),ie=this.getIds(),re=o.a2.fromPoints(Q);for(let ae=0;ae<ie.length;ae++){let Ae=this._tiles[ie[ae]];if(Ae.holdingForSymbolFade())continue;let Te=D?[Ae.tileID]:[Ae.tileID.unwrapTo(-1),Ae.tileID.unwrapTo(0)],Me=Math.pow(2,I.zoom-Ae.tileID.overscaledZ),Ce=f*Ae.queryPadding*o.$/Ae.tileSize/Me;for(let De of Te){let Ve=re.map((Oe=>De.getTilePoint(new o.a1(Oe.x,Oe.y))));if(Ve.expandBy(Ce),Ve.intersects(di)){let Oe=X.map((He=>De.getTilePoint(He))),je=Q.map((He=>De.getTilePoint(He)));S.push({tile:Ae,tileID:D?De:De.unwrapTo(0),queryGeometry:Oe,cameraQueryGeometry:je,scale:Me})}}}return S}transformBbox(l,f,v){let S=l.map(f);if(v){let I=o.a2.fromPoints(l);I.shrinkBy(.001*Math.min(I.width(),I.height()));let D=I.map(f);o.a2.fromPoints(S).covers(D)||(S=S.map((z=>z.x>.5?new o.a1(z.x-1,z.y,z.z):z)))}return S}getVisibleCoordinates(l){let f=this.getRenderableIds(l).map((v=>this._tiles[v].tileID));return this.transform&&this.transform.populateCache(f),f}hasTransition(){if(this._source.hasTransition())return!0;if(Lt(this._source.type)&&this._rasterFadeDuration>0){let l=M();for(let f in this._tiles)if(this._tiles[f].fadeEndTime>=l)return!0}return!1}setRasterFadeDuration(l){this._rasterFadeDuration=l}setFeatureState(l,f,v){this._state.updateState(l=l||"_geojsonTileLayer",f,v)}removeFeatureState(l,f,v){this._state.removeFeatureState(l=l||"_geojsonTileLayer",f,v)}getFeatureState(l,f){return this._state.getState(l=l||"_geojsonTileLayer",f)}setDependencies(l,f,v){let S=this._tiles[l];S&&S.setDependencies(f,v)}reloadTilesForDependencies(l,f){for(let v in this._tiles)this._tiles[v].hasDependency(l,f)&&this._reloadTile(v,"reloading");this._cache.filter((v=>!v.hasDependency(l,f)))}}function Jo(C,l){let f=Math.abs(2*C.wrap)-+(C.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return C.overscaledZ-l.overscaledZ||v-f||l.canonical.y-C.canonical.y||l.canonical.x-C.canonical.x}function Lt(C){return C==="raster"||C==="image"||C==="video"}rn.maxOverzooming=10,rn.maxUnderzooming=3;class Ws{constructor(l,f){this.reset(l,f)}reset(l,f){this.points=l||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ae(l,0,1);let f=1,v=this._distances[f],S=l*this.paddedLength+this.padding;for(;v<S&&f<this._distances.length;)v=this._distances[++f];let I=f-1,D=this._distances[I],z=v-D,V=z>0?(S-D)/z:0;return this.points[I].mult(1-V).add(this.points[f].mult(V))}}function ko(C,l){let f=!0;return C==="always"||C!=="never"&&l!=="never"||(f=!1),f}class Zn{constructor(l,f,v){let S=this.boxCells=[],I=this.circleCells=[];this.xCellCount=Math.ceil(l/v),this.yCellCount=Math.ceil(f/v);for(let D=0;D<this.xCellCount*this.yCellCount;D++)S.push([]),I.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,f,v,S,I){this._forEachCell(f,v,S,I,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(I)}insertCircle(l,f,v,S){this._forEachCell(f-S,v-S,f+S,v+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(v),this.circles.push(S)}_insertBoxCell(l,f,v,S,I,D){this.boxCells[I].push(D)}_insertCircleCell(l,f,v,S,I,D){this.circleCells[I].push(D)}_query(l,f,v,S,I,D,z){if(v<0||l>this.width||S<0||f>this.height)return[];let V=[];if(l<=0&&f<=0&&this.width<=v&&this.height<=S){if(I)return[{key:null,x1:l,y1:f,x2:v,y2:S}];for(let X=0;X<this.boxKeys.length;X++)V.push({key:this.boxKeys[X],x1:this.bboxes[4*X],y1:this.bboxes[4*X+1],x2:this.bboxes[4*X+2],y2:this.bboxes[4*X+3]});for(let X=0;X<this.circleKeys.length;X++){let Q=this.circles[3*X],ie=this.circles[3*X+1],re=this.circles[3*X+2];V.push({key:this.circleKeys[X],x1:Q-re,y1:ie-re,x2:Q+re,y2:ie+re})}}else this._forEachCell(l,f,v,S,this._queryCell,V,{hitTest:I,overlapMode:D,seenUids:{box:{},circle:{}}},z);return V}query(l,f,v,S){return this._query(l,f,v,S,!1,null)}hitTest(l,f,v,S,I,D){return this._query(l,f,v,S,!0,I,D).length>0}hitTestCircle(l,f,v,S,I){let D=l-v,z=l+v,V=f-v,X=f+v;if(z<0||D>this.width||X<0||V>this.height)return!1;let Q=[];return this._forEachCell(D,V,z,X,this._queryCellCircle,Q,{hitTest:!0,overlapMode:S,circle:{x:l,y:f,radius:v},seenUids:{box:{},circle:{}}},I),Q.length>0}_queryCell(l,f,v,S,I,D,z,V){let{seenUids:X,hitTest:Q,overlapMode:ie}=z,re=this.boxCells[I];if(re!==null){let Ae=this.bboxes;for(let Te of re)if(!X.box[Te]){X.box[Te]=!0;let Me=4*Te,Ce=this.boxKeys[Te];if(l<=Ae[Me+2]&&f<=Ae[Me+3]&&v>=Ae[Me+0]&&S>=Ae[Me+1]&&(!V||V(Ce))&&(!Q||!ko(ie,Ce.overlapMode))&&(D.push({key:Ce,x1:Ae[Me],y1:Ae[Me+1],x2:Ae[Me+2],y2:Ae[Me+3]}),Q))return!0}}let ae=this.circleCells[I];if(ae!==null){let Ae=this.circles;for(let Te of ae)if(!X.circle[Te]){X.circle[Te]=!0;let Me=3*Te,Ce=this.circleKeys[Te];if(this._circleAndRectCollide(Ae[Me],Ae[Me+1],Ae[Me+2],l,f,v,S)&&(!V||V(Ce))&&(!Q||!ko(ie,Ce.overlapMode))){let De=Ae[Me],Ve=Ae[Me+1],Oe=Ae[Me+2];if(D.push({key:Ce,x1:De-Oe,y1:Ve-Oe,x2:De+Oe,y2:Ve+Oe}),Q)return!0}}}return!1}_queryCellCircle(l,f,v,S,I,D,z,V){let{circle:X,seenUids:Q,overlapMode:ie}=z,re=this.boxCells[I];if(re!==null){let Ae=this.bboxes;for(let Te of re)if(!Q.box[Te]){Q.box[Te]=!0;let Me=4*Te,Ce=this.boxKeys[Te];if(this._circleAndRectCollide(X.x,X.y,X.radius,Ae[Me+0],Ae[Me+1],Ae[Me+2],Ae[Me+3])&&(!V||V(Ce))&&!ko(ie,Ce.overlapMode))return D.push(!0),!0}}let ae=this.circleCells[I];if(ae!==null){let Ae=this.circles;for(let Te of ae)if(!Q.circle[Te]){Q.circle[Te]=!0;let Me=3*Te,Ce=this.circleKeys[Te];if(this._circlesCollide(Ae[Me],Ae[Me+1],Ae[Me+2],X.x,X.y,X.radius)&&(!V||V(Ce))&&!ko(ie,Ce.overlapMode))return D.push(!0),!0}}}_forEachCell(l,f,v,S,I,D,z,V){let X=this._convertToXCellCoord(l),Q=this._convertToYCellCoord(f),ie=this._convertToXCellCoord(v),re=this._convertToYCellCoord(S);for(let ae=X;ae<=ie;ae++)for(let Ae=Q;Ae<=re;Ae++)if(I.call(this,l,f,v,S,this.xCellCount*Ae+ae,D,z,V))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,f,v,S,I,D){let z=S-l,V=I-f,X=v+D;return X*X>z*z+V*V}_circleAndRectCollide(l,f,v,S,I,D,z){let V=(D-S)/2,X=Math.abs(l-(S+V));if(X>V+v)return!1;let Q=(z-I)/2,ie=Math.abs(f-(I+Q));if(ie>Q+v)return!1;if(X<=V||ie<=Q)return!0;let re=X-V,ae=ie-Q;return re*re+ae*ae<=v*v}}function Vo(C,l,f){let v=o.L();if(!C){let{vecSouth:ie,vecEast:re}=wo(l),ae=a();ae[0]=re[0],ae[1]=re[1],ae[2]=ie[0],ae[3]=ie[1],S=ae,(Q=(D=(I=ae)[0])*(X=I[3])-(V=I[2])*(z=I[1]))&&(S[0]=X*(Q=1/Q),S[1]=-z*Q,S[2]=-V*Q,S[3]=D*Q),v[0]=ae[0],v[1]=ae[1],v[4]=ae[2],v[5]=ae[3]}var S,I,D,z,V,X,Q;return o.N(v,v,[1/f,1/f,1]),v}function Ot(C,l,f,v){if(C){let S=o.L();if(!l){let{vecSouth:I,vecEast:D}=wo(f);S[0]=D[0],S[1]=D[1],S[4]=I[0],S[5]=I[1]}return o.N(S,S,[v,v,1]),S}return f.pixelsToClipSpaceMatrix}function wo(C){let l=Math.cos(C.rollInRadians),f=Math.sin(C.rollInRadians),v=Math.cos(C.pitchInRadians),S=Math.cos(C.bearingInRadians),I=Math.sin(C.bearingInRadians),D=o.ar();D[0]=-S*v*f-I*l,D[1]=-I*v*f+S*l;let z=o.as(D);z<1e-9?o.at(D):o.au(D,D,1/z);let V=o.ar();V[0]=S*v*l-I*f,V[1]=I*v*l+S*f;let X=o.as(V);return X<1e-9?o.at(V):o.au(V,V,1/X),{vecEast:V,vecSouth:D}}function ka(C,l,f,v){let S;v?(S=[C,l,v(C,l),1],o.aw(S,S,f)):(S=[C,l,0,1],Oa(S,S,f));let I=S[3];return{point:new o.P(S[0]/I,S[1]/I),signedDistanceFromCamera:I,isOccluded:!1}}function tf(C,l){return .5+C/l*.5}function Ra(C,l){return C.x>=-l[0]&&C.x<=l[0]&&C.y>=-l[1]&&C.y<=l[1]}function Kt(C,l,f,v,S,I,D,z,V,X,Q,ie,re){let ae=f?C.textSizeData:C.iconSizeData,Ae=o.an(ae,l.transform.zoom),Te=[256/l.width*2+1,256/l.height*2+1],Me=f?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;Me.clear();let Ce=C.lineVertexArray,De=f?C.text.placedSymbolArray:C.icon.placedSymbolArray,Ve=l.transform.width/l.transform.height,Oe=!1;for(let je=0;je<De.length;je++){let He=De.get(je);if(He.hidden||He.writingMode===o.ao.vertical&&!Oe){Hu(He.numGlyphs,Me);continue}Oe=!1;let Be=new o.P(He.anchorX,He.anchorY),et={getElevation:re,pitchedLabelPlaneMatrix:v,lineVertexArray:Ce,pitchWithMap:I,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:l.transform,tileAnchorPoint:Be,unwrappedTileID:V,width:X,height:Q,translation:ie},Ke=yp(He.anchorX,He.anchorY,et);if(!Ra(Ke.point,Te)){Hu(He.numGlyphs,Me);continue}let ct=tf(l.transform.cameraToCenterDistance,Ke.signedDistanceFromCamera),Ye=o.ap(ae,Ae,He),gt=I?Ye*l.transform.getPitchedTextCorrection(He.anchorX,He.anchorY,V)/ct:Ye*ct,Gt=ql({projectionContext:et,pitchedLabelPlaneMatrixInverse:S,symbol:He,fontSize:gt,flip:!1,keepUpright:D,glyphOffsetArray:C.glyphOffsetArray,dynamicLayoutVertexArray:Me,aspectRatio:Ve,rotateToLine:z});Oe=Gt.useVertical,(Gt.notEnoughRoom||Oe||Gt.needsFlipping&&ql({projectionContext:et,pitchedLabelPlaneMatrixInverse:S,symbol:He,fontSize:gt,flip:!0,keepUpright:D,glyphOffsetArray:C.glyphOffsetArray,dynamicLayoutVertexArray:Me,aspectRatio:Ve,rotateToLine:z}).notEnoughRoom)&&Hu(He.numGlyphs,Me)}f?C.text.dynamicLayoutVertexBuffer.updateData(Me):C.icon.dynamicLayoutVertexBuffer.updateData(Me)}function fi(C,l,f,v,S,I,D,z){let V=I.glyphStartIndex+I.numGlyphs,X=I.lineStartIndex,Q=I.lineStartIndex+I.lineLength,ie=l.getoffsetX(I.glyphStartIndex),re=l.getoffsetX(V-1),ae=nf(C*ie,f,v,S,I.segment,X,Q,z,D);if(!ae)return null;let Ae=nf(C*re,f,v,S,I.segment,X,Q,z,D);return Ae?z.projectionCache.anyProjectionOccluded?null:{first:ae,last:Ae}:null}function Si(C,l,f,v){return C===o.ao.horizontal&&Math.abs(f.y-l.y)>Math.abs(f.x-l.x)*v?{useVertical:!0}:(C===o.ao.vertical?l.y<f.y:l.x>f.x)?{needsFlipping:!0}:null}function ql(C){let{projectionContext:l,pitchedLabelPlaneMatrixInverse:f,symbol:v,fontSize:S,flip:I,keepUpright:D,glyphOffsetArray:z,dynamicLayoutVertexArray:V,aspectRatio:X,rotateToLine:Q}=C,ie=S/24,re=v.lineOffsetX*ie,ae=v.lineOffsetY*ie,Ae;if(v.numGlyphs>1){let Te=v.glyphStartIndex+v.numGlyphs,Me=v.lineStartIndex,Ce=v.lineStartIndex+v.lineLength,De=fi(ie,z,re,ae,I,v,Q,l);if(!De)return{notEnoughRoom:!0};let Ve=rf(De.first.point.x,De.first.point.y,l,f),Oe=rf(De.last.point.x,De.last.point.y,l,f);if(D&&!I){let je=Si(v.writingMode,Ve,Oe,X);if(je)return je}Ae=[De.first];for(let je=v.glyphStartIndex+1;je<Te-1;je++){let He=nf(ie*z.getoffsetX(je),re,ae,I,v.segment,Me,Ce,l,Q);if(!He)return{notEnoughRoom:!0};Ae.push(He)}Ae.push(De.last)}else{if(D&&!I){let Me=Kr(l.tileAnchorPoint.x,l.tileAnchorPoint.y,l).point,Ce=v.lineStartIndex+v.segment+1,De=new o.P(l.lineVertexArray.getx(Ce),l.lineVertexArray.gety(Ce)),Ve=Kr(De.x,De.y,l),Oe=Ve.signedDistanceFromCamera>0?Ve.point:im(l.tileAnchorPoint,De,Me,1,l),je=rf(Me.x,Me.y,l,f),He=rf(Oe.x,Oe.y,l,f),Be=Si(v.writingMode,je,He,X);if(Be)return Be}let Te=nf(ie*z.getoffsetX(v.glyphStartIndex),re,ae,I,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,l,Q);if(!Te||l.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ae=[Te]}for(let Te of Ae)o.av(V,Te.point,Te.angle);return{}}function im(C,l,f,v,S){let I=C.add(C.sub(l)._unit()),D=Kr(I.x,I.y,S).point,z=f.sub(D);return f.add(z._mult(v/z.mag()))}function Gu(C,l,f){let v=l.projectionCache;if(v.projections[C])return v.projections[C];let S=new o.P(l.lineVertexArray.getx(C),l.lineVertexArray.gety(C)),I=Kr(S.x,S.y,l);if(I.signedDistanceFromCamera>0)return v.projections[C]=I.point,v.anyProjectionOccluded=v.anyProjectionOccluded||I.isOccluded,I.point;let D=C-f.direction;return im(f.distanceFromAnchor===0?l.tileAnchorPoint:new o.P(l.lineVertexArray.getx(D),l.lineVertexArray.gety(D)),S,f.previousVertex,f.absOffsetX-f.distanceFromAnchor+1,l)}function Kr(C,l,f){let v=C+f.translation[0],S=l+f.translation[1],I;return f.pitchWithMap?(I=ka(v,S,f.pitchedLabelPlaneMatrix,f.getElevation),I.isOccluded=!1):(I=f.transform.projectTileCoordinates(v,S,f.unwrappedTileID,f.getElevation),I.point.x=(.5*I.point.x+.5)*f.width,I.point.y=(.5*-I.point.y+.5)*f.height),I}function rf(C,l,f,v){if(f.pitchWithMap){let S=[C,l,0,1];return o.aw(S,S,v),f.transform.projectTileCoordinates(S[0]/S[3],S[1]/S[3],f.unwrappedTileID,f.getElevation).point}return{x:C/f.width*2-1,y:1-l/f.height*2}}function yp(C,l,f){return f.transform.projectTileCoordinates(C,l,f.unwrappedTileID,f.getElevation)}function _p(C,l,f){return C._unit()._perp()._mult(l*f)}function nm(C,l,f,v,S,I,D,z,V){if(z.projectionCache.offsets[C])return z.projectionCache.offsets[C];let X=f.add(l);if(C+V.direction<v||C+V.direction>=S)return z.projectionCache.offsets[C]=X,X;let Q=Gu(C+V.direction,z,V),ie=_p(Q.sub(f),D,V.direction),re=f.add(ie),ae=Q.add(ie);return z.projectionCache.offsets[C]=o.ax(I,X,re,ae)||X,z.projectionCache.offsets[C]}function nf(C,l,f,v,S,I,D,z,V){let X=v?C-l:C+l,Q=X>0?1:-1,ie=0;v&&(Q*=-1,ie=Math.PI),Q<0&&(ie+=Math.PI);let re,ae=Q>0?I+S:I+S+1;z.projectionCache.cachedAnchorPoint?re=z.projectionCache.cachedAnchorPoint:(re=Kr(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=re);let Ae,Te,Me=re,Ce=re,De=0,Ve=0,Oe=Math.abs(X),je=[],He;for(;De+Ve<=Oe;){if(ae+=Q,ae<I||ae>=D)return null;De+=Ve,Ce=Me,Te=Ae;let Ke={absOffsetX:Oe,direction:Q,distanceFromAnchor:De,previousVertex:Ce};if(Me=Gu(ae,z,Ke),f===0)je.push(Ce),He=Me.sub(Ce);else{let ct,Ye=Me.sub(Ce);ct=Ye.mag()===0?_p(Gu(ae+Q,z,Ke).sub(Me),f,Q):_p(Ye,f,Q),Te||(Te=Ce.add(ct)),Ae=nm(ae,ct,Me,I,D,Te,f,z,Ke),je.push(Te),He=Ae.sub(Te)}Ve=He.mag()}let Be=He._mult((Oe-De)/Ve)._add(Te||Ce),et=ie+Math.atan2(Me.y-Ce.y,Me.x-Ce.x);return je.push(Be),{point:Be,angle:V?et:0,path:je}}let om=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Hu(C,l){for(let f=0;f<C;f++){let v=l.length;l.resize(v+4),l.float32.set(om,3*v)}}function Oa(C,l,f){let v=l[0],S=l[1];return C[0]=f[0]*v+f[4]*S+f[12],C[1]=f[1]*v+f[5]*S+f[13],C[3]=f[3]*v+f[7]*S+f[15],C}let Ii=100;class k4{constructor(l,f=new Zn(l.width+200,l.height+200,25),v=new Zn(l.width+200,l.height+200,25)){this.transform=l,this.grid=f,this.ignoredGrid=v,this.pitchFactor=Math.cos(l.pitch*Math.PI/180)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ii,this.screenBottomBoundary=l.height+Ii,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,f,v,S,I,D,z,V,X,Q,ie,re){let ae=this.projectAndGetPerspectiveRatio(l.anchorPointX+V[0],l.anchorPointY+V[1],I,Q,re),Ae=v*ae.perspectiveRatio,Te;if(D||z)Te=this._projectCollisionBox(l,Ae,S,I,D,z,V,ae,Q,ie,re);else{let He=ae.x+(ie?ie.x*Ae:0),Be=ae.y+(ie?ie.y*Ae:0);Te={allPointsOccluded:!1,box:[He+l.x1*Ae,Be+l.y1*Ae,He+l.x2*Ae,Be+l.y2*Ae]}}let[Me,Ce,De,Ve]=Te.box,Oe=D?Te.allPointsOccluded:ae.isOccluded,je=Oe;return je||(je=ae.perspectiveRatio<this.perspectiveRatioCutoff),je||(je=!this.isInsideGrid(Me,Ce,De,Ve)),je||f!=="always"&&this.grid.hitTest(Me,Ce,De,Ve,f,X)?{box:[Me,Ce,De,Ve],placeable:!1,offscreen:!1,occluded:Oe}:{box:[Me,Ce,De,Ve],placeable:!0,offscreen:this.isOffscreen(Me,Ce,De,Ve),occluded:Oe}}placeCollisionCircles(l,f,v,S,I,D,z,V,X,Q,ie,re,ae,Ae){let Te=[],Me=new o.P(f.anchorX,f.anchorY),Ce=this.getPerspectiveRatio(Me.x,Me.y,D,Ae),De=(X?I*this.transform.getPitchedTextCorrection(f.anchorX,f.anchorY,D)/Ce:I*Ce)/o.aB,Ve={getElevation:Ae,pitchedLabelPlaneMatrix:z,lineVertexArray:v,pitchWithMap:X,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Me,unwrappedTileID:D,width:this.transform.width,height:this.transform.height,translation:ae},Oe=fi(De,S,f.lineOffsetX*De,f.lineOffsetY*De,!1,f,!1,Ve),je=!1,He=!1,Be=!0;if(Oe){let et=.5*ie*Ce+re,Ke=new o.P(-100,-100),ct=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Ye=new Ws,gt=Oe.first,Gt=Oe.last,Ht=[];for(let Ar=gt.path.length-1;Ar>=1;Ar--)Ht.push(gt.path[Ar]);for(let Ar=1;Ar<Gt.path.length;Ar++)Ht.push(Gt.path[Ar]);let kt=2.5*et;if(X){let Ar=this.projectPathToScreenSpace(Ht,Ve);Ht=Ar.some((Wi=>Wi.signedDistanceFromCamera<=0))?[]:Ar.map((Wi=>Wi.point))}let pr=[];if(Ht.length>0){let Ar=Ht[0].clone(),Wi=Ht[0].clone();for(let An=1;An<Ht.length;An++)Ar.x=Math.min(Ar.x,Ht[An].x),Ar.y=Math.min(Ar.y,Ht[An].y),Wi.x=Math.max(Wi.x,Ht[An].x),Wi.y=Math.max(Wi.y,Ht[An].y);pr=Ar.x>=Ke.x&&Wi.x<=ct.x&&Ar.y>=Ke.y&&Wi.y<=ct.y?[Ht]:Wi.x<Ke.x||Ar.x>ct.x||Wi.y<Ke.y||Ar.y>ct.y?[]:o.ay([Ht],Ke.x,Ke.y,ct.x,ct.y)}for(let Ar of pr){Ye.reset(Ar,.25*et);let Wi=0;Wi=Ye.length<=.5*et?1:Math.ceil(Ye.paddedLength/kt)+1;for(let An=0;An<Wi;An++){let kn=An/Math.max(Wi-1,1),St=Ye.lerp(kn),Dt=St.x+Ii,ts=St.y+Ii;Te.push(Dt,ts,et,0);let eo=Dt-et,$o=ts-et,to=Dt+et,Gn=ts+et;if(Be=Be&&this.isOffscreen(eo,$o,to,Gn),He=He||this.isInsideGrid(eo,$o,to,Gn),l!=="always"&&this.grid.hitTestCircle(Dt,ts,et,l,Q)&&(je=!0,!V))return{circles:[],offscreen:!1,collisionDetected:je}}}}return{circles:!V&&je||!He||Ce<this.perspectiveRatioCutoff?[]:Te,offscreen:Be,collisionDetected:je}}projectPathToScreenSpace(l,f){let v=(function(S,I){let D=o.L();return o.aq(D,I.pitchedLabelPlaneMatrix),S.map((z=>{let V=ka(z.x,z.y,D,I.getElevation),X=I.transform.projectTileCoordinates(V.point.x,V.point.y,I.unwrappedTileID,I.getElevation);return X.point.x=(.5*X.point.x+.5)*I.width,X.point.y=(.5*-X.point.y+.5)*I.height,X}))})(l,f);return(function(S){let I=0,D=0,z=0,V=0;for(let X=0;X<S.length;X++)S[X].isOccluded?(z=X+1,V=0):(V++,V>D&&(D=V,I=z));return S.slice(I,I+D)})(v)}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let f=[],v=new o.a2;for(let ie of l){let re=new o.P(ie.x+Ii,ie.y+Ii);v.extend(re),f.push(re)}let{minX:S,minY:I,maxX:D,maxY:z}=v,V=this.grid.query(S,I,D,z).concat(this.ignoredGrid.query(S,I,D,z)),X={},Q={};for(let ie of V){let re=ie.key;if(X[re.bucketInstanceId]===void 0&&(X[re.bucketInstanceId]={}),X[re.bucketInstanceId][re.featureIndex])continue;let ae=[new o.P(ie.x1,ie.y1),new o.P(ie.x2,ie.y1),new o.P(ie.x2,ie.y2),new o.P(ie.x1,ie.y2)];o.az(f,ae)&&(X[re.bucketInstanceId][re.featureIndex]=!0,Q[re.bucketInstanceId]===void 0&&(Q[re.bucketInstanceId]=[]),Q[re.bucketInstanceId].push(re.featureIndex))}return Q}insertCollisionBox(l,f,v,S,I,D){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:I,collisionGroupID:D,overlapMode:f},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,f,v,S,I,D){let z=v?this.ignoredGrid:this.grid,V={bucketInstanceId:S,featureIndex:I,collisionGroupID:D,overlapMode:f};for(let X=0;X<l.length;X+=4)z.insertCircle(V,l[X],l[X+1],l[X+2])}projectAndGetPerspectiveRatio(l,f,v,S,I){if(I){let D;S?(D=[l,f,S(l,f),1],o.aw(D,D,I)):(D=[l,f,0,1],Oa(D,D,I));let z=D[3];return{x:(D[0]/z+1)/2*this.transform.width+Ii,y:(-D[1]/z+1)/2*this.transform.height+Ii,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{let D=this.transform.projectTileCoordinates(l,f,v,S);return{x:(D.point.x+1)/2*this.transform.width+Ii,y:(1-D.point.y)/2*this.transform.height+Ii,perspectiveRatio:.5+this.transform.cameraToCenterDistance/D.signedDistanceFromCamera*.5,isOccluded:D.isOccluded,signedDistanceFromCamera:D.signedDistanceFromCamera}}}getPerspectiveRatio(l,f,v,S){let I=this.transform.projectTileCoordinates(l,f,v,S);return .5+this.transform.cameraToCenterDistance/I.signedDistanceFromCamera*.5}isOffscreen(l,f,v,S){return v<Ii||l>=this.screenRightBoundary||S<Ii||f>this.screenBottomBoundary}isInsideGrid(l,f,v,S){return v>=0&&l<this.gridRightBoundary&&S>=0&&f<this.gridBottomBoundary}getViewportMatrix(){let l=o.ai([]);return o.M(l,l,[-100,-100,0]),l}_projectCollisionBox(l,f,v,S,I,D,z,V,X,Q,ie){let re=1,ae=0,Ae=0,Te=1,Me=l.anchorPointX+z[0],Ce=l.anchorPointY+z[1];if(D&&!I){let Ht=this.projectAndGetPerspectiveRatio(Me+1,Ce,S,X,ie),kt=Ht.x-V.x,pr=Math.atan((Ht.y-V.y)/kt)+(kt<0?Math.PI:0),Ar=Math.sin(pr),Wi=Math.cos(pr);re=Wi,ae=Ar,Ae=-Ar,Te=Wi}else if(!D&&I){let Ht=wo(this.transform);re=Ht.vecEast[0],ae=Ht.vecEast[1],Ae=Ht.vecSouth[0],Te=Ht.vecSouth[1]}let De=V.x,Ve=V.y,Oe=f;I&&(De=Me,Ve=Ce,Oe=Math.pow(2,-(this.transform.zoom-v.overscaledZ)),Oe*=this.transform.getPitchedTextCorrection(Me,Ce,S),Q||(Oe*=o.ae(.5+V.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Q&&(De+=re*Q.x*Oe+Ae*Q.y*Oe,Ve+=ae*Q.x*Oe+Te*Q.y*Oe);let je=l.x1*Oe,He=l.x2*Oe,Be=(je+He)/2,et=l.y1*Oe,Ke=l.y2*Oe,ct=(et+Ke)/2,Ye=[{offsetX:je,offsetY:et},{offsetX:Be,offsetY:et},{offsetX:He,offsetY:et},{offsetX:He,offsetY:ct},{offsetX:He,offsetY:Ke},{offsetX:Be,offsetY:Ke},{offsetX:je,offsetY:Ke},{offsetX:je,offsetY:ct}],gt=[];for(let{offsetX:Ht,offsetY:kt}of Ye)gt.push(new o.P(De+re*Ht+Ae*kt,Ve+ae*Ht+Te*kt));let Gt=!1;if(I){let Ht=gt.map((kt=>this.projectAndGetPerspectiveRatio(kt.x,kt.y,S,X,ie)));Gt=Ht.some((kt=>!kt.isOccluded)),gt=Ht.map((kt=>new o.P(kt.x,kt.y)))}else Gt=!0;return{box:o.aA(gt),allPointsOccluded:!Gt}}}class vp{constructor(l,f,v,S){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):S&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class of{constructor(l,f,v,S,I){this.text=new vp(l?l.text:null,f,v,I),this.icon=new vp(l?l.icon:null,f,S,I)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $h{constructor(l,f,v){this.text=l,this.icon=f,this.skipFade=v}}class Wh{constructor(l,f,v,S,I){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=v,this.bucketIndex=S,this.tileID=I}}class Rx{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){let f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:v=>v.collisionGroupID===f}}return this.collisionGroups[l]}}function lv(C,l,f,v,S){let{horizontalAlign:I,verticalAlign:D}=o.aH(C);return new o.P(-(I-.5)*l+v[0]*S,-(D-.5)*f+v[1]*S)}class cv{constructor(l,f,v,S,I){this.transform=l.clone(),this.terrain=f,this.collisionIndex=new k4(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new Rx(S),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){let f=this.terrain;return f?(v,S)=>f.getElevation(l,v,S):null}getBucketParts(l,f,v,S){let I=v.getBucket(f),D=v.latestFeatureIndex;if(!I||!D||f.id!==I.layerIds[0])return;let z=v.collisionBoxArray,V=I.layers[0].layout,X=I.layers[0].paint,Q=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),ie=v.tileSize/o.$,re=v.tileID.toUnwrapped(),ae=V.get("text-rotation-alignment")==="map",Ae=o.aC(v,1,this.transform.zoom),Te=o.aD(this.collisionIndex.transform,v,X.get("text-translate"),X.get("text-translate-anchor")),Me=o.aD(this.collisionIndex.transform,v,X.get("icon-translate"),X.get("icon-translate-anchor")),Ce=Vo(ae,this.transform,Ae);this.retainedQueryData[I.bucketInstanceId]=new Wh(I.bucketInstanceId,D,I.sourceLayerIndex,I.index,v.tileID);let De={bucket:I,layout:V,translationText:Te,translationIcon:Me,unwrappedTileID:re,pitchedLabelPlaneMatrix:Ce,scale:Q,textPixelRatio:ie,holdingForFade:v.holdingForSymbolFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:o.an(I.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(I.sourceID)};if(S)for(let Ve of I.sortKeyRanges){let{sortKey:Oe,symbolInstanceStart:je,symbolInstanceEnd:He}=Ve;l.push({sortKey:Oe,symbolInstanceStart:je,symbolInstanceEnd:He,parameters:De})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:De})}attemptAnchorPlacement(l,f,v,S,I,D,z,V,X,Q,ie,re,ae,Ae,Te,Me,Ce,De,Ve,Oe){let je=o.aE[l.textAnchor],He=[l.textOffset0,l.textOffset1],Be=lv(je,v,S,He,I),et=this.collisionIndex.placeCollisionBox(f,re,V,X,Q,z,D,Me,ie.predicate,Ve,Be,Oe);if((!De||this.collisionIndex.placeCollisionBox(De,re,V,X,Q,z,D,Ce,ie.predicate,Ve,Be,Oe).placeable)&&et.placeable){let Ke;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ae.crossTileID]&&this.prevPlacement.placements[ae.crossTileID]&&this.prevPlacement.placements[ae.crossTileID].text&&(Ke=this.prevPlacement.variableOffsets[ae.crossTileID].anchor),ae.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ae.crossTileID]={textOffset:He,width:v,height:S,anchor:je,textBoxScale:I,prevAnchor:Ke},this.markUsedJustification(Ae,je,ae,Te),Ae.allowVerticalPlacement&&(this.markUsedOrientation(Ae,Te,ae),this.placedOrientations[ae.crossTileID]=Te),{shift:Be,placedGlyphBoxes:et}}}placeLayerBucketPart(l,f,v){let{bucket:S,layout:I,translationText:D,translationIcon:z,unwrappedTileID:V,pitchedLabelPlaneMatrix:X,textPixelRatio:Q,holdingForFade:ie,collisionBoxArray:re,partiallyEvaluatedTextSize:ae,collisionGroup:Ae}=l.parameters,Te=I.get("text-optional"),Me=I.get("icon-optional"),Ce=o.aF(I,"text-overlap","text-allow-overlap"),De=Ce==="always",Ve=o.aF(I,"icon-overlap","icon-allow-overlap"),Oe=Ve==="always",je=I.get("text-rotation-alignment")==="map",He=I.get("text-pitch-alignment")==="map",Be=I.get("icon-text-fit")!=="none",et=I.get("symbol-z-order")==="viewport-y",Ke=De&&(Oe||!S.hasIconData()||Me),ct=Oe&&(De||!S.hasTextData()||Te);!S.collisionArrays&&re&&S.deserializeCollisionBoxes(re);let Ye=this.retainedQueryData[S.bucketInstanceId].tileID,gt=this._getTerrainElevationFunc(Ye),Gt=this.transform.getFastPathSimpleProjectionMatrix(Ye),Ht=(kt,pr,Ar)=>{var Wi,An;if(f[kt.crossTileID])return;if(ie)return void(this.placements[kt.crossTileID]=new $h(!1,!1,!1));let kn=!1,St=!1,Dt=!0,ts=null,eo={box:null,placeable:!1,offscreen:null,occluded:!1},$o={placeable:!1},to=null,Gn=null,ro=null,th=0,Ba=0,g=0;pr.textFeatureIndex?th=pr.textFeatureIndex:kt.useRuntimeCollisionCircles&&(th=kt.featureIndex),pr.verticalTextFeatureIndex&&(Ba=pr.verticalTextFeatureIndex);let y=pr.textBox;if(y){let O=K=>{let te=o.ao.horizontal;if(S.allowVerticalPlacement&&!K&&this.prevPlacement){let _e=this.prevPlacement.placedOrientations[kt.crossTileID];_e&&(this.placedOrientations[kt.crossTileID]=_e,te=_e,this.markUsedOrientation(S,te,kt))}return te},B=(K,te)=>{if(S.allowVerticalPlacement&&kt.numVerticalGlyphVertices>0&&pr.verticalTextBox){for(let _e of S.writingModes)if(_e===o.ao.vertical?(eo=te(),$o=eo):eo=K(),eo&&eo.placeable)break}else eo=K()},N=kt.textAnchorOffsetStartIndex,G=kt.textAnchorOffsetEndIndex;if(G===N){let K=(te,_e)=>{let Ee=this.collisionIndex.placeCollisionBox(te,Ce,Q,Ye,V,He,je,D,Ae.predicate,gt,void 0,Gt);return Ee&&Ee.placeable&&(this.markUsedOrientation(S,_e,kt),this.placedOrientations[kt.crossTileID]=_e),Ee};B((()=>K(y,o.ao.horizontal)),(()=>{let te=pr.verticalTextBox;return S.allowVerticalPlacement&&kt.numVerticalGlyphVertices>0&&te?K(te,o.ao.vertical):{box:null,offscreen:null}})),O(eo&&eo.placeable)}else{let K=o.aE[(An=(Wi=this.prevPlacement)===null||Wi===void 0?void 0:Wi.variableOffsets[kt.crossTileID])===null||An===void 0?void 0:An.anchor],te=(Ee,ke,Ie)=>{let qe=Ee.x2-Ee.x1,ot=Ee.y2-Ee.y1,wt=kt.textBoxScale,At=Be&&Ve==="never"?ke:null,ut=null,Xe=Ce==="never"?1:2,Yt="never";K&&Xe++;for(let Mr=0;Mr<Xe;Mr++){for(let dr=N;dr<G;dr++){let Qr=S.textAnchorOffsets.get(dr);if(K&&Qr.textAnchor!==K)continue;let Nr=this.attemptAnchorPlacement(Qr,Ee,qe,ot,wt,je,He,Q,Ye,V,Ae,Yt,kt,S,Ie,D,z,At,gt);if(Nr&&(ut=Nr.placedGlyphBoxes,ut&&ut.placeable))return kn=!0,ts=Nr.shift,ut}K?K=null:Yt=Ce}return v&&!ut&&(ut={box:this.collisionIndex.placeCollisionBox(y,"always",Q,Ye,V,He,je,D,Ae.predicate,gt,void 0,Gt).box,offscreen:!1,placeable:!1,occluded:!1}),ut};B((()=>te(y,pr.iconBox,o.ao.horizontal)),(()=>{let Ee=pr.verticalTextBox;return S.allowVerticalPlacement&&(!eo||!eo.placeable)&&kt.numVerticalGlyphVertices>0&&Ee?te(Ee,pr.verticalIconBox,o.ao.vertical):{box:null,occluded:!0,offscreen:null}})),eo&&(kn=eo.placeable,Dt=eo.offscreen);let _e=O(eo&&eo.placeable);if(!kn&&this.prevPlacement){let Ee=this.prevPlacement.variableOffsets[kt.crossTileID];Ee&&(this.variableOffsets[kt.crossTileID]=Ee,this.markUsedJustification(S,Ee.anchor,kt,_e))}}}if(to=eo,kn=to&&to.placeable,Dt=to&&to.offscreen,kt.useRuntimeCollisionCircles&&kt.centerJustifiedTextSymbolIndex>=0){let O=S.text.placedSymbolArray.get(kt.centerJustifiedTextSymbolIndex),B=o.ap(S.textSizeData,ae,O),N=I.get("text-padding");Gn=this.collisionIndex.placeCollisionCircles(Ce,O,S.lineVertexArray,S.glyphOffsetArray,B,V,X,v,He,Ae.predicate,kt.collisionCircleDiameter,N,D,gt),Gn.circles.length&&Gn.collisionDetected&&!v&&o.w("Collisions detected, but collision boxes are not shown"),kn=De||Gn.circles.length>0&&!Gn.collisionDetected,Dt=Dt&&Gn.offscreen}if(pr.iconFeatureIndex&&(g=pr.iconFeatureIndex),pr.iconBox){let O=B=>this.collisionIndex.placeCollisionBox(B,Ve,Q,Ye,V,He,je,z,Ae.predicate,gt,Be&&ts?ts:void 0,Gt);$o&&$o.placeable&&pr.verticalIconBox?(ro=O(pr.verticalIconBox),St=ro.placeable):(ro=O(pr.iconBox),St=ro.placeable),Dt=Dt&&ro.offscreen}let b=Te||kt.numHorizontalGlyphVertices===0&&kt.numVerticalGlyphVertices===0,T=Me||kt.numIconVertices===0;b||T?T?b||(St=St&&kn):kn=St&&kn:St=kn=St&&kn;let E=St&&ro.placeable;if(kn&&to.placeable&&this.collisionIndex.insertCollisionBox(to.box,Ce,I.get("text-ignore-placement"),S.bucketInstanceId,$o&&$o.placeable&&Ba?Ba:th,Ae.ID),E&&this.collisionIndex.insertCollisionBox(ro.box,Ve,I.get("icon-ignore-placement"),S.bucketInstanceId,g,Ae.ID),Gn&&kn&&this.collisionIndex.insertCollisionCircles(Gn.circles,Ce,I.get("text-ignore-placement"),S.bucketInstanceId,th,Ae.ID),v&&this.storeCollisionData(S.bucketInstanceId,Ar,pr,to,ro,Gn),kt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(S.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[kt.crossTileID]=new $h((kn||Ke)&&!to?.occluded,(St||ct)&&!ro?.occluded,Dt||S.justReloaded),f[kt.crossTileID]=!0};if(et){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let kt=S.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let pr=kt.length-1;pr>=0;--pr){let Ar=kt[pr];Ht(S.symbolInstances.get(Ar),S.collisionArrays[Ar],Ar)}}else for(let kt=l.symbolInstanceStart;kt<l.symbolInstanceEnd;kt++)Ht(S.symbolInstances.get(kt),S.collisionArrays[kt],kt);S.justReloaded=!1}storeCollisionData(l,f,v,S,I,D){if(v.textBox||v.iconBox){let z,V;this.collisionBoxArrays.has(l)?z=this.collisionBoxArrays.get(l):(z=new Map,this.collisionBoxArrays.set(l,z)),z.has(f)?V=z.get(f):(V={text:null,icon:null},z.set(f,V)),v.textBox&&(V.text=S.box),v.iconBox&&(V.icon=I.box)}if(D){let z=this.collisionCircleArrays[l];z===void 0&&(z=this.collisionCircleArrays[l]=[]);for(let V=0;V<D.circles.length;V+=4)z.push(D.circles[V+0]-Ii),z.push(D.circles[V+1]-Ii),z.push(D.circles[V+2]),z.push(D.collisionDetected?1:0)}}markUsedJustification(l,f,v,S){let I;I=S===o.ao.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[o.aG(f)];let D=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(let z of D)z>=0&&(l.text.placedSymbolArray.get(z).crossTileID=I>=0&&z!==I?0:v.crossTileID)}markUsedOrientation(l,f,v){let S=f===o.ao.horizontal||f===o.ao.horizontalOnly?f:0,I=f===o.ao.vertical?f:0,D=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(let z of D)l.text.placedSymbolArray.get(z).placedOrientation=S;v.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=I)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;let f=this.prevPlacement,v=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;let S=f?f.symbolFadeChange(l):1,I=f?f.opacities:{},D=f?f.variableOffsets:{},z=f?f.placedOrientations:{};for(let V in this.placements){let X=this.placements[V],Q=I[V];Q?(this.opacities[V]=new of(Q,S,X.text,X.icon),v=v||X.text!==Q.text.placed||X.icon!==Q.icon.placed):(this.opacities[V]=new of(null,S,X.text,X.icon,X.skipFade),v=v||X.text||X.icon)}for(let V in I){let X=I[V];if(!this.opacities[V]){let Q=new of(X,S,!1,!1);Q.isHidden()||(this.opacities[V]=Q,v=v||X.text.placed||X.icon.placed)}}for(let V in D)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=D[V]);for(let V in z)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=z[V]);if(f&&f.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");v?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)}updateLayerOpacities(l,f){let v={};for(let S of f){let I=S.getBucket(l);I&&S.latestFeatureIndex&&l.id===I.layerIds[0]&&this.updateBucketOpacities(I,S.tileID,v,S.collisionBoxArray)}}updateBucketOpacities(l,f,v,S){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();let I=l.layers[0],D=I.layout,z=new of(null,0,!1,!1,!0),V=D.get("text-allow-overlap"),X=D.get("icon-allow-overlap"),Q=I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ie=D.get("text-rotation-alignment")==="map",re=D.get("text-pitch-alignment")==="map",ae=D.get("icon-text-fit")!=="none",Ae=new of(null,0,V&&(X||!l.hasIconData()||D.get("icon-optional")),X&&(V||!l.hasTextData()||D.get("text-optional")),!0);!l.collisionArrays&&S&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(S);let Te=(Ce,De,Ve)=>{for(let Oe=0;Oe<De/4;Oe++)Ce.opacityVertexArray.emplaceBack(Ve);Ce.hasVisibleVertices=Ce.hasVisibleVertices||Ve!==bp},Me=this.collisionBoxArrays.get(l.bucketInstanceId);for(let Ce=0;Ce<l.symbolInstances.length;Ce++){let De=l.symbolInstances.get(Ce),{numHorizontalGlyphVertices:Ve,numVerticalGlyphVertices:Oe,crossTileID:je}=De,He=this.opacities[je];v[je]?He=z:He||(He=Ae,this.opacities[je]=He),v[je]=!0;let Be=De.numIconVertices>0,et=this.placedOrientations[De.crossTileID],Ke=et===o.ao.vertical,ct=et===o.ao.horizontal||et===o.ao.horizontalOnly;if(Ve>0||Oe>0){let gt=aA(He.text);Te(l.text,Ve,Ke?bp:gt),Te(l.text,Oe,ct?bp:gt);let Gt=He.text.isHidden();[De.rightJustifiedTextSymbolIndex,De.centerJustifiedTextSymbolIndex,De.leftJustifiedTextSymbolIndex].forEach((pr=>{pr>=0&&(l.text.placedSymbolArray.get(pr).hidden=Gt||Ke?1:0)})),De.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(De.verticalPlacedTextSymbolIndex).hidden=Gt||ct?1:0);let Ht=this.variableOffsets[De.crossTileID];Ht&&this.markUsedJustification(l,Ht.anchor,De,et);let kt=this.placedOrientations[De.crossTileID];kt&&(this.markUsedJustification(l,"left",De,kt),this.markUsedOrientation(l,kt,De))}if(Be){let gt=aA(He.icon),Gt=!(ae&&De.verticalPlacedIconSymbolIndex&&Ke);De.placedIconSymbolIndex>=0&&(Te(l.icon,De.numIconVertices,Gt?gt:bp),l.icon.placedSymbolArray.get(De.placedIconSymbolIndex).hidden=He.icon.isHidden()),De.verticalPlacedIconSymbolIndex>=0&&(Te(l.icon,De.numVerticalIconVertices,Gt?bp:gt),l.icon.placedSymbolArray.get(De.verticalPlacedIconSymbolIndex).hidden=He.icon.isHidden())}let Ye=Me&&Me.has(Ce)?Me.get(Ce):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){let gt=l.collisionArrays[Ce];if(gt){let Gt=new o.P(0,0);if(gt.textBox||gt.verticalTextBox){let Ht=!0;if(Q){let kt=this.variableOffsets[je];kt?(Gt=lv(kt.anchor,kt.width,kt.height,kt.textOffset,kt.textBoxScale),ie&&Gt._rotate(re?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ht=!1}if(gt.textBox||gt.verticalTextBox){let kt;gt.textBox&&(kt=Ke),gt.verticalTextBox&&(kt=ct),sf(l.textCollisionBox.collisionVertexArray,He.text.placed,!Ht||kt,Ye.text,Gt.x,Gt.y)}}if(gt.iconBox||gt.verticalIconBox){let Ht=!!(!ct&&gt.verticalIconBox),kt;gt.iconBox&&(kt=Ht),gt.verticalIconBox&&(kt=!Ht),sf(l.iconCollisionBox.collisionVertexArray,He.icon.placed,kt,Ye.icon,ae?Gt.x:0,ae?Gt.y:0)}}}}if(l.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);l.bucketInstanceId in this.collisionCircleArrays&&(l.collisionCircleArray=this.collisionCircleArrays[l.bucketInstanceId],delete this.collisionCircleArrays[l.bucketInstanceId])}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,f){let v=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*v>l}setStale(){this.stale=!0}}function sf(C,l,f,v,S,I){v&&v.length!==0||(v=[0,0,0,0]);let D=v[0]-Ii,z=v[1]-Ii,V=v[2]-Ii,X=v[3]-Ii;C.emplaceBack(l?1:0,f?1:0,S||0,I||0,D,z),C.emplaceBack(l?1:0,f?1:0,S||0,I||0,V,z),C.emplaceBack(l?1:0,f?1:0,S||0,I||0,V,X),C.emplaceBack(l?1:0,f?1:0,S||0,I||0,D,X)}let Ox=Math.pow(2,25),R4=Math.pow(2,24),O4=Math.pow(2,17),D4=Math.pow(2,16),Dx=Math.pow(2,9),Lx=Math.pow(2,8),uv=Math.pow(2,1);function aA(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;let l=C.placed?1:0,f=Math.floor(127*C.opacity);return f*Ox+l*R4+f*O4+l*D4+f*Dx+l*Lx+f*uv+l}let bp=0;class hv{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,f,v,S,I){let D=this._bucketParts;for(;this._currentTileIndex<l.length;)if(f.getBucketParts(D,S,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,I())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(((z,V)=>z.sortKey-V.sortKey)));this._currentPartIndex<D.length;)if(f.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,v),this._currentPartIndex++,I())return!0;return!1}}class dv{constructor(l,f,v,S,I,D,z,V){this.placement=new cv(l,f,D,z,V),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(l,f,v){let S=M(),I=()=>!this._forceFullPlacement&&M()-S>2;for(;this._currentPlacementIndex>=0;){let D=f[l[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=z)&&(!D.maxzoom||D.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new hv(D)),this._inProgressLayer.continuePlacement(v[D.source],this.placement,this._showCollisionBoxes,D,I))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}let sm=512/o.$/2;class am{constructor(l,f,v){this.tileID=l,this.bucketInstanceId=v,this._symbolsByKey={};let S=new Map;for(let I=0;I<f.length;I++){let D=f.get(I),z=D.key,V=S.get(z);V?V.push(D):S.set(z,[D])}for(let[I,D]of S){let z={positions:D.map((V=>({x:Math.floor(V.anchorX*sm),y:Math.floor(V.anchorY*sm)}))),crossTileIDs:D.map((V=>V.crossTileID))};if(z.positions.length>128){let V=new o.aI(z.positions.length,16,Uint16Array);for(let{x:X,y:Q}of z.positions)V.add(X,Q);V.finish(),delete z.positions,z.index=V}this._symbolsByKey[I]=z}}getScaledCoordinates(l,f){let{x:v,y:S,z:I}=this.tileID.canonical,{x:D,y:z,z:V}=f.canonical,X=sm/Math.pow(2,V-I),Q=(z*o.$+l.anchorY)*X,ie=S*o.$*sm;return{x:Math.floor((D*o.$+l.anchorX)*X-v*o.$*sm),y:Math.floor(Q-ie)}}findMatches(l,f,v){let S=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let I=0;I<l.length;I++){let D=l.get(I);if(D.crossTileID)continue;let z=this._symbolsByKey[D.key];if(!z)continue;let V=this.getScaledCoordinates(D,f);if(z.index){let X=z.index.range(V.x-S,V.y-S,V.x+S,V.y+S).sort();for(let Q of X){let ie=z.crossTileIDs[Q];if(!v[ie]){v[ie]=!0,D.crossTileID=ie;break}}}else if(z.positions)for(let X=0;X<z.positions.length;X++){let Q=z.positions[X],ie=z.crossTileIDs[X];if(Math.abs(Q.x-V.x)<=S&&Math.abs(Q.y-V.y)<=S&&!v[ie]){v[ie]=!0,D.crossTileID=ie;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:l})=>l))}}class lA{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Bx{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){let f=Math.round((l-this.lng)/360);if(f!==0)for(let v in this.indexes){let S=this.indexes[v],I={};for(let D in S){let z=S[D];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+f),I[z.tileID.key]=z}this.indexes[v]=I}this.lng=l}addBucket(l,f,v){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let I=0;I<f.symbolInstances.length;I++)f.symbolInstances.get(I).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});let S=this.usedCrossTileIDs[l.overscaledZ];for(let I in this.indexes){let D=this.indexes[I];if(Number(I)>l.overscaledZ)for(let z in D){let V=D[z];V.tileID.isChildOf(l)&&V.findMatches(f.symbolInstances,l,S)}else{let z=D[l.scaledTo(Number(I)).key];z&&z.findMatches(f.symbolInstances,l,S)}}for(let I=0;I<f.symbolInstances.length;I++){let D=f.symbolInstances.get(I);D.crossTileID||(D.crossTileID=v.generate(),S[D.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new am(l,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(l,f){for(let v of f.getCrossTileIDsLists())for(let S of v)delete this.usedCrossTileIDs[l][S]}removeStaleBuckets(l){let f=!1;for(let v in this.indexes){let S=this.indexes[v];for(let I in S)l[S[I].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,S[I]),delete S[I],f=!0)}return f}}class af{constructor(){this.layerIndexes={},this.crossTileIDs=new lA,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,f,v){let S=this.layerIndexes[l.id];S===void 0&&(S=this.layerIndexes[l.id]=new Bx);let I=!1,D={};S.handleWrapJump(v);for(let z of f){let V=z.getBucket(l);V&&l.id===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(z.tileID,V,this.crossTileIDs)&&(I=!0),D[V.bucketInstanceId]=!0)}return S.removeStaleBuckets(D)&&(I=!0),I}pruneUnusedLayers(l){let f={};l.forEach((v=>{f[v]=!0}));for(let v in this.layerIndexes)f[v]||delete this.layerIndexes[v]}}var fv="void main() {fragColor=vec4(1.0);}";let iu={prelude:gi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:gi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:gi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:gi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:gi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:gi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:gi(fv,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:gi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:gi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:gi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:gi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:gi(fv,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:gi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:gi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:gi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:gi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:gi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:gi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:gi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:gi(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:gi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:gi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:gi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:gi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:gi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:gi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:gi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:gi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:gi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:gi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:gi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function gi(C,l){let f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=l.match(/in ([\w]+) ([\w]+)/g),S=C.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=I?I.concat(S):S,z={};return{fragmentSource:C=C.replace(f,((V,X,Q,ie,re)=>(z[re]=!0,X==="define"?`
#ifndef HAS_UNIFORM_u_${re}
in ${Q} ${ie} ${re};
#else
uniform ${Q} ${ie} u_${re};
#endif
`:`
#ifdef HAS_UNIFORM_u_${re}
    ${Q} ${ie} ${re} = u_${re};
#endif
`))),vertexSource:l=l.replace(f,((V,X,Q,ie,re)=>{let ae=ie==="float"?"vec2":"vec4",Ae=re.match(/color/)?"color":ae;return z[re]?X==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${Q} ${ae} a_${re};
out ${Q} ${ie} ${re};
#else
uniform ${Q} ${ie} u_${re};
#endif
`:Ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = a_${re};
#else
    ${Q} ${ie} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = unpack_mix_${Ae}(a_${re}, u_${re}_t);
#else
    ${Q} ${ie} ${re} = u_${re};
#endif
`:X==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${Q} ${ae} a_${re};
#else
uniform ${Q} ${ie} u_${re};
#endif
`:Ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${Q} ${ie} ${re} = a_${re};
#else
    ${Q} ${ie} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${Q} ${ie} ${re} = unpack_mix_${Ae}(a_${re}, u_${re}_t);
#else
    ${Q} ${ie} ${re} = u_${re};
#endif
`})),staticAttributes:v,staticUniforms:D}}class bc{constructor(l,f,v){this.vertexBuffer=l,this.indexBuffer=f,this.segments=v}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ci=o.aJ([{name:"a_pos",type:"Int16",components:2}]);let cA="#define PROJECTION_MERCATOR",Fx="mercator";class lm{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Fx}get shaderDefine(){return cA}get shaderPreludeCode(){return iu.projectionMercator}get vertexShaderPreludeCode(){return iu.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(l){}getMeshFromTileID(l,f,v,S,I){if(this._cachedMesh)return this._cachedMesh;let D=new o.aL;D.emplaceBack(0,0),D.emplaceBack(o.$,0),D.emplaceBack(0,o.$),D.emplaceBack(o.$,o.$);let z=l.createVertexBuffer(D,ci.members),V=o.aM.simpleSegment(0,0,4,2),X=new o.aN;X.emplaceBack(1,0,2),X.emplaceBack(1,2,3);let Q=l.createIndexBuffer(X);return this._cachedMesh=new bc(z,Q,V),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(l){}}class Gs{constructor(l=0,f=0,v=0,S=0){if(isNaN(l)||l<0||isNaN(f)||f<0||isNaN(v)||v<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=f,this.left=v,this.right=S}interpolate(l,f,v){return f.top!=null&&l.top!=null&&(this.top=o.C.number(l.top,f.top,v)),f.bottom!=null&&l.bottom!=null&&(this.bottom=o.C.number(l.bottom,f.bottom,v)),f.left!=null&&l.left!=null&&(this.left=o.C.number(l.left,f.left,v)),f.right!=null&&l.right!=null&&(this.right=o.C.number(l.right,f.right,v)),this}getCenter(l,f){let v=o.ae((this.left+l-this.right)/2,0,l),S=o.ae((this.top+f-this.bottom)/2,0,f);return new o.P(v,S)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Gs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ts(C,l){if(!C.renderWorldCopies||C.lngRange)return;let f=l.lng-C.center.lng;l.lng+=f>180?-360:f<-180?360:0}function ca(C){return Math.max(0,Math.floor(C))}class hs{constructor(l,f){var v;this._callbacks=l,this._tileSize=512,this._renderWorldCopies=f?.renderWorldCopies===void 0||!!f?.renderWorldCopies,this._minZoom=f?.minZoom||0,this._maxZoom=f?.maxZoom||22,this._minPitch=f?.minPitch==null?0:f?.minPitch,this._maxPitch=f?.maxPitch==null?60:f?.maxPitch,this._constrain=(v=f?.constrain)!==null&&v!==void 0?v:this._callbacks.constrain,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=ca(this._zoom),this._scale=o.ah(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Gs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(l,f,v){this._latRange=l.latRange,this._lngRange=l.lngRange,this._width=l.width,this._height=l.height,this._center=l.center,this._elevation=l.elevation,this._minElevationForCurrentTile=l.minElevationForCurrentTile,this._zoom=l.zoom,this._tileZoom=ca(this._zoom),this._scale=o.ah(this._zoom),this._bearingInRadians=l.bearingInRadians,this._fovInRadians=l.fovInRadians,this._pitchInRadians=l.pitchInRadians,this._rollInRadians=l.rollInRadians,this._unmodified=l.unmodified,this._edgeInsets=new Gs(l.padding.top,l.padding.bottom,l.padding.left,l.padding.right),this._minZoom=l.minZoom,this._maxZoom=l.maxZoom,this._minPitch=l.minPitch,this._maxPitch=l.maxPitch,this._renderWorldCopies=l.renderWorldCopies,this._cameraToCenterDistance=l.cameraToCenterDistance,this._nearZ=l.nearZ,this._farZ=l.farZ,this._autoCalculateNearFarZ=!v&&l.autoCalculateNearFarZ,f&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(l){this._minElevationForCurrentTile=l}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(l){this._minZoom!==l&&(this._minZoom=l,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(l){this._minPitch!==l&&(this._minPitch=l,this.setPitch(Math.max(this.pitch,l)))}get maxPitch(){return this._maxPitch}setMaxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.setPitch(Math.min(this.pitch,l)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get constrain(){return this._constrain}setConstrain(l){l||(l=this._callbacks.constrain),this._constrain=l,this.constrainInternal(),this._calcMatrices()}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(l){let f=o.aO(l,-180,180)*Math.PI/180;var v,S,I,D,z,V,X,Q,ie;this._bearingInRadians!==f&&(this._unmodified=!1,this._bearingInRadians=f,this._calcMatrices(),this._rotationMatrix=a(),v=this._rotationMatrix,I=-this._bearingInRadians,D=(S=this._rotationMatrix)[0],z=S[1],V=S[2],X=S[3],Q=Math.sin(I),ie=Math.cos(I),v[0]=D*ie+V*Q,v[1]=z*ie+X*Q,v[2]=D*-Q+V*ie,v[3]=z*-Q+X*ie)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(l){let f=o.ae(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==f&&(this._unmodified=!1,this._pitchInRadians=f,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(l){let f=l/180*Math.PI;this._rollInRadians!==f&&(this._unmodified=!1,this._rollInRadians=f,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aP(this._fovInRadians)}setFov(l){l=o.ae(l,.1,150),this.fov!==l&&(this._unmodified=!1,this._fovInRadians=o.ag(l),this._calcMatrices())}get zoom(){return this._zoom}setZoom(l){let f=this.constrain(this._center,l).zoom;this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this._tileZoom=Math.max(0,Math.floor(f)),this._scale=o.ah(f),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(l){l!==this._elevation&&(this._elevation=l,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(l,f){this._autoCalculateNearFarZ=!1,this._nearZ=l,this._farZ=f,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,f,v){this._unmodified=!1,this._edgeInsets.interpolate(l,f,v),this.constrainInternal(),this._calcMatrices()}resize(l,f,v=!0){this._width=l,this._height=f,v&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new dn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(l){l?(this._lngRange=[l.getWest(),l.getEast()],this._latRange=[l.getSouth(),l.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.af,o.af])}getCameraQueryGeometry(l,f){if(f.length===1)return[f[0],l];{let{minX:v,minY:S,maxX:I,maxY:D}=o.a2.fromPoints(f).extend(l);return[new o.P(v,S),new o.P(I,S),new o.P(I,D),new o.P(v,D),new o.P(v,S)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let l=this._unmodified,{center:f,zoom:v}=this.constrain(this.center,this.zoom);this.setCenter(f),this.setZoom(v),this._unmodified=l,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let l=o.ai(new Float64Array(16));o.N(l,l,[this._width/2,-this._height/2,1]),o.M(l,l,[1,-1,0]),this._clipSpaceToPixelsMatrix=l,l=o.ai(new Float64Array(16)),o.N(l,l,[1,-1,1]),o.M(l,l,[-1,-1,0]),o.N(l,l,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=l,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(l,f,v,S){let I=v!==void 0?v:this.bearing,D=S=S!==void 0?S:this.pitch,z=o.a1.fromLngLat(l,f),V=-Math.cos(o.ag(D)),X=Math.sin(o.ag(D)),Q=X*Math.sin(o.ag(I)),ie=-X*Math.cos(o.ag(I)),re=this.elevation,ae=f-re,Ae;V*ae>=0||Math.abs(V)<.1?(Ae=1e4,re=f+Ae*V):Ae=-ae/V;let Te,Me,Ce=o.aQ(1,z.y),De=0;do{if(De+=1,De>10)break;Me=Ae/Ce,Te=new o.a1(z.x+Q*Me,z.y+ie*Me),Ce=1/Te.meterInMercatorCoordinateUnits()}while(Math.abs(Ae-Me*Ce)>1e-12);return{center:Te.toLngLat(),elevation:re,zoom:o.ak(this.height/2/Math.tan(this.fovInRadians/2)/Me/this.tileSize)}}recalculateZoomAndCenter(l){if(this.elevation-l==0)return;let f=o.aj(1,this.center.lat)*this.worldSize,v=this.cameraToCenterDistance/f,S=o.a1.fromLngLat(this.center,this.elevation),I=Ft(this.center,this.elevation,this.pitch,this.bearing,v);this._elevation=l;let D=this.calculateCenterFromCameraLngLatAlt(I.toLngLat(),o.aQ(I.z,S.y),this.bearing,this.pitch);this._elevation=D.elevation,this._center=D.center,this.setZoom(D.zoom)}getCameraPoint(){let l=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(l*Math.sin(this.rollInRadians),l*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let l=o.aj(1,this.center.lat)*this.worldSize;return Ft(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/l).toLngLat()}getMercatorTileCoordinates(l){if(!l)return[0,0,1,1];let f=l.canonical.z>=0?1<<l.canonical.z:Math.pow(2,l.canonical.z);return[l.canonical.x/f,l.canonical.y/f,1/f/o.$,1/f/o.$]}}class $n{constructor(l,f){this.min=l,this.max=f,this.center=o.aR([],o.aS([],this.min,this.max),.5)}quadrant(l){let f=[l%2==0,l<2],v=o.aT(this.min),S=o.aT(this.max);for(let I=0;I<f.length;I++)v[I]=f[I]?this.min[I]:this.center[I],S[I]=f[I]?this.center[I]:this.max[I];return S[2]=this.max[2],new $n(v,S)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersectsFrustum(l){let f=!0;for(let v=0;v<l.planes.length;v++){let S=this.intersectsPlane(l.planes[v]);if(S===0)return 0;S===1&&(f=!1)}return f?2:l.aabb.min[0]>this.max[0]||l.aabb.min[1]>this.max[1]||l.aabb.min[2]>this.max[2]||l.aabb.max[0]<this.min[0]||l.aabb.max[1]<this.min[1]||l.aabb.max[2]<this.min[2]?0:1}intersectsPlane(l){let f=l[3],v=l[3];for(let S=0;S<3;S++)l[S]>0?(f+=l[S]*this.min[S],v+=l[S]*this.max[S]):(v+=l[S]*this.min[S],f+=l[S]*this.max[S]);return f>=0?2:v<0?0:1}}class L4{distanceToTile2d(l,f,v,S){let I=S.distanceX([l,f]),D=S.distanceY([l,f]);return Math.hypot(I,D)}getWrap(l,f,v){return v}getTileBoundingVolume(l,f,v,S){var I,D;let z=0,V=0;if(S?.terrain){let Q=new o.Z(l.z,f,l.z,l.x,l.y),ie=S.terrain.getMinMaxElevation(Q);z=(I=ie.minElevation)!==null&&I!==void 0?I:Math.min(0,v),V=(D=ie.maxElevation)!==null&&D!==void 0?D:Math.max(0,v)}let X=1<<l.z;return new $n([f+l.x/X,l.y/X,z],[f+(l.x+1)/X,(l.y+1)/X,V])}allowVariableZoom(l,f){let v=l.fov*(Math.abs(Math.cos(l.rollInRadians))*l.height+Math.abs(Math.sin(l.rollInRadians))*l.width)/l.height,S=o.ae(78.5-v/2,0,60);return!!f.terrain||l.pitch>S}allowWorldCopies(){return!0}prepareNextFrame(){}}class Hs{constructor(l,f,v){this.points=l,this.planes=f,this.aabb=v}static fromInvProjectionMatrix(l,f=1,v=0,S,I){let D=I?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],z=Math.pow(2,v),V=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((re=>(function(ae,Ae,Te,Me){let Ce=o.aw([],ae,Ae),De=1/Ce[3]/Te*Me;return o.aY(Ce,Ce,[De,De,1/Ce[3],De])})(re,l,f,z)));S&&(function(re,ae,Ae,Te){let Me=Te?4:0,Ce=Te?0:4,De=0,Ve=[],Oe=[];for(let Be=0;Be<4;Be++){let et=o.aU([],re[Be+Ce],re[Be+Me]),Ke=o.aZ(et);o.aR(et,et,1/Ke),Ve.push(Ke),Oe.push(et)}for(let Be=0;Be<4;Be++){let et=o.a_(re[Be+Me],Oe[Be],Ae);De=et!==null&&et>=0?Math.max(De,et):Math.max(De,Ve[Be])}let je=(function(Be,et){let Ke=o.aU([],Be[et[0]],Be[et[1]]),ct=o.aU([],Be[et[2]],Be[et[1]]),Ye=[0,0,0,0];return o.aV(Ye,o.aW([],Ke,ct)),Ye[3]=-o.aX(Ye,Be[et[0]]),Ye})(re,ae),He=(function(Be,et){let Ke=o.a$(Be),ct=o.b0([],Be,1/Ke),Ye=o.aU([],et,o.aR([],ct,o.aX(et,ct))),gt=o.a$(Ye);if(gt>0){let Gt=Math.sqrt(1-ct[3]*ct[3]),Ht=o.aR([],ct,-ct[3]),kt=o.aS([],Ht,o.aR([],Ye,Gt/gt));return o.b1(et,kt)}return null})(Ae,je);if(He!==null){let Be=He/o.aX(Oe[0],je);De=Math.min(De,Be)}for(let Be=0;Be<4;Be++){let et=Math.min(De,Ve[Be]);re[Be+Ce]=[re[Be+Me][0]+Oe[Be][0]*et,re[Be+Me][1]+Oe[Be][1]*et,re[Be+Me][2]+Oe[Be][2]*et,1]}})(V,D[0],S,I);let X=D.map((re=>{let ae=o.aU([],V[re[0]],V[re[1]]),Ae=o.aU([],V[re[2]],V[re[1]]),Te=o.aV([],o.aW([],ae,Ae)),Me=-o.aX(Te,V[re[1]]);return Te.concat(Me)})),Q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],ie=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let re of V)for(let ae=0;ae<3;ae++)Q[ae]=Math.min(Q[ae],re[ae]),ie[ae]=Math.max(ie[ae],re[ae]);return new Hs(V,X,new $n(Q,ie))}}class qs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,f,v){return this._helper.interpolatePadding(l,f,v)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,f,v=!0){this._helper.resize(l,f,v)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrain(l){this._helper.setConstrain(l)}overrideNearFarZ(l,f){this._helper.overrideNearFarZ(l,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l,f){}constructor(l){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(f,v)=>{v=o.ae(+v,this.minZoom,this.maxZoom);let S={center:new o.S(f.lng,f.lat),zoom:v},I=this._helper._lngRange;if(!this._helper._renderWorldCopies&&I===null){let Oe=179.9999999999;I=[-Oe,Oe]}let D=this.tileSize*o.ah(S.zoom),z=0,V=D,X=0,Q=D,ie=0,re=0,{x:ae,y:Ae}=this.size;if(this._helper._latRange){let Oe=this._helper._latRange;z=o.U(Oe[1])*D,V=o.U(Oe[0])*D,V-z<Ae&&(ie=Ae/(V-z))}I&&(X=o.aO(o.V(I[0])*D,0,D),Q=o.aO(o.V(I[1])*D,0,D),Q<X&&(Q+=D),Q-X<ae&&(re=ae/(Q-X)));let{x:Te,y:Me}=tt(D,f),Ce,De,Ve=Math.max(re||0,ie||0);if(Ve){let Oe=new o.P(re?(Q+X)/2:Te,ie?(V+z)/2:Me);return S.center=yt(D,Oe).wrap(),S.zoom+=o.ak(Ve),S}if(this._helper._latRange){let Oe=Ae/2;Me-Oe<z&&(De=z+Oe),Me+Oe>V&&(De=V-Oe)}if(I){let Oe=(X+Q)/2,je=Te;this._helper._renderWorldCopies&&(je=o.aO(Te,Oe-D/2,Oe+D/2));let He=ae/2;je-He<X&&(Ce=X+He),je+He>Q&&(Ce=Q-He)}if(Ce!==void 0||De!==void 0){let Oe=new o.P(Ce??Te,De??Me);S.center=yt(D,Oe).wrap()}return S},this._helper=new hs({calcMatrices:()=>{this._calcMatrices()},constrain:(f,v)=>this.defaultConstrain(f,v)},l),this._coveringTilesDetailsProvider=new L4}clone(){let l=new qs;return l.apply(this),l}apply(l,f,v){this._helper.apply(l,f,v)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(l){let f=[new o.b2(0,l)];if(this._helper._renderWorldCopies){let v=this.screenPointToMercatorCoordinate(new o.P(0,0)),S=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),I=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),D=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),z=Math.floor(Math.min(v.x,S.x,I.x,D.x)),V=Math.floor(Math.max(v.x,S.x,I.x,D.x)),X=1;for(let Q=z-X;Q<=V+X;Q++)Q!==0&&f.push(new o.b2(Q,l))}return f}getCameraFrustum(){return Hs.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){let f=this.screenPointToLocation(this.centerPoint,l),v=l?l.getElevationForLngLatZoom(f,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(v)}setLocationAtPoint(l,f){let v=o.aj(this.elevation,this.center.lat),S=this.screenPointToMercatorCoordinateAtZ(f,v),I=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,v),D=o.a1.fromLngLat(l),z=new o.a1(D.x-(S.x-I.x),D.y-(S.y-I.y));this.setCenter(z?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(l,f){return f?this.coordinatePoint(o.a1.fromLngLat(l),f.getElevationForLngLatZoom(l,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.a1.fromLngLat(l))}screenPointToLocation(l,f){var v;return(v=this.screenPointToMercatorCoordinate(l,f))===null||v===void 0?void 0:v.toLngLat()}screenPointToMercatorCoordinate(l,f){if(f){let v=f.pointCoordinate(l);if(v!=null)return v}return this.screenPointToMercatorCoordinateAtZ(l)}screenPointToMercatorCoordinateAtZ(l,f){let v=f||0,S=[l.x,l.y,0,1],I=[l.x,l.y,1,1];o.aw(S,S,this._pixelMatrixInverse),o.aw(I,I,this._pixelMatrixInverse);let D=S[3],z=I[3],V=S[1]/D,X=I[1]/z,Q=S[2]/D,ie=I[2]/z,re=Q===ie?0:(v-Q)/(ie-Q);return new o.a1(o.C.number(S[0]/D,I[0]/z,re)/this.worldSize,o.C.number(V,X,re)/this.worldSize,v)}coordinatePoint(l,f=0,v=this._pixelMatrix){let S=[l.x*this.worldSize,l.y*this.worldSize,f,1];return o.aw(S,S,v),new o.P(S[0]/S[3],S[1]/S[3])}getBounds(){let l=Math.max(0,this._helper._height/2-it(this));return new dn().extend(this.screenPointToLocation(new o.P(0,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,l))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(l,f){return f?f.pointCoordinate(l)!=null:l.y>this.height/2-it(this)}calculatePosMatrix(l,f=!1,v){var S;let I=(S=l.key)!==null&&S!==void 0?S:o.b3(l.wrap,l.canonical.z,l.canonical.z,l.canonical.x,l.canonical.y),D=f?this._alignedPosMatrixCache:this._posMatrixCache;if(D.has(I)){let X=D.get(I);return v?X.f32:X.f64}let z=xt(l,this.worldSize);o.O(z,f?this._alignedProjMatrix:this._viewProjMatrix,z);let V={f64:z,f32:new Float32Array(z)};return D.set(I,V),v?V.f32:V.f64}calculateFogMatrix(l){let f=l.key,v=this._fogMatrixCacheF32;if(v.has(f))return v.get(f);let S=xt(l,this.worldSize);return o.O(S,this._fogMatrix,S),v.set(f,new Float32Array(S)),v.get(f)}calculateCenterFromCameraLngLatAlt(l,f,v,S){return this._helper.calculateCenterFromCameraLngLatAlt(l,f,v,S)}_calculateNearFarZIfNeeded(l,f,v){if(!this._helper.autoCalculateNearFarZ)return;let S=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),I=l-S*this._helper._pixelPerMeter/Math.cos(f),D=S<0?I:l,z=Math.PI/2+this.pitchInRadians,V=o.ag(this.fov)*(Math.abs(Math.cos(o.ag(this.roll)))*this.height+Math.abs(Math.sin(o.ag(this.roll)))*this.width)/this.height*(.5+v.y/this.height),X=Math.sin(V)*D/Math.sin(o.ae(Math.PI-z-V,.01,Math.PI-.01)),Q=it(this),ie=Math.atan(Q/this._helper.cameraToCenterDistance),re=o.ag(.75),ae=ie>re?2*ie*(.5+v.y/(2*Q)):re,Ae=Math.sin(ae)*D/Math.sin(o.ae(Math.PI-z-ae,.01,Math.PI-.01)),Te=Math.min(X,Ae);this._helper._farZ=1.01*(Math.cos(Math.PI/2-f)*Te+D),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let l=this.centerOffset,f=tt(this.worldSize,this.center),v=f.x,S=f.y;this._helper._pixelPerMeter=o.aj(1,this.center.lat)*this.worldSize;let I=o.ag(Math.min(this.pitch,$e)),D=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(I)),z;this._calculateNearFarZIfNeeded(D,I,l),z=new Float64Array(16),o.b4(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aq(this._invProjMatrix,z),z[8]=2*-l.x/this._helper._width,z[9]=2*l.y/this._helper._height,this._projectionMatrix=o.b5(z),o.N(z,z,[1,-1,1]),o.M(z,z,[0,0,-this._helper.cameraToCenterDistance]),o.b6(z,z,-this.rollInRadians),o.b7(z,z,this.pitchInRadians),o.b6(z,z,-this.bearingInRadians),o.M(z,z,[-v,-S,0]),this._mercatorMatrix=o.N([],z,[this.worldSize,this.worldSize,this.worldSize]),o.N(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),o.M(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=o.aq([],z);let V=[0,0,-1,1];o.aw(V,V,this._invViewProjMatrix),this._cameraPosition=[V[0]/V[3],V[1]/V[3],V[2]/V[3]],this._fogMatrix=new Float64Array(16),o.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,D,this._helper._farZ),this._fogMatrix[8]=2*-l.x/this.width,this._fogMatrix[9]=2*l.y/this.height,o.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.M(this._fogMatrix,this._fogMatrix,[-v,-S,0]),o.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);let X=this._helper._width%2/2,Q=this._helper._height%2/2,ie=Math.cos(this.bearingInRadians),re=Math.sin(-this.bearingInRadians),ae=v-Math.round(v)+ie*X+re*Q,Ae=S-Math.round(S)+ie*Q+re*X,Te=new Float64Array(z);if(o.M(Te,Te,[ae>.5?ae-1:ae,Ae>.5?Ae-1:Ae,0]),this._alignedProjMatrix=Te,z=o.aq(new Float64Array(16),this._pixelMatrix),!z)throw new Error("failed to invert matrix");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let l=this.screenPointToMercatorCoordinate(new o.P(0,0)),f=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.aw(f,f,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let l=o.aj(1,this.center.lat)*this.worldSize;return Ft(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/l).toLngLat()}lngLatToCameraDepth(l,f){let v=o.a1.fromLngLat(l),S=[v.x*this.worldSize,v.y*this.worldSize,f,1];return o.aw(S,S,this._viewProjMatrix),S[2]/S[3]}getProjectionData(l){let{overscaledTileID:f,aligned:v,applyTerrainMatrix:S}=l,I=this._helper.getMercatorTileCoordinates(f),D=f?this.calculatePosMatrix(f,v,!0):null,z;return z=f&&f.terrainRttPosMatrix32f&&S?f.terrainRttPosMatrix32f:D||o.b8(),{mainMatrix:z,tileMercatorCoords:I,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(l){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(l,f,v){return 1}transformLightDirection(l){return o.aT(l)}getRayDirectionFromPixel(l){throw new Error("Not implemented.")}projectTileCoordinates(l,f,v,S){let I=this.calculatePosMatrix(v),D;S?(D=[l,f,S(l,f),1],o.aw(D,D,I)):(D=[l,f,0,1],Oa(D,D,I));let z=D[3];return{point:new o.P(D[0]/z,D[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(l){for(let f of l)this.calculatePosMatrix(f)}getMatrixForModel(l,f){let v=o.a1.fromLngLat(l,f),S=v.meterInMercatorCoordinateUnits(),I=o.b9();return o.M(I,I,[v.x,v.y,v.z]),o.b6(I,I,Math.PI),o.b7(I,I,Math.PI/2),o.N(I,I,[-S,S,S]),I}getProjectionDataForCustomLayer(l=!0){let f=new o.Z(0,0,0,0,0),v=this.getProjectionData({overscaledTileID:f,applyGlobeMatrix:l}),S=xt(f,this.worldSize);o.O(S,this._viewProjMatrix,S),v.tileMercatorCoords=[0,0,1,1];let I=[o.$,o.$,this.worldSize/this._helper.pixelsPerMeter],D=o.ba();return o.N(D,S,I),v.fallbackMatrix=D,v.mainMatrix=D,v}getFastPathSimpleProjectionMatrix(l){return this.calculatePosMatrix(l)}}function Ja(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function pv(C){if(C.useSlerp)if(C.k<1){let l=o.bb(C.startEulerAngles.roll,C.startEulerAngles.pitch,C.startEulerAngles.bearing),f=o.bb(C.endEulerAngles.roll,C.endEulerAngles.pitch,C.endEulerAngles.bearing),v=new Float64Array(4);o.bc(v,l,f,C.k);let S=o.bd(v);C.tr.setRoll(S.roll),C.tr.setPitch(S.pitch),C.tr.setBearing(S.bearing)}else C.tr.setRoll(C.endEulerAngles.roll),C.tr.setPitch(C.endEulerAngles.pitch),C.tr.setBearing(C.endEulerAngles.bearing);else C.tr.setRoll(o.C.number(C.startEulerAngles.roll,C.endEulerAngles.roll,C.k)),C.tr.setPitch(o.C.number(C.startEulerAngles.pitch,C.endEulerAngles.pitch,C.k)),C.tr.setBearing(o.C.number(C.startEulerAngles.bearing,C.endEulerAngles.bearing,C.k))}function xp(C,l,f,v,S){let I=S.padding,D=tt(S.worldSize,f.getNorthWest()),z=tt(S.worldSize,f.getNorthEast()),V=tt(S.worldSize,f.getSouthEast()),X=tt(S.worldSize,f.getSouthWest()),Q=o.ag(-v),ie=D.rotate(Q),re=z.rotate(Q),ae=V.rotate(Q),Ae=X.rotate(Q),Te=new o.P(Math.max(ie.x,re.x,Ae.x,ae.x),Math.max(ie.y,re.y,Ae.y,ae.y)),Me=new o.P(Math.min(ie.x,re.x,Ae.x,ae.x),Math.min(ie.y,re.y,Ae.y,ae.y)),Ce=Te.sub(Me),De=(S.width-(I.left+I.right+l.left+l.right))/Ce.x,Ve=(S.height-(I.top+I.bottom+l.top+l.bottom))/Ce.y;if(Ve<0||De<0)return void Ja();let Oe=Math.min(o.ak(S.scale*Math.min(De,Ve)),C.maxZoom),je=o.P.convert(C.offset),He=new o.P((l.left-l.right)/2,(l.top-l.bottom)/2).rotate(o.ag(v)),Be=je.add(He).mult(S.scale/o.ah(Oe));return{center:yt(S.worldSize,D.add(V).div(2).sub(Be)),zoom:Oe,bearing:v}}class uo{get useGlobeControls(){return!1}handlePanInertia(l,f){let v=l.mag(),S=Math.abs(it(f));return{easingOffset:l.mult(Math.min(.75*S/v,1)),easingCenter:f.center}}handleMapControlsRollPitchBearingZoom(l,f){l.bearingDelta&&f.setBearing(f.bearing+l.bearingDelta),l.pitchDelta&&f.setPitch(f.pitch+l.pitchDelta),l.rollDelta&&f.setRoll(f.roll+l.rollDelta),l.zoomDelta&&f.setZoom(f.zoom+l.zoomDelta)}handleMapControlsPan(l,f,v){l.around.distSqr(f.centerPoint)<.01||f.setLocationAtPoint(v,l.around)}cameraForBoxAndBearing(l,f,v,S,I){return xp(l,f,v,S,I)}handleJumpToCenterZoom(l,f){l.zoom!==(f.zoom!==void 0?+f.zoom:l.zoom)&&l.setZoom(+f.zoom),f.center!==void 0&&l.setCenter(o.S.convert(f.center))}handleEaseTo(l,f){let v=l.zoom,S=l.padding,I={roll:l.roll,pitch:l.pitch,bearing:l.bearing},D={roll:f.roll===void 0?l.roll:f.roll,pitch:f.pitch===void 0?l.pitch:f.pitch,bearing:f.bearing===void 0?l.bearing:f.bearing},z=f.zoom!==void 0,V=!l.isPaddingEqual(f.padding),X=!1,Q=z?+f.zoom:l.zoom,ie=l.centerPoint.add(f.offsetAsPoint),re=l.screenPointToLocation(ie),{center:ae,zoom:Ae}=l.constrain(o.S.convert(f.center||re),Q??v);Ts(l,ae);let Te=tt(l.worldSize,re),Me=tt(l.worldSize,ae).sub(Te),Ce=o.ah(Ae-v);return X=Ae!==v,{easeFunc:De=>{if(X&&l.setZoom(o.C.number(v,Ae,De)),o.be(I,D)||pv({startEulerAngles:I,endEulerAngles:D,tr:l,k:De,useSlerp:I.roll!=D.roll}),V&&(l.interpolatePadding(S,f.padding,De),ie=l.centerPoint.add(f.offsetAsPoint)),f.around)l.setLocationAtPoint(f.around,f.aroundPoint);else{let Ve=o.ah(l.zoom-v),Oe=Ae>v?Math.min(2,Ce):Math.max(.5,Ce),je=Math.pow(Oe,1-De),He=yt(l.worldSize,Te.add(Me.mult(De*je)).mult(Ve));l.setLocationAtPoint(l.renderWorldCopies?He.wrap():He,ie)}},isZooming:X,elevationCenter:ae}}handleFlyTo(l,f){let v=f.zoom!==void 0,S=l.zoom,I=l.constrain(o.S.convert(f.center||f.locationAtOffset),v?+f.zoom:S),D=I.center,z=I.zoom;Ts(l,D);let V=tt(l.worldSize,f.locationAtOffset),X=tt(l.worldSize,D).sub(V),Q=X.mag(),ie=o.ah(z-S),re;if(f.minZoom!==void 0){let ae=Math.min(+f.minZoom,S,z),Ae=l.constrain(D,ae).zoom;re=o.ah(Ae-S)}return{easeFunc:(ae,Ae,Te,Me)=>{l.setZoom(ae===1?z:S+o.ak(Ae));let Ce=ae===1?D:yt(l.worldSize,V.add(X.mult(Te)).mult(Ae));l.setLocationAtPoint(l.renderWorldCopies?Ce.wrap():Ce,Me)},scaleOfZoom:ie,targetCenter:D,scaleOfMinZoom:re,pixelPathLength:Q}}}class Mn{constructor(l,f,v){this.blendFunction=l,this.blendColor=f,this.mask=v}}Mn.Replace=[1,0],Mn.disabled=new Mn(Mn.Replace,o.bf.transparent,[!1,!1,!1,!1]),Mn.unblended=new Mn(Mn.Replace,o.bf.transparent,[!0,!0,!0,!0]),Mn.alphaBlended=new Mn([1,771],o.bf.transparent,[!0,!0,!0,!0]);let qu=2305;class $i{constructor(l,f,v){this.enable=l,this.mode=f,this.frontFace=v}}$i.disabled=new $i(!1,1029,qu),$i.backCCW=new $i(!0,1029,qu),$i.frontCCW=new $i(!0,1028,qu);class zr{constructor(l,f,v){this.func=l,this.mask=f,this.range=v}}zr.ReadOnly=!1,zr.ReadWrite=!0,zr.disabled=new zr(519,zr.ReadOnly,[0,1]);let uA=7680;class ki{constructor(l,f,v,S,I,D){this.test=l,this.ref=f,this.mask=v,this.fail=S,this.depthFail=I,this.pass=D}}ki.disabled=new ki({func:519,mask:0},0,0,uA,uA,uA);let mv=new WeakMap;function nu(C){var l;if(mv.has(C))return mv.get(C);{let f=(l=C.getParameter(C.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return mv.set(C,f),f}}class wp{get awaitingQuery(){return!!this._readbackQueue}constructor(l){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=l;let f=l.context,v=f.gl;this._texFormat=v.RGBA,this._texType=v.UNSIGNED_BYTE;let S=new o.aL;S.emplaceBack(-1,-1),S.emplaceBack(2,-1),S.emplaceBack(-1,2);let I=new o.aN;I.emplaceBack(0,1,2),this._fullscreenTriangle=new bc(f.createVertexBuffer(S,ci.members),f.createIndexBuffer(I),o.aM.simpleSegment(0,0,S.length,I.length)),this._resultBuffer=new Uint8Array(4),f.activeTexture.set(v.TEXTURE1);let D=v.createTexture();v.bindTexture(v.TEXTURE_2D,D),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texImage2D(v.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=f.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(D),nu(v)&&(this._pbo=v.createBuffer(),v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.bufferData(v.PIXEL_PACK_BUFFER,4,v.STREAM_READ),v.bindBuffer(v.PIXEL_PACK_BUFFER,null))}destroy(){let l=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),l.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(l,f){let v=this._updateCount;return this._readbackQueue?v>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():v>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(l,f),this._updateCount++,this._measuredError}_bindFramebuffer(){let l=this._cachedRenderContext.context,f=l.gl;l.activeTexture.set(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,this._fbo.colorAttachment.get()),l.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(l,f){let v=this._cachedRenderContext.context,S=v.gl;if(this._bindFramebuffer(),v.viewport.set([0,0,this._texWidth,this._texHeight]),v.clear({color:o.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(v,S.TRIANGLES,zr.disabled,ki.disabled,Mn.unblended,$i.disabled,((I,D)=>({u_input:I,u_output_expected:D}))(l,f),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&nu(S)){S.bindBuffer(S.PIXEL_PACK_BUFFER,this._pbo),S.readBuffer(S.COLOR_ATTACHMENT0),S.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),S.bindBuffer(S.PIXEL_PACK_BUFFER,null);let I=S.fenceSync(S.SYNC_GPU_COMMANDS_COMPLETE,0);S.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:I}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let l=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&nu(l)){let f=l.clientWaitSync(this._readbackQueue.sync,0,0);if(f===l.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(f===l.TIMEOUT_EXPIRED)return;l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),l.bindBuffer(l.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),l.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=wp._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(l){let f=0;return f+=l[0]/256,f+=l[1]/65536,f+=l[2]/16777216,l[3]<127&&(f=-f),f/128}}let lf=o.$/128;function cm(C,l){let f=C.granularity!==void 0?Math.max(C.granularity,1):1,v=f+(C.generateBorders?2:0),S=f+(C.extendToNorthPole||C.generateBorders?1:0)+(C.extendToSouthPole||C.generateBorders?1:0),I=v+1,D=S+1,z=C.generateBorders?-1:0,V=C.generateBorders||C.extendToNorthPole?-1:0,X=f+(C.generateBorders?1:0),Q=f+(C.generateBorders||C.extendToSouthPole?1:0),ie=I*D,re=v*S*6,ae=I*D>65536;if(ae&&l==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");let Ae=ae||l==="32bit",Te=new Int16Array(2*ie),Me=0;for(let Ve=V;Ve<=Q;Ve++)for(let Oe=z;Oe<=X;Oe++){let je=Oe/f*o.$;Oe===-1&&(je=-lf),Oe===f+1&&(je=o.$+lf);let He=Ve/f*o.$;Ve===-1&&(He=C.extendToNorthPole?o.bh:-lf),Ve===f+1&&(He=C.extendToSouthPole?o.bi:o.$+lf),Te[Me++]=je,Te[Me++]=He}let Ce=Ae?new Uint32Array(re):new Uint16Array(re),De=0;for(let Ve=0;Ve<S;Ve++)for(let Oe=0;Oe<v;Oe++){let je=Oe+1+Ve*I,He=Oe+(Ve+1)*I,Be=Oe+1+(Ve+1)*I;Ce[De++]=Oe+Ve*I,Ce[De++]=He,Ce[De++]=je,Ce[De++]=je,Ce[De++]=He,Ce[De++]=Be}return{vertices:Te.buffer.slice(0),indices:Ce.buffer.slice(0),uses32bitIndices:Ae}}let um=new o.aK({fill:new o.bj(128,2),line:new o.bj(512,0),tile:new o.bj(128,32),stencil:new o.bj(128,1),circle:3});class Xt{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return iu.projectionGlobe}get vertexShaderPreludeCode(){return iu.projectionMercator.vertexSource}get subdivisionGranularity(){return um}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(l){this._errorMeasurement||(this._errorMeasurement=new wp(l));let f=o.U(this._errorQueryLatitudeDegrees),v=2*Math.atan(Math.exp(Math.PI-f*Math.PI*2))-.5*Math.PI,S=this._errorMeasurement.updateErrorLoop(f,v),I=M();S!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=S,this._errorMeasurementLastChangeTime=I);let D=Math.min(Math.max((I-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bl(D))}_getMeshKey(l){return`${l.granularity.toString(36)}_${l.generateBorders?"b":""}${l.extendToNorthPole?"n":""}${l.extendToSouthPole?"s":""}`}getMeshFromTileID(l,f,v,S,I){let D=(I==="stencil"?um.stencil:um.tile).getGranularityForZoomLevel(f.z);return this._getMesh(l,{granularity:D,generateBorders:v,extendToNorthPole:f.y===0&&S,extendToSouthPole:f.y===(1<<f.z)-1&&S})}_getMesh(l,f){let v=this._getMeshKey(f);if(v in this._tileMeshCache)return this._tileMeshCache[v];let S=(function(I,D){let z=cm(D,"16bit"),V=o.aL.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),X=o.aN.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new bc(I.createVertexBuffer(V,ci.members),I.createIndexBuffer(X),o.aM.simpleSegment(0,0,V.length,X.length))})(l,f);return this._tileMeshCache[v]=S,S}recalculate(l){}hasTransition(){let l=M(),f=!1;return f=f||(l-this._errorMeasurementLastChangeTime)/1e3<.7,f=f||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,f}setErrorQueryLatitudeDegrees(l){this._errorQueryLatitudeDegrees=l}}let ur=new o.r({type:new o.D(o.v.projection.type)});class Ir extends o.E{constructor(l){super(),this._transitionable=new o.t(ur,void 0),this.setProjection(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0)),this._mercatorProjection=new lm,this._verticalPerspectiveProjection=new Xt}get transitionState(){let l=this.properties.get("type");if(typeof l=="string"&&l==="mercator")return 0;if(typeof l=="string"&&l==="vertical-perspective")return 1;if(l instanceof o.bm){if(l.from==="vertical-perspective"&&l.to==="mercator")return 1-l.transition;if(l.from==="mercator"&&l.to==="vertical-perspective")return l.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(l){this._mercatorProjection.updateGPUdependent(l),this._verticalPerspectiveProjection.updateGPUdependent(l)}getMeshFromTileID(l,f,v,S,I){return this.currentProjection.getMeshFromTileID(l,f,v,S,I)}setProjection(l){this._transitionable.setValue("type",l?.type||"mercator")}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}setErrorQueryLatitudeDegrees(l){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(l),this._mercatorProjection.setErrorQueryLatitudeDegrees(l)}}function Di(C){let l=Wn(C.worldSize,C.center.lat);return 2*Math.PI*l}function Qi(C,l,f,v,S){let I=1/(1<<S),D=l/o.$*I+v*I,z=o.bo((C/o.$*I+f*I)*Math.PI*2+Math.PI,2*Math.PI),V=2*Math.atan(Math.exp(Math.PI-D*Math.PI*2))-.5*Math.PI,X=Math.cos(V),Q=new Float64Array(3);return Q[0]=Math.sin(z)*X,Q[1]=Math.sin(V),Q[2]=Math.cos(z)*X,Q}function Hi(C){return(function(l,f){let v=Math.cos(f),S=new Float64Array(3);return S[0]=Math.sin(l)*v,S[1]=Math.sin(f),S[2]=Math.cos(l)*v,S})(C.lng*Math.PI/180,C.lat*Math.PI/180)}function Wn(C,l){return C/(2*Math.PI)/Math.cos(l*Math.PI/180)}function ou(C){let l=Math.asin(C[1])/Math.PI*180,f=Math.sqrt(C[0]*C[0]+C[2]*C[2]);if(f>1e-6){let v=C[0]/f,S=Math.acos(C[2]/f),I=(v>0?S:-S)/Math.PI*180;return new o.S(o.aO(I,-180,180),l)}return new o.S(0,l)}function Yl(C){return Math.cos(C*Math.PI/180)}function ho(C,l){let f=Yl(C),v=Yl(l);return o.ak(v/f)}function Sp(C,l){let f=C.rotate(l.bearingInRadians),v=l.zoom+ho(l.center.lat,0),S=o.bk(1/Yl(l.center.lat),1/Yl(Math.min(Math.abs(l.center.lat),60)),o.bn(v,7,3,0,1)),I=360/Di({worldSize:l.worldSize,center:{lat:l.center.lat}});return new o.S(l.center.lng-f.x*I*S,o.ae(l.center.lat+f.y*I,-o.af,o.af))}function cf(C){let l=.5*C,f=Math.sin(l),v=Math.cos(l);return Math.log(f+v)-Math.log(v-f)}function Ro(C,l,f,v){let S=C.lat+f*v;if(Math.abs(f)>1){let I=(Math.sign(C.lat+f)!==Math.sign(C.lat)?-Math.abs(C.lat):Math.abs(C.lat))*Math.PI/180,D=Math.abs(C.lat+f)*Math.PI/180,z=cf(I+v*(D-I)),V=cf(I),X=cf(D);return new o.S(C.lng+l*((z-V)/(X-V)),S)}return new o.S(C.lng+l*v,S)}class xc{constructor(l){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=l}swapBuffers(){if(!this._hadAnyChanges)return;let l=this._cachePrevious;this._cachePrevious=this._cache,this._cache=l,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(l,f,v,S){let I=`${l.z}_${l.x}_${l.y}_${S?.terrain?"t":""}`,D=this._cache.get(I);if(D)return D;let z=this._cachePrevious.get(I);if(z)return this._cache.set(I,z),z;let V=this._boundingVolumeFactory(l,f,v,S);return this._cache.set(I,V),this._hadAnyChanges=!0,V}}class Oo{constructor(l,f,v,S){this.min=v,this.max=S,this.points=l,this.planes=f}static fromAabb(l,f){let v=[];for(let S=0;S<8;S++)v.push([1&~S?l[0]:f[0],(S>>1&1)==1?f[1]:l[1],(S>>2&1)==1?f[2]:l[2]]);return new Oo(v,[[-1,0,0,f[0]],[1,0,0,-l[0]],[0,-1,0,f[1]],[0,1,0,-l[1]],[0,0,-1,f[2]],[0,0,1,-l[2]]],l,f)}static fromCenterSizeAngles(l,f,v){let S=o.br([],v[0],v[1],v[2]),I=o.bs([],[f[0],0,0],S),D=o.bs([],[0,f[1],0],S),z=o.bs([],[0,0,f[2]],S),V=[...l],X=[...l];for(let ie=0;ie<8;ie++)for(let re=0;re<3;re++){let ae=l[re]+I[re]*(1&~ie?-1:1)+D[re]*((ie>>1&1)==1?1:-1)+z[re]*((ie>>2&1)==1?1:-1);V[re]=Math.min(V[re],ae),X[re]=Math.max(X[re],ae)}let Q=[];for(let ie=0;ie<8;ie++){let re=[...l];o.aS(re,re,o.aR([],I,1&~ie?-1:1)),o.aS(re,re,o.aR([],D,(ie>>1&1)==1?1:-1)),o.aS(re,re,o.aR([],z,(ie>>2&1)==1?1:-1)),Q.push(re)}return new Oo(Q,[[...I,-o.aX(I,Q[0])],[...D,-o.aX(D,Q[0])],[...z,-o.aX(z,Q[0])],[-I[0],-I[1],-I[2],-o.aX(I,Q[7])],[-D[0],-D[1],-D[2],-o.aX(D,Q[7])],[-z[0],-z[1],-z[2],-o.aX(z,Q[7])]],V,X)}intersectsFrustum(l){let f=!0,v=this.points.length,S=this.planes.length,I=l.planes.length,D=l.points.length;for(let z=0;z<I;z++){let V=l.planes[z],X=0;for(let Q=0;Q<v;Q++){let ie=this.points[Q];V[0]*ie[0]+V[1]*ie[1]+V[2]*ie[2]+V[3]>=0&&X++}if(X===0)return 0;X<v&&(f=!1)}if(f)return 2;for(let z=0;z<S;z++){let V=this.planes[z],X=0;for(let Q=0;Q<D;Q++){let ie=l.points[Q];V[0]*ie[0]+V[1]*ie[1]+V[2]*ie[2]+V[3]>=0&&X++}if(X===0)return 0}return 1}intersectsPlane(l){let f=this.points.length,v=0;for(let S=0;S<f;S++){let I=this.points[S];l[0]*I[0]+l[1]*I[1]+l[2]*I[2]+l[3]>=0&&v++}return v===f?2:v===0?0:1}}function Gh(C,l,f){let v=C-l;return v<0?-v:Math.max(0,v-f)}function uf(C,l,f,v,S){let I=C-f,D;return D=I<0?Math.min(-I,1+I-S):I>1?Math.min(Math.max(I-S,0),1-I):0,Math.max(D,Gh(l,v,S))}class hA{constructor(){this._boundingVolumeCache=new xc(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(l,f,v,S){let I=1<<v.z,D=1/I,z=v.x/I,V=v.y/I,X=2;return X=Math.min(X,uf(l,f,z,V,D)),X=Math.min(X,uf(l,f,z+.5,-V-D,D)),X=Math.min(X,uf(l,f,z+.5,2-V-D,D)),X}getWrap(l,f,v){let S=1<<f.z,I=1/S,D=f.x/S,z=Gh(l.x,D,I),V=Gh(l.x,D-1,I),X=Gh(l.x,D+1,I),Q=Math.min(z,V,X);return Q===X?1:Q===V?-1:0}allowVariableZoom(l,f){return jn(l,f)>4}allowWorldCopies(){return!1}getTileBoundingVolume(l,f,v,S){return this._boundingVolumeCache.getTileBoundingVolume(l,f,v,S)}_computeTileBoundingVolume(l,f,v,S){var I,D;let z=0,V=0;if(S?.terrain){let X=new o.Z(l.z,f,l.z,l.x,l.y),Q=S.terrain.getMinMaxElevation(X);z=(I=Q.minElevation)!==null&&I!==void 0?I:Math.min(0,v),V=(D=Q.maxElevation)!==null&&D!==void 0?D:Math.max(0,v)}if(z/=o.bu,V/=o.bu,z+=1,V+=1,l.z<=0)return Oo.fromAabb([-V,-V,-V],[V,V,V]);if(l.z===1)return Oo.fromAabb([l.x===0?-V:0,l.y===0?0:-V,-V],[l.x===0?0:V,l.y===0?V:0,V]);{let X=[Qi(0,0,l.x,l.y,l.z),Qi(o.$,0,l.x,l.y,l.z),Qi(o.$,o.$,l.x,l.y,l.z),Qi(0,o.$,l.x,l.y,l.z)],Q=[];for(let Ye of X)Q.push(o.aR([],Ye,V));if(V!==z)for(let Ye of X)Q.push(o.aR([],Ye,z));l.y===0&&Q.push([0,1,0]),l.y===(1<<l.z)-1&&Q.push([0,-1,0]);let ie=[1,1,1],re=[-1,-1,-1];for(let Ye of Q)for(let gt=0;gt<3;gt++)ie[gt]=Math.min(ie[gt],Ye[gt]),re[gt]=Math.max(re[gt],Ye[gt]);let ae=Qi(o.$/2,o.$/2,l.x,l.y,l.z),Ae=o.aW([],[0,1,0],ae);o.aV(Ae,Ae);let Te=o.aW([],ae,Ae);o.aV(Te,Te);let Me=o.aW([],X[2],X[1]);o.aV(Me,Me);let Ce=o.aW([],X[0],X[3]);o.aV(Ce,Ce),Q.push(o.aR([],ae,V)),l.y>=(1<<l.z)/2&&Q.push(o.aR([],Qi(o.$/2,0,l.x,l.y,l.z),V)),l.y<(1<<l.z)/2&&Q.push(o.aR([],Qi(o.$/2,o.$,l.x,l.y,l.z),V));let De=Yu(ae,Q),Ve=Yu(Te,Q),Oe=[-ae[0],-ae[1],-ae[2],De.max],je=[ae[0],ae[1],ae[2],-De.min],He=[-Te[0],-Te[1],-Te[2],Ve.max],Be=[Te[0],Te[1],Te[2],-Ve.min],et=[...Me,0],Ke=[...Ce,0],ct=[];return l.y===0?ct.push(o.bt(Ke,et,Oe),o.bt(Ke,et,je)):ct.push(o.bt(He,et,Oe),o.bt(He,et,je),o.bt(He,Ke,Oe),o.bt(He,Ke,je)),l.y===(1<<l.z)-1?ct.push(o.bt(Ke,et,Oe),o.bt(Ke,et,je)):ct.push(o.bt(Be,et,Oe),o.bt(Be,et,je),o.bt(Be,Ke,Oe),o.bt(Be,Ke,je)),new Oo(ct,[Oe,je,He,Be,et,Ke],ie,re)}}}function Yu(C,l){let f=1/0,v=-1/0;for(let S of l){let I=o.aX(C,S);f=Math.min(f,I),v=Math.max(v,I)}return{min:f,max:v}}class Tp{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,f,v){return this._helper.interpolatePadding(l,f,v)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,f){this._helper.resize(l,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrain(l){this._helper.setConstrain(l)}overrideNearFarZ(l,f){this._helper.overrideNearFarZ(l,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(l){}constructor(l){this._cachedClippingPlane=o.bv(),this._projectionMatrix=o.b9(),this._globeViewProjMatrix32f=o.b8(),this._globeViewProjMatrixNoCorrection=o.b9(),this._globeViewProjMatrixNoCorrectionInverted=o.b9(),this._globeProjMatrixInverted=o.b9(),this._cameraPosition=o.bp(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(f,v)=>{let S=o.ae(f.lat,-o.af,o.af),I=o.ae(+v,this.minZoom+ho(0,S),this.maxZoom);return{center:new o.S(f.lng,S),zoom:I}},this._helper=new hs({calcMatrices:()=>{this._calcMatrices()},constrain:(f,v)=>this.defaultConstrain(f,v)},l),this._coveringTilesDetailsProvider=new hA}clone(){let l=new Tp;return l.apply(this),l}apply(l,f){this._globeLatitudeErrorCorrectionRadians=f||0,this._helper.apply(l)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let l=o.bp();return l[0]=this._cameraPosition[0],l[1]=this._cameraPosition[1],l[2]=this._cameraPosition[2],l}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(l){let{overscaledTileID:f,applyGlobeMatrix:v}=l,S=this._helper.getMercatorTileCoordinates(f);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:S,clippingPlane:this._cachedClippingPlane,projectionTransition:v?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(l){let f=this.pitchInRadians,v=this.cameraToCenterDistance/l,S=Math.sin(f)*v,I=Math.cos(f)*v+1,D=1/Math.sqrt(S*S+I*I)*1,z=-S,V=I,X=Math.sqrt(z*z+V*V);z/=X,V/=X;let Q=[0,z,V];o.bw(Q,Q,[0,0,0],-this.bearingInRadians),o.bx(Q,Q,[0,0,0],-1*this.center.lat*Math.PI/180),o.by(Q,Q,[0,0,0],this.center.lng*Math.PI/180);let ie=1/o.aZ(Q);return o.aR(Q,Q,ie),[...Q,-D*ie]}isLocationOccluded(l){return!this.isSurfacePointVisible(Hi(l))}transformLightDirection(l){let f=this._helper._center.lng*Math.PI/180,v=this._helper._center.lat*Math.PI/180,S=Math.cos(v),I=[Math.sin(f)*S,Math.sin(v),Math.cos(f)*S],D=[I[2],0,-I[0]],z=[0,0,0];o.aW(z,D,I),o.aV(D,D),o.aV(z,z);let V=[0,0,0];return o.aV(V,[D[0]*l[0]+z[0]*l[1]+I[0]*l[2],D[1]*l[0]+z[1]*l[1]+I[1]*l[2],D[2]*l[0]+z[2]*l[1]+I[2]*l[2]]),V}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(l,f,v){let S=(function(z,V,X){let Q=1/(1<<X.z);return new o.a1(z/o.$*Q+X.x*Q,V/o.$*Q+X.y*Q)})(l,f,v.canonical),I=(D=S.y,[o.bo(S.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-D*Math.PI*2))-.5*Math.PI]);var D;return this.getCircleRadiusCorrection()/Math.cos(I[1])}projectTileCoordinates(l,f,v,S){let I=v.canonical,D=Qi(l,f,I.x,I.y,I.z),z=1+(S?S(l,f):0)/o.bu,V=[D[0]*z,D[1]*z,D[2]*z,1];o.aw(V,V,this._globeViewProjMatrixNoCorrection);let X=this._cachedClippingPlane,Q=X[0]*D[0]+X[1]*D[1]+X[2]*D[2]+X[3]<0;return{point:new o.P(V[0]/V[3],V[1]/V[3]),signedDistanceFromCamera:V[3],isOccluded:Q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let l=Wn(this.worldSize,this.center.lat),f=o.ba(),v=o.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*l),o.b4(f,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let S=this.centerOffset;f[8]=2*-S.x/this._helper._width,f[9]=2*S.y/this._helper._height,this._projectionMatrix=o.b5(f),this._globeProjMatrixInverted=o.ba(),o.aq(this._globeProjMatrixInverted,f),o.M(f,f,[0,0,-this.cameraToCenterDistance]),o.b6(f,f,this.rollInRadians),o.b7(f,f,-this.pitchInRadians),o.b6(f,f,this.bearingInRadians),o.M(f,f,[0,0,-l]);let I=o.bp();I[0]=l,I[1]=l,I[2]=l,o.b7(v,f,this.center.lat*Math.PI/180),o.bz(v,v,-this.center.lng*Math.PI/180),o.N(v,v,I),this._globeViewProjMatrixNoCorrection=v,o.b7(f,f,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bz(f,f,-this.center.lng*Math.PI/180),o.N(f,f,I),this._globeViewProjMatrix32f=new Float32Array(f),this._globeViewProjMatrixNoCorrectionInverted=o.ba(),o.aq(this._globeViewProjMatrixNoCorrectionInverted,v);let D=o.bp();this._cameraPosition=o.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/l,o.bw(this._cameraPosition,this._cameraPosition,D,-this.rollInRadians),o.bx(this._cameraPosition,this._cameraPosition,D,this.pitchInRadians),o.bw(this._cameraPosition,this._cameraPosition,D,-this.bearingInRadians),o.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bx(this._cameraPosition,this._cameraPosition,D,-this.center.lat*Math.PI/180),o.by(this._cameraPosition,this._cameraPosition,D,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(l);let z=o.b5(this._globeViewProjMatrixNoCorrectionInverted);o.N(z,z,[1,1,-1]),this._cachedFrustum=Hs.fromInvProjectionMatrix(z,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(l){o.w("calculateFogMatrix is not supported on globe projection.");let f=o.ba();return o.ai(f),f}getVisibleUnwrappedCoordinates(l){return[new o.b2(0,l)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(l){l&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,f){if(!this._globeViewProjMatrixNoCorrection)return 1;let v=Hi(l);o.aR(v,v,1+f/o.bu);let S=o.bv();return o.aw(S,[v[0],v[1],v[2],1],this._globeViewProjMatrixNoCorrection),S[2]/S[3]}populateCache(l){}getBounds(){let l=.5*this.width,f=.5*this.height,v=[new o.P(0,0),new o.P(l,0),new o.P(this.width,0),new o.P(this.width,f),new o.P(this.width,this.height),new o.P(l,this.height),new o.P(0,this.height),new o.P(0,f)],S=[];for(let ie of v)S.push(this.unprojectScreenPoint(ie));let I=0,D=0,z=0,V=0,X=this.center;for(let ie of S){let re=o.bA(X.lng,ie.lng),ae=o.bA(X.lat,ie.lat);re<D&&(D=re),re>I&&(I=re),ae<V&&(V=ae),ae>z&&(z=ae)}let Q=[X.lng+D,X.lat+V,X.lng+I,X.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(Q[3]=90,Q[0]=-180,Q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Q[1]=-90,Q[0]=-180,Q[2]=180),new dn(Q)}calculateCenterFromCameraLngLatAlt(l,f,v,S){return this._helper.calculateCenterFromCameraLngLatAlt(l,f,v,S)}setLocationAtPoint(l,f){let v=Hi(this.unprojectScreenPoint(f)),S=Hi(l),I=o.bp();o.bB(I);let D=o.bp();o.by(D,v,I,-this.center.lng*Math.PI/180),o.bx(D,D,I,this.center.lat*Math.PI/180);let z=S[0]*S[0]+S[2]*S[2],V=D[0]*D[0];if(z<V)return;let X=Math.sqrt(z-V),Q=-X,ie=o.bC(S[0],S[2],D[0],X),re=o.bC(S[0],S[2],D[0],Q),ae=o.bp();o.by(ae,S,I,-ie);let Ae=o.bC(ae[1],ae[2],D[1],D[2]),Te=o.bp();o.by(Te,S,I,-re);let Me=o.bC(Te[1],Te[2],D[1],D[2]),Ce=.5*Math.PI,De=Ae>=-Ce&&Ae<=Ce,Ve=Me>=-Ce&&Me<=Ce,Oe,je;if(De&&Ve){let Ke=this.center.lng*Math.PI/180,ct=this.center.lat*Math.PI/180;o.bD(ie,Ke)+o.bD(Ae,ct)<o.bD(re,Ke)+o.bD(Me,ct)?(Oe=ie,je=Ae):(Oe=re,je=Me)}else if(De)Oe=ie,je=Ae;else{if(!Ve)return;Oe=re,je=Me}let He=Oe/Math.PI*180,Be=je/Math.PI*180,et=this.center.lat;this.setCenter(new o.S(He,o.ae(Be,-90,90))),this.setZoom(this.zoom+ho(et,this.center.lat))}locationToScreenPoint(l,f){let v=Hi(l);if(f){let S=f.getElevationForLngLatZoom(l,this._helper._tileZoom);o.aR(v,v,1+S/o.bu)}return this._projectSurfacePointToScreen(v)}_projectSurfacePointToScreen(l){let f=o.bv();return o.aw(f,[...l,1],this._globeViewProjMatrixNoCorrection),f[0]/=f[3],f[1]/=f[3],new o.P((.5*f[0]+.5)*this.width,(.5*-f[1]+.5)*this.height)}screenPointToMercatorCoordinate(l,f){if(f){let v=f.pointCoordinate(l);if(v)return v}return o.a1.fromLngLat(this.unprojectScreenPoint(l))}screenPointToLocation(l,f){var v;return(v=this.screenPointToMercatorCoordinate(l,f))===null||v===void 0?void 0:v.toLngLat()}isPointOnMapSurface(l,f){let v=this._cameraPosition,S=this.getRayDirectionFromPixel(l);return!!this.rayPlanetIntersection(v,S)}getRayDirectionFromPixel(l){let f=o.bv();f[0]=l.x/this.width*2-1,f[1]=-1*(l.y/this.height*2-1),f[2]=1,f[3]=1,o.aw(f,f,this._globeViewProjMatrixNoCorrectionInverted),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3];let v=o.bp();v[0]=f[0]-this._cameraPosition[0],v[1]=f[1]-this._cameraPosition[1],v[2]=f[2]-this._cameraPosition[2];let S=o.bp();return o.aV(S,v),S}isSurfacePointVisible(l){let f=this._cachedClippingPlane;return f[0]*l[0]+f[1]*l[1]+f[2]*l[2]+f[3]>=0}isSurfacePointOnScreen(l){if(!this.isSurfacePointVisible(l))return!1;let f=o.bv();return o.aw(f,[...l,1],this._globeViewProjMatrixNoCorrection),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[0]>-1&&f[0]<1&&f[1]>-1&&f[1]<1&&f[2]>-1&&f[2]<1}rayPlanetIntersection(l,f){let v=o.aX(l,f),S=o.bp(),I=o.bp();o.aR(I,f,v),o.aU(S,l,I);let D=1-o.aX(S,S);if(D<0)return null;let z=o.aX(l,l)-1,V=-v+(v<0?1:-1)*Math.sqrt(D),X=z/V,Q=V;return{tMin:Math.min(X,Q),tMax:Math.max(X,Q)}}unprojectScreenPoint(l){let f=this._cameraPosition,v=this.getRayDirectionFromPixel(l),S=this.rayPlanetIntersection(f,v);if(S){let Q=o.bp();o.aS(Q,f,[v[0]*S.tMin,v[1]*S.tMin,v[2]*S.tMin]);let ie=o.bp();return o.aV(ie,Q),ou(ie)}let I=this._cachedClippingPlane,D=I[0]*v[0]+I[1]*v[1]+I[2]*v[2],z=-o.b1(I,f)/D,V=o.bp();if(z>0)o.aS(V,f,[v[0]*z,v[1]*z,v[2]*z]);else{let Q=o.bp();o.aS(Q,f,[2*v[0],2*v[1],2*v[2]]);let ie=o.b1(this._cachedClippingPlane,Q);o.aU(V,Q,[this._cachedClippingPlane[0]*ie,this._cachedClippingPlane[1]*ie,this._cachedClippingPlane[2]*ie])}let X=(function(Q){let ie=o.bp();return ie[0]=Q[0]*-Q[3],ie[1]=Q[1]*-Q[3],ie[2]=Q[2]*-Q[3],{center:ie,radius:Math.sqrt(1-Q[3]*Q[3])}})(I);return ou((function(Q,ie,re){let ae=o.bp();o.aU(ae,re,Q);let Ae=o.bp();return o.bq(Ae,Q,ae,ie/o.a$(ae)),Ae})(X.center,X.radius,V))}getMatrixForModel(l,f){let v=o.S.convert(l),S=1/o.bu,I=o.b9();return o.bz(I,I,v.lng/180*Math.PI),o.b7(I,I,-v.lat/180*Math.PI),o.M(I,I,[0,0,1+f/o.bu]),o.b7(I,I,.5*Math.PI),o.N(I,I,[S,S,S]),I}getProjectionDataForCustomLayer(l=!0){let f=this.getProjectionData({overscaledTileID:new o.Z(0,0,0,0,0),applyGlobeMatrix:l});return f.tileMercatorCoords=[0,0,1,1],f}getFastPathSimpleProjectionMatrix(l){}}class Hh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(l){this._helper.setMinZoom(l)}setMaxZoom(l){this._helper.setMaxZoom(l)}setMinPitch(l){this._helper.setMinPitch(l)}setMaxPitch(l){this._helper.setMaxPitch(l)}setRenderWorldCopies(l){this._helper.setRenderWorldCopies(l)}setBearing(l){this._helper.setBearing(l)}setPitch(l){this._helper.setPitch(l)}setRoll(l){this._helper.setRoll(l)}setFov(l){this._helper.setFov(l)}setZoom(l){this._helper.setZoom(l)}setCenter(l){this._helper.setCenter(l)}setElevation(l){this._helper.setElevation(l)}setMinElevationForCurrentTile(l){this._helper.setMinElevationForCurrentTile(l)}setPadding(l){this._helper.setPadding(l)}interpolatePadding(l,f,v){return this._helper.interpolatePadding(l,f,v)}isPaddingEqual(l){return this._helper.isPaddingEqual(l)}resize(l,f,v=!0){this._helper.resize(l,f,v)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(l){this._helper.setMaxBounds(l)}setConstrain(l){this._helper.setConstrain(l)}overrideNearFarZ(l,f){this._helper.overrideNearFarZ(l,f)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(l){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),l)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(l,f){this._globeness=l,this._globeLatitudeErrorCorrectionRadians=f,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(l){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(f,v)=>this.currentTransform.defaultConstrain(f,v),this._helper=new hs({calcMatrices:()=>{this._calcMatrices()},constrain:(f,v)=>this.defaultConstrain(f,v)},l),this._globeness=1,this._mercatorTransform=new qs,this._verticalPerspectiveTransform=new Tp}clone(){let l=new Hh;return l._globeness=this._globeness,l._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,l.apply(this),l}apply(l){this._helper.apply(l),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(l){let f=this._mercatorTransform.getProjectionData(l),v=this._verticalPerspectiveTransform.getProjectionData(l);return{mainMatrix:this.isGlobeRendering?v.mainMatrix:f.mainMatrix,clippingPlane:v.clippingPlane,tileMercatorCoords:v.tileMercatorCoords,projectionTransition:l.applyGlobeMatrix?this._globeness:0,fallbackMatrix:f.fallbackMatrix}}isLocationOccluded(l){return this.currentTransform.isLocationOccluded(l)}transformLightDirection(l){return this.currentTransform.transformLightDirection(l)}getPixelScale(){return o.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(l,f,v){let S=this._mercatorTransform.getPitchedTextCorrection(l,f,v),I=this._verticalPerspectiveTransform.getPitchedTextCorrection(l,f,v);return o.bk(S,I,this._globeness)}projectTileCoordinates(l,f,v,S){return this.currentTransform.projectTileCoordinates(l,f,v,S)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(l){return this.currentTransform.calculateFogMatrix(l)}getVisibleUnwrappedCoordinates(l){return this.currentTransform.getVisibleUnwrappedCoordinates(l)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(l){this._mercatorTransform.recalculateZoomAndCenter(l),this._verticalPerspectiveTransform.recalculateZoomAndCenter(l)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(l,f){return this.currentTransform.lngLatToCameraDepth(l,f)}populateCache(l){this._mercatorTransform.populateCache(l),this._verticalPerspectiveTransform.populateCache(l)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(l,f,v,S){return this._helper.calculateCenterFromCameraLngLatAlt(l,f,v,S)}setLocationAtPoint(l,f){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(l,f),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(l,f),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(l,f){return this.currentTransform.locationToScreenPoint(l,f)}screenPointToMercatorCoordinate(l,f){return this.currentTransform.screenPointToMercatorCoordinate(l,f)}screenPointToLocation(l,f){return this.currentTransform.screenPointToLocation(l,f)}isPointOnMapSurface(l,f){return this.currentTransform.isPointOnMapSurface(l,f)}getRayDirectionFromPixel(l){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(l)}getMatrixForModel(l,f){return this.currentTransform.getMatrixForModel(l,f)}getProjectionDataForCustomLayer(l=!0){let f=this._mercatorTransform.getProjectionDataForCustomLayer(l);if(!this.isGlobeRendering)return f;let v=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(l);return v.fallbackMatrix=f.mainMatrix,v}getFastPathSimpleProjectionMatrix(l){return this.currentTransform.getFastPathSimpleProjectionMatrix(l)}}class el{get useGlobeControls(){return!0}handlePanInertia(l,f){let v=Sp(l,f);return Math.abs(v.lng-f.center.lng)>180&&(v.lng=f.center.lng+179.5*Math.sign(v.lng-f.center.lng)),{easingCenter:v,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(l,f){let v=l.around,S=f.screenPointToLocation(v);l.bearingDelta&&f.setBearing(f.bearing+l.bearingDelta),l.pitchDelta&&f.setPitch(f.pitch+l.pitchDelta),l.rollDelta&&f.setRoll(f.roll+l.rollDelta);let I=f.zoom;l.zoomDelta&&f.setZoom(f.zoom+l.zoomDelta);let D=f.zoom-I;if(D===0)return;let z=o.bA(f.center.lng,S.lng),V=z/(Math.abs(z/180)+1),X=o.bA(f.center.lat,S.lat),Q=f.getRayDirectionFromPixel(v),ie=f.cameraPosition,re=-1*o.aX(ie,Q),ae=o.bp();o.aS(ae,ie,[Q[0]*re,Q[1]*re,Q[2]*re]);let Ae=o.aZ(ae)-1,Te=Math.exp(.5*-Math.max(Ae-.3,0)),Me=Wn(f.worldSize,f.center.lat)/Math.min(f.width,f.height),Ce=o.bn(Me,.9,.5,1,.25),De=(1-o.ah(-D))*Math.min(Te,Ce),Ve=f.center.lat,Oe=f.zoom,je=new o.S(f.center.lng+V*De,o.ae(f.center.lat+X*De,-o.af,o.af));f.setLocationAtPoint(S,v);let He=f.center,Be=o.bn(Math.abs(z),45,85,0,1),et=o.bn(Me,.75,.35,0,1),Ke=Math.pow(Math.max(Be,et),.25),ct=o.bA(He.lng,je.lng),Ye=o.bA(He.lat,je.lat);f.setCenter(new o.S(He.lng+ct*Ke,He.lat+Ye*Ke).wrap()),f.setZoom(Oe+ho(Ve,f.center.lat))}handleMapControlsPan(l,f,v){if(!l.panDelta)return;let S=f.center.lat,I=f.zoom;f.setCenter(Sp(l.panDelta,f).wrap()),f.setZoom(I+ho(S,f.center.lat))}cameraForBoxAndBearing(l,f,v,S,I){let D=xp(l,f,v,S,I),z=f.left/I.width*2-1,V=(I.width-f.right)/I.width*2-1,X=f.top/I.height*-2+1,Q=(I.height-f.bottom)/I.height*-2+1,ie=o.bA(v.getWest(),v.getEast())<0,re=ie?v.getEast():v.getWest(),ae=ie?v.getWest():v.getEast(),Ae=Math.max(v.getNorth(),v.getSouth()),Te=Math.min(v.getNorth(),v.getSouth()),Me=re+.5*o.bA(re,ae),Ce=Ae+.5*o.bA(Ae,Te),De=I.clone();De.setCenter(D.center),De.setBearing(D.bearing),De.setPitch(0),De.setRoll(0),De.setZoom(D.zoom);let Ve=De.modelViewProjectionMatrix,Oe=[Hi(v.getNorthWest()),Hi(v.getNorthEast()),Hi(v.getSouthWest()),Hi(v.getSouthEast()),Hi(new o.S(ae,Ce)),Hi(new o.S(re,Ce)),Hi(new o.S(Me,Ae)),Hi(new o.S(Me,Te))],je=Hi(D.center),He=Number.POSITIVE_INFINITY;for(let Be of Oe)z<0&&(He=el.getLesserNonNegativeNonNull(He,el.solveVectorScale(Be,je,Ve,"x",z))),V>0&&(He=el.getLesserNonNegativeNonNull(He,el.solveVectorScale(Be,je,Ve,"x",V))),X>0&&(He=el.getLesserNonNegativeNonNull(He,el.solveVectorScale(Be,je,Ve,"y",X))),Q<0&&(He=el.getLesserNonNegativeNonNull(He,el.solveVectorScale(Be,je,Ve,"y",Q)));if(Number.isFinite(He)&&He!==0)return D.zoom=De.zoom+o.ak(He),D;Ja()}handleJumpToCenterZoom(l,f){let v=l.center.lat,S=l.constrain(f.center?o.S.convert(f.center):l.center,l.zoom).center;l.setCenter(S.wrap());let I=f.zoom!==void 0?+f.zoom:l.zoom+ho(v,S.lat);l.zoom!==I&&l.setZoom(I)}handleEaseTo(l,f){let v=l.zoom,S=l.center,I=l.padding,D={roll:l.roll,pitch:l.pitch,bearing:l.bearing},z={roll:f.roll===void 0?l.roll:f.roll,pitch:f.pitch===void 0?l.pitch:f.pitch,bearing:f.bearing===void 0?l.bearing:f.bearing},V=f.zoom!==void 0,X=!l.isPaddingEqual(f.padding),Q=!1,ie=f.center?o.S.convert(f.center):S,re=l.constrain(ie,v).center;Ts(l,re);let ae=l.clone();ae.setCenter(re),ae.setZoom(V?+f.zoom:v+ho(S.lat,ie.lat)),ae.setBearing(f.bearing);let Ae=new o.P(o.ae(l.centerPoint.x+f.offsetAsPoint.x,0,l.width),o.ae(l.centerPoint.y+f.offsetAsPoint.y,0,l.height));ae.setLocationAtPoint(re,Ae);let Te=(f.offset&&f.offsetAsPoint.mag())>0?ae.center:re,Me=V?+f.zoom:v+ho(S.lat,Te.lat),Ce=v+ho(S.lat,0),De=Me+ho(Te.lat,0),Ve=o.bA(S.lng,Te.lng),Oe=o.bA(S.lat,Te.lat),je=o.ah(De-Ce);return Q=Me!==v,{easeFunc:He=>{if(o.be(D,z)||pv({startEulerAngles:D,endEulerAngles:z,tr:l,k:He,useSlerp:D.roll!=z.roll}),X&&l.interpolatePadding(I,f.padding,He),f.around)o.w("Easing around a point is not supported under globe projection."),l.setLocationAtPoint(f.around,f.aroundPoint);else{let Be=De>Ce?Math.min(2,je):Math.max(.5,je),et=Math.pow(Be,1-He),Ke=Ro(S,Ve,Oe,He*et);l.setCenter(Ke.wrap())}if(Q){let Be=o.C.number(Ce,De,He)+ho(0,l.center.lat);l.setZoom(Be)}},isZooming:Q,elevationCenter:Te}}handleFlyTo(l,f){let v=f.zoom!==void 0,S=l.center,I=l.zoom,D=l.padding,z=!l.isPaddingEqual(f.padding),V=l.constrain(o.S.convert(f.center||f.locationAtOffset),I).center,X=v?+f.zoom:l.zoom+ho(l.center.lat,V.lat),Q=l.clone();Q.setCenter(V),Q.setZoom(X),Q.setBearing(f.bearing);let ie=new o.P(o.ae(l.centerPoint.x+f.offsetAsPoint.x,0,l.width),o.ae(l.centerPoint.y+f.offsetAsPoint.y,0,l.height));Q.setLocationAtPoint(V,ie);let re=Q.center;Ts(l,re);let ae=(function(Oe,je,He){let Be=Hi(je),et=Hi(He),Ke=o.aX(Be,et),ct=Math.acos(Ke),Ye=Di(Oe);return ct/(2*Math.PI)*Ye})(l,S,re),Ae=I+ho(S.lat,0),Te=X+ho(re.lat,0),Me=o.ah(Te-Ae),Ce;if(typeof f.minZoom=="number"){let Oe=+f.minZoom+ho(re.lat,0),je=Math.min(Oe,Ae,Te)+ho(0,re.lat),He=l.constrain(re,je).zoom+ho(re.lat,0);Ce=o.ah(He-Ae)}let De=o.bA(S.lng,re.lng),Ve=o.bA(S.lat,re.lat);return{easeFunc:(Oe,je,He,Be)=>{let et=Ro(S,De,Ve,He);z&&l.interpolatePadding(D,f.padding,Oe);let Ke=Oe===1?re:et;l.setCenter(Ke.wrap());let ct=Ae+o.ak(je);l.setZoom(Oe===1?X:ct+ho(0,Ke.lat))},scaleOfZoom:Me,targetCenter:re,scaleOfMinZoom:Ce,pixelPathLength:ae}}static solveVectorScale(l,f,v,S,I){let D=S==="x"?[v[0],v[4],v[8],v[12]]:[v[1],v[5],v[9],v[13]],z=[v[3],v[7],v[11],v[15]],V=l[0]*D[0]+l[1]*D[1]+l[2]*D[2],X=l[0]*z[0]+l[1]*z[1]+l[2]*z[2],Q=f[0]*D[0]+f[1]*D[1]+f[2]*D[2],ie=f[0]*z[0]+f[1]*z[1]+f[2]*z[2];return Q+I*X===V+I*ie||z[3]*(V-Q)+D[3]*(ie-X)+V*ie==Q*X?null:(Q+D[3]-I*ie-I*z[3])/(Q-V-I*ie+I*X)}static getLesserNonNegativeNonNull(l,f){return f!==null&&f>=0&&f<l?f:l}}class Xu{constructor(l){this._globe=l,this._mercatorCameraHelper=new uo,this._verticalPerspectiveCameraHelper=new el}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(l,f){return this.currentHelper.handlePanInertia(l,f)}handleMapControlsRollPitchBearingZoom(l,f){return this.currentHelper.handleMapControlsRollPitchBearingZoom(l,f)}handleMapControlsPan(l,f,v){this.currentHelper.handleMapControlsPan(l,f,v)}cameraForBoxAndBearing(l,f,v,S,I){return this.currentHelper.cameraForBoxAndBearing(l,f,v,S,I)}handleJumpToCenterZoom(l,f){this.currentHelper.handleJumpToCenterZoom(l,f)}handleEaseTo(l,f){return this.currentHelper.handleEaseTo(l,f)}handleFlyTo(l,f){return this.currentHelper.handleFlyTo(l,f)}}let vt=(C,l)=>o.y(C,l&&l.filter((f=>f.identifier!=="source.canvas"))),Nt=o.bE();class sr extends o.E{constructor(l,f={}){var v,S;super(),this._rtlPluginLoaded=()=>{for(let D in this.sourceCaches){let z=this.sourceCaches[D].getSource().type;z!=="vector"&&z!=="geojson"||this.sourceCaches[D].reload()}},this.map=l,this.dispatcher=new jr(oi(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",((D,z)=>this.getGlyphs(D,z))),this.dispatcher.registerMessageHandler("GI",((D,z)=>this.getImages(D,z))),this.dispatcher.registerMessageHandler("GDA",((D,z)=>this.getDashes(D,z))),this.imageManager=new pe,this.imageManager.setEventedParent(this);let I=((v=l._container)===null||v===void 0?void 0:v.lang)||typeof document<"u"&&((S=document.documentElement)===null||S===void 0?void 0:S.lang)||void 0;this.glyphManager=new ze(l._requestManager,f.localIdeographFontFamily,I),this.lineAtlas=new Qt(256,512),this.crossTileSymbolIndex=new af,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",o.bG()),Hl().on(bl,this._rtlPluginLoaded),this.on("data",(D=>{if(D.dataType!=="source"||D.sourceDataType!=="metadata")return;let z=this.sourceCaches[D.sourceId];if(!z)return;let V=z.getSource();if(V&&V.vectorLayerIds)for(let X in this._layers){let Q=this._layers[X];Q.source===V.id&&this._validateLayer(Q)}}))}setGlobalStateProperty(l,f){var v,S,I;this._checkLoaded();let D=f===null?(I=(S=(v=this.stylesheet.state)===null||v===void 0?void 0:v[l])===null||S===void 0?void 0:S.default)!==null&&I!==void 0?I:null:f;if(o.bH(D,this._globalState[l]))return this;this._globalState[l]=D,this._applyGlobalStateChanges([l])}getGlobalState(){return this._globalState}setGlobalState(l){this._checkLoaded();let f=[];for(let v in l)!o.bH(this._globalState[v],l[v].default)&&(f.push(v),this._globalState[v]=l[v].default);this._applyGlobalStateChanges(f)}_applyGlobalStateChanges(l){if(l.length===0)return;let f=new Set,v={};for(let S of l){v[S]=this._globalState[S];for(let I in this._layers){let D=this._layers[I],z=D.getLayoutAffectingGlobalStateRefs(),V=D.getPaintAffectingGlobalStateRefs();if(z.has(S)&&f.add(D.source),V.has(S))for(let{name:X,value:Q}of V.get(S))this._updatePaintProperty(D,X,Q)}}this.dispatcher.broadcast("UGS",v);for(let S in this.sourceCaches)f.has(S)&&(this._reloadSource(S),this._changed=!0)}loadURL(l,f={},v){this.fire(new o.l("dataloading",{dataType:"style"})),f.validate=typeof f.validate!="boolean"||f.validate;let S=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;let I=this._loadStyleRequest;o.j(S,this._loadStyleRequest).then((D=>{this._loadStyleRequest=null,this._load(D.data,f,v)})).catch((D=>{this._loadStyleRequest=null,D&&!I.signal.aborted&&this.fire(new o.k(D))}))}loadJSON(l,f={},v){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,m.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,f.validate=f.validate!==!1,this._load(l,f,v)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Nt,{validate:!1})}_load(l,f,v){var S,I;let D=f.transformStyle?f.transformStyle(v,l):l;if(!f.validate||!vt(this,o.z(D))){D=Object.assign({},D),this._loaded=!0,this.stylesheet=D;for(let z in D.sources)this.addSource(z,D.sources[z],{validate:!1});D.sprite?this._loadSprite(D.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(D.glyphs),this._createLayers(),this.light=new Wt(this.stylesheet.light),this._setProjectionInternal(((S=this.stylesheet.projection)===null||S===void 0?void 0:S.type)||"mercator"),this.sky=new Bt(this.stylesheet.sky),this.map.setTerrain((I=this.stylesheet.terrain)!==null&&I!==void 0?I:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var l,f,v;let S=o.bI(this.stylesheet.layers);this.setGlobalState((l=this.stylesheet.state)!==null&&l!==void 0?l:null),this.dispatcher.broadcast("SL",S),this._order=S.map((I=>I.id)),this._layers={},this._serializedLayers=null;for(let I of S){let D=o.bJ(I,this._globalState);if(D.setEventedParent(this,{layer:{id:I.id}}),this._layers[I.id]=D,o.bK(D)&&this.sourceCaches[D.source]){let z=(v=(f=I.paint)===null||f===void 0?void 0:f["raster-fade-duration"])!==null&&v!==void 0?v:D.paint.get("raster-fade-duration");this.sourceCaches[D.source].setRasterFadeDuration(z)}}}_loadSprite(l,f=!1,v=void 0){let S;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(I,D,z,V){return o._(this,void 0,void 0,(function*(){let X=ge(I),Q=z>1?"@2x":"",ie={},re={};for(let{id:ae,url:Ae}of X){let Te=D.transformRequest(Se(Ae,Q,".json"),"SpriteJSON");ie[ae]=o.j(Te,V);let Me=D.transformRequest(Se(Ae,Q,".png"),"SpriteImage");re[ae]=ee.getImage(Me,V)}return yield Promise.all([...Object.values(ie),...Object.values(re)]),(function(ae,Ae){return o._(this,void 0,void 0,(function*(){let Te={};for(let Me in ae){Te[Me]={};let Ce=m.getImageCanvasContext((yield Ae[Me]).data),De=(yield ae[Me]).data;for(let Ve in De){let{width:Oe,height:je,x:He,y:Be,sdf:et,pixelRatio:Ke,stretchX:ct,stretchY:Ye,content:gt,textFitWidth:Gt,textFitHeight:Ht}=De[Ve];Te[Me][Ve]={data:null,pixelRatio:Ke,sdf:et,stretchX:ct,stretchY:Ye,content:gt,textFitWidth:Gt,textFitHeight:Ht,spriteData:{width:Oe,height:je,x:He,y:Be,context:Ce}}}}return Te}))})(ie,re)}))})(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((I=>{if(this._spriteRequest=null,I)for(let D in I){this._spritesImagesIds[D]=[];let z=this._spritesImagesIds[D]?this._spritesImagesIds[D].filter((V=>!(V in I))):[];for(let V of z)this.imageManager.removeImage(V),this._changedImages[V]=!0;for(let V in I[D]){let X=D==="default"?V:`${D}:${V}`;this._spritesImagesIds[D].push(X),X in this.imageManager.images?this.imageManager.updateImage(X,I[D][V],!1):this.imageManager.addImage(X,I[D][V]),f&&(this._changedImages[X]=!0)}}})).catch((I=>{this._spriteRequest=null,S=I,this.fire(new o.k(S))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),f&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),v&&v(S)}))}_unloadSprite(){for(let l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(l){let f=this.sourceCaches[l.source];if(!f)return;let v=l.sourceLayer;if(!v)return;let S=f.getSource();(S.type==="geojson"||S.vectorLayerIds&&S.vectorLayerIds.indexOf(v)===-1)&&this.fire(new o.k(new Error(`Source layer "${v}" does not exist on source "${S.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,f=!1){let v=this._serializedAllLayers();if(!l||l.length===0)return Object.values(f?o.bL(v):v);let S=[];for(let I of l)if(v[I]){let D=f?o.bL(v[I]):v[I];S.push(D)}return S}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};let f=Object.keys(this._layers);for(let v of f){let S=this._layers[v];S.type!=="custom"&&(l[v]=S.serialize())}return l}hasTransitions(){var l,f,v;if(!((l=this.light)===null||l===void 0)&&l.hasTransition()||!((f=this.sky)===null||f===void 0)&&f.hasTransition()||!((v=this.projection)===null||v===void 0)&&v.hasTransition())return!0;for(let S in this.sourceCaches)if(this.sourceCaches[S].hasTransition())return!0;for(let S in this._layers)if(this._layers[S].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;let f=this._changed;if(f){let S=Object.keys(this._updatedLayers),I=Object.keys(this._removedLayers);(S.length||I.length)&&this._updateWorkerLayers(S,I);for(let D in this._updatedSources){let z=this._updatedSources[D];if(z==="reload")this._reloadSource(D);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(D)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let D in this._updatedPaintProps)this._layers[D].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}let v={};for(let S in this.sourceCaches){let I=this.sourceCaches[S];v[S]=I.used,I.used=!1}for(let S of this._order){let I=this._layers[S];I.recalculate(l,this._availableImages),!I.isHidden(l.zoom)&&I.source&&(this.sourceCaches[I.source].used=!0)}for(let S in v){let I=this.sourceCaches[S];!!v[S]!=!!I.used&&I.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:S}))}this.light.recalculate(l),this.sky.recalculate(l),this.projection.recalculate(l),this.z=l.zoom,f&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){let l=Object.keys(this._changedImages);if(l.length){for(let f in this.sourceCaches)this.sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,f){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,f={}){var v;this._checkLoaded();let S=this.serialize();if(l=f.transformStyle?f.transformStyle(S,l):l,((v=f.validate)===null||v===void 0||v)&&vt(this,o.z(l)))return!1;(l=o.bL(l)).layers=o.bI(l.layers);let I=o.bM(S,l),D=this._getOperationsToPerform(I);if(D.unimplemented.length>0)throw new Error(`Unimplemented: ${D.unimplemented.join(", ")}.`);if(D.operations.length===0)return!1;for(let z of D.operations)z();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){let f=[],v=[];for(let S of l)switch(S.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":f.push((()=>this.addLayer.apply(this,S.args)));break;case"removeLayer":f.push((()=>this.removeLayer.apply(this,S.args)));break;case"setPaintProperty":f.push((()=>this.setPaintProperty.apply(this,S.args)));break;case"setLayoutProperty":f.push((()=>this.setLayoutProperty.apply(this,S.args)));break;case"setFilter":f.push((()=>this.setFilter.apply(this,S.args)));break;case"addSource":f.push((()=>this.addSource.apply(this,S.args)));break;case"removeSource":f.push((()=>this.removeSource.apply(this,S.args)));break;case"setLayerZoomRange":f.push((()=>this.setLayerZoomRange.apply(this,S.args)));break;case"setLight":f.push((()=>this.setLight.apply(this,S.args)));break;case"setGeoJSONSourceData":f.push((()=>this.setGeoJSONSourceData.apply(this,S.args)));break;case"setGlyphs":f.push((()=>this.setGlyphs.apply(this,S.args)));break;case"setSprite":f.push((()=>this.setSprite.apply(this,S.args)));break;case"setTerrain":f.push((()=>this.map.setTerrain.apply(this,S.args)));break;case"setSky":f.push((()=>this.setSky.apply(this,S.args)));break;case"setProjection":this.setProjection.apply(this,S.args);break;case"setGlobalState":f.push((()=>this.setGlobalState.apply(this,S.args)));break;case"setTransition":f.push((()=>{}));break;default:v.push(S.command)}return{operations:f,unimplemented:v}}addImage(l,f){if(this.getImage(l))return this.fire(new o.k(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,f),this._afterImageUpdated(l)}updateImage(l,f){this.imageManager.updateImage(l,f)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.k(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,f,v={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(o.z.source,`sources.${l}`,f,null,v))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);let S=this.sourceCaches[l]=new rn(l,f,this.dispatcher);S.style=this,S.setEventedParent(this,(()=>({isSourceLoaded:S.loaded(),source:S.serialize(),sourceId:l}))),S.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(let v in this._layers)if(this._layers[v].source===l)return this.fire(new o.k(new Error(`Source "${l}" cannot be removed while layer "${v}" is using it.`)));let f=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],f.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),f.setEventedParent(null),f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,f){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);let v=this.sourceCaches[l].getSource();if(v.type!=="geojson")throw new Error(`geojsonSource.type is ${v.type}, which is !== 'geojson`);v.setData(f),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,f,v={}){this._checkLoaded();let S=l.id;if(this.getLayer(S))return void this.fire(new o.k(new Error(`Layer "${S}" already exists on this map.`)));let I;if(l.type==="custom"){if(vt(this,o.bN(l)))return;I=o.bJ(l,this._globalState)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(S,l.source),l=o.bL(l),l=o.e(l,{source:S})),this._validate(o.z.layer,`layers.${S}`,l,{arrayIndex:-1},v))return;I=o.bJ(l,this._globalState),this._validateLayer(I),I.setEventedParent(this,{layer:{id:S}})}let D=f?this._order.indexOf(f):this._order.length;if(f&&D===-1)this.fire(new o.k(new Error(`Cannot add layer "${S}" before non-existing layer "${f}".`)));else{if(this._order.splice(D,0,S),this._layerOrderChanged=!0,this._layers[S]=I,this._removedLayers[S]&&I.source&&I.type!=="custom"){let z=this._removedLayers[S];delete this._removedLayers[S],z.type!==I.type?this._updatedSources[I.source]="clear":(this._updatedSources[I.source]="reload",this.sourceCaches[I.source].pause())}this._updateLayer(I),I.onAdd&&I.onAdd(this.map)}}moveLayer(l,f){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.k(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===f)return;let v=this._order.indexOf(l);this._order.splice(v,1);let S=f?this._order.indexOf(f):this._order.length;f&&S===-1?this.fire(new o.k(new Error(`Cannot move layer "${l}" before non-existing layer "${f}".`))):(this._order.splice(S,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();let f=this._layers[l];if(!f)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${l}".`)));f.setEventedParent(null);let v=this._order.indexOf(l);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=f,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],f.onRemove&&f.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,f,v){this._checkLoaded();let S=this.getLayer(l);S?S.minzoom===f&&S.maxzoom===v||(f!=null&&(S.minzoom=f),v!=null&&(S.maxzoom=v),this._updateLayer(S)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,f,v={}){this._checkLoaded();let S=this.getLayer(l);if(S){if(!o.bH(S.filter,f))return f==null?(S.setFilter(void 0),void this._updateLayer(S)):void(this._validate(o.z.filter,`layers.${S.id}.filter`,f,null,v)||(S.setFilter(o.bL(f)),this._updateLayer(S)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.bL(this.getLayer(l).filter)}setLayoutProperty(l,f,v,S={}){this._checkLoaded();let I=this.getLayer(l);I?o.bH(I.getLayoutProperty(f),v)||(I.setLayoutProperty(f,v,S),this._updateLayer(I)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,f){let v=this.getLayer(l);if(v)return v.getLayoutProperty(f);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,f,v,S={}){this._checkLoaded();let I=this.getLayer(l);I?o.bH(I.getPaintProperty(f),v)||this._updatePaintProperty(I,f,v,S):this.fire(new o.k(new Error(`Cannot style non-existing layer "${l}".`)))}_updatePaintProperty(l,f,v,S={}){l.setPaintProperty(f,v,S)&&this._updateLayer(l),o.bK(l)&&f==="raster-fade-duration"&&this.sourceCaches[l.source].setRasterFadeDuration(v),this._changed=!0,this._updatedPaintProps[l.id]=!0,this._serializedLayers=null}getPaintProperty(l,f){return this.getLayer(l).getPaintProperty(f)}setFeatureState(l,f){this._checkLoaded();let v=l.source,S=l.sourceLayer,I=this.sourceCaches[v];if(I===void 0)return void this.fire(new o.k(new Error(`The source '${v}' does not exist in the map's style.`)));let D=I.getSource().type;D==="geojson"&&S?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):D!=="vector"||S?(l.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),I.setFeatureState(S,l.id,f)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,f){this._checkLoaded();let v=l.source,S=this.sourceCaches[v];if(S===void 0)return void this.fire(new o.k(new Error(`The source '${v}' does not exist in the map's style.`)));let I=S.getSource().type,D=I==="vector"?l.sourceLayer:void 0;I!=="vector"||D?f&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):S.removeFeatureState(D,l.id,f):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();let f=l.source,v=l.sourceLayer,S=this.sourceCaches[f];if(S!==void 0)return S.getSource().type!=="vector"||v?(l.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),S.getFeatureState(v,l.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let l=o.bO(this.sourceCaches,(I=>I.serialize())),f=this._serializeByIds(this._order,!0),v=this.map.getTerrain()||void 0,S=this.stylesheet;return o.bP({version:S.version,name:S.name,metadata:S.metadata,light:S.light,sky:S.sky,center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch,sprite:S.sprite,glyphs:S.glyphs,transition:S.transition,projection:S.projection,sources:l,layers:f,terrain:v},(I=>I!==void 0))}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){let f=D=>this._layers[D].type==="fill-extrusion",v={},S=[];for(let D=this._order.length-1;D>=0;D--){let z=this._order[D];if(f(z)){v[z]=D;for(let V of l){let X=V[z];if(X)for(let Q of X)S.push(Q)}}}S.sort(((D,z)=>z.intersectionZ-D.intersectionZ));let I=[];for(let D=this._order.length-1;D>=0;D--){let z=this._order[D];if(f(z))for(let V=S.length-1;V>=0;V--){let X=S[V].feature;if(v[X.layer.id]<D)break;I.push(X),S.pop()}else for(let V of l){let X=V[z];if(X)for(let Q of X)I.push(Q.feature)}}return I}queryRenderedFeatures(l,f,v){f&&f.filter&&this._validate(o.z.filter,"queryRenderedFeatures.filter",f.filter,null,f);let S={};if(f&&f.layers){if(!(Array.isArray(f.layers)||f.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(let X of f.layers){let Q=this._layers[X];if(!Q)return this.fire(new o.k(new Error(`The layer '${X}' does not exist in the map's style and cannot be queried for features.`))),[];S[Q.source]=!0}}let I=[];f.availableImages=this._availableImages;let D=this._serializedAllLayers(),z=f.layers instanceof Set?f.layers:Array.isArray(f.layers)?new Set(f.layers):null,V=Object.assign(Object.assign({},f),{layers:z,globalState:this._globalState});for(let X in this.sourceCaches)f.layers&&!S[X]||I.push(Ki(this.sourceCaches[X],this._layers,D,l,V,v,this.map.terrain?(Q,ie,re)=>this.map.terrain.getElevation(Q,ie,re):void 0));return this.placement&&I.push((function(X,Q,ie,re,ae,Ae,Te){let Me={},Ce=Ae.queryRenderedSymbols(re),De=[];for(let Ve of Object.keys(Ce).map(Number))De.push(Te[Ve]);De.sort(hn);for(let Ve of De){let Oe=Ve.featureIndex.lookupSymbolFeatures(Ce[Ve.bucketInstanceId],Q,Ve.bucketIndex,Ve.sourceLayerIndex,{filterSpec:ae.filter,globalState:ae.globalState},ae.layers,ae.availableImages,X);for(let je in Oe){let He=Me[je]=Me[je]||[],Be=Oe[je];Be.sort(((et,Ke)=>{let ct=Ve.featureSortOrder;if(ct){let Ye=ct.indexOf(et.featureIndex);return ct.indexOf(Ke.featureIndex)-Ye}return Ke.featureIndex-et.featureIndex}));for(let et of Be)He.push(et)}}return(function(Ve,Oe,je){for(let He in Ve)for(let Be of Ve[He])_l(Be,je[Oe[He].source]);return Ve})(Me,X,ie)})(this._layers,D,this.sourceCaches,l,V,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(I)}querySourceFeatures(l,f){f?.filter&&this._validate(o.z.filter,"querySourceFeatures.filter",f.filter,null,f);let v=this.sourceCaches[l];return v?(function(S,I){let D=S.getRenderableIds().map((X=>S.getTileByID(X))),z=[],V={};for(let X=0;X<D.length;X++){let Q=D[X],ie=Q.tileID.canonical.key;V[ie]||(V[ie]=!0,Q.querySourceFeatures(z,I))}return z})(v,f?Object.assign(Object.assign({},f),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(l,f={}){this._checkLoaded();let v=this.light.getLight(),S=!1;for(let D in l)if(!o.bH(l[D],v[D])){S=!0;break}if(!S)return;let I={now:M(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,f),this.light.updateTransitions(I)}getProjection(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.projection}setProjection(l){if(this._checkLoaded(),this.projection){if(this.projection.name===l.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=l,this._setProjectionInternal(l.type)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,f={}){this._checkLoaded();let v=this.getSky(),S=!1;if(!l&&!v)return;if(l&&!v)S=!0;else if(!l&&v)S=!0;else for(let D in l)if(!o.bH(l[D],v[D])){S=!0;break}if(!S)return;let I={now:M(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,f),this.sky.updateTransitions(I)}_setProjectionInternal(l){let f=(function(v,S){let I={constrain:S};if(Array.isArray(v)){let D=new Ir({type:v});return{projection:D,transform:new Hh(I),cameraHelper:new Xu(D)}}switch(v){case"mercator":return{projection:new lm,transform:new qs(I),cameraHelper:new uo};case"globe":{let D=new Ir({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:D,transform:new Hh(I),cameraHelper:new Xu(D)}}case"vertical-perspective":return{projection:new Xt,transform:new Tp(I),cameraHelper:new el};default:return o.w(`Unknown projection name: ${v}. Falling back to mercator projection.`),{projection:new lm,transform:new qs(I),cameraHelper:new uo}}})(l,this.map.transformConstrain);this.projection=f.projection,this.map.migrateProjection(f.transform,f.cameraHelper);for(let v in this.sourceCaches)this.sourceCaches[v].reload()}_validate(l,f,v,S,I={}){return(!I||I.validate!==!1)&&vt(this,l.call(o.z,o.e({key:f,style:this.serialize(),value:v,styleSpec:o.v},S)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Hl().off(bl,this._rtlPluginLoaded);for(let f in this._layers)this._layers[f].setEventedParent(null);for(let f in this.sourceCaches){let v=this.sourceCaches[f];v.setEventedParent(null),v.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(let f in this.sourceCaches)this.sourceCaches[f].update(l,this.map.terrain)}_generateCollisionBoxes(){for(let l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,f,v,S,I=!1){let D=!1,z=!1,V={};for(let X of this._order){let Q=this._layers[X];if(Q.type!=="symbol")continue;if(!V[Q.source]){let re=this.sourceCaches[Q.source];V[Q.source]=re.getRenderableIds(!0).map((ae=>re.getTileByID(ae))).sort(((ae,Ae)=>Ae.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(Ae.tileID)?-1:1)))}let ie=this.crossTileSymbolIndex.addLayer(Q,V[Q.source],l.center.lng);D=D||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((I=I||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(M(),l.zoom))&&(this.pauseablePlacement=new dv(l,this.map.terrain,this._order,I,f,v,S,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,V),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(M()),z=!0),D&&this.pauseablePlacement.placement.setStale()),z||D)for(let X of this._order){let Q=this._layers[X];Q.type==="symbol"&&this.placement.updateLayerOpacities(Q,V[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(M())}_releaseSymbolFadeTiles(){for(let l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,f){return o._(this,void 0,void 0,(function*(){let v=yield this.imageManager.getImages(f.icons);this._updateTilesForChangedImages();let S=this.sourceCaches[f.source];return S&&S.setDependencies(f.tileID.key,f.type,f.icons),v}))}getGlyphs(l,f){return o._(this,void 0,void 0,(function*(){let v=yield this.glyphManager.getGlyphs(f.stacks),S=this.sourceCaches[f.source];return S&&S.setDependencies(f.tileID.key,f.type,[""]),v}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,f={}){this._checkLoaded(),l&&this._validate(o.z.glyphs,"glyphs",l,null,f)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}getDashes(l,f){return o._(this,void 0,void 0,(function*(){let v={};for(let[S,I]of Object.entries(f.dashes))v[S]=this.lineAtlas.getDash(I.dasharray,I.round);return v}))}addSprite(l,f,v={},S){this._checkLoaded();let I=[{id:l,url:f}],D=[...ge(this.stylesheet.sprite),...I];this._validate(o.z.sprite,"sprite",D,null,v)||(this.stylesheet.sprite=D,this._loadSprite(I,!0,S))}removeSprite(l){this._checkLoaded();let f=ge(this.stylesheet.sprite);if(f.find((v=>v.id===l))){if(this._spritesImagesIds[l])for(let v of this._spritesImagesIds[l])this.imageManager.removeImage(v),this._changedImages[v]=!0;f.splice(f.findIndex((v=>v.id===l)),1),this.stylesheet.sprite=f.length>0?f:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return ge(this.stylesheet.sprite)}setSprite(l,f={},v){this._checkLoaded(),l&&this._validate(o.z.sprite,"sprite",l,null,f)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,v):(this._unloadSprite(),v&&v(null)))}}var zt=o.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class A{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,f,v,S,I,D,z,V,X){this.context=l;let Q=this.boundPaintVertexBuffers.length!==S.length;for(let ie=0;!Q&&ie<S.length;ie++)this.boundPaintVertexBuffers[ie]!==S[ie]&&(Q=!0);!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==v||Q||this.boundIndexBuffer!==I||this.boundVertexOffset!==D||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==V||this.boundDynamicVertexBuffer3!==X?this.freshBind(f,v,S,I,D,z,V,X):(l.bindVertexArray.set(this.vao),z&&z.bind(),I&&I.dynamicDraw&&I.bind(),V&&V.bind(),X&&X.bind())}freshBind(l,f,v,S,I,D,z,V){let X=l.numAttributes,Q=this.context,ie=Q.gl;this.vao&&this.destroy(),this.vao=Q.createVertexArray(),Q.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=S,this.boundVertexOffset=I,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=V,f.enableAttributes(ie,l);for(let re of v)re.enableAttributes(ie,l);D&&D.enableAttributes(ie,l),z&&z.enableAttributes(ie,l),V&&V.enableAttributes(ie,l),f.bind(),f.setVertexAttribPointers(ie,l,I);for(let re of v)re.bind(),re.setVertexAttribPointers(ie,l,I);D&&(D.bind(),D.setVertexAttribPointers(ie,l,I)),S&&S.bind(),z&&(z.bind(),z.setVertexAttribPointers(ie,l,I)),V&&(V.bind(),V.setVertexAttribPointers(ie,l,I)),Q.currentNumAttributes=X}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let wn=(C,l,f,v,S)=>({u_texture:0,u_ele_delta:C,u_fog_matrix:l,u_fog_color:f?f.properties.get("fog-color"):o.bf.white,u_fog_ground_blend:f?f.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:S?0:f?f.calculateFogBlendOpacity(v):0,u_horizon_color:f?f.properties.get("horizon-color"):o.bf.white,u_horizon_fog_blend:f?f.properties.get("horizon-fog-blend"):1,u_is_globe_mode:S?1:0}),sn={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function de(C){let l=[];for(let f=0;f<C.length;f++){if(C[f]===null)continue;let v=C[f].split(" ");l.push(v.pop())}return l}class Ms{constructor(l,f,v,S,I,D,z,V,X=[]){let Q=l.gl;this.program=Q.createProgram();let ie=de(f.staticAttributes),re=v?v.getBinderAttributes():[],ae=ie.concat(re),Ae=iu.prelude.staticUniforms?de(iu.prelude.staticUniforms):[],Te=z.staticUniforms?de(z.staticUniforms):[],Me=f.staticUniforms?de(f.staticUniforms):[],Ce=v?v.getBinderUniforms():[],De=Ae.concat(Te).concat(Me).concat(Ce),Ve=[];for(let ct of De)Ve.indexOf(ct)<0&&Ve.push(ct);let Oe=v?v.defines():[];nu(Q)&&Oe.unshift("#version 300 es"),I&&Oe.push("#define OVERDRAW_INSPECTOR;"),D&&Oe.push("#define TERRAIN3D;"),V&&Oe.push(V),X&&Oe.push(...X);let je=Oe.concat(iu.prelude.fragmentSource,z.fragmentSource,f.fragmentSource).join(`
`),He=Oe.concat(iu.prelude.vertexSource,z.vertexSource,f.vertexSource).join(`
`);nu(Q)||(je=(function(ct){return ct.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(je),He=(function(ct){return ct.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(He));let Be=Q.createShader(Q.FRAGMENT_SHADER);if(Q.isContextLost())return void(this.failedToCreate=!0);if(Q.shaderSource(Be,je),Q.compileShader(Be),!Q.getShaderParameter(Be,Q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Q.getShaderInfoLog(Be)}`);Q.attachShader(this.program,Be);let et=Q.createShader(Q.VERTEX_SHADER);if(Q.isContextLost())return void(this.failedToCreate=!0);if(Q.shaderSource(et,He),Q.compileShader(et),!Q.getShaderParameter(et,Q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Q.getShaderInfoLog(et)}`);Q.attachShader(this.program,et),this.attributes={};let Ke={};this.numAttributes=ae.length;for(let ct=0;ct<this.numAttributes;ct++)ae[ct]&&(Q.bindAttribLocation(this.program,ct,ae[ct]),this.attributes[ae[ct]]=ct);if(Q.linkProgram(this.program),!Q.getProgramParameter(this.program,Q.LINK_STATUS))throw new Error(`Program failed to link: ${Q.getProgramInfoLog(this.program)}`);Q.deleteShader(et),Q.deleteShader(Be);for(let ct=0;ct<Ve.length;ct++){let Ye=Ve[ct];if(Ye&&!Ke[Ye]){let gt=Q.getUniformLocation(this.program,Ye);gt&&(Ke[Ye]=gt)}}this.fixedUniforms=S(l,Ke),this.terrainUniforms=((ct,Ye)=>({u_depth:new o.bQ(ct,Ye.u_depth),u_terrain:new o.bQ(ct,Ye.u_terrain),u_terrain_dim:new o.bg(ct,Ye.u_terrain_dim),u_terrain_matrix:new o.bS(ct,Ye.u_terrain_matrix),u_terrain_unpack:new o.bT(ct,Ye.u_terrain_unpack),u_terrain_exaggeration:new o.bg(ct,Ye.u_terrain_exaggeration)}))(l,Ke),this.projectionUniforms=((ct,Ye)=>({u_projection_matrix:new o.bS(ct,Ye.u_projection_matrix),u_projection_tile_mercator_coords:new o.bT(ct,Ye.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bT(ct,Ye.u_projection_clipping_plane),u_projection_transition:new o.bg(ct,Ye.u_projection_transition),u_projection_fallback_matrix:new o.bS(ct,Ye.u_projection_fallback_matrix)}))(l,Ke),this.binderUniforms=v?v.getUniforms(l,Ke):[]}draw(l,f,v,S,I,D,z,V,X,Q,ie,re,ae,Ae,Te,Me,Ce,De,Ve){let Oe=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(v),l.setStencilMode(S),l.setColorMode(I),l.setCullFace(D),V){l.activeTexture.set(Oe.TEXTURE2),Oe.bindTexture(Oe.TEXTURE_2D,V.depthTexture),l.activeTexture.set(Oe.TEXTURE3),Oe.bindTexture(Oe.TEXTURE_2D,V.texture);for(let He in this.terrainUniforms)this.terrainUniforms[He].set(V[He])}if(X)for(let He in X)this.projectionUniforms[sn[He]].set(X[He]);if(z)for(let He in this.fixedUniforms)this.fixedUniforms[He].set(z[He]);Me&&Me.setUniforms(l,this.binderUniforms,Ae,{zoom:Te});let je=0;switch(f){case Oe.LINES:je=2;break;case Oe.TRIANGLES:je=3;break;case Oe.LINE_STRIP:je=1}for(let He of ae.get()){let Be=He.vaos||(He.vaos={});(Be[Q]||(Be[Q]=new A)).bind(l,this,ie,Me?Me.getPaintVertexBuffers():[],re,He.vertexOffset,Ce,De,Ve),Oe.drawElements(f,He.primitiveLength*je,Oe.UNSIGNED_SHORT,He.primitiveOffset*je*2)}}}function Ys(C,l,f){let v=1/o.aC(f,1,l.transform.tileZoom),S=Math.pow(2,f.tileID.overscaledZ),I=f.tileSize*Math.pow(2,l.transform.tileZoom)/S,D=I*(f.tileID.canonical.x+f.tileID.wrap*S),z=I*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[v,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[D>>16,z>>16],u_pixel_coord_lower:[65535&D,65535&z]}}let So=(C,l,f,v)=>{let S=C.style.light,I=S.properties.get("position"),D=[I.x,I.y,I.z],z=o.bW();S.properties.get("anchor")==="viewport"&&o.bX(z,C.transform.bearingInRadians),o.bY(D,D,z);let V=C.transform.transformLightDirection(D),X=S.properties.get("color");return{u_lightpos:D,u_lightpos_globe:V,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[X.r,X.g,X.b],u_vertical_gradient:+l,u_opacity:f,u_fill_translate:v}},qi=(C,l,f,v,S,I,D)=>o.e(So(C,l,f,v),Ys(I,C,D),{u_height_factor:-Math.pow(2,S.overscaledZ)/D.tileSize/8}),Kn=(C,l,f,v)=>o.e(Ys(l,C,f),{u_fill_translate:v}),jo=(C,l)=>({u_world:C,u_fill_translate:l}),en=(C,l,f,v,S)=>o.e(Kn(C,l,f,S),{u_world:v}),Yi=(C,l,f,v,S)=>{let I=C.transform,D,z,V=0;if(f.paint.get("circle-pitch-alignment")==="map"){let X=o.aC(l,1,I.zoom);D=!0,z=[X,X],V=X/(o.$*Math.pow(2,l.tileID.overscaledZ))*2*Math.PI*S}else D=!1,z=I.pixelsToGLUnits;return{u_camera_to_center_distance:I.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+D,u_device_pixel_ratio:C.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:V,u_translate:v}},hm=C=>({u_pixel_extrude_scale:[1/C.width,1/C.height]}),Nx=C=>({u_viewport_size:[C.width,C.height]}),zx=(C,l=1)=>({u_color:C,u_overlay:0,u_overlay_scale:l}),dm=(C,l,f,v)=>{let S=o.aC(C,1,l)/(o.$*Math.pow(2,C.tileID.overscaledZ))*2*Math.PI*v;return{u_extrude_scale:o.aC(C,1,l),u_intensity:f,u_globe_extrude_scale:S}},Da=(C,l,f,v)=>{let S=o.L();o.bZ(S,0,C.width,C.height,0,0,1);let I=C.context.gl;return{u_matrix:S,u_world:[I.drawingBufferWidth,I.drawingBufferHeight],u_image:f,u_color_ramp:v,u_opacity:l.paint.get("heatmap-opacity")}},hf=(C,l,f)=>{let v=f.paint.get("hillshade-accent-color"),S;switch(f.paint.get("hillshade-method")){case"basic":S=4;break;case"combined":S=1;break;case"igor":S=2;break;case"multidirectional":S=3;break;default:S=0}let I=f.getIlluminationProperties();for(let D=0;D<I.directionRadians.length;D++)f.paint.get("hillshade-illumination-anchor")==="viewport"&&(I.directionRadians[D]+=C.transform.bearingInRadians);return{u_image:0,u_latrange:dA(0,l.tileID),u_exaggeration:f.paint.get("hillshade-exaggeration"),u_altitudes:I.altitudeRadians,u_azimuths:I.directionRadians,u_accent:v,u_method:S,u_highlights:I.highlightColor,u_shadows:I.shadowColor}},wc=(C,l)=>{let f=l.stride,v=o.L();return o.bZ(v,0,o.$,-o.$,0,0,1),o.M(v,v,[0,-o.$,0]),{u_matrix:v,u_image:1,u_dimension:[f,f],u_zoom:C.overscaledZ,u_unpack:l.getUnpackVector()}};function dA(C,l){let f=Math.pow(2,l.canonical.z),v=l.canonical.y;return[new o.a1(0,v/f).toLngLat().lat,new o.a1(0,(v+1)/f).toLngLat().lat]}let Ux=(C,l,f=0)=>({u_image:0,u_unpack:l.getUnpackVector(),u_dimension:[l.stride,l.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:f,u_opacity:C.paint.get("color-relief-opacity")}),Es=(C,l,f,v)=>{let S=C.transform;return{u_translation:jx(C,l,f),u_ratio:v/o.aC(l,1,S.zoom),u_device_pixel_ratio:C.pixelRatio,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},si=(C,l,f,v,S)=>o.e(Es(C,l,f,v),{u_image:0,u_image_height:S}),be=(C,l,f,v,S)=>{let I=C.transform,D=Mp(l,I);return{u_translation:jx(C,l,f),u_texsize:l.imageAtlasTexture.size,u_ratio:v/o.aC(l,1,I.zoom),u_device_pixel_ratio:C.pixelRatio,u_image:0,u_scale:[D,S.fromScale,S.toScale],u_fade:S.t,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]]}},Ur=(C,l,f,v,S)=>{let I=Mp(l,C.transform);return o.e(Es(C,l,f,v),{u_tileratio:I,u_crossfade_from:S.fromScale,u_crossfade_to:S.toScale,u_image:0,u_mix:S.t,u_lineatlas_width:C.lineAtlas.width,u_lineatlas_height:C.lineAtlas.height})},Vx=(C,l,f,v,S,I)=>{let D=Mp(l,C.transform);return o.e(Es(C,l,f,v),{u_image:0,u_image_height:I,u_tileratio:D,u_crossfade_from:S.fromScale,u_crossfade_to:S.toScale,u_image_dash:1,u_mix:S.t,u_lineatlas_width:C.lineAtlas.width,u_lineatlas_height:C.lineAtlas.height})};function Mp(C,l){return 1/o.aC(C,1,l.tileZoom)}function jx(C,l,f){return o.aD(C.transform,l,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}let B4=(C,l,f,v,S)=>{return{u_tl_parent:C,u_scale_parent:l,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(D=v.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(I=v.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:$x(v.paint.get("raster-hue-rotate")),u_coords_top:[S[0].x,S[0].y,S[1].x,S[1].y],u_coords_bottom:[S[3].x,S[3].y,S[2].x,S[2].y]};var I,D};function $x(C){C*=Math.PI/180;let l=Math.sin(C),f=Math.cos(C);return[(2*f+1)/3,(-Math.sqrt(3)*l-f+1)/3,(Math.sqrt(3)*l-f+1)/3]}let me=(C,l,f,v,S,I,D,z,V,X,Q,ie,re)=>{let ae=D.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:ae.cameraToCenterDistance,u_pitch:ae.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:ae.width/ae.height,u_fade_change:D.options.fadeDuration?D.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:V,u_is_text:+Q,u_pitch_with_map:+v,u_is_along_line:S,u_is_variable_anchor:I,u_texsize:ie,u_texture:0,u_translation:X,u_pitched_scale:re}},gv=(C,l,f,v,S,I,D,z,V,X,Q,ie,re,ae)=>{let Ae=D.transform;return o.e(me(C,l,f,v,S,I,D,z,V,X,Q,ie,ae),{u_gamma_scale:v?Math.cos(Ae.pitch*Math.PI/180)*Ae.cameraToCenterDistance:1,u_device_pixel_ratio:D.pixelRatio,u_is_halo:1})},Av=(C,l,f,v,S,I,D,z,V,X,Q,ie,re)=>o.e(gv(C,l,f,v,S,I,D,z,V,X,!0,Q,0,re),{u_texsize_icon:ie,u_texture_icon:1}),Wx=(C,l)=>({u_opacity:C,u_color:l}),fA=(C,l,f,v,S)=>o.e((function(I,D,z,V){let X=z.imageManager.getPattern(I.from.toString()),Q=z.imageManager.getPattern(I.to.toString()),{width:ie,height:re}=z.imageManager.getPixelSize(),ae=Math.pow(2,V.tileID.overscaledZ),Ae=V.tileSize*Math.pow(2,z.transform.tileZoom)/ae,Te=Ae*(V.tileID.canonical.x+V.tileID.wrap*ae),Me=Ae*V.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:X.tl,u_pattern_br_a:X.br,u_pattern_tl_b:Q.tl,u_pattern_br_b:Q.br,u_texsize:[ie,re],u_mix:D.t,u_pattern_size_a:X.displaySize,u_pattern_size_b:Q.displaySize,u_scale_a:D.fromScale,u_scale_b:D.toScale,u_tile_units_to_pixels:1/o.aC(V,1,z.transform.tileZoom),u_pixel_coord_upper:[Te>>16,Me>>16],u_pixel_coord_lower:[65535&Te,65535&Me]}})(f,S,l,v),{u_opacity:C}),su=(C,l)=>{},yv={fillExtrusion:(C,l)=>({u_lightpos:new o.bU(C,l.u_lightpos),u_lightpos_globe:new o.bU(C,l.u_lightpos_globe),u_lightintensity:new o.bg(C,l.u_lightintensity),u_lightcolor:new o.bU(C,l.u_lightcolor),u_vertical_gradient:new o.bg(C,l.u_vertical_gradient),u_opacity:new o.bg(C,l.u_opacity),u_fill_translate:new o.bV(C,l.u_fill_translate)}),fillExtrusionPattern:(C,l)=>({u_lightpos:new o.bU(C,l.u_lightpos),u_lightpos_globe:new o.bU(C,l.u_lightpos_globe),u_lightintensity:new o.bg(C,l.u_lightintensity),u_lightcolor:new o.bU(C,l.u_lightcolor),u_vertical_gradient:new o.bg(C,l.u_vertical_gradient),u_height_factor:new o.bg(C,l.u_height_factor),u_opacity:new o.bg(C,l.u_opacity),u_fill_translate:new o.bV(C,l.u_fill_translate),u_image:new o.bQ(C,l.u_image),u_texsize:new o.bV(C,l.u_texsize),u_pixel_coord_upper:new o.bV(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bV(C,l.u_pixel_coord_lower),u_scale:new o.bU(C,l.u_scale),u_fade:new o.bg(C,l.u_fade)}),fill:(C,l)=>({u_fill_translate:new o.bV(C,l.u_fill_translate)}),fillPattern:(C,l)=>({u_image:new o.bQ(C,l.u_image),u_texsize:new o.bV(C,l.u_texsize),u_pixel_coord_upper:new o.bV(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bV(C,l.u_pixel_coord_lower),u_scale:new o.bU(C,l.u_scale),u_fade:new o.bg(C,l.u_fade),u_fill_translate:new o.bV(C,l.u_fill_translate)}),fillOutline:(C,l)=>({u_world:new o.bV(C,l.u_world),u_fill_translate:new o.bV(C,l.u_fill_translate)}),fillOutlinePattern:(C,l)=>({u_world:new o.bV(C,l.u_world),u_image:new o.bQ(C,l.u_image),u_texsize:new o.bV(C,l.u_texsize),u_pixel_coord_upper:new o.bV(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bV(C,l.u_pixel_coord_lower),u_scale:new o.bU(C,l.u_scale),u_fade:new o.bg(C,l.u_fade),u_fill_translate:new o.bV(C,l.u_fill_translate)}),circle:(C,l)=>({u_camera_to_center_distance:new o.bg(C,l.u_camera_to_center_distance),u_scale_with_map:new o.bQ(C,l.u_scale_with_map),u_pitch_with_map:new o.bQ(C,l.u_pitch_with_map),u_extrude_scale:new o.bV(C,l.u_extrude_scale),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_globe_extrude_scale:new o.bg(C,l.u_globe_extrude_scale),u_translate:new o.bV(C,l.u_translate)}),collisionBox:(C,l)=>({u_pixel_extrude_scale:new o.bV(C,l.u_pixel_extrude_scale)}),collisionCircle:(C,l)=>({u_viewport_size:new o.bV(C,l.u_viewport_size)}),debug:(C,l)=>({u_color:new o.bR(C,l.u_color),u_overlay:new o.bQ(C,l.u_overlay),u_overlay_scale:new o.bg(C,l.u_overlay_scale)}),depth:su,clippingMask:su,heatmap:(C,l)=>({u_extrude_scale:new o.bg(C,l.u_extrude_scale),u_intensity:new o.bg(C,l.u_intensity),u_globe_extrude_scale:new o.bg(C,l.u_globe_extrude_scale)}),heatmapTexture:(C,l)=>({u_matrix:new o.bS(C,l.u_matrix),u_world:new o.bV(C,l.u_world),u_image:new o.bQ(C,l.u_image),u_color_ramp:new o.bQ(C,l.u_color_ramp),u_opacity:new o.bg(C,l.u_opacity)}),hillshade:(C,l)=>({u_image:new o.bQ(C,l.u_image),u_latrange:new o.bV(C,l.u_latrange),u_exaggeration:new o.bg(C,l.u_exaggeration),u_altitudes:new o.b$(C,l.u_altitudes),u_azimuths:new o.b$(C,l.u_azimuths),u_accent:new o.bR(C,l.u_accent),u_method:new o.bQ(C,l.u_method),u_shadows:new o.b_(C,l.u_shadows),u_highlights:new o.b_(C,l.u_highlights)}),hillshadePrepare:(C,l)=>({u_matrix:new o.bS(C,l.u_matrix),u_image:new o.bQ(C,l.u_image),u_dimension:new o.bV(C,l.u_dimension),u_zoom:new o.bg(C,l.u_zoom),u_unpack:new o.bT(C,l.u_unpack)}),colorRelief:(C,l)=>({u_image:new o.bQ(C,l.u_image),u_unpack:new o.bT(C,l.u_unpack),u_dimension:new o.bV(C,l.u_dimension),u_elevation_stops:new o.bQ(C,l.u_elevation_stops),u_color_stops:new o.bQ(C,l.u_color_stops),u_color_ramp_size:new o.bQ(C,l.u_color_ramp_size),u_opacity:new o.bg(C,l.u_opacity)}),line:(C,l)=>({u_translation:new o.bV(C,l.u_translation),u_ratio:new o.bg(C,l.u_ratio),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.bV(C,l.u_units_to_pixels)}),lineGradient:(C,l)=>({u_translation:new o.bV(C,l.u_translation),u_ratio:new o.bg(C,l.u_ratio),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.bV(C,l.u_units_to_pixels),u_image:new o.bQ(C,l.u_image),u_image_height:new o.bg(C,l.u_image_height)}),linePattern:(C,l)=>({u_translation:new o.bV(C,l.u_translation),u_texsize:new o.bV(C,l.u_texsize),u_ratio:new o.bg(C,l.u_ratio),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_image:new o.bQ(C,l.u_image),u_units_to_pixels:new o.bV(C,l.u_units_to_pixels),u_scale:new o.bU(C,l.u_scale),u_fade:new o.bg(C,l.u_fade)}),lineSDF:(C,l)=>({u_translation:new o.bV(C,l.u_translation),u_ratio:new o.bg(C,l.u_ratio),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.bV(C,l.u_units_to_pixels),u_image:new o.bQ(C,l.u_image),u_mix:new o.bg(C,l.u_mix),u_tileratio:new o.bg(C,l.u_tileratio),u_crossfade_from:new o.bg(C,l.u_crossfade_from),u_crossfade_to:new o.bg(C,l.u_crossfade_to),u_lineatlas_width:new o.bg(C,l.u_lineatlas_width),u_lineatlas_height:new o.bg(C,l.u_lineatlas_height)}),lineGradientSDF:(C,l)=>({u_translation:new o.bV(C,l.u_translation),u_ratio:new o.bg(C,l.u_ratio),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_units_to_pixels:new o.bV(C,l.u_units_to_pixels),u_image:new o.bQ(C,l.u_image),u_image_height:new o.bg(C,l.u_image_height),u_tileratio:new o.bg(C,l.u_tileratio),u_crossfade_from:new o.bg(C,l.u_crossfade_from),u_crossfade_to:new o.bg(C,l.u_crossfade_to),u_image_dash:new o.bQ(C,l.u_image_dash),u_mix:new o.bg(C,l.u_mix),u_lineatlas_width:new o.bg(C,l.u_lineatlas_width),u_lineatlas_height:new o.bg(C,l.u_lineatlas_height)}),raster:(C,l)=>({u_tl_parent:new o.bV(C,l.u_tl_parent),u_scale_parent:new o.bg(C,l.u_scale_parent),u_buffer_scale:new o.bg(C,l.u_buffer_scale),u_fade_t:new o.bg(C,l.u_fade_t),u_opacity:new o.bg(C,l.u_opacity),u_image0:new o.bQ(C,l.u_image0),u_image1:new o.bQ(C,l.u_image1),u_brightness_low:new o.bg(C,l.u_brightness_low),u_brightness_high:new o.bg(C,l.u_brightness_high),u_saturation_factor:new o.bg(C,l.u_saturation_factor),u_contrast_factor:new o.bg(C,l.u_contrast_factor),u_spin_weights:new o.bU(C,l.u_spin_weights),u_coords_top:new o.bT(C,l.u_coords_top),u_coords_bottom:new o.bT(C,l.u_coords_bottom)}),symbolIcon:(C,l)=>({u_is_size_zoom_constant:new o.bQ(C,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bQ(C,l.u_is_size_feature_constant),u_size_t:new o.bg(C,l.u_size_t),u_size:new o.bg(C,l.u_size),u_camera_to_center_distance:new o.bg(C,l.u_camera_to_center_distance),u_pitch:new o.bg(C,l.u_pitch),u_rotate_symbol:new o.bQ(C,l.u_rotate_symbol),u_aspect_ratio:new o.bg(C,l.u_aspect_ratio),u_fade_change:new o.bg(C,l.u_fade_change),u_label_plane_matrix:new o.bS(C,l.u_label_plane_matrix),u_coord_matrix:new o.bS(C,l.u_coord_matrix),u_is_text:new o.bQ(C,l.u_is_text),u_pitch_with_map:new o.bQ(C,l.u_pitch_with_map),u_is_along_line:new o.bQ(C,l.u_is_along_line),u_is_variable_anchor:new o.bQ(C,l.u_is_variable_anchor),u_texsize:new o.bV(C,l.u_texsize),u_texture:new o.bQ(C,l.u_texture),u_translation:new o.bV(C,l.u_translation),u_pitched_scale:new o.bg(C,l.u_pitched_scale)}),symbolSDF:(C,l)=>({u_is_size_zoom_constant:new o.bQ(C,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bQ(C,l.u_is_size_feature_constant),u_size_t:new o.bg(C,l.u_size_t),u_size:new o.bg(C,l.u_size),u_camera_to_center_distance:new o.bg(C,l.u_camera_to_center_distance),u_pitch:new o.bg(C,l.u_pitch),u_rotate_symbol:new o.bQ(C,l.u_rotate_symbol),u_aspect_ratio:new o.bg(C,l.u_aspect_ratio),u_fade_change:new o.bg(C,l.u_fade_change),u_label_plane_matrix:new o.bS(C,l.u_label_plane_matrix),u_coord_matrix:new o.bS(C,l.u_coord_matrix),u_is_text:new o.bQ(C,l.u_is_text),u_pitch_with_map:new o.bQ(C,l.u_pitch_with_map),u_is_along_line:new o.bQ(C,l.u_is_along_line),u_is_variable_anchor:new o.bQ(C,l.u_is_variable_anchor),u_texsize:new o.bV(C,l.u_texsize),u_texture:new o.bQ(C,l.u_texture),u_gamma_scale:new o.bg(C,l.u_gamma_scale),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_is_halo:new o.bQ(C,l.u_is_halo),u_translation:new o.bV(C,l.u_translation),u_pitched_scale:new o.bg(C,l.u_pitched_scale)}),symbolTextAndIcon:(C,l)=>({u_is_size_zoom_constant:new o.bQ(C,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bQ(C,l.u_is_size_feature_constant),u_size_t:new o.bg(C,l.u_size_t),u_size:new o.bg(C,l.u_size),u_camera_to_center_distance:new o.bg(C,l.u_camera_to_center_distance),u_pitch:new o.bg(C,l.u_pitch),u_rotate_symbol:new o.bQ(C,l.u_rotate_symbol),u_aspect_ratio:new o.bg(C,l.u_aspect_ratio),u_fade_change:new o.bg(C,l.u_fade_change),u_label_plane_matrix:new o.bS(C,l.u_label_plane_matrix),u_coord_matrix:new o.bS(C,l.u_coord_matrix),u_is_text:new o.bQ(C,l.u_is_text),u_pitch_with_map:new o.bQ(C,l.u_pitch_with_map),u_is_along_line:new o.bQ(C,l.u_is_along_line),u_is_variable_anchor:new o.bQ(C,l.u_is_variable_anchor),u_texsize:new o.bV(C,l.u_texsize),u_texsize_icon:new o.bV(C,l.u_texsize_icon),u_texture:new o.bQ(C,l.u_texture),u_texture_icon:new o.bQ(C,l.u_texture_icon),u_gamma_scale:new o.bg(C,l.u_gamma_scale),u_device_pixel_ratio:new o.bg(C,l.u_device_pixel_ratio),u_is_halo:new o.bQ(C,l.u_is_halo),u_translation:new o.bV(C,l.u_translation),u_pitched_scale:new o.bg(C,l.u_pitched_scale)}),background:(C,l)=>({u_opacity:new o.bg(C,l.u_opacity),u_color:new o.bR(C,l.u_color)}),backgroundPattern:(C,l)=>({u_opacity:new o.bg(C,l.u_opacity),u_image:new o.bQ(C,l.u_image),u_pattern_tl_a:new o.bV(C,l.u_pattern_tl_a),u_pattern_br_a:new o.bV(C,l.u_pattern_br_a),u_pattern_tl_b:new o.bV(C,l.u_pattern_tl_b),u_pattern_br_b:new o.bV(C,l.u_pattern_br_b),u_texsize:new o.bV(C,l.u_texsize),u_mix:new o.bg(C,l.u_mix),u_pattern_size_a:new o.bV(C,l.u_pattern_size_a),u_pattern_size_b:new o.bV(C,l.u_pattern_size_b),u_scale_a:new o.bg(C,l.u_scale_a),u_scale_b:new o.bg(C,l.u_scale_b),u_pixel_coord_upper:new o.bV(C,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.bV(C,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bg(C,l.u_tile_units_to_pixels)}),terrain:(C,l)=>({u_texture:new o.bQ(C,l.u_texture),u_ele_delta:new o.bg(C,l.u_ele_delta),u_fog_matrix:new o.bS(C,l.u_fog_matrix),u_fog_color:new o.bR(C,l.u_fog_color),u_fog_ground_blend:new o.bg(C,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bg(C,l.u_fog_ground_blend_opacity),u_horizon_color:new o.bR(C,l.u_horizon_color),u_horizon_fog_blend:new o.bg(C,l.u_horizon_fog_blend),u_is_globe_mode:new o.bg(C,l.u_is_globe_mode)}),terrainDepth:(C,l)=>({u_ele_delta:new o.bg(C,l.u_ele_delta)}),terrainCoords:(C,l)=>({u_texture:new o.bQ(C,l.u_texture),u_terrain_coords_id:new o.bg(C,l.u_terrain_coords_id),u_ele_delta:new o.bg(C,l.u_ele_delta)}),projectionErrorMeasurement:(C,l)=>({u_input:new o.bg(C,l.u_input),u_output_expected:new o.bg(C,l.u_output_expected)}),atmosphere:(C,l)=>({u_sun_pos:new o.bU(C,l.u_sun_pos),u_atmosphere_blend:new o.bg(C,l.u_atmosphere_blend),u_globe_position:new o.bU(C,l.u_globe_position),u_globe_radius:new o.bg(C,l.u_globe_radius),u_inv_proj_matrix:new o.bS(C,l.u_inv_proj_matrix)}),sky:(C,l)=>({u_sky_color:new o.bR(C,l.u_sky_color),u_horizon_color:new o.bR(C,l.u_horizon_color),u_horizon:new o.bV(C,l.u_horizon),u_horizon_normal:new o.bV(C,l.u_horizon_normal),u_sky_horizon_blend:new o.bg(C,l.u_sky_horizon_blend),u_sky_blend:new o.bg(C,l.u_sky_blend)})};class pA{constructor(l,f,v){this.context=l;let S=l.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){let f=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let mA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _v{constructor(l,f,v,S){this.length=f.length,this.attributes=v,this.itemSize=f.bytesPerElement,this.dynamicDraw=S,this.context=l;let I=l.gl;this.buffer=I.createBuffer(),l.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);let f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,f){for(let v=0;v<this.attributes.length;v++){let S=f.attributes[this.attributes[v].name];S!==void 0&&l.enableVertexAttribArray(S)}}setVertexAttribPointers(l,f,v){for(let S=0;S<this.attributes.length;S++){let I=this.attributes[S],D=f.attributes[I.name];D!==void 0&&l.vertexAttribPointer(D,I.components,l[mA[I.type]],!1,this.itemSize,I.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ti{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fo extends Ti{getDefault(){return o.bf.transparent}set(l){let f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class vv extends Ti{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Gx extends Ti{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class F4 extends Ti{getDefault(){return[!0,!0,!0,!0]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class bv extends Ti{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class N4 extends Ti{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class xv extends Ti{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){let f=this.current;(l.func!==f.func||l.ref!==f.ref||l.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class z4 extends Ti{getDefault(){let l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Hx extends Ti{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=l,this.dirty=!1}}class gA extends Ti{getDefault(){return[0,1]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class In extends Ti{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=l,this.dirty=!1}}class Ep extends Ti{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class AA extends Ti{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.BLEND):f.disable(f.BLEND),this.current=l,this.dirty=!1}}class df extends Ti{getDefault(){let l=this.gl;return[l.ONE,l.ZERO]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class fm extends Ti{getDefault(){return o.bf.transparent}set(l){let f=this.current;(l.r!==f.r||l.g!==f.g||l.b!==f.b||l.a!==f.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Cp extends Ti{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class xl extends Ti{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;l?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=l,this.dirty=!1}}class yA extends Ti{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class _A extends Ti{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class wv extends Ti{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class ff extends Ti{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class vA extends Ti{getDefault(){let l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){let f=this.current;(l[0]!==f[0]||l[1]!==f[1]||l[2]!==f[2]||l[3]!==f[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class pm extends Ti{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class mm extends Ti{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Pp extends Ti{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindTexture(f.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class bA extends Ti{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ip extends Ti{getDefault(){return null}set(l){let f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class pf extends Ti{getDefault(){return null}set(l){var f;if(l===this.current&&!this.dirty)return;let v=this.gl;nu(v)?v.bindVertexArray(l):(f=v.getExtension("OES_vertex_array_object"))===null||f===void 0||f.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Sv extends Ti{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class xA extends Ti{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Li extends Ti{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class kp extends Ti{constructor(l,f){super(l),this.context=l,this.parent=f}getDefault(){return null}}class U4 extends kp{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class qx extends kp{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class es extends kp{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,l),this.current=l,this.dirty=!1}}let qh="Framebuffer is not complete";class La{constructor(l,f,v,S,I){this.context=l,this.width=f,this.height=v;let D=l.gl,z=this.framebuffer=D.createFramebuffer();if(this.colorAttachment=new U4(l,z),S)this.depthAttachment=I?new es(l,z):new qx(l,z);else if(I)throw new Error("Stencil cannot be set without depth");if(D.checkFramebufferStatus(D.FRAMEBUFFER)!==D.FRAMEBUFFER_COMPLETE)throw new Error(qh)}destroy(){let l=this.context.gl,f=this.colorAttachment.get();if(f&&l.deleteTexture(f),this.depthAttachment){let v=this.depthAttachment.get();v&&l.deleteRenderbuffer(v)}l.deleteFramebuffer(this.framebuffer)}}class wA{constructor(l){var f,v;if(this.gl=l,this.clearColor=new fo(this),this.clearDepth=new vv(this),this.clearStencil=new Gx(this),this.colorMask=new F4(this),this.depthMask=new bv(this),this.stencilMask=new N4(this),this.stencilFunc=new xv(this),this.stencilOp=new z4(this),this.stencilTest=new Hx(this),this.depthRange=new gA(this),this.depthTest=new In(this),this.depthFunc=new Ep(this),this.blend=new AA(this),this.blendFunc=new df(this),this.blendColor=new fm(this),this.blendEquation=new Cp(this),this.cullFace=new xl(this),this.cullFaceSide=new yA(this),this.frontFace=new _A(this),this.program=new wv(this),this.activeTexture=new ff(this),this.viewport=new vA(this),this.bindFramebuffer=new pm(this),this.bindRenderbuffer=new mm(this),this.bindTexture=new Pp(this),this.bindVertexBuffer=new bA(this),this.bindElementBuffer=new Ip(this),this.bindVertexArray=new pf(this),this.pixelStoreUnpack=new Sv(this),this.pixelStoreUnpackPremultiplyAlpha=new xA(this),this.pixelStoreUnpackFlipY=new Li(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),nu(l)){this.HALF_FLOAT=l.HALF_FLOAT;let S=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(f=l.RGBA16F)!==null&&f!==void 0?f:S?.RGBA16F_EXT,this.RGB16F=(v=l.RGB16F)!==null&&v!==void 0?v:S?.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");let S=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=S?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,f){return new pA(this,l,f)}createVertexBuffer(l,f,v){return new _v(this,l,f,v)}createRenderbuffer(l,f,v){let S=this.gl,I=S.createRenderbuffer();return this.bindRenderbuffer.set(I),S.renderbufferStorage(S.RENDERBUFFER,l,f,v),this.bindRenderbuffer.set(null),I}createFramebuffer(l,f,v,S){return new La(this,l,f,v,S)}clear({color:l,depth:f,stencil:v}){let S=this.gl,I=0;l&&(I|=S.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(I|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),v!==void 0&&(I|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),S.clear(I)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.bH(l.blendFunction,Mn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return nu(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var f;return nu(this.gl)?this.gl.deleteVertexArray(l):(f=this.gl.getExtension("OES_vertex_array_object"))===null||f===void 0?void 0:f.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}let gm;function mf(C,l,f,v,S){let I=C.context,D=C.transform,z=I.gl,V=C.useProgram("collisionBox"),X=[],Q=0,ie=0;for(let Ce=0;Ce<v.length;Ce++){let De=v[Ce],Ve=l.getTile(De).getBucket(f);if(!Ve)continue;let Oe=S?Ve.textCollisionBox:Ve.iconCollisionBox,je=Ve.collisionCircleArray;je.length>0&&(X.push({circleArray:je,circleOffset:ie,coord:De}),Q+=je.length/4,ie=Q),Oe&&V.draw(I,z.LINES,zr.disabled,ki.disabled,C.colorModeForRenderPass(),$i.disabled,hm(C.transform),C.style.map.terrain&&C.style.map.terrain.getTerrainData(De),D.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),f.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,null,C.transform.zoom,null,null,Oe.collisionVertexBuffer)}if(!S||!X.length)return;let re=C.useProgram("collisionCircle"),ae=new o.c0;ae.resize(4*Q),ae._trim();let Ae=0;for(let Ce of X)for(let De=0;De<Ce.circleArray.length/4;De++){let Ve=4*De,Oe=Ce.circleArray[Ve+0],je=Ce.circleArray[Ve+1],He=Ce.circleArray[Ve+2],Be=Ce.circleArray[Ve+3];ae.emplace(Ae++,Oe,je,He,Be,0),ae.emplace(Ae++,Oe,je,He,Be,1),ae.emplace(Ae++,Oe,je,He,Be,2),ae.emplace(Ae++,Oe,je,He,Be,3)}(!gm||gm.length<2*Q)&&(gm=(function(Ce){let De=2*Ce,Ve=new o.c2;Ve.resize(De),Ve._trim();for(let Oe=0;Oe<De;Oe++){let je=6*Oe;Ve.uint16[je+0]=4*Oe+0,Ve.uint16[je+1]=4*Oe+1,Ve.uint16[je+2]=4*Oe+2,Ve.uint16[je+3]=4*Oe+2,Ve.uint16[je+4]=4*Oe+3,Ve.uint16[je+5]=4*Oe+0}return Ve})(Q));let Te=I.createIndexBuffer(gm,!0),Me=I.createVertexBuffer(ae,o.c1.members,!0);for(let Ce of X){let De=Nx(C.transform);re.draw(I,z.TRIANGLES,zr.disabled,ki.disabled,C.colorModeForRenderPass(),$i.disabled,De,C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ce.coord),null,f.id,Me,Te,o.aM.simpleSegment(0,2*Ce.circleOffset,Ce.circleArray.length,Ce.circleArray.length/2),null,C.transform.zoom,null,null,null)}Me.destroy(),Te.destroy()}let SA=o.ai(new Float32Array(16));function TA(C,l,f,v,S,I){let{horizontalAlign:D,verticalAlign:z}=o.aH(C);return new o.P((-(D-.5)*l/S+v[0])*I,(-(z-.5)*f/S+v[1])*I)}function MA(C,l,f,v,S,I){let D=l.tileAnchorPoint.add(new o.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let z=v.mult(I);f||(z=z.rotate(-S));let V=D.add(z);return ka(V.x,V.y,l.pitchedLabelPlaneMatrix,l.getElevation).point}if(f){let z=Kr(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(C),V=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return C.add(v.rotate(V))}return C.add(v)}function EA(C,l,f,v,S,I,D,z,V,X,Q,ie){let re=C.text.placedSymbolArray,ae=C.text.dynamicLayoutVertexArray,Ae=C.icon.dynamicLayoutVertexArray,Te={};ae.clear();for(let Me=0;Me<re.length;Me++){let Ce=re.get(Me),De=Ce.hidden||!Ce.crossTileID||C.allowVerticalPlacement&&!Ce.placedOrientation?null:v[Ce.crossTileID];if(De){let Ve=new o.P(Ce.anchorX,Ce.anchorY),Oe={getElevation:ie,width:S.width,height:S.height,pitchedLabelPlaneMatrix:I,pitchWithMap:f,transform:S,tileAnchorPoint:Ve,translation:X,unwrappedTileID:Q},je=f?yp(Ve.x,Ve.y,Oe):Kr(Ve.x,Ve.y,Oe),He=tf(S.cameraToCenterDistance,je.signedDistanceFromCamera),Be=o.ap(C.textSizeData,z,Ce)*He/o.aB;f&&(Be*=C.tilePixelRatio/D);let{width:et,height:Ke,anchor:ct,textOffset:Ye,textBoxScale:gt}=De,Gt=TA(ct,et,Ke,Ye,gt,Be),Ht=S.getPitchedTextCorrection(Ve.x+X[0],Ve.y+X[1],Q),kt=MA(je.point,Oe,l,Gt,-S.bearingInRadians,Ht),pr=C.allowVerticalPlacement&&Ce.placedOrientation===o.ao.vertical?Math.PI/2:0;for(let Ar=0;Ar<Ce.numGlyphs;Ar++)o.av(ae,kt,pr);V&&Ce.associatedIconIndex>=0&&(Te[Ce.associatedIconIndex]={shiftedAnchor:kt,angle:pr})}else Hu(Ce.numGlyphs,ae)}if(V){Ae.clear();let Me=C.icon.placedSymbolArray;for(let Ce=0;Ce<Me.length;Ce++){let De=Me.get(Ce);if(De.hidden)Hu(De.numGlyphs,Ae);else{let Ve=Te[Ce];if(Ve)for(let Oe=0;Oe<De.numGlyphs;Oe++)o.av(Ae,Ve.shiftedAnchor,Ve.angle);else Hu(De.numGlyphs,Ae)}}C.icon.dynamicLayoutVertexBuffer.updateData(Ae)}C.text.dynamicLayoutVertexBuffer.updateData(ae)}function Am(C,l,f){return f.iconsInText&&l?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function Sc(C,l,f,v,S,I,D,z,V,X,Q,ie,re){let ae=C.context,Ae=ae.gl,Te=C.transform,Me=z==="map",Ce=V==="map",De=z!=="viewport"&&f.layout.get("symbol-placement")!=="point",Ve=Me&&!Ce&&!De,Oe=!f.layout.get("symbol-sort-key").isConstant(),je=!1,He=C.getDepthModeForSublayer(0,zr.ReadOnly),Be=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),et=[],Ke=Te.getCircleRadiusCorrection();for(let ct of v){let Ye=l.getTile(ct),gt=Ye.getBucket(f);if(!gt)continue;let Gt=S?gt.text:gt.icon;if(!Gt||!Gt.segments.get().length||!Gt.hasVisibleVertices)continue;let Ht=Gt.programConfigurations.get(f.id),kt=S||gt.sdfIcons,pr=S?gt.textSizeData:gt.iconSizeData,Ar=Ce||Te.pitch!==0,Wi=C.useProgram(Am(kt,S,gt),Ht),An=o.an(pr,Te.zoom),kn=C.style.map.terrain&&C.style.map.terrain.getTerrainData(ct),St,Dt,ts,eo,$o=[0,0],to=null;if(S)Dt=Ye.glyphAtlasTexture,ts=Ae.LINEAR,St=Ye.glyphAtlasTexture.size,gt.iconsInText&&($o=Ye.imageAtlasTexture.size,to=Ye.imageAtlasTexture,eo=Ar||C.options.rotating||C.options.zooming||pr.kind==="composite"||pr.kind==="camera"?Ae.LINEAR:Ae.NEAREST);else{let K=f.layout.get("icon-size").constantOr(0)!==1||gt.iconsNeedLinear;Dt=Ye.imageAtlasTexture,ts=kt||C.options.rotating||C.options.zooming||K||Ar?Ae.LINEAR:Ae.NEAREST,St=Ye.imageAtlasTexture.size}let Gn=o.aC(Ye,1,C.transform.zoom),ro=Vo(Me,C.transform,Gn),th=o.L();o.aq(th,ro);let Ba=Ot(Ce,Me,C.transform,Gn),g=o.aD(Te,Ye,I,D),y=Te.getProjectionData({overscaledTileID:ct,applyGlobeMatrix:!re,applyTerrainMatrix:!0}),b=Be&&gt.hasTextData(),T=f.layout.get("icon-text-fit")!=="none"&&b&&gt.hasIconData();if(De){let K=C.style.map.terrain?(_e,Ee)=>C.style.map.terrain.getElevation(ct,_e,Ee):null,te=f.layout.get("text-rotation-alignment")==="map";Kt(gt,C,S,ro,th,Ce,X,te,ct.toUnwrapped(),Te.width,Te.height,g,K)}let E=S&&Be||T,O=De||E?SA:Ce?ro:C.transform.clipSpaceToPixelsMatrix,B=kt&&f.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0,N;N=kt?gt.iconsInText?Av(pr.kind,An,Ve,Ce,De,E,C,O,Ba,g,St,$o,Ke):gv(pr.kind,An,Ve,Ce,De,E,C,O,Ba,g,S,St,0,Ke):me(pr.kind,An,Ve,Ce,De,E,C,O,Ba,g,S,St,Ke);let G={program:Wi,buffers:Gt,uniformValues:N,projectionData:y,atlasTexture:Dt,atlasTextureIcon:to,atlasInterpolation:ts,atlasInterpolationIcon:eo,isSDF:kt,hasHalo:B};if(Oe&&gt.canOverlap){je=!0;let K=Gt.segments.get();for(let te of K)et.push({segments:new o.aM([te]),sortKey:te.sortKey,state:G,terrainData:kn})}else et.push({segments:Gt.segments,sortKey:0,state:G,terrainData:kn})}je&&et.sort(((ct,Ye)=>ct.sortKey-Ye.sortKey));for(let ct of et){let Ye=ct.state;if(ae.activeTexture.set(Ae.TEXTURE0),Ye.atlasTexture.bind(Ye.atlasInterpolation,Ae.CLAMP_TO_EDGE),Ye.atlasTextureIcon&&(ae.activeTexture.set(Ae.TEXTURE1),Ye.atlasTextureIcon&&Ye.atlasTextureIcon.bind(Ye.atlasInterpolationIcon,Ae.CLAMP_TO_EDGE)),Ye.isSDF){let gt=Ye.uniformValues;Ye.hasHalo&&(gt.u_is_halo=1,Rp(Ye.buffers,ct.segments,f,C,Ye.program,He,Q,ie,gt,Ye.projectionData,ct.terrainData)),gt.u_is_halo=0}Rp(Ye.buffers,ct.segments,f,C,Ye.program,He,Q,ie,Ye.uniformValues,Ye.projectionData,ct.terrainData)}}function Rp(C,l,f,v,S,I,D,z,V,X,Q){let ie=v.context;S.draw(ie,ie.gl.TRIANGLES,I,D,z,$i.backCCW,V,Q,X,f.id,C.layoutVertexBuffer,C.indexBuffer,l,f.paint,v.transform.zoom,C.programConfigurations.get(f.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function ym(C,l,f,v,S){let I=C.context,D=I.gl,z=ki.disabled,V=new Mn([D.ONE,D.ONE],o.bf.transparent,[!0,!0,!0,!0]),X=l.getBucket(f);if(!X)return;let Q=v.key,ie=f.heatmapFbos.get(Q);ie||(ie=au(I,l.tileSize,l.tileSize),f.heatmapFbos.set(Q,ie)),I.bindFramebuffer.set(ie.framebuffer),I.viewport.set([0,0,l.tileSize,l.tileSize]),I.clear({color:o.bf.transparent});let re=X.programConfigurations.get(f.id),ae=C.useProgram("heatmap",re,!S),Ae=C.transform.getProjectionData({overscaledTileID:l.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Te=C.style.map.terrain.getTerrainData(v);ae.draw(I,D.TRIANGLES,zr.disabled,z,V,$i.disabled,dm(l,C.transform.zoom,f.paint.get("heatmap-intensity"),1),Te,Ae,f.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,f.paint,C.transform.zoom,re)}function Zu(C,l,f,v,S){let I=C.context,D=I.gl,z=C.transform;I.setColorMode(C.colorModeForRenderPass());let V=Ku(I,l),X=f.key,Q=l.heatmapFbos.get(X);if(!Q)return;I.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,Q.colorAttachment.get()),I.activeTexture.set(D.TEXTURE1),V.bind(D.LINEAR,D.CLAMP_TO_EDGE);let ie=z.getProjectionData({overscaledTileID:f,applyTerrainMatrix:S,applyGlobeMatrix:!v});C.useProgram("heatmapTexture").draw(I,D.TRIANGLES,zr.disabled,ki.disabled,C.colorModeForRenderPass(),$i.disabled,Da(C,l,0,1),null,ie,l.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments,l.paint,z.zoom),Q.destroy(),l.heatmapFbos.delete(X)}function au(C,l,f){var v,S;let I=C.gl,D=I.createTexture();I.bindTexture(I.TEXTURE_2D,D),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.LINEAR);let z=(v=C.HALF_FLOAT)!==null&&v!==void 0?v:I.UNSIGNED_BYTE,V=(S=C.RGBA16F)!==null&&S!==void 0?S:I.RGBA;I.texImage2D(I.TEXTURE_2D,0,V,l,f,0,I.RGBA,z,null);let X=C.createFramebuffer(l,f,!1,!1);return X.colorAttachment.set(D),X}function Ku(C,l){return l.colorRampTexture||(l.colorRampTexture=new o.T(C,l.colorRamp,C.gl.RGBA)),l.colorRampTexture}function gf(C,l,f,v,S,I,D,z){let V=256;if(S.stepInterpolant){let X=l.getSource().maxzoom,Q=D.canonical.z===X?Math.ceil(1<<C.transform.maxZoom-D.canonical.z):1;V=o.ae(o.c4(I.maxLineLength/o.$*1024*Q),256,f.maxTextureSize)}return z.gradient=o.c5({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:V,image:z.gradient||void 0,clips:I.lineClipsArray}),z.texture?z.texture.update(z.gradient):z.texture=new o.T(f,z.gradient,v.RGBA),z.version=S.gradientVersion,z.texture}function Yx(C,l,f,v,S){C.activeTexture.set(l.TEXTURE0),f.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(S)}function CA(C,l,f,v,S,I){(S||C.lineAtlas.dirty)&&(l.activeTexture.set(f.TEXTURE0),C.lineAtlas.bind(l)),v.updatePaintBuffers(I)}function PA(C,l,f,v,S,I,D){let z=I.gradients[S.id],V=z.texture;S.gradientVersion!==z.version&&(V=gf(C,l,f,v,S,I,D,z)),f.activeTexture.set(v.TEXTURE0),V.bind(S.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}function Tv(C,l,f,v,S,I,D,z,V){let X=I.gradients[S.id],Q=X.texture;S.gradientVersion!==X.version&&(Q=gf(C,l,f,v,S,I,D,X)),f.activeTexture.set(v.TEXTURE0),Q.bind(S.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE),f.activeTexture.set(v.TEXTURE1),C.lineAtlas.bind(f),z.updatePaintBuffers(V)}function IA(C,l,f,v,S){if(!f||!v||!v.imageAtlas)return;let I=v.imageAtlas.patternPositions,D=I[f.to.toString()],z=I[f.from.toString()];if(!D&&z&&(D=z),!z&&D&&(z=D),!D||!z){let V=S.getPaintProperty(l);D=I[V],z=I[V]}D&&z&&C.setConstantPatternPositions(D,z)}function Mv(C,l,f,v,S,I,D,z){let V=C.context.gl,X="fill-pattern",Q=f.paint.get(X),ie=Q&&Q.constantOr(1),re=f.getCrossfadeParameters(),ae,Ae,Te,Me,Ce,De=C.transform,Ve=f.paint.get("fill-translate"),Oe=f.paint.get("fill-translate-anchor");D?(Ae=ie&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ae=V.LINES):(Ae=ie?"fillPattern":"fill",ae=V.TRIANGLES);let je=Q.constantOr(null);for(let He of v){let Be=l.getTile(He);if(ie&&!Be.patternsLoaded())continue;let et=Be.getBucket(f);if(!et)continue;let Ke=et.programConfigurations.get(f.id),ct=C.useProgram(Ae,Ke),Ye=C.style.map.terrain&&C.style.map.terrain.getTerrainData(He);ie&&(C.context.activeTexture.set(V.TEXTURE0),Be.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ke.updatePaintBuffers(re)),IA(Ke,X,je,Be,f);let gt=De.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),Gt=o.aD(De,Be,Ve,Oe);if(D){Me=et.indexBuffer2,Ce=et.segments2;let kt=[V.drawingBufferWidth,V.drawingBufferHeight];Te=Ae==="fillOutlinePattern"&&ie?en(C,re,Be,kt,Gt):jo(kt,Gt)}else Me=et.indexBuffer,Ce=et.segments,Te=ie?Kn(C,re,Be,Gt):{u_fill_translate:Gt};let Ht=C.stencilModeForClipping(He);ct.draw(C.context,ae,S,Ht,I,$i.backCCW,Te,Ye,gt,f.id,et.layoutVertexBuffer,Me,Ce,f.paint,C.transform.zoom,Ke)}}function Op(C,l,f,v,S,I,D,z){let V=C.context,X=V.gl,Q="fill-extrusion-pattern",ie=f.paint.get(Q),re=ie.constantOr(1),ae=f.getCrossfadeParameters(),Ae=f.paint.get("fill-extrusion-opacity"),Te=ie.constantOr(null),Me=C.transform;for(let Ce of v){let De=l.getTile(Ce),Ve=De.getBucket(f);if(!Ve)continue;let Oe=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ce),je=Ve.programConfigurations.get(f.id),He=C.useProgram(re?"fillExtrusionPattern":"fillExtrusion",je);re&&(C.context.activeTexture.set(X.TEXTURE0),De.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),je.updatePaintBuffers(ae));let Be=Me.getProjectionData({overscaledTileID:Ce,applyGlobeMatrix:!z,applyTerrainMatrix:!0});IA(je,Q,Te,De,f);let et=o.aD(Me,De,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Ke=f.paint.get("fill-extrusion-vertical-gradient"),ct=re?qi(C,Ke,Ae,et,Ce,ae,De):So(C,Ke,Ae,et);He.draw(V,V.gl.TRIANGLES,S,I,D,$i.backCCW,ct,Oe,Be,f.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,f.paint,C.transform.zoom,je,C.style.map.terrain&&Ve.centroidVertexBuffer)}}function _m(C,l,f,v,S,I,D,z,V){var X;let Q=C.style.projection,ie=C.context,re=C.transform,ae=ie.gl,Ae=[`#define NUM_ILLUMINATION_SOURCES ${f.paint.get("hillshade-highlight-color").values.length}`],Te=C.useProgram("hillshade",null,!1,Ae),Me=!C.options.moving;for(let Ce of v){let De=l.getTile(Ce),Ve=De.fbo;if(!Ve)continue;let Oe=Q.getMeshFromTileID(ie,Ce.canonical,z,!0,"raster"),je=(X=C.style.map.terrain)===null||X===void 0?void 0:X.getTerrainData(Ce);ie.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,Ve.colorAttachment.get());let He=re.getProjectionData({overscaledTileID:Ce,aligned:Me,applyGlobeMatrix:!V,applyTerrainMatrix:!0});Te.draw(ie,ae.TRIANGLES,I,S[Ce.overscaledZ],D,$i.backCCW,hf(C,De,f),je,He,f.id,Oe.vertexBuffer,Oe.indexBuffer,Oe.segments)}}function Ev(C,l,f,v,S,I,D,z,V){var X;let Q=C.style.projection,ie=C.context,re=C.transform,ae=ie.gl,Ae=C.useProgram("colorRelief"),Te=!C.options.moving,Me=!0,Ce=0;for(let De of v){let Ve=l.getTile(De),Oe=Ve.dem;if(Me){let ct=ae.getParameter(ae.MAX_TEXTURE_SIZE),{elevationTexture:Ye,colorTexture:gt}=f.getColorRampTextures(ie,ct,Oe.getUnpackVector());ie.activeTexture.set(ae.TEXTURE1),Ye.bind(ae.NEAREST,ae.CLAMP_TO_EDGE),ie.activeTexture.set(ae.TEXTURE4),gt.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),Me=!1,Ce=Ye.size[0]}if(!Oe||!Oe.data)continue;let je=Oe.stride,He=Oe.getPixels();if(ie.activeTexture.set(ae.TEXTURE0),ie.pixelStoreUnpackPremultiplyAlpha.set(!1),Ve.demTexture=Ve.demTexture||C.getTileTexture(je),Ve.demTexture){let ct=Ve.demTexture;ct.update(He,{premultiply:!1}),ct.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)}else Ve.demTexture=new o.T(ie,He,ae.RGBA,{premultiply:!1}),Ve.demTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);let Be=Q.getMeshFromTileID(ie,De.canonical,z,!0,"raster"),et=(X=C.style.map.terrain)===null||X===void 0?void 0:X.getTerrainData(De),Ke=re.getProjectionData({overscaledTileID:De,aligned:Te,applyGlobeMatrix:!V,applyTerrainMatrix:!0});Ae.draw(ie,ae.TRIANGLES,I,S[De.overscaledZ],D,$i.backCCW,Ux(f,Ve.dem,Ce),et,Ke,f.id,Be.vertexBuffer,Be.indexBuffer,Be.segments)}}let kA=[new o.P(0,0),new o.P(o.$,0),new o.P(o.$,o.$),new o.P(0,o.$)];function Qn(C,l,f,v,S,I,D,z,V=!1,X=!1){let Q=v[v.length-1].overscaledZ,ie=C.context,re=ie.gl,ae=C.useProgram("raster"),Ae=C.transform,Te=C.style.projection,Me=C.colorModeForRenderPass(),Ce=!C.options.moving,De=f.paint.get("raster-opacity"),Ve=f.paint.get("raster-resampling"),Oe=f.paint.get("raster-fade-duration"),je=!!C.style.map.terrain;for(let He of v){let Be=C.getDepthModeForSublayer(He.overscaledZ-Q,De===1?zr.ReadWrite:zr.ReadOnly,re.LESS),et=l.getTile(He),Ke=Ve==="nearest"?re.NEAREST:re.LINEAR;ie.activeTexture.set(re.TEXTURE0),et.texture.bind(Ke,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),ie.activeTexture.set(re.TEXTURE1);let{parentTile:ct,parentScaleBy:Ye,parentTopLeft:gt,fadeValues:Gt}=Af(et,l,Oe,je);et.fadeOpacity=Gt.tileOpacity,ct?(ct.fadeOpacity=Gt.parentTileOpacity,ct.texture.bind(Ke,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST)):et.texture.bind(Ke,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),et.texture.useMipmap&&ie.extTextureFilterAnisotropic&&C.transform.pitch>20&&re.texParameterf(re.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax);let Ht=C.style.map.terrain&&C.style.map.terrain.getTerrainData(He),kt=Ae.getProjectionData({overscaledTileID:He,aligned:Ce,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),pr=B4(gt,Ye,Gt.fadeMix,f,z),Ar=Te.getMeshFromTileID(ie,He.canonical,I,D,"raster");ae.draw(ie,re.TRIANGLES,Be,S?S[He.overscaledZ]:ki.disabled,Me,V?$i.frontCCW:$i.backCCW,pr,Ht,kt,f.id,Ar.vertexBuffer,Ar.indexBuffer,Ar.segments)}}function Af(C,l,f,v){let S={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(f===0||v)return S;if(C.fadingParentID){let I=l._getLoadedTile(C.fadingParentID);if(!I)return S;let D=Math.pow(2,I.tileID.overscaledZ-C.tileID.overscaledZ),z=[C.tileID.canonical.x*D%1,C.tileID.canonical.y*D%1],V=(function(X,Q,ie){let re=M(),ae=(re-Q.timeAdded)/ie,Ae=X.fadingDirection===he.Incoming,Te=o.ae((re-X.timeAdded)/ie,0,1),Me=o.ae(1-ae,0,1),Ce=Ae?Te:Me;return{tileOpacity:Ce,parentTileOpacity:Ae?Me:Te,fadeMix:{opacity:1,mix:1-Ce}}})(C,I,f);return{parentTile:I,parentScaleBy:D,parentTopLeft:z,fadeValues:V}}if(C.selfFading){let I=(function(D,z){let V=(M()-D.timeAdded)/z,X=o.ae(V,0,1);return{tileOpacity:X,fadeMix:{opacity:X,mix:0}}})(C,f);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:I}}return S}let Xl=new o.bf(1,0,0,1),Dp=new o.bf(0,1,0,1),RA=new o.bf(0,0,1,1),Xx=new o.bf(1,0,1,1),Lp=new o.bf(0,1,1,1);function Yh(C,l,f,v){Xh(C,0,l+f/2,C.transform.width,f,v)}function Bp(C,l,f,v){Xh(C,l-f/2,0,f,C.transform.height,v)}function Xh(C,l,f,v,S,I){let D=C.context,z=D.gl;z.enable(z.SCISSOR_TEST),z.scissor(l*C.pixelRatio,f*C.pixelRatio,v*C.pixelRatio,S*C.pixelRatio),D.clear({color:I}),z.disable(z.SCISSOR_TEST)}function Cv(C,l,f){let v=C.context,S=v.gl,I=C.useProgram("debug"),D=zr.disabled,z=ki.disabled,V=C.colorModeForRenderPass(),X="$debug",Q=C.style.map.terrain&&C.style.map.terrain.getTerrainData(f);v.activeTexture.set(S.TEXTURE0);let ie=l.getTileByID(f.key).latestRawTileData,re=Math.floor((ie&&ie.byteLength||0)/1024),ae=l.getTile(f).tileSize,Ae=512/Math.min(ae,512)*(f.overscaledZ/C.transform.zoom)*.5,Te=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Te+=` => ${f.overscaledZ}`),(function(Ce,De){Ce.initDebugOverlayCanvas();let Ve=Ce.debugOverlayCanvas,Oe=Ce.context.gl,je=Ce.debugOverlayCanvas.getContext("2d");je.clearRect(0,0,Ve.width,Ve.height),je.shadowColor="white",je.shadowBlur=2,je.lineWidth=1.5,je.strokeStyle="white",je.textBaseline="top",je.font="bold 36px Open Sans, sans-serif",je.fillText(De,5,5),je.strokeText(De,5,5),Ce.debugOverlayTexture.update(Ve),Ce.debugOverlayTexture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE)})(C,`${Te} ${re}kB`);let Me=C.transform.getProjectionData({overscaledTileID:f,applyGlobeMatrix:!0,applyTerrainMatrix:!0});I.draw(v,S.TRIANGLES,D,z,Mn.alphaBlended,$i.disabled,zx(o.bf.transparent,Ae),null,Me,X,C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments),I.draw(v,S.LINE_STRIP,D,z,V,$i.disabled,zx(o.bf.red),Q,Me,X,C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments)}function Zh(C,l,f,v){let{isRenderingGlobe:S}=v,I=C.context,D=I.gl,z=C.transform,V=C.colorModeForRenderPass(),X=C.getDepthModeFor3D(),Q=C.useProgram("terrain");I.bindFramebuffer.set(null),I.viewport.set([0,0,C.width,C.height]);for(let ie of f){let re=l.getTerrainMesh(ie.tileID),ae=C.renderToTexture.getTexture(ie),Ae=l.getTerrainData(ie.tileID);I.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,ae.texture);let Te=l.getMeshFrameDelta(z.zoom),Me=z.calculateFogMatrix(ie.tileID.toUnwrapped()),Ce=wn(Te,Me,C.style.sky,z.pitch,S),De=z.getProjectionData({overscaledTileID:ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(I,D.TRIANGLES,X,ki.disabled,V,$i.backCCW,Ce,Ae,De,"terrain",re.vertexBuffer,re.indexBuffer,re.segments)}}function Pv(C,l){if(!l.mesh){let f=new o.aL;f.emplaceBack(-1,-1),f.emplaceBack(1,-1),f.emplaceBack(1,1),f.emplaceBack(-1,1);let v=new o.aN;v.emplaceBack(0,1,2),v.emplaceBack(0,2,3),l.mesh=new bc(C.createVertexBuffer(f,ci.members),C.createIndexBuffer(v),o.aM.simpleSegment(0,0,f.length,v.length))}return l.mesh}class OA{constructor(l,f){this.context=new wA(l),this.transform=f,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ai(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=rn.maxUnderzooming+rn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new af}resize(l,f,v){if(this.width=Math.floor(l*v),this.height=Math.floor(f*v),this.pixelRatio=v,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let S of this.style._order)this.style._layers[S].resize()}setup(){let l=this.context,f=new o.aL;f.emplaceBack(0,0),f.emplaceBack(o.$,0),f.emplaceBack(0,o.$),f.emplaceBack(o.$,o.$),this.tileExtentBuffer=l.createVertexBuffer(f,ci.members),this.tileExtentSegments=o.aM.simpleSegment(0,0,4,2);let v=new o.aL;v.emplaceBack(0,0),v.emplaceBack(o.$,0),v.emplaceBack(0,o.$),v.emplaceBack(o.$,o.$),this.debugBuffer=l.createVertexBuffer(v,ci.members),this.debugSegments=o.aM.simpleSegment(0,0,4,5);let S=new o.c7;S.emplaceBack(0,0,0,0),S.emplaceBack(o.$,0,o.$,0),S.emplaceBack(0,o.$,0,o.$),S.emplaceBack(o.$,o.$,o.$,o.$),this.rasterBoundsBuffer=l.createVertexBuffer(S,zt.members),this.rasterBoundsSegments=o.aM.simpleSegment(0,0,4,2);let I=new o.aL;I.emplaceBack(0,0),I.emplaceBack(o.$,0),I.emplaceBack(0,o.$),I.emplaceBack(o.$,o.$),this.rasterBoundsBufferPosOnly=l.createVertexBuffer(I,ci.members),this.rasterBoundsSegmentsPosOnly=o.aM.simpleSegment(0,0,4,5);let D=new o.aL;D.emplaceBack(0,0),D.emplaceBack(1,0),D.emplaceBack(0,1),D.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(D,ci.members),this.viewportSegments=o.aM.simpleSegment(0,0,4,2);let z=new o.c8;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(z);let V=new o.aN;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(V);let X=this.context.gl;this.stencilClearMode=new ki({func:X.ALWAYS,mask:0},0,255,X.ZERO,X.ZERO,X.ZERO),this.tileExtentMesh=new bc(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let l=this.context,f=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let v=o.L();o.bZ(v,0,this.width,this.height,0,0,1),o.N(v,v,[f.drawingBufferWidth,f.drawingBufferHeight,0]);let S={mainMatrix:v,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:v};this.useProgram("clippingMask",null,!0).draw(l,f.TRIANGLES,zr.disabled,this.stencilClearMode,Mn.disabled,$i.disabled,null,null,S,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,f,v){if(this.currentStencilSource===l.source||!l.isTileClipped()||!f||!f.length)return;this.currentStencilSource=l.source,this.nextStencilID+f.length>256&&this.clearStencil();let S=this.context;S.setColorMode(Mn.disabled),S.setDepthMode(zr.disabled);let I={};for(let D of f)I[D.key]=this.nextStencilID++;this._renderTileMasks(I,f,v,!0),this._renderTileMasks(I,f,v,!1),this._tileClippingMaskIDs=I}_renderTileMasks(l,f,v,S){let I=this.context,D=I.gl,z=this.style.projection,V=this.transform,X=this.useProgram("clippingMask");for(let Q of f){let ie=l[Q.key],re=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Q),ae=z.getMeshFromTileID(this.context,Q.canonical,S,!0,"stencil"),Ae=V.getProjectionData({overscaledTileID:Q,applyGlobeMatrix:!v,applyTerrainMatrix:!0});X.draw(I,D.TRIANGLES,zr.disabled,new ki({func:D.ALWAYS,mask:0},ie,255,D.KEEP,D.KEEP,D.REPLACE),Mn.disabled,v?$i.disabled:$i.backCCW,null,re,Ae,"$clipping",ae.vertexBuffer,ae.indexBuffer,ae.segments)}}_renderTilesDepthBuffer(){let l=this.context,f=l.gl,v=this.style.projection,S=this.transform,I=this.useProgram("depth"),D=this.getDepthModeFor3D(),z=wr(S,{tileSize:S.tileSize});for(let V of z){let X=this.style.map.terrain&&this.style.map.terrain.getTerrainData(V),Q=v.getMeshFromTileID(this.context,V.canonical,!0,!0,"raster"),ie=S.getProjectionData({overscaledTileID:V,applyGlobeMatrix:!0,applyTerrainMatrix:!0});I.draw(l,f.TRIANGLES,D,ki.disabled,Mn.disabled,$i.backCCW,null,X,ie,"$clipping",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let l=this.nextStencilID++,f=this.context.gl;return new ki({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(l){let f=this.context.gl;return new ki({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(l){let f=this.context.gl,v=l.sort(((D,z)=>z.overscaledZ-D.overscaledZ)),S=v[v.length-1].overscaledZ,I=v[0].overscaledZ-S+1;if(I>1){this.currentStencilSource=void 0,this.nextStencilID+I>256&&this.clearStencil();let D={};for(let z=0;z<I;z++)D[z+S]=new ki({func:f.GEQUAL,mask:255},z+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=I,[D,v]}return[{[S]:ki.disabled},v]}stencilConfigForOverlapTwoPass(l){let f=this.context.gl,v=l.sort(((D,z)=>z.overscaledZ-D.overscaledZ)),S=v[v.length-1].overscaledZ,I=v[0].overscaledZ-S+1;if(this.clearStencil(),I>1){let D={},z={};for(let V=0;V<I;V++)D[V+S]=new ki({func:f.GREATER,mask:255},I+1+V,255,f.KEEP,f.KEEP,f.REPLACE),z[V+S]=new ki({func:f.GREATER,mask:255},1+V,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID=2*I+1,[D,z,v]}return this.nextStencilID=3,[{[S]:new ki({func:f.GREATER,mask:255},2,255,f.KEEP,f.KEEP,f.REPLACE)},{[S]:new ki({func:f.GREATER,mask:255},1,255,f.KEEP,f.KEEP,f.REPLACE)},v]}colorModeForRenderPass(){let l=this.context.gl;return this._showOverdrawInspector?new Mn([l.CONSTANT_COLOR,l.ONE],new o.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mn.unblended:Mn.alphaBlended}getDepthModeForSublayer(l,f,v){if(!this.opaquePassEnabledForLayer())return zr.disabled;let S=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new zr(v||this.context.gl.LEQUAL,f,[S,S])}getDepthModeFor3D(){return new zr(this.context.gl.LEQUAL,zr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,f){var v,S;this.style=l,this.options=f,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(M()),this.imageManager.beginFrame();let I=this.style._order,D=this.style.sourceCaches,z={},V={},X={},Q={isRenderingToTexture:!1,isRenderingGlobe:((v=l.projection)===null||v===void 0?void 0:v.transitionState)>0};for(let re in D){let ae=D[re];ae.used&&ae.prepare(this.context),z[re]=ae.getVisibleCoordinates(!1),V[re]=z[re].slice().reverse(),X[re]=ae.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let re=0;re<I.length;re++)if(this.style._layers[I[re]].is3D()){this.opaquePassCutoff=re;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let re of I){let ae=this.style._layers[re];if(!ae.hasOffscreenPass()||ae.isHidden(this.transform.zoom))continue;let Ae=V[ae.source];(ae.type==="custom"||Ae.length)&&this.renderLayer(this,D[ae.source],ae,Ae,Q)}if((S=this.style.projection)===null||S===void 0||S.updateGPUdependent({context:this.context,useProgram:re=>this.useProgram(re)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?o.bf.black:o.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(re,ae){let Ae=re.context,Te=Ae.gl,Me=((He,Be,et)=>{let Ke=Math.cos(Be.rollInRadians),ct=Math.sin(Be.rollInRadians),Ye=it(Be),gt=Be.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:He.properties.get("sky-color"),u_horizon_color:He.properties.get("horizon-color"),u_horizon:[(Be.width/2-Ye*ct)*et,(Be.height/2+Ye*Ke)*et],u_horizon_normal:[-ct,Ke],u_sky_horizon_blend:He.properties.get("sky-horizon-blend")*Be.height/2*et,u_sky_blend:gt}})(ae,re.style.map.transform,re.pixelRatio),Ce=new zr(Te.LEQUAL,zr.ReadWrite,[0,1]),De=ki.disabled,Ve=re.colorModeForRenderPass(),Oe=re.useProgram("sky"),je=Pv(Ae,ae);Oe.draw(Ae,Te.TRIANGLES,Ce,De,Ve,$i.disabled,Me,null,void 0,"sky",je.vertexBuffer,je.indexBuffer,je.segments)})(this,this.style.sky),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){let re=this.style._layers[I[this.currentLayer]],ae=D[re.source],Ae=z[re.source];this._renderTileClippingMasks(re,Ae,!1),this.renderLayer(this,ae,re,Ae,Q)}this.renderPass="translucent";let ie=!1;for(this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){let re=this.style._layers[I[this.currentLayer]],ae=D[re.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(re,Q))continue;this.opaquePassEnabledForLayer()||ie||(ie=!0,Q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let Ae=(re.type==="symbol"?X:V)[re.source];this._renderTileClippingMasks(re,z[re.source],!!this.renderToTexture),this.renderLayer(this,ae,re,Ae,Q)}if(Q.isRenderingGlobe&&(function(re,ae,Ae){let Te=re.context,Me=Te.gl,Ce=re.useProgram("atmosphere"),De=new zr(Me.LEQUAL,zr.ReadOnly,[0,1]),Ve=re.transform,Oe=(function(gt,Gt){let Ht=gt.properties.get("position"),kt=[-Ht.x,-Ht.y,-Ht.z],pr=o.ai(new Float64Array(16));return gt.properties.get("anchor")==="map"&&(o.b6(pr,pr,Gt.rollInRadians),o.b7(pr,pr,-Gt.pitchInRadians),o.b6(pr,pr,Gt.bearingInRadians),o.b7(pr,pr,Gt.center.lat*Math.PI/180),o.bz(pr,pr,-Gt.center.lng*Math.PI/180)),o.c6(kt,kt,pr),kt})(Ae,re.transform),je=Ve.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),He=ae.properties.get("atmosphere-blend")*je.projectionTransition;if(He===0)return;let Be=Wn(Ve.worldSize,Ve.center.lat),et=Ve.inverseProjectionMatrix,Ke=new Float64Array(4);Ke[3]=1,o.aw(Ke,Ke,Ve.modelViewProjectionMatrix),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1,o.aw(Ke,Ke,et),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1;let ct=((gt,Gt,Ht,kt,pr)=>({u_sun_pos:gt,u_atmosphere_blend:Gt,u_globe_position:Ht,u_globe_radius:kt,u_inv_proj_matrix:pr}))(Oe,He,[Ke[0],Ke[1],Ke[2]],Be,et),Ye=Pv(Te,ae);Ce.draw(Te,Me.TRIANGLES,De,ki.disabled,Mn.alphaBlended,$i.disabled,ct,null,null,"atmosphere",Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let re=(function(ae,Ae){let Te=null,Me=Object.values(ae._layers).flatMap((Oe=>Oe.source&&!Oe.isHidden(Ae)?[ae.sourceCaches[Oe.source]]:[])),Ce=Me.filter((Oe=>Oe.getSource().type==="vector")),De=Me.filter((Oe=>Oe.getSource().type!=="vector")),Ve=Oe=>{(!Te||Te.getSource().maxzoom<Oe.getSource().maxzoom)&&(Te=Oe)};return Ce.forEach((Oe=>Ve(Oe))),Te||De.forEach((Oe=>Ve(Oe))),Te})(this.style,this.transform.zoom);re&&(function(ae,Ae,Te){for(let Me=0;Me<Te.length;Me++)Cv(ae,Ae,Te[Me])})(this,re,re.getVisibleCoordinates())}this.options.showPadding&&(function(re){let ae=re.transform.padding;Yh(re,re.transform.height-(ae.top||0),3,Xl),Yh(re,ae.bottom||0,3,Dp),Bp(re,ae.left||0,3,RA),Bp(re,re.transform.width-(ae.right||0),3,Xx);let Ae=re.transform.centerPoint;(function(Te,Me,Ce,De){Xh(Te,Me-1,Ce-10,2,20,De),Xh(Te,Me-10,Ce-1,20,2,De)})(re,Ae.x,re.transform.height-Ae.y,Lp)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;let f=this.terrainFacilitator.matrix,v=this.transform.modelViewProjectionMatrix,S=this.terrainFacilitator.dirty;S||(S=l?!o.c9(f,v):!o.ca(f,v)),S||(S=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),S&&(o.cb(f,v),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(I,D){let z=I.context,V=z.gl,X=I.transform,Q=Mn.unblended,ie=new zr(V.LEQUAL,zr.ReadWrite,[0,1]),re=D.sourceCache.getRenderableTiles(),ae=I.useProgram("terrainDepth");z.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,I.width/devicePixelRatio,I.height/devicePixelRatio]),z.clear({color:o.bf.transparent,depth:1});for(let Ae of re){let Te=D.getTerrainMesh(Ae.tileID),Me=D.getTerrainData(Ae.tileID),Ce=X.getProjectionData({overscaledTileID:Ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),De={u_ele_delta:D.getMeshFrameDelta(X.zoom)};ae.draw(z,V.TRIANGLES,ie,ki.disabled,Q,$i.backCCW,De,Me,Ce,"terrain",Te.vertexBuffer,Te.indexBuffer,Te.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,I.width,I.height])})(this,this.style.map.terrain),(function(I,D){let z=I.context,V=z.gl,X=I.transform,Q=Mn.unblended,ie=new zr(V.LEQUAL,zr.ReadWrite,[0,1]),re=D.getCoordsTexture(),ae=D.sourceCache.getRenderableTiles(),Ae=I.useProgram("terrainCoords");z.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,I.width/devicePixelRatio,I.height/devicePixelRatio]),z.clear({color:o.bf.transparent,depth:1}),D.coordsIndex=[];for(let Te of ae){let Me=D.getTerrainMesh(Te.tileID),Ce=D.getTerrainData(Te.tileID);z.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,re.texture);let De={u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0,u_ele_delta:D.getMeshFrameDelta(X.zoom)},Ve=X.getProjectionData({overscaledTileID:Te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ae.draw(z,V.TRIANGLES,ie,ki.disabled,Q,$i.backCCW,De,Ce,Ve,"terrain",Me.vertexBuffer,Me.indexBuffer,Me.segments),D.coordsIndex.push(Te.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,I.width,I.height])})(this,this.style.map.terrain))}renderLayer(l,f,v,S,I){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="custom"||(S||[]).length)&&(this.id=v.id,o.cc(v)?(function(D,z,V,X,Q,ie){if(D.renderPass!=="translucent")return;let{isRenderingToTexture:re}=ie,ae=ki.disabled,Ae=D.colorModeForRenderPass();(V._unevaluatedLayout.hasValue("text-variable-anchor")||V._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(Te,Me,Ce,De,Ve,Oe,je,He,Be){let et=Me.transform,Ke=Me.style.map.terrain,ct=Ve==="map",Ye=Oe==="map";for(let gt of Te){let Gt=De.getTile(gt),Ht=Gt.getBucket(Ce);if(!Ht||!Ht.text||!Ht.text.segments.get().length)continue;let kt=o.an(Ht.textSizeData,et.zoom),pr=o.aC(Gt,1,Me.transform.zoom),Ar=Vo(ct,Me.transform,pr),Wi=Ce.layout.get("icon-text-fit")!=="none"&&Ht.hasIconData();if(kt){let An=Math.pow(2,et.zoom-Gt.tileID.overscaledZ),kn=Ke?(St,Dt)=>Ke.getElevation(gt,St,Dt):null;EA(Ht,ct,Ye,Be,et,Ar,An,kt,Wi,o.aD(et,Gt,je,He),gt.toUnwrapped(),kn)}}})(X,D,V,z,V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),Q),V.paint.get("icon-opacity").constantOr(1)!==0&&Sc(D,z,V,X,!1,V.paint.get("icon-translate"),V.paint.get("icon-translate-anchor"),V.layout.get("icon-rotation-alignment"),V.layout.get("icon-pitch-alignment"),V.layout.get("icon-keep-upright"),ae,Ae,re),V.paint.get("text-opacity").constantOr(1)!==0&&Sc(D,z,V,X,!0,V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),V.layout.get("text-keep-upright"),ae,Ae,re),z.map.showCollisionBoxes&&(mf(D,z,V,X,!0),mf(D,z,V,X,!1))})(l,f,v,S,this.style.placement.variableOffsets,I):o.cd(v)?(function(D,z,V,X,Q){if(D.renderPass!=="translucent")return;let{isRenderingToTexture:ie}=Q,re=V.paint.get("circle-opacity"),ae=V.paint.get("circle-stroke-width"),Ae=V.paint.get("circle-stroke-opacity"),Te=!V.layout.get("circle-sort-key").isConstant();if(re.constantOr(1)===0&&(ae.constantOr(1)===0||Ae.constantOr(1)===0))return;let Me=D.context,Ce=Me.gl,De=D.transform,Ve=D.getDepthModeForSublayer(0,zr.ReadOnly),Oe=ki.disabled,je=D.colorModeForRenderPass(),He=[],Be=De.getCircleRadiusCorrection();for(let et=0;et<X.length;et++){let Ke=X[et],ct=z.getTile(Ke),Ye=ct.getBucket(V);if(!Ye)continue;let gt=V.paint.get("circle-translate"),Gt=V.paint.get("circle-translate-anchor"),Ht=o.aD(De,ct,gt,Gt),kt=Ye.programConfigurations.get(V.id),pr=D.useProgram("circle",kt),Ar=Ye.layoutVertexBuffer,Wi=Ye.indexBuffer,An=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Ke),kn={programConfiguration:kt,program:pr,layoutVertexBuffer:Ar,indexBuffer:Wi,uniformValues:Yi(D,ct,V,Ht,Be),terrainData:An,projectionData:De.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!ie,applyTerrainMatrix:!0})};if(Te){let St=Ye.segments.get();for(let Dt of St)He.push({segments:new o.aM([Dt]),sortKey:Dt.sortKey,state:kn})}else He.push({segments:Ye.segments,sortKey:0,state:kn})}Te&&He.sort(((et,Ke)=>et.sortKey-Ke.sortKey));for(let et of He){let{programConfiguration:Ke,program:ct,layoutVertexBuffer:Ye,indexBuffer:gt,uniformValues:Gt,terrainData:Ht,projectionData:kt}=et.state;ct.draw(Me,Ce.TRIANGLES,Ve,Oe,je,$i.backCCW,Gt,Ht,kt,V.id,Ye,gt,et.segments,V.paint,D.transform.zoom,Ke)}})(l,f,v,S,I):o.ce(v)?(function(D,z,V,X,Q){if(V.paint.get("heatmap-opacity")===0)return;let ie=D.context,{isRenderingToTexture:re,isRenderingGlobe:ae}=Q;if(D.style.map.terrain){for(let Ae of X){let Te=z.getTile(Ae);z.hasRenderableParent(Ae)||(D.renderPass==="offscreen"?ym(D,Te,V,Ae,ae):D.renderPass==="translucent"&&Zu(D,V,Ae,re,ae))}ie.viewport.set([0,0,D.width,D.height])}else D.renderPass==="offscreen"?(function(Ae,Te,Me,Ce){let De=Ae.context,Ve=De.gl,Oe=Ae.transform,je=ki.disabled,He=new Mn([Ve.ONE,Ve.ONE],o.bf.transparent,[!0,!0,!0,!0]);(function(Be,et,Ke){let ct=Be.gl;Be.activeTexture.set(ct.TEXTURE1),Be.viewport.set([0,0,et.width/4,et.height/4]);let Ye=Ke.heatmapFbos.get(o.c3);Ye?(ct.bindTexture(ct.TEXTURE_2D,Ye.colorAttachment.get()),Be.bindFramebuffer.set(Ye.framebuffer)):(Ye=au(Be,et.width/4,et.height/4),Ke.heatmapFbos.set(o.c3,Ye))})(De,Ae,Me),De.clear({color:o.bf.transparent});for(let Be=0;Be<Ce.length;Be++){let et=Ce[Be];if(Te.hasRenderableParent(et))continue;let Ke=Te.getTile(et),ct=Ke.getBucket(Me);if(!ct)continue;let Ye=ct.programConfigurations.get(Me.id),gt=Ae.useProgram("heatmap",Ye),Gt=Oe.getProjectionData({overscaledTileID:et,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ht=Oe.getCircleRadiusCorrection();gt.draw(De,Ve.TRIANGLES,zr.disabled,je,He,$i.backCCW,dm(Ke,Oe.zoom,Me.paint.get("heatmap-intensity"),Ht),null,Gt,Me.id,ct.layoutVertexBuffer,ct.indexBuffer,ct.segments,Me.paint,Oe.zoom,Ye)}De.viewport.set([0,0,Ae.width,Ae.height])})(D,z,V,X):D.renderPass==="translucent"&&(function(Ae,Te){let Me=Ae.context,Ce=Me.gl;Me.setColorMode(Ae.colorModeForRenderPass());let De=Te.heatmapFbos.get(o.c3);De&&(Me.activeTexture.set(Ce.TEXTURE0),Ce.bindTexture(Ce.TEXTURE_2D,De.colorAttachment.get()),Me.activeTexture.set(Ce.TEXTURE1),Ku(Me,Te).bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Ae.useProgram("heatmapTexture").draw(Me,Ce.TRIANGLES,zr.disabled,ki.disabled,Ae.colorModeForRenderPass(),$i.disabled,Da(Ae,Te,0,1),null,null,Te.id,Ae.viewportBuffer,Ae.quadTriangleIndexBuffer,Ae.viewportSegments,Te.paint,Ae.transform.zoom))})(D,V)})(l,f,v,S,I):o.cf(v)?(function(D,z,V,X,Q){if(D.renderPass!=="translucent")return;let{isRenderingToTexture:ie}=Q,re=V.paint.get("line-opacity"),ae=V.paint.get("line-width");if(re.constantOr(1)===0||ae.constantOr(1)===0)return;let Ae=D.getDepthModeForSublayer(0,zr.ReadOnly),Te=D.colorModeForRenderPass(),Me=V.paint.get("line-dasharray"),Ce=Me.constantOr(1),De=V.paint.get("line-pattern"),Ve=De.constantOr(1),Oe=V.paint.get("line-gradient"),je=V.getCrossfadeParameters(),He;He=Ve?"linePattern":Ce&&Oe?"lineGradientSDF":Ce?"lineSDF":Oe?"lineGradient":"line";let Be=D.context,et=Be.gl,Ke=D.transform,ct=!0;for(let Ye of X){let gt=z.getTile(Ye);if(Ve&&!gt.patternsLoaded())continue;let Gt=gt.getBucket(V);if(!Gt)continue;let Ht=Gt.programConfigurations.get(V.id),kt=D.context.program.get(),pr=D.useProgram(He,Ht),Ar=ct||pr.program!==kt,Wi=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Ye),An=De.constantOr(null),kn=Me&&Me.constantOr(null);if(An&&gt.imageAtlas){let $o=gt.imageAtlas,to=$o.patternPositions[An.to.toString()],Gn=$o.patternPositions[An.from.toString()];to&&Gn&&Ht.setConstantPatternPositions(to,Gn)}else if(kn){let $o=V.layout.get("line-cap")==="round",to=D.lineAtlas.getDash(kn.to,$o),Gn=D.lineAtlas.getDash(kn.from,$o);Ht.setConstantDashPositions(to,Gn)}let St=Ke.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!ie,applyTerrainMatrix:!0}),Dt=Ke.getPixelScale(),ts;Ve?(ts=be(D,gt,V,Dt,je),Yx(Be,et,gt,Ht,je)):Ce&&Oe?(ts=Vx(D,gt,V,Dt,je,Gt.lineClipsArray.length),Tv(D,z,Be,et,V,Gt,Ye,Ht,je)):Ce?(ts=Ur(D,gt,V,Dt,je),CA(D,Be,et,Ht,Ar,je)):Oe?(ts=si(D,gt,V,Dt,Gt.lineClipsArray.length),PA(D,z,Be,et,V,Gt,Ye)):ts=Es(D,gt,V,Dt);let eo=D.stencilModeForClipping(Ye);pr.draw(Be,et.TRIANGLES,Ae,eo,Te,$i.disabled,ts,Wi,St,V.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,V.paint,D.transform.zoom,Ht,Gt.layoutVertexBuffer2),ct=!1}})(l,f,v,S,I):o.cg(v)?(function(D,z,V,X,Q){let ie=V.paint.get("fill-color"),re=V.paint.get("fill-opacity");if(re.constantOr(1)===0)return;let{isRenderingToTexture:ae}=Q,Ae=D.colorModeForRenderPass(),Te=V.paint.get("fill-pattern"),Me=D.opaquePassEnabledForLayer()&&!Te.constantOr(1)&&ie.constantOr(o.bf.transparent).a===1&&re.constantOr(0)===1?"opaque":"translucent";if(D.renderPass===Me){let Ce=D.getDepthModeForSublayer(1,D.renderPass==="opaque"?zr.ReadWrite:zr.ReadOnly);Mv(D,z,V,X,Ce,Ae,!1,ae)}if(D.renderPass==="translucent"&&V.paint.get("fill-antialias")){let Ce=D.getDepthModeForSublayer(V.getPaintProperty("fill-outline-color")?2:0,zr.ReadOnly);Mv(D,z,V,X,Ce,Ae,!0,ae)}})(l,f,v,S,I):o.ch(v)?(function(D,z,V,X,Q){let ie=V.paint.get("fill-extrusion-opacity");if(ie===0)return;let{isRenderingToTexture:re}=Q;if(D.renderPass==="translucent"){let ae=new zr(D.context.gl.LEQUAL,zr.ReadWrite,D.depthRangeFor3D);if(ie!==1||V.paint.get("fill-extrusion-pattern").constantOr(1))Op(D,z,V,X,ae,ki.disabled,Mn.disabled,re),Op(D,z,V,X,ae,D.stencilModeFor3D(),D.colorModeForRenderPass(),re);else{let Ae=D.colorModeForRenderPass();Op(D,z,V,X,ae,ki.disabled,Ae,re)}}})(l,f,v,S,I):o.ci(v)?(function(D,z,V,X,Q){if(D.renderPass!=="offscreen"&&D.renderPass!=="translucent")return;let{isRenderingToTexture:ie}=Q,re=D.context,ae=D.style.projection.useSubdivision,Ae=D.getDepthModeForSublayer(0,zr.ReadOnly),Te=D.colorModeForRenderPass();if(D.renderPass==="offscreen")(function(Me,Ce,De,Ve,Oe,je,He){let Be=Me.context,et=Be.gl;for(let Ke of De){let ct=Ce.getTile(Ke),Ye=ct.dem;if(!Ye||!Ye.data||!ct.needsHillshadePrepare)continue;let gt=Ye.dim,Gt=Ye.stride,Ht=Ye.getPixels();if(Be.activeTexture.set(et.TEXTURE1),Be.pixelStoreUnpackPremultiplyAlpha.set(!1),ct.demTexture=ct.demTexture||Me.getTileTexture(Gt),ct.demTexture){let pr=ct.demTexture;pr.update(Ht,{premultiply:!1}),pr.bind(et.NEAREST,et.CLAMP_TO_EDGE)}else ct.demTexture=new o.T(Be,Ht,et.RGBA,{premultiply:!1}),ct.demTexture.bind(et.NEAREST,et.CLAMP_TO_EDGE);Be.activeTexture.set(et.TEXTURE0);let kt=ct.fbo;if(!kt){let pr=new o.T(Be,{width:gt,height:gt,data:null},et.RGBA);pr.bind(et.LINEAR,et.CLAMP_TO_EDGE),kt=ct.fbo=Be.createFramebuffer(gt,gt,!0,!1),kt.colorAttachment.set(pr.texture)}Be.bindFramebuffer.set(kt.framebuffer),Be.viewport.set([0,0,gt,gt]),Me.useProgram("hillshadePrepare").draw(Be,et.TRIANGLES,Oe,je,He,$i.disabled,wc(ct.tileID,Ye),null,null,Ve.id,Me.rasterBoundsBuffer,Me.quadTriangleIndexBuffer,Me.rasterBoundsSegments),ct.needsHillshadePrepare=!1}})(D,z,X,V,Ae,ki.disabled,Te),re.viewport.set([0,0,D.width,D.height]);else if(D.renderPass==="translucent")if(ae){let[Me,Ce,De]=D.stencilConfigForOverlapTwoPass(X);_m(D,z,V,De,Me,Ae,Te,!1,ie),_m(D,z,V,De,Ce,Ae,Te,!0,ie)}else{let[Me,Ce]=D.getStencilConfigForOverlapAndUpdateStencilID(X);_m(D,z,V,Ce,Me,Ae,Te,!1,ie)}})(l,f,v,S,I):o.cj(v)?(function(D,z,V,X,Q){if(D.renderPass!=="translucent"||!X.length)return;let{isRenderingToTexture:ie}=Q,re=D.style.projection.useSubdivision,ae=D.getDepthModeForSublayer(0,zr.ReadOnly),Ae=D.colorModeForRenderPass();if(re){let[Te,Me,Ce]=D.stencilConfigForOverlapTwoPass(X);Ev(D,z,V,Ce,Te,ae,Ae,!1,ie),Ev(D,z,V,Ce,Me,ae,Ae,!0,ie)}else{let[Te,Me]=D.getStencilConfigForOverlapAndUpdateStencilID(X);Ev(D,z,V,Me,Te,ae,Ae,!1,ie)}})(l,f,v,S,I):o.bK(v)?(function(D,z,V,X,Q){if(D.renderPass!=="translucent"||V.paint.get("raster-opacity")===0||!X.length)return;let{isRenderingToTexture:ie}=Q,re=z.getSource(),ae=D.style.projection.useSubdivision;if(re instanceof Gl)Qn(D,z,V,X,null,!1,!1,re.tileCoords,re.flippedWindingOrder,ie);else if(ae){let[Ae,Te,Me]=D.stencilConfigForOverlapTwoPass(X);Qn(D,z,V,Me,Ae,!1,!0,kA,!1,ie),Qn(D,z,V,Me,Te,!0,!0,kA,!1,ie)}else{let[Ae,Te]=D.getStencilConfigForOverlapAndUpdateStencilID(X);Qn(D,z,V,Te,Ae,!1,!0,kA,!1,ie)}})(l,f,v,S,I):o.ck(v)?(function(D,z,V,X,Q){let ie=V.paint.get("background-color"),re=V.paint.get("background-opacity");if(re===0)return;let{isRenderingToTexture:ae}=Q,Ae=D.context,Te=Ae.gl,Me=D.style.projection,Ce=D.transform,De=Ce.tileSize,Ve=V.paint.get("background-pattern");if(D.isPatternMissing(Ve))return;let Oe=!Ve&&ie.a===1&&re===1&&D.opaquePassEnabledForLayer()?"opaque":"translucent";if(D.renderPass!==Oe)return;let je=ki.disabled,He=D.getDepthModeForSublayer(0,Oe==="opaque"?zr.ReadWrite:zr.ReadOnly),Be=D.colorModeForRenderPass(),et=D.useProgram(Ve?"backgroundPattern":"background"),Ke=X||wr(Ce,{tileSize:De,terrain:D.style.map.terrain});Ve&&(Ae.activeTexture.set(Te.TEXTURE0),D.imageManager.bind(D.context));let ct=V.getCrossfadeParameters();for(let Ye of Ke){let gt=Ce.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!ae,applyTerrainMatrix:!0}),Gt=Ve?fA(re,D,Ve,{tileID:Ye,tileSize:De},ct):Wx(re,ie),Ht=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Ye),kt=Me.getMeshFromTileID(Ae,Ye.canonical,!1,!0,"raster");et.draw(Ae,Te.TRIANGLES,He,je,Be,$i.backCCW,Gt,Ht,gt,V.id,kt.vertexBuffer,kt.indexBuffer,kt.segments)}})(l,0,v,S,I):o.cl(v)&&(function(D,z,V,X){let{isRenderingGlobe:Q}=X,ie=D.context,re=V.implementation,ae=D.style.projection,Ae=D.transform,Te=Ae.getProjectionDataForCustomLayer(Q),Me={farZ:Ae.farZ,nearZ:Ae.nearZ,fov:Ae.fov*Math.PI/180,modelViewProjectionMatrix:Ae.modelViewProjectionMatrix,projectionMatrix:Ae.projectionMatrix,shaderData:{variantName:ae.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ae.shaderPreludeCode.vertexSource}`,define:ae.shaderDefine},defaultProjectionData:Te},Ce=re.renderingMode?re.renderingMode:"2d";if(D.renderPass==="offscreen"){let De=re.prerender;De&&(D.setCustomLayerDefaults(),ie.setColorMode(D.colorModeForRenderPass()),De.call(re,ie.gl,Me),ie.setDirty(),D.setBaseState())}else if(D.renderPass==="translucent"){D.setCustomLayerDefaults(),ie.setColorMode(D.colorModeForRenderPass()),ie.setStencilMode(ki.disabled);let De=Ce==="3d"?D.getDepthModeFor3D():D.getDepthModeForSublayer(0,zr.ReadOnly);ie.setDepthMode(De),re.render(ie.gl,Me),ie.setDirty(),D.setBaseState(),ie.bindFramebuffer.set(null)}})(l,0,v,I))}saveTileTexture(l){let f=this._tileTextures[l.size[0]];f?f.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){let f=this._tileTextures[l];return f&&f.length>0?f.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;let f=this.imageManager.getPattern(l.from.toString()),v=this.imageManager.getPattern(l.to.toString());return!f||!v}useProgram(l,f,v=!1,S=[]){this.cache=this.cache||{};let I=!!this.style.map.terrain,D=this.style.projection,z=v?iu.projectionMercator:D.shaderPreludeCode,V=v?cA:D.shaderDefine,X=l+(f?f.cacheKey:"")+`/${v?Fx:D.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(I?"/terrain":"")+(S?`/${S.join("/")}`:"");return this.cache[X]||(this.cache[X]=new Ms(this.context,iu[l],f,yv[l],this._showOverdrawInspector,I,z,V,S)),this.cache[X]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:l,drawingBufferHeight:f}=this.context.gl;return this.width!==l||this.height!==f}}function DA(C,l){let f,v=!1,S=null,I=null,D=()=>{S=null,v&&(C.apply(I,f),S=setTimeout(D,l),v=!1)};return(...z)=>(v=!0,I=this,f=z,S||D(),S)}class Kh{constructor(l){this._getCurrentHash=()=>{let f=window.location.hash.replace("#","");if(this._hashName){let v;return f.split("&").map((S=>S.split("="))).forEach((S=>{S[0]===this._hashName&&(v=S)})),(v&&v[1]||"").split("/")}return f.split("/")},this._onHashChange=()=>{let f=this._getCurrentHash();if(!this._isValidHash(f))return!1;let v=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(f[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:v,pitch:+(f[4]||0)}),!0},this._updateHashUnthrottled=()=>{let f=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,f)},this._removeHash=()=>{let f=this._getCurrentHash();if(f.length===0)return;let v=f.join("/"),S=v;S.split("&").length>0&&(S=S.split("&")[0]),this._hashName&&(S=`${this._hashName}=${v}`);let I=window.location.hash.replace(S,"");I.startsWith("#&")?I=I.slice(0,1)+I.slice(2):I==="#"&&(I="");let D=window.location.href.replace(/(#.+)?$/,I);D=D.replace("&&","&"),window.history.replaceState(window.history.state,null,D)},this._updateHash=DA(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){let f=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,S=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,S),D=Math.round(f.lng*I)/I,z=Math.round(f.lat*I)/I,V=this._map.getBearing(),X=this._map.getPitch(),Q="";if(Q+=l?`/${D}/${z}/${v}`:`${v}/${z}/${D}`,(V||X)&&(Q+="/"+Math.round(10*V)/10),X&&(Q+=`/${Math.round(X)}`),this._hashName){let ie=this._hashName,re=!1,ae=window.location.hash.slice(1).split("&").map((Ae=>{let Te=Ae.split("=")[0];return Te===ie?(re=!0,`${Te}=${Q}`):Ae})).filter((Ae=>Ae));return re||ae.push(`${ie}=${Q}`),`#${ae.join("&")}`}return`#${Q}`}_isValidHash(l){if(l.length<3||l.some(isNaN))return!1;try{new o.S(+l[2],+l[1])}catch{return!1}let f=+l[0],v=+(l[3]||0),S=+(l[4]||0);return f>=this._map.getMinZoom()&&f<=this._map.getMaxZoom()&&v>=-180&&v<=180&&S>=this._map.getMinPitch()&&S<=this._map.getMaxPitch()}}let yf={linearity:.3,easing:o.cm(0,0,.3,1)},LA=o.e({deceleration:2500,maxSpeed:1400},yf),BA=o.e({deceleration:20,maxSpeed:1400},yf),FA=o.e({deceleration:1e3,maxSpeed:360},yf),Fp=o.e({deceleration:1e3,maxSpeed:90},yf),En=o.e({deceleration:1e3,maxSpeed:360},yf);class Zx{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:M(),settings:l})}_drainInertiaBuffer(){let l=this._inertiaBuffer,f=M();for(;l.length>0&&f-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let f={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:I}of this._inertiaBuffer)f.zoom+=I.zoomDelta||0,f.bearing+=I.bearingDelta||0,f.pitch+=I.pitchDelta||0,f.roll+=I.rollDelta||0,I.panDelta&&f.pan._add(I.panDelta),I.around&&(f.around=I.around),I.pinchAround&&(f.pinchAround=I.pinchAround);let v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(f.pan.mag()){let I=Qu(f.pan.mag(),v,o.e({},LA,l||{})),D=f.pan.mult(I.amount/f.pan.mag()),z=this._map.cameraHelper.handlePanInertia(D,this._map.transform);S.center=z.easingCenter,S.offset=z.easingOffset,_f(S,I)}if(f.zoom){let I=Qu(f.zoom,v,BA);S.zoom=this._map.transform.zoom+I.amount,_f(S,I)}if(f.bearing){let I=Qu(f.bearing,v,FA);S.bearing=this._map.transform.bearing+o.ae(I.amount,-179,179),_f(S,I)}if(f.pitch){let I=Qu(f.pitch,v,Fp);S.pitch=this._map.transform.pitch+I.amount,_f(S,I)}if(f.roll){let I=Qu(f.roll,v,En);S.roll=this._map.transform.roll+o.ae(I.amount,-179,179),_f(S,I)}if(S.zoom||S.bearing){let I=f.pinchAround===void 0?f.around:f.pinchAround;S.around=I?this._map.unproject(I):this._map.getCenter()}return this.clear(),o.e(S,{noMoveStart:!0})}}function _f(C,l){(!C.duration||C.duration<l.duration)&&(C.duration=l.duration,C.easing=l.easing)}function Qu(C,l,f){let{maxSpeed:v,linearity:S,deceleration:I}=f,D=o.ae(C*S/(l/1e3),-v,v),z=Math.abs(D)/(I*S);return{easing:f.easing,duration:1e3*z,amount:D*(z/2)}}class tl extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,v,S={}){v=v instanceof MouseEvent?v:new MouseEvent(l,v);let I=k.mousePos(f.getCanvas(),v),D=f.unproject(I);super(l,o.e({point:I,lngLat:D,originalEvent:v},S)),this._defaultPrevented=!1,this.target=f}}class ua extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,v){let S=l==="touchend"?v.changedTouches:v.touches,I=k.touchPos(f.getCanvasContainer(),S),D=I.map((V=>f.unproject(V))),z=I.reduce(((V,X,Q,ie)=>V.add(X.div(ie.length))),new o.P(0,0));super(l,{points:I,point:z,lngLats:D,lngLat:f.unproject(z),originalEvent:v}),this._defaultPrevented=!1}}class Zl extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,f,v){super(l,{originalEvent:v}),this._defaultPrevented=!1}}class Kx{constructor(l,f){this._map=l,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new Zl(l.type,this._map,l))}mousedown(l,f){return this._mousedownPos=f,this._firePreventable(new tl(l.type,this._map,l))}mouseup(l){this._map.fire(new tl(l.type,this._map,l))}click(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new tl(l.type,this._map,l))}dblclick(l){return this._firePreventable(new tl(l.type,this._map,l))}mouseover(l){this._map.fire(new tl(l.type,this._map,l))}mouseout(l){this._map.fire(new tl(l.type,this._map,l))}touchstart(l){return this._firePreventable(new ua(l.type,this._map,l))}touchmove(l){this._map.fire(new ua(l.type,this._map,l))}touchend(l){this._map.fire(new ua(l.type,this._map,l))}touchcancel(l){this._map.fire(new ua(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class po{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new tl(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new tl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new tl(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kl{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.screenPointToLocation(o.P.convert(l),this._map.terrain)}}class Qh{constructor(l,f){this._map=l,this._tr=new Kl(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,f){this.isEnabled()&&l.shiftKey&&l.button===0&&(k.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(l,f){if(!this._active)return;let v=f;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;let S=this._startPos;this._lastPos=v,this._box||(this._box=k.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));let I=Math.min(S.x,v.x),D=Math.max(S.x,v.x),z=Math.min(S.y,v.y),V=Math.max(S.y,v.y);k.setTransform(this._box,`translate(${I}px,${z}px)`),this._box.style.width=D-I+"px",this._box.style.height=V-z+"px"}mouseupWindow(l,f){if(!this._active||l.button!==0)return;let v=this._startPos,S=f;if(this.reset(),k.suppressClick(),v.x!==S.x||v.y!==S.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:l})),{cameraAnimation:I=>I.fitScreenCoordinates(v,S,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,f){return this._map.fire(new o.l(l,{originalEvent:f}))}}function Iv(C,l){if(C.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${C.length}, points ${l.length}`);let f={};for(let v=0;v<C.length;v++)f[C[v].identifier]=l[v];return f}class kv{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,f,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),v.length===this.numTouches&&(this.centroid=(function(S){let I=new o.P(0,0);for(let D of S)I._add(D);return I.div(S.length)})(f),this.touches=Iv(v,f)))}touchmove(l,f,v){if(this.aborted||!this.centroid)return;let S=Iv(v,f);for(let I in this.touches){let D=S[I];(!D||D.dist(this.touches[I])>30)&&(this.aborted=!0)}}touchend(l,f,v){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){let S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Rv{constructor(l){this.singleTap=new kv(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,f,v){this.singleTap.touchstart(l,f,v)}touchmove(l,f,v){this.singleTap.touchmove(l,f,v)}touchend(l,f,v){let S=this.singleTap.touchend(l,f,v);if(S){let I=l.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(S)<30;if(I&&D||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class wl{constructor(l){this._tr=new Kl(l),this._zoomIn=new Rv({numTouches:1,numTaps:2}),this._zoomOut=new Rv({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,f,v){this._zoomIn.touchstart(l,f,v),this._zoomOut.touchstart(l,f,v)}touchmove(l,f,v){this._zoomIn.touchmove(l,f,v),this._zoomOut.touchmove(l,f,v)}touchend(l,f,v){let S=this._zoomIn.touchend(l,f,v),I=this._zoomOut.touchend(l,f,v),D=this._tr;return S?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:D.zoom+1,around:D.unproject(S)},{originalEvent:l})}):I?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:D.zoom-1,around:D.unproject(I)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tc{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){let f=this._moveFunction(...l);if(f.bearingDelta||f.pitchDelta||f.rollDelta||f.around||f.panDelta)return this._active=!0,f}dragStart(l,f){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=Array.isArray(f)?f[0]:f,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,f){if(!this.isEnabled())return;let v=this._lastPoint;if(!v)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);let S=Array.isArray(f)?f[0]:f;return!this._moved&&S.dist(v)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=S,this._move(v,S))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&k.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let Mc=0,ar=2,Jh={[Mc]:1,[ar]:2};class Ql{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){let f=k.mouseButton(l);this._eventButton=f}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!(function(f,v){let S=Jh[v];return f.buttons===void 0||(f.buttons&S)!==S})(l,this._eventButton)}isValidEndEvent(l){return k.mouseButton(l)===this._eventButton}}class Qx{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}class Np{constructor(l=new Ql({checkCorrectEvent:()=>!0}),f=new Qx){this.mouseMoveStateManager=l,this.oneFingerTouchMoveStateManager=f}_executeRelevantHandler(l,f,v){return l instanceof MouseEvent?f(l):typeof TouchEvent<"u"&&l instanceof TouchEvent?v(l):void 0}startMove(l){this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.startMove(f)),(f=>this.oneFingerTouchMoveStateManager.startMove(f)))}endMove(l){this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.endMove(f)),(f=>this.oneFingerTouchMoveStateManager.endMove(f)))}isValidStartEvent(l){return this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.isValidStartEvent(f)),(f=>this.oneFingerTouchMoveStateManager.isValidStartEvent(f)))}isValidMoveEvent(l){return this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.isValidMoveEvent(f)),(f=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(f)))}isValidEndEvent(l){return this._executeRelevantHandler(l,(f=>this.mouseMoveStateManager.isValidEndEvent(f)),(f=>this.oneFingerTouchMoveStateManager.isValidEndEvent(f)))}}let ed=C=>{C.mousedown=C.dragStart,C.mousemoveWindow=C.dragMove,C.mouseup=C.dragEnd,C.contextmenu=l=>{l.preventDefault()}};class vm{constructor(l,f){this._clickTolerance=l.clickTolerance||1,this._map=f,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,f,v){return this._calculateTransform(l,f,v)}touchmove(l,f,v){if(this._active){if(!this._shouldBePrevented(v.length))return l.preventDefault(),this._calculateTransform(l,f,v);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,f,v){this._calculateTransform(l,f,v),this._active&&this._shouldBePrevented(v.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,f,v){v.length>0&&(this._active=!0);let S=Iv(v,f),I=new o.P(0,0),D=new o.P(0,0),z=0;for(let X in S){let Q=S[X],ie=this._touches[X];ie&&(I._add(Q),D._add(Q.sub(ie)),z++,S[X]=Q)}if(this._touches=S,this._shouldBePrevented(z)||!D.mag())return;let V=D.div(z);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:I.div(z),panDelta:V}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ri{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,f,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([f[0],f[1]]))}touchmove(l,f,v){if(!this._firstTwoTouches)return;l.preventDefault();let[S,I]=this._firstTwoTouches,D=zp(v,f,S),z=zp(v,f,I);if(!D||!z)return;let V=this._aroundCenter?null:D.add(z).div(2);return this._move([D,z],V,l)}touchend(l,f,v){if(!this._firstTwoTouches)return;let[S,I]=this._firstTwoTouches,D=zp(v,f,S),z=zp(v,f,I);D&&z||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function zp(C,l,f){for(let v=0;v<C.length;v++)if(C[v].identifier===f)return l[v]}function NA(C,l){return Math.log(C/l)/Math.LN2}class bm extends Ri{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,f){let v=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(NA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:NA(this._distance,v),pinchAround:f}}}function zA(C,l){return 180*C.angleWith(l)/Math.PI}class Up extends Ri{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,f,v){let S=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zA(this._vector,S),pinchAround:f}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());let f=25/(Math.PI*this._minDiameter)*360,v=zA(l,this._startVector);return Math.abs(v)<f}}function Ju(C){return Math.abs(C.y)>Math.abs(C.x)}class ha extends Ri{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,f,v){super.touchstart(l,f,v),this._currentTouchCount=v.length}_start(l){this._lastPoints=l,Ju(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,f,v){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let S=l[0].sub(this._lastPoints[0]),I=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(S,I,v.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(S.y+I.y)/2*-.5}):void 0}gestureBeginsVertically(l,f,v){if(this._valid!==void 0)return this._valid;let S=l.mag()>=2,I=f.mag()>=2;if(!S&&!I)return;if(!S||!I)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;let D=l.y>0==f.y>0;return Ju(l)&&Ju(f)&&D}}let Jx={panStep:100,bearingStep:15,pitchStep:10};class Vp{constructor(l){this._tr=new Kl(l);let f=Jx;this._panStep=f.panStep,this._bearingStep=f.bearingStep,this._pitchStep=f.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let f=0,v=0,S=0,I=0,D=0;switch(l.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:l.shiftKey?v=-1:(l.preventDefault(),I=-1);break;case 39:l.shiftKey?v=1:(l.preventDefault(),I=1);break;case 38:l.shiftKey?S=1:(l.preventDefault(),D=-1);break;case 40:l.shiftKey?S=-1:(l.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(v=0,S=0),{cameraAnimation:z=>{let V=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:ew,zoom:f?Math.round(V.zoom)+f*(l.shiftKey?2:1):V.zoom,bearing:V.bearing+v*this._bearingStep,pitch:V.pitch+S*this._pitchStep,offset:[-I*this._panStep,-D*this._panStep],center:V.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ew(C){return C*(2-C)}let tw=4.000244140625,V4=1/450;class lu{constructor(l,f){this._onTimeout=v=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(v)},this._map=l,this._tr=new Kl(l),this._triggerRenderFrame=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=V4}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let f=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,v=M(),S=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,f!==0&&f%tw==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(S*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let f=k.mousePos(this._map.getCanvas(),l),v=this._tr;this._aroundPoint=this._aroundCenter?v.transform.locationToScreenPoint(o.S.convert(v.center)):f,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let l=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){let z=l.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=z),typeof this._targetZoom=="number"&&(this._targetZoom+=z)}if(this._delta!==0){let z=this._type==="wheel"&&Math.abs(this._delta)>tw?this._wheelZoomRate:this._defaultZoomRate,V=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&V!==0&&(V=1/V);let X=typeof this._targetZoom!="number"?l.scale:o.ah(this._targetZoom);this._targetZoom=l.constrain(l.getCameraLngLat(),o.ak(X*V)).zoom,this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let f=typeof this._targetZoom!="number"?l.zoom:this._targetZoom,v=this._startZoom,S=this._easing,I,D=!1;if(this._type==="wheel"&&v&&S){let z=M()-this._lastWheelEventTime,V=Math.min((z+5)/200,1),X=S(V);I=o.C.number(v,f,X),V<1?this._frameId||(this._frameId=!0):D=!0}else I=f,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=I,{noInertia:!0,needsRenderFrame:!D,zoomDelta:I-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let f=o.co;if(this._prevEase){let v=this._prevEase,S=(M()-v.start)/v.duration,I=v.easing(S+.01)-v.easing(S),D=.27/Math.sqrt(I*I+1e-4)*.01,z=Math.sqrt(.0729-D*D);f=o.cm(D,z,.25,1)}return this._prevEase={start:M(),duration:l,easing:f},f}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Cn{constructor(l,f){this._clickZoom=l,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class j4{constructor(l){this._tr=new Kl(l),this.reset()}reset(){this._active=!1}dblclick(l,f){return l.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(f)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class UA{constructor(){this._tap=new Rv({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,f,v){if(!this._swipePoint)if(this._tapTime){let S=f[0],I=l.timeStamp-this._tapTime<500,D=this._tapPoint.dist(S)<30;I&&D?v.length>0&&(this._swipePoint=S,this._swipeTouch=v[0].identifier):this.reset()}else this._tap.touchstart(l,f,v)}touchmove(l,f,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;let S=f[0],I=S.y-this._swipePoint.y;return this._swipePoint=S,l.preventDefault(),this._active=!0,{zoomDelta:I/128}}}else this._tap.touchmove(l,f,v)}touchend(l,f,v){if(this._tapTime)this._swipePoint&&v.length===0&&this.reset();else{let S=this._tap.touchend(l,f,v);S&&(this._tapTime=l.timeStamp,this._tapPoint=S)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vf{constructor(l,f,v){this._el=l,this._mousePan=f,this._touchPan=v}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class VA{constructor(l,f,v,S){this._pitchWithRotate=l.pitchWithRotate,this._rollEnabled=l.rollEnabled,this._mouseRotate=f,this._mousePitch=v,this._mouseRoll=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class xm{constructor(l,f,v,S){this._el=l,this._touchZoom=f,this._touchRotate=v,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ov{constructor(l,f){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=f,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=k.create("div","maplibregl-cooperative-gesture-screen",l);let f=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(f=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let v=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),S=document.createElement("div");S.className="maplibregl-desktop-message",S.textContent=f,this._container.appendChild(S);let I=document.createElement("div");I.className="maplibregl-mobile-message",I.textContent=v,this._container.appendChild(I),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(k.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,f){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:l,originalEvent:f})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}let jA=C=>C.zoom||C.drag||C.roll||C.pitch||C.rotate;class cu extends o.l{}function jp(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta||C.rollDelta}class _r{constructor(l,f){this.handleWindowEvent=S=>{this.handleEvent(S,`${S.type}Window`)},this.handleEvent=(S,I)=>{if(S.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let D=S.type==="renderFrame"?void 0:S,z={needsRenderFrame:!1},V={},X={};for(let{handlerName:re,handler:ae,allowed:Ae}of this._handlers){if(!ae.isEnabled())continue;let Te;if(this._blockedByActive(X,Ae,re))ae.reset();else if(ae[I||S.type]){if(o.cp(S,I||S.type)){let Me=k.mousePos(this._map.getCanvas(),S);Te=ae[I||S.type](S,Me)}else if(o.cq(S,I||S.type)){let Me=this._getMapTouches(S.touches),Ce=k.touchPos(this._map.getCanvas(),Me);Te=ae[I||S.type](S,Ce,Me)}else o.cr(I||S.type)||(Te=ae[I||S.type](S));this.mergeHandlerResult(z,V,Te,re,D),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()}(Te||ae.isActive())&&(X[re]=ae)}let Q={};for(let re in this._previousActiveHandlers)X[re]||(Q[re]=D);this._previousActiveHandlers=X,(Object.keys(Q).length||jp(z))&&(this._changes.push([z,V,Q]),this._triggerRenderFrame()),(Object.keys(X).length||jp(z))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:ie}=z;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zx(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f);let v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(let[S,I,D]of this._listeners)k.addEventListener(S,I,S===document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(let[l,f,v]of this._listeners)k.removeEventListener(l,f,l===document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(l){let f=this._map,v=f.getCanvasContainer();this._add("mapEvent",new Kx(f,l));let S=f.boxZoom=new Qh(f,l);this._add("boxZoom",S),l.interactive&&l.boxZoom&&S.enable();let I=f.cooperativeGestures=new Ov(f,l.cooperativeGestures);this._add("cooperativeGestures",I),l.cooperativeGestures&&I.enable();let D=new wl(f),z=new j4(f);f.doubleClickZoom=new Cn(z,D),this._add("tapZoom",D),this._add("clickZoom",z),l.interactive&&l.doubleClickZoom&&f.doubleClickZoom.enable();let V=new UA;this._add("tapDragZoom",V);let X=f.touchPitch=new ha(f);this._add("touchPitch",X),l.interactive&&l.touchPitch&&f.touchPitch.enable(l.touchPitch);let Q=()=>f.project(f.getCenter()),ie=(function({enable:Oe,clickTolerance:je,aroundCenter:He=!0,minPixelCenterThreshold:Be=100,rotateDegreesPerPixelMoved:et=.8},Ke){let ct=new Ql({checkCorrectEvent:Ye=>k.mouseButton(Ye)===0&&Ye.ctrlKey||k.mouseButton(Ye)===2&&!Ye.ctrlKey});return new Tc({clickTolerance:je,move:(Ye,gt)=>{let Gt=Ke();if(He&&Math.abs(Gt.y-Ye.y)>Be)return{bearingDelta:o.cn(new o.P(Ye.x,gt.y),gt,Gt)};let Ht=(gt.x-Ye.x)*et;return He&&gt.y<Gt.y&&(Ht=-Ht),{bearingDelta:Ht}},moveStateManager:ct,enable:Oe,assignEvents:ed})})(l,Q),re=(function({enable:Oe,clickTolerance:je,pitchDegreesPerPixelMoved:He=-.5}){let Be=new Ql({checkCorrectEvent:et=>k.mouseButton(et)===0&&et.ctrlKey||k.mouseButton(et)===2});return new Tc({clickTolerance:je,move:(et,Ke)=>({pitchDelta:(Ke.y-et.y)*He}),moveStateManager:Be,enable:Oe,assignEvents:ed})})(l),ae=(function({enable:Oe,clickTolerance:je,rollDegreesPerPixelMoved:He=.3},Be){let et=new Ql({checkCorrectEvent:Ke=>k.mouseButton(Ke)===2&&Ke.ctrlKey});return new Tc({clickTolerance:je,move:(Ke,ct)=>{let Ye=Be(),gt=(ct.x-Ke.x)*He;return ct.y<Ye.y&&(gt=-gt),{rollDelta:gt}},moveStateManager:et,enable:Oe,assignEvents:ed})})(l,Q);f.dragRotate=new VA(l,ie,re,ae),this._add("mouseRotate",ie,["mousePitch"]),this._add("mousePitch",re,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ae,["mousePitch"]),l.interactive&&l.dragRotate&&f.dragRotate.enable();let Ae=(function({enable:Oe,clickTolerance:je}){let He=new Ql({checkCorrectEvent:Be=>k.mouseButton(Be)===0&&!Be.ctrlKey});return new Tc({clickTolerance:je,move:(Be,et)=>({around:et,panDelta:et.sub(Be)}),activateOnStart:!0,moveStateManager:He,enable:Oe,assignEvents:ed})})(l),Te=new vm(l,f);f.dragPan=new vf(v,Ae,Te),this._add("mousePan",Ae),this._add("touchPan",Te,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&f.dragPan.enable(l.dragPan);let Me=new Up,Ce=new bm;f.touchZoomRotate=new xm(v,Ce,Me,V),this._add("touchRotate",Me,["touchPan","touchZoom"]),this._add("touchZoom",Ce,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&f.touchZoomRotate.enable(l.touchZoomRotate),this._add("blockableMapEvent",new po(f));let De=f.scrollZoom=new lu(f,(()=>this._triggerRenderFrame()));this._add("scrollZoom",De,["mousePan"]),l.interactive&&l.scrollZoom&&f.scrollZoom.enable(l.scrollZoom);let Ve=f.keyboard=new Vp(f);this._add("keyboard",Ve),l.interactive&&l.keyboard&&f.keyboard.enable()}_add(l,f,v){this._handlers.push({handlerName:l,handler:f,allowed:v}),this._handlersById[l]=f}stop(l){if(!this._updatingCamera){for(let{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(let{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!jA(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,f,v){for(let S in l)if(S!==v&&(!f||f.indexOf(S)<0))return!0;return!1}_getMapTouches(l){let f=[];for(let v of l)this._el.contains(v.target)&&f.push(v);return f}mergeHandlerResult(l,f,v,S,I){if(!v)return;o.e(l,v);let D={handlerName:S,originalEvent:v.originalEvent||I};v.zoomDelta!==void 0&&(f.zoom=D),v.panDelta!==void 0&&(f.drag=D),v.rollDelta!==void 0&&(f.roll=D),v.pitchDelta!==void 0&&(f.pitch=D),v.bearingDelta!==void 0&&(f.rotate=D)}_applyChanges(){let l={},f={},v={};for(let[S,I,D]of this._changes)S.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(S.panDelta)),S.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+S.pitchDelta),S.rollDelta&&(l.rollDelta=(l.rollDelta||0)+S.rollDelta),S.around!==void 0&&(l.around=S.around),S.pinchAround!==void 0&&(l.pinchAround=S.pinchAround),S.noInertia&&(l.noInertia=S.noInertia),o.e(f,I),o.e(v,D);this._updateMapTransform(l,f,v),this._changes=[]}_updateMapTransform(l,f,v){let S=this._map,I=S._getTransformForUpdate(),D=S.terrain;if(!(jp(l)||D&&this._terrainMovement))return this._fireEvents(f,v,!0);S._stop(!0);let{panDelta:z,zoomDelta:V,bearingDelta:X,pitchDelta:Q,rollDelta:ie,around:re,pinchAround:ae}=l;ae!==void 0&&(re=ae),re=re||S.transform.centerPoint,D&&!I.isPointOnMapSurface(re)&&(re=I.centerPoint);let Ae={panDelta:z,zoomDelta:V,rollDelta:ie,pitchDelta:Q,bearingDelta:X,around:re};this._map.cameraHelper.useGlobeControls&&!I.isPointOnMapSurface(re)&&(re=I.centerPoint);let Te=re.distSqr(I.centerPoint)<.01?I.center:I.screenPointToLocation(z?re.sub(z):re);this._handleMapControls({terrain:D,tr:I,deltasForHelper:Ae,preZoomAroundLoc:Te,combinedEventsInProgress:f,panDelta:z}),S._applyUpdatedTransform(I),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,v,!0)}_handleMapControls({terrain:l,tr:f,deltasForHelper:v,preZoomAroundLoc:S,combinedEventsInProgress:I,panDelta:D}){let z=this._map.cameraHelper;if(z.handleMapControlsRollPitchBearingZoom(v,f),l)return z.useGlobeControls?(this._terrainMovement||!I.drag&&!I.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void z.handleMapControlsPan(v,f,S)):this._terrainMovement||!I.drag&&!I.zoom?void(I.drag&&this._terrainMovement&&D?f.setCenter(f.screenPointToLocation(f.centerPoint.sub(D))):z.handleMapControlsPan(v,f,S)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void z.handleMapControlsPan(v,f,S));z.handleMapControlsPan(v,f,S)}_fireEvents(l,f,v){let S=jA(this._eventsInProgress),I=jA(l),D={};for(let ie in l){let{originalEvent:re}=l[ie];this._eventsInProgress[ie]||(D[`${ie}start`]=re),this._eventsInProgress[ie]=l[ie]}!S&&I&&this._fireEvent("movestart",I.originalEvent);for(let ie in D)this._fireEvent(ie,D[ie]);I&&this._fireEvent("move",I.originalEvent);for(let ie in l){let{originalEvent:re}=l[ie];this._fireEvent(ie,re)}let z={},V;for(let ie in this._eventsInProgress){let{handlerName:re,originalEvent:ae}=this._eventsInProgress[ie];this._handlersById[re].isActive()||(delete this._eventsInProgress[ie],V=f[re]||ae,z[`${ie}end`]=V)}for(let ie in z)this._fireEvent(ie,z[ie]);let X=jA(this._eventsInProgress),Q=(S||I)&&!X;if(Q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let ie=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&ie.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(ie)}if(v&&Q){this._updatingCamera=!0;let ie=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=ae=>ae!==0&&-this._bearingSnap<ae&&ae<this._bearingSnap;!ie||!ie.essential&&m.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:V})),re(this._map.getBearing())&&this._map.resetNorth()):(re(ie.bearing||this._map.getBearing())&&(ie.bearing=0),ie.freezeElevation=!0,this._map.easeTo(ie,{originalEvent:V})),this._updatingCamera=!1}}_fireEvent(l,f){this._map.fire(new o.l(l,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((l=>{delete this._frameId,this.handleEvent(new cu("renderFrame",{timeStamp:l})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Lr extends o.E{constructor(l,f,v){super(),this._renderFrameCallback=()=>{let S=Math.min((M()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(S)),S<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=v.bearingSnap,this.cameraHelper=f,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(l,f){l.apply(this.transform),this.transform=l,this.cameraHelper=f}getCenter(){return new o.S(this.transform.center.lng,this.transform.center.lat)}setCenter(l,f){return this.jumpTo({center:l},f)}getCenterElevation(){return this.transform.elevation}setCenterElevation(l,f){return this.jumpTo({elevation:l},f),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(l){this._centerClampedToGround=l}panBy(l,f,v){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},f),v)}panTo(l,f,v){return this.easeTo(o.e({center:l},f),v)}getZoom(){return this.transform.zoom}setZoom(l,f){return this.jumpTo({zoom:l},f),this}zoomTo(l,f,v){return this.easeTo(o.e({zoom:l},f),v)}zoomIn(l,f){return this.zoomTo(this.getZoom()+1,l,f),this}zoomOut(l,f){return this.zoomTo(this.getZoom()-1,l,f),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(l,f){return l!=this.transform.fov&&(this.transform.setFov(l),this.fire(new o.l("movestart",f)).fire(new o.l("move",f)).fire(new o.l("moveend",f))),this}getBearing(){return this.transform.bearing}setBearing(l,f){return this.jumpTo({bearing:l},f),this}getPadding(){return this.transform.padding}setPadding(l,f){return this.jumpTo({padding:l},f),this}rotateTo(l,f,v){return this.easeTo(o.e({bearing:l},f),v)}resetNorth(l,f){return this.rotateTo(0,o.e({duration:1e3},l),f),this}resetNorthPitch(l,f){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},l),f),this}snapToNorth(l,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,f):this}getPitch(){return this.transform.pitch}setPitch(l,f){return this.jumpTo({pitch:l},f),this}getRoll(){return this.transform.roll}setRoll(l,f){return this.jumpTo({roll:l},f),this}cameraForBounds(l,f){l=dn.convert(l).adjustAntiMeridian();let v=f&&f.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),v,f)}_cameraForBoxAndBearing(l,f,v,S){let I={top:0,bottom:0,right:0,left:0};if(typeof(S=o.e({padding:I,offset:[0,0],maxZoom:this.transform.maxZoom},S)).padding=="number"){let X=S.padding;S.padding={top:X,bottom:X,right:X,left:X}}let D=o.e(I,S.padding);S.padding=D;let z=this.transform,V=new dn(l,f);return this.cameraHelper.cameraForBoxAndBearing(S,D,V,v,z)}fitBounds(l,f,v){return this._fitInternal(this.cameraForBounds(l,f),f,v)}fitScreenCoordinates(l,f,v,S,I){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(l)),this.transform.screenPointToLocation(o.P.convert(f)),v,S),S,I)}_fitInternal(l,f,v){return l?(delete(f=o.e(l,f)).padding,f.linear?this.easeTo(f,v):this.flyTo(f,v)):this}jumpTo(l,f){this.stop();let v=this._getTransformForUpdate(),S=!1,I=!1,D=!1,z=v.zoom;this.cameraHelper.handleJumpToCenterZoom(v,l);let V=v.zoom!==z;return"elevation"in l&&v.elevation!==+l.elevation&&v.setElevation(+l.elevation),"bearing"in l&&v.bearing!==+l.bearing&&(S=!0,v.setBearing(+l.bearing)),"pitch"in l&&v.pitch!==+l.pitch&&(I=!0,v.setPitch(+l.pitch)),"roll"in l&&v.roll!==+l.roll&&(D=!0,v.setRoll(+l.roll)),l.padding==null||v.isPaddingEqual(l.padding)||v.setPadding(l.padding),this._applyUpdatedTransform(v),this.fire(new o.l("movestart",f)).fire(new o.l("move",f)),V&&this.fire(new o.l("zoomstart",f)).fire(new o.l("zoom",f)).fire(new o.l("zoomend",f)),S&&this.fire(new o.l("rotatestart",f)).fire(new o.l("rotate",f)).fire(new o.l("rotateend",f)),I&&this.fire(new o.l("pitchstart",f)).fire(new o.l("pitch",f)).fire(new o.l("pitchend",f)),D&&this.fire(new o.l("rollstart",f)).fire(new o.l("roll",f)).fire(new o.l("rollend",f)),this.fire(new o.l("moveend",f))}calculateCameraOptionsFromTo(l,f,v,S=0){let I=o.a1.fromLngLat(l,f),D=o.a1.fromLngLat(v,S),z=D.x-I.x,V=D.y-I.y,X=D.z-I.z,Q=Math.hypot(z,V,X);if(Q===0)throw new Error("Can't calculate camera options with same From and To");let ie=Math.hypot(z,V),re=o.ak(this.transform.cameraToCenterDistance/Q/this.transform.tileSize),ae=180*Math.atan2(z,-V)/Math.PI,Ae=180*Math.acos(ie/Q)/Math.PI;return Ae=X<0?90-Ae:90+Ae,{center:D.toLngLat(),elevation:S,zoom:re,pitch:Ae,bearing:ae}}calculateCameraOptionsFromCameraLngLatAltRotation(l,f,v,S,I){let D=this.transform.calculateCenterFromCameraLngLatAlt(l,f,v,S);return{center:D.center,elevation:D.elevation,zoom:D.zoom,bearing:v,pitch:S,roll:I}}easeTo(l,f){this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.co},l)).animate===!1||!l.essential&&m.prefersReducedMotion)&&(l.duration=0);let v=this._getTransformForUpdate(),S=this.getBearing(),I=v.pitch,D=v.roll,z="bearing"in l?this._normalizeBearing(l.bearing,S):S,V="pitch"in l?+l.pitch:I,X="roll"in l?this._normalizeBearing(l.roll,D):D,Q="padding"in l?l.padding:v.padding,ie=o.P.convert(l.offset),re,ae;l.around&&(re=o.S.convert(l.around),ae=v.locationToScreenPoint(re));let Ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Te=this.cameraHelper.handleEaseTo(v,{bearing:z,pitch:V,roll:X,padding:Q,around:re,aroundPoint:ae,offsetAsPoint:ie,offset:l.offset,zoom:l.zoom,center:l.center});return this._rotating=this._rotating||S!==z,this._pitching=this._pitching||V!==I,this._rolling=this._rolling||X!==D,this._padding=!v.isPaddingEqual(Q),this._zooming=this._zooming||Te.isZooming,this._easeId=l.easeId,this._prepareEase(f,l.noMoveStart,Ae),this.terrain&&this._prepareElevation(Te.elevationCenter),this._ease((Me=>{Te.easeFunc(Me),this.terrain&&!l.freezeElevation&&this._updateElevation(Me),this._applyUpdatedTransform(v),this._fireMoveEvents(f)}),(Me=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(f,Me)}),l),this}_prepareEase(l,f,v={}){this._moving=!0,f||v.moving||this.fire(new o.l("movestart",l)),this._zooming&&!v.zooming&&this.fire(new o.l("zoomstart",l)),this._rotating&&!v.rotating&&this.fire(new o.l("rotatestart",l)),this._pitching&&!v.pitching&&this.fire(new o.l("pitchstart",l)),this._rolling&&!v.rolling&&this.fire(new o.l("rollstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let f=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&f!==this._elevationTarget){let v=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(v-(f-(v*l+this._elevationStart))/(1-l)),this._elevationTarget=f}this.transform.setElevation(o.C.number(this._elevationStart,this._elevationTarget,l))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){if(!this.terrain&&l.elevation>=0&&l.pitch<=90)return{};let f=l.getCameraLngLat(),v=l.getCameraAltitude(),S=this.terrain?this.terrain.getElevationForLngLatZoom(f,l.zoom):0;if(v<S){let I=this.calculateCameraOptionsFromTo(f,S,l.center,l.elevation);return{pitch:I.pitch,zoom:I.zoom}}return{}}_applyUpdatedTransform(l){let f=[];if(f.push((S=>this._elevateCameraIfInsideTerrain(S))),this.transformCameraUpdate&&f.push((S=>this.transformCameraUpdate(S))),!f.length)return;let v=l.clone();for(let S of f){let I=v.clone(),{center:D,zoom:z,roll:V,pitch:X,bearing:Q,elevation:ie}=S(I);D&&I.setCenter(D),ie!==void 0&&I.setElevation(ie),z!==void 0&&I.setZoom(z),V!==void 0&&I.setRoll(V),X!==void 0&&I.setPitch(X),Q!==void 0&&I.setBearing(Q),v.apply(I)}this.transform.apply(v)}_fireMoveEvents(l){this.fire(new o.l("move",l)),this._zooming&&this.fire(new o.l("zoom",l)),this._rotating&&this.fire(new o.l("rotate",l)),this._pitching&&this.fire(new o.l("pitch",l)),this._rolling&&this.fire(new o.l("roll",l))}_afterEase(l,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId;let v=this._zooming,S=this._rotating,I=this._pitching,D=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,v&&this.fire(new o.l("zoomend",l)),S&&this.fire(new o.l("rotateend",l)),I&&this.fire(new o.l("pitchend",l)),D&&this.fire(new o.l("rollend",l)),this.fire(new o.l("moveend",l))}flyTo(l,f){if(!l.essential&&m.prefersReducedMotion){let gt=o.Q(l,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(gt,f)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.co},l);let v=this._getTransformForUpdate(),S=v.bearing,I=v.pitch,D=v.roll,z=v.padding,V="bearing"in l?this._normalizeBearing(l.bearing,S):S,X="pitch"in l?+l.pitch:I,Q="roll"in l?this._normalizeBearing(l.roll,D):D,ie="padding"in l?l.padding:v.padding,re=o.P.convert(l.offset),ae=v.centerPoint.add(re),Ae=v.screenPointToLocation(ae),Te=this.cameraHelper.handleFlyTo(v,{bearing:V,pitch:X,roll:Q,padding:ie,locationAtOffset:Ae,offsetAsPoint:re,center:l.center,minZoom:l.minZoom,zoom:l.zoom}),Me=l.curve,Ce=Math.max(v.width,v.height),De=Ce/Te.scaleOfZoom,Ve=Te.pixelPathLength;typeof Te.scaleOfMinZoom=="number"&&(Me=Math.sqrt(Ce/Te.scaleOfMinZoom/Ve*2));let Oe=Me*Me;function je(gt){let Gt=(De*De-Ce*Ce+(gt?-1:1)*Oe*Oe*Ve*Ve)/(2*(gt?De:Ce)*Oe*Ve);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function He(gt){return(Math.exp(gt)-Math.exp(-gt))/2}function Be(gt){return(Math.exp(gt)+Math.exp(-gt))/2}let et=je(!1),Ke=function(gt){return Be(et)/Be(et+Me*gt)},ct=function(gt){return Ce*((Be(et)*(He(Gt=et+Me*gt)/Be(Gt))-He(et))/Oe)/Ve;var Gt},Ye=(je(!0)-et)/Me;if(Math.abs(Ve)<2e-6||!isFinite(Ye)){if(Math.abs(Ce-De)<1e-6)return this.easeTo(l,f);let gt=De<Ce?-1:1;Ye=Math.abs(Math.log(De/Ce))/Me,ct=()=>0,Ke=Gt=>Math.exp(gt*Me*Gt)}return l.duration="duration"in l?+l.duration:1e3*Ye/("screenSpeed"in l?+l.screenSpeed/Me:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=S!==V,this._pitching=X!==I,this._rolling=Q!==D,this._padding=!v.isPaddingEqual(ie),this._prepareEase(f,!1),this.terrain&&this._prepareElevation(Te.targetCenter),this._ease((gt=>{let Gt=gt*Ye,Ht=1/Ke(Gt),kt=ct(Gt);this._rotating&&v.setBearing(o.C.number(S,V,gt)),this._pitching&&v.setPitch(o.C.number(I,X,gt)),this._rolling&&v.setRoll(o.C.number(D,Q,gt)),this._padding&&(v.interpolatePadding(z,ie,gt),ae=v.centerPoint.add(re)),Te.easeFunc(gt,Ht,kt,ae),this.terrain&&!l.freezeElevation&&this._updateElevation(gt),this._applyUpdatedTransform(v),this._fireMoveEvents(f)}),(()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(f)}),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,f){var v;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let S=this._onEaseEnd;delete this._onEaseEnd,S.call(this,f)}return l||(v=this.handlers)===null||v===void 0||v.stop(!1),this}_ease(l,f,v){v.animate===!1||v.duration===0?(l(1),f()):(this._easeStart=M(),this._easeOptions=v,this._onEaseFrame=l,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,f){l=o.aO(l,-180,180);let v=Math.abs(l-f);return Math.abs(l-360-f)<v&&(l-=360),Math.abs(l+360-f)<v&&(l+=360),l}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.S.convert(l),this.transform.tileZoom):null}}let $p={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class $A{constructor(l=$p){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=f=>{!f||f.sourceDataType!=="metadata"&&f.sourceDataType!=="visibility"&&f.dataType!=="style"&&f.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,f){let v=this._map._getUIString(`AttributionControl.${f}`);l.title=v,l.setAttribute("aria-label",v)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map((S=>typeof S!="string"?"":S))):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){let S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}let f=this._map.style.sourceCaches;for(let S in f){let I=f[S];if(I.used||I.usedForTerrain){let D=I.getSource();D.attribution&&l.indexOf(D.attribution)<0&&l.push(D.attribution)}}l=l.filter((S=>String(S).trim())),l.sort(((S,I)=>S.length-I.length)),l=l.filter(((S,I)=>{for(let D=I+1;D<l.length;D++)if(l[D].indexOf(S)>=0)return!1;return!0}));let v=l.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,l.length?(this._innerContainer.innerHTML=k.sanitize(v),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class wm{constructor(l={}){this._updateCompact=()=>{let f=this._container.children;if(f.length){let v=f[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&v.classList.add("maplibregl-compact"):v.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl");let f=k.create("a","maplibregl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class da{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){let f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f}remove(l){let f=this._currentlyRunning,v=f?this._queue.concat(f):this._queue;for(let S of v)if(S.id===l)return void(S.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let f=this._currentlyRunning=this._queue;this._queue=[];for(let v of f)if(!v.cancelled&&(v.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var uu=o.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Jl extends o.E{constructor(l){super(),this._lastTilesetChange=M(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=l._source.tileSize*2**this.deltaZoom,l.usedForTerrain=!0,l.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,f){this.sourceCache.update(l,f),this._renderableTilesKeys=[];let v={};for(let S of wr(l,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:f,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))v[S.key]=!0,this._renderableTilesKeys.push(S.key),this._tiles[S.key]||(S.terrainRttPosMatrix32f=new Float64Array(16),o.bZ(S.terrainRttPosMatrix32f,0,o.$,o.$,0,0,1),this._tiles[S.key]=new fe(S,this.tileSize),this._lastTilesetChange=M());for(let S in this._tiles)v[S]||delete this._tiles[S]}freeRtt(l){for(let f in this._tiles){let v=this._tiles[f];(!l||v.tileID.equals(l)||v.tileID.isChildOf(l)||l.isChildOf(v.tileID))&&(v.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((l=>this.getTileByID(l)))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l,f){return f?this._getTerrainCoordsForTileRanges(l,f):this._getTerrainCoordsForRegularTile(l)}_getTerrainCoordsForRegularTile(l){let f={};for(let v of this._renderableTilesKeys){let S=this._tiles[v].tileID,I=l.clone(),D=o.ba();if(S.canonical.equals(l.canonical))o.bZ(D,0,o.$,o.$,0,0,1);else if(S.canonical.isChildOf(l.canonical)){let z=S.canonical.z-l.canonical.z,V=S.canonical.x-(S.canonical.x>>z<<z),X=S.canonical.y-(S.canonical.y>>z<<z),Q=o.$>>z;o.bZ(D,0,Q,Q,0,0,1),o.M(D,D,[-V*Q,-X*Q,0])}else{if(!l.canonical.isChildOf(S.canonical))continue;{let z=l.canonical.z-S.canonical.z,V=l.canonical.x-(l.canonical.x>>z<<z),X=l.canonical.y-(l.canonical.y>>z<<z),Q=o.$>>z;o.bZ(D,0,o.$,o.$,0,0,1),o.M(D,D,[V*Q,X*Q,0]),o.N(D,D,[1/2**z,1/2**z,0])}}I.terrainRttPosMatrix32f=new Float32Array(D),f[v]=I}return f}_getTerrainCoordsForTileRanges(l,f){let v={};for(let S of this._renderableTilesKeys){let I=this._tiles[S].tileID;if(!this._isWithinTileRanges(I,f))continue;let D=l.clone(),z=o.ba();if(I.canonical.z===l.canonical.z){let V=l.canonical.x-I.canonical.x,X=l.canonical.y-I.canonical.y;o.bZ(z,0,o.$,o.$,0,0,1),o.M(z,z,[V*o.$,X*o.$,0])}else if(I.canonical.z>l.canonical.z){let V=I.canonical.z-l.canonical.z,X=I.canonical.x-(I.canonical.x>>V<<V),Q=I.canonical.y-(I.canonical.y>>V<<V),ie=l.canonical.x-(I.canonical.x>>V),re=l.canonical.y-(I.canonical.y>>V),ae=o.$>>V;o.bZ(z,0,ae,ae,0,0,1),o.M(z,z,[-X*ae+ie*o.$,-Q*ae+re*o.$,0])}else{let V=l.canonical.z-I.canonical.z,X=l.canonical.x-(l.canonical.x>>V<<V),Q=l.canonical.y-(l.canonical.y>>V<<V),ie=(l.canonical.x>>V)-I.canonical.x,re=(l.canonical.y>>V)-I.canonical.y,ae=o.$<<V;o.bZ(z,0,ae,ae,0,0,1),o.M(z,z,[X*o.$+ie*ae,Q*o.$+re*ae,0])}D.terrainRttPosMatrix32f=new Float32Array(z),v[S]=D}return v}getSourceTile(l,f){let v=this.sourceCache._source,S=l.overscaledZ-this.deltaZoom;if(S>v.maxzoom&&(S=v.maxzoom),S<v.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(S).key);let I=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!I||!I.dem)&&f)for(;S>=v.minzoom&&(!I||!I.dem);)I=this.sourceCache.getTileByID(l.scaledTo(S--).key);return I}anyTilesAfterTime(l=Date.now()){return this._lastTilesetChange>=l}_isWithinTileRanges(l,f){return f[l.canonical.z]&&l.canonical.x>=f[l.canonical.z].minTileX&&l.canonical.x<=f[l.canonical.z].maxTileX&&l.canonical.y>=f[l.canonical.z].minTileY&&l.canonical.y<=f[l.canonical.z].maxTileY}}class rw{constructor(l,f,v){this._meshCache={},this.painter=l,this.sourceCache=new Jl(f),this.options=v,this.exaggeration=typeof v.exaggeration=="number"?v.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,f,v,S=o.$){var I;if(!(f>=0&&f<S&&v>=0&&v<S))return 0;let D=this.getTerrainData(l),z=(I=D.tile)===null||I===void 0?void 0:I.dem;if(!z)return 0;let V=o.cs([],[f/S*o.$,v/S*o.$],D.u_terrain_matrix),X=[V[0]*z.dim,V[1]*z.dim],Q=Math.floor(X[0]),ie=Math.floor(X[1]),re=X[0]-Q,ae=X[1]-ie;return z.get(Q,ie)*(1-re)*(1-ae)+z.get(Q+1,ie)*re*(1-ae)+z.get(Q,ie+1)*(1-re)*ae+z.get(Q+1,ie+1)*re*ae}getElevationForLngLatZoom(l,f){if(!o.ct(f,l.wrap()))return 0;let{tileID:v,mercatorX:S,mercatorY:I}=this._getOverscaledTileIDFromLngLatZoom(l,f);return this.getElevation(v,S%o.$,I%o.$,o.$)}getElevation(l,f,v,S=o.$){return this.getDEMElevation(l,f,v,S)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){let S=this.painter.context,I=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(S,I,S.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(S,new o.R({width:1,height:1}),S.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(S.gl.NEAREST,S.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ai([])}let f=this.sourceCache.getSourceTile(l,!0);if(f&&f.dem&&(!f.demTexture||f.needsTerrainPrepare)){let S=this.painter.context;f.demTexture=this.painter.getTileTexture(f.dem.stride),f.demTexture?f.demTexture.update(f.dem.getPixels(),{premultiply:!1}):f.demTexture=new o.T(S,f.dem.getPixels(),S.gl.RGBA,{premultiply:!1}),f.demTexture.bind(S.gl.NEAREST,S.gl.CLAMP_TO_EDGE),f.needsTerrainPrepare=!1}let v=f&&f+f.tileID.key+l.key;if(v&&!this._demMatrixCache[v]){let S=this.sourceCache.sourceCache._source.maxzoom,I=l.canonical.z-f.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=S?I=l.canonical.z-S:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let D=l.canonical.x-(l.canonical.x>>I<<I),z=l.canonical.y-(l.canonical.y>>I<<I),V=o.cu(new Float64Array(16),[1/(o.$<<I),1/(o.$<<I),0]);o.M(V,V,[D*o.$,z*o.$,0]),this._demMatrixCache[l.key]={matrix:V,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:f&&f.dem&&f.dem.dim||1,u_terrain_matrix:v?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:f&&f.dem&&f.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(f&&f.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:f}}getFramebuffer(l){let f=this.painter,v=f.width/devicePixelRatio,S=f.height/devicePixelRatio;return!this._fbo||this._fbo.width===v&&this._fbo.height===S||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(f.context,{width:v,height:S,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(f.context,{width:v,height:S,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=f.context.createFramebuffer(v,S,!0,!1),this._fbo.depthAttachment.set(f.context.createRenderbuffer(f.context.gl.DEPTH_COMPONENT16,v,S))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let f=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let I=0,D=0;I<this._coordsTextureSize;I++)for(let z=0;z<this._coordsTextureSize;z++,D+=4)f[D+0]=255&z,f[D+1]=255&I,f[D+2]=z>>8<<4|I>>8,f[D+3]=0;let v=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(f.buffer)),S=new o.T(l,v,l.gl.RGBA,{premultiply:!1});return S.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=S,S}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);let f=new Uint8Array(4),v=this.painter.context,S=v.gl,I=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),D=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);v.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),S.readPixels(I,z-D-1,1,1,S.RGBA,S.UNSIGNED_BYTE,f),v.bindFramebuffer.set(null);let V=f[0]+(f[2]>>4<<8),X=f[1]+((15&f[2])<<8),Q=this.coordsIndex[255-f[3]],ie=Q&&this.sourceCache.getTileByID(Q);if(!ie)return null;let re=this._coordsTextureSize,ae=(1<<ie.tileID.canonical.z)*re;return new o.a1((ie.tileID.canonical.x*re+V)/ae+ie.tileID.wrap,(ie.tileID.canonical.y*re+X)/ae,this.getElevation(ie.tileID,V,X,re))}depthAtPoint(l){let f=new Uint8Array(4),v=this.painter.context,S=v.gl;return v.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),S.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,S.RGBA,S.UNSIGNED_BYTE,f),v.bindFramebuffer.set(null),(f[0]/16777216+f[1]/65536+f[2]/256+f[3])/256}getTerrainMesh(l){var f;let v=((f=this.painter.style.projection)===null||f===void 0?void 0:f.transitionState)>0,S=v&&l.canonical.y===0,I=v&&l.canonical.y===(1<<l.canonical.z)-1,D=`m_${S?"n":""}_${I?"s":""}`;if(this._meshCache[D])return this._meshCache[D];let z=this.painter.context,V=new o.cv,X=new o.aN,Q=this.meshSize,ie=o.$/Q,re=Q*Q;for(let Be=0;Be<=Q;Be++)for(let et=0;et<=Q;et++)V.emplaceBack(et*ie,Be*ie,0);for(let Be=0;Be<re;Be+=Q+1)for(let et=0;et<Q;et++)X.emplaceBack(et+Be,Q+et+Be+1,Q+et+Be+2),X.emplaceBack(et+Be,Q+et+Be+2,et+Be+1);let ae=V.length,Ae=ae+(Q+1),Te=(Q+1)*Q,Me=S?o.bh:0,Ce=S?0:1,De=I?o.bi:o.$,Ve=I?0:1;for(let Be=0;Be<=Q;Be++)V.emplaceBack(Be*ie,Me,Ce);for(let Be=0;Be<=Q;Be++)V.emplaceBack(Be*ie,De,Ve);for(let Be=0;Be<Q;Be++)X.emplaceBack(Te+Be,Ae+Be,Ae+Be+1),X.emplaceBack(Te+Be,Ae+Be+1,Te+Be+1),X.emplaceBack(0+Be,ae+Be+1,ae+Be),X.emplaceBack(0+Be,0+Be+1,ae+Be+1);let Oe=V.length,je=Oe+2*(Q+1);for(let Be of[0,1])for(let et=0;et<=Q;et++)for(let Ke of[0,1])V.emplaceBack(Be*o.$,et*ie,Ke);for(let Be=0;Be<2*Q;Be+=2)X.emplaceBack(Oe+Be,Oe+Be+1,Oe+Be+3),X.emplaceBack(Oe+Be,Oe+Be+3,Oe+Be+2),X.emplaceBack(je+Be,je+Be+3,je+Be+1),X.emplaceBack(je+Be,je+Be+2,je+Be+3);let He=new bc(z.createVertexBuffer(V,uu.members),z.createIndexBuffer(X),o.aM.simpleSegment(0,0,V.length,X.length));return this._meshCache[D]=He,He}getMeshFrameDelta(l){return 2*Math.PI*o.bu/Math.pow(2,Math.max(l,0))/5}getMinTileElevationForLngLatZoom(l,f){var v;let{tileID:S}=this._getOverscaledTileIDFromLngLatZoom(l,f);return(v=this.getMinMaxElevation(S).minElevation)!==null&&v!==void 0?v:0}getMinMaxElevation(l){let f=this.getTerrainData(l).tile,v={minElevation:null,maxElevation:null};return f&&f.dem&&(v.minElevation=f.dem.min*this.exaggeration,v.maxElevation=f.dem.max*this.exaggeration),v}_getOverscaledTileIDFromLngLatZoom(l,f){let v=o.a1.fromLngLat(l.wrap()),S=(1<<f)*o.$,I=v.x*S,D=v.y*S,z=Math.floor(I/o.$),V=Math.floor(D/o.$);return{tileID:new o.Z(f,0,f,z,V),mercatorX:I,mercatorY:D}}}class $4{constructor(l,f,v){this._context=l,this._size=f,this._tileSize=v,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){let f=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),v=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return v.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),f.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),f.colorAttachment.set(v.texture),{id:l,fbo:f,texture:v,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((f=>l.id!==f)),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(let f of this._recentlyUsed)if(!this._objects[f].inUse)return this._objects[f];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(let l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((l=>!l.inUse))===!1}}let Wp={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class W4{constructor(l,f){this.painter=l,this.terrain=f,this.pool=new $4(l.context,30,f.sourceCache.tileSize*f.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,f){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter((v=>!l._layers[v].isHidden(f))),this._coordsAscending={};for(let v in l.sourceCaches){this._coordsAscending[v]={};let S=l.sourceCaches[v].getVisibleCoordinates(),I=l.sourceCaches[v].getSource(),D=I instanceof Gl?I.terrainTileRanges:null;for(let z of S){let V=this.terrain.sourceCache.getTerrainCoords(z,D);for(let X in V)this._coordsAscending[v][X]||(this._coordsAscending[v][X]=[]),this._coordsAscending[v][X].push(V[X])}}this._coordsAscendingStr={};for(let v of l._order){let S=l._layers[v],I=S.source;if(Wp[S.type]&&!this._coordsAscendingStr[I]){this._coordsAscendingStr[I]={};for(let D in this._coordsAscending[I])this._coordsAscendingStr[I][D]=this._coordsAscending[I][D].map((z=>z.key)).sort().join()}}for(let v of this._renderableTiles)for(let S in this._coordsAscendingStr){let I=this._coordsAscendingStr[S][v.tileID.key];I&&I!==v.rttCoords[S]&&(v.rtt=[])}}renderLayer(l,f){if(l.isHidden(this.painter.transform.zoom))return!1;let v=Object.assign(Object.assign({},f),{isRenderingToTexture:!0}),S=l.type,I=this.painter,D=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Wp[S]&&(this._prevType&&Wp[this._prevType]||this._stacks.push([]),this._prevType=S,this._stacks[this._stacks.length-1].push(l.id),!D))return!0;if(Wp[this._prevType]||Wp[S]&&D){this._prevType=S;let z=this._stacks.length-1,V=this._stacks[z]||[];for(let X of this._renderableTiles){if(this.pool.isFull()&&(Zh(this.painter,this.terrain,this._rttTiles,v),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(X),X.rtt[z]){let ie=this.pool.getObjectForId(X.rtt[z].id);if(ie.stamp===X.rtt[z].stamp){this.pool.useObject(ie);continue}}let Q=this.pool.getOrCreateFreeObject();this.pool.useObject(Q),this.pool.stampObject(Q),X.rtt[z]={id:Q.id,stamp:Q.stamp},I.context.bindFramebuffer.set(Q.fbo.framebuffer),I.context.clear({color:o.bf.transparent,stencil:0}),I.currentStencilSource=void 0;for(let ie=0;ie<V.length;ie++){let re=I.style._layers[V[ie]],ae=re.source?this._coordsAscending[re.source][X.tileID.key]:[X.tileID];I.context.viewport.set([0,0,Q.fbo.width,Q.fbo.height]),I._renderTileClippingMasks(re,ae,!0),I.renderLayer(I,I.style.sourceCaches[re.source],re,ae,v),re.source&&(X.rttCoords[re.source]=this._coordsAscendingStr[re.source][X.tileID.key])}}return Zh(this.painter,this.terrain,this._rttTiles,v),this._rttTiles=[],this.pool.freeAllObjects(),Wp[S]}return!1}}let Sm={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},gn=s,Jn={hash:!1,interactive:!0,bearingSnap:7,attributionControl:$p,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},iw={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class td{constructor(l,f,v=!1){this.mousedown=I=>{this.startMove(I,k.mousePos(this.element,I)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=I=>{this.move(I,k.mousePos(this.element,I))},this.mouseup=I=>{this._rotatePitchHandler.dragEnd(I),this.offTemp()},this.touchstart=I=>{I.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,I.targetTouches)[0],this.startMove(I,this._startPos),k.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.addEventListener(window,"touchend",this.touchend))},this.touchmove=I=>{I.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,I.targetTouches)[0],this.move(I,this._lastPos))},this.touchend=I=>{I.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=f;let S=new Np;this._rotatePitchHandler=new Tc({clickTolerance:3,move:(I,D)=>{let z=f.getBoundingClientRect(),V=new o.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:o.cn(new o.P(I.x,D.y),D,V),pitchDelta:v?-.5*(D.y-I.y):void 0}},moveStateManager:S,enable:!0,assignEvents:()=>{}}),this.map=l,k.addEventListener(f,"mousedown",this.mousedown),k.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(f,"touchcancel",this.reset)}startMove(l,f){this._rotatePitchHandler.dragStart(l,f),k.disableDrag()}move(l,f){let v=this.map,{bearingDelta:S,pitchDelta:I}=this._rotatePitchHandler.dragMove(l,f)||{};S&&v.setBearing(v.getBearing()+S),I&&v.setPitch(v.getPitch()+I)}off(){let l=this.element;k.removeEventListener(l,"mousedown",this.mousedown),k.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend),k.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend)}}let Ec;function WA(C,l,f,v=!1){if(v||!f.getCoveringTilesDetailsProvider().allowWorldCopies())return C?.wrap();let S=new o.S(C.lng,C.lat);if(C=new o.S(C.lng,C.lat),l){let I=new o.S(C.lng-360,C.lat),D=new o.S(C.lng+360,C.lat),z=f.locationToScreenPoint(C).distSqr(l);f.locationToScreenPoint(I).distSqr(l)<z?C=I:f.locationToScreenPoint(D).distSqr(l)<z&&(C=D)}for(;Math.abs(C.lng-f.center.lng)>180;){let I=f.locationToScreenPoint(C);if(I.x>=0&&I.y>=0&&I.x<=f.width&&I.y<=f.height)break;C.lng>f.center.lng?C.lng-=360:C.lng+=360}return C.lng!==S.lng&&f.isPointOnMapSurface(f.locationToScreenPoint(C))?C:S}let Tm={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rd(C,l,f){let v=C.classList;for(let S in Tm)v.remove(`maplibregl-${f}-anchor-${S}`);v.add(`maplibregl-${f}-anchor-${l}`)}class id extends o.E{constructor(l){if(super(),this._onKeyPress=f=>{let v=f.code,S=f.charCode||f.keyCode;v!=="Space"&&v!=="Enter"&&S!==32&&S!==13||this.togglePopup()},this._onMapClick=f=>{let v=f.originalEvent.target,S=this._element;this._popup&&(v===S||S.contains(v))&&this.togglePopup()},this._update=f=>{if(!this._map)return;let v=this._map.loaded()&&!this._map.isMoving();(f?.type==="terrain"||f?.type==="render"&&!v)&&this._map.once("render",this._update),this._lngLat=WA(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let S="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?S=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(S=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let I="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?I="rotateX(0deg)":this._pitchAlignment==="map"&&(I=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||f&&f.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${Tm[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${I} ${S}`),m.frameAsync(new AbortController).then((()=>{this._updateOpacity(f&&f.type==="moveend")})).catch((()=>{}))},this._onMove=f=>{if(!this._isDragging){let v=this._clickTolerance||this._map._clickTolerance;this._isDragging=f.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=f.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=f=>{this._element.contains(f.originalEvent.target)&&(f.preventDefault(),this._positionDelta=f.point.sub(this._pos).add(this._offset),this._pointerdownPos=f.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(l?.opacity,l?.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div");let f=k.createNS("http://www.w3.org/2000/svg","svg"),v=41,S=27;f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height",`${v}px`),f.setAttributeNS(null,"width",`${S}px`),f.setAttributeNS(null,"viewBox",`0 0 ${S} ${v}`);let I=k.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"stroke","none"),I.setAttributeNS(null,"stroke-width","1"),I.setAttributeNS(null,"fill","none"),I.setAttributeNS(null,"fill-rule","evenodd");let D=k.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill-rule","nonzero");let z=k.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");let V=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let Ce of V){let De=k.createNS("http://www.w3.org/2000/svg","ellipse");De.setAttributeNS(null,"opacity","0.04"),De.setAttributeNS(null,"cx","10.5"),De.setAttributeNS(null,"cy","5.80029008"),De.setAttributeNS(null,"rx",Ce.rx),De.setAttributeNS(null,"ry",Ce.ry),z.appendChild(De)}let X=k.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill",this._color);let Q=k.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),X.appendChild(Q);let ie=k.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"fill","#000000");let re=k.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ie.appendChild(re);let ae=k.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");let Ae=k.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");let Te=k.createNS("http://www.w3.org/2000/svg","circle");Te.setAttributeNS(null,"fill","#000000"),Te.setAttributeNS(null,"opacity","0.25"),Te.setAttributeNS(null,"cx","5.5"),Te.setAttributeNS(null,"cy","5.5"),Te.setAttributeNS(null,"r","5.4999962");let Me=k.createNS("http://www.w3.org/2000/svg","circle");Me.setAttributeNS(null,"fill","#FFFFFF"),Me.setAttributeNS(null,"cx","5.5"),Me.setAttributeNS(null,"cy","5.5"),Me.setAttributeNS(null,"r","5.4999962"),Ae.appendChild(Te),Ae.appendChild(Me),D.appendChild(z),D.appendChild(X),D.appendChild(ie),D.appendChild(ae),D.appendChild(Ae),f.appendChild(D),f.setAttributeNS(null,"height",v*this._scale+"px"),f.setAttributeNS(null,"width",S*this._scale+"px"),this._element.appendChild(f),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(f=>{f.preventDefault()})),this._element.addEventListener("mousedown",(f=>{f.preventDefault()})),rd(this._element,this._anchor,"marker"),l&&l.className)for(let f of l.className.split(" "))this._element.classList.add(f);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),l.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.S.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){let S=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){let l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var f,v;let S=(f=this._map)===null||f===void 0?void 0:f.terrain,I=this._map.transform.isLocationOccluded(this._lngLat);if(!S||I){let ae=I?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ae&&(this._element.style.opacity=ae))}if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}let D=this._map,z=D.terrain.depthAtPoint(this._pos),V=D.terrain.getElevationForLngLatZoom(this._lngLat,D.transform.tileZoom);if(D.transform.lngLatToCameraDepth(this._lngLat,V)-z<.006)return void(this._element.style.opacity=this._opacity);let X=-this._offset.y/D.transform.pixelsPerMeter,Q=Math.sin(D.getPitch()*Math.PI/180)*X,ie=D.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),re=D.transform.lngLatToCameraDepth(this._lngLat,V+Q)-ie>.006;!((v=this._popup)===null||v===void 0)&&v.isOpen()&&re&&this._popup.remove(),this._element.style.opacity=re?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,f){return(this._opacity===void 0||l===void 0&&f===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),f!==void 0&&(this._opacityWhenCovered=f),this._map&&this._updateOpacity(!0),this}}let bf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},nd=0,eh=!1,GA={maxWidth:100,unit:"metric"};function xf(C,l,f){let v=f&&f.maxWidth||100,S=C._container.clientHeight/2,I=C._container.clientWidth/2,D=C.unproject([I-v/2,S]),z=C.unproject([I+v/2,S]),V=Math.round(C.project(z).x-C.project(D).x),X=Math.min(v,V,C._container.clientWidth),Q=D.distanceTo(z);if(f&&f.unit==="imperial"){let ie=3.2808*Q;ie>5280?od(l,X,ie/5280,C._getUIString("ScaleControl.Miles")):od(l,X,ie,C._getUIString("ScaleControl.Feet"))}else f&&f.unit==="nautical"?od(l,X,Q/1852,C._getUIString("ScaleControl.NauticalMiles")):Q>=1e3?od(l,X,Q/1e3,C._getUIString("ScaleControl.Kilometers")):od(l,X,Q,C._getUIString("ScaleControl.Meters"))}function od(C,l,f,v){let S=(function(I){let D=Math.pow(10,`${Math.floor(I)}`.length-1),z=I/D;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:(function(V){let X=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*X)/X})(z),D*z})(f);C.style.width=l*(S/f)+"px",C.innerHTML=`${S}&nbsp;${v}`}let Dv={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Lv=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function HA(C){if(C){if(typeof C=="number"){let l=Math.round(Math.abs(C)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,C),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-C),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(C,0),right:new o.P(-C,0)}}if(C instanceof o.P||Array.isArray(C)){let l=o.P.convert(C);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(C.center||[0,0]),top:o.P.convert(C.top||[0,0]),"top-left":o.P.convert(C["top-left"]||[0,0]),"top-right":o.P.convert(C["top-right"]||[0,0]),bottom:o.P.convert(C.bottom||[0,0]),"bottom-left":o.P.convert(C["bottom-left"]||[0,0]),"bottom-right":o.P.convert(C["bottom-right"]||[0,0]),left:o.P.convert(C.left||[0,0]),right:o.P.convert(C.right||[0,0])}}return HA(new o.P(0,0))}let qA=s;n.AJAXError=o.cz,n.Event=o.l,n.Evented=o.E,n.LngLat=o.S,n.MercatorCoordinate=o.a1,n.Point=o.P,n.addProtocol=o.cA,n.config=o.a,n.removeProtocol=o.cB,n.AttributionControl=$A,n.BoxZoomHandler=Qh,n.CanvasSource=us,n.CooperativeGesturesHandler=Ov,n.DoubleClickZoomHandler=Cn,n.DragPanHandler=vf,n.DragRotateHandler=VA,n.EdgeInsets=Gs,n.FullscreenControl=class extends o.E{constructor(C={}){super(),this._onFullscreenChange=()=>{var l;let f=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=f?.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)f=f.shadowRoot.fullscreenElement;f===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,C&&C.container&&(C.container instanceof HTMLElement?this._container=C.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let C=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon",C).setAttribute("aria-hidden","true"),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},n.GeoJSONSource=Wl,n.GeolocateControl=class extends o.E{constructor(C){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",l)),this._finish()}},this._updateCamera=l=>{let f=new o.S(l.coords.longitude,l.coords.latitude),v=l.coords.accuracy,S=this._map.getBearing(),I=o.e({bearing:S},this.options.fitBoundsOptions),D=dn.fromLngLat(f,v);this._map.fitBounds(D,I,{geolocateSource:!0})},this._updateMarker=l=>{if(l){let f=new o.S(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(f).addTo(this._map),this._userLocationDotMarker.setLngLat(f).addTo(this._map),this._accuracy=l.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=l=>{if(this._map){if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&eh)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");let f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}else{let f=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new id({element:this._dotElement}),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new id({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(f=>{let v=f?.[0]instanceof ResizeObserverEntry;f.geolocateSource||this._watchState!=="ACTIVE_LOCK"||v||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},bf,C)}onAdd(C){return this._map=C,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(l=!1){if(Ec!==void 0&&!l)return Ec;if(window.navigator.permissions===void 0)return Ec=!!window.navigator.geolocation,Ec;try{Ec=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ec=!!window.navigator.geolocation}return Ec}))})().then((l=>this._finishSetupUI(l))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,nd=0,eh=!1}_isOutOfMapMaxBounds(C){let l=this._map.getMaxBounds(),f=C.coords;return l&&(f.longitude<l.getWest()||f.longitude>l.getEast()||f.latitude<l.getSouth()||f.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){let C=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&C))return;let l=this._map.project(C),f=this._map.unproject([l.x+100,l.y]),v=C.distanceTo(f)/100,S=2*this._accuracy/v;this._circleElement.style.width=`${S.toFixed(2)}px`,this._circleElement.style.height=`${S.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":nd--,eh=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let C;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),nd++,nd>1?(C={maximumAge:6e5,timeout:0},eh=!0):(C=this.options.positionOptions,eh=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,C)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},n.GlobeControl=class{constructor(){this._toggleProjection=()=>{var C;let l=(C=this._map.getProjection())===null||C===void 0?void 0:C.type;this._map.setProjection(l!=="mercator"&&l?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var C;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((C=this._map.getProjection())===null||C===void 0?void 0:C.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(C){return this._map=C,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=k.create("button","maplibregl-ctrl-globe",this._container),k.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},n.Hash=Kh,n.ImageSource=Gl,n.KeyboardHandler=Vp,n.LngLatBounds=dn,n.LogoControl=wm,n.Map=class extends Lr{constructor(C){var l,f;o.cw.mark(o.cx.create);let v=Object.assign(Object.assign(Object.assign({},Jn),C),{canvasContextAttributes:Object.assign(Object.assign({},Jn.canvasContextAttributes),C.canvasContextAttributes)});if(v.minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");let S=new qs,I=new uo;if(v.minZoom!==void 0&&S.setMinZoom(v.minZoom),v.maxZoom!==void 0&&S.setMaxZoom(v.maxZoom),v.minPitch!==void 0&&S.setMinPitch(v.minPitch),v.maxPitch!==void 0&&S.setMaxPitch(v.maxPitch),v.renderWorldCopies!==void 0&&S.setRenderWorldCopies(v.renderWorldCopies),v.transformConstrain!==null&&S.setConstrain(v.transformConstrain),super(S,I,{bearingSnap:v.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new da,this._controls=[],this._mapId=o.a7(),this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:z}))},this._contextRestored=z=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},v.canvasContextAttributes),this._trackResize=v.trackResize===!0,this._bearingSnap=v.bearingSnap,this._centerClampedToGround=v.centerClampedToGround,this._refreshExpiredTiles=v.refreshExpiredTiles===!0,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions===!0,this._collectResourceTiming=v.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Sm),v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this.transformConstrain=v.transformConstrain,this.cancelPendingTileRequestsWhileZooming=v.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ee.addThrottleControl((()=>this.isMoving())),this._requestManager=new ce(v.transformRequest),typeof v.container=="string"){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let z=!1,V=DA((X=>{this._trackResize&&!this._removed&&(this.resize(X),this.redraw())}),50);this._resizeObserver=new ResizeObserver((X=>{z?V(X):z=!0})),this._resizeObserver.observe(this._container)}this.handlers=new _r(this,v),this._hash=v.hash&&new Kh(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,roll:v.roll}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,o.e({},v.fitBoundsOptions,{duration:0}))));let D=typeof v.style=="string"||((f=(l=v.style)===null||l===void 0?void 0:l.projection)===null||f===void 0?void 0:f.type)!=="globe";this.resize(null,D),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new $A(typeof v.attributionControl=="boolean"?void 0:v.attributionControl)),v.maplibreLogo&&this.addControl(new wm,v.logoPosition),this.on("style.load",(()=>{if(D||this._resizeTransform(),this.transform.unmodified){let z=o.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(z)}})),this.on("data",(z=>{this._update(z.dataType==="style"),this.fire(new o.l(`${z.dataType}data`,z))})),this.on("dataloading",(z=>{this.fire(new o.l(`${z.dataType}dataloading`,z))})),this.on("dataabort",(z=>{this.fire(new o.l("sourcedataabort",z))}))}_getMapId(){return this._mapId}setGlobalStateProperty(C,l){return this.style.setGlobalStateProperty(C,l),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(C,l){if(l===void 0&&(l=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let f=C.onAdd(this);this._controls.push(C);let v=this._controlPositions[l];return l.indexOf("bottom")!==-1?v.insertBefore(f,v.firstChild):v.appendChild(f),this}removeControl(C){if(!C||!C.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let l=this._controls.indexOf(C);return l>-1&&this._controls.splice(l,1),C.onRemove(this),this}hasControl(C){return this._controls.indexOf(C)>-1}coveringTiles(C){return wr(this.transform,C)}calculateCameraOptionsFromTo(C,l,f,v){return v==null&&this.terrain&&(v=this.terrain.getElevationForLngLatZoom(f,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(C,l,f,v)}resize(C,l=!0){let[f,v]=this._containerDimensions(),S=this._getClampedPixelRatio(f,v);if(this._resizeCanvas(f,v,S),this.painter.resize(f,v,S),this.painter.overLimit()){let D=this.painter.context.gl;this._maxCanvasSize=[D.drawingBufferWidth,D.drawingBufferHeight];let z=this._getClampedPixelRatio(f,v);this._resizeCanvas(f,v,z),this.painter.resize(f,v,z)}this._resizeTransform(l);let I=!this._moving;return I&&(this.stop(),this.fire(new o.l("movestart",C)).fire(new o.l("move",C))),this.fire(new o.l("resize",C)),I&&this.fire(new o.l("moveend",C)),this}_resizeTransform(C=!0){var l;let[f,v]=this._containerDimensions();this.transform.resize(f,v,C),(l=this._requestedCameraState)===null||l===void 0||l.resize(f,v,C)}_getClampedPixelRatio(C,l){let{0:f,1:v}=this._maxCanvasSize,S=this.getPixelRatio(),I=C*S,D=l*S;return Math.min(I>f?f/I:1,D>v?v/D:1)*S}getPixelRatio(){var C;return(C=this._overridePixelRatio)!==null&&C!==void 0?C:devicePixelRatio}setPixelRatio(C){this._overridePixelRatio=C,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(C){return this.transform.setMaxBounds(dn.convert(C)),this._update()}setMinZoom(C){if((C=C??-2)>=-2&&C<=this.transform.maxZoom)return this.transform.setMinZoom(C),this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(C){if((C=C??22)>=this.transform.minZoom)return this.transform.setMaxZoom(C),this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(C){if((C=C??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.setMinPitch(C),this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(C){if((C=C??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(C>=this.transform.minPitch)return this.transform.setMaxPitch(C),this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(C){return this.transform.setRenderWorldCopies(C),this._update()}setTransformConstrain(C){return this.transform.setConstrain(C),this._update()}project(C){return this.transform.locationToScreenPoint(o.S.convert(C),this.style&&this.terrain)}unproject(C){return this.transform.screenPointToLocation(o.P.convert(C),this.terrain)}isMoving(){var C;return this._moving||((C=this.handlers)===null||C===void 0?void 0:C.isMoving())}isZooming(){var C;return this._zooming||((C=this.handlers)===null||C===void 0?void 0:C.isZooming())}isRotating(){var C;return this._rotating||((C=this.handlers)===null||C===void 0?void 0:C.isRotating())}_createDelegatedListener(C,l,f){if(C==="mouseenter"||C==="mouseover"){let v=!1;return{layers:l,listener:f,delegates:{mousemove:I=>{let D=l.filter((V=>this.getLayer(V))),z=D.length!==0?this.queryRenderedFeatures(I.point,{layers:D}):[];z.length?v||(v=!0,f.call(this,new tl(C,this,I.originalEvent,{features:z}))):v=!1},mouseout:()=>{v=!1}}}}if(C==="mouseleave"||C==="mouseout"){let v=!1;return{layers:l,listener:f,delegates:{mousemove:D=>{let z=l.filter((V=>this.getLayer(V)));(z.length!==0?this.queryRenderedFeatures(D.point,{layers:z}):[]).length?v=!0:v&&(v=!1,f.call(this,new tl(C,this,D.originalEvent)))},mouseout:D=>{v&&(v=!1,f.call(this,new tl(C,this,D.originalEvent)))}}}}{let v=S=>{let I=l.filter((z=>this.getLayer(z))),D=I.length!==0?this.queryRenderedFeatures(S.point,{layers:I}):[];D.length&&(S.features=D,f.call(this,S),delete S.features)};return{layers:l,listener:f,delegates:{[C]:v}}}}_saveDelegatedListener(C,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(l)}_removeDelegatedListener(C,l,f){if(!this._delegatedListeners||!this._delegatedListeners[C])return;let v=this._delegatedListeners[C];for(let S=0;S<v.length;S++){let I=v[S];if(I.listener===f&&I.layers.length===l.length&&I.layers.every((D=>l.includes(D)))){for(let D in I.delegates)this.off(D,I.delegates[D]);return void v.splice(S,1)}}}on(C,l,f){if(f===void 0)return super.on(C,l);let v=typeof l=="string"?[l]:l,S=this._createDelegatedListener(C,v,f);this._saveDelegatedListener(C,S);for(let I in S.delegates)this.on(I,S.delegates[I]);return{unsubscribe:()=>{this._removeDelegatedListener(C,v,f)}}}once(C,l,f){if(f===void 0)return super.once(C,l);let v=typeof l=="string"?[l]:l,S=this._createDelegatedListener(C,v,f);for(let I in S.delegates){let D=S.delegates[I];S.delegates[I]=(...z)=>{this._removeDelegatedListener(C,v,f),D(...z)}}this._saveDelegatedListener(C,S);for(let I in S.delegates)this.once(I,S.delegates[I]);return this}off(C,l,f){return f===void 0?super.off(C,l):(this._removeDelegatedListener(C,typeof l=="string"?[l]:l,f),this)}queryRenderedFeatures(C,l){if(!this.style)return[];let f,v=C instanceof o.P||Array.isArray(C),S=v?C:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(v?{}:C)||{},S instanceof o.P||typeof S[0]=="number")f=[o.P.convert(S)];else{let I=o.P.convert(S[0]),D=o.P.convert(S[1]);f=[I,new o.P(D.x,I.y),D,new o.P(I.x,D.y),I]}return this.style.queryRenderedFeatures(f,l,this.transform)}querySourceFeatures(C,l){return this.style.querySourceFeatures(C,l)}setStyle(C,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&C?(this._diffStyle(C,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(C,l))}setTransformRequest(C){return this._requestManager.setTransformRequest(C),this}_getUIString(C){let l=this._locale[C];if(l==null)throw new Error(`Missing UI string '${C}'`);return l}_updateStyle(C,l){var f,v;if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(C,l)));let S=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!C)),C?(this.style=new sr(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof C=="string"?this.style.loadURL(C,l,S):this.style.loadJSON(C,l,S),this):((v=(f=this.style)===null||f===void 0?void 0:f.projection)===null||v===void 0||v.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new sr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(C,l){if(typeof C=="string"){let f=this._requestManager.transformRequest(C,"Style");o.j(f,new AbortController).then((v=>{this._updateDiff(v.data,l)})).catch((v=>{v&&this.fire(new o.k(v))}))}else typeof C=="object"&&this._updateDiff(C,l)}_updateDiff(C,l){try{this.style.setState(C,l)&&this._update(!0)}catch(f){o.w(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(C,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(C,l){return this._lazyInitEmptyStyle(),this.style.addSource(C,l),this._update(!0)}isSourceLoaded(C){let l=this.style&&this.style.sourceCaches[C];if(l!==void 0)return l.loaded();this.fire(new o.k(new Error(`There is no source with ID '${C}'`)))}setTerrain(C){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),C){let l=this.style.sourceCaches[C.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${C.source}`);this.terrain===null&&l.reload();for(let f in this.style._layers){let v=this.style._layers[f];v.type==="hillshade"&&v.source===C.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),v.type==="color-relief"&&v.source===C.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new rw(this.painter,l,C),this.painter.renderToTexture=new W4(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=f=>{var v;f.dataType==="style"?this.terrain.sourceCache.freeRtt():f.dataType==="source"&&f.tile&&(f.sourceId!==C.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((v=f.source)===null||v===void 0?void 0:v.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(f.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:C})),this}getTerrain(){var C,l;return(l=(C=this.terrain)===null||C===void 0?void 0:C.options)!==null&&l!==void 0?l:null}areTilesLoaded(){let C=this.style&&this.style.sourceCaches;for(let l in C){let f=C[l]._tiles;for(let v in f){let S=f[v];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}removeSource(C){return this.style.removeSource(C),this._update(!0)}getSource(C){return this.style.getSource(C)}setSourceTileLodParams(C,l,f){if(f){let v=this.getSource(f);if(!v)throw new Error(`There is no source with ID "${f}", cannot set LOD parameters`);v.calculateTileZoom=lt(Math.max(1,C),Math.max(1,l))}else for(let v in this.style.sourceCaches)this.style.sourceCaches[v].getSource().calculateTileZoom=lt(Math.max(1,C),Math.max(1,l));return this._update(!0),this}refreshTiles(C,l){let f=this.style.sourceCaches[C];if(!f)throw new Error(`There is no source cache with ID "${C}", cannot refresh tile`);l===void 0?f.reload(!0):f.refreshTiles(l.map((v=>new o.a4(v.z,v.x,v.y))))}addImage(C,l,f={}){let{pixelRatio:v=1,sdf:S=!1,stretchX:I,stretchY:D,content:z,textFitWidth:V,textFitHeight:X}=f;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:Q,height:ie,data:re}=l,ae=l;return this.style.addImage(C,{data:new o.R({width:Q,height:ie},new Uint8Array(re)),pixelRatio:v,stretchX:I,stretchY:D,content:z,textFitWidth:V,textFitHeight:X,sdf:S,version:0,userImage:ae}),ae.onAdd&&ae.onAdd(this,C),this}}{let{width:Q,height:ie,data:re}=m.getImageData(l);this.style.addImage(C,{data:new o.R({width:Q,height:ie},re),pixelRatio:v,stretchX:I,stretchY:D,content:z,textFitWidth:V,textFitHeight:X,sdf:S,version:0})}}updateImage(C,l){let f=this.style.getImage(C);if(!f)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let v=l instanceof HTMLImageElement||o.b(l)?m.getImageData(l):l,{width:S,height:I,data:D}=v;if(S===void 0||I===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==f.data.width||I!==f.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));let z=!(l instanceof HTMLImageElement||o.b(l));return f.data.replace(D,z),this.style.updateImage(C,f),this}getImage(C){return this.style.getImage(C)}hasImage(C){return C?!!this.style.getImage(C):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(C){this.style.removeImage(C)}loadImage(C){return ee.getImage(this._requestManager.transformRequest(C,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(C,l){return this._lazyInitEmptyStyle(),this.style.addLayer(C,l),this._update(!0)}moveLayer(C,l){return this.style.moveLayer(C,l),this._update(!0)}removeLayer(C){return this.style.removeLayer(C),this._update(!0)}getLayer(C){return this.style.getLayer(C)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(C,l,f){return this.style.setLayerZoomRange(C,l,f),this._update(!0)}setFilter(C,l,f={}){return this.style.setFilter(C,l,f),this._update(!0)}getFilter(C){return this.style.getFilter(C)}setPaintProperty(C,l,f,v={}){return this.style.setPaintProperty(C,l,f,v),this._update(!0)}getPaintProperty(C,l){return this.style.getPaintProperty(C,l)}setLayoutProperty(C,l,f,v={}){return this.style.setLayoutProperty(C,l,f,v),this._update(!0)}getLayoutProperty(C,l){return this.style.getLayoutProperty(C,l)}setGlyphs(C,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(C,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(C,l,f={}){return this._lazyInitEmptyStyle(),this.style.addSprite(C,l,f,(v=>{v||this._update(!0)})),this}removeSprite(C){return this._lazyInitEmptyStyle(),this.style.removeSprite(C),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(C,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(C,l,(f=>{f||this._update(!0)})),this}setLight(C,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(C,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(C,l={}){return this._lazyInitEmptyStyle(),this.style.setSky(C,l),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(C,l){return this.style.setFeatureState(C,l),this._update()}removeFeatureState(C,l){return this.style.removeFeatureState(C,l),this._update()}getFeatureState(C){return this.style.getFeatureState(C)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let C=0,l=0;return this._container&&(C=this._container.clientWidth||400,l=this._container.clientHeight||300),[C,l]}_setupContainer(){let C=this._container;C.classList.add("maplibregl-map");let l=this._canvasContainer=k.create("div","maplibregl-canvas-container",C);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let f=this._containerDimensions(),v=this._getClampedPixelRatio(f[0],f[1]);this._resizeCanvas(f[0],f[1],v);let S=this._controlContainer=k.create("div","maplibregl-control-container",C),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((D=>{I[D]=k.create("div",`maplibregl-ctrl-${D} `,S)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(C,l,f){this._canvas.width=Math.floor(f*C),this._canvas.height=Math.floor(f*l),this._canvas.style.width=`${C}px`,this._canvas.style.height=`${l}px`}_setupPainter(){let C=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),l=null;this._canvas.addEventListener("webglcontextcreationerror",(v=>{l={requestedAttributes:C},v&&(l.statusMessage=v.statusMessage,l.type=v.type)}),{once:!0});let f=null;if(f=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,C):this._canvas.getContext("webgl2",C)||this._canvas.getContext("webgl",C),!f){let v="Failed to initialize WebGL";throw l?(l.message=v,new Error(JSON.stringify(l))):new Error(v)}this.painter=new OA(f,this.transform),F.testSupport(f)}migrateProjection(C,l){super.migrateProjection(C,l),this.painter.transform=C,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(C){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(C){return this._update(),this._renderTaskQueue.add(C)}_cancelRenderFrame(C){this._renderTaskQueue.remove(C)}_render(C){var l,f,v,S,I;let D=this._idleTriggered?this._fadeDuration:0,z=((l=this.style.projection)===null||l===void 0?void 0:l.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),this._removed)return;let V=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let ie=this.transform.zoom,re=M();this.style.zoomHistory.update(ie,re);let ae=new o.F(ie,{now:re,fadeDuration:D,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ae=ae.crossFadingFactor();Ae===1&&Ae===this._crossFadingFactor||(V=!0,this._crossFadingFactor=Ae),this.style.update(ae)}let X=((f=this.style.projection)===null||f===void 0?void 0:f.transitionState)>0!==z;(v=this.style.projection)===null||v===void 0||v.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((S=this.style.projection)===null||S===void 0?void 0:S.transitionState,(I=this.style.projection)===null||I===void 0?void 0:I.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||X)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,D,this._crossSourceCollisions,X),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:D,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cw.mark(o.cx.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||V)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let Q=this._sourcesDirty||this._styleDirty||this._placementDirty;return Q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||Q||(this._fullyLoaded=!0,o.cw.mark(o.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var C;this._hash&&this._hash.remove();for(let f of this._controls)f.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ee.removeThrottleControl(this._imageQueueHandle),(C=this._resizeObserver)===null||C===void 0||C.disconnect();let l=this.painter.context.gl.getExtension("WEBGL_lose_context");l?.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cw.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,m.frame(this._frameRequest,(C=>{o.cw.frame(C),this._frameRequest=null;try{this._render(C)}catch(l){if(!o.cy(l)&&!(function(f){return f.message===qh})(l))throw l}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())}get showPadding(){return!!this._showPadding}set showPadding(C){this._showPadding!==C&&(this._showPadding=C,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())}get repaint(){return!!this._repaint}set repaint(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(C){this._vertices=C,this._update()}get version(){return gn}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(C){return this._lazyInitEmptyStyle(),this.style.setProjection(C),this._update(!0)}},n.MapMouseEvent=tl,n.MapTouchEvent=ua,n.MapWheelEvent=Zl,n.Marker=id,n.NavigationControl=class{constructor(C){this._updateZoomButtons=()=>{let l=this._map.getZoom(),f=l===this._map.getMaxZoom(),v=l===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(l,f)=>{let v=this._map._getUIString(`NavigationControl.${f}`);l.title=v,l.setAttribute("aria-label",v)},this.options=o.e({},iw,C),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(l=>this._map.zoomIn({},{originalEvent:l}))),k.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(l=>this._map.zoomOut({},{originalEvent:l}))),k.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})})),this._compassIcon=k.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new td(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(C,l){let f=k.create("button",C,this._container);return f.type="button",f.addEventListener("click",l),f}},n.Popup=class extends o.E{constructor(C){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=k.create("div","maplibregl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let D of this.options.className.split(" "))this._container.classList.add(D);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=WA(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!l)return;let f=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationToScreenPoint(this._lngLat));let v=this.options.anchor,S=HA(this.options.offset);if(!v){let D=this._container.offsetWidth,z=this._container.offsetHeight,V;V=f.y+S.bottom.y<z?["top"]:f.y>this._map.transform.height-z?["bottom"]:[],f.x<D/2?V.push("left"):f.x>this._map.transform.width-D/2&&V.push("right"),v=V.length===0?"bottom":V.join("-")}let I=f.add(S[v]);this.options.subpixelPositioning||(I=I.round()),k.setTransform(this._container,`${Tm[v]} translate(${I.x}px,${I.y}px)`),rd(this._container,v,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Dv),C)}addTo(C){return this._map&&this.remove(),this._map=C,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(C){return this._lngLat=o.S.convert(C),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(C){return this.setDOMContent(document.createTextNode(C))}setHTML(C){let l=document.createDocumentFragment(),f=document.createElement("body"),v;for(f.innerHTML=C;v=f.firstChild,v;)l.appendChild(v);return this.setDOMContent(l)}getMaxWidth(){var C;return(C=this._container)===null||C===void 0?void 0:C.style.maxWidth}setMaxWidth(C){return this.options.maxWidth=C,this._update(),this}setDOMContent(C){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(C),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(C){return this._container&&this._container.classList.add(C),this}removeClassName(C){return this._container&&this._container.classList.remove(C),this}setOffset(C){return this.options.offset=C,this._update(),this}toggleClassName(C){if(this._container)return this._container.classList.toggle(C)}setSubpixelPositioning(C){this.options.subpixelPositioning=C}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let C=this._container.querySelector(Lv);C&&C.focus()}},n.RasterDEMTileSource=Ss,n.RasterTileSource=cs,n.ScaleControl=class{constructor(C){this._onMove=()=>{xf(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,xf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},GA),C)}getDefaultPosition(){return"bottom-left"}onAdd(C){return this._map=C,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},n.ScrollZoomHandler=lu,n.Style=sr,n.TerrainControl=class{constructor(C){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=C}onAdd(C){return this._map=C,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},n.TwoFingersTouchPitchHandler=ha,n.TwoFingersTouchRotateHandler=Up,n.TwoFingersTouchZoomHandler=bm,n.TwoFingersTouchZoomRotateHandler=xm,n.VectorTileSource=vl,n.VideoSource=_c,n.addSourceType=(C,l)=>o._(void 0,void 0,void 0,(function*(){if(vc(C))throw new Error(`A source type called "${C}" already exists.`);((f,v)=>{$s[f]=v})(C,l)})),n.clearPrewarmedResources=function(){let C=yr;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(hr),yr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},n.createTileMesh=cm,n.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},n.getRTLTextPluginStatus=function(){return Hl().getRTLTextPluginStatus()},n.getVersion=function(){return qA},n.getWorkerCount=function(){return nt.workerCount},n.getWorkerUrl=function(){return o.a.WORKER_URL},n.importScriptInWorkers=function(C){return zi().broadcast("IS",C)},n.isTimeFrozen=function(){return x.isFrozen()},n.prewarm=function(){oi().acquire(hr)},n.restoreNow=function(){x.restoreNow()},n.setMaxParallelImageRequests=function(C){o.a.MAX_PARALLEL_IMAGE_REQUESTS=C},n.setNow=function(C){x.setNow(C)},n.setRTLTextPlugin=function(C,l){return Hl().setRTLTextPlugin(C,l)},n.setWorkerCount=function(C){nt.workerCount=C},n.setWorkerUrl=function(C){o.a.WORKER_URL=C}}));var i=t;return i}))});var R5e=nr((p2r,k5e)=>{k5e.exports=lR;lR.default=lR;lR.stable=P5e;lR.stableStringify=P5e;var yU="[...]",E5e="[Circular]",fx=[],dx=[];function C5e(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function lR(t,e,r,i){typeof i>"u"&&(i=C5e()),_re(t,"",0,[],void 0,0,i);var n;try{dx.length===0?n=JSON.stringify(t,e,r):n=JSON.stringify(t,I5e(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;fx.length!==0;){var o=fx.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return n}function g4(t,e,r,i){var n=Object.getOwnPropertyDescriptor(i,r);n.get!==void 0?n.configurable?(Object.defineProperty(i,r,{value:t}),fx.push([i,r,e,n])):dx.push([e,r,t]):(i[r]=t,fx.push([i,r,e]))}function _re(t,e,r,i,n,o,s){o+=1;var a;if(typeof t=="object"&&t!==null){for(a=0;a<i.length;a++)if(i[a]===t){g4(E5e,t,e,n);return}if(typeof s.depthLimit<"u"&&o>s.depthLimit){g4(yU,t,e,n);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){g4(yU,t,e,n);return}if(i.push(t),Array.isArray(t))for(a=0;a<t.length;a++)_re(t[a],a,a,i,t,o,s);else{var u=Object.keys(t);for(a=0;a<u.length;a++){var p=u[a];_re(t[p],p,a,i,t,o,s)}}i.pop()}}function udt(t,e){return t<e?-1:t>e?1:0}function P5e(t,e,r,i){typeof i>"u"&&(i=C5e());var n=vre(t,"",0,[],void 0,0,i)||t,o;try{dx.length===0?o=JSON.stringify(n,e,r):o=JSON.stringify(n,I5e(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;fx.length!==0;){var s=fx.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function vre(t,e,r,i,n,o,s){o+=1;var a;if(typeof t=="object"&&t!==null){for(a=0;a<i.length;a++)if(i[a]===t){g4(E5e,t,e,n);return}try{if(typeof t.toJSON=="function")return}catch{return}if(typeof s.depthLimit<"u"&&o>s.depthLimit){g4(yU,t,e,n);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){g4(yU,t,e,n);return}if(i.push(t),Array.isArray(t))for(a=0;a<t.length;a++)vre(t[a],a,a,i,t,o,s);else{var u={},p=Object.keys(t).sort(udt);for(a=0;a<p.length;a++){var m=p[a];vre(t[m],m,a,i,t,o,s),u[m]=t[m]}if(typeof n<"u")fx.push([n,e,t]),n[e]=u;else return u}i.pop()}}function I5e(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(dx.length>0)for(var i=0;i<dx.length;i++){var n=dx[i];if(n[1]===e&&n[0]===r){r=n[2],dx.splice(i,1);break}}return t.call(this,e,r)}}});function hdt(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function ddt(){let t=hdt();if(t.__xstate__)return t.__xstate__}var O5e,_U=ve(()=>{O5e=t=>{if(typeof window>"u")return;let e=ddt();e&&e.register(t)}});function gdt(t,e){return{type:`xstate.after.${t}.${e}`}}function wre(t,e){return{type:`xstate.done.state.${t}`,output:e}}function Adt(t,e){return{type:`xstate.done.actor.${t}`,output:e,actorId:t}}function Cre(t,e){return{type:`xstate.error.actor.${t}`,error:e,actorId:t}}function Pre(t){return{type:z5e,input:t}}function Q0(t){setTimeout(()=>{throw t})}function xU(t,e){let r=D5e(t),i=D5e(e);return typeof i=="string"?typeof r=="string"?i===r:!1:typeof r=="string"?r in i:Object.keys(r).every(n=>n in i?xU(r[n],i[n]):!1)}function wU(t){if(j5e(t))return t;let e=[],r="";for(let i=0;i<t.length;i++){switch(t.charCodeAt(i)){case 92:r+=t[i+1],i++;continue;case 46:e.push(r),r="";continue}r+=t[i]}return e.push(r),e}function D5e(t){if(Bre(t))return t.value;if(typeof t!="string")return t;let e=wU(t);return Ire(e)}function Ire(t){if(t.length===1)return t[0];let e={},r=e;for(let i=0;i<t.length-1;i++)if(i===t.length-2)r[t[i]]=t[i+1];else{let n=r;r={},n[t[i]]=r}return e}function kre(t,e){let r={},i=Object.keys(t);for(let n=0;n<i.length;n++){let o=i[n];r[o]=e(t[o],o,t,n)}return r}function V5e(t){return j5e(t)?t:[t]}function mp(t){return t===void 0?[]:V5e(t)}function Sre(t,e,r,i){return typeof t=="function"?t({context:e,event:r,self:i}):t}function j5e(t){return Array.isArray(t)}function _dt(t){return t.type.startsWith("xstate.error.actor")}function px(t){return V5e(t).map(e=>typeof e>"u"||typeof e=="string"?{target:e}:e)}function $5e(t){if(!(t===void 0||t===fdt))return mp(t)}function gx(t,e,r){let i=typeof t=="object",n=i?t:void 0;return{next:(i?t.next:t)?.bind(n),error:(i?t.error:e)?.bind(n),complete:(i?t.complete:r)?.bind(n)}}function Rre(t,e){return`${e}.${t}`}function hR(t,e){let r=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!r)return t.implementations.actors[e];let[,i,n]=r,s=t.getStateNodeById(n).config.invoke;return(Array.isArray(s)?s[i]:s).src}function W5e(t){return[...new Set([...t._nodes.flatMap(e=>e.ownEvents)])]}function L5e(t,e){return`${t.sessionId}.${e}`}function bdt(t,e){let r=new Map,i=new Map,n=new WeakMap,o=new Set,s={},{clock:a,logger:u}=e,p={schedule:(M,k,F,j,H=Math.random().toString(36).slice(2))=>{let W={source:M,target:k,event:F,delay:j,id:H,startedAt:Date.now()},Z=L5e(M,H);x._snapshot._scheduledEvents[Z]=W;let Y=a.setTimeout(()=>{delete s[Z],delete x._snapshot._scheduledEvents[Z],x._relay(M,k,F)},j);s[Z]=Y},cancel:(M,k)=>{let F=L5e(M,k),j=s[F];delete s[F],delete x._snapshot._scheduledEvents[F],j!==void 0&&a.clearTimeout(j)},cancelAll:M=>{for(let k in x._snapshot._scheduledEvents){let F=x._snapshot._scheduledEvents[k];F.source===M&&p.cancel(M,F.id)}}},m=M=>{if(!o.size)return;let k={...M,rootId:t.sessionId};o.forEach(F=>F.next?.(k))},x={_snapshot:{_scheduledEvents:(e?.snapshot&&e.snapshot.scheduler)??{}},_bookId:()=>`x:${vdt++}`,_register:(M,k)=>(r.set(M,k),M),_unregister:M=>{r.delete(M.sessionId);let k=n.get(M);k!==void 0&&(i.delete(k),n.delete(M))},get:M=>i.get(M),getAll:()=>Object.fromEntries(i.entries()),_set:(M,k)=>{let F=i.get(M);if(F&&F!==k)throw new Error(`Actor with system ID '${M}' already exists.`);i.set(M,k),n.set(k,M)},inspect:M=>{let k=gx(M);return o.add(k),{unsubscribe(){o.delete(k)}}},_sendInspectionEvent:m,_relay:(M,k,F)=>{x._sendInspectionEvent({type:"@xstate.event",sourceRef:M,actorRef:k,event:F}),k._send(F)},scheduler:p,getSnapshot:()=>({_scheduledEvents:{...x._snapshot._scheduledEvents}}),start:()=>{let M=x._snapshot._scheduledEvents;x._snapshot._scheduledEvents={};for(let k in M){let{source:F,target:j,event:H,delay:W,id:Z}=M[k];p.schedule(F,j,H,W,Z)}},_clock:a,_logger:u};return x}function pc(t,...[e]){return new cR(t,e)}function wdt(t,e,r,i,{sendId:n}){let o=typeof n=="function"?n(r,i):n;return[e,{sendId:o},void 0]}function Sdt(t,e){t.defer(()=>{t.system.scheduler.cancel(t.self,e.sendId)})}function yx(t){function e(r,i){}return e.type="xstate.cancel",e.sendId=t,e.resolve=wdt,e.execute=Sdt,e}function Tdt(t,e,r,i,{id:n,systemId:o,src:s,input:a,syncSnapshot:u}){let p=typeof s=="string"?hR(e.machine,s):s,m=typeof n=="function"?n(r):n,x,M;return p&&(M=typeof a=="function"?a({context:e.context,event:r.event,self:t.self}):a,x=pc(p,{id:m,src:s,parent:t.self,syncSnapshot:u,systemId:o,input:M})),[iv(e,{children:{...e.children,[m]:x}}),{id:n,systemId:o,actorRef:x,src:s,input:M},void 0]}function Mdt(t,{actorRef:e}){e&&t.defer(()=>{e._processingStatus!==tu.Stopped&&e.start()})}function _x(...[t,{id:e,systemId:r,input:i,syncSnapshot:n=!1}={}]){function o(s,a){}return o.type="xstate.spawnChild",o.id=e,o.systemId=r,o.src=t,o.input=i,o.syncSnapshot=n,o.resolve=Tdt,o.execute=Mdt,o}function Edt(t,e,r,i,{actorRef:n}){let o=typeof n=="function"?n(r,i):n,s=typeof o=="string"?e.children[o]:o,a=e.children;return s&&(a={...a},delete a[s.id]),[iv(e,{children:a}),s,void 0]}function Cdt(t,e){if(e){if(t.system._unregister(e),e._processingStatus!==tu.Running){t.stopChild(e);return}t.defer(()=>{t.stopChild(e)})}}function rA(t){function e(r,i){}return e.type="xstate.stopChild",e.actorRef=t,e.resolve=Edt,e.execute=Cdt,e}function Pdt(t,e,{stateValue:r}){if(typeof r=="string"&&v4(r)){let i=t.machine.getStateNodeById(r);return t._nodes.some(n=>n===i)}return t.matches(r)}function q5e(t){function e(){return!1}return e.check=Pdt,e.stateValue=t,e}function Idt(t,{context:e,event:r},{guards:i}){return!iA(i[0],e,r,t)}function Y5e(t){function e(r,i){return!1}return e.check=Idt,e.guards=[t],e}function kdt(t,{context:e,event:r},{guards:i}){return i.every(n=>iA(n,e,r,t))}function X5e(t){function e(r,i){return!1}return e.check=kdt,e.guards=t,e}function Rdt(t,{context:e,event:r},{guards:i}){return i.some(n=>iA(n,e,r,t))}function Z5e(t){function e(r,i){return!1}return e.check=Rdt,e.guards=t,e}function iA(t,e,r,i){let{machine:n}=i,o=typeof t=="function",s=o?t:n.implementations.guards[typeof t=="string"?t:t.type];if(!o&&!s)throw new Error(`Guard '${typeof t=="string"?t:t.type}' is not implemented.'.`);if(typeof s!="function")return iA(s,e,r,i);let a={context:e,event:r},u=o||typeof t=="string"?void 0:"params"in t?typeof t.params=="function"?t.params({context:e,event:r}):t.params:void 0;return"check"in s?s.check(i,a,s):s(a,u)}function y4(t){return Object.values(t.states).filter(e=>e.type!=="history")}function dR(t,e){let r=[];if(e===t)return r;let i=t.parent;for(;i&&i!==e;)r.push(i),i=i.parent;return r}function fR(t){let e=new Set(t),r=Q5e(e);for(let i of e)if(i.type==="compound"&&(!r.get(i)||!r.get(i).length))B5e(i).forEach(n=>e.add(n));else if(i.type==="parallel"){for(let n of y4(i))if(n.type!=="history"&&!e.has(n)){let o=B5e(n);for(let s of o)e.add(s)}}for(let i of e){let n=i.parent;for(;n;)e.add(n),n=n.parent}return e}function K5e(t,e){let r=e.get(t);if(!r)return{};if(t.type==="compound"){let n=r[0];if(n){if(Ore(n))return n.key}else return{}}let i={};for(let n of r)i[n.key]=K5e(n,e);return i}function Q5e(t){let e=new Map;for(let r of t)e.has(r)||e.set(r,[]),r.parent&&(e.has(r.parent)||e.set(r.parent,[]),e.get(r.parent).push(r));return e}function J5e(t,e){let r=fR(e);return K5e(t,Q5e(r))}function TU(t,e){return e.type==="compound"?y4(e).some(r=>r.type==="final"&&t.has(r)):e.type==="parallel"?y4(e).every(r=>TU(t,r)):e.type==="final"}function ePe(t,e){return t.transitions.get(e)||[...t.transitions.keys()].filter(i=>{if(i===mdt)return!0;if(!i.endsWith(".*"))return!1;let n=i.split("."),o=e.split(".");for(let s=0;s<n.length;s++){let a=n[s],u=o[s];if(a==="*")return s===n.length-1;if(a!==u)return!1}return!0}).sort((i,n)=>n.length-i.length).flatMap(i=>t.transitions.get(i))}function tPe(t){let e=t.config.after;if(!e)return[];let r=n=>{let o=gdt(n,t.id),s=o.type;return t.entry.push(bx(o,{id:s,delay:n})),t.exit.push(yx(s)),s};return Object.keys(e).flatMap(n=>{let o=e[n],s=typeof o=="string"?{target:o}:o,a=Number.isNaN(+n)?n:+n,u=r(a);return mp(s).map(p=>({...p,event:u,delay:a}))}).map(n=>{let{delay:o}=n;return{...ev(t,n.event,n),delay:o}})}function ev(t,e,r){let i=$5e(r.target),n=r.reenter??!1,o=Odt(t,i),s={...r,actions:mp(r.actions),guard:r.guard,target:o,source:t,reenter:n,eventType:e,toJSON:()=>({...s,source:`#${t.id}`,target:o?o.map(a=>`#${a.id}`):void 0})};return s}function rPe(t){let e=new Map;if(t.config.on)for(let r of Object.keys(t.config.on)){if(r===Ere)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');let i=t.config.on[r];e.set(r,px(i).map(n=>ev(t,r,n)))}if(t.config.onDone){let r=`xstate.done.state.${t.id}`;e.set(r,px(t.config.onDone).map(i=>ev(t,r,i)))}for(let r of t.invoke){if(r.onDone){let i=`xstate.done.actor.${r.id}`;e.set(i,px(r.onDone).map(n=>ev(t,i,n)))}if(r.onError){let i=`xstate.error.actor.${r.id}`;e.set(i,px(r.onError).map(n=>ev(t,i,n)))}if(r.onSnapshot){let i=`xstate.snapshot.${r.id}`;e.set(i,px(r.onSnapshot).map(n=>ev(t,i,n)))}}for(let r of t.after){let i=e.get(r.eventType);i||(i=[],e.set(r.eventType,i)),i.push(r)}return e}function iPe(t,e){let r=typeof e=="string"?t.states[e]:e?t.states[e.target]:void 0;if(!r&&e)throw new Error(`Initial state node "${e}" not found on parent state node #${t.id}`);let i={source:t,actions:!e||typeof e=="string"?[]:mp(e.actions),eventType:null,reenter:!1,target:r?[r]:[],toJSON:()=>({...i,source:`#${t.id}`,target:r?[`#${r.id}`]:[]})};return i}function Odt(t,e){if(e!==void 0)return e.map(r=>{if(typeof r!="string")return r;if(v4(r))return t.machine.getStateNodeById(r);let i=r[0]===Mre;if(i&&!t.parent)return uR(t,r.slice(1));let n=i?t.key+r:r;if(t.parent)try{return uR(t.parent,n)}catch(o){throw new Error(`Invalid transition definition for state node '${t.id}':
${o.message}`)}else throw new Error(`Invalid target: "${r}" is not a valid target from the root node. Did you mean ".${r}"?`)})}function nPe(t){let e=$5e(t.config.target);return e?{target:e.map(r=>typeof r=="string"?uR(t.parent,r):r)}:t.parent.initial}function mx(t){return t.type==="history"}function B5e(t){let e=Dre(t);for(let r of e)for(let i of dR(r,t))e.add(i);return e}function Dre(t){let e=new Set;function r(i){if(!e.has(i)){if(e.add(i),i.type==="compound")r(i.initial.target[0]);else if(i.type==="parallel")for(let n of y4(i))r(n)}}return r(t),e}function _4(t,e){if(v4(e))return t.machine.getStateNodeById(e);if(!t.states)throw new Error(`Unable to retrieve child state '${e}' from '${t.id}'; no child states exist.`);let r=t.states[e];if(!r)throw new Error(`Child state '${e}' does not exist on '${t.id}'`);return r}function uR(t,e){if(typeof e=="string"&&v4(e))try{return t.machine.getStateNodeById(e)}catch{}let r=wU(e).slice(),i=t;for(;r.length;){let n=r.shift();if(!n.length)break;i=_4(i,n)}return i}function vx(t,e){if(typeof e=="string"){let n=t.states[e];if(!n)throw new Error(`State '${e}' does not exist on '${t.id}'`);return[t,n]}let r=Object.keys(e),i=r.map(n=>_4(t,n)).filter(Boolean);return[t.machine.root,t].concat(i,r.reduce((n,o)=>{let s=_4(t,o);if(!s)return n;let a=vx(s,e[o]);return n.concat(a)},[]))}function Ddt(t,e,r,i){let o=_4(t,e).next(r,i);return!o||!o.length?t.next(r,i):o}function Ldt(t,e,r,i){let n=Object.keys(e),o=_4(t,n[0]),s=MU(o,e[n[0]],r,i);return!s||!s.length?t.next(r,i):s}function Bdt(t,e,r,i){let n=[];for(let o of Object.keys(e)){let s=e[o];if(!s)continue;let a=_4(t,o),u=MU(a,s,r,i);u&&n.push(...u)}return n.length?n:t.next(r,i)}function MU(t,e,r,i){return typeof e=="string"?Ddt(t,e,r,i):Object.keys(e).length===1?Ldt(t,e,r,i):Bdt(t,e,r,i)}function Fdt(t){return Object.keys(t.states).map(e=>t.states[e]).filter(e=>e.type==="history")}function rv(t,e){let r=t;for(;r.parent&&r.parent!==e;)r=r.parent;return r.parent===e}function Ndt(t,e){let r=new Set(t),i=new Set(e);for(let n of r)if(i.has(n))return!0;for(let n of i)if(r.has(n))return!0;return!1}function oPe(t,e,r){let i=new Set;for(let n of t){let o=!1,s=new Set;for(let a of i)if(Ndt(Tre([n],e,r),Tre([a],e,r)))if(rv(n.source,a.source))s.add(a);else{o=!0;break}if(!o){for(let a of s)i.delete(a);i.add(n)}}return Array.from(i)}function zdt(t){let[e,...r]=t;for(let i of dR(e,void 0))if(r.every(n=>rv(n,i)))return i}function Lre(t,e){if(!t.target)return[];let r=new Set;for(let i of t.target)if(mx(i))if(e[i.id])for(let n of e[i.id])r.add(n);else for(let n of Lre(nPe(i),e))r.add(n);else r.add(i);return[...r]}function sPe(t,e){let r=Lre(t,e);if(!r)return;if(!t.reenter&&r.every(n=>n===t.source||rv(n,t.source)))return t.source;let i=zdt(r.concat(t.source));if(i)return i;if(!t.reenter)return t.source.machine.root}function Tre(t,e,r){let i=new Set;for(let n of t)if(n.target?.length){let o=sPe(n,r);n.reenter&&n.source===o&&i.add(o);for(let s of e)rv(s,o)&&i.add(s)}return[...i]}function Udt(t,e){if(t.length!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;return!0}function bU(t,e,r,i,n,o){if(!t.length)return e;let s=new Set(e._nodes),a=e.historyValue,u=oPe(t,s,a),p=e;n||([p,a]=Wdt(p,i,r,u,s,a,o,r.actionExecutor)),p=Ax(p,i,r,u.flatMap(x=>x.actions),o,void 0),p=jdt(p,i,r,u,s,o,a,n);let m=[...s];p.status==="done"&&(p=Ax(p,i,r,m.sort((x,M)=>M.order-x.order).flatMap(x=>x.exit),o,void 0));try{return a===e.historyValue&&Udt(e._nodes,s)?p:iv(p,{_nodes:m,historyValue:a})}catch(x){throw x}}function Vdt(t,e,r,i,n){if(i.output===void 0)return;let o=wre(n.id,n.output!==void 0&&n.parent?Sre(n.output,t.context,e,r.self):void 0);return Sre(i.output,t.context,o,r.self)}function jdt(t,e,r,i,n,o,s,a){let u=t,p=new Set,m=new Set;$dt(i,s,m,p),a&&m.add(t.machine.root);let x=new Set;for(let M of[...p].sort((k,F)=>k.order-F.order)){n.add(M);let k=[];k.push(...M.entry);for(let F of M.invoke)k.push(_x(F.src,{...F,syncSnapshot:!!F.onSnapshot}));if(m.has(M)){let F=M.initial.actions;k.push(...F)}if(u=Ax(u,e,r,k,o,M.invoke.map(F=>F.id)),M.type==="final"){let F=M.parent,j=F?.type==="parallel"?F:F?.parent,H=j||M;for(F?.type==="compound"&&o.push(wre(F.id,M.output!==void 0?Sre(M.output,u.context,e,r.self):void 0));j?.type==="parallel"&&!x.has(j)&&TU(n,j);)x.add(j),o.push(wre(j.id)),H=j,j=j.parent;if(j)continue;u=iv(u,{status:"done",output:Vdt(u,e,r,u.machine.root,H)})}}return u}function $dt(t,e,r,i){for(let n of t){let o=sPe(n,e);for(let a of n.target||[])!mx(a)&&(n.source!==a||n.source!==o||n.reenter)&&(i.add(a),r.add(a)),A4(a,e,r,i);let s=Lre(n,e);for(let a of s){let u=dR(a,o);o?.type==="parallel"&&u.push(o),aPe(i,e,r,u,!n.source.parent&&n.reenter?void 0:o)}}}function A4(t,e,r,i){if(mx(t))if(e[t.id]){let n=e[t.id];for(let o of n)i.add(o),A4(o,e,r,i);for(let o of n)xre(o,t.parent,i,e,r)}else{let n=nPe(t);for(let o of n.target)i.add(o),n===t.parent?.initial&&r.add(t.parent),A4(o,e,r,i);for(let o of n.target)xre(o,t.parent,i,e,r)}else if(t.type==="compound"){let[n]=t.initial.target;mx(n)||(i.add(n),r.add(n)),A4(n,e,r,i),xre(n,t,i,e,r)}else if(t.type==="parallel")for(let n of y4(t).filter(o=>!mx(o)))[...i].some(o=>rv(o,n))||(mx(n)||(i.add(n),r.add(n)),A4(n,e,r,i))}function aPe(t,e,r,i,n){for(let o of i)if((!n||rv(o,n))&&t.add(o),o.type==="parallel")for(let s of y4(o).filter(a=>!mx(a)))[...t].some(a=>rv(a,s))||(t.add(s),A4(s,e,r,t))}function xre(t,e,r,i,n){aPe(r,i,n,dR(t,e))}function Wdt(t,e,r,i,n,o,s,a){let u=t,p=Tre(i,n,o);p.sort((x,M)=>M.order-x.order);let m;for(let x of p)for(let M of Fdt(x)){let k;M.history==="deep"?k=F=>Ore(F)&&rv(F,x):k=F=>F.parent===x,m??={...o},m[M.id]=Array.from(n).filter(k)}for(let x of p)u=Ax(u,e,r,[...x.exit,...x.invoke.map(M=>rA(M.id))],s,void 0),n.delete(x);return[u,m||o]}function Gdt(t,e){return t.implementations.actions[e]}function lPe(t,e,r,i,n,o){let{machine:s}=t,a=t;for(let u of i){let p=typeof u=="function",m=p?u:Gdt(s,typeof u=="string"?u:u.type),x={context:a.context,event:e,self:r.self,system:r.system},M=p||typeof u=="string"?void 0:"params"in u?typeof u.params=="function"?u.params({context:a.context,event:e}):u.params:void 0;if(!m||!("resolve"in m)){r.actionExecutor({type:typeof u=="string"?u:typeof u=="object"?u.type:u.name||"(anonymous)",info:x,params:M,exec:m});continue}let k=m,[F,j,H]=k.resolve(r,a,x,M,m,n);a=F,"retryResolve"in k&&o?.push([k,j]),"execute"in k&&r.actionExecutor({type:k.type,info:x,params:j,exec:k.execute.bind(null,r,j)}),H&&(a=lPe(a,e,r,H,n,o))}return a}function Ax(t,e,r,i,n,o){let s=o?[]:void 0,a=lPe(t,e,r,i,{internalQueue:n,deferredActorIds:o},s);return s?.forEach(([u,p])=>{u.retryResolve(r,a,p)}),a}function EU(t,e,r,i){let n=t,o=[];function s(p,m,x){r.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:r.self,event:m,snapshot:p,_transitions:x}),o.push(p)}if(e.type===tv)return n=iv(F5e(n,e,r),{status:"stopped"}),s(n,e,[]),{snapshot:n,microstates:o};let a=e;if(a.type!==z5e){let p=a,m=_dt(p),x=N5e(p,n);if(m&&!x.length)return n=iv(t,{status:"error",error:p.error}),s(n,p,[]),{snapshot:n,microstates:o};n=bU(x,t,r,a,!1,i),s(n,p,x)}let u=!0;for(;n.status==="active";){let p=u?Hdt(n,a):[],m=p.length?n:void 0;if(!p.length){if(!i.length)break;a=i.shift(),p=N5e(a,n)}n=bU(p,n,r,a,!1,i),u=n!==m,s(n,a,p)}return n.status!=="active"&&F5e(n,a,r),{snapshot:n,microstates:o}}function F5e(t,e,r){return Ax(t,e,r,Object.values(t.children).map(i=>rA(i)),[],void 0)}function N5e(t,e){return e.machine.getTransitionData(e,t)}function Hdt(t,e){let r=new Set,i=t._nodes.filter(Ore);for(let n of i)e:for(let o of[n].concat(dR(n,void 0)))if(o.always){for(let s of o.always)if(s.guard===void 0||iA(s.guard,t.context,e,t)){r.add(s);break e}}return oPe(Array.from(r),new Set(t._nodes),t.historyValue)}function cPe(t,e){let r=fR(vx(t,e));return J5e(t,[...r])}function Bre(t){return!!t&&typeof t=="object"&&"machine"in t&&"value"in t}function pR(t,e){return{status:t.status,output:t.output,error:t.error,machine:e,context:t.context,_nodes:t._nodes,value:J5e(e.root,t._nodes),tags:new Set(t._nodes.flatMap(r=>r.tags)),children:t.children,historyValue:t.historyValue||{},matches:qdt,hasTag:Ydt,can:Xdt,getMeta:Kdt,toJSON:Zdt}}function iv(t,e={}){return pR({...t,...e},t.machine)}function Qdt(t){if(typeof t!="object"||t===null)return{};let e={};for(let r in t){let i=t[r];Array.isArray(i)&&(e[r]=i.map(n=>({id:n.id})))}return e}function uPe(t,e){let{_nodes:r,tags:i,machine:n,children:o,context:s,can:a,hasTag:u,matches:p,getMeta:m,toJSON:x,...M}=t,k={};for(let j in o){let H=o[j];k[j]={snapshot:H.getPersistedSnapshot(e),src:H.src,systemId:H.systemId,syncSnapshot:H._syncSnapshot}}return{...M,context:hPe(s),children:k,historyValue:Qdt(M.historyValue)}}function hPe(t){let e;for(let r in t){let i=t[r];if(i&&typeof i=="object")if("sessionId"in i&&"send"in i&&"ref"in i)e??=Array.isArray(t)?t.slice():{...t},e[r]={xstate$$type:SU,id:i.id};else{let n=hPe(i);n!==i&&(e??=Array.isArray(t)?t.slice():{...t},e[r]=n)}}return e??t}function Jdt(t,e,r,i,{event:n,id:o,delay:s},{internalQueue:a}){let u=e.machine.implementations.delays;if(typeof n=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${n}" }) instead`);let p=typeof n=="function"?n(r,i):n,m;if(typeof s=="string"){let x=u&&u[s];m=typeof x=="function"?x(r,i):x}else m=typeof s=="function"?s(r,i):s;return typeof m!="number"&&a.push(p),[e,{event:p,id:o,delay:m},void 0]}function eft(t,e){let{event:r,delay:i,id:n}=e;if(typeof i=="number"){t.defer(()=>{let o=t.self;t.system.scheduler.schedule(o,o,r,i,n)});return}}function bx(t,e){function r(i,n){}return r.type="xstate.raise",r.event=t,r.id=e?.id,r.delay=e?.delay,r.resolve=Jdt,r.execute=eft,r}var vU,Mre,fdt,Ere,pdt,mdt,z5e,U5e,tv,ydt,vdt,bre,SU,tu,xdt,cR,G5e,H5e,Ore,v4,qdt,Ydt,Xdt,Zdt,Kdt,xx=ve(()=>{_U();vU=class{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){let r={value:e,next:null};if(this._current){this._last.next=r,this._last=r;return}this._current=r,this._last=r,this._active&&this.flush()}flush(){for(;this._current;){let e=this._current;this._process(e.value),this._current=e.next}this._last=null}},Mre=".",fdt="",Ere="",pdt="#",mdt="*",z5e="xstate.init",U5e="xstate.error",tv="xstate.stop";ydt=typeof Symbol=="function"&&Symbol.observable||"@@observable";vdt=0;bre=!1,SU=1,tu=(function(t){return t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped",t})({}),xdt={clock:{setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t)},logger:console.log.bind(console),devTools:!1},cR=class{constructor(e,r){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new vU(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=tu.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this.systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];let i={...xdt,...r},{clock:n,logger:o,parent:s,syncSnapshot:a,id:u,systemId:p,inspect:m}=i;this.system=s?s.system:bdt(this,{clock:n,logger:o}),m&&!s&&this.system.inspect(gx(m)),this.sessionId=this.system._bookId(),this.id=u??this.sessionId,this.logger=r?.logger??this.system._logger,this.clock=r?.clock??this.system._clock,this._parent=s,this._syncSnapshot=a,this.options=i,this.src=i.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:x=>{this._deferred.push(x)},system:this.system,stopChild:x=>{if(x._parent!==this)throw new Error(`Cannot stop child actor ${x.id} of ${this.id} because it is not a child`);x._stop()},emit:x=>{let M=this.eventListeners.get(x.type),k=this.eventListeners.get("*");if(!M&&!k)return;let F=[...M?M.values():[],...k?k.values():[]];for(let j of F)try{j(x)}catch(H){Q0(H)}},actionExecutor:x=>{let M=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:x.type,params:x.params}}),!x.exec)return;let k=bre;try{bre=!0,x.exec(x.info,x.params)}finally{bre=k}};this._processingStatus===tu.Running?M():this._deferred.push(M)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),p&&(this.systemId=p,this.system._set(p,this)),this._initState(r?.snapshot??r?.state),p&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(e){try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(r){this._snapshot={status:"error",output:void 0,error:r}}}update(e,r){this._snapshot=e;let i;for(;i=this._deferred.shift();)try{i()}catch(n){this._deferred.length=0,this._snapshot={...e,status:"error",error:n}}switch(this._snapshot.status){case"active":for(let n of this.observers)try{n.next?.(e)}catch(o){Q0(o)}break;case"done":for(let n of this.observers)try{n.next?.(e)}catch(o){Q0(o)}this._stopProcedure(),this._complete(),this._doneEvent=Adt(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:r,snapshot:e})}subscribe(e,r,i){let n=gx(e,r,i);if(this._processingStatus!==tu.Stopped)this.observers.add(n);else switch(this._snapshot.status){case"done":try{n.complete?.()}catch(o){Q0(o)}break;case"error":{let o=this._snapshot.error;if(!n.error)Q0(o);else try{n.error(o)}catch(s){Q0(s)}break}}return{unsubscribe:()=>{this.observers.delete(n)}}}on(e,r){let i=this.eventListeners.get(e);i||(i=new Set,this.eventListeners.set(e,i));let n=r.bind(void 0);return i.add(n),{unsubscribe:()=>{i.delete(n)}}}start(){if(this._processingStatus===tu.Running)return this;this._syncSnapshot&&this.subscribe({next:i=>{i.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:i})},error:()=>{}}),this.system._register(this.sessionId,this),this.systemId&&this.system._set(this.systemId,this),this._processingStatus=tu.Running;let e=Pre(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(i){return this._snapshot={...this._snapshot,status:"error",error:i},this._error(i),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let r,i;try{r=this.logic.transition(this._snapshot,e,this._actorScope)}catch(n){i={err:n}}if(i){let{err:n}=i;this._snapshot={...this._snapshot,status:"error",error:n},this._error(n);return}this.update(r,e),e.type===tv&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===tu.Stopped?this:(this.mailbox.clear(),this._processingStatus===tu.NotStarted?(this._processingStatus=tu.Stopped,this):(this.mailbox.enqueue({type:tv}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(let e of this.observers)try{e.complete?.()}catch(r){Q0(r)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||Q0(e);return}let r=!1;for(let i of this.observers){let n=i.error;r||=!n;try{n?.(e)}catch(o){Q0(o)}}this.observers.clear(),r&&Q0(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,Cre(this.id,e))}_stopProcedure(){return this._processingStatus!==tu.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new vU(this._process.bind(this)),this._processingStatus=tu.Stopped,this.system._unregister(this),this)}_send(e){this._processingStatus!==tu.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){let{devTools:e}=this.options;e&&(typeof e=="function"?e:O5e)(this)}toJSON(){return{xstate$$type:SU,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[ydt](){return this}getSnapshot(){return this._snapshot}};G5e=pc;H5e=rA;Ore=t=>t.type==="atomic"||t.type==="final";v4=t=>t[0]===pdt;qdt=function(e){return xU(e,this.value)},Ydt=function(e){return this.tags.has(e)},Xdt=function(e){let r=this.machine.getTransitionData(this,e);return!!r?.length&&r.some(i=>i.target!==void 0||i.actions.length)},Zdt=function(){let{_nodes:e,tags:r,machine:i,getMeta:n,toJSON:o,can:s,hasTag:a,matches:u,...p}=this;return{...p,tags:Array.from(r)}},Kdt=function(){return this._nodes.reduce((e,r)=>(r.meta!==void 0&&(e[r.id]=r.meta),e),{})}});function Fre(t,e){return{config:t,transition:(r,i,n)=>({...r,context:t(r.context,i,n)}),getInitialSnapshot:(r,i)=>({status:"active",output:void 0,error:void 0,context:typeof e=="function"?e({input:i}):e}),getPersistedSnapshot:r=>r,restoreSnapshot:r=>r}}function gPe(t){return{config:t,start:(r,i)=>{let{self:n,system:o,emit:s}=i,a={receivers:void 0,dispose:void 0};dPe.set(n,a),a.dispose=t({input:r.input,system:o,self:n,sendBack:u=>{n.getSnapshot().status!=="stopped"&&n._parent&&o._relay(n,n._parent,u)},receive:u=>{a.receivers??=new Set,a.receivers.add(u)},emit:s})},transition:(r,i,n)=>{let o=dPe.get(n.self);return i.type===tv?(r={...r,status:"stopped",error:void 0},o.dispose?.(),r):(o.receivers?.forEach(s=>s(i)),r)},getInitialSnapshot:(r,i)=>({status:"active",output:void 0,error:void 0,input:i}),getPersistedSnapshot:r=>r,restoreSnapshot:r=>r}}function APe(t){return{config:t,transition:(r,i)=>{if(r.status!=="active")return r;switch(i.type){case fPe:return{...r,context:i.data};case PU:return{...r,status:"error",error:i.data,input:void 0,_subscription:void 0};case IU:return{...r,status:"done",input:void 0,_subscription:void 0};case tv:return r._subscription.unsubscribe(),{...r,status:"stopped",input:void 0,_subscription:void 0};default:return r}},getInitialSnapshot:(r,i)=>({status:"active",output:void 0,error:void 0,context:void 0,input:i,_subscription:void 0}),start:(r,{self:i,system:n,emit:o})=>{r.status!=="done"&&(r._subscription=t({input:r.input,system:n,self:i,emit:o}).subscribe({next:s=>{n._relay(i,i,{type:fPe,data:s})},error:s=>{n._relay(i,i,{type:PU,data:s})},complete:()=>{n._relay(i,i,{type:IU})}}))},getPersistedSnapshot:({_subscription:r,...i})=>i,restoreSnapshot:r=>({...r,_subscription:void 0})}}function yPe(t){return{config:t,transition:(r,i)=>{if(r.status!=="active")return r;switch(i.type){case PU:return{...r,status:"error",error:i.data,input:void 0,_subscription:void 0};case IU:return{...r,status:"done",input:void 0,_subscription:void 0};case tv:return r._subscription.unsubscribe(),{...r,status:"stopped",input:void 0,_subscription:void 0};default:return r}},getInitialSnapshot:(r,i)=>({status:"active",output:void 0,error:void 0,context:void 0,input:i,_subscription:void 0}),start:(r,{self:i,system:n,emit:o})=>{r.status!=="done"&&(r._subscription=t({input:r.input,system:n,self:i,emit:o}).subscribe({next:s=>{i._parent&&n._relay(i,i._parent,s)},error:s=>{n._relay(i,i,{type:PU,data:s})},complete:()=>{n._relay(i,i,{type:IU})}}))},getPersistedSnapshot:({_subscription:r,...i})=>i,restoreSnapshot:r=>({...r,_subscription:void 0})}}function _Pe(t){return{config:t,transition:(r,i,n)=>{if(r.status!=="active")return r;switch(i.type){case pPe:{let o=i.data;return{...r,status:"done",output:o,input:void 0}}case mPe:return{...r,status:"error",error:i.data,input:void 0};case tv:return CU.get(n.self)?.abort(),{...r,status:"stopped",input:void 0};default:return r}},start:(r,{self:i,system:n,emit:o})=>{if(r.status!=="active")return;let s=new AbortController;CU.set(i,s),Promise.resolve(t({input:r.input,system:n,self:i,signal:s.signal,emit:o})).then(u=>{i.getSnapshot().status==="active"&&(CU.delete(i),n._relay(i,i,{type:pPe,data:u}))},u=>{i.getSnapshot().status==="active"&&(CU.delete(i),n._relay(i,i,{type:mPe,data:u}))})},getInitialSnapshot:(r,i)=>({status:"active",output:void 0,error:void 0,input:i}),getPersistedSnapshot:r=>r,restoreSnapshot:r=>r}}function vPe(){return pc(tft)}var dPe,fPe,PU,IU,pPe,mPe,CU,tft,bPe=ve(()=>{xx();_U();dPe=new WeakMap;fPe="xstate.observable.next",PU="xstate.observable.error",IU="xstate.observable.complete";pPe="xstate.promise.resolve",mPe="xstate.promise.reject",CU=new WeakMap;tft=Fre(t=>{},void 0)});function rft(t,{machine:e,context:r},i,n){let o=(s,a)=>{if(typeof s=="string"){let u=hR(e,s);if(!u)throw new Error(`Actor logic '${s}' not implemented in machine '${e.id}'`);let p=pc(u,{id:a?.id,parent:t.self,syncSnapshot:a?.syncSnapshot,input:typeof a?.input=="function"?a.input({context:r,event:i,self:t.self}):a?.input,src:s,systemId:a?.systemId});return n[p.id]=p,p}else return pc(s,{id:a?.id,parent:t.self,syncSnapshot:a?.syncSnapshot,input:a?.input,src:s,systemId:a?.systemId})};return(s,a)=>{let u=o(s,a);return n[u.id]=u,t.defer(()=>{u._processingStatus!==tu.Stopped&&u.start()}),u}}function ift(t,e,r,i,{assignment:n}){if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");let o={},s={context:e.context,event:r.event,spawn:rft(t,e,r.event,o),self:t.self,system:t.system},a={};if(typeof n=="function")a=n(s,i);else for(let p of Object.keys(n)){let m=n[p];a[p]=typeof m=="function"?m(s,i):m}let u=Object.assign({},e.context,a);return[iv(e,{context:u,children:Object.keys(o).length?{...e.children,...o}:e.children}),void 0,void 0]}function ju(t){function e(r,i){}return e.type="xstate.assign",e.assignment=t,e.resolve=ift,e}var mR=ve(()=>{xx()});function b4(t,e,r){let i=xPe.get(t);return i?e in i||(i[e]=r()):(i={[e]:r()},xPe.set(t,i)),i[e]}var xPe,nft,gR,x4,oft,w4,Nre=ve(()=>{xx();mR();xPe=new WeakMap;nft={},gR=t=>typeof t=="string"?{type:t}:typeof t=="function"?"resolve"in t?{type:t.type}:{type:t.name}:t,x4=class t{constructor(e,r){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=r._parent,this.key=r._key,this.machine=r._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(Mre),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?kre(this.config.states,(i,n)=>new t(i,{_parent:this,_key:n,_machine:this.machine})):nft,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=mp(this.config.entry).slice(),this.exit=mp(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=mp(e.tags).slice()}_initialize(){this.transitions=rPe(this),this.config.always&&(this.always=px(this.config.always).map(e=>ev(this,Ere,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(gR),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(gR),eventType:null})}:void 0,history:this.history,states:kre(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(gR)})),entry:this.entry.map(gR),exit:this.exit.map(gR),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return b4(this,"invoke",()=>mp(this.config.invoke).map((e,r)=>{let{src:i,systemId:n}=e,o=e.id??Rre(this.id,r),s=typeof i=="string"?i:`xstate.invoke.${Rre(this.id,r)}`;return{...e,src:s,id:o,systemId:n,toJSON(){let{onDone:a,onError:u,...p}=e;return{...p,type:"xstate.invoke",src:s,id:o}}}}))}get on(){return b4(this,"on",()=>[...this.transitions].flatMap(([r,i])=>i.map(n=>[r,n])).reduce((r,[i,n])=>(r[i]=r[i]||[],r[i].push(n),r),{}))}get after(){return b4(this,"delayedTransitions",()=>tPe(this))}get initial(){return b4(this,"initial",()=>iPe(this,this.config.initial))}next(e,r){let i=r.type,n=[],o,s=b4(this,`candidates-${i}`,()=>ePe(this,i));for(let a of s){let{guard:u}=a,p=e.context,m=!1;try{m=!u||iA(u,p,r,e)}catch(x){let M=typeof u=="string"?u:typeof u=="object"?u.type:void 0;throw new Error(`Unable to evaluate guard ${M?`'${M}' `:""}in transition for event '${i}' in state node '${this.id}':
${x.message}`)}if(m){n.push(...a.actions),o=a;break}}return o?[o]:void 0}get events(){return b4(this,"events",()=>{let{states:e}=this,r=new Set(this.ownEvents);if(e)for(let i of Object.keys(e)){let n=e[i];if(n.states)for(let o of n.events)r.add(`${o}`)}return Array.from(r)})}get ownEvents(){let e=new Set([...this.transitions.keys()].filter(r=>this.transitions.get(r).some(i=>!(!i.target&&!i.actions.length&&!i.reenter))));return Array.from(e)}},oft="#",w4=class t{constructor(e,r){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:r?.actors??{},actions:r?.actions??{},delays:r?.delays??{},guards:r?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new x4(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){let{actions:r,guards:i,actors:n,delays:o}=this.implementations;return new t(this.config,{actions:{...r,...e.actions},guards:{...i,...e.guards},actors:{...n,...e.actors},delays:{...o,...e.delays}})}resolveState(e){let r=cPe(this.root,e.value),i=fR(vx(this.root,r));return pR({_nodes:[...i],context:e.context||{},children:{},status:TU(i,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,r,i){return EU(e,r,i,[]).snapshot}microstep(e,r,i){return EU(e,r,i,[]).microstates}getTransitionData(e,r){return MU(this.root,e.value,e,r)||[]}getPreInitialState(e,r,i){let{context:n}=this.config,o=pR({context:typeof n!="function"&&n?n:{},_nodes:[this.root],children:{},status:"active"},this);return typeof n=="function"?Ax(o,r,e,[ju(({spawn:a,event:u,self:p})=>n({spawn:a,input:u.input,self:p}))],i,void 0):o}getInitialSnapshot(e,r){let i=Pre(r),n=[],o=this.getPreInitialState(e,i,n),s=bU([{target:[...Dre(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],o,e,i,!0,n),{snapshot:a}=EU(s,i,e,n);return a}start(e){Object.values(e.children).forEach(r=>{r.getSnapshot().status==="active"&&r.start()})}getStateNodeById(e){let r=wU(e),i=r.slice(1),n=v4(r[0])?r[0].slice(oft.length):r[0],o=this.idMap.get(n);if(!o)throw new Error(`Child state node '#${n}' does not exist on machine '${this.id}'`);return uR(o,i)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,r){return uPe(e,r)}restoreSnapshot(e,r){let i={},n=e.children;Object.keys(n).forEach(x=>{let M=n[x],k=M.snapshot,F=M.src,j=typeof F=="string"?hR(this,F):F;if(!j)return;let H=pc(j,{id:x,parent:r.self,syncSnapshot:M.syncSnapshot,snapshot:k,src:F,systemId:M.systemId});i[x]=H});function o(x,M){if(M instanceof x4)return M;try{return x.machine.getStateNodeById(M.id)}catch{}}function s(x,M){if(!M||typeof M!="object")return{};let k={};for(let F in M){let j=M[F];for(let H of j){let W=o(x,H);W&&(k[F]??=[],k[F].push(W))}}return k}let a=s(this.root,e.historyValue),u=pR({...e,children:i,_nodes:Array.from(fR(vx(this.root,e.value))),historyValue:a},this),p=new Set;function m(x,M){if(!p.has(x)){p.add(x);for(let k in x){let F=x[k];if(F&&typeof F=="object"){if("xstate$$type"in F&&F.xstate$$type===SU){x[k]=M[F.id];continue}m(F,M)}}}}return m(u.context,i),u}}});function sft(t,e,r,i,{event:n}){let o=typeof n=="function"?n(r,i):n;return[e,{event:o},void 0]}function aft(t,{event:e}){t.defer(()=>t.emit(e))}function yR(t){function e(r,i){}return e.type="xstate.emit",e.event=t,e.resolve=sft,e.execute=aft,e}function lft(t,e,r,i,{to:n,event:o,id:s,delay:a},u){let p=e.machine.implementations.delays;if(typeof o=="string")throw new Error(`Only event objects may be used with sendTo; use sendTo({ type: "${o}" }) instead`);let m=typeof o=="function"?o(r,i):o,x;if(typeof a=="string"){let F=p&&p[a];x=typeof F=="function"?F(r,i):F}else x=typeof a=="function"?a(r,i):a;let M=typeof n=="function"?n(r,i):n,k;if(typeof M=="string"){if(M===AR.Parent?k=t.self._parent:M===AR.Internal?k=t.self:M.startsWith("#_")?k=e.children[M.slice(2)]:k=u.deferredActorIds?.includes(M)?M:e.children[M],!k)throw new Error(`Unable to send event to actor '${M}' from machine '${e.machine.id}'.`)}else k=M||t.self;return[e,{to:k,targetId:typeof M=="string"?M:void 0,event:m,id:s,delay:x},void 0]}function cft(t,e,r){typeof r.to=="string"&&(r.to=e.children[r.to])}function uft(t,e){t.defer(()=>{let{to:r,event:i,delay:n,id:o}=e;if(typeof n=="number"){t.system.scheduler.schedule(t.self,r,i,n,o);return}t.system._relay(t.self,r,i.type===U5e?Cre(t.self.id,i.data):i)})}function wx(t,e,r){function i(n,o){}return i.type="xstate.sendTo",i.to=t,i.event=e,i.id=r?.id,i.delay=r?.delay,i.resolve=lft,i.retryResolve=cft,i.execute=uft,i}function zre(t,e){return wx(AR.Parent,t,e)}function wPe(t,e){return wx(t,({event:r})=>r,e)}function hft(t,e,r,i,{collect:n}){let o=[],s=function(u){o.push(u)};return s.assign=(...a)=>{o.push(ju(...a))},s.cancel=(...a)=>{o.push(yx(...a))},s.raise=(...a)=>{o.push(bx(...a))},s.sendTo=(...a)=>{o.push(wx(...a))},s.sendParent=(...a)=>{o.push(zre(...a))},s.spawnChild=(...a)=>{o.push(_x(...a))},s.stopChild=(...a)=>{o.push(rA(...a))},s.emit=(...a)=>{o.push(yR(...a))},n({context:r.context,event:r.event,enqueue:s,check:a=>iA(a,e.context,r.event,e),self:t.self,system:t.system},i),[e,void 0,o]}function kU(t){function e(r,i){}return e.type="xstate.enqueueActions",e.collect=t,e.resolve=hft,e}function dft(t,e,r,i,{value:n,label:o}){return[e,{value:typeof n=="function"?n(r,i):n,label:o},void 0]}function fft({logger:t},{value:e,label:r}){r?t(r,e):t(e)}function RU(t=({context:r,event:i})=>({context:r,event:i}),e){function r(i,n){}return r.type="xstate.log",r.value=t,r.label=e,r.resolve=dft,r.execute=fft,r}var AR,Ure=ve(()=>{xx();mR();AR=(function(t){return t.Parent="#_parent",t.Internal="#_internal",t})({})});var jre={};nl(jre,{Actor:()=>cR,SimulatedClock:()=>Vre,SpecialTargets:()=>AR,StateMachine:()=>w4,StateNode:()=>x4,__unsafe_getAllOwnEventDescriptors:()=>W5e,and:()=>X5e,assertEvent:()=>pft,assign:()=>ju,cancel:()=>yx,createActor:()=>pc,createEmptyActor:()=>vPe,createMachine:()=>OU,emit:()=>yR,enqueueActions:()=>kU,forwardTo:()=>wPe,fromCallback:()=>gPe,fromEventObservable:()=>yPe,fromObservable:()=>APe,fromPromise:()=>_Pe,fromTransition:()=>Fre,getInitialSnapshot:()=>mft,getNextSnapshot:()=>gft,getStateNodes:()=>vx,initialTransition:()=>vft,interpret:()=>G5e,isMachineSnapshot:()=>Bre,log:()=>RU,matchesState:()=>xU,not:()=>Y5e,or:()=>Z5e,pathToStateValue:()=>Ire,raise:()=>bx,sendParent:()=>zre,sendTo:()=>wx,setup:()=>Aft,spawnChild:()=>_x,stateIn:()=>q5e,stop:()=>H5e,stopChild:()=>rA,toObserver:()=>gx,toPromise:()=>yft,transition:()=>_ft,waitFor:()=>xft});function pft(t,e){let r=mp(e);if(!r.includes(t.type)){let i=r.length===1?`type "${r[0]}"`:`one of types "${r.join('", "')}"`;throw new Error(`Expected event ${JSON.stringify(t)} to have ${i}`)}}function OU(t,e){return new w4(t,e)}function DU(t){let e=pc(t);return{self:e,defer:()=>{},id:"",logger:()=>{},sessionId:"",stopChild:()=>{},system:e.system,emit:()=>{},actionExecutor:()=>{}}}function mft(t,...[e]){let r=DU(t);return t.getInitialSnapshot(r,e)}function gft(t,e,r){let i=DU(t);return i.self._snapshot=e,t.transition(e,r,i)}function Aft({schemas:t,actors:e,actions:r,guards:i,delays:n}){return{assign:ju,sendTo:wx,raise:bx,log:RU,cancel:yx,stopChild:rA,enqueueActions:kU,emit:yR,spawnChild:_x,createStateConfig:o=>o,createAction:o=>o,createMachine:o=>OU({...o,schemas:t},{actors:e,actions:r,guards:i,delays:n})}}function yft(t){return new Promise((e,r)=>{t.subscribe({complete:()=>{e(t.getSnapshot().output)},error:r})})}function _ft(t,e,r){let i=[],n=DU(t);return n.actionExecutor=s=>{i.push(s)},[t.transition(e,r,n),i]}function vft(t,...[e]){let r=[],i=DU(t);return i.actionExecutor=o=>{r.push(o)},[t.getInitialSnapshot(i,e),r]}function xft(t,e,r){let i={...bft,...r};return new Promise((n,o)=>{let{signal:s}=i;if(s?.aborted){o(s.reason);return}let a=!1,u=i.timeout===1/0?void 0:setTimeout(()=>{p(),o(new Error(`Timeout of ${i.timeout} ms exceeded`))},i.timeout),p=()=>{clearTimeout(u),a=!0,M?.unsubscribe(),x&&s.removeEventListener("abort",x)};function m(k){e(k)&&(p(),n(k))}let x,M;m(t.getSnapshot()),!a&&(s&&(x=()=>{p(),o(s.reason)},s.addEventListener("abort",x)),M=t.subscribe({next:m,error:k=>{p(),o(k)},complete:()=>{p(),o(new Error("Actor terminated without satisfying predicate"))}}),a&&M.unsubscribe())})}var Vre,bft,_R=ve(()=>{bPe();xx();xx();Nre();Nre();mR();mR();Ure();Ure();_U();Vre=class{constructor(){this.timeouts=new Map,this._now=0,this._id=0,this._flushing=!1,this._flushingInvalidated=!1}now(){return this._now}getId(){return this._id++}setTimeout(e,r){this._flushingInvalidated=this._flushing;let i=this.getId();return this.timeouts.set(i,{start:this.now(),timeout:r,fn:e}),i}clearTimeout(e){this._flushingInvalidated=this._flushing,this.timeouts.delete(e)}set(e){if(this._now>e)throw new Error("Unable to travel back in time");this._now=e,this.flushTimeouts()}flushTimeouts(){if(this._flushing){this._flushingInvalidated=!0;return}this._flushing=!0;let e=[...this.timeouts].sort(([r,i],[n,o])=>{let s=i.start+i.timeout;return o.start+o.timeout>s?-1:1});for(let[r,i]of e){if(this._flushingInvalidated){this._flushingInvalidated=!1,this._flushing=!1,this.flushTimeouts();return}this.now()-i.start>=i.timeout&&(this.timeouts.delete(r),i.fn.call(null))}this._flushing=!1}increment(e){this._now+=e,this.flushTimeouts()}};bft={timeout:1/0}});var qre=nr((Hre,MPe)=>{"use strict";var{hasOwnProperty:vR}=Object.prototype,Tx=Gre();Tx.configure=Gre;Tx.stringify=Tx;Tx.default=Tx;Hre.stringify=Tx;Hre.configure=Gre;MPe.exports=Tx;var wft=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function nv(t){return t.length<5e3&&!wft.test(t)?`"${t}"`:JSON.stringify(t)}function $re(t,e){if(t.length>200||e)return t.sort(e);for(let r=1;r<t.length;r++){let i=t[r],n=r;for(;n!==0&&t[n-1]>i;)t[n]=t[n-1],n--;t[n]=i}return t}var Sft=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function Wre(t){return Sft.call(t)!==void 0&&t.length!==0}function SPe(t,e,r){t.length<r&&(r=t.length);let i=e===","?"":" ",n=`"0":${i}${t[0]}`;for(let o=1;o<r;o++)n+=`${e}"${o}":${i}${t[o]}`;return n}function Tft(t){if(vR.call(t,"circularValue")){let e=t.circularValue;if(typeof e=="string")return`"${e}"`;if(e==null)return e;if(e===Error||e===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function Mft(t){let e;if(vR.call(t,"deterministic")&&(e=t.deterministic,typeof e!="boolean"&&typeof e!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return e===void 0?!0:e}function Eft(t,e){let r;if(vR.call(t,e)&&(r=t[e],typeof r!="boolean"))throw new TypeError(`The "${e}" argument must be of type boolean`);return r===void 0?!0:r}function TPe(t,e){let r;if(vR.call(t,e)){if(r=t[e],typeof r!="number")throw new TypeError(`The "${e}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${e}" argument must be an integer`);if(r<1)throw new RangeError(`The "${e}" argument must be >= 1`)}return r===void 0?1/0:r}function Sx(t){return t===1?"1 item":`${t} items`}function Cft(t){let e=new Set;for(let r of t)(typeof r=="string"||typeof r=="number")&&e.add(String(r));return e}function Pft(t){if(vR.call(t,"strict")){let e=t.strict;if(typeof e!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(e)return r=>{let i=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(i+=` (${r.toString()})`),new Error(i)}}}function Gre(t){t={...t};let e=Pft(t);e&&(t.bigint===void 0&&(t.bigint=!1),"circularValue"in t||(t.circularValue=Error));let r=Tft(t),i=Eft(t,"bigint"),n=Mft(t),o=typeof n=="function"?n:void 0,s=TPe(t,"maximumDepth"),a=TPe(t,"maximumBreadth");function u(k,F,j,H,W,Z){let Y=F[k];switch(typeof Y=="object"&&Y!==null&&typeof Y.toJSON=="function"&&(Y=Y.toJSON(k)),Y=H.call(F,k,Y),typeof Y){case"string":return nv(Y);case"object":{if(Y===null)return"null";if(j.indexOf(Y)!==-1)return r;let ee="",ce=",",ge=Z;if(Array.isArray(Y)){if(Y.length===0)return"[]";if(s<j.length+1)return'"[Array]"';j.push(Y),W!==""&&(Z+=W,ee+=`
${Z}`,ce=`,
${Z}`);let We=Math.min(Y.length,a),ze=0;for(;ze<We-1;ze++){let at=u(String(ze),Y,j,H,W,Z);ee+=at!==void 0?at:"null",ee+=ce}let rt=u(String(ze),Y,j,H,W,Z);if(ee+=rt!==void 0?rt:"null",Y.length-1>a){let at=Y.length-a-1;ee+=`${ce}"... ${Sx(at)} not stringified"`}return W!==""&&(ee+=`
${ge}`),j.pop(),`[${ee}]`}let Se=Object.keys(Y),ne=Se.length;if(ne===0)return"{}";if(s<j.length+1)return'"[Object]"';let pe="",ue="";W!==""&&(Z+=W,ce=`,
${Z}`,pe=" ");let Le=Math.min(ne,a);n&&!Wre(Y)&&(Se=$re(Se,o)),j.push(Y);for(let We=0;We<Le;We++){let ze=Se[We],rt=u(ze,Y,j,H,W,Z);rt!==void 0&&(ee+=`${ue}${nv(ze)}:${pe}${rt}`,ue=ce)}if(ne>a){let We=ne-a;ee+=`${ue}"...":${pe}"${Sx(We)} not stringified"`,ue=ce}return W!==""&&ue.length>1&&(ee=`
${Z}${ee}
${ge}`),j.pop(),`{${ee}}`}case"number":return isFinite(Y)?String(Y):e?e(Y):"null";case"boolean":return Y===!0?"true":"false";case"undefined":return;case"bigint":if(i)return String(Y);default:return e?e(Y):void 0}}function p(k,F,j,H,W,Z){switch(typeof F=="object"&&F!==null&&typeof F.toJSON=="function"&&(F=F.toJSON(k)),typeof F){case"string":return nv(F);case"object":{if(F===null)return"null";if(j.indexOf(F)!==-1)return r;let Y=Z,ee="",ce=",";if(Array.isArray(F)){if(F.length===0)return"[]";if(s<j.length+1)return'"[Array]"';j.push(F),W!==""&&(Z+=W,ee+=`
${Z}`,ce=`,
${Z}`);let ne=Math.min(F.length,a),pe=0;for(;pe<ne-1;pe++){let Le=p(String(pe),F[pe],j,H,W,Z);ee+=Le!==void 0?Le:"null",ee+=ce}let ue=p(String(pe),F[pe],j,H,W,Z);if(ee+=ue!==void 0?ue:"null",F.length-1>a){let Le=F.length-a-1;ee+=`${ce}"... ${Sx(Le)} not stringified"`}return W!==""&&(ee+=`
${Y}`),j.pop(),`[${ee}]`}j.push(F);let ge="";W!==""&&(Z+=W,ce=`,
${Z}`,ge=" ");let Se="";for(let ne of H){let pe=p(ne,F[ne],j,H,W,Z);pe!==void 0&&(ee+=`${Se}${nv(ne)}:${ge}${pe}`,Se=ce)}return W!==""&&Se.length>1&&(ee=`
${Z}${ee}
${Y}`),j.pop(),`{${ee}}`}case"number":return isFinite(F)?String(F):e?e(F):"null";case"boolean":return F===!0?"true":"false";case"undefined":return;case"bigint":if(i)return String(F);default:return e?e(F):void 0}}function m(k,F,j,H,W){switch(typeof F){case"string":return nv(F);case"object":{if(F===null)return"null";if(typeof F.toJSON=="function"){if(F=F.toJSON(k),typeof F!="object")return m(k,F,j,H,W);if(F===null)return"null"}if(j.indexOf(F)!==-1)return r;let Z=W;if(Array.isArray(F)){if(F.length===0)return"[]";if(s<j.length+1)return'"[Array]"';j.push(F),W+=H;let pe=`
${W}`,ue=`,
${W}`,Le=Math.min(F.length,a),We=0;for(;We<Le-1;We++){let rt=m(String(We),F[We],j,H,W);pe+=rt!==void 0?rt:"null",pe+=ue}let ze=m(String(We),F[We],j,H,W);if(pe+=ze!==void 0?ze:"null",F.length-1>a){let rt=F.length-a-1;pe+=`${ue}"... ${Sx(rt)} not stringified"`}return pe+=`
${Z}`,j.pop(),`[${pe}]`}let Y=Object.keys(F),ee=Y.length;if(ee===0)return"{}";if(s<j.length+1)return'"[Object]"';W+=H;let ce=`,
${W}`,ge="",Se="",ne=Math.min(ee,a);Wre(F)&&(ge+=SPe(F,ce,a),Y=Y.slice(F.length),ne-=F.length,Se=ce),n&&(Y=$re(Y,o)),j.push(F);for(let pe=0;pe<ne;pe++){let ue=Y[pe],Le=m(ue,F[ue],j,H,W);Le!==void 0&&(ge+=`${Se}${nv(ue)}: ${Le}`,Se=ce)}if(ee>a){let pe=ee-a;ge+=`${Se}"...": "${Sx(pe)} not stringified"`,Se=ce}return Se!==""&&(ge=`
${W}${ge}
${Z}`),j.pop(),`{${ge}}`}case"number":return isFinite(F)?String(F):e?e(F):"null";case"boolean":return F===!0?"true":"false";case"undefined":return;case"bigint":if(i)return String(F);default:return e?e(F):void 0}}function x(k,F,j){switch(typeof F){case"string":return nv(F);case"object":{if(F===null)return"null";if(typeof F.toJSON=="function"){if(F=F.toJSON(k),typeof F!="object")return x(k,F,j);if(F===null)return"null"}if(j.indexOf(F)!==-1)return r;let H="",W=F.length!==void 0;if(W&&Array.isArray(F)){if(F.length===0)return"[]";if(s<j.length+1)return'"[Array]"';j.push(F);let ge=Math.min(F.length,a),Se=0;for(;Se<ge-1;Se++){let pe=x(String(Se),F[Se],j);H+=pe!==void 0?pe:"null",H+=","}let ne=x(String(Se),F[Se],j);if(H+=ne!==void 0?ne:"null",F.length-1>a){let pe=F.length-a-1;H+=`,"... ${Sx(pe)} not stringified"`}return j.pop(),`[${H}]`}let Z=Object.keys(F),Y=Z.length;if(Y===0)return"{}";if(s<j.length+1)return'"[Object]"';let ee="",ce=Math.min(Y,a);W&&Wre(F)&&(H+=SPe(F,",",a),Z=Z.slice(F.length),ce-=F.length,ee=","),n&&(Z=$re(Z,o)),j.push(F);for(let ge=0;ge<ce;ge++){let Se=Z[ge],ne=x(Se,F[Se],j);ne!==void 0&&(H+=`${ee}${nv(Se)}:${ne}`,ee=",")}if(Y>a){let ge=Y-a;H+=`${ee}"...":"${Sx(ge)} not stringified"`}return j.pop(),`{${H}}`}case"number":return isFinite(F)?String(F):e?e(F):"null";case"boolean":return F===!0?"true":"false";case"undefined":return;case"bigint":if(i)return String(F);default:return e?e(F):void 0}}function M(k,F,j){if(arguments.length>1){let H="";if(typeof j=="number"?H=" ".repeat(Math.min(j,10)):typeof j=="string"&&(H=j.slice(0,10)),F!=null){if(typeof F=="function")return u("",{"":k},[],F,H,"");if(Array.isArray(F))return p("",k,[],Cft(F),H,"")}if(H.length!==0)return m("",k,[],H,"")}return x("",k,[])}return M}});var LPe=nr((z2r,DPe)=>{"use strict";var Xre=Object.defineProperty,Ift=Object.getOwnPropertyDescriptor,kft=Object.getOwnPropertyNames,Rft=Object.prototype.hasOwnProperty,Oft=(t,e)=>{for(var r in e)Xre(t,r,{get:e[r],enumerable:!0})},Dft=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of kft(e))!Rft.call(t,n)&&n!==r&&Xre(t,n,{get:()=>e[n],enumerable:!(i=Ift(e,n))||i.enumerable});return t},Lft=t=>Dft(Xre({},"__esModule",{value:!0}),t),PPe={};Oft(PPe,{WebSocket:()=>RPe,default:()=>jft});DPe.exports=Lft(PPe);(!globalThis.EventTarget||!globalThis.Event)&&console.error(`
  PartySocket requires a global 'EventTarget' class to be available!
  You can polyfill this global by adding this to your code before any partysocket imports: 
  
  \`\`\`
  import 'partysocket/event-target-polyfill';
  \`\`\`
  Please file an issue at https://github.com/partykit/partykit if you're still having trouble.
`);var IPe=class extends Event{message;error;constructor(t,e){super("error",e),this.message=t.message,this.error=t}},kPe=class extends Event{code;reason;wasClean=!0;constructor(t=1e3,e="",r){super("close",r),this.code=t,this.reason=e}},Yre={Event,ErrorEvent:IPe,CloseEvent:kPe};function Bft(t,e){if(!t)throw new Error(e)}function Fft(t){return new t.constructor(t.type,t)}function Nft(t){return"data"in t?new MessageEvent(t.type,t):"code"in t||"reason"in t?new kPe(t.code||1999,t.reason||"unknown reason",t):"error"in t?new IPe(t.error,t):new Event(t.type,t)}var zft=typeof process<"u"&&typeof process.versions?.node<"u"&&typeof document>"u",LU=zft?Nft:Fft,Mx={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},EPe=!1,RPe=class Ex extends EventTarget{_ws;_retryCount=-1;_uptimeTimeout;_connectTimeout;_shouldReconnect=!0;_connectLock=!1;_binaryType="blob";_closeCalled=!1;_messageQueue=[];_debugLogger=console.log.bind(console);_url;_protocols;_options;constructor(e,r,i={}){super(),this._url=e,this._protocols=r,this._options=i,this._options.startClosed&&(this._shouldReconnect=!1),this._options.debugLogger&&(this._debugLogger=this._options.debugLogger),this._connect()}static get CONNECTING(){return 0}static get OPEN(){return 1}static get CLOSING(){return 2}static get CLOSED(){return 3}get CONNECTING(){return Ex.CONNECTING}get OPEN(){return Ex.OPEN}get CLOSING(){return Ex.CLOSING}get CLOSED(){return Ex.CLOSED}get binaryType(){return this._ws?this._ws.binaryType:this._binaryType}set binaryType(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)}get retryCount(){return Math.max(this._retryCount,0)}get bufferedAmount(){return this._messageQueue.reduce((r,i)=>(typeof i=="string"?r+=i.length:i instanceof Blob?r+=i.size:r+=i.byteLength,r),0)+(this._ws?this._ws.bufferedAmount:0)}get extensions(){return this._ws?this._ws.extensions:""}get protocol(){return this._ws?this._ws.protocol:""}get readyState(){return this._ws?this._ws.readyState:this._options.startClosed?Ex.CLOSED:Ex.CONNECTING}get url(){return this._ws?this._ws.url:""}get shouldReconnect(){return this._shouldReconnect}onclose=null;onerror=null;onmessage=null;onopen=null;close(e=1e3,r){if(this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(e,r)}reconnect(e,r){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(e,r),this._connect())}send(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{let{maxEnqueuedMessages:r=Mx.maxEnqueuedMessages}=this._options;this._messageQueue.length<r&&(this._debug("enqueue",e),this._messageQueue.push(e))}}_debug(...e){this._options.debug&&this._debugLogger("RWS>",...e)}_getNextDelay(){let{reconnectionDelayGrowFactor:e=Mx.reconnectionDelayGrowFactor,minReconnectionDelay:r=Mx.minReconnectionDelay,maxReconnectionDelay:i=Mx.maxReconnectionDelay}=this._options,n=0;return this._retryCount>0&&(n=r*Math.pow(e,this._retryCount-1),n>i&&(n=i)),this._debug("next delay",n),n}_wait(){return new Promise(e=>{setTimeout(e,this._getNextDelay())})}_getNextProtocols(e){if(!e)return Promise.resolve(null);if(typeof e=="string"||Array.isArray(e))return Promise.resolve(e);if(typeof e=="function"){let r=e();if(!r)return Promise.resolve(null);if(typeof r=="string"||Array.isArray(r))return Promise.resolve(r);if(r.then)return r}throw Error("Invalid protocols")}_getNextUrl(e){if(typeof e=="string")return Promise.resolve(e);if(typeof e=="function"){let r=e();if(typeof r=="string")return Promise.resolve(r);if(r.then)return r}throw Error("Invalid URL")}_connect(){if(this._connectLock||!this._shouldReconnect)return;this._connectLock=!0;let{maxRetries:e=Mx.maxRetries,connectionTimeout:r=Mx.connectionTimeout}=this._options;if(this._retryCount>=e){this._debug("max retries reached",this._retryCount,">=",e);return}this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),this._wait().then(()=>Promise.all([this._getNextUrl(this._url),this._getNextProtocols(this._protocols||null)])).then(([i,n])=>{if(this._closeCalled){this._connectLock=!1;return}!this._options.WebSocket&&typeof WebSocket>"u"&&!EPe&&(console.error(`\u203C\uFE0F No WebSocket implementation available. You should define options.WebSocket. 

For example, if you're using node.js, run \`npm install ws\`, and then in your code:

import PartySocket from 'partysocket';
import WS from 'ws';

const partysocket = new PartySocket({
  host: "127.0.0.1:1999",
  room: "test-room",
  WebSocket: WS
});

`),EPe=!0);let o=this._options.WebSocket||WebSocket;this._debug("connect",{url:i,protocols:n}),this._ws=n?new o(i,n):new o(i),this._ws.binaryType=this._binaryType,this._connectLock=!1,this._addListeners(),this._connectTimeout=setTimeout(()=>this._handleTimeout(),r)}).catch(i=>{this._connectLock=!1,this._handleError(new Yre.ErrorEvent(Error(i.message),this))})}_handleTimeout(){this._debug("timeout event"),this._handleError(new Yre.ErrorEvent(Error("TIMEOUT"),this))}_disconnect(e=1e3,r){if(this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(e,r),this._handleClose(new Yre.CloseEvent(e,r,this))}catch{}}}_acceptOpen(){this._debug("accept open"),this._retryCount=0}_handleOpen=e=>{this._debug("open event");let{minUptime:r=Mx.minUptime}=this._options;clearTimeout(this._connectTimeout),this._uptimeTimeout=setTimeout(()=>this._acceptOpen(),r),Bft(this._ws,"WebSocket is not defined"),this._ws.binaryType=this._binaryType,this._messageQueue.forEach(i=>this._ws?.send(i)),this._messageQueue=[],this.onopen&&this.onopen(e),this.dispatchEvent(LU(e))};_handleMessage=e=>{this._debug("message event"),this.onmessage&&this.onmessage(e),this.dispatchEvent(LU(e))};_handleError=e=>{this._debug("error event",e.message),this._disconnect(void 0,e.message==="TIMEOUT"?"timeout":void 0),this.onerror&&this.onerror(e),this._debug("exec error listeners"),this.dispatchEvent(LU(e)),this._connect()};_handleClose=e=>{this._debug("close event"),this._clearTimeouts(),this._shouldReconnect&&this._connect(),this.onclose&&this.onclose(e),this.dispatchEvent(LU(e))};_removeListeners(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))}_addListeners(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))}_clearTimeouts(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)}},Uft=t=>t[1]!==null&&t[1]!==void 0;function Vft(){if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();let t=new Date().getTime(),e=typeof performance<"u"&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let i=Math.random()*16;return t>0?(i=(t+i)%16|0,t=Math.floor(t/16)):(i=(e+i)%16|0,e=Math.floor(e/16)),(r==="x"?i:i&3|8).toString(16)})}function OPe(t,e,r={}){let{host:i,path:n,protocol:o,room:s,party:a,query:u}=t,p=i.replace(/^(http|https|ws|wss):\/\//,"");if(p.endsWith("/")&&(p=p.slice(0,-1)),n&&n.startsWith("/"))throw new Error("path must not start with a slash");let m=a??"main",x=n?`/${n}`:"",M=o||(p.startsWith("localhost:")||p.startsWith("127.0.0.1:")||p.startsWith("192.168.")||p.startsWith("10.")||p.startsWith("172.")&&p.split(".")[1]>="16"&&p.split(".")[1]<="31"||p.startsWith("[::ffff:7f00:1]:")?e:e+"s"),k=`${M}://${p}/${a?`parties/${a}`:"party"}/${s}${x}`,F=(H={})=>`${k}?${new URLSearchParams([...Object.entries(r),...Object.entries(H).filter(Uft)])}`,j=typeof u=="function"?async()=>F(await u()):F(u);return{host:p,path:x,room:s,name:m,protocol:M,partyUrl:k,urlProvider:j}}var jft=class extends RPe{constructor(t){let e=CPe(t);super(e.urlProvider,e.protocols,e.socketOptions),this.partySocketOptions=t,this.setWSProperties(e)}_pk;_pkurl;name;room;host;path;updateProperties(t){let e=CPe({...this.partySocketOptions,...t,host:t.host??this.host,room:t.room??this.room,path:t.path??this.path});this._url=e.urlProvider,this._protocols=e.protocols,this._options=e.socketOptions,this.setWSProperties(e)}setWSProperties(t){let{_pk:e,_pkurl:r,name:i,room:n,host:o,path:s}=t;this._pk=e,this._pkurl=r,this.name=i,this.room=n,this.host=o,this.path=s}reconnect(t,e){if(!this.room||!this.host)throw new Error("The room and host must be set before connecting, use `updateProperties` method to set them or pass them to the constructor.");super.reconnect(t,e)}get id(){return this._pk}get roomUrl(){return this._pkurl}static async fetch(t,e){let r=OPe(t,"http"),i=typeof r.urlProvider=="string"?r.urlProvider:await r.urlProvider();return(t.fetch??fetch)(i,e)}};function CPe(t){let{id:e,host:r,path:i,party:n,room:o,protocol:s,query:a,protocols:u,...p}=t,m=e||Vft(),x=OPe(t,"ws",{_pk:m});return{_pk:m,_pkurl:x.partyUrl,name:x.name,room:x.room,host:x.host,path:x.path,protocols:u,socketOptions:p,urlProvider:x.urlProvider}}});var BPe=nr(BU=>{"use strict";BU.__esModule=!0;BU.DoubleIndexedKV=void 0;var $ft=(function(){function t(){this.keyToValue=new Map,this.valueToKey=new Map}return t.prototype.set=function(e,r){this.keyToValue.set(e,r),this.valueToKey.set(r,e)},t.prototype.getByKey=function(e){return this.keyToValue.get(e)},t.prototype.getByValue=function(e){return this.valueToKey.get(e)},t.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},t})();BU.DoubleIndexedKV=$ft});var Zre=nr(FU=>{"use strict";FU.__esModule=!0;FU.Registry=void 0;var Wft=BPe(),Gft=(function(){function t(e){this.generateIdentifier=e,this.kv=new Wft.DoubleIndexedKV}return t.prototype.register=function(e,r){this.kv.getByValue(e)||(r||(r=this.generateIdentifier(e)),this.kv.set(r,e))},t.prototype.clear=function(){this.kv.clear()},t.prototype.getIdentifier=function(e){return this.kv.getByValue(e)},t.prototype.getValue=function(e){return this.kv.getByKey(e)},t})();FU.Registry=Gft});var FPe=nr(S4=>{"use strict";var Hft=S4&&S4.__extends||(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}})();S4.__esModule=!0;S4.ClassRegistry=void 0;var qft=Zre(),Yft=(function(t){Hft(e,t);function e(){var r=t.call(this,function(i){return i.name})||this;return r.classToAllowedProps=new Map,r}return e.prototype.register=function(r,i){typeof i=="object"?(i.allowProps&&this.classToAllowedProps.set(r,i.allowProps),t.prototype.register.call(this,r,i.identifier)):t.prototype.register.call(this,r,i)},e.prototype.getAllowedProps=function(r){return this.classToAllowedProps.get(r)},e})(qft.Registry);S4.ClassRegistry=Yft});var bR=nr(Qd=>{"use strict";var Xft=Qd&&Qd.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,o=[],s;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(a){s={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return o};Qd.__esModule=!0;Qd.findArr=Qd.includes=Qd.forEach=Qd.find=void 0;function Zft(t){if("values"in Object)return Object.values(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return e}function Kft(t,e){var r=Zft(t);if("find"in r)return r.find(e);for(var i=r,n=0;n<i.length;n++){var o=i[n];if(e(o))return o}}Qd.find=Kft;function Qft(t,e){Object.entries(t).forEach(function(r){var i=Xft(r,2),n=i[0],o=i[1];return e(o,n)})}Qd.forEach=Qft;function Jft(t,e){return t.indexOf(e)!==-1}Qd.includes=Jft;function ept(t,e){for(var r=0;r<t.length;r++){var i=t[r];if(e(i))return i}}Qd.findArr=ept});var NPe=nr(NU=>{"use strict";NU.__esModule=!0;NU.CustomTransformerRegistry=void 0;var tpt=bR(),rpt=(function(){function t(){this.transfomers={}}return t.prototype.register=function(e){this.transfomers[e.name]=e},t.prototype.findApplicable=function(e){return tpt.find(this.transfomers,function(r){return r.isApplicable(e)})},t.prototype.findByName=function(e){return this.transfomers[e]},t})();NU.CustomTransformerRegistry=rpt});var zU=nr(mi=>{"use strict";mi.__esModule=!0;mi.isURL=mi.isTypedArray=mi.isInfinite=mi.isBigint=mi.isPrimitive=mi.isNaNValue=mi.isError=mi.isDate=mi.isSymbol=mi.isSet=mi.isMap=mi.isRegExp=mi.isBoolean=mi.isNumber=mi.isString=mi.isArray=mi.isEmptyObject=mi.isPlainObject=mi.isNull=mi.isUndefined=void 0;var ipt=function(t){return Object.prototype.toString.call(t).slice(8,-1)},npt=function(t){return typeof t>"u"};mi.isUndefined=npt;var opt=function(t){return t===null};mi.isNull=opt;var spt=function(t){return typeof t!="object"||t===null||t===Object.prototype?!1:Object.getPrototypeOf(t)===null?!0:Object.getPrototypeOf(t)===Object.prototype};mi.isPlainObject=spt;var apt=function(t){return mi.isPlainObject(t)&&Object.keys(t).length===0};mi.isEmptyObject=apt;var lpt=function(t){return Array.isArray(t)};mi.isArray=lpt;var cpt=function(t){return typeof t=="string"};mi.isString=cpt;var upt=function(t){return typeof t=="number"&&!isNaN(t)};mi.isNumber=upt;var hpt=function(t){return typeof t=="boolean"};mi.isBoolean=hpt;var dpt=function(t){return t instanceof RegExp};mi.isRegExp=dpt;var fpt=function(t){return t instanceof Map};mi.isMap=fpt;var ppt=function(t){return t instanceof Set};mi.isSet=ppt;var mpt=function(t){return ipt(t)==="Symbol"};mi.isSymbol=mpt;var gpt=function(t){return t instanceof Date&&!isNaN(t.valueOf())};mi.isDate=gpt;var Apt=function(t){return t instanceof Error};mi.isError=Apt;var ypt=function(t){return typeof t=="number"&&isNaN(t)};mi.isNaNValue=ypt;var _pt=function(t){return mi.isBoolean(t)||mi.isNull(t)||mi.isUndefined(t)||mi.isNumber(t)||mi.isString(t)||mi.isSymbol(t)};mi.isPrimitive=_pt;var vpt=function(t){return typeof t=="bigint"};mi.isBigint=vpt;var bpt=function(t){return t===1/0||t===-1/0};mi.isInfinite=bpt;var xpt=function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)};mi.isTypedArray=xpt;var wpt=function(t){return t instanceof URL};mi.isURL=wpt});var Kre=nr(nA=>{"use strict";nA.__esModule=!0;nA.parsePath=nA.stringifyPath=nA.escapeKey=void 0;var Spt=function(t){return t.replace(/\./g,"\\.")};nA.escapeKey=Spt;var Tpt=function(t){return t.map(String).map(nA.escapeKey).join(".")};nA.stringifyPath=Tpt;var Mpt=function(t){for(var e=[],r="",i=0;i<t.length;i++){var n=t.charAt(i),o=n==="\\"&&t.charAt(i+1)===".";if(o){r+=".",i++;continue}var s=n===".";if(s){e.push(r),r="";continue}r+=n}var a=r;return e.push(a),e};nA.parsePath=Mpt});var qPe=nr(Wu=>{"use strict";var Qre=Wu&&Wu.__assign||function(){return Qre=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Qre.apply(this,arguments)},Jre=Wu&&Wu.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,o=[],s;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(a){s={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return o},eie=Wu&&Wu.__spreadArray||function(t,e){for(var r=0,i=e.length,n=t.length;r<i;r++,n++)t[n]=e[r];return t};Wu.__esModule=!0;Wu.untransformValue=Wu.transformValue=Wu.isInstanceOfRegisteredClass=void 0;var $u=zU(),zPe=bR();function J0(t,e,r,i){return{isApplicable:t,annotation:e,transform:r,untransform:i}}var UPe=[J0($u.isUndefined,"undefined",function(){return null},function(){}),J0($u.isBigint,"bigint",function(t){return t.toString()},function(t){return typeof BigInt<"u"?BigInt(t):(console.error("Please add a BigInt polyfill."),t)}),J0($u.isDate,"Date",function(t){return t.toISOString()},function(t){return new Date(t)}),J0($u.isError,"Error",function(t,e){var r={name:t.name,message:t.message};return e.allowedErrorProps.forEach(function(i){r[i]=t[i]}),r},function(t,e){var r=new Error(t.message);return r.name=t.name,r.stack=t.stack,e.allowedErrorProps.forEach(function(i){r[i]=t[i]}),r}),J0($u.isRegExp,"regexp",function(t){return""+t},function(t){var e=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,r)}),J0($u.isSet,"set",function(t){return eie([],Jre(t.values()))},function(t){return new Set(t)}),J0($u.isMap,"map",function(t){return eie([],Jre(t.entries()))},function(t){return new Map(t)}),J0(function(t){return $u.isNaNValue(t)||$u.isInfinite(t)},"number",function(t){return $u.isNaNValue(t)?"NaN":t>0?"Infinity":"-Infinity"},Number),J0(function(t){return t===0&&1/t===-1/0},"number",function(){return"-0"},Number),J0($u.isURL,"URL",function(t){return t.toString()},function(t){return new URL(t)})];function UU(t,e,r,i){return{isApplicable:t,annotation:e,transform:r,untransform:i}}var VPe=UU(function(t,e){if($u.isSymbol(t)){var r=!!e.symbolRegistry.getIdentifier(t);return r}return!1},function(t,e){var r=e.symbolRegistry.getIdentifier(t);return["symbol",r]},function(t){return t.description},function(t,e,r){var i=r.symbolRegistry.getValue(e[1]);if(!i)throw new Error("Trying to deserialize unknown symbol");return i}),Ept=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(t,e){return t[e.name]=e,t},{}),jPe=UU($u.isTypedArray,function(t){return["typed-array",t.constructor.name]},function(t){return eie([],Jre(t))},function(t,e){var r=Ept[e[1]];if(!r)throw new Error("Trying to deserialize unknown typed array");return new r(t)});function $Pe(t,e){if(t?.constructor){var r=!!e.classRegistry.getIdentifier(t.constructor);return r}return!1}Wu.isInstanceOfRegisteredClass=$Pe;var WPe=UU($Pe,function(t,e){var r=e.classRegistry.getIdentifier(t.constructor);return["class",r]},function(t,e){var r=e.classRegistry.getAllowedProps(t.constructor);if(!r)return Qre({},t);var i={};return r.forEach(function(n){i[n]=t[n]}),i},function(t,e,r){var i=r.classRegistry.getValue(e[1]);if(!i)throw new Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(i.prototype),t)}),GPe=UU(function(t,e){return!!e.customTransformerRegistry.findApplicable(t)},function(t,e){var r=e.customTransformerRegistry.findApplicable(t);return["custom",r.name]},function(t,e){var r=e.customTransformerRegistry.findApplicable(t);return r.serialize(t)},function(t,e,r){var i=r.customTransformerRegistry.findByName(e[1]);if(!i)throw new Error("Trying to deserialize unknown custom value");return i.deserialize(t)}),Cpt=[WPe,VPe,GPe,jPe],Ppt=function(t,e){var r=zPe.findArr(Cpt,function(n){return n.isApplicable(t,e)});if(r)return{value:r.transform(t,e),type:r.annotation(t,e)};var i=zPe.findArr(UPe,function(n){return n.isApplicable(t,e)});if(i)return{value:i.transform(t,e),type:i.annotation}};Wu.transformValue=Ppt;var HPe={};UPe.forEach(function(t){HPe[t.annotation]=t});var Ipt=function(t,e,r){if($u.isArray(e))switch(e[0]){case"symbol":return VPe.untransform(t,e,r);case"class":return WPe.untransform(t,e,r);case"custom":return GPe.untransform(t,e,r);case"typed-array":return jPe.untransform(t,e,r);default:throw new Error("Unknown transformation: "+e)}else{var i=HPe[e];if(!i)throw new Error("Unknown transformation: "+e);return i.untransform(t,r)}};Wu.untransformValue=Ipt});var XPe=nr(M4=>{"use strict";M4.__esModule=!0;M4.setDeep=M4.getDeep=void 0;var em=zU(),tie=bR(),T4=function(t,e){for(var r=t.keys();e>0;)r.next(),e--;return r.next().value};function YPe(t){if(tie.includes(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(tie.includes(t,"prototype"))throw new Error("prototype is not allowed as a property");if(tie.includes(t,"constructor"))throw new Error("constructor is not allowed as a property")}var kpt=function(t,e){YPe(e);for(var r=0;r<e.length;r++){var i=e[r];if(em.isSet(t))t=T4(t,+i);else if(em.isMap(t)){var n=+i,o=+e[++r]==0?"key":"value",s=T4(t,n);switch(o){case"key":t=s;break;case"value":t=t.get(s);break}}else t=t[i]}return t};M4.getDeep=kpt;var Rpt=function(t,e,r){if(YPe(e),e.length===0)return r(t);for(var i=t,n=0;n<e.length-1;n++){var o=e[n];if(em.isArray(i)){var s=+o;i=i[s]}else if(em.isPlainObject(i))i=i[o];else if(em.isSet(i)){var a=+o;i=T4(i,a)}else if(em.isMap(i)){var u=n===e.length-2;if(u)break;var a=+o,p=+e[++n]==0?"key":"value",m=T4(i,a);switch(p){case"key":i=m;break;case"value":i=i.get(m);break}}}var x=e[e.length-1];if(em.isArray(i)?i[+x]=r(i[+x]):em.isPlainObject(i)&&(i[x]=r(i[x])),em.isSet(i)){var M=T4(i,+x),k=r(M);M!==k&&(i.delete(M),i.add(k))}if(em.isMap(i)){var a=+e[e.length-2],F=T4(i,a),p=+x==0?"key":"value";switch(p){case"key":{var j=r(F);i.set(j,i.get(F)),j!==F&&i.delete(F);break}case"value":{i.set(F,r(i.get(F)));break}}}return t};M4.setDeep=Rpt});var ZPe=nr(ru=>{"use strict";var oA=ru&&ru.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,o=[],s;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(a){s={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return o},ov=ru&&ru.__spreadArray||function(t,e){for(var r=0,i=e.length,n=t.length;r<i;r++,n++)t[n]=e[r];return t};ru.__esModule=!0;ru.walker=ru.generateReferentialEqualityAnnotations=ru.applyReferentialEqualityAnnotations=ru.applyValueAnnotations=void 0;var jh=zU(),VU=Kre(),$U=qPe(),Cx=bR(),xR=Kre(),jU=XPe();function rie(t,e,r){if(r===void 0&&(r=[]),!!t){if(!jh.isArray(t)){Cx.forEach(t,function(s,a){return rie(s,e,ov(ov([],oA(r)),oA(xR.parsePath(a))))});return}var i=oA(t,2),n=i[0],o=i[1];o&&Cx.forEach(o,function(s,a){rie(s,e,ov(ov([],oA(r)),oA(xR.parsePath(a))))}),e(n,r)}}function Opt(t,e,r){return rie(e,function(i,n){t=jU.setDeep(t,n,function(o){return $U.untransformValue(o,i,r)})}),t}ru.applyValueAnnotations=Opt;function Dpt(t,e){function r(s,a){var u=jU.getDeep(t,xR.parsePath(a));s.map(xR.parsePath).forEach(function(p){t=jU.setDeep(t,p,function(){return u})})}if(jh.isArray(e)){var i=oA(e,2),n=i[0],o=i[1];n.forEach(function(s){t=jU.setDeep(t,xR.parsePath(s),function(){return t})}),o&&Cx.forEach(o,r)}else Cx.forEach(e,r);return t}ru.applyReferentialEqualityAnnotations=Dpt;var Lpt=function(t,e){return jh.isPlainObject(t)||jh.isArray(t)||jh.isMap(t)||jh.isSet(t)||$U.isInstanceOfRegisteredClass(t,e)};function Bpt(t,e,r){var i=r.get(t);i?i.push(e):r.set(t,[e])}function Fpt(t,e){var r={},i=void 0;return t.forEach(function(n){if(!(n.length<=1)){e||(n=n.map(function(u){return u.map(String)}).sort(function(u,p){return u.length-p.length}));var o=oA(n),s=o[0],a=o.slice(1);s.length===0?i=a.map(VU.stringifyPath):r[VU.stringifyPath(s)]=a.map(VU.stringifyPath)}}),i?jh.isEmptyObject(r)?[i]:[i,r]:jh.isEmptyObject(r)?void 0:r}ru.generateReferentialEqualityAnnotations=Fpt;var Npt=function(t,e,r,i,n,o,s){var a;n===void 0&&(n=[]),o===void 0&&(o=[]),s===void 0&&(s=new Map);var u=jh.isPrimitive(t);if(!u){Bpt(t,n,e);var p=s.get(t);if(p)return i?{transformedValue:null}:p}if(!Lpt(t,r)){var m=$U.transformValue(t,r),x=m?{transformedValue:m.value,annotations:[m.type]}:{transformedValue:t};return u||s.set(t,x),x}if(Cx.includes(o,t))return{transformedValue:null};var M=$U.transformValue(t,r),k=(a=M?.value)!==null&&a!==void 0?a:t,F=jh.isArray(k)?[]:{},j={};Cx.forEach(k,function(W,Z){var Y=ru.walker(W,e,r,i,ov(ov([],oA(n)),[Z]),ov(ov([],oA(o)),[t]),s);F[Z]=Y.transformedValue,jh.isArray(Y.annotations)?j[Z]=Y.annotations:jh.isPlainObject(Y.annotations)&&Cx.forEach(Y.annotations,function(ee,ce){j[VU.escapeKey(Z)+"."+ce]=ee})});var H=jh.isEmptyObject(j)?{transformedValue:F,annotations:M?[M.type]:void 0}:{transformedValue:F,annotations:M?[M.type,j]:j};return u||s.set(t,H),H};ru.walker=Npt});var r6e=nr(nn=>{"use strict";function ws(t){return Object.prototype.toString.call(t).slice(8,-1)}function KPe(t){return ws(t)==="Object"}function iie(t){return ws(t)==="Array"}function zpt(t){return ws(t)==="Blob"}function QPe(t){return ws(t)==="Boolean"}function Upt(t){return ws(t)==="Date"&&!isNaN(t)}function Vpt(t){return iie(t)&&t.length===0}function WU(t){if(ws(t)!=="Object")return!1;let e=Object.getPrototypeOf(t);return!!e&&e.constructor===Object&&e===Object.prototype}function jpt(t){return WU(t)&&Object.keys(t).length===0}function $pt(t){return t===""}function Wpt(t){return ws(t)==="Error"||t instanceof Error}function Gpt(t){return ws(t)==="File"}function Hpt(t){return iie(t)&&t.length>0}function qpt(t){return WU(t)&&Object.keys(t).length>0}function nie(t){return ws(t)==="String"}function Ypt(t){return nie(t)&&t!==""}function Xpt(t){return typeof t=="function"}function JPe(t,e){if(!(e instanceof Function))throw new TypeError("Type must be a function");if(!Object.prototype.hasOwnProperty.call(e,"prototype"))throw new TypeError("Type is not a class");let r=e.name;return ws(t)===r||!!(t&&t.constructor===e)}function Zpt(t,e){if(typeof e=="function"){for(let r=t;r;r=Object.getPrototypeOf(r))if(JPe(r,e))return!0;return!1}else{for(let r=t;r;r=Object.getPrototypeOf(r))if(ws(r)===e)return!0;return!1}}function Kpt(t){return ws(t)==="Map"}function Qpt(t){return ws(t)==="Number"&&isNaN(t)}function GU(t){return ws(t)==="Number"&&!isNaN(t)}function Jpt(t){return GU(t)&&t<0}function oie(t){return ws(t)==="Null"}function e6e(t,e,r,i,n){return o=>t(o)||e(o)||!!r&&r(o)||!!i&&i(o)||!!n&&n(o)}function sie(t){return ws(t)==="Undefined"}var e0t=e6e(oie,sie);function t0t(t){return WU(t)}function r0t(t){return KPe(t)}function i0t(t){return GU(t)&&t>0}function t6e(t){return ws(t)==="Symbol"}function n0t(t){return QPe(t)||oie(t)||sie(t)||GU(t)||nie(t)||t6e(t)}function o0t(t){return ws(t)==="Promise"}function s0t(t){return ws(t)==="RegExp"}function a0t(t){return ws(t)==="Set"}function l0t(t){return ws(t)==="WeakMap"}function c0t(t){return ws(t)==="WeakSet"}nn.getType=ws;nn.isAnyObject=KPe;nn.isArray=iie;nn.isBlob=zpt;nn.isBoolean=QPe;nn.isDate=Upt;nn.isEmptyArray=Vpt;nn.isEmptyObject=jpt;nn.isEmptyString=$pt;nn.isError=Wpt;nn.isFile=Gpt;nn.isFullArray=Hpt;nn.isFullObject=qpt;nn.isFullString=Ypt;nn.isFunction=Xpt;nn.isInstanceOf=Zpt;nn.isMap=Kpt;nn.isNaNValue=Qpt;nn.isNegativeNumber=Jpt;nn.isNull=oie;nn.isNullOrUndefined=e0t;nn.isNumber=GU;nn.isObject=t0t;nn.isObjectLike=r0t;nn.isOneOf=e6e;nn.isPlainObject=WU;nn.isPositiveNumber=i0t;nn.isPrimitive=n0t;nn.isPromise=o0t;nn.isRegExp=s0t;nn.isSet=a0t;nn.isString=nie;nn.isSymbol=t6e;nn.isType=JPe;nn.isUndefined=sie;nn.isWeakMap=l0t;nn.isWeakSet=c0t});var n6e=nr(i6e=>{"use strict";var aie=r6e();function u0t(t,e,r,i,n){let o={}.propertyIsEnumerable.call(i,e)?"enumerable":"nonenumerable";o==="enumerable"&&(t[e]=r),n&&o==="nonenumerable"&&Object.defineProperty(t,e,{value:r,enumerable:!1,writable:!0,configurable:!0})}function lie(t,e={}){if(aie.isArray(t))return t.map(n=>lie(n,e));if(!aie.isPlainObject(t))return t;let r=Object.getOwnPropertyNames(t),i=Object.getOwnPropertySymbols(t);return[...r,...i].reduce((n,o)=>{if(aie.isArray(e.props)&&!e.props.includes(o))return n;let s=t[o],a=lie(s,e);return u0t(n,o,a,t,e.nonenumerable),n},{})}i6e.copy=lie});var o6e=nr(Io=>{"use strict";var Px=Io&&Io.__assign||function(){return Px=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Px.apply(this,arguments)},h0t=Io&&Io.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,o=[],s;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(a){s={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return o},d0t=Io&&Io.__spreadArray||function(t,e){for(var r=0,i=e.length,n=t.length;r<i;r++,n++)t[n]=e[r];return t};Io.__esModule=!0;Io.allowErrorProps=Io.registerSymbol=Io.registerCustom=Io.registerClass=Io.parse=Io.stringify=Io.deserialize=Io.serialize=Io.SuperJSON=void 0;var f0t=FPe(),p0t=Zre(),m0t=NPe(),HU=ZPe(),g0t=n6e(),tm=(function(){function t(e){var r=e===void 0?{}:e,i=r.dedupe,n=i===void 0?!1:i;this.classRegistry=new f0t.ClassRegistry,this.symbolRegistry=new p0t.Registry(function(o){var s;return(s=o.description)!==null&&s!==void 0?s:""}),this.customTransformerRegistry=new m0t.CustomTransformerRegistry,this.allowedErrorProps=[],this.dedupe=n}return t.prototype.serialize=function(e){var r=new Map,i=HU.walker(e,r,this,this.dedupe),n={json:i.transformedValue};i.annotations&&(n.meta=Px(Px({},n.meta),{values:i.annotations}));var o=HU.generateReferentialEqualityAnnotations(r,this.dedupe);return o&&(n.meta=Px(Px({},n.meta),{referentialEqualities:o})),n},t.prototype.deserialize=function(e){var r=e.json,i=e.meta,n=g0t.copy(r);return i?.values&&(n=HU.applyValueAnnotations(n,i.values,this)),i?.referentialEqualities&&(n=HU.applyReferentialEqualityAnnotations(n,i.referentialEqualities)),n},t.prototype.stringify=function(e){return JSON.stringify(this.serialize(e))},t.prototype.parse=function(e){return this.deserialize(JSON.parse(e))},t.prototype.registerClass=function(e,r){this.classRegistry.register(e,r)},t.prototype.registerSymbol=function(e,r){this.symbolRegistry.register(e,r)},t.prototype.registerCustom=function(e,r){this.customTransformerRegistry.register(Px({name:r},e))},t.prototype.allowErrorProps=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];(e=this.allowedErrorProps).push.apply(e,d0t([],h0t(r)))},t.defaultInstance=new t,t.serialize=t.defaultInstance.serialize.bind(t.defaultInstance),t.deserialize=t.defaultInstance.deserialize.bind(t.defaultInstance),t.stringify=t.defaultInstance.stringify.bind(t.defaultInstance),t.parse=t.defaultInstance.parse.bind(t.defaultInstance),t.registerClass=t.defaultInstance.registerClass.bind(t.defaultInstance),t.registerSymbol=t.defaultInstance.registerSymbol.bind(t.defaultInstance),t.registerCustom=t.defaultInstance.registerCustom.bind(t.defaultInstance),t.allowErrorProps=t.defaultInstance.allowErrorProps.bind(t.defaultInstance),t})();Io.SuperJSON=tm;Io.default=tm;Io.serialize=tm.serialize;Io.deserialize=tm.deserialize;Io.stringify=tm.stringify;Io.parse=tm.parse;Io.registerClass=tm.registerClass;Io.registerCustom=tm.registerCustom;Io.registerSymbol=tm.registerSymbol;Io.allowErrorProps=tm.allowErrorProps});var uie=nr(cie=>{"use strict";Object.defineProperty(cie,"__esModule",{value:!0});cie.default=y0t;var qU,A0t=new Uint8Array(16);function y0t(){if(!qU&&(qU=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!qU))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qU(A0t)}});var s6e=nr(YU=>{"use strict";Object.defineProperty(YU,"__esModule",{value:!0});YU.default=void 0;var _0t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;YU.default=_0t});var wR=nr(XU=>{"use strict";Object.defineProperty(XU,"__esModule",{value:!0});XU.default=void 0;var v0t=b0t(s6e());function b0t(t){return t&&t.__esModule?t:{default:t}}function x0t(t){return typeof t=="string"&&v0t.default.test(t)}var w0t=x0t;XU.default=w0t});var TR=nr(SR=>{"use strict";Object.defineProperty(SR,"__esModule",{value:!0});SR.default=void 0;SR.unsafeStringify=a6e;var S0t=T0t(wR());function T0t(t){return t&&t.__esModule?t:{default:t}}var $l=[];for(let t=0;t<256;++t)$l.push((t+256).toString(16).slice(1));function a6e(t,e=0){return $l[t[e+0]]+$l[t[e+1]]+$l[t[e+2]]+$l[t[e+3]]+"-"+$l[t[e+4]]+$l[t[e+5]]+"-"+$l[t[e+6]]+$l[t[e+7]]+"-"+$l[t[e+8]]+$l[t[e+9]]+"-"+$l[t[e+10]]+$l[t[e+11]]+$l[t[e+12]]+$l[t[e+13]]+$l[t[e+14]]+$l[t[e+15]]}function M0t(t,e=0){let r=a6e(t,e);if(!(0,S0t.default)(r))throw TypeError("Stringified UUID is invalid");return r}var E0t=M0t;SR.default=E0t});var c6e=nr(ZU=>{"use strict";Object.defineProperty(ZU,"__esModule",{value:!0});ZU.default=void 0;var C0t=I0t(uie()),P0t=TR();function I0t(t){return t&&t.__esModule?t:{default:t}}var l6e,hie,die=0,fie=0;function k0t(t,e,r){let i=e&&r||0,n=e||new Array(16);t=t||{};let o=t.node||l6e,s=t.clockseq!==void 0?t.clockseq:hie;if(o==null||s==null){let M=t.random||(t.rng||C0t.default)();o==null&&(o=l6e=[M[0]|1,M[1],M[2],M[3],M[4],M[5]]),s==null&&(s=hie=(M[6]<<8|M[7])&16383)}let a=t.msecs!==void 0?t.msecs:Date.now(),u=t.nsecs!==void 0?t.nsecs:fie+1,p=a-die+(u-fie)/1e4;if(p<0&&t.clockseq===void 0&&(s=s+1&16383),(p<0||a>die)&&t.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");die=a,fie=u,hie=s,a+=122192928e5;let m=((a&268435455)*1e4+u)%4294967296;n[i++]=m>>>24&255,n[i++]=m>>>16&255,n[i++]=m>>>8&255,n[i++]=m&255;let x=a/4294967296*1e4&268435455;n[i++]=x>>>8&255,n[i++]=x&255,n[i++]=x>>>24&15|16,n[i++]=x>>>16&255,n[i++]=s>>>8|128,n[i++]=s&255;for(let M=0;M<6;++M)n[i+M]=o[M];return e||(0,P0t.unsafeStringify)(n)}var R0t=k0t;ZU.default=R0t});var pie=nr(KU=>{"use strict";Object.defineProperty(KU,"__esModule",{value:!0});KU.default=void 0;var O0t=D0t(wR());function D0t(t){return t&&t.__esModule?t:{default:t}}function L0t(t){if(!(0,O0t.default)(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var B0t=L0t;KU.default=B0t});var mie=nr(Ix=>{"use strict";Object.defineProperty(Ix,"__esModule",{value:!0});Ix.URL=Ix.DNS=void 0;Ix.default=V0t;var F0t=TR(),N0t=z0t(pie());function z0t(t){return t&&t.__esModule?t:{default:t}}function U0t(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var u6e="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Ix.DNS=u6e;var h6e="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Ix.URL=h6e;function V0t(t,e,r){function i(n,o,s,a){var u;if(typeof n=="string"&&(n=U0t(n)),typeof o=="string"&&(o=(0,N0t.default)(o)),((u=o)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let p=new Uint8Array(16+n.length);if(p.set(o),p.set(n,o.length),p=r(p),p[6]=p[6]&15|e,p[8]=p[8]&63|128,s){a=a||0;for(let m=0;m<16;++m)s[a+m]=p[m];return s}return(0,F0t.unsafeStringify)(p)}try{i.name=t}catch{}return i.DNS=u6e,i.URL=h6e,i}});var f6e=nr(JU=>{"use strict";Object.defineProperty(JU,"__esModule",{value:!0});JU.default=void 0;function j0t(t){if(typeof t=="string"){let e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return $0t(W0t(G0t(t),t.length*8))}function $0t(t){let e=[],r=t.length*32,i="0123456789abcdef";for(let n=0;n<r;n+=8){let o=t[n>>5]>>>n%32&255,s=parseInt(i.charAt(o>>>4&15)+i.charAt(o&15),16);e.push(s)}return e}function d6e(t){return(t+64>>>9<<4)+14+1}function W0t(t,e){t[e>>5]|=128<<e%32,t[d6e(e)-1]=e;let r=1732584193,i=-271733879,n=-1732584194,o=271733878;for(let s=0;s<t.length;s+=16){let a=r,u=i,p=n,m=o;r=mc(r,i,n,o,t[s],7,-680876936),o=mc(o,r,i,n,t[s+1],12,-389564586),n=mc(n,o,r,i,t[s+2],17,606105819),i=mc(i,n,o,r,t[s+3],22,-1044525330),r=mc(r,i,n,o,t[s+4],7,-176418897),o=mc(o,r,i,n,t[s+5],12,1200080426),n=mc(n,o,r,i,t[s+6],17,-1473231341),i=mc(i,n,o,r,t[s+7],22,-45705983),r=mc(r,i,n,o,t[s+8],7,1770035416),o=mc(o,r,i,n,t[s+9],12,-1958414417),n=mc(n,o,r,i,t[s+10],17,-42063),i=mc(i,n,o,r,t[s+11],22,-1990404162),r=mc(r,i,n,o,t[s+12],7,1804603682),o=mc(o,r,i,n,t[s+13],12,-40341101),n=mc(n,o,r,i,t[s+14],17,-1502002290),i=mc(i,n,o,r,t[s+15],22,1236535329),r=gc(r,i,n,o,t[s+1],5,-165796510),o=gc(o,r,i,n,t[s+6],9,-1069501632),n=gc(n,o,r,i,t[s+11],14,643717713),i=gc(i,n,o,r,t[s],20,-373897302),r=gc(r,i,n,o,t[s+5],5,-701558691),o=gc(o,r,i,n,t[s+10],9,38016083),n=gc(n,o,r,i,t[s+15],14,-660478335),i=gc(i,n,o,r,t[s+4],20,-405537848),r=gc(r,i,n,o,t[s+9],5,568446438),o=gc(o,r,i,n,t[s+14],9,-1019803690),n=gc(n,o,r,i,t[s+3],14,-187363961),i=gc(i,n,o,r,t[s+8],20,1163531501),r=gc(r,i,n,o,t[s+13],5,-1444681467),o=gc(o,r,i,n,t[s+2],9,-51403784),n=gc(n,o,r,i,t[s+7],14,1735328473),i=gc(i,n,o,r,t[s+12],20,-1926607734),r=Ac(r,i,n,o,t[s+5],4,-378558),o=Ac(o,r,i,n,t[s+8],11,-2022574463),n=Ac(n,o,r,i,t[s+11],16,1839030562),i=Ac(i,n,o,r,t[s+14],23,-35309556),r=Ac(r,i,n,o,t[s+1],4,-1530992060),o=Ac(o,r,i,n,t[s+4],11,1272893353),n=Ac(n,o,r,i,t[s+7],16,-155497632),i=Ac(i,n,o,r,t[s+10],23,-1094730640),r=Ac(r,i,n,o,t[s+13],4,681279174),o=Ac(o,r,i,n,t[s],11,-358537222),n=Ac(n,o,r,i,t[s+3],16,-722521979),i=Ac(i,n,o,r,t[s+6],23,76029189),r=Ac(r,i,n,o,t[s+9],4,-640364487),o=Ac(o,r,i,n,t[s+12],11,-421815835),n=Ac(n,o,r,i,t[s+15],16,530742520),i=Ac(i,n,o,r,t[s+2],23,-995338651),r=yc(r,i,n,o,t[s],6,-198630844),o=yc(o,r,i,n,t[s+7],10,1126891415),n=yc(n,o,r,i,t[s+14],15,-1416354905),i=yc(i,n,o,r,t[s+5],21,-57434055),r=yc(r,i,n,o,t[s+12],6,1700485571),o=yc(o,r,i,n,t[s+3],10,-1894986606),n=yc(n,o,r,i,t[s+10],15,-1051523),i=yc(i,n,o,r,t[s+1],21,-2054922799),r=yc(r,i,n,o,t[s+8],6,1873313359),o=yc(o,r,i,n,t[s+15],10,-30611744),n=yc(n,o,r,i,t[s+6],15,-1560198380),i=yc(i,n,o,r,t[s+13],21,1309151649),r=yc(r,i,n,o,t[s+4],6,-145523070),o=yc(o,r,i,n,t[s+11],10,-1120210379),n=yc(n,o,r,i,t[s+2],15,718787259),i=yc(i,n,o,r,t[s+9],21,-343485551),r=sv(r,a),i=sv(i,u),n=sv(n,p),o=sv(o,m)}return[r,i,n,o]}function G0t(t){if(t.length===0)return[];let e=t.length*8,r=new Uint32Array(d6e(e));for(let i=0;i<e;i+=8)r[i>>5]|=(t[i/8]&255)<<i%32;return r}function sv(t,e){let r=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(r>>16)<<16|r&65535}function H0t(t,e){return t<<e|t>>>32-e}function QU(t,e,r,i,n,o){return sv(H0t(sv(sv(e,t),sv(i,o)),n),r)}function mc(t,e,r,i,n,o,s){return QU(e&r|~e&i,t,e,n,o,s)}function gc(t,e,r,i,n,o,s){return QU(e&i|r&~i,t,e,n,o,s)}function Ac(t,e,r,i,n,o,s){return QU(e^r^i,t,e,n,o,s)}function yc(t,e,r,i,n,o,s){return QU(r^(e|~i),t,e,n,o,s)}var q0t=j0t;JU.default=q0t});var m6e=nr(eV=>{"use strict";Object.defineProperty(eV,"__esModule",{value:!0});eV.default=void 0;var Y0t=p6e(mie()),X0t=p6e(f6e());function p6e(t){return t&&t.__esModule?t:{default:t}}var Z0t=(0,Y0t.default)("v3",48,X0t.default),K0t=Z0t;eV.default=K0t});var g6e=nr(tV=>{"use strict";Object.defineProperty(tV,"__esModule",{value:!0});tV.default=void 0;var Q0t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),J0t={randomUUID:Q0t};tV.default=J0t});var _6e=nr(rV=>{"use strict";Object.defineProperty(rV,"__esModule",{value:!0});rV.default=void 0;var A6e=y6e(g6e()),emt=y6e(uie()),tmt=TR();function y6e(t){return t&&t.__esModule?t:{default:t}}function rmt(t,e,r){if(A6e.default.randomUUID&&!e&&!t)return A6e.default.randomUUID();t=t||{};let i=t.random||(t.rng||emt.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){r=r||0;for(let n=0;n<16;++n)e[r+n]=i[n];return e}return(0,tmt.unsafeStringify)(i)}var imt=rmt;rV.default=imt});var v6e=nr(iV=>{"use strict";Object.defineProperty(iV,"__esModule",{value:!0});iV.default=void 0;function nmt(t,e,r,i){switch(t){case 0:return e&r^~e&i;case 1:return e^r^i;case 2:return e&r^e&i^r&i;case 3:return e^r^i}}function gie(t,e){return t<<e|t>>>32-e}function omt(t){let e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){let s=unescape(encodeURIComponent(t));t=[];for(let a=0;a<s.length;++a)t.push(s.charCodeAt(a))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);let i=t.length/4+2,n=Math.ceil(i/16),o=new Array(n);for(let s=0;s<n;++s){let a=new Uint32Array(16);for(let u=0;u<16;++u)a[u]=t[s*64+u*4]<<24|t[s*64+u*4+1]<<16|t[s*64+u*4+2]<<8|t[s*64+u*4+3];o[s]=a}o[n-1][14]=(t.length-1)*8/Math.pow(2,32),o[n-1][14]=Math.floor(o[n-1][14]),o[n-1][15]=(t.length-1)*8&4294967295;for(let s=0;s<n;++s){let a=new Uint32Array(80);for(let k=0;k<16;++k)a[k]=o[s][k];for(let k=16;k<80;++k)a[k]=gie(a[k-3]^a[k-8]^a[k-14]^a[k-16],1);let u=r[0],p=r[1],m=r[2],x=r[3],M=r[4];for(let k=0;k<80;++k){let F=Math.floor(k/20),j=gie(u,5)+nmt(F,p,m,x)+M+e[F]+a[k]>>>0;M=x,x=m,m=gie(p,30)>>>0,p=u,u=j}r[0]=r[0]+u>>>0,r[1]=r[1]+p>>>0,r[2]=r[2]+m>>>0,r[3]=r[3]+x>>>0,r[4]=r[4]+M>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var smt=omt;iV.default=smt});var x6e=nr(nV=>{"use strict";Object.defineProperty(nV,"__esModule",{value:!0});nV.default=void 0;var amt=b6e(mie()),lmt=b6e(v6e());function b6e(t){return t&&t.__esModule?t:{default:t}}var cmt=(0,amt.default)("v5",80,lmt.default),umt=cmt;nV.default=umt});var w6e=nr(oV=>{"use strict";Object.defineProperty(oV,"__esModule",{value:!0});oV.default=void 0;var hmt="00000000-0000-0000-0000-000000000000";oV.default=hmt});var S6e=nr(sV=>{"use strict";Object.defineProperty(sV,"__esModule",{value:!0});sV.default=void 0;var dmt=fmt(wR());function fmt(t){return t&&t.__esModule?t:{default:t}}function pmt(t){if(!(0,dmt.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var mmt=pmt;sV.default=mmt});var T6e=nr(gp=>{"use strict";Object.defineProperty(gp,"__esModule",{value:!0});Object.defineProperty(gp,"NIL",{enumerable:!0,get:function(){return vmt.default}});Object.defineProperty(gp,"parse",{enumerable:!0,get:function(){return Smt.default}});Object.defineProperty(gp,"stringify",{enumerable:!0,get:function(){return wmt.default}});Object.defineProperty(gp,"v1",{enumerable:!0,get:function(){return gmt.default}});Object.defineProperty(gp,"v3",{enumerable:!0,get:function(){return Amt.default}});Object.defineProperty(gp,"v4",{enumerable:!0,get:function(){return ymt.default}});Object.defineProperty(gp,"v5",{enumerable:!0,get:function(){return _mt.default}});Object.defineProperty(gp,"validate",{enumerable:!0,get:function(){return xmt.default}});Object.defineProperty(gp,"version",{enumerable:!0,get:function(){return bmt.default}});var gmt=sA(c6e()),Amt=sA(m6e()),ymt=sA(_6e()),_mt=sA(x6e()),vmt=sA(w6e()),bmt=sA(S6e()),xmt=sA(wR()),wmt=sA(TR()),Smt=sA(pie());function sA(t){return t&&t.__esModule?t:{default:t}}});var Aie={};nl(Aie,{default:()=>Tmt});var E4,Tmt,yie=ve(()=>{E4=null;typeof WebSocket<"u"?E4=WebSocket:typeof MozWebSocket<"u"?E4=MozWebSocket:typeof global<"u"?E4=global.WebSocket||global.MozWebSocket:typeof window<"u"?E4=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(E4=self.WebSocket||self.MozWebSocket);Tmt=E4});var D6e=nr((y3r,O6e)=>{"use strict";var Mmt=Object.create,lV=Object.defineProperty,Emt=Object.getOwnPropertyDescriptor,Cmt=Object.getOwnPropertyNames,Pmt=Object.getPrototypeOf,Imt=Object.prototype.hasOwnProperty,kmt=(t,e)=>{for(var r in e)lV(t,r,{get:e[r],enumerable:!0})},P6e=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Cmt(e))!Imt.call(t,n)&&n!==r&&lV(t,n,{get:()=>e[n],enumerable:!(i=Emt(e,n))||i.enumerable});return t},MR=(t,e,r)=>(r=t!=null?Mmt(Pmt(t)):{},P6e(e||!t||!t.__esModule?lV(r,"default",{value:t,enumerable:!0}):r,t)),Rmt=t=>P6e(lV({},"__esModule",{value:!0}),t),I6e={};kmt(I6e,{createBrowserInspector:()=>k6e,createBrowserReceiver:()=>Gmt,createInspector:()=>cV,createSkyInspector:()=>Xmt,createWebSocketInspector:()=>Qmt,createWebSocketReceiver:()=>Jmt});O6e.exports=Rmt(I6e);var Omt=MR(R5e()),Dmt=(_R(),qR(jre));function Lmt(t){return typeof t=="string"?{type:t}:t}var M6e=typeof process<"u"&&typeof process.versions?.node<"u"&&typeof document>"u",C4={devDependencies:{"@changesets/changelog-github":"^0.5.0","@changesets/cli":"^2.27.7","@types/jsdom":"^21.1.7","@types/uuid":"^9.0.8",jsdom:"^23.2.0",tsup:"^8.1.0",typescript:"^5.5.3",vitest:"^1.6.0",xstate:"^5.14.0"},name:"@statelyai/inspect",version:"0.4.0",description:"Inspection utilities for state, actors, workflows, and state machines.",main:"dist/index.js",repository:"https://github.com/statelyai/inspect.git",author:"David Khourshid <davidkpiano@gmail.com>",license:"MIT",dependencies:{"fast-safe-stringify":"^2.1.1","isomorphic-ws":"^5.0.0",partysocket:"^0.0.25","safe-stable-stringify":"^2.4.3",superjson:"^1.13.3",uuid:"^9.0.1"},peerDependencies:{xstate:"^5.5.1"},scripts:{build:"tsup src/index.ts --dts",watch:"tsup src/index.ts --dts --watch",test:"vitest",prepublishOnly:"tsup src/index.ts --dts",changeset:"changeset",release:"changeset publish",version:"changeset version",dev:"yarn build && ./scripts/dev.sh"},publishConfig:{access:"public"},packageManager:"pnpm@8.11.0"};function Bmt(t){typeof window<"u"?(window.requestIdleCallback||window.requestAnimationFrame)(t):setTimeout(t,0)}var aV=MR(qre());function Fmt(t){let e=t;do e=e._parent;while(e?._parent);return e}function Nmt(t){return(typeof t=="string"?void 0:Fmt(t)?.sessionId)??void 0}var vie={filter:()=>!0,serialize:t=>t,autoStart:!0,maxDeferredEvents:200,sanitizeEvent:t=>t,sanitizeContext:t=>t};function cV(t,e){function r(n){if(e?.filter&&!e.filter(n))return;let o=e?.sanitizeContext||e?.sanitizeEvent?n:{...n};e?.sanitizeContext&&(o.type==="@xstate.actor"||o.type==="@xstate.snapshot")&&(o.snapshot={...o.snapshot,context:e.sanitizeContext(o.snapshot.context)}),e?.sanitizeEvent&&(o.type==="@xstate.event"||o.type==="@xstate.snapshot")&&(o.event=e.sanitizeEvent(o.event));let s=e?.serialize?.(o)??o;t.send(s)}return{adapter:t,actor:(n,o,s)=>{let a=typeof n=="string"?n:n.sessionId,u=n?.logic?.config,p=u?(0,aV.default)(u):void 0,m=s?.rootId??typeof n=="string"?void 0:Nmt(n),x=s?.parentId??typeof n=="string"?void 0:n._parent?.sessionId,M=u?u.id:a;r({type:"@xstate.actor",name:M,sessionId:a,createdAt:Date.now().toString(),_version:C4.version,rootId:m,parentId:x,id:null,definition:p,snapshot:o??{status:"active"}})},event:(n,o,s)=>{let a=typeof n=="string"?n:n.sessionId,u=s?.source?typeof s.source=="string"?s.source:s.source.sessionId:void 0;r({type:"@xstate.event",sourceId:u,sessionId:a,event:Lmt(o),id:Math.random().toString(),createdAt:Date.now().toString(),rootId:"anonymous",_version:C4.version})},snapshot:(n,o,s)=>{let a=typeof n=="string"?n:n.sessionId;r({type:"@xstate.snapshot",snapshot:{status:"active",...o},event:s?.event??{type:""},sessionId:a,id:null,createdAt:Date.now().toString(),rootId:"anonymous",_version:C4.version})},inspect:{next:n=>{Bmt(function(){let s=zmt(n);s&&r(s)})}},start(){t.start?.()},stop(){t.stop?.()}}}function zmt(t){switch(t.type){case"@xstate.actor":{let e=t.actorRef,i=e?.logic?.config,n=e.id;n===e.sessionId&&i&&(n=i.id);let o=typeof i=="object"?(0,aV.default)(i,(s,a)=>typeof a=="function"?{type:a.name}:a):(0,aV.default)({id:n});return{name:n,type:"@xstate.actor",definition:o,_version:C4.version,createdAt:Date.now().toString(),id:null,rootId:t.rootId,parentId:t.actorRef._parent?.sessionId,sessionId:t.actorRef.sessionId,snapshot:t.actorRef.getSnapshot()}}case"@xstate.event":return{type:"@xstate.event",event:t.event,sourceId:t.sourceRef?.sessionId,sessionId:t.actorRef.sessionId,_version:C4.version,createdAt:Date.now().toString(),id:null,rootId:t.rootId};case"@xstate.snapshot":return{type:"@xstate.snapshot",event:t.event,snapshot:JSON.parse((0,aV.default)(t.snapshot)),sessionId:t.actorRef.sessionId,_version:C4.version,createdAt:Date.now().toString(),id:null,rootId:t.rootId};default:{if(t.type.startsWith("@xstate."))return;console.warn(`Unhandled inspection event type: ${t.type}`);return}}}var Umt=class{constructor(){}start(){}stop(){}send(t){}},Vmt="@statelyai.connected";function jmt(t){return typeof t=="object"&&t!==null&&typeof t.type=="string"}function $mt(t){return typeof t=="object"&&t!==null&&typeof t.type=="string"&&typeof t._version=="string"}function k6e(t){let e=t?.window??(typeof window>"u"?void 0:window);if(!e)return console.error("Window does not exist; inspector cannot be started."),new Umt;let r={...vie,url:"https://stately.ai/inspect",filter:()=>!0,serialize:o=>JSON.parse((0,Omt.default)(o)),autoStart:!0,iframe:null,...t,window:e},i=new Hmt(r),n=cV(i,r);return r.autoStart&&n.start(),n}var Wmt={replayCount:0,window:typeof window<"u"?window:void 0};function Gmt(t){let r={...Wmt,...t}.window,i=r.self===r.top?r.opener:r.parent,n=new Set;r.addEventListener("message",s=>{$mt(s.data)&&n.forEach(a=>a.next?.(s.data))});let o={subscribe(s){let a=(0,Dmt.toObserver)(s);return n.add(a),{unsubscribe(){n.delete(a)}}}};return i&&i.postMessage({type:Vmt},"*"),o}var Hmt=class{constructor(t){this.options=t}status="disconnected";deferredEvents=[];targetWindow=null;start(){this.targetWindow=this.options.iframe?null:this.options.window.open(String(this.options.url),"xstateinspector"),this.options.iframe&&(this.options.iframe.addEventListener("load",()=>{this.targetWindow=this.options.iframe?.contentWindow??null}),this.options.iframe?.setAttribute("src",String(this.options.url))),this.options.window.addEventListener("message",t=>{jmt(t.data)&&t.data.type==="@statelyai.connected"&&(this.status="connected",this.deferredEvents.forEach(e=>{let r=this.options.serialize(e);this.targetWindow?.postMessage(r,"*")}))})}stop(){this.targetWindow?.postMessage({type:"@statelyai.disconnected"},"*"),this.status="disconnected"}send(t){if(this.options.filter(t)){if(this.options.send)this.options.send(t);else if(this.status==="connected"){let r=this.options.serialize(t);this.targetWindow?.postMessage(r,"*")}this.deferredEvents.push(t),this.deferredEvents.length>this.options.maxDeferredEvents&&this.deferredEvents.shift()}}},qmt=MR(LPe()),E6e=o6e(),Ymt=T6e(),C6e=!1;function Xmt(t={}){let{host:e,apiBaseURL:r}={host:C6e?"localhost:1999":"stately-sky-beta.mellson.partykit.dev",apiBaseURL:C6e?"http://localhost:3000/registry/api/sky":"https://stately.ai/registry/api/sky"},i=r.replace("/api/sky",""),{apiKey:n,onerror:o,...s}=t,a=(0,Ymt.v4)(),u=`inspect-${a}`,p=new qmt.default({host:e,room:u,WebSocket:M6e?(yie(),qR(Aie)):void 0}),m=`${i}/inspect/${a}`;return p.onerror=o??console.error,p.onopen=()=>{console.log("Connected to Sky, link to your live inspect session:"),console.log(m)},M6e?cV({...s,send(x){let M=n?{apiKey:n,...x}:x;p.send((0,E6e.stringify)(M))}}):k6e({...s,url:m,send(x){let M=n?{apiKey:n,...x}:x;p.send((0,E6e.stringify)(M))}})}var R6e=MR((yie(),qR(Aie))),_ie=MR(qre()),Zmt=(_R(),qR(jre)),Kmt=class{ws;status="closed";deferredEvents=[];options;constructor(t){this.options={...vie,filter:()=>!0,serialize:e=>JSON.parse((0,_ie.default)(e)),autoStart:!0,url:"ws://localhost:8080",...t}}start(){let t=()=>{this.ws=new R6e.default(this.options.url),this.ws.onopen=()=>{console.log("websocket open"),this.status="open",this.deferredEvents.forEach(e=>{let r=vie.serialize(e),i=this.options.serialize(r);this.ws.send((0,_ie.default)(i))})},this.ws.onclose=()=>{console.log("websocket closed")},this.ws.onerror=async e=>{console.error("websocket error",e),await new Promise(r=>setTimeout(r,5e3)),console.warn("restarting"),t()},this.ws.onmessage=e=>{typeof e.data=="string"&&console.log("message",e.data)}};t()}stop(){this.ws.close(),this.status="closed"}send(t){this.status==="open"?this.ws.send((0,_ie.default)(t)):(this.deferredEvents.push(t),this.deferredEvents.length>this.options.maxDeferredEvents&&this.deferredEvents.shift())}};function Qmt(t){let e=new Kmt(t);return cV(e,t)}function Jmt(t){let e={server:"ws://localhost:8080",...t},r=new Set,i=new R6e.default(e.server);return i.onopen=()=>{console.log("websocket open"),i.onmessage=o=>{if(typeof o.data!="string")return;console.log("message",o.data);let s=JSON.parse(o.data);r.forEach(a=>{a.next?.(s)})}},{subscribe(o){let s=(0,Zmt.toObserver)(o);return r.add(s),{unsubscribe(){r.delete(s)}}}}}});var B6e=nr(L6e=>{"use strict";var P4=$t();function egt(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tgt=typeof Object.is=="function"?Object.is:egt,rgt=P4.useState,igt=P4.useEffect,ngt=P4.useLayoutEffect,ogt=P4.useDebugValue;function sgt(t,e){var r=e(),i=rgt({inst:{value:r,getSnapshot:e}}),n=i[0].inst,o=i[1];return ngt(function(){n.value=r,n.getSnapshot=e,bie(n)&&o({inst:n})},[t,r,e]),igt(function(){return bie(n)&&o({inst:n}),t(function(){bie(n)&&o({inst:n})})},[t]),ogt(r),r}function bie(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!tgt(t,r)}catch{return!0}}function agt(t,e){return e()}var lgt=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?agt:sgt;L6e.useSyncExternalStore=P4.useSyncExternalStore!==void 0?P4.useSyncExternalStore:lgt});var xie=nr((w3r,F6e)=>{"use strict";F6e.exports=B6e()});var z6e=nr(N6e=>{"use strict";var uV=$t(),cgt=xie();function ugt(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hgt=typeof Object.is=="function"?Object.is:ugt,dgt=cgt.useSyncExternalStore,fgt=uV.useRef,pgt=uV.useEffect,mgt=uV.useMemo,ggt=uV.useDebugValue;N6e.useSyncExternalStoreWithSelector=function(t,e,r,i,n){var o=fgt(null);if(o.current===null){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=mgt(function(){function u(k){if(!p){if(p=!0,m=k,k=i(k),n!==void 0&&s.hasValue){var F=s.value;if(n(F,k))return x=F}return x=k}if(F=x,hgt(m,k))return F;var j=i(k);return n!==void 0&&n(F,j)?(m=k,F):(m=k,x=j)}var p=!1,m,x,M=r===void 0?null:r;return[function(){return u(e())},M===null?void 0:function(){return u(M())}]},[e,r,i,n]);var a=dgt(t,o[0],o[1]);return pgt(function(){s.hasValue=!0,s.value=a},[a]),ggt(a),a}});var V6e=nr((T3r,U6e)=>{"use strict";U6e.exports=z6e()});var yu=Tt($t(),1),$ce=Tt(jce(),1),Wce=yu.createContext(null);function WOe(){let t=yu.useContext(Wce);if(!t)throw new Error("RenderContext not found");return t}function lE(){return WOe().model}function gh(t){let e=lE(),r=yu.useSyncExternalStore(n=>(e.on(`change:${t}`,n),()=>e.off(`change:${t}`,n)),()=>e.get(t)),i=yu.useCallback(n=>{e.set(t,typeof n=="function"?n(e.get(t)):n),e.save_changes()},[e,t]);return[r,i]}function Gce(t){return({el:e,model:r,experimental:i})=>{let n=$ce.createRoot(e);return n.render(yu.createElement(yu.StrictMode,null,yu.createElement(Wce.Provider,{value:{model:r,experimental:i}},yu.createElement(t)))),()=>n.unmount()}}var SO=Tt($t(),1);function cE(t={}){let{strict:e=!0,errorMessage:r="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:i}=t,n=SO.createContext(void 0);n.displayName=i;function o(){var s;let a=SO.useContext(n);if(!a&&e){let u=new Error(r);throw u.name="ContextError",(s=Error.captureStackTrace)==null||s.call(Error,u,o),u}return a}return[n.Provider,o,n]}var uE=Tt($t(),1);function Hce(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var GOe=Hce();function LW(t){return{UNSAFE_getDOMNode(){return t.current}}}function hE(t){let e=(0,uE.useRef)(null);return(0,uE.useImperativeHandle)(t,()=>e.current),e}function BW(t){return typeof t=="function"}var Dc=t=>t?"true":void 0;function qce(t){var e,r,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=qce(t[e]))&&(i&&(i+=" "),i+=r);else for(e in t)t[e]&&(i&&(i+=" "),i+=e);return i}function dE(...t){for(var e=0,r,i,n="";e<t.length;)(r=t[e++])&&(i=qce(r))&&(n&&(n+=" "),n+=i);return n}var Yce={};function fE(t,e,...r){let n=`[Next UI]${e?` [${e}]`:" "}: ${t}`;typeof console>"u"||Yce[n]||(Yce[n]=!0)}var HOe=Object.create,Xce=Object.defineProperty,qOe=Object.getOwnPropertyDescriptor,Zce=Object.getOwnPropertyNames,YOe=Object.getPrototypeOf,XOe=Object.prototype.hasOwnProperty,TO=(t,e)=>function(){return e||(0,t[Zce(t)[0]])((e={exports:{}}).exports,e),e.exports},ZOe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Zce(e))!XOe.call(t,n)&&n!==r&&Xce(t,n,{get:()=>e[n],enumerable:!(i=qOe(e,n))||i.enumerable});return t},Kce=(t,e,r)=>(r=t!=null?HOe(YOe(t)):{},ZOe(e||!t||!t.__esModule?Xce(r,"default",{value:t,enumerable:!0}):r,t));var KOe=TO({"../../../node_modules/.pnpm/react@18.2.0/node_modules/react/cjs/react.production.min.js"(t){"use strict";var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),M=Symbol.iterator;function k(nt){return nt===null||typeof nt!="object"?null:(nt=M&&nt[M]||nt["@@iterator"],typeof nt=="function"?nt:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,H={};function W(nt,Et,yr){this.props=nt,this.context=Et,this.refs=H,this.updater=yr||F}W.prototype.isReactComponent={},W.prototype.setState=function(nt,Et){if(typeof nt!="object"&&typeof nt!="function"&&nt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,nt,Et,"setState")},W.prototype.forceUpdate=function(nt){this.updater.enqueueForceUpdate(this,nt,"forceUpdate")};function Z(){}Z.prototype=W.prototype;function Y(nt,Et,yr){this.props=nt,this.context=Et,this.refs=H,this.updater=yr||F}var ee=Y.prototype=new Z;ee.constructor=Y,j(ee,W.prototype),ee.isPureReactComponent=!0;var ce=Array.isArray,ge=Object.prototype.hasOwnProperty,Se={current:null},ne={key:!0,ref:!0,__self:!0,__source:!0};function pe(nt,Et,yr){var xr,oi={},jr=null,zi=null;if(Et!=null)for(xr in Et.ref!==void 0&&(zi=Et.ref),Et.key!==void 0&&(jr=""+Et.key),Et)ge.call(Et,xr)&&!ne.hasOwnProperty(xr)&&(oi[xr]=Et[xr]);var on=arguments.length-2;if(on===1)oi.children=yr;else if(1<on){for(var Ki=Array(on),hn=0;hn<on;hn++)Ki[hn]=arguments[hn+2];oi.children=Ki}if(nt&&nt.defaultProps)for(xr in on=nt.defaultProps,on)oi[xr]===void 0&&(oi[xr]=on[xr]);return{$$typeof:e,type:nt,key:jr,ref:zi,props:oi,_owner:Se.current}}function ue(nt,Et){return{$$typeof:e,type:nt.type,key:Et,ref:nt.ref,props:nt.props,_owner:nt._owner}}function Le(nt){return typeof nt=="object"&&nt!==null&&nt.$$typeof===e}function We(nt){var Et={"=":"=0",":":"=2"};return"$"+nt.replace(/[=:]/g,function(yr){return Et[yr]})}var ze=/\/+/g;function rt(nt,Et){return typeof nt=="object"&&nt!==null&&nt.key!=null?We(""+nt.key):Et.toString(36)}function at(nt,Et,yr,xr,oi){var jr=typeof nt;(jr==="undefined"||jr==="boolean")&&(nt=null);var zi=!1;if(nt===null)zi=!0;else switch(jr){case"string":case"number":zi=!0;break;case"object":switch(nt.$$typeof){case e:case r:zi=!0}}if(zi)return zi=nt,oi=oi(zi),nt=xr===""?"."+rt(zi,0):xr,ce(oi)?(yr="",nt!=null&&(yr=nt.replace(ze,"$&/")+"/"),at(oi,Et,yr,"",function(hn){return hn})):oi!=null&&(Le(oi)&&(oi=ue(oi,yr+(!oi.key||zi&&zi.key===oi.key?"":(""+oi.key).replace(ze,"$&/")+"/")+nt)),Et.push(oi)),1;if(zi=0,xr=xr===""?".":xr+":",ce(nt))for(var on=0;on<nt.length;on++){jr=nt[on];var Ki=xr+rt(jr,on);zi+=at(jr,Et,yr,Ki,oi)}else if(Ki=k(nt),typeof Ki=="function")for(nt=Ki.call(nt),on=0;!(jr=nt.next()).done;)jr=jr.value,Ki=xr+rt(jr,on++),zi+=at(jr,Et,yr,Ki,oi);else if(jr==="object")throw Et=String(nt),Error("Objects are not valid as a React child (found: "+(Et==="[object Object]"?"object with keys {"+Object.keys(nt).join(", ")+"}":Et)+"). If you meant to render a collection of children, use an array instead.");return zi}function Wt(nt,Et,yr){if(nt==null)return nt;var xr=[],oi=0;return at(nt,xr,"","",function(jr){return Et.call(yr,jr,oi++)}),xr}function It(nt){if(nt._status===-1){var Et=nt._result;Et=Et(),Et.then(function(yr){(nt._status===0||nt._status===-1)&&(nt._status=1,nt._result=yr)},function(yr){(nt._status===0||nt._status===-1)&&(nt._status=2,nt._result=yr)}),nt._status===-1&&(nt._status=0,nt._result=Et)}if(nt._status===1)return nt._result.default;throw nt._result}var Bt={current:null},Qt={transition:null},hr={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Qt,ReactCurrentOwner:Se};t.Children={map:Wt,forEach:function(nt,Et,yr){Wt(nt,function(){Et.apply(this,arguments)},yr)},count:function(nt){var Et=0;return Wt(nt,function(){Et++}),Et},toArray:function(nt){return Wt(nt,function(Et){return Et})||[]},only:function(nt){if(!Le(nt))throw Error("React.Children.only expected to receive a single React element child.");return nt}},t.Component=W,t.Fragment=i,t.Profiler=o,t.PureComponent=Y,t.StrictMode=n,t.Suspense=p,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hr,t.cloneElement=function(nt,Et,yr){if(nt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+nt+".");var xr=j({},nt.props),oi=nt.key,jr=nt.ref,zi=nt._owner;if(Et!=null){if(Et.ref!==void 0&&(jr=Et.ref,zi=Se.current),Et.key!==void 0&&(oi=""+Et.key),nt.type&&nt.type.defaultProps)var on=nt.type.defaultProps;for(Ki in Et)ge.call(Et,Ki)&&!ne.hasOwnProperty(Ki)&&(xr[Ki]=Et[Ki]===void 0&&on!==void 0?on[Ki]:Et[Ki])}var Ki=arguments.length-2;if(Ki===1)xr.children=yr;else if(1<Ki){on=Array(Ki);for(var hn=0;hn<Ki;hn++)on[hn]=arguments[hn+2];xr.children=on}return{$$typeof:e,type:nt.type,key:oi,ref:jr,props:xr,_owner:zi}},t.createContext=function(nt){return nt={$$typeof:a,_currentValue:nt,_currentValue2:nt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},nt.Provider={$$typeof:s,_context:nt},nt.Consumer=nt},t.createElement=pe,t.createFactory=function(nt){var Et=pe.bind(null,nt);return Et.type=nt,Et},t.createRef=function(){return{current:null}},t.forwardRef=function(nt){return{$$typeof:u,render:nt}},t.isValidElement=Le,t.lazy=function(nt){return{$$typeof:x,_payload:{_status:-1,_result:nt},_init:It}},t.memo=function(nt,Et){return{$$typeof:m,type:nt,compare:Et===void 0?null:Et}},t.startTransition=function(nt){var Et=Qt.transition;Qt.transition={};try{nt()}finally{Qt.transition=Et}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(nt,Et){return Bt.current.useCallback(nt,Et)},t.useContext=function(nt){return Bt.current.useContext(nt)},t.useDebugValue=function(){},t.useDeferredValue=function(nt){return Bt.current.useDeferredValue(nt)},t.useEffect=function(nt,Et){return Bt.current.useEffect(nt,Et)},t.useId=function(){return Bt.current.useId()},t.useImperativeHandle=function(nt,Et,yr){return Bt.current.useImperativeHandle(nt,Et,yr)},t.useInsertionEffect=function(nt,Et){return Bt.current.useInsertionEffect(nt,Et)},t.useLayoutEffect=function(nt,Et){return Bt.current.useLayoutEffect(nt,Et)},t.useMemo=function(nt,Et){return Bt.current.useMemo(nt,Et)},t.useReducer=function(nt,Et,yr){return Bt.current.useReducer(nt,Et,yr)},t.useRef=function(nt){return Bt.current.useRef(nt)},t.useState=function(nt){return Bt.current.useState(nt)},t.useSyncExternalStore=function(nt,Et,yr){return Bt.current.useSyncExternalStore(nt,Et,yr)},t.useTransition=function(){return Bt.current.useTransition()},t.version="18.2.0"}}),Ggt=TO({"../../../node_modules/.pnpm/react@18.2.0/node_modules/react/cjs/react.development.js"(t,e){"use strict"}}),QOe=TO({"../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"(t,e){"use strict";e.exports=KOe()}}),Hgt=Kce(QOe());function FW(t){return`${t}-${Math.floor(Math.random()*1e6)}`}function l1(t){if(!t||typeof t!="object")return"";try{return JSON.stringify(t)}catch{return""}}function NW(t,e,r){return Math.min(Math.max(t,e),r)}function Qce(t,e){if(t!=null){if(BW(t)){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function zW(...t){return e=>{t.forEach(r=>Qce(r,e))}}var UW=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","enterKeyHint","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),VW=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]);var Jce=/^(data-.*)$/,JOe=/^(aria-.*)$/,MO=/^(on[A-Z].*)$/;function pE(t,e={}){let{labelable:r=!0,enabled:i=!0,propNames:n,omitPropNames:o,omitEventNames:s,omitDataProps:a,omitEventProps:u}=e,p={};if(!i)return t;for(let m in t)o?.has(m)||s?.has(m)&&MO.test(m)||MO.test(m)&&!VW.has(m)||a&&Jce.test(m)||u&&MO.test(m)||(Object.prototype.hasOwnProperty.call(t,m)&&(UW.has(m)||r&&JOe.test(m)||n?.has(m)||Jce.test(m))||MO.test(m))&&(p[m]=t[m]);return p}var[jW,c1]=cE({name:"ProviderContext",strict:!1});var eDe=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),tDe=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function EO(t){if(Intl.Locale){let r=new Intl.Locale(t).maximize(),i=typeof r.getTextInfo=="function"?r.getTextInfo():r.textInfo;if(i)return i.direction==="rtl";if(r.script)return eDe.has(r.script)}let e=t.split("-")[0];return tDe.has(e)}var PO=Tt($t(),1);var ll=Tt($t(),1),CO={prefix:String(Math.round(Math.random()*1e10)),current:0},eue=ll.default.createContext(CO),rDe=ll.default.createContext(!1);var iDe=!!(typeof window<"u"&&window.document&&window.document.createElement),$W=new WeakMap;function nDe(t=!1){let e=(0,ll.useContext)(eue),r=(0,ll.useRef)(null);if(r.current===null&&!t){var i,n;let o=(n=ll.default.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||n===void 0||(i=n.ReactCurrentOwner)===null||i===void 0?void 0:i.current;if(o){let s=$W.get(o);s==null?$W.set(o,{id:e.current,state:o.memoizedState}):o.memoizedState!==s.state&&(e.current=s.id,$W.delete(o))}r.current=++e.current}return r.current}function oDe(t){let e=(0,ll.useContext)(eue);e===CO&&!iDe&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let r=nDe(!!t),i=`react-aria${e.prefix}`;return t||`${i}-${r}`}function sDe(t){let e=ll.default.useId(),[r]=(0,ll.useState)(d2()),i=r?"react-aria":`react-aria${CO.prefix}`;return t||`${i}-${e}`}var WW=typeof ll.default.useId=="function"?sDe:oDe;function aDe(){return!1}function lDe(){return!0}function cDe(t){return()=>{}}function d2(){return typeof ll.default.useSyncExternalStore=="function"?ll.default.useSyncExternalStore(cDe,aDe,lDe):(0,ll.useContext)(rDe)}var uDe=Symbol.for("react-aria.i18n.locale");function rue(){let t=typeof window<"u"&&window[uDe]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:EO(t)?"rtl":"ltr"}}var GW=rue(),mE=new Set;function tue(){GW=rue();for(let t of mE)t(GW)}function HW(){let t=d2(),[e,r]=(0,PO.useState)(GW);return(0,PO.useEffect)(()=>(mE.size===0&&window.addEventListener("languagechange",tue),mE.add(r),()=>{mE.delete(r),mE.size===0&&window.removeEventListener("languagechange",tue)}),[]),t?{locale:"en-US",direction:"ltr"}:e}var f2=Tt($t(),1),iue=f2.default.createContext(null);function qW(t){let{locale:e,children:r}=t,i=HW(),n=f2.default.useMemo(()=>e?{locale:e,direction:EO(e)?"rtl":"ltr"}:i,[i,e]);return f2.default.createElement(iue.Provider,{value:n},r)}function YW(){let t=HW();return(0,f2.useContext)(iue)||t}function oue(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Sr(t,e,r,i){function n(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(m){try{p(i.next(m))}catch(x){s(x)}}function u(m){try{p(i.throw(m))}catch(x){s(x)}}function p(m){m.done?o(m.value):n(m.value).then(a,u)}p((i=i.apply(t,e||[])).next())})}function nue(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bi(t){return this instanceof Bi?(this.v=t,this):new Bi(t)}function Ah(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,o=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),n[Symbol.asyncIterator]=function(){return this},n;function s(k){return function(F){return Promise.resolve(F).then(k,x)}}function a(k,F){i[k]&&(n[k]=function(j){return new Promise(function(H,W){o.push([k,j,H,W])>1||u(k,j)})},F&&(n[k]=F(n[k])))}function u(k,F){try{p(i[k](F))}catch(j){M(o[0][3],j)}}function p(k){k.value instanceof Bi?Promise.resolve(k.value.v).then(m,x):M(o[0][2],k)}function m(k){u("next",k)}function x(k){u("throw",k)}function M(k,F){k(F),o.shift(),o.length&&u(o[0][0],o[0][1])}}function p2(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,o){e[n]=t[n]?function(s){return(r=!r)?{value:Bi(t[n](s)),done:!1}:o?o(s):s}:o}}function If(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof nue=="function"?nue(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(o){r[o]=t[o]&&function(s){return new Promise(function(a,u){s=t[o](s),n(a,u,s.done,s.value)})}}function n(o,s,a,u){Promise.resolve(u).then(function(p){o({value:p,done:a})},s)}}function sue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aue(t,e,r){sue(t,e),e.set(t,r)}var lue=Tt($t(),1),yh=typeof document<"u"?lue.default.useLayoutEffect:()=>{};var IO=Tt($t(),1);function Ad(t){let e=(0,IO.useRef)(null);return yh(()=>{e.current=t},[t]),(0,IO.useCallback)((...r)=>{let i=e.current;return i?.(...r)},[])}var Ey=Tt($t(),1);var hDe=!!(typeof window<"u"&&window.document&&window.document.createElement),My=new Map;function XW(t){let[e,r]=(0,Ey.useState)(t),i=(0,Ey.useRef)(null),n=WW(e),o=(0,Ey.useCallback)(s=>{i.current=s},[]);return hDe&&(My.has(n)&&!My.get(n).includes(o)?My.set(n,[...My.get(n),o]):My.set(n,[o])),yh(()=>{let s=n;return()=>{My.delete(s)}},[n]),(0,Ey.useEffect)(()=>{let s=i.current;s&&(i.current=null,r(s))}),n}function ZW(t,e){if(t===e)return t;let r=My.get(t);if(r)return r.forEach(n=>n(e)),e;let i=My.get(e);return i?(i.forEach(n=>n(t)),t):e}function u1(...t){return(...e)=>{for(let r of t)typeof r=="function"&&r(...e)}}var Js=t=>{var e;return(e=t?.ownerDocument)!==null&&e!==void 0?e:document},_h=t=>t&&"window"in t&&t.window===t?t:Js(t).defaultView||window;function cue(t){var e,r,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=cue(t[e]))&&(i&&(i+=" "),i+=r)}else for(r in t)t[r]&&(i&&(i+=" "),i+=r);return i}function dDe(){for(var t,e,r=0,i="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=cue(t))&&(i&&(i+=" "),i+=e);return i}var uue=dDe;function fs(...t){let e={...t[0]};for(let r=1;r<t.length;r++){let i=t[r];for(let n in i){let o=e[n],s=i[n];typeof o=="function"&&typeof s=="function"&&n[0]==="o"&&n[1]==="n"&&n.charCodeAt(2)>=65&&n.charCodeAt(2)<=90?e[n]=u1(o,s):(n==="className"||n==="UNSAFE_className")&&typeof o=="string"&&typeof s=="string"?e[n]=uue(o,s):n==="id"&&o&&s?e.id=ZW(o,s):e[n]=s!==void 0?s:o}}return e}var fDe=new Set(["id"]),pDe=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),mDe=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),gDe=/^(data-.*)$/;function gE(t,e={}){let{labelable:r,isLink:i,propNames:n}=e,o={};for(let s in t)Object.prototype.hasOwnProperty.call(t,s)&&(fDe.has(s)||r&&pDe.has(s)||i&&mDe.has(s)||n?.has(s)||gDe.test(s))&&(o[s]=t[s]);return o}function kf(t){if(ADe())t.focus({preventScroll:!0});else{let e=yDe(t);t.focus(),_De(e)}}var kO=null;function ADe(){if(kO==null){kO=!1;try{document.createElement("div").focus({get preventScroll(){return kO=!0,!0}})}catch{}}return kO}function yDe(t){let e=t.parentNode,r=[],i=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==i;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&r.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return i instanceof HTMLElement&&r.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),r}function _De(t){for(let{element:e,scrollTop:r,scrollLeft:i}of t)e.scrollTop=r,e.scrollLeft=i}function RO(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(r=>t.test(r.brand)))||t.test(window.navigator.userAgent)}function KW(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Ym(t){let e=null;return()=>(e==null&&(e=t()),e)}var Jp=Ym(function(){return KW(/^Mac/i)}),hue=Ym(function(){return KW(/^iPhone/i)}),OO=Ym(function(){return KW(/^iPad/i)||Jp()&&navigator.maxTouchPoints>1}),h1=Ym(function(){return hue()||OO()}),vDe=Ym(function(){return Jp()||h1()}),AE=Ym(function(){return RO(/AppleWebKit/i)&&!due()}),due=Ym(function(){return RO(/Chrome/i)}),m2=Ym(function(){return RO(/Android/i)}),QW=Ym(function(){return RO(/Firefox/i)});var d1=Tt($t(),1),bDe=(0,d1.createContext)({isNative:!0,open:xDe,useHref:t=>t});function JW(t){let{children:e,navigate:r,useHref:i}=t,n=(0,d1.useMemo)(()=>({isNative:!1,open:(o,s,a,u)=>{pue(o,p=>{fue(p,s)?r(a,u):Xm(p,s)})},useHref:i||(o=>o)}),[r,i]);return d1.default.createElement(bDe.Provider,{value:n},e)}function fue(t,e){let r=t.getAttribute("target");return(!r||r==="_self")&&t.origin===location.origin&&!t.hasAttribute("download")&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey}function Xm(t,e,r=!0){var i,n;let{metaKey:o,ctrlKey:s,altKey:a,shiftKey:u}=e;QW()&&(!((n=window.event)===null||n===void 0||(i=n.type)===null||i===void 0)&&i.startsWith("key"))&&t.target==="_blank"&&(Jp()?o=!0:s=!0);let p=AE()&&Jp()&&!OO()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:o,ctrlKey:s,altKey:a,shiftKey:u}):new MouseEvent("click",{metaKey:o,ctrlKey:s,altKey:a,shiftKey:u,bubbles:!0,cancelable:!0});Xm.isOpening=r,kf(t),t.dispatchEvent(p),Xm.isOpening=!1}Xm.isOpening=!1;function pue(t,e){if(t instanceof HTMLAnchorElement)e(t);else if(t.hasAttribute("data-href")){let r=document.createElement("a");r.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(r.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(r.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(r.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(r.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(r.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(r),e(r),t.removeChild(r)}}function xDe(t,e){pue(t,r=>Xm(r,e))}var g2=new Map,eG=new Set;function mue(){if(typeof window>"u")return;function t(i){return"propertyName"in i}let e=i=>{if(!t(i)||!i.target)return;let n=g2.get(i.target);n||(n=new Set,g2.set(i.target,n),i.target.addEventListener("transitioncancel",r,{once:!0})),n.add(i.propertyName)},r=i=>{if(!t(i)||!i.target)return;let n=g2.get(i.target);if(n&&(n.delete(i.propertyName),n.size===0&&(i.target.removeEventListener("transitioncancel",r),g2.delete(i.target)),g2.size===0)){for(let o of eG)o();eG.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",r)}typeof document<"u"&&(document.readyState!=="loading"?mue():document.addEventListener("DOMContentLoaded",mue));function yE(t){requestAnimationFrame(()=>{g2.size===0?t():eG.add(t)})}var Cy=Tt($t(),1);function tG(){let t=(0,Cy.useRef)(new Map),e=(0,Cy.useCallback)((n,o,s,a)=>{let u=a?.once?(...p)=>{t.current.delete(s),s(...p)}:s;t.current.set(s,{type:o,eventTarget:n,fn:u,options:a}),n.addEventListener(o,s,a)},[]),r=(0,Cy.useCallback)((n,o,s,a)=>{var u;let p=((u=t.current.get(s))===null||u===void 0?void 0:u.fn)||s;n.removeEventListener(o,p,a),t.current.delete(s)},[]),i=(0,Cy.useCallback)(()=>{t.current.forEach((n,o)=>{r(n.eventTarget,n.type,o,n.options)})},[r]);return(0,Cy.useEffect)(()=>i,[i]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:i}}var gue=Tt($t(),1);function wDe(){return typeof window.ResizeObserver<"u"}function DO(t){let{ref:e,box:r,onResize:i}=t;(0,gue.useEffect)(()=>{let n=e?.current;if(n)if(wDe()){let o=new window.ResizeObserver(s=>{s.length&&i()});return o.observe(n,{box:r}),()=>{n&&o.unobserve(n)}}else return window.addEventListener("resize",i,!1),()=>{window.removeEventListener("resize",i,!1)}},[i,e,r])}function _E(t,e){yh(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref&&(t.ref.current=null)}})}function A2(t){return t.mozInputSource===0&&t.isTrusted?!0:m2()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function rG(t){return!m2()&&t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}var Py=Tt($t(),1);function iG(t,e,r){let[i,n]=(0,Py.useState)(t||e),o=(0,Py.useRef)(t!==void 0),s=t!==void 0;(0,Py.useEffect)(()=>{let p=o.current;p!==s&&console.warn(`WARN: A component changed from ${p?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}.`),o.current=s},[s]);let a=s?t:i,u=(0,Py.useCallback)((p,...m)=>{let x=(M,...k)=>{r&&(Object.is(a,M)||r(M,...k)),s||(a=M)};typeof p=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),n((k,...F)=>{let j=p(s?a:k,...F);return x(j,...m),s?k:j})):(s||n(p),x(p,...m))},[s,a,r]);return[a,u]}function y2(t,e=-1/0,r=1/0){return Math.min(Math.max(t,e),r)}var e0={top:"top",bottom:"top",left:"left",right:"left"},BO={top:"bottom",bottom:"top",left:"right",right:"left"},TDe={top:"left",left:"top"},oG={top:"height",left:"width"},wue={width:"totalWidth",height:"totalHeight"},LO={},cl=typeof document<"u"?window.visualViewport:null;function Aue(t){let e=0,r=0,i=0,n=0,o=0,s=0,a={};var u;let p=((u=cl?.scale)!==null&&u!==void 0?u:1)>1;if(t.tagName==="BODY"){let F=document.documentElement;i=F.clientWidth,n=F.clientHeight;var m;e=(m=cl?.width)!==null&&m!==void 0?m:i;var x;r=(x=cl?.height)!==null&&x!==void 0?x:n,a.top=F.scrollTop||t.scrollTop,a.left=F.scrollLeft||t.scrollLeft,cl&&(o=cl.offsetTop,s=cl.offsetLeft)}else({width:e,height:r,top:o,left:s}=_2(t)),a.top=t.scrollTop,a.left=t.scrollLeft,i=e,n=r;if(AE()&&(t.tagName==="BODY"||t.tagName==="HTML")&&p){a.top=0,a.left=0;var M;o=(M=cl?.pageTop)!==null&&M!==void 0?M:0;var k;s=(k=cl?.pageLeft)!==null&&k!==void 0?k:0}return{width:e,height:r,totalWidth:i,totalHeight:n,scroll:a,top:o,left:s}}function MDe(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function yue(t,e,r,i,n,o,s){var a;let u=(a=n.scroll[t])!==null&&a!==void 0?a:0,p=i[oG[t]],m=i.scroll[e0[t]]+o,x=p+i.scroll[e0[t]]-o,M=e-u+s[t]-i[e0[t]],k=e-u+r+s[t]-i[e0[t]];return M<m?m-M:k>x?Math.max(x-k,m-M):0}function EDe(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function _ue(t){if(LO[t])return LO[t];let[e,r]=t.split(" "),i=e0[e]||"right",n=TDe[i];e0[r]||(r="center");let o=oG[i],s=oG[n];return LO[t]={placement:e,crossPlacement:r,axis:i,crossAxis:n,size:o,crossSize:s},LO[t]}function nG(t,e,r,i,n,o,s,a,u,p){let{placement:m,crossPlacement:x,axis:M,crossAxis:k,size:F,crossSize:j}=i,H={};var W;H[k]=(W=t[k])!==null&&W!==void 0?W:0;var Z,Y,ee,ce;x==="center"?H[k]+=(((Z=t[j])!==null&&Z!==void 0?Z:0)-((Y=r[j])!==null&&Y!==void 0?Y:0))/2:x!==k&&(H[k]+=((ee=t[j])!==null&&ee!==void 0?ee:0)-((ce=r[j])!==null&&ce!==void 0?ce:0)),H[k]+=o;let ge=t[k]-r[j]+u+p,Se=t[k]+t[j]-u-p;if(H[k]=y2(H[k],ge,Se),m===M){let ne=a?s[F]:e[wue[F]];H[BO[M]]=Math.floor(ne-t[M]+n)}else H[M]=Math.floor(t[M]+t[F]+n);return H}function CDe(t,e,r,i,n,o,s,a){let u=i?r.height:e[wue.height];var p;let m=t.top!=null?r.top+t.top:r.top+(u-((p=t.bottom)!==null&&p!==void 0?p:0)-s);var x,M,k,F,j,H;let W=a!=="top"?Math.max(0,e.height+e.top+((x=e.scroll.top)!==null&&x!==void 0?x:0)-m-(((M=n.top)!==null&&M!==void 0?M:0)+((k=n.bottom)!==null&&k!==void 0?k:0)+o)):Math.max(0,m+s-(e.top+((F=e.scroll.top)!==null&&F!==void 0?F:0))-(((j=n.top)!==null&&j!==void 0?j:0)+((H=n.bottom)!==null&&H!==void 0?H:0)+o));return Math.min(e.height-o*2,W)}function vue(t,e,r,i,n,o){let{placement:s,axis:a,size:u}=o;var p,m;if(s===a)return Math.max(0,r[a]-t[a]-((p=t.scroll[a])!==null&&p!==void 0?p:0)+e[a]-((m=i[a])!==null&&m!==void 0?m:0)-i[BO[a]]-n);var x;return Math.max(0,t[u]+t[a]+t.scroll[a]-e[a]-r[a]-r[u]-((x=i[a])!==null&&x!==void 0?x:0)-i[BO[a]]-n)}function PDe(t,e,r,i,n,o,s,a,u,p,m,x,M,k,F,j){let H=_ue(t),{size:W,crossAxis:Z,crossSize:Y,placement:ee,crossPlacement:ce}=H,ge=nG(e,a,r,H,m,x,p,M,F,j),Se=m,ne=vue(a,p,e,n,o+m,H);if(s&&i[W]>ne){let xr=_ue(`${BO[ee]} ${ce}`),oi=nG(e,a,r,xr,m,x,p,M,F,j);vue(a,p,e,n,o+m,xr)>ne&&(H=xr,ge=oi,Se=m)}let pe="bottom";H.axis==="top"?H.placement==="top"?pe="top":H.placement==="bottom"&&(pe="bottom"):H.crossAxis==="top"&&(H.crossPlacement==="top"?pe="bottom":H.crossPlacement==="bottom"&&(pe="top"));let ue=yue(Z,ge[Z],r[Y],a,u,o,p);ge[Z]+=ue;let Le=CDe(ge,a,p,M,n,o,r.height,pe);k&&k<Le&&(Le=k),r.height=Math.min(r.height,Le),ge=nG(e,a,r,H,Se,x,p,M,F,j),ue=yue(Z,ge[Z],r[Y],a,u,o,p),ge[Z]+=ue;let We={},ze=e[Z]+.5*e[Y]-ge[Z]-n[e0[Z]],rt=F/2+j;var at,Wt,It,Bt;let Qt=e0[Z]==="left"?((at=n.left)!==null&&at!==void 0?at:0)+((Wt=n.right)!==null&&Wt!==void 0?Wt:0):((It=n.top)!==null&&It!==void 0?It:0)+((Bt=n.bottom)!==null&&Bt!==void 0?Bt:0),hr=r[Y]-Qt-F/2-j,nt=e[Z]+F/2-(ge[Z]+n[e0[Z]]),Et=e[Z]+e[Y]-F/2-(ge[Z]+n[e0[Z]]),yr=y2(ze,nt,Et);return We[Z]=y2(yr,rt,hr),{position:ge,maxHeight:Le,arrowOffsetLeft:We.left,arrowOffsetTop:We.top,placement:H.placement}}function Sue(t){let{placement:e,targetNode:r,overlayNode:i,scrollNode:n,padding:o,shouldFlip:s,boundaryElement:a,offset:u,crossOffset:p,maxHeight:m,arrowSize:x=0,arrowBoundaryOffset:M=0}=t,k=i instanceof HTMLElement?IDe(i):document.documentElement,F=k===document.documentElement,j=window.getComputedStyle(k).position,H=!!j&&j!=="static",W=F?_2(r):bue(r,k);if(!F){let{marginTop:We,marginLeft:ze}=window.getComputedStyle(r);W.top+=parseInt(We,10)||0,W.left+=parseInt(ze,10)||0}let Z=_2(i),Y=EDe(i);var ee,ce;Z.width+=((ee=Y.left)!==null&&ee!==void 0?ee:0)+((ce=Y.right)!==null&&ce!==void 0?ce:0);var ge,Se;Z.height+=((ge=Y.top)!==null&&ge!==void 0?ge:0)+((Se=Y.bottom)!==null&&Se!==void 0?Se:0);let ne=MDe(n),pe=Aue(a),ue=Aue(k),Le=a.tagName==="BODY"?_2(k):bue(k,a);return k.tagName==="HTML"&&a.tagName==="BODY"&&(ue.scroll.top=0,ue.scroll.left=0),PDe(e,W,Z,ne,Y,o,s,pe,ue,Le,u,p,H,m,x,M)}function _2(t){let{top:e,left:r,width:i,height:n}=t.getBoundingClientRect(),{scrollTop:o,scrollLeft:s,clientTop:a,clientLeft:u}=document.documentElement;return{top:e+o-a,left:r+s-u,width:i,height:n}}function bue(t,e){let r=window.getComputedStyle(t),i;if(r.position==="fixed"){let{top:n,left:o,width:s,height:a}=t.getBoundingClientRect();i={top:n,left:o,width:s,height:a}}else{i=_2(t);let n=_2(e),o=window.getComputedStyle(e);n.top+=(parseInt(o.borderTopWidth,10)||0)-e.scrollTop,n.left+=(parseInt(o.borderLeftWidth,10)||0)-e.scrollLeft,i.top-=n.top,i.left-=n.left}return i.top-=parseInt(r.marginTop,10)||0,i.left-=parseInt(r.marginLeft,10)||0,i}function IDe(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!xue(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!xue(e);)e=e.parentElement;return e||document.documentElement}function xue(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}var Tue=Tt($t(),1),kDe=new WeakMap;function Mue(t){let{triggerRef:e,isOpen:r,onClose:i}=t;(0,Tue.useEffect)(()=>{if(!r||i===null)return;let n=o=>{let s=o.target;if(!e.current||s instanceof Node&&!s.contains(e.current)||o.target instanceof HTMLInputElement||o.target instanceof HTMLTextAreaElement)return;let a=i||kDe.get(e.current);a&&a()};return window.addEventListener("scroll",n,!0),()=>{window.removeEventListener("scroll",n,!0)}},[r,i,e])}var t0=Tt($t(),1);var ea=typeof document<"u"?window.visualViewport:null;function sG(t){let{direction:e}=YW(),{arrowSize:r=0,targetRef:i,overlayRef:n,scrollRef:o=n,placement:s="bottom",containerPadding:a=12,shouldFlip:u=!0,boundaryElement:p=typeof document<"u"?document.body:null,offset:m=0,crossOffset:x=0,shouldUpdatePosition:M=!0,isOpen:k=!0,onClose:F,maxHeight:j,arrowBoundaryOffset:H=0}=t,[W,Z]=(0,t0.useState)(null),Y=[M,s,n.current,i.current,o.current,a,u,p,m,x,k,e,j,H,r],ee=(0,t0.useRef)(ea?.scale);(0,t0.useEffect)(()=>{k&&(ee.current=ea?.scale)},[k]);let ce=(0,t0.useCallback)(()=>{if(M===!1||!k||!n.current||!i.current||!p||ea?.scale!==ee.current)return;let ue=null;if(o.current&&o.current.contains(document.activeElement)){var Le;let Bt=(Le=document.activeElement)===null||Le===void 0?void 0:Le.getBoundingClientRect(),Qt=o.current.getBoundingClientRect();var We;if(ue={type:"top",offset:((We=Bt?.top)!==null&&We!==void 0?We:0)-Qt.top},ue.offset>Qt.height/2){ue.type="bottom";var ze;ue.offset=((ze=Bt?.bottom)!==null&&ze!==void 0?ze:0)-Qt.bottom}}let rt=n.current;if(!j&&n.current){var at;rt.style.top="0px",rt.style.bottom="";var Wt;rt.style.maxHeight=((Wt=(at=window.visualViewport)===null||at===void 0?void 0:at.height)!==null&&Wt!==void 0?Wt:window.innerHeight)+"px"}let It=Sue({placement:ODe(s,e),overlayNode:n.current,targetNode:i.current,scrollNode:o.current||n.current,padding:a,shouldFlip:u,boundaryElement:p,offset:m,crossOffset:x,maxHeight:j,arrowSize:r,arrowBoundaryOffset:H});if(It.position){if(rt.style.top="",rt.style.bottom="",rt.style.left="",rt.style.right="",Object.keys(It.position).forEach(Bt=>rt.style[Bt]=It.position[Bt]+"px"),rt.style.maxHeight=It.maxHeight!=null?It.maxHeight+"px":"",ue&&document.activeElement&&o.current){let Bt=document.activeElement.getBoundingClientRect(),Qt=o.current.getBoundingClientRect(),hr=Bt[ue.type]-Qt[ue.type];o.current.scrollTop+=hr-ue.offset}Z(It)}},Y);yh(ce,Y),RDe(ce),DO({ref:n,onResize:ce}),DO({ref:i,onResize:ce});let ge=(0,t0.useRef)(!1);yh(()=>{let ue,Le=()=>{ge.current=!0,clearTimeout(ue),ue=setTimeout(()=>{ge.current=!1},500),ce()},We=()=>{ge.current&&Le()};return ea?.addEventListener("resize",Le),ea?.addEventListener("scroll",We),()=>{ea?.removeEventListener("resize",Le),ea?.removeEventListener("scroll",We)}},[ce]);let Se=(0,t0.useCallback)(()=>{ge.current||F?.()},[F,ge]);Mue({triggerRef:i,isOpen:k,onClose:F&&Se});var ne,pe;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...W?.position,maxHeight:(ne=W?.maxHeight)!==null&&ne!==void 0?ne:"100vh"}},placement:(pe=W?.placement)!==null&&pe!==void 0?pe:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:W?.arrowOffsetLeft,top:W?.arrowOffsetTop}},updatePosition:ce}}function RDe(t){yh(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function ODe(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}var v2="default",aG="",FO=new WeakMap;function lG(t){if(h1()){if(v2==="default"){let e=Js(t);aG=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}v2="disabled"}else(t instanceof HTMLElement||t instanceof SVGElement)&&(FO.set(t,t.style.userSelect),t.style.userSelect="none")}function vE(t){if(h1()){if(v2!=="disabled")return;v2="restoring",setTimeout(()=>{yE(()=>{if(v2==="restoring"){let e=Js(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=aG||""),aG="",v2="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&FO.has(t)){let e=FO.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),FO.delete(t)}}var Eue=Tt($t(),1),cG=Eue.default.createContext({register:()=>{}});cG.displayName="PressResponderContext";function Cue(t,e){return e.get?e.get.call(t):e.value}function NO(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Pue(t,e){var r=NO(t,e,"get");return Cue(t,r)}function Iue(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function uG(t,e,r){var i=NO(t,e,"set");return Iue(t,i,r),r}var r0=Tt($t(),1);function DDe(t){let e=(0,r0.useContext)(cG);if(e){let{register:r,...i}=e;t=fs(i,t),r()}return _E(e,t.ref),t}var zO=new WeakMap,x2=class{continuePropagation(){uG(this,zO,!1)}get shouldStopPropagation(){return Pue(this,zO)}constructor(e,r,i,n){aue(this,zO,{writable:!0,value:void 0}),uG(this,zO,!0);var o;let s=(o=n?.target)!==null&&o!==void 0?o:i.currentTarget,a=s?.getBoundingClientRect(),u,p=0,m,x=null;i.clientX!=null&&i.clientY!=null&&(m=i.clientX,x=i.clientY),a&&(m!=null&&x!=null?(u=m-a.left,p=x-a.top):(u=a.width/2,p=a.height/2)),this.type=e,this.pointerType=r,this.target=i.currentTarget,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.x=u,this.y=p}},kue=Symbol("linkClicked");function fG(t){let{onPress:e,onPressChange:r,onPressStart:i,onPressEnd:n,onPressUp:o,isDisabled:s,isPressed:a,preventFocusOnPress:u,shouldCancelOnPointerExit:p,allowTextSelectionOnPress:m,ref:x,...M}=DDe(t),[k,F]=(0,r0.useState)(!1),j=(0,r0.useRef)({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:H,removeAllGlobalListeners:W}=tG(),Z=Ad((ne,pe)=>{let ue=j.current;if(s||ue.didFirePressStart)return!1;let Le=!0;if(ue.isTriggeringEvent=!0,i){let We=new x2("pressstart",pe,ne);i(We),Le=We.shouldStopPropagation}return r&&r(!0),ue.isTriggeringEvent=!1,ue.didFirePressStart=!0,F(!0),Le}),Y=Ad((ne,pe,ue=!0)=>{let Le=j.current;if(!Le.didFirePressStart)return!1;Le.ignoreClickAfterPress=!0,Le.didFirePressStart=!1,Le.isTriggeringEvent=!0;let We=!0;if(n){let ze=new x2("pressend",pe,ne);n(ze),We=ze.shouldStopPropagation}if(r&&r(!1),F(!1),e&&ue&&!s){let ze=new x2("press",pe,ne);e(ze),We&&(We=ze.shouldStopPropagation)}return Le.isTriggeringEvent=!1,We}),ee=Ad((ne,pe)=>{let ue=j.current;if(s)return!1;if(o){ue.isTriggeringEvent=!0;let Le=new x2("pressup",pe,ne);return o(Le),ue.isTriggeringEvent=!1,Le.shouldStopPropagation}return!0}),ce=Ad(ne=>{let pe=j.current;pe.isPressed&&pe.target&&(pe.isOverTarget&&pe.pointerType!=null&&Y(Zm(pe.target,ne),pe.pointerType,!1),pe.isPressed=!1,pe.isOverTarget=!1,pe.activePointerId=null,pe.pointerType=null,W(),m||vE(pe.target))}),ge=Ad(ne=>{p&&ce(ne)}),Se=(0,r0.useMemo)(()=>{let ne=j.current,pe={onKeyDown(Le){if(hG(Le.nativeEvent,Le.currentTarget)&&Le.currentTarget.contains(Le.target)){var We;Oue(Le.target,Le.key)&&Le.preventDefault();let ze=!0;if(!ne.isPressed&&!Le.repeat){ne.target=Le.currentTarget,ne.isPressed=!0,ze=Z(Le,"keyboard");let rt=Le.currentTarget,at=Wt=>{hG(Wt,rt)&&!Wt.repeat&&rt.contains(Wt.target)&&ne.target&&ee(Zm(ne.target,Wt),"keyboard")};H(Js(Le.currentTarget),"keyup",u1(at,ue),!0)}ze&&Le.stopPropagation(),Le.metaKey&&Jp()&&((We=ne.metaKeyEvents)===null||We===void 0||We.set(Le.key,Le.nativeEvent))}else Le.key==="Meta"&&(ne.metaKeyEvents=new Map)},onClick(Le){if(!(Le&&!Le.currentTarget.contains(Le.target))&&Le&&Le.button===0&&!ne.isTriggeringEvent&&!Xm.isOpening){let We=!0;if(s&&Le.preventDefault(),!ne.ignoreClickAfterPress&&!ne.ignoreEmulatedMouseEvents&&!ne.isPressed&&(ne.pointerType==="virtual"||A2(Le.nativeEvent))){!s&&!u&&kf(Le.currentTarget);let ze=Z(Le,"virtual"),rt=ee(Le,"virtual"),at=Y(Le,"virtual");We=ze&&rt&&at}ne.ignoreEmulatedMouseEvents=!1,ne.ignoreClickAfterPress=!1,We&&Le.stopPropagation()}}},ue=Le=>{var We;if(ne.isPressed&&ne.target&&hG(Le,ne.target)){var ze;Oue(Le.target,Le.key)&&Le.preventDefault();let at=Le.target;Y(Zm(ne.target,Le),"keyboard",ne.target.contains(at)),W(),Le.key!=="Enter"&&pG(ne.target)&&ne.target.contains(at)&&!Le[kue]&&(Le[kue]=!0,Xm(ne.target,Le,!1)),ne.isPressed=!1,(ze=ne.metaKeyEvents)===null||ze===void 0||ze.delete(Le.key)}else if(Le.key==="Meta"&&(!((We=ne.metaKeyEvents)===null||We===void 0)&&We.size)){var rt;let at=ne.metaKeyEvents;ne.metaKeyEvents=void 0;for(let Wt of at.values())(rt=ne.target)===null||rt===void 0||rt.dispatchEvent(new KeyboardEvent("keyup",Wt))}};if(typeof PointerEvent<"u"){pe.onPointerDown=at=>{if(at.button!==0||!at.currentTarget.contains(at.target))return;if(rG(at.nativeEvent)){ne.pointerType="virtual";return}dG(at.currentTarget)&&at.preventDefault(),ne.pointerType=at.pointerType;let Wt=!0;ne.isPressed||(ne.isPressed=!0,ne.isOverTarget=!0,ne.activePointerId=at.pointerId,ne.target=at.currentTarget,!s&&!u&&kf(at.currentTarget),m||lG(ne.target),Wt=Z(at,ne.pointerType),H(Js(at.currentTarget),"pointermove",Le,!1),H(Js(at.currentTarget),"pointerup",We,!1),H(Js(at.currentTarget),"pointercancel",rt,!1)),Wt&&at.stopPropagation()},pe.onMouseDown=at=>{at.currentTarget.contains(at.target)&&at.button===0&&(dG(at.currentTarget)&&at.preventDefault(),at.stopPropagation())},pe.onPointerUp=at=>{!at.currentTarget.contains(at.target)||ne.pointerType==="virtual"||at.button===0&&b2(at,at.currentTarget)&&ee(at,ne.pointerType||at.pointerType)};let Le=at=>{at.pointerId===ne.activePointerId&&(ne.target&&b2(at,ne.target)?!ne.isOverTarget&&ne.pointerType!=null&&(ne.isOverTarget=!0,Z(Zm(ne.target,at),ne.pointerType)):ne.target&&ne.isOverTarget&&ne.pointerType!=null&&(ne.isOverTarget=!1,Y(Zm(ne.target,at),ne.pointerType,!1),ge(at)))},We=at=>{at.pointerId===ne.activePointerId&&ne.isPressed&&at.button===0&&ne.target&&(b2(at,ne.target)&&ne.pointerType!=null?Y(Zm(ne.target,at),ne.pointerType):ne.isOverTarget&&ne.pointerType!=null&&Y(Zm(ne.target,at),ne.pointerType,!1),ne.isPressed=!1,ne.isOverTarget=!1,ne.activePointerId=null,ne.pointerType=null,W(),m||vE(ne.target),"ontouchend"in ne.target&&at.pointerType!=="mouse"&&H(ne.target,"touchend",ze,{once:!0}))},ze=at=>{Due(at.currentTarget)&&at.preventDefault()},rt=at=>{ce(at)};pe.onDragStart=at=>{at.currentTarget.contains(at.target)&&ce(at)}}else{pe.onMouseDown=ze=>{if(ze.button!==0||!ze.currentTarget.contains(ze.target))return;if(dG(ze.currentTarget)&&ze.preventDefault(),ne.ignoreEmulatedMouseEvents){ze.stopPropagation();return}ne.isPressed=!0,ne.isOverTarget=!0,ne.target=ze.currentTarget,ne.pointerType=A2(ze.nativeEvent)?"virtual":"mouse",!s&&!u&&kf(ze.currentTarget),Z(ze,ne.pointerType)&&ze.stopPropagation(),H(Js(ze.currentTarget),"mouseup",Le,!1)},pe.onMouseEnter=ze=>{if(!ze.currentTarget.contains(ze.target))return;let rt=!0;ne.isPressed&&!ne.ignoreEmulatedMouseEvents&&ne.pointerType!=null&&(ne.isOverTarget=!0,rt=Z(ze,ne.pointerType)),rt&&ze.stopPropagation()},pe.onMouseLeave=ze=>{if(!ze.currentTarget.contains(ze.target))return;let rt=!0;ne.isPressed&&!ne.ignoreEmulatedMouseEvents&&ne.pointerType!=null&&(ne.isOverTarget=!1,rt=Y(ze,ne.pointerType,!1),ge(ze)),rt&&ze.stopPropagation()},pe.onMouseUp=ze=>{ze.currentTarget.contains(ze.target)&&!ne.ignoreEmulatedMouseEvents&&ze.button===0&&ee(ze,ne.pointerType||"mouse")};let Le=ze=>{if(ze.button===0){if(ne.isPressed=!1,W(),ne.ignoreEmulatedMouseEvents){ne.ignoreEmulatedMouseEvents=!1;return}ne.target&&b2(ze,ne.target)&&ne.pointerType!=null?Y(Zm(ne.target,ze),ne.pointerType):ne.target&&ne.isOverTarget&&ne.pointerType!=null&&Y(Zm(ne.target,ze),ne.pointerType,!1),ne.isOverTarget=!1}};pe.onTouchStart=ze=>{if(!ze.currentTarget.contains(ze.target))return;let rt=LDe(ze.nativeEvent);if(!rt)return;ne.activePointerId=rt.identifier,ne.ignoreEmulatedMouseEvents=!0,ne.isOverTarget=!0,ne.isPressed=!0,ne.target=ze.currentTarget,ne.pointerType="touch",!s&&!u&&kf(ze.currentTarget),m||lG(ne.target),Z(Iy(ne.target,ze),ne.pointerType)&&ze.stopPropagation(),H(_h(ze.currentTarget),"scroll",We,!0)},pe.onTouchMove=ze=>{if(!ze.currentTarget.contains(ze.target))return;if(!ne.isPressed){ze.stopPropagation();return}let rt=Rue(ze.nativeEvent,ne.activePointerId),at=!0;rt&&b2(rt,ze.currentTarget)?!ne.isOverTarget&&ne.pointerType!=null&&(ne.isOverTarget=!0,at=Z(Iy(ne.target,ze),ne.pointerType)):ne.isOverTarget&&ne.pointerType!=null&&(ne.isOverTarget=!1,at=Y(Iy(ne.target,ze),ne.pointerType,!1),ge(Iy(ne.target,ze))),at&&ze.stopPropagation()},pe.onTouchEnd=ze=>{if(!ze.currentTarget.contains(ze.target))return;if(!ne.isPressed){ze.stopPropagation();return}let rt=Rue(ze.nativeEvent,ne.activePointerId),at=!0;rt&&b2(rt,ze.currentTarget)&&ne.pointerType!=null?(ee(Iy(ne.target,ze),ne.pointerType),at=Y(Iy(ne.target,ze),ne.pointerType)):ne.isOverTarget&&ne.pointerType!=null&&(at=Y(Iy(ne.target,ze),ne.pointerType,!1)),at&&ze.stopPropagation(),ne.isPressed=!1,ne.activePointerId=null,ne.isOverTarget=!1,ne.ignoreEmulatedMouseEvents=!0,ne.target&&!m&&vE(ne.target),W()},pe.onTouchCancel=ze=>{ze.currentTarget.contains(ze.target)&&(ze.stopPropagation(),ne.isPressed&&ce(Iy(ne.target,ze)))};let We=ze=>{ne.isPressed&&ze.target.contains(ne.target)&&ce({currentTarget:ne.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};pe.onDragStart=ze=>{ze.currentTarget.contains(ze.target)&&ce(ze)}}return pe},[H,s,u,W,m,ce,ge,Y,Z,ee]);return(0,r0.useEffect)(()=>()=>{var ne;m||vE((ne=j.current.target)!==null&&ne!==void 0?ne:void 0)},[m]),{isPressed:a||k,pressProps:fs(M,Se)}}function pG(t){return t.tagName==="A"&&t.hasAttribute("href")}function hG(t,e){let{key:r,code:i}=t,n=e,o=n.getAttribute("role");return(r==="Enter"||r===" "||r==="Spacebar"||i==="Space")&&!(n instanceof _h(n).HTMLInputElement&&!Lue(n,r)||n instanceof _h(n).HTMLTextAreaElement||n.isContentEditable)&&!((o==="link"||!o&&pG(n))&&r!=="Enter")}function LDe(t){let{targetTouches:e}=t;return e.length>0?e[0]:null}function Rue(t,e){let r=t.changedTouches;for(let i=0;i<r.length;i++){let n=r[i];if(n.identifier===e)return n}return null}function Iy(t,e){let r=0,i=0;return e.targetTouches&&e.targetTouches.length===1&&(r=e.targetTouches[0].clientX,i=e.targetTouches[0].clientY),{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:r,clientY:i}}function Zm(t,e){let r=e.clientX,i=e.clientY;return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:r,clientY:i}}function BDe(t){let e=0,r=0;return t.width!==void 0?e=t.width/2:t.radiusX!==void 0&&(e=t.radiusX),t.height!==void 0?r=t.height/2:t.radiusY!==void 0&&(r=t.radiusY),{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function FDe(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function b2(t,e){let r=e.getBoundingClientRect(),i=BDe(t);return FDe(r,i)}function dG(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function Due(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!pG(t)}function Oue(t,e){return t instanceof HTMLInputElement?!Lue(t,e):Due(t)}var NDe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Lue(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":NDe.has(t.type)}var UO=Tt($t(),1);var mG=class{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,r){this.nativeEvent=r,this.target=r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget,this.bubbles=r.bubbles,this.cancelable=r.cancelable,this.defaultPrevented=r.defaultPrevented,this.eventPhase=r.eventPhase,this.isTrusted=r.isTrusted,this.timeStamp=r.timeStamp,this.type=e}};function VO(t){let e=(0,UO.useRef)({isFocused:!1,observer:null});yh(()=>{let i=e.current;return()=>{i.observer&&(i.observer.disconnect(),i.observer=null)}},[]);let r=Ad(i=>{t?.(i)});return(0,UO.useCallback)(i=>{if(i.target instanceof HTMLButtonElement||i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||i.target instanceof HTMLSelectElement){e.current.isFocused=!0;let n=i.target,o=s=>{e.current.isFocused=!1,n.disabled&&r(new mG("blur",s)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};n.addEventListener("focusout",o,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&n.disabled){var s;(s=e.current.observer)===null||s===void 0||s.disconnect();let a=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:a})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:a}))}}),e.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[r])}var gG=Tt($t(),1);function bE(t){let{isDisabled:e,onFocus:r,onBlur:i,onFocusChange:n}=t,o=(0,gG.useCallback)(u=>{if(u.target===u.currentTarget)return i&&i(u),n&&n(!1),!0},[i,n]),s=VO(o),a=(0,gG.useCallback)(u=>{let p=Js(u.target);u.target===u.currentTarget&&p.activeElement===u.target&&(r&&r(u),n&&n(!0),s(u))},[n,r,s]);return{focusProps:{onFocus:!e&&(r||n||i)?a:void 0,onBlur:!e&&(i||n)?o:void 0}}}var vG=Tt($t(),1);var w2=null,AG=new Set,xE=new Map,f1=!1,yG=!1,zDe={Tab:!0,Escape:!0};function bG(t,e){for(let r of AG)r(t,e)}function UDe(t){return!(t.metaKey||!Jp()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function jO(t){f1=!0,UDe(t)&&(w2="keyboard",bG("keyboard",t))}function yd(t){w2="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(f1=!0,bG("pointer",t))}function Bue(t){A2(t)&&(f1=!0,w2="virtual")}function Fue(t){t.target===window||t.target===document||(!f1&&!yG&&(w2="virtual",bG("virtual",t)),f1=!1,yG=!1)}function Nue(){f1=!1,yG=!0}function _G(t){if(typeof window>"u"||xE.get(_h(t)))return;let e=_h(t),r=Js(t),i=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){f1=!0,i.apply(this,arguments)},r.addEventListener("keydown",jO,!0),r.addEventListener("keyup",jO,!0),r.addEventListener("click",Bue,!0),e.addEventListener("focus",Fue,!0),e.addEventListener("blur",Nue,!1),typeof PointerEvent<"u"?(r.addEventListener("pointerdown",yd,!0),r.addEventListener("pointermove",yd,!0),r.addEventListener("pointerup",yd,!0)):(r.addEventListener("mousedown",yd,!0),r.addEventListener("mousemove",yd,!0),r.addEventListener("mouseup",yd,!0)),e.addEventListener("beforeunload",()=>{zue(t)},{once:!0}),xE.set(e,{focus:i})}var zue=(t,e)=>{let r=_h(t),i=Js(t);e&&i.removeEventListener("DOMContentLoaded",e),xE.has(r)&&(r.HTMLElement.prototype.focus=xE.get(r).focus,i.removeEventListener("keydown",jO,!0),i.removeEventListener("keyup",jO,!0),i.removeEventListener("click",Bue,!0),r.removeEventListener("focus",Fue,!0),r.removeEventListener("blur",Nue,!1),typeof PointerEvent<"u"?(i.removeEventListener("pointerdown",yd,!0),i.removeEventListener("pointermove",yd,!0),i.removeEventListener("pointerup",yd,!0)):(i.removeEventListener("mousedown",yd,!0),i.removeEventListener("mousemove",yd,!0),i.removeEventListener("mouseup",yd,!0)),xE.delete(r))};function Uue(t){let e=Js(t),r;return e.readyState!=="loading"?_G(t):(r=()=>{_G(t)},e.addEventListener("DOMContentLoaded",r)),()=>zue(t,r)}typeof document<"u"&&Uue();function S2(){return w2!=="pointer"}function wE(){return w2}var VDe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function jDe(t,e,r){var i;let n=typeof window<"u"?_h(r?.target).HTMLInputElement:HTMLInputElement,o=typeof window<"u"?_h(r?.target).HTMLTextAreaElement:HTMLTextAreaElement,s=typeof window<"u"?_h(r?.target).HTMLElement:HTMLElement,a=typeof window<"u"?_h(r?.target).KeyboardEvent:KeyboardEvent;return t=t||r?.target instanceof n&&!VDe.has(r==null||(i=r.target)===null||i===void 0?void 0:i.type)||r?.target instanceof o||r?.target instanceof s&&r?.target.isContentEditable,!(t&&e==="keyboard"&&r instanceof a&&!zDe[r.key])}function xG(t,e,r){_G(),(0,vG.useEffect)(()=>{let i=(n,o)=>{jDe(!!r?.isTextInput,n,o)&&t(S2())};return AG.add(i),()=>{AG.delete(i)}},e)}var SE=Tt($t(),1);function TE(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:i,onFocusWithinChange:n}=t,o=(0,SE.useRef)({isFocusWithin:!1}),s=(0,SE.useCallback)(p=>{o.current.isFocusWithin&&!p.currentTarget.contains(p.relatedTarget)&&(o.current.isFocusWithin=!1,r&&r(p),n&&n(!1))},[r,n,o]),a=VO(s),u=(0,SE.useCallback)(p=>{!o.current.isFocusWithin&&document.activeElement===p.target&&(i&&i(p),n&&n(!0),o.current.isFocusWithin=!0,a(p))},[i,n,a]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:s}}}var Km=Tt($t(),1),$O=!1,wG=0;function SG(){$O=!0,setTimeout(()=>{$O=!1},50)}function Vue(t){t.pointerType==="touch"&&SG()}function $De(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",Vue):document.addEventListener("touchend",SG),wG++,()=>{wG--,!(wG>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",Vue):document.removeEventListener("touchend",SG))}}function p1(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:i,isDisabled:n}=t,[o,s]=(0,Km.useState)(!1),a=(0,Km.useRef)({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;(0,Km.useEffect)($De,[]);let{hoverProps:u,triggerHoverEnd:p}=(0,Km.useMemo)(()=>{let m=(k,F)=>{if(a.pointerType=F,n||F==="touch"||a.isHovered||!k.currentTarget.contains(k.target))return;a.isHovered=!0;let j=k.currentTarget;a.target=j,e&&e({type:"hoverstart",target:j,pointerType:F}),r&&r(!0),s(!0)},x=(k,F)=>{if(a.pointerType="",a.target=null,F==="touch"||!a.isHovered)return;a.isHovered=!1;let j=k.currentTarget;i&&i({type:"hoverend",target:j,pointerType:F}),r&&r(!1),s(!1)},M={};return typeof PointerEvent<"u"?(M.onPointerEnter=k=>{$O&&k.pointerType==="mouse"||m(k,k.pointerType)},M.onPointerLeave=k=>{!n&&k.currentTarget.contains(k.target)&&x(k,k.pointerType)}):(M.onTouchStart=()=>{a.ignoreEmulatedMouseEvents=!0},M.onMouseEnter=k=>{!a.ignoreEmulatedMouseEvents&&!$O&&m(k,"mouse"),a.ignoreEmulatedMouseEvents=!1},M.onMouseLeave=k=>{!n&&k.currentTarget.contains(k.target)&&x(k,"mouse")}),{hoverProps:M,triggerHoverEnd:x}},[e,r,i,n,a]);return(0,Km.useEffect)(()=>{n&&p({currentTarget:a.target},a.pointerType)},[n]),{hoverProps:u,isHovered:o}}var GO=Tt($t(),1);function TG(t){let{ref:e,onInteractOutside:r,isDisabled:i,onInteractOutsideStart:n}=t,o=(0,GO.useRef)({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),s=Ad(u=>{r&&WO(u,e)&&(n&&n(u),o.current.isPointerDown=!0)}),a=Ad(u=>{r&&r(u)});(0,GO.useEffect)(()=>{let u=o.current;if(i)return;let p=e.current,m=Js(p);if(typeof PointerEvent<"u"){let x=M=>{u.isPointerDown&&WO(M,e)&&a(M),u.isPointerDown=!1};return m.addEventListener("pointerdown",s,!0),m.addEventListener("pointerup",x,!0),()=>{m.removeEventListener("pointerdown",s,!0),m.removeEventListener("pointerup",x,!0)}}else{let x=k=>{u.ignoreEmulatedMouseEvents?u.ignoreEmulatedMouseEvents=!1:u.isPointerDown&&WO(k,e)&&a(k),u.isPointerDown=!1},M=k=>{u.ignoreEmulatedMouseEvents=!0,u.isPointerDown&&WO(k,e)&&a(k),u.isPointerDown=!1};return m.addEventListener("mousedown",s,!0),m.addEventListener("mouseup",x,!0),m.addEventListener("touchstart",s,!0),m.addEventListener("touchend",M,!0),()=>{m.removeEventListener("mousedown",s,!0),m.removeEventListener("mouseup",x,!0),m.removeEventListener("touchstart",s,!0),m.removeEventListener("touchend",M,!0)}}},[e,i,s,a])}function WO(t,e){if(t.button>0)return!1;if(t.target){let r=t.target.ownerDocument;if(!r||!r.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current&&!e.current.contains(t.target)}function MG(t){if(!t)return;let e=!0;return r=>{let i={...r,preventDefault(){r.preventDefault()},isDefaultPrevented(){return r.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(i),e&&r.stopPropagation()}}function EG(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:MG(t.onKeyDown),onKeyUp:MG(t.onKeyUp)}}}function jue(t){let e=Js(t);if(wE()==="virtual"){let r=e.activeElement;yE(()=>{e.activeElement===r&&t.isConnected&&kf(t)})}else kf(t)}var ME=Tt($t(),1);var WDe=null;var PG=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],Avt=PG.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";PG.push('[tabindex]:not([tabindex="-1"]):not([disabled])');var yvt=PG.join(':not([hidden]):not([tabindex="-1"]),');function Wue(t,e){return!t||!e?!1:e.some(r=>r.contains(t))}function GDe(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:r}of $ue.traverse($ue.getTreeNode(e)))if(r&&Wue(t,r.current))return!0;return!1}function IG(t){return GDe(t,WDe)}var CG=class t{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,r,i){let n=this.fastMap.get(r??null);if(!n)return;let o=new HO({scopeRef:e});n.addChild(o),o.parent=n,this.fastMap.set(e,o),i&&(o.nodeToRestore=i)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let r=this.fastMap.get(e);if(!r)return;let i=r.parent;for(let o of this.traverse())o!==r&&r.nodeToRestore&&o.nodeToRestore&&r.scopeRef&&r.scopeRef.current&&Wue(o.nodeToRestore,r.scopeRef.current)&&(o.nodeToRestore=r.nodeToRestore);let n=r.children;i&&(i.removeChild(r),n.size>0&&n.forEach(o=>i&&i.addChild(o))),this.fastMap.delete(r.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let r of e.children)yield*this.traverse(r)}clone(){var e;let r=new t;var i;for(let n of this.traverse())r.addTreeNode(n.scopeRef,(i=(e=n.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&i!==void 0?i:null,n.nodeToRestore);return r}constructor(){this.fastMap=new Map,this.root=new HO({scopeRef:null}),this.fastMap.set(null,this.root)}},HO=class{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}},$ue=new CG;var ky=Tt($t(),1);function kG(t={}){let{autoFocus:e=!1,isTextInput:r,within:i}=t,n=(0,ky.useRef)({isFocused:!1,isFocusVisible:e||S2()}),[o,s]=(0,ky.useState)(!1),[a,u]=(0,ky.useState)(()=>n.current.isFocused&&n.current.isFocusVisible),p=(0,ky.useCallback)(()=>u(n.current.isFocused&&n.current.isFocusVisible),[]),m=(0,ky.useCallback)(k=>{n.current.isFocused=k,s(k),p()},[p]);xG(k=>{n.current.isFocusVisible=k,p()},[],{isTextInput:r});let{focusProps:x}=bE({isDisabled:i,onFocusChange:m}),{focusWithinProps:M}=TE({isDisabled:!i,onFocusWithinChange:m});return{isFocused:o,isFocusVisible:a,focusProps:i?M:x}}var Ry=Tt($t(),1);var HDe=Ry.default.createContext(null);function qDe(t){let e=(0,Ry.useContext)(HDe)||{};_E(e,t);let{ref:r,...i}=e;return i}function EE(t,e){let{focusProps:r}=bE(t),{keyboardProps:i}=EG(t),n=fs(r,i),o=qDe(e),s=t.isDisabled?{}:o,a=(0,Ry.useRef)(t.autoFocus);return(0,Ry.useEffect)(()=>{a.current&&e.current&&jue(e.current),a.current=!1},[e]),{focusableProps:fs({...n,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},s)}}var Gue=Tt($t(),1);var Qm=[];function RG(t,e){let{onClose:r,shouldCloseOnBlur:i,isOpen:n,isDismissable:o=!1,isKeyboardDismissDisabled:s=!1,shouldCloseOnInteractOutside:a}=t;(0,Gue.useEffect)(()=>(n&&Qm.push(e),()=>{let F=Qm.indexOf(e);F>=0&&Qm.splice(F,1)}),[n,e]);let u=()=>{Qm[Qm.length-1]===e&&r&&r()},p=F=>{(!a||a(F.target))&&Qm[Qm.length-1]===e&&(F.stopPropagation(),F.preventDefault())},m=F=>{(!a||a(F.target))&&(Qm[Qm.length-1]===e&&(F.stopPropagation(),F.preventDefault()),u())},x=F=>{F.key==="Escape"&&!s&&!F.nativeEvent.isComposing&&(F.stopPropagation(),F.preventDefault(),u())};TG({ref:e,onInteractOutside:o&&n?m:void 0,onInteractOutsideStart:p});let{focusWithinProps:M}=TE({isDisabled:!i,onBlurWithin:F=>{!F.relatedTarget||IG(F.relatedTarget)||(!a||a(F.relatedTarget))&&r?.()}}),k=F=>{F.target===F.currentTarget&&F.preventDefault()};return{overlayProps:{onKeyDown:x,...M},underlayProps:{onPointerDown:k}}}var rc=Tt($t(),1),Hue=Tt(uM(),1);var OG=rc.default.createContext(null);function que(t){let{children:e}=t,r=(0,rc.useContext)(OG),[i,n]=(0,rc.useState)(0),o=(0,rc.useMemo)(()=>({parent:r,modalCount:i,addModal(){n(s=>s+1),r&&r.addModal()},removeModal(){n(s=>s-1),r&&r.removeModal()}}),[r,i]);return rc.default.createElement(OG.Provider,{value:o},e)}function Yue(){let t=(0,rc.useContext)(OG);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function YDe(t){let{modalProviderProps:e}=Yue();return rc.default.createElement("div",{"data-overlay-container":!0,...t,...e})}function qO(t){return rc.default.createElement(que,null,rc.default.createElement(YDe,t))}function YO(t){let e=d2(),{portalContainer:r=e?null:document.body,...i}=t;if(rc.default.useEffect(()=>{if(r?.closest("[data-overlay-container]"))throw new Error("An OverlayContainer must not be inside another container. Please change the portalContainer prop.")},[r]),!r)return null;let n=rc.default.createElement(qO,i);return Hue.default.createPortal(n,r)}var z0e=Tt($t(),1);xC();var K2=Tt(oo(),1),Lq=({children:t,navigate:e,disableAnimation:r,useHref:i,disableRipple:n=!1,skipFramerMotionAnimations:o=r,reducedMotion:s="never",validationBehavior:a,locale:u="en-US",defaultDates:p,createCalendar:m,...x})=>{let M=t;e&&(M=(0,K2.jsx)(JW,{navigate:e,useHref:i,children:M}));let k=(0,z0e.useMemo)(()=>(r&&o&&($a.skipAnimations=!0),{createCalendar:m,defaultDates:p,disableAnimation:r,disableRipple:n,validationBehavior:a}),[m,p?.maxDate,p?.minDate,r,n,a]);return(0,K2.jsx)(jW,{value:k,children:(0,K2.jsx)(qW,{locale:u,children:(0,K2.jsx)(lq,{reducedMotion:s,children:(0,K2.jsx)(qO,{...x,children:M})})})})};var U0e=Tt($t(),1);function l0(t){return(0,U0e.forwardRef)(t)}var Yy=(t,e,r=!0)=>{if(!e)return[t,{}];let i=e.reduce((n,o)=>o in t?{...n,[o]:t[o]}:n,{});return r?[Object.keys(t).filter(o=>!e.includes(o)).reduce((o,s)=>({...o,[s]:t[s]}),{}),i]:[t,i]};var TL=["small","medium","large"],Bq={theme:{opacity:["disabled"],spacing:["divider"],borderWidth:TL,borderRadius:TL},classGroups:{shadow:[{shadow:TL}],"font-size":[{text:["tiny",...TL]}],"bg-image":["bg-stripe-gradient-default","bg-stripe-gradient-primary","bg-stripe-gradient-secondary","bg-stripe-gradient-success","bg-stripe-gradient-warning","bg-stripe-gradient-danger"]}};var Fq=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,xu=t=>!t||typeof t!="object"||Object.keys(t).length===0,V0e=(t,e)=>JSON.stringify(t)===JSON.stringify(e);function j0e(t,e){t.forEach(function(r){Array.isArray(r)?j0e(r,e):e.push(r)})}function Nq(t){let e=[];return j0e(t,e),e}var zq=(...t)=>Nq(t).filter(Boolean),Uq=(t,e)=>{let r={},i=Object.keys(t),n=Object.keys(e);for(let o of i)if(n.includes(o)){let s=t[o],a=e[o];typeof s=="object"&&typeof a=="object"?r[o]=Uq(s,a):Array.isArray(s)||Array.isArray(a)?r[o]=zq(a,s):r[o]=a+" "+s}else r[o]=t[o];for(let o of n)i.includes(o)||(r[o]=e[o]);return r},Vq=t=>!t||typeof t!="string"?t:t.replace(/\s+/g," ").trim();function $0e(){for(var t=0,e,r,i="";t<arguments.length;)(e=arguments[t++])&&(r=W0e(e))&&(i&&(i+=" "),i+=r);return i}function W0e(t){if(typeof t=="string")return t;for(var e,r="",i=0;i<t.length;i++)t[i]&&(e=W0e(t[i]))&&(r&&(r+=" "),r+=e);return r}var $q="-";function q0e(t){var e=F7e(t),r=t.conflictingClassGroups,i=t.conflictingClassGroupModifiers,n=i===void 0?{}:i;function o(a){var u=a.split($q);return u[0]===""&&u.length!==1&&u.shift(),Y0e(u,e)||B7e(a)}function s(a,u){var p=r[a]||[];return u&&n[a]?[].concat(p,n[a]):p}return{getClassGroupId:o,getConflictingClassGroupIds:s}}function Y0e(t,e){if(t.length===0)return e.classGroupId;var r=t[0],i=e.nextPart.get(r),n=i?Y0e(t.slice(1),i):void 0;if(n)return n;if(e.validators.length!==0){var o=t.join($q);return e.validators.find(function(s){var a=s.validator;return a(o)})?.classGroupId}}var G0e=/^\[(.+)\]$/;function B7e(t){if(G0e.test(t)){var e=G0e.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}}function F7e(t){var e=t.theme,r=t.prefix,i={nextPart:new Map,validators:[]},n=z7e(Object.entries(t.classGroups),r);return n.forEach(function(o){var s=o[0],a=o[1];jq(a,i,s,e)}),i}function jq(t,e,r,i){t.forEach(function(n){if(typeof n=="string"){var o=n===""?e:H0e(e,n);o.classGroupId=r;return}if(typeof n=="function"){if(N7e(n)){jq(n(i),e,r,i);return}e.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(function(s){var a=s[0],u=s[1];jq(u,H0e(e,a),r,i)})})}function H0e(t,e){var r=t;return e.split($q).forEach(function(i){r.nextPart.has(i)||r.nextPart.set(i,{nextPart:new Map,validators:[]}),r=r.nextPart.get(i)}),r}function N7e(t){return t.isThemeGetter}function z7e(t,e){return e?t.map(function(r){var i=r[0],n=r[1],o=n.map(function(s){return typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(function(a){var u=a[0],p=a[1];return[e+u,p]})):s});return[i,o]}):t}function X0e(t){if(t<1)return{get:function(){},set:function(){}};var e=0,r=new Map,i=new Map;function n(o,s){r.set(o,s),e++,e>t&&(e=0,i=r,r=new Map)}return{get:function(s){var a=r.get(s);if(a!==void 0)return a;if((a=i.get(s))!==void 0)return n(s,a),a},set:function(s,a){r.has(s)?r.set(s,a):n(s,a)}}}var Wq="!";function Z0e(t){var e=t.separator||":",r=e.length===1,i=e[0],n=e.length;return function(s){for(var a=[],u=0,p=0,m,x=0;x<s.length;x++){var M=s[x];if(u===0){if(M===i&&(r||s.slice(x,x+n)===e)){a.push(s.slice(p,x)),p=x+n;continue}if(M==="/"){m=x;continue}}M==="["?u++:M==="]"&&u--}var k=a.length===0?s:s.substring(p),F=k.startsWith(Wq),j=F?k.substring(1):k,H=m&&m>p?m-p:void 0;return{modifiers:a,hasImportantModifier:F,baseClassName:j,maybePostfixModifierPosition:H}}}function K0e(t){if(t.length<=1)return t;var e=[],r=[];return t.forEach(function(i){var n=i[0]==="[";n?(e.push.apply(e,r.sort().concat([i])),r=[]):r.push(i)}),e.push.apply(e,r.sort()),e}function Q0e(t){return{cache:X0e(t.cacheSize),splitModifiers:Z0e(t),...q0e(t)}}var U7e=/\s+/;function J0e(t,e){var r=e.splitModifiers,i=e.getClassGroupId,n=e.getConflictingClassGroupIds,o=new Set;return t.trim().split(U7e).map(function(s){var a=r(s),u=a.modifiers,p=a.hasImportantModifier,m=a.baseClassName,x=a.maybePostfixModifierPosition,M=i(x?m.substring(0,x):m),k=!!x;if(!M){if(!x)return{isTailwindClass:!1,originalClassName:s};if(M=i(m),!M)return{isTailwindClass:!1,originalClassName:s};k=!1}var F=K0e(u).join(":"),j=p?F+Wq:F;return{isTailwindClass:!0,modifierId:j,classGroupId:M,originalClassName:s,hasPostfixModifier:k}}).reverse().filter(function(s){if(!s.isTailwindClass)return!0;var a=s.modifierId,u=s.classGroupId,p=s.hasPostfixModifier,m=a+u;return o.has(m)?!1:(o.add(m),n(u,p).forEach(function(x){return o.add(a+x)}),!0)}).reverse().map(function(s){return s.originalClassName}).join(" ")}function wC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i,n,o,s=a;function a(p){var m=e[0],x=e.slice(1),M=x.reduce(function(k,F){return F(k)},m());return i=Q0e(M),n=i.cache.get,o=i.cache.set,s=u,u(p)}function u(p){var m=n(p);if(m)return m;var x=J0e(p,i);return o(p,x),x}return function(){return s($0e.apply(null,arguments))}}function Bo(t){var e=function(i){return i[t]||[]};return e.isThemeGetter=!0,e}var tme=/^\[(?:([a-z-]+):)?(.+)\]$/i,V7e=/^\d+\/\d+$/,j7e=new Set(["px","full","screen"]),$7e=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,W7e=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,G7e=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function _d(t){return Xy(t)||j7e.has(t)||V7e.test(t)||ML(t)}function ML(t){return C1(t,"length",H7e)}function rme(t){return C1(t,"size",ame)}function ime(t){return C1(t,"position",ame)}function nme(t){return C1(t,"url",q7e)}function SC(t){return C1(t,"number",Xy)}function Xy(t){return!Number.isNaN(Number(t))}function ome(t){return t.endsWith("%")&&Xy(t.slice(0,-1))}function Q2(t){return eme(t)||C1(t,"number",eme)}function cn(t){return tme.test(t)}function J2(){return!0}function cg(t){return $7e.test(t)}function sme(t){return C1(t,"",Y7e)}function C1(t,e,r){var i=tme.exec(t);return i?i[1]?i[1]===e:r(i[2]):!1}function H7e(t){return W7e.test(t)}function ame(){return!1}function q7e(t){return t.startsWith("url(")}function eme(t){return Number.isInteger(Number(t))}function Y7e(t){return G7e.test(t)}function TC(){var t=Bo("colors"),e=Bo("spacing"),r=Bo("blur"),i=Bo("brightness"),n=Bo("borderColor"),o=Bo("borderRadius"),s=Bo("borderSpacing"),a=Bo("borderWidth"),u=Bo("contrast"),p=Bo("grayscale"),m=Bo("hueRotate"),x=Bo("invert"),M=Bo("gap"),k=Bo("gradientColorStops"),F=Bo("gradientColorStopPositions"),j=Bo("inset"),H=Bo("margin"),W=Bo("opacity"),Z=Bo("padding"),Y=Bo("saturate"),ee=Bo("scale"),ce=Bo("sepia"),ge=Bo("skew"),Se=Bo("space"),ne=Bo("translate"),pe=function(){return["auto","contain","none"]},ue=function(){return["auto","hidden","clip","visible","scroll"]},Le=function(){return["auto",cn,e]},We=function(){return[cn,e]},ze=function(){return["",_d]},rt=function(){return["auto",Xy,cn]},at=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},Wt=function(){return["solid","dashed","dotted","double","none"]},It=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},Bt=function(){return["start","end","center","between","around","evenly","stretch"]},Qt=function(){return["","0",cn]},hr=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},nt=function(){return[Xy,SC]},Et=function(){return[Xy,cn]};return{cacheSize:500,theme:{colors:[J2],spacing:[_d],blur:["none","",cg,cn],brightness:nt(),borderColor:[t],borderRadius:["none","","full",cg,cn],borderSpacing:We(),borderWidth:ze(),contrast:nt(),grayscale:Qt(),hueRotate:Et(),invert:Qt(),gap:We(),gradientColorStops:[t],gradientColorStopPositions:[ome,ML],inset:Le(),margin:Le(),opacity:nt(),padding:We(),saturate:nt(),scale:nt(),sepia:Qt(),skew:Et(),space:We(),translate:We()},classGroups:{aspect:[{aspect:["auto","square","video",cn]}],container:["container"],columns:[{columns:[cg]}],"break-after":[{"break-after":hr()}],"break-before":[{"break-before":hr()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(at(),[cn])}],overflow:[{overflow:ue()}],"overflow-x":[{"overflow-x":ue()}],"overflow-y":[{"overflow-y":ue()}],overscroll:[{overscroll:pe()}],"overscroll-x":[{"overscroll-x":pe()}],"overscroll-y":[{"overscroll-y":pe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[j]}],"inset-x":[{"inset-x":[j]}],"inset-y":[{"inset-y":[j]}],start:[{start:[j]}],end:[{end:[j]}],top:[{top:[j]}],right:[{right:[j]}],bottom:[{bottom:[j]}],left:[{left:[j]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Q2]}],basis:[{basis:Le()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",cn]}],grow:[{grow:Qt()}],shrink:[{shrink:Qt()}],order:[{order:["first","last","none",Q2]}],"grid-cols":[{"grid-cols":[J2]}],"col-start-end":[{col:["auto",{span:["full",Q2]},cn]}],"col-start":[{"col-start":rt()}],"col-end":[{"col-end":rt()}],"grid-rows":[{"grid-rows":[J2]}],"row-start-end":[{row:["auto",{span:[Q2]},cn]}],"row-start":[{"row-start":rt()}],"row-end":[{"row-end":rt()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",cn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",cn]}],gap:[{gap:[M]}],"gap-x":[{"gap-x":[M]}],"gap-y":[{"gap-y":[M]}],"justify-content":[{justify:["normal"].concat(Bt())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(Bt(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(Bt(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[Z]}],px:[{px:[Z]}],py:[{py:[Z]}],ps:[{ps:[Z]}],pe:[{pe:[Z]}],pt:[{pt:[Z]}],pr:[{pr:[Z]}],pb:[{pb:[Z]}],pl:[{pl:[Z]}],m:[{m:[H]}],mx:[{mx:[H]}],my:[{my:[H]}],ms:[{ms:[H]}],me:[{me:[H]}],mt:[{mt:[H]}],mr:[{mr:[H]}],mb:[{mb:[H]}],ml:[{ml:[H]}],"space-x":[{"space-x":[Se]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Se]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",cn,e]}],"min-w":[{"min-w":["min","max","fit",cn,_d]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[cg]},cg,cn]}],h:[{h:[cn,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",cn,_d]}],"max-h":[{"max-h":[cn,e,"min","max","fit"]}],"font-size":[{text:["base",cg,ML]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",SC]}],"font-family":[{font:[J2]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",cn]}],"line-clamp":[{"line-clamp":["none",Xy,SC]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",cn,_d]}],"list-image":[{"list-image":["none",cn]}],"list-style-type":[{list:["none","disc","decimal",cn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[W]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[W]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(Wt(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",_d]}],"underline-offset":[{"underline-offset":["auto",cn,_d]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:We()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",cn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",cn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[W]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(at(),[ime])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",rme]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},nme]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[F]}],"gradient-via-pos":[{via:[F]}],"gradient-to-pos":[{to:[F]}],"gradient-from":[{from:[k]}],"gradient-via":[{via:[k]}],"gradient-to":[{to:[k]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[W]}],"border-style":[{border:[].concat(Wt(),["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[W]}],"divide-style":[{divide:Wt()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:[""].concat(Wt())}],"outline-offset":[{"outline-offset":[cn,_d]}],"outline-w":[{outline:[_d]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:ze()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[W]}],"ring-offset-w":[{"ring-offset":[_d]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",cg,sme]}],"shadow-color":[{shadow:[J2]}],opacity:[{opacity:[W]}],"mix-blend":[{"mix-blend":It()}],"bg-blend":[{"bg-blend":It()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[i]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",cg,cn]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[x]}],saturate:[{saturate:[Y]}],sepia:[{sepia:[ce]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[W]}],"backdrop-saturate":[{"backdrop-saturate":[Y]}],"backdrop-sepia":[{"backdrop-sepia":[ce]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",cn]}],duration:[{duration:Et()}],ease:[{ease:["linear","in","out","in-out",cn]}],delay:[{delay:Et()}],animate:[{animate:["none","spin","ping","pulse","bounce",cn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[ee]}],"scale-x":[{"scale-x":[ee]}],"scale-y":[{"scale-y":[ee]}],rotate:[{rotate:[Q2,cn]}],"translate-x":[{"translate-x":[ne]}],"translate-y":[{"translate-y":[ne]}],"skew-x":[{"skew-x":[ge]}],"skew-y":[{"skew-y":[ge]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",cn]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",cn]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":We()}],"scroll-mx":[{"scroll-mx":We()}],"scroll-my":[{"scroll-my":We()}],"scroll-ms":[{"scroll-ms":We()}],"scroll-me":[{"scroll-me":We()}],"scroll-mt":[{"scroll-mt":We()}],"scroll-mr":[{"scroll-mr":We()}],"scroll-mb":[{"scroll-mb":We()}],"scroll-ml":[{"scroll-ml":We()}],"scroll-p":[{"scroll-p":We()}],"scroll-px":[{"scroll-px":We()}],"scroll-py":[{"scroll-py":We()}],"scroll-ps":[{"scroll-ps":We()}],"scroll-pe":[{"scroll-pe":We()}],"scroll-pt":[{"scroll-pt":We()}],"scroll-pr":[{"scroll-pr":We()}],"scroll-pb":[{"scroll-pb":We()}],"scroll-pl":[{"scroll-pl":We()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",cn]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[_d,SC]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}function lme(t,e){for(var r in e)cme(t,r,e[r]);return t}var X7e=Object.prototype.hasOwnProperty,Z7e=new Set(["string","number","boolean"]);function cme(t,e,r){if(!X7e.call(t,e)||Z7e.has(typeof r)||r===null){t[e]=r;return}if(Array.isArray(r)&&Array.isArray(t[e])){t[e]=t[e].concat(r);return}if(typeof r=="object"&&typeof t[e]=="object"){if(t[e]===null){t[e]=r;return}for(var i in r)cme(t[e],i,r[i])}}function Gq(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return typeof t=="function"?wC.apply(void 0,[TC,t].concat(r)):wC.apply(void 0,[function(){return lme(TC(),t)}].concat(r))}var Hq=wC(TC);var K7e={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},hme=t=>t||void 0,EC=(...t)=>hme(Nq(t).filter(Boolean).join(" ")),qq=null,EL={},Yq=!1,MC=(...t)=>e=>e.twMerge?((!qq||Yq)&&(Yq=!1,qq=xu(EL)?Hq:Gq(EL)),hme(qq(EC(t)))):EC(t),ume=(t,e)=>{for(let r in e)t.hasOwnProperty(r)?t[r]=EC(t[r],e[r]):t[r]=e[r];return t},dme=(t,e)=>{let{extend:r=null,slots:i={},variants:n={},compoundVariants:o=[],compoundSlots:s=[],defaultVariants:a={}}=t,u={...K7e,...e},p=r!=null&&r.base?EC(r.base,t?.base):t?.base,m=r!=null&&r.variants&&!xu(r.variants)?Uq(n,r.variants):n,x=r!=null&&r.defaultVariants&&!xu(r.defaultVariants)?{...r.defaultVariants,...a}:a;!xu(u.twMergeConfig)&&!V0e(u.twMergeConfig,EL)&&(Yq=!0,EL=u.twMergeConfig);let M=xu(r?.slots),k=xu(i)?{}:{base:EC(t?.base,M&&r?.base),...i},F=M?k:ume({...r?.slots},xu(k)?{base:t?.base}:k),j=W=>{if(xu(m)&&xu(i)&&M)return MC(p,W?.class,W?.className)(u);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof o}`);if(s&&!Array.isArray(s))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof s}`);let Z=(We,ze,rt=[],at)=>{let Wt=rt;if(typeof ze=="string")Wt=Wt.concat(Vq(ze).split(" ").map(It=>`${We}:${It}`));else if(Array.isArray(ze))Wt=Wt.concat(ze.reduce((It,Bt)=>It.concat(`${We}:${Bt}`),[]));else if(typeof ze=="object"&&typeof at=="string"){for(let It in ze)if(ze.hasOwnProperty(It)&&It===at){let Bt=ze[It];if(Bt&&typeof Bt=="string"){let Qt=Vq(Bt);Wt[at]?Wt[at]=Wt[at].concat(Qt.split(" ").map(hr=>`${We}:${hr}`)):Wt[at]=Qt.split(" ").map(hr=>`${We}:${hr}`)}else Array.isArray(Bt)&&Bt.length>0&&(Wt[at]=Bt.reduce((Qt,hr)=>Qt.concat(`${We}:${hr}`),[]))}}return Wt},Y=(We,ze=m,rt=null,at=null)=>{var Wt;let It=ze[We];if(!It||xu(It))return null;let Bt=(Wt=at?.[We])!=null?Wt:W?.[We];if(Bt===null)return null;let Qt=Fq(Bt),hr=Array.isArray(u.responsiveVariants)&&u.responsiveVariants.length>0||u.responsiveVariants===!0,nt=x?.[We],Et=[];if(typeof Qt=="object"&&hr)for(let[xr,oi]of Object.entries(Qt)){let jr=It[oi];if(xr==="initial"){nt=oi;continue}Array.isArray(u.responsiveVariants)&&!u.responsiveVariants.includes(xr)||(Et=Z(xr,jr,Et,rt))}let yr=It[Qt]||It[Fq(nt)];return typeof Et=="object"&&typeof rt=="string"&&Et[rt]?ume(Et,yr):Et.length>0?(Et.push(yr),Et):yr},ee=()=>m?Object.keys(m).map(We=>Y(We,m)):null,ce=(We,ze)=>{if(!m||typeof m!="object")return null;let rt=new Array;for(let at in m){let Wt=Y(at,m,We,ze),It=We==="base"&&typeof Wt=="string"?Wt:Wt&&Wt[We];It&&(rt[rt.length]=It)}return rt},ge={};for(let We in W)W[We]!==void 0&&(ge[We]=W[We]);let Se=(We,ze)=>{var rt;let at=typeof W?.[We]=="object"?{[We]:(rt=W[We])==null?void 0:rt.initial}:{};return{...x,...ge,...at,...ze}},ne=(We=[],ze)=>{let rt=[];for(let{class:at,className:Wt,...It}of We){let Bt=!0;for(let[Qt,hr]of Object.entries(It)){let nt=Se(Qt,ze);if(Array.isArray(hr)){if(!hr.includes(nt[Qt])){Bt=!1;break}}else if(nt[Qt]!==hr){Bt=!1;break}}Bt&&(at&&rt.push(at),Wt&&rt.push(Wt))}return rt},pe=We=>{let ze=ne(o,We),rt=ne(r?.compoundVariants,We);return zq(rt,ze)},ue=We=>{let ze=pe(We);if(!Array.isArray(ze))return ze;let rt={};for(let at of ze)if(typeof at=="string"&&(rt.base=MC(rt.base,at)(u)),typeof at=="object")for(let[Wt,It]of Object.entries(at))rt[Wt]=MC(rt[Wt],It)(u);return rt},Le=We=>{if(s.length<1)return null;let ze={};for(let{slots:rt=[],class:at,className:Wt,...It}of s){if(!xu(It)){let Bt=!0;for(let Qt of Object.keys(It)){let hr=Se(Qt,We)[Qt];if(hr===void 0||(Array.isArray(It[Qt])?!It[Qt].includes(hr):It[Qt]!==hr)){Bt=!1;break}}if(!Bt)continue}for(let Bt of rt)ze[Bt]=ze[Bt]||[],ze[Bt].push([at,Wt])}return ze};if(!xu(i)||!M){let We={};if(typeof F=="object"&&!xu(F))for(let ze of Object.keys(F))We[ze]=rt=>{var at,Wt;return MC(F[ze],ce(ze,rt),((at=ue(rt))!=null?at:[])[ze],((Wt=Le(rt))!=null?Wt:[])[ze],rt?.class,rt?.className)(u)};return We}return MC(p,ee(),pe(),W?.class,W?.className)(u)},H=()=>{if(!(!m||typeof m!="object"))return Object.keys(m)};return j.variantKeys=H(),j.extend=r,j.base=p,j.slots=F,j.variants=m,j.defaultVariants=x,j.compoundSlots=s,j.compoundVariants=o,j};var P1=(t,e)=>{var r,i,n;return dme(t,{...e,twMerge:(r=e?.twMerge)!=null?r:!0,twMergeConfig:{...e?.twMergeConfig,theme:{...(i=e?.twMergeConfig)==null?void 0:i.theme,...Bq.theme},classGroups:{...(n=e?.twMergeConfig)==null?void 0:n.classGroups,...Bq.classGroups}}})};var CL=P1({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",circle1:["absolute","w-full","h-full","rounded-full","animate-spinner-ease-spin","border-2","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["absolute","w-full","h-full","rounded-full","opacity-75","animate-spinner-linear-spin","border-2","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"],label:"text-foreground dark:text-foreground-dark font-regular"},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current"},white:{circle1:"border-b-white",circle2:"border-b-white"},default:{circle1:"border-b-default",circle2:"border-b-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground"}});var PL=["outline-none","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"];var I1={default:["[&+.border-medium.border-default]:ms-[calc(theme(borderWidth.medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(theme(borderWidth.medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(theme(borderWidth.medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(theme(borderWidth.medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(theme(borderWidth.medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(theme(borderWidth.medium)*-1)]"]};var Q7e={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},J7e={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground",foreground:"shadow-lg shadow-foreground/40 bg-foreground text-background"},e9e={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger",foreground:"bg-transparent border-foreground text-foreground"},t9e={default:"bg-default/40 text-default-700",primary:"bg-primary/20 text-primary-600",secondary:"bg-secondary/20 text-secondary-600",success:"bg-success/20 text-success-700 dark:text-success",warning:"bg-warning/20 text-warning-700 dark:text-warning",danger:"bg-danger/20 text-danger-600 dark:text-danger-500",foreground:"bg-foreground/10 text-foreground"},r9e={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger",foreground:"border-default bg-default-100 text-foreground"},i9e={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger",foreground:"bg-transparent text-foreground"},n9e={default:"border-default text-default-foreground",primary:"border-primary text-primary",secondary:"border-secondary text-secondary",success:"border-success text-success",warning:"border-warning text-warning",danger:"border-danger text-danger",foreground:"border-foreground text-foreground hover:!bg-foreground"},ui={solid:Q7e,shadow:J7e,bordered:e9e,flat:t9e,faded:r9e,light:i9e,ghost:n9e};var IL=P1({slots:{base:["z-0","relative","bg-transparent","before:content-['']","before:hidden","before:z-[-1]","before:absolute","before:rotate-45","before:w-2.5","before:h-2.5","before:rounded-sm","data-[arrow=true]:before:block","data-[placement=top]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top]:before:left-1/2","data-[placement=top]:before:-translate-x-1/2","data-[placement=top-start]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-start]:before:left-3","data-[placement=top-end]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-end]:before:right-3","data-[placement=bottom]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom]:before:left-1/2","data-[placement=bottom]:before:-translate-x-1/2","data-[placement=bottom-start]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-start]:before:left-3","data-[placement=bottom-end]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-end]:before:right-3","data-[placement=left]:before:-right-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=left]:before:top-1/2","data-[placement=left]:before:-translate-y-1/2","data-[placement=left-start]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-start]:before:top-1/4","data-[placement=left-end]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-end]:before:bottom-1/4","data-[placement=right]:before:-left-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=right]:before:top-1/2","data-[placement=right]:before:-translate-y-1/2","data-[placement=right-start]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-start]:before:top-1/4","data-[placement=right-end]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-end]:before:bottom-1/4",...PL],content:["z-10","px-2.5","py-1","w-full","inline-flex","flex-col","items-center","justify-center","box-border","subpixel-antialiased","outline-none","box-border"],trigger:["z-10"],backdrop:["hidden"],arrow:[]},variants:{size:{sm:{content:"text-tiny"},md:{content:"text-small"},lg:{content:"text-medium"}},color:{default:{base:"before:bg-content1 before:shadow-small",content:"bg-content1"},foreground:{base:"before:bg-foreground",content:ui.solid.foreground},primary:{base:"before:bg-primary",content:ui.solid.primary},secondary:{base:"before:bg-secondary",content:ui.solid.secondary},success:{base:"before:bg-success",content:ui.solid.success},warning:{base:"before:bg-warning",content:ui.solid.warning},danger:{base:"before:bg-danger",content:ui.solid.danger}},radius:{none:{content:"rounded-none"},sm:{content:"rounded-small"},md:{content:"rounded-medium"},lg:{content:"rounded-large"},full:{content:"rounded-full"}},shadow:{sm:{content:"shadow-small"},md:{content:"shadow-medium"},lg:{content:"shadow-large"}},backdrop:{transparent:{},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-sm backdrop-saturate-150 bg-overlay/30"}},triggerScaleOnOpen:{true:{trigger:["aria-expanded:scale-[0.97]","aria-expanded:opacity-70","subpixel-antialiased"]},false:{}},disableAnimation:{true:{base:"animate-none"}},isTriggerDisabled:{true:{trigger:"opacity-disabled pointer-events-none"},false:{}}},defaultVariants:{color:"default",radius:"lg",size:"md",shadow:"md",backdrop:"transparent",triggerScaleOnOpen:!0},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"block w-full h-full fixed inset-0 -z-30"}}]});var Xq=P1({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-none","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent","data-[pressed=true]:scale-[0.97]",...PL],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-3 min-w-16 h-8 text-tiny gap-2 rounded-small",md:"px-4 min-w-20 h-10 text-small gap-2 rounded-medium",lg:"px-6 min-w-24 h-12 text-medium gap-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-0 !gap-0",false:"[&>svg]:max-w-[theme(spacing.8)]"},disableAnimation:{true:"!transition-none data-[pressed=true]:scale-100",false:"transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1},compoundVariants:[{variant:"solid",color:"default",class:ui.solid.default},{variant:"solid",color:"primary",class:ui.solid.primary},{variant:"solid",color:"secondary",class:ui.solid.secondary},{variant:"solid",color:"success",class:ui.solid.success},{variant:"solid",color:"warning",class:ui.solid.warning},{variant:"solid",color:"danger",class:ui.solid.danger},{variant:"shadow",color:"default",class:ui.shadow.default},{variant:"shadow",color:"primary",class:ui.shadow.primary},{variant:"shadow",color:"secondary",class:ui.shadow.secondary},{variant:"shadow",color:"success",class:ui.shadow.success},{variant:"shadow",color:"warning",class:ui.shadow.warning},{variant:"shadow",color:"danger",class:ui.shadow.danger},{variant:"bordered",color:"default",class:ui.bordered.default},{variant:"bordered",color:"primary",class:ui.bordered.primary},{variant:"bordered",color:"secondary",class:ui.bordered.secondary},{variant:"bordered",color:"success",class:ui.bordered.success},{variant:"bordered",color:"warning",class:ui.bordered.warning},{variant:"bordered",color:"danger",class:ui.bordered.danger},{variant:"flat",color:"default",class:ui.flat.default},{variant:"flat",color:"primary",class:ui.flat.primary},{variant:"flat",color:"secondary",class:ui.flat.secondary},{variant:"flat",color:"success",class:ui.flat.success},{variant:"flat",color:"warning",class:ui.flat.warning},{variant:"flat",color:"danger",class:ui.flat.danger},{variant:"faded",color:"default",class:ui.faded.default},{variant:"faded",color:"primary",class:ui.faded.primary},{variant:"faded",color:"secondary",class:ui.faded.secondary},{variant:"faded",color:"success",class:ui.faded.success},{variant:"faded",color:"warning",class:ui.faded.warning},{variant:"faded",color:"danger",class:ui.faded.danger},{variant:"light",color:"default",class:[ui.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[ui.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[ui.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[ui.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[ui.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[ui.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:[ui.ghost.default,"data-[hover=true]:!bg-default"]},{variant:"ghost",color:"primary",class:[ui.ghost.primary,"data-[hover=true]:!bg-primary data-[hover=true]:!text-primary-foreground"]},{variant:"ghost",color:"secondary",class:[ui.ghost.secondary,"data-[hover=true]:!bg-secondary data-[hover=true]:!text-secondary-foreground"]},{variant:"ghost",color:"success",class:[ui.ghost.success,"data-[hover=true]:!bg-success data-[hover=true]:!text-success-foreground"]},{variant:"ghost",color:"warning",class:[ui.ghost.warning,"data-[hover=true]:!bg-warning data-[hover=true]:!text-warning-foreground"]},{variant:"ghost",color:"danger",class:[ui.ghost.danger,"data-[hover=true]:!bg-danger data-[hover=true]:!text-danger-foreground"]},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:I1.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:I1.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:I1.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:I1.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:I1.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:I1.danger},{isIconOnly:!0,size:"sm",class:"min-w-8 w-8 h-8"},{isIconOnly:!0,size:"md",class:"min-w-10 w-10 h-10"},{isIconOnly:!0,size:"lg",class:"min-w-12 w-12 h-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]}),kL=P1({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});var ug={ease:[.36,.66,.4,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1],spring:[.155,1.105,.295,1.12],springOut:[.57,-.15,.62,.07],softSpring:[.16,1.11,.3,1.02]},l9e={enter:{duration:.2,ease:ug.easeOut},exit:{duration:.1,ease:ug.easeIn}},Zq={scaleSpring:{enter:{transform:"scale(1)",opacity:1,transition:{type:"spring",bounce:0,duration:.2}},exit:{transform:"scale(0.85)",opacity:0,transition:{type:"easeOut",duration:.15}}},scaleSpringOpacity:{initial:{opacity:0,transform:"scale(0.8)"},enter:{opacity:1,transform:"scale(1)",transition:{type:"spring",bounce:0,duration:.3}},exit:{opacity:0,transform:"scale(0.96)",transition:{type:"easeOut",bounce:0,duration:.15}}},scale:{enter:{scale:1},exit:{scale:.95}},scaleFadeIn:{enter:{transform:"scale(1)",opacity:1,transition:{duration:.25,ease:ug.easeIn}},exit:{transform:"scale(0.95)",opacity:0,transition:{duration:.2,ease:ug.easeOut}}},scaleInOut:{enter:{transform:"scale(1)",opacity:1,transition:{duration:.4,ease:ug.ease}},exit:{transform:"scale(1.03)",opacity:0,transition:{duration:.3,ease:ug.ease}}},fade:{enter:{opacity:1,transition:{duration:.4,ease:ug.ease}},exit:{opacity:0,transition:{duration:.3,ease:ug.ease}}},collapse:{enter:{opacity:1,height:"auto",transition:{height:{type:"spring",bounce:0,duration:.3},opacity:{easings:"ease",duration:.4}}},exit:{opacity:0,height:0,transition:{easings:"ease",duration:.3}}}};var Kq=t=>{let e={top:{originY:1},bottom:{originY:0},left:{originX:1},right:{originX:0},"top-start":{originX:0,originY:1},"top-end":{originX:1,originY:1},"bottom-start":{originX:0,originY:0},"bottom-end":{originX:1,originY:0},"right-start":{originX:0,originY:0},"right-end":{originX:0,originY:1},"left-start":{originX:1,originY:0},"left-end":{originX:1,originY:1}};return e?.[t]||{}},Qq=t=>({top:"top",bottom:"bottom",left:"left",right:"right","top-start":"top start","top-end":"top end","bottom-start":"bottom start","bottom-end":"bottom end","left-start":"left top","left-end":"left bottom","right-start":"right top","right-end":"right bottom"})[t];var RL=(t,e)=>{if(e.includes("-")){let[,r]=e.split("-");return`${t}-${r}`}return t};var OL=Tt($t(),1),fme=globalThis?.document?OL.useLayoutEffect:OL.useEffect;var CC=Tt($t(),1);function pme(t){var e,r;let i=c1(),[n,o]=Yy(t,kL.variantKeys),{ref:s,as:a,children:u,color:p="default",size:m="md",variant:x="solid",radius:M,isDisabled:k=!1,isIconOnly:F=!1,disableRipple:j=(e=i?.disableRipple)!=null?e:!1,disableAnimation:H=(r=i?.disableAnimation)!=null?r:!1,className:W,...Z}=n,Y=a||"div",ee=hE(s),ce=(0,CC.useMemo)(()=>kL({...o,className:W}),[l1(o),W]),ge=(0,CC.useMemo)(()=>({size:m,color:p,variant:x,radius:M,isIconOnly:F,isDisabled:k,disableAnimation:H,disableRipple:j,fullWidth:!!t?.fullWidth}),[m,p,x,M,k,F,H,j,t?.fullWidth]),Se=(0,CC.useCallback)(()=>({role:"group",...Z}),[Z]);return{Component:Y,children:u,domRef:ee,context:ge,classNames:ce,getButtonGroupProps:Se}}var[mme,gme]=cE({name:"ButtonGroupContext",strict:!1});var Jq=Tt(oo(),1),Ame=l0((t,e)=>{let{Component:r,domRef:i,context:n,children:o,classNames:s,getButtonGroupProps:a}=pme({...t,ref:e});return(0,Jq.jsx)(mme,{value:n,children:(0,Jq.jsx)(r,{ref:i,className:s,...a(),children:o})})});Ame.displayName="NextUI.ButtonGroup";var eY=Ame;var DL=Tt($t(),1);var R1=Tt($t(),1);function yme(t,e){let{elementType:r="button",isDisabled:i,onPress:n,onPressStart:o,onPressEnd:s,onPressChange:a,preventFocusOnPress:u,allowFocusWhenDisabled:p,onClick:m,href:x,target:M,rel:k,type:F="button",allowTextSelectionOnPress:j}=t,H;r==="button"?H={type:F,disabled:i}:H={role:"button",tabIndex:i?void 0:0,href:r==="a"&&!i?x:void 0,target:r==="a"?M:void 0,type:r==="input"?F:void 0,disabled:r==="input"?i:void 0,"aria-disabled":!i||r==="input"?void 0:i,rel:r==="a"?k:void 0};let W=h1()||m2();m&&typeof m=="function"&&fE("onClick is deprecated, please use onPress instead. See: https://github.com/nextui-org/nextui/issues/4292","useButton");let Z=Se=>{W&&m?.(Se),n?.(Se)},{pressProps:Y,isPressed:ee}=fG({onPressStart:o,onPressEnd:s,onPressChange:a,onPress:Z,isDisabled:i,preventFocusOnPress:u,allowTextSelectionOnPress:j,ref:e}),{focusableProps:ce}=EE(t,e);p&&(ce.tabIndex=i?-1:ce.tabIndex);let ge=fs(ce,Y,gE(t,{labelable:!0}));return{isPressed:ee,buttonProps:fs(H,ge,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],onClick:Se=>{F==="button"&&W||m?.(Se)}})}}xC();var k1=Tt(oo(),1),u9e=()=>Promise.resolve().then(()=>(rY(),tY)).then(t=>t.default),_me=t=>{let{ripples:e=[],motionProps:r,color:i="currentColor",style:n,onClear:o}=t;return(0,k1.jsx)(k1.Fragment,{children:e.map(s=>{let a=NW(.01*s.size,.2,s.size>100?.75:.5);return(0,k1.jsx)(dC,{features:u9e,children:(0,k1.jsx)(uC,{mode:"popLayout",children:(0,k1.jsx)(yC.span,{animate:{transform:"scale(2)",opacity:0},className:"nextui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:i,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:s.y,left:s.x,width:`${s.size}px`,height:`${s.size}px`,...n},transition:{duration:a},onAnimationComplete:()=>{o(s.key)},...r})})},s.key)})})};_me.displayName="NextUI.Ripple";var iY=_me;var PC=Tt($t(),1);function nY(t={}){let[e,r]=(0,PC.useState)([]),i=(0,PC.useCallback)(o=>{let s=o.target,a=Math.max(s.clientWidth,s.clientHeight);r(u=>[...u,{key:FW(u.length.toString()),size:a,x:o.x-a/2,y:o.y-a/2}])},[]),n=(0,PC.useCallback)(o=>{r(s=>s.filter(a=>a.key!==o))},[]);return{ripples:e,onClear:n,onPress:i,...t}}function vme(t){var e,r,i,n,o,s,a,u,p;let m=gme(),x=c1(),M=!!m,{ref:k,as:F,children:j,startContent:H,endContent:W,autoFocus:Z,className:Y,spinner:ee,isLoading:ce=!1,disableRipple:ge=!1,fullWidth:Se=(e=m?.fullWidth)!=null?e:!1,radius:ne=m?.radius,size:pe=(r=m?.size)!=null?r:"md",color:ue=(i=m?.color)!=null?i:"default",variant:Le=(n=m?.variant)!=null?n:"solid",disableAnimation:We=(s=(o=m?.disableAnimation)!=null?o:x?.disableAnimation)!=null?s:!1,isDisabled:ze=(a=m?.isDisabled)!=null?a:!1,isIconOnly:rt=(u=m?.isIconOnly)!=null?u:!1,spinnerPlacement:at="start",onPress:Wt,onClick:It,...Bt}=t,Qt=F||"button",hr=typeof Qt=="string",nt=hE(k),Et=(p=ge||x?.disableRipple)!=null?p:We,{isFocusVisible:yr,isFocused:xr,focusProps:oi}=kG({autoFocus:Z}),jr=ze||ce,zi=(0,R1.useMemo)(()=>Xq({size:pe,color:ue,variant:Le,radius:ne,fullWidth:Se,isDisabled:jr,isInGroup:M,disableAnimation:We,isIconOnly:rt,className:Y}),[pe,ue,Le,ne,Se,jr,M,rt,We,Y]),{onPress:on,onClear:Ki,ripples:hn}=nY(),_l=(0,DL.useCallback)($s=>{Et||jr||We||nt.current&&on($s)},[Et,jr,We,nt,on]),{buttonProps:xn,isPressed:dn}=yme({elementType:F,isDisabled:jr,onPress:u1(Wt,_l),onClick:It,...Bt},nt),{isHovered:Pa,hoverProps:vl}=p1({isDisabled:jr}),cs=(0,DL.useCallback)(($s={})=>({"data-disabled":Dc(jr),"data-focus":Dc(xr),"data-pressed":Dc(dn),"data-focus-visible":Dc(yr),"data-hover":Dc(Pa),"data-loading":Dc(ce),...fs(xn,oi,vl,pE(Bt,{enabled:hr}),pE($s))}),[ce,jr,xr,dn,hr,yr,Pa,xn,oi,vl,Bt]),Ss=$s=>(0,R1.isValidElement)($s)?(0,R1.cloneElement)($s,{"aria-hidden":!0,focusable:!1,tabIndex:-1}):null,Wl=Ss(H),Gl=Ss(W),_c=(0,R1.useMemo)(()=>({sm:"sm",md:"sm",lg:"md"})[pe],[pe]),us=(0,DL.useCallback)(()=>({ripples:hn,onClear:Ki}),[hn,Ki]);return{Component:Qt,children:j,domRef:nt,spinner:ee,styles:zi,startContent:Wl,endContent:Gl,isLoading:ce,spinnerPlacement:at,spinnerSize:_c,disableRipple:Et,getButtonProps:cs,getRippleProps:us,isIconOnly:rt}}var IC=Tt($t(),1);function bme(t){let[e,r]=Yy(t,CL.variantKeys),{children:i,className:n,classNames:o,label:s,...a}=e,u=(0,IC.useMemo)(()=>CL({...r}),[l1(r)]),p=dE(o?.base,n),m=s||i,x=(0,IC.useMemo)(()=>m&&typeof m=="string"?m:a["aria-label"]?"":"Loading",[i,m,a["aria-label"]]),M=(0,IC.useCallback)(()=>({"aria-label":x,className:u.base({class:p}),...a}),[x,u,p,a]);return{label:m,slots:u,classNames:o,getSpinnerProps:M}}var O1=Tt(oo(),1),xme=l0((t,e)=>{let{slots:r,classNames:i,label:n,getSpinnerProps:o}=bme({...t});return(0,O1.jsxs)("div",{ref:e,...o(),children:[(0,O1.jsxs)("div",{className:r.wrapper({class:i?.wrapper}),children:[(0,O1.jsx)("i",{className:r.circle1({class:i?.circle1})}),(0,O1.jsx)("i",{className:r.circle2({class:i?.circle2})})]}),n&&(0,O1.jsx)("span",{className:r.label({class:i?.label}),children:n})]})});xme.displayName="NextUI.Spinner";var oY=xme;var kC=Tt(oo(),1),wme=l0((t,e)=>{let{Component:r,domRef:i,children:n,styles:o,spinnerSize:s,spinner:a=(0,kC.jsx)(oY,{color:"current",size:s}),spinnerPlacement:u,startContent:p,endContent:m,isLoading:x,disableRipple:M,getButtonProps:k,getRippleProps:F,isIconOnly:j}=vme({...t,ref:e});return(0,kC.jsxs)(r,{ref:i,className:o,...k(),children:[p,x&&u==="start"&&a,x&&j?null:n,x&&u==="end"&&a,m,!M&&(0,kC.jsx)(iY,{...F()})]})});wme.displayName="NextUI.Button";var RC=wme;var BL=Tt($t(),1);var Zy=Tt($t(),1);var LL=Tt($t(),1);function sY(t){let[e,r]=iG(t.isOpen,t.defaultOpen||!1,t.onOpenChange),i=(0,LL.useCallback)(()=>{r(!0)},[r]),n=(0,LL.useCallback)(()=>{r(!1)},[r]),o=(0,LL.useCallback)(()=>{r(!e)},[r,e]);return{isOpen:e,setOpen:r,open:i,close:n,toggle:o}}var h9e=1500,Sme=500,D1={},d9e=0,OC=!1,hg=null,L1=null;function aY(t={}){let{delay:e=h9e,closeDelay:r=Sme}=t,{isOpen:i,open:n,close:o}=sY(t),s=(0,Zy.useMemo)(()=>`${++d9e}`,[]),a=(0,Zy.useRef)(null),u=(0,Zy.useRef)(o),p=()=>{D1[s]=M},m=()=>{for(let F in D1)F!==s&&(D1[F](!0),delete D1[F])},x=()=>{a.current&&clearTimeout(a.current),a.current=null,m(),p(),OC=!0,n(),hg&&(clearTimeout(hg),hg=null),L1&&(clearTimeout(L1),L1=null)},M=F=>{F||r<=0?(a.current&&clearTimeout(a.current),a.current=null,u.current()):a.current||(a.current=setTimeout(()=>{a.current=null,u.current()},r)),hg&&(clearTimeout(hg),hg=null),OC&&(L1&&clearTimeout(L1),L1=setTimeout(()=>{delete D1[s],L1=null,OC=!1},Math.max(Sme,r)))},k=()=>{m(),p(),!i&&!hg&&!OC?hg=setTimeout(()=>{hg=null,OC=!0,x()},e):i||x()};return(0,Zy.useEffect)(()=>{u.current=o},[o]),(0,Zy.useEffect)(()=>()=>{a.current&&clearTimeout(a.current),D1[s]&&delete D1[s]},[s]),{isOpen:i,open:F=>{!F&&e>0&&!a.current?k():x()},close:M}}function lY(t,e){let r=gE(t,{labelable:!0}),{hoverProps:i}=p1({onHoverStart:()=>e?.open(!0),onHoverEnd:()=>e?.close()});return{tooltipProps:fs(r,i,{role:"tooltip"})}}var DC=Tt($t(),1);function cY(t,e,r){let{isDisabled:i,trigger:n}=t,o=XW(),s=(0,DC.useRef)(!1),a=(0,DC.useRef)(!1),u=()=>{(s.current||a.current)&&e.open(a.current)},p=W=>{!s.current&&!a.current&&e.close(W)};(0,DC.useEffect)(()=>{let W=Z=>{r&&r.current&&Z.key==="Escape"&&(Z.stopPropagation(),e.close(!0))};if(e.isOpen)return document.addEventListener("keydown",W,!0),()=>{document.removeEventListener("keydown",W,!0)}},[r,e]);let m=()=>{n!=="focus"&&(wE()==="pointer"?s.current=!0:s.current=!1,u())},x=()=>{n!=="focus"&&(a.current=!1,s.current=!1,p())},M=()=>{a.current=!1,s.current=!1,p(!0)},k=()=>{S2()&&(a.current=!0,u())},F=()=>{a.current=!1,s.current=!1,p(!0)},{hoverProps:j}=p1({isDisabled:i,onHoverStart:m,onHoverEnd:x}),{focusableProps:H}=EE({isDisabled:i,onFocus:k,onBlur:F},r);return{triggerProps:{"aria-describedby":e.isOpen?o:void 0,...fs(H,j,{onPointerDown:M,onKeyDown:M})},tooltipProps:{id:o}}}var dg=Tt($t(),1);function Tme(t){var e,r;let i=c1(),[n,o]=Yy(t,IL.variantKeys),{ref:s,as:a,isOpen:u,content:p,children:m,defaultOpen:x,onOpenChange:M,isDisabled:k,trigger:F,shouldFlip:j=!0,containerPadding:H=12,placement:W="top",delay:Z=0,closeDelay:Y=500,showArrow:ee=!1,offset:ce=7,crossOffset:ge=0,isDismissable:Se,shouldCloseOnBlur:ne=!0,portalContainer:pe,isKeyboardDismissDisabled:ue=!1,updatePositionDeps:Le=[],shouldCloseOnInteractOutside:We,className:ze,onClose:rt,motionProps:at,classNames:Wt,...It}=n,Bt=a||"div",Qt=(r=(e=t?.disableAnimation)!=null?e:i?.disableAnimation)!=null?r:!1,hr=aY({delay:Z,closeDelay:Y,isDisabled:k,defaultOpen:x,isOpen:u,onOpenChange:cs=>{M?.(cs),cs||rt?.()}}),nt=(0,dg.useRef)(null),Et=(0,dg.useRef)(null),yr=(0,BL.useId)(),xr=hr.isOpen&&!k;(0,BL.useImperativeHandle)(s,()=>LW(Et));let{triggerProps:oi,tooltipProps:jr}=cY({isDisabled:k,trigger:F},hr,nt),{tooltipProps:zi}=lY({isOpen:xr,...fs(n,jr)},hr),{overlayProps:on,placement:Ki,updatePosition:hn}=sG({isOpen:xr,targetRef:nt,placement:Qq(W),overlayRef:Et,offset:ee?ce+3:ce,crossOffset:ge,shouldFlip:j,containerPadding:H});fme(()=>{Le.length&&hn()},Le);let{overlayProps:_l}=RG({isOpen:xr,onClose:hr.close,isDismissable:Se,shouldCloseOnBlur:ne,isKeyboardDismissDisabled:ue,shouldCloseOnInteractOutside:We},Et),xn=(0,dg.useMemo)(()=>{var cs,Ss,Wl;return IL({...o,disableAnimation:Qt,radius:(cs=t?.radius)!=null?cs:"md",size:(Ss=t?.size)!=null?Ss:"md",shadow:(Wl=t?.shadow)!=null?Wl:"sm"})},[l1(o),Qt,t?.radius,t?.size,t?.shadow]),dn=(0,dg.useCallback)((cs={},Ss=null)=>({...fs(oi,cs),ref:zW(Ss,nt),"aria-describedby":xr?yr:void 0}),[oi,xr,yr,hr]),Pa=(0,dg.useCallback)(()=>({ref:Et,"data-slot":"base","data-open":Dc(xr),"data-arrow":Dc(ee),"data-disabled":Dc(k),"data-placement":RL(Ki||"top",W),...fs(zi,_l,It),style:fs(on.style,It.style,n.style),className:xn.base({class:Wt?.base}),id:yr}),[xn,xr,ee,k,Ki,W,zi,_l,It,on,n,yr]),vl=(0,dg.useCallback)(()=>({"data-slot":"content","data-open":Dc(xr),"data-arrow":Dc(ee),"data-disabled":Dc(k),"data-placement":RL(Ki||"top",W),className:xn.content({class:dE(Wt?.content,ze)})}),[xn,xr,ee,k,Ki,W,Wt]);return{Component:Bt,content:p,children:m,isOpen:xr,triggerRef:nt,showArrow:ee,portalContainer:pe,placement:W,disableAnimation:Qt,isDisabled:k,motionProps:at,getTooltipContentProps:vl,getTriggerProps:dn,getTooltipProps:Pa}}xC();var e3=Tt($t(),1);var ic=Tt(oo(),1),f9e=()=>Promise.resolve().then(()=>(rY(),tY)).then(t=>t.default),Mme=l0((t,e)=>{let{Component:r,children:i,content:n,isOpen:o,portalContainer:s,placement:a,disableAnimation:u,motionProps:p,getTriggerProps:m,getTooltipProps:x,getTooltipContentProps:M}=Tme({...t,ref:e}),k;try{if(e3.Children.count(i)!==1)throw new Error;if(!(0,e3.isValidElement)(i))k=(0,ic.jsx)("p",{...m(),children:i});else{let ee=i;k=(0,e3.cloneElement)(ee,m(ee.props,ee.ref))}}catch{k=(0,ic.jsx)("span",{}),fE("Tooltip must have only one child node. Please, check your code.")}let{ref:F,id:j,style:H,...W}=x(),Z=(0,ic.jsx)("div",{ref:F,id:j,style:H,children:(0,ic.jsx)(dC,{features:f9e,children:(0,ic.jsx)(yC.div,{animate:"enter",exit:"exit",initial:"exit",variants:Zq.scaleSpring,...fs(p,W),style:{...Kq(a)},children:(0,ic.jsx)(r,{...M(),children:n})})})});return(0,ic.jsxs)(ic.Fragment,{children:[k,u&&o?(0,ic.jsx)(YO,{portalContainer:s,children:(0,ic.jsx)("div",{ref:F,id:j,style:H,...W,children:(0,ic.jsx)(r,{...M(),children:n})})}):(0,ic.jsx)(uC,{children:o?(0,ic.jsx)(YO,{portalContainer:s,children:Z}):null})]})});Mme.displayName="NextUI.Tooltip";var uY=Mme;var Eme=Tt($t()),Cme=Eme.useLayoutEffect;var eIe=Tt(fY(),1),tIe=Tt(Bme(),1),Ap=Tt($t(),1);var Rl=[];for(let t=0;t<256;++t)Rl.push((t+256).toString(16).slice(1));function Fme(t,e=0){return(Rl[t[e+0]]+Rl[t[e+1]]+Rl[t[e+2]]+Rl[t[e+3]]+"-"+Rl[t[e+4]]+Rl[t[e+5]]+"-"+Rl[t[e+6]]+Rl[t[e+7]]+"-"+Rl[t[e+8]]+Rl[t[e+9]]+"-"+Rl[t[e+10]]+Rl[t[e+11]]+Rl[t[e+12]]+Rl[t[e+13]]+Rl[t[e+14]]+Rl[t[e+15]]).toLowerCase()}var mY,Y9e=new Uint8Array(16);function gY(){if(!mY){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");mY=crypto.getRandomValues.bind(crypto)}return mY(Y9e)}var X9e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),AY={randomUUID:X9e};function Z9e(t,e,r){t=t||{};let i=t.random??t.rng?.()??gY();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){if(r=r||0,r<0||r+16>e.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let n=0;n<16;++n)e[r+n]=i[n];return e}return Fme(i)}function K9e(t,e,r){return AY.randomUUID&&!e&&!t?AY.randomUUID():Z9e(t,e,r)}var yY=K9e;function Ky(t,e){if(!t)throw new Error(e||"loader assertion failed.")}var c0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Q9e=c0.self||c0.window||c0.global||{},J9e=c0.window||c0.self||c0.global||{},eBe=c0.global||c0.self||c0.window||{},tBe=c0.document||{};var B1=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser);var Nme=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),rBe=Nme&&parseFloat(Nme[1])||0;BC();var TY="4.3.3",hBe=TY[0]>="0"&&TY[0]<="9"?`v${TY}`:"";function dBe(){let t=new wu({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=hBe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}var MY=dBe();function EY(t,e){return ige(t||{},e)}function ige(t,e,r=0){if(r>3)return e;let i={...t};for(let[n,o]of Object.entries(e))o&&typeof o=="object"&&!Array.isArray(o)?i[n]=ige(i[n]||{},e[n],r+1):i[n]=e[n];return i}var nge="latest";function fBe(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}var CY=fBe();function Bc(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}var u0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},$kt=u0.self||u0.window||u0.global||{},Wkt=u0.window||u0.self||u0.global||{},Gkt=u0.global||u0.self||u0.window||{},Hkt=u0.document||{};var vd=typeof process!="object"||String(process)!=="[object process]"||process.browser;var sge=typeof window<"u"&&typeof window.orientation<"u",oge=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),qkt=oge&&parseFloat(oge[1])||0;var FC=class{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,r){this.name=e,this.workerThread=r,this.result=new Promise((i,n)=>{this._resolve=i,this._reject=n})}postMessage(e,r){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:r})}done(e){Bc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Bc(this.isRunning),this.isRunning=!1,this._reject(e)}};var i3=class{terminate(){}};var PY=new Map;function age(t){Bc(t.source&&!t.url||!t.source&&t.url);let e=PY.get(t.source||t.url);return e||(t.url&&(e=pBe(t.url),PY.set(t.url,e)),t.source&&(e=lge(t.source),PY.set(t.source,e))),Bc(e),e}function pBe(t){if(!t.startsWith("http"))return t;let e=mBe(t);return lge(e)}function lge(t){let e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function mBe(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function IY(t,e=!0,r){let i=r||new Set;if(t){if(cge(t))i.add(t);else if(cge(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(let n in t)IY(t[n],e,i)}}return r===void 0?Array.from(i):[]}function cge(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}var kY=()=>{},Jy=class{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&vd||typeof i3<"u"&&!vd}constructor(e){let{name:r,source:i,url:n}=e;Bc(i||n),this.name=r,this.source=i,this.url=n,this.onMessage=kY,this.onError=o=>console.log(o),this.worker=vd?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=kY,this.onError=kY,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,r){r=r||IY(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,e.message&&(r+=`${e.message} in `),e.lineno&&(r+=`:${e.lineno}:${e.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=age({source:this.source,url:this.url});let e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},e.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},e.onmessageerror=r=>console.error(r),e}_createNodeWorker(){let e;if(this.url){let i=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new i3(i,{eval:!1})}else if(this.source)e=new i3(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",r=>{this.onMessage(r)}),e.on("error",r=>{this.onError(r)}),e.on("exit",r=>{}),e}};var NC=class{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return Jy.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,r=(n,o,s)=>n.done(s),i=(n,o)=>n.error(o)){let n=new Promise(o=>(this.jobQueue.push({name:e,onMessage:r,onError:i,onStart:o}),this));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;let e=this._getAvailableWorker();if(!e)return;let r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:e,backlog:this.jobQueue.length});let i=new FC(r.name,e);e.onMessage=n=>r.onMessage(i,n.type,n.payload),e.onError=n=>r.onError(i,n),r.onStart(i);try{await i.result}catch(n){console.error(`Worker exception: ${n}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!vd||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Jy({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return sge?this.maxMobileConcurrency:this.maxConcurrency}};var gBe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},N1=class t{props;workerPools=new Map;static _workerFarm;static isSupported(){return Jy.isSupported()}static getWorkerFarm(e={}){return t._workerFarm=t._workerFarm||new t({}),t._workerFarm.setProps(e),t._workerFarm}constructor(e){this.props={...gBe},this.setProps(e),this.workerPools=new Map}destroy(){for(let e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(let r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(e){let{name:r,source:i,url:n}=e,o=this.workerPools.get(r);return o||(o=new NC({name:r,source:i,url:n}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};function RY(t,e={}){let r=e[t.id]||{},i=vd?`${t.id}-worker.js`:`${t.id}-worker-node.js`,n=r.workerUrl;if(!n&&t.id==="compression"&&(n=e.workerUrl),e._workerType==="test"&&(vd?n=`modules/${t.module}/dist/${i}`:n=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!n){let o=t.version;o==="latest"&&(o=nge);let s=o?`@${o}`:"";n=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${i}`}return Bc(n),n}function OY(t,e=CY){Bc(t,"no worker provided");let r=t.version;return!(!e||!r)}function DY(t,e){return!N1.isSupported()||!vd&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function LY(t,e,r,i,n){let o=t.id,s=RY(t,r),u=N1.getWorkerFarm(r).getWorkerPool({name:o,url:s});r=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(i||{}));let p=await u.startJob("process-on-worker",ABe.bind(null,n));return p.postMessage("process",{input:e,options:r,context:i}),await(await p.result).result}async function ABe(t,e,r,i){switch(r){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":let{id:n,input:o,options:s}=i;try{let a=await t(o,s);e.postMessage("done",{id:n,result:a})}catch(a){let u=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:n,error:u})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function BY(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;let i=new Uint8Array(t),n=new Uint8Array(e);for(let o=0;o<i.length;++o)if(i[o]!==n[o])return!1;return!0}function FY(...t){return uge(t)}function uge(t){let e=t.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),r=e.reduce((o,s)=>o+s.byteLength,0),i=new Uint8Array(r),n=0;for(let o of e)i.set(o,n),n+=o.byteLength;return i.buffer}async function NY(t){let e=[];for await(let r of t)e.push(r);return FY(...e)}n3();var yBe="Queued Requests",_Be="Active Requests",vBe="Cancelled Requests",bBe="Queued Requests Ever",xBe="Active Requests Ever",wBe={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0},o3=class{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(e={}){this.props={...wBe,...e},this.stats=new Su({id:this.props.id}),this.stats.get(yBe),this.stats.get(_Be),this.stats.get(vBe),this.stats.get(bBe),this.stats.get(xBe)}scheduleRequest(e,r=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);let i={handle:e,priority:0,getPriority:r},n=new Promise(o=>(i.resolve=o,i));return this.requestQueue.push(i),this.requestMap.set(e,n),this._issueNewRequests(),n}_issueRequest(e){let{handle:r,resolve:i}=e,n=!1,o=()=>{n||(n=!0,this.requestMap.delete(r),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:o}):Promise.resolve({done:o})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;let e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let r=0;r<e;++r){let i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){let e=this.requestQueue;for(let r=0;r<e.length;++r){let i=e[r];this._updateRequest(i)||(e.splice(r,1),this.requestMap.delete(i.handle),r--)}e.sort((r,i)=>r.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}};var SBe="",dge={};function VY(t){for(let e in dge)if(t.startsWith(e)){let r=dge[e];t=t.replace(e,r)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${SBe}${t}`),t}function fge(t){return t&&typeof t=="object"&&t.isBuffer}function $L(t){if(fge(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){let e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}var U1={};nl(U1,{dirname:()=>MBe,filename:()=>TBe,join:()=>EBe,resolve:()=>CBe});function pge(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();let t=window.location?.pathname;return t?.slice(0,t.lastIndexOf("/")+1)||""}function TBe(t){let e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function MBe(t){let e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}function EBe(...t){return t=t.map((r,i)=>(i&&(r=r.replace(new RegExp("^/"),"")),i!==t.length-1&&(r=r.replace(new RegExp("/$"),"")),r)),t.join("/")}function CBe(...t){let e=[];for(let o=0;o<t.length;o++)e[o]=t[o];let r="",i=!1,n;for(let o=e.length-1;o>=-1&&!i;o--){let s;o>=0?s=e[o]:(n===void 0&&(n=pge()),s=n),s.length!==0&&(r=`${s}/${r}`,i=s.charCodeAt(0)===UC)}return r=PBe(r,!i),i?`/${r}`:r.length>0?r:"."}var UC=47,jY=46;function PBe(t,e){let r="",i=-1,n=0,o,s=!1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===UC)break;o=UC}if(o===UC){if(!(i===a-1||n===1))if(i!==a-1&&n===2){if(r.length<2||!s||r.charCodeAt(r.length-1)!==jY||r.charCodeAt(r.length-2)!==jY){if(r.length>2){let u=r.length-1,p=u;for(;p>=0&&r.charCodeAt(p)!==UC;--p);if(p!==u){r=p===-1?"":r.slice(0,p),i=a,n=0,s=!1;continue}}else if(r.length===2||r.length===1){r="",i=a,n=0,s=!1;continue}}e&&(r.length>0?r+="/..":r="..",s=!0)}else{let u=t.slice(i+1,a);r.length>0?r+=`/${u}`:r=u,s=!1}i=a,n=0}else o===jY&&n!==-1?++n:n=-1}return r}var IBe=t=>typeof t=="boolean",VC=t=>typeof t=="function",V1=t=>t!==null&&typeof t=="object",$Y=t=>V1(t)&&t.constructor==={}.constructor;var mge=t=>!!t&&typeof t[Symbol.iterator]=="function",gge=t=>t&&typeof t[Symbol.asyncIterator]=="function";var bd=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json;var xd=t=>typeof Blob<"u"&&t instanceof Blob,Age=t=>t&&typeof t=="object"&&t.isBuffer;var kBe=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||V1(t)&&VC(t.tee)&&VC(t.cancel)&&VC(t.getReader);var RBe=t=>V1(t)&&VC(t.read)&&VC(t.pipe)&&IBe(t.readable),WL=t=>kBe(t)||RBe(t);var GL=class extends Error{constructor(e,r){super(e),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response};var OBe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,DBe=/^([-\w.]+\/[-\w.+]+)/;function WY(t,e){return t.toLowerCase()===e.toLowerCase()}function yge(t){let e=DBe.exec(t);return e?e[1]:t}function GY(t){let e=OBe.exec(t);return e?e[1]:""}var _ge=/\?.*/;function vge(t){let e=t.match(_ge);return e&&e[0]}function s3(t){return t.replace(_ge,"")}function bge(t){if(t.length<50)return t;let e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function j1(t){return bd(t)?t.url:xd(t)?t.name||"":typeof t=="string"?t:""}function jC(t){if(bd(t)){let e=t,r=e.headers.get("content-type")||"",i=s3(e.url);return yge(r)||GY(i)}return xd(t)?t.type||"":typeof t=="string"?GY(t):""}function xge(t){return bd(t)?t.headers["content-length"]||-1:xd(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function HL(t){if(bd(t))return t;let e={},r=xge(t);r>=0&&(e["content-length"]=String(r));let i=j1(t),n=jC(t);n&&(e["content-type"]=n);let o=await BBe(t);o&&(e["x-first-bytes"]=o),typeof t=="string"&&(t=new TextEncoder().encode(t));let s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:i}),s}async function wge(t){if(!t.ok)throw await LBe(t)}async function LBe(t){let e=bge(t.url),r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;r=r.length>100?`${r.slice(0,100)}...`:r;let i={reason:t.statusText,url:t.url,response:t};try{let n=t.headers.get("Content-Type");i.reason=!t.bodyUsed&&n?.includes("application/json")?await t.json():await t.text()}catch{}return new GL(r,i)}async function BBe(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){let r=t.slice(0,5);return await new Promise(i=>{let n=new FileReader;n.onload=o=>i(o?.target?.result),n.readAsDataURL(r)})}if(t instanceof ArrayBuffer){let r=t.slice(0,5);return`data:base64,${FBe(r)}`}return null}function FBe(t){let e="",r=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)e+=String.fromCharCode(r[i]);return btoa(e)}function NBe(t){return!zBe(t)&&!UBe(t)}function zBe(t){return t.startsWith("http:")||t.startsWith("https:")}function UBe(t){return t.startsWith("data:")}async function HY(t,e){if(typeof t=="string"){let r=VY(t);return NBe(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,e):await fetch(r,e)}return await HL(t)}BC();var qY=new wu({id:"loaders.gl"}),qL=class{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}},YL=class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}};var YY={fetch:null,mimeType:void 0,nothrow:!1,log:new YL,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:B1,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Sge={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function XY(){globalThis.loaders=globalThis.loaders||{};let{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function ZY(){let t=XY();return t.globalOptions=t.globalOptions||{...YY},t.globalOptions}function Ege(t,e,r,i){return r=r||[],r=Array.isArray(r)?r:[r],VBe(t,r),$Be(e,t,i)}function VBe(t,e){Tge(t,null,YY,Sge,e);for(let r of e){let i=t&&t[r.id]||{},n=r.options&&r.options[r.id]||{},o=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};Tge(i,r.id,n,o,e)}}function Tge(t,e,r,i,n){let o=e||"Top level",s=e?`${e}.`:"";for(let a in t){let u=!e&&V1(t[a]),p=a==="baseUri"&&!e,m=a==="workerUrl"&&e;if(!(a in r)&&!p&&!m){if(a in i)qY.warn(`${o} loader option '${s}${a}' no longer supported, use '${i[a]}'`)();else if(!u){let x=jBe(a,n);qY.warn(`${o} loader option '${s}${a}' not recognized. ${x}`)()}}}}function jBe(t,e){let r=t.toLowerCase(),i="";for(let n of e)for(let o in n.options){if(t===o)return`Did you mean '${n.id}.${o}'?`;let s=o.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(i=i||`Did you mean '${n.id}.${o}'?`)}return i}function $Be(t,e,r){let n={...t.options||{}};return WBe(n,r),n.log===null&&(n.log=new qL),Mge(n,ZY()),Mge(n,e),n}function Mge(t,e){for(let r in e)if(r in e){let i=e[r];$Y(i)&&$Y(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function WBe(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function $C(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function WC(t){Ky(t,"null loader"),Ky($C(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}var Cge=()=>{let t=XY();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function KY(t){let e=Cge();t=Array.isArray(t)?t:[t];for(let r of t){let i=WC(r);e.find(n=>i===n)||e.unshift(i)}}function Pge(){return Cge()}var GBe=/\.([^.]+)$/;async function Rge(t,e=[],r,i){if(!Oge(t))return null;let n=Ige(t,e,{...r,nothrow:!0},i);if(n)return n;if(xd(t)&&(t=await t.slice(0,10).arrayBuffer(),n=Ige(t,e,r,i)),!n&&!r?.nothrow)throw new Error(Dge(t));return n}function Ige(t,e=[],r,i){if(!Oge(t))return null;if(e&&!Array.isArray(e))return WC(e);let n=[];e&&(n=n.concat(e)),r?.ignoreRegisteredLoaders||n.push(...Pge()),qBe(n);let o=HBe(t,n,r,i);if(!o&&!r?.nothrow)throw new Error(Dge(t));return o}function HBe(t,e,r,i){let n=j1(t),o=jC(t),s=s3(n)||i?.url,a=null,u="";return r?.mimeType&&(a=QY(e,r?.mimeType),u=`match forced by supplied MIME type ${r?.mimeType}`),a=a||YBe(e,s),u=u||(a?`matched url ${s}`:""),a=a||QY(e,o),u=u||(a?`matched MIME type ${o}`:""),a=a||ZBe(e,t),u=u||(a?`matched initial data ${Lge(t)}`:""),r?.fallbackMimeType&&(a=a||QY(e,r?.fallbackMimeType),u=u||(a?`matched fallback MIME type ${o}`:"")),u&&MY.log(1,`selectLoader selected ${a?.name}: ${u}.`),a}function Oge(t){return!(t instanceof Response&&t.status===204)}function Dge(t){let e=j1(t),r=jC(t),i="No valid loader found (";i+=e?`${U1.filename(e)}, `:"no url provided, ",i+=`MIME type: ${r?`"${r}"`:"not provided"}, `;let n=t?Lge(t):"";return i+=n?` first bytes: "${n}"`:"first bytes: not available",i+=")",i}function qBe(t){for(let e of t)WC(e)}function YBe(t,e){let r=e&&GBe.exec(e),i=r&&r[1];return i?XBe(t,i):null}function XBe(t,e){e=e.toLowerCase();for(let r of t)for(let i of r.extensions)if(i.toLowerCase()===e)return r;return null}function QY(t,e){for(let r of t)if(r.mimeTypes?.some(i=>WY(e,i))||WY(e,`application/x.${r.id}`))return r;return null}function ZBe(t,e){if(!e)return null;for(let r of t)if(typeof e=="string"){if(KBe(e,r))return r}else if(ArrayBuffer.isView(e)){if(kge(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer&&kge(e,0,r))return r;return null}function KBe(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function kge(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(n=>QBe(t,e,r,n))}function QBe(t,e,r,i){if(i instanceof ArrayBuffer)return BY(i,t,i.byteLength);switch(typeof i){case"function":return i(t);case"string":let n=JY(t,e,i.length);return i===n;default:return!1}}function Lge(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?JY(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?JY(t,0,e):""}function JY(t,e,r){if(t.byteLength<e+r)return"";let i=new DataView(t),n="";for(let o=0;o<r;o++)n+=String.fromCharCode(i.getUint8(e+o));return n}function*Bge(t,e){let r=e?.chunkSize||262144,i=0,n=new TextEncoder;for(;i<t.length;){let o=Math.min(t.length-i,r),s=t.slice(i,i+o);i+=o,yield n.encode(s)}}function*Fge(t,e={}){let{chunkSize:r=262144}=e,i=0;for(;i<t.byteLength;){let n=Math.min(t.byteLength-i,r),o=new ArrayBuffer(n),s=new Uint8Array(t,i,n);new Uint8Array(o).set(s),i+=n,yield o}}async function*Nge(t,e){let r=e?.chunkSize||1048576,i=0;for(;i<t.size;){let n=i+r,o=await t.slice(i,n).arrayBuffer();i=n,yield o}}function eX(t,e){return B1?JBe(t,e):eFe(t,e)}async function*JBe(t,e){let r=t.getReader(),i;try{for(;;){let n=i||r.read();e?._streamReadAhead&&(i=r.read());let{done:o,value:s}=await n;if(o)return;yield $L(s)}}catch{r.releaseLock()}}async function*eFe(t,e){for await(let r of t)yield $L(r)}function zge(t,e){if(typeof t=="string")return Bge(t,e);if(t instanceof ArrayBuffer)return Fge(t,e);if(xd(t))return Nge(t,e);if(WL(t))return eX(t,e);if(bd(t))return eX(t.body,e);throw new Error("makeIterator")}var Uge="Cannot convert supplied data type";function tFe(t,e,r){if(e.text&&typeof t=="string")return t;if(Age(t)&&(t=t.buffer),t instanceof ArrayBuffer){let i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer,n=t.byteLength||t.length;return(t.byteOffset!==0||n!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+n)),i}throw new Error(Uge)}async function Vge(t,e,r){let i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return tFe(t,e,r);if(xd(t)&&(t=await HL(t)),bd(t)){let n=t;return await wge(n),e.binary?await n.arrayBuffer():await n.text()}if(WL(t)&&(t=zge(t,r)),mge(t)||gge(t))return NY(t);throw new Error(Uge)}function XL(t,e){let r=ZY(),i=t||r;return typeof i.fetch=="function"?i.fetch:V1(i.fetch)?n=>HY(n,i.fetch):e?.fetch?e?.fetch:HY}function jge(t,e,r){if(r)return r;let i={fetch:XL(e,t),...t};if(i.url){let n=s3(i.url);i.baseUrl=n,i.queryString=vge(i.url),i.filename=U1.filename(n),i.baseUrl=U1.dirname(n)}return Array.isArray(i.loaders)||(i.loaders=null),i}function $ge(t,e){if(t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){let i=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...i]:i}return r&&r.length?r:void 0}async function GC(t,e,r,i){e&&!Array.isArray(e)&&!$C(e)&&(i=void 0,r=e,e=void 0),t=await t,r=r||{};let n=j1(t),s=$ge(e,i),a=await Rge(t,s,r);return a?(r=Ege(r,a,s,n),i=jge({url:n,_parse:GC,loaders:s},r,i||null),await rFe(a,t,r,i)):null}async function rFe(t,e,r,i){if(OY(t),r=EY(t.options,r),bd(e)){let o=e,{ok:s,redirected:a,status:u,statusText:p,type:m,url:x}=o,M=Object.fromEntries(o.headers.entries());i.response={headers:M,ok:s,redirected:a,status:u,statusText:p,type:m,url:x}}e=await Vge(e,t,r);let n=t;if(n.parseTextSync&&typeof e=="string")return n.parseTextSync(e,r,i);if(DY(t,r))return await LY(t,e,r,i,GC);if(n.parseText&&typeof e=="string")return await n.parseText(e,r,i);if(n.parse)return await n.parse(e,r,i);throw Bc(!n.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}function tX(t){let e=1/0,r=1/0,i=1/0,n=-1/0,o=-1/0,s=-1/0,a=t.POSITION?t.POSITION.value:[],u=a&&a.length;for(let p=0;p<u;p+=3){let m=a[p],x=a[p+1],M=a[p+2];e=m<e?m:e,r=x<r?x:r,i=M<i?M:i,n=m>n?m:n,o=x>o?x:o,s=M>s?M:s}return[[e,r,i],[n,o,s]]}async function e_(t,e,r,i){let n,o;!Array.isArray(e)&&!$C(e)?(n=[],o=e,i=void 0):(n=e,o=r);let s=XL(o),a=t;return typeof t=="string"&&(a=await s(t)),xd(t)&&(a=await s(t)),Array.isArray(n)?await GC(a,n,o):await GC(a,n,o)}var Wge="4.3.3";var iFe=globalThis.loaders?.parseImageNode,rX=typeof Image<"u",iX=typeof ImageBitmap<"u",nFe=!!iFe,nX=B1?!0:nFe;function Gge(t){switch(t){case"auto":return iX||rX||nX;case"imagebitmap":return iX;case"image":return rX;case"data":return nX;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function Hge(){if(iX)return"imagebitmap";if(rX)return"image";if(nX)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function oFe(t){let e=sFe(t);if(!e)throw new Error("Not an image");return e}function qge(t){switch(oFe(t)){case"data":return t;case"image":case"imagebitmap":let e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function sFe(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}var aFe=/^data:image\/svg\+xml/,lFe=/\.svg((\?|#).*)?$/;function ZL(t){return t&&(aFe.test(t)||lFe.test(t))}function Yge(t,e){if(ZL(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(o){throw new Error(o.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return oX(t,e)}function oX(t,e){if(ZL(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function KL(t,e,r){let i=Yge(t,r),n=self.URL||self.webkitURL,o=typeof i!="string"&&n.createObjectURL(i);try{return await cFe(o||i,e)}finally{o&&n.revokeObjectURL(o)}}async function cFe(t,e){let r=new Image;return r.src=t,e.image&&e.image.decode&&r.decode?(await r.decode(),r):await new Promise((i,n)=>{try{r.onload=()=>i(r),r.onerror=o=>{let s=o instanceof Error?o.message:"error";n(new Error(s))}}catch(o){n(o)}})}var uFe={},Xge=!0;async function Zge(t,e,r){let i;ZL(r)?i=await KL(t,e,r):i=oX(t,r);let n=e&&e.imagebitmap;return await hFe(i,n)}async function hFe(t,e=null){if((dFe(e)||!Xge)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),Xge=!1}return await createImageBitmap(t)}function dFe(t){for(let e in t||uFe)return!1;return!0}function Kge(t){return!gFe(t,"ftyp",4)||(t[8]&96)===0?null:fFe(t)}function fFe(t){switch(pFe(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function pFe(t,e,r){return String.fromCharCode(...t.slice(e,r))}function mFe(t){return[...t].map(e=>e.charCodeAt(0))}function gFe(t,e,r=0){let i=mFe(e);for(let n=0;n<i.length;++n)if(i[n]!==t[n+r])return!1;return!0}var h0=!1,HC=!0;function QL(t){let e=qC(t);return yFe(e)||bFe(e)||_Fe(e)||vFe(e)||AFe(e)}function AFe(t){let e=new Uint8Array(t instanceof DataView?t.buffer:t),r=Kge(e);return r?{mimeType:r.mimeType,width:0,height:0}:null}function yFe(t){let e=qC(t);return e.byteLength>=24&&e.getUint32(0,h0)===2303741511?{mimeType:"image/png",width:e.getUint32(16,h0),height:e.getUint32(20,h0)}:null}function _Fe(t){let e=qC(t);return e.byteLength>=10&&e.getUint32(0,h0)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,HC),height:e.getUint16(8,HC)}:null}function vFe(t){let e=qC(t);return e.byteLength>=14&&e.getUint16(0,h0)===16973&&e.getUint32(2,HC)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,HC),height:e.getUint32(22,HC)}:null}function bFe(t){let e=qC(t);if(!(e.byteLength>=3&&e.getUint16(0,h0)===65496&&e.getUint8(2)===255))return null;let{tableMarkers:i,sofMarkers:n}=xFe(),o=2;for(;o+9<e.byteLength;){let s=e.getUint16(o,h0);if(n.has(s))return{mimeType:"image/jpeg",height:e.getUint16(o+5,h0),width:e.getUint16(o+7,h0)};if(!i.has(s))return null;o+=2,o+=e.getUint16(o,h0)}return null}function xFe(){let t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function qC(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function Qge(t,e){let{mimeType:r}=QL(t)||{},i=globalThis.loaders?.parseImageNode;return Ky(i),await i(t,r)}async function Jge(t,e,r){e=e||{};let n=(e.image||{}).type||"auto",{url:o}=r||{},s=wFe(n),a;switch(s){case"imagebitmap":a=await Zge(t,e,o);break;case"image":a=await KL(t,e,o);break;case"data":a=await Qge(t,e);break;default:Ky(!1)}return n==="data"&&(a=qge(a)),a}function wFe(t){switch(t){case"auto":case"data":return Hge();default:return Gge(t),t}}var SFe=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],TFe=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],MFe={image:{type:"auto",decode:!0}},sX={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:Wge,mimeTypes:TFe,extensions:SFe,parse:Jge,tests:[t=>!!QL(new DataView(t))],options:MFe};BC();var EFe=new wu({id:"deck"}),mr=EFe;var aX={};function eAe(t){aX=t}function ks(t,e,r,i){mr.level>0&&aX[t]&&aX[t].call(null,e,r,i)}function CFe(t){let e=t[0],r=t[t.length-1];return e==="{"&&r==="}"||e==="["&&r==="]"}var tAe={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:CFe,parseTextSync:JSON.parse};function PFe(){let t="9.2.2",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(mr.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:mr,_registerLoggers:eAe},KY([tAe,[sX,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}var rAe=PFe();function JL(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}var lX={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function nAe(t){let e={};for(let[r,i]of Object.entries(t))e[r]=IFe(i);return e}function IFe(t){let e=iAe(t);if(e!=="object")return{value:t,...lX[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...lX[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=iAe(t.value),{...t,...lX[e],type:e}):{type:"object",value:null};throw new Error("props")}function iAe(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}var oAe=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,sAe=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`;var kFe={vertex:oAe,fragment:sAe},aAe=/void\s+main\s*\([^)]*\)\s*\{\n?/,lAe=/}\n?[^{}]*$/,cX=[],YC="__LUMA_INJECT_DECLARATIONS__";function cAe(t){let e={vertex:{},fragment:{}};for(let r in t){let i=t[r],n=RFe(r);typeof i=="string"&&(i={order:0,injection:i}),e[n][r]=i}return e}function RFe(t){let e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function XC(t,e,r,i=!1){let n=e==="vertex";for(let o in r){let s=r[o];s.sort((u,p)=>u.order-p.order),cX.length=s.length;for(let u=0,p=s.length;u<p;++u)cX[u]=s[u].injection;let a=`${cX.join(`
`)}
`;switch(o){case"vs:#decl":n&&(t=t.replace(YC,a));break;case"vs:#main-start":n&&(t=t.replace(aAe,u=>u+a));break;case"vs:#main-end":n&&(t=t.replace(lAe,u=>a+u));break;case"fs:#decl":n||(t=t.replace(YC,a));break;case"fs:#main-start":n||(t=t.replace(aAe,u=>u+a));break;case"fs:#main-end":n||(t=t.replace(lAe,u=>a+u));break;default:t=t.replace(o,u=>u+a)}}return t=t.replace(YC,""),i&&(t=t.replace(/\}\s*$/,o=>o+kFe[e])),t}function a3(t){t.map(e=>OFe(e))}function OFe(t){if(t.instance)return;a3(t.dependencies||[]);let{propTypes:e={},deprecations:r=[],inject:i={}}=t,n={normalizedInjections:cAe(i),parsedDeprecations:DFe(r)};e&&(n.propValidators=nAe(e)),t.instance=n;let o={};e&&(o=Object.entries(e).reduce((s,[a,u])=>{let p=u?.value;return p&&(s[a]=p),s},{})),t.defaultUniforms={...t.defaultUniforms,...o}}function uX(t,e,r){t.deprecations?.forEach(i=>{i.regex?.test(e)&&(i.deprecated?r.deprecated(i.old,i.new)():r.removed(i.old,i.new)())})}function DFe(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function l3(t){a3(t);let e={},r={};uAe({modules:t,level:0,moduleMap:e,moduleDepth:r});let i=Object.keys(r).sort((n,o)=>r[o]-r[n]).map(n=>e[n]);return a3(i),i}function uAe(t){let{modules:e,level:r,moduleMap:i,moduleDepth:n}=t;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(let o of e)i[o.name]=o,(n[o.name]===void 0||n[o.name]<r)&&(n[o.name]=r);for(let o of e)o.dependencies&&uAe({modules:o.dependencies,level:r+1,moduleMap:i,moduleDepth:n})}function hAe(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function fAe(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=dAe(t,LFe),t;case"fragment":return t=dAe(t,BFe),t;default:throw new Error(e)}}var pAe=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],LFe=[...pAe,[hX("attribute"),"in $1"],[hX("varying"),"out $1"]],BFe=[...pAe,[hX("varying"),"in $1"]];function dAe(t,e){for(let[r,i]of e)t=t.replace(r,i);return t}function hX(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function dX(t,e){let r="";for(let i in t){let n=t[i];if(r+=`void ${n.signature} {
`,n.header&&(r+=`  ${n.header}`),e[i]){let o=e[i];o.sort((s,a)=>s.order-a.order);for(let s of o)r+=`  ${s.injection}
`}n.footer&&(r+=`  ${n.footer}`),r+=`}
`}return r}function fX(t){let e={vertex:{},fragment:{}};for(let r of t){let i,n;typeof r!="string"?(i=r,n=i.hook):(i={},n=r),n=n.trim();let[o,s]=n.split(":"),a=n.replace(/\(.+/,""),u=Object.assign(i,{signature:s});switch(o){case"vs":e.vertex[a]=u;break;case"fs":e.fragment[a]=u;break;default:throw new Error(o)}}return e}function mAe(t,e){return{name:FFe(t,e),language:"glsl",version:NFe(t)}}function FFe(t,e="unnamed"){let i=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return i?i[1]:e}function NFe(t){let e=100,r=t.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){let i=parseInt(r[1],10);Number.isFinite(i)&&(e=i)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}var AAe=`

${YC}
`,zFe=`precision highp float;
`;function yAe(t){let e=l3(t.modules||[]);return{source:UFe(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:vAe(e)}}function _Ae(t){let{vs:e,fs:r}=t,i=l3(t.modules||[]);return{vs:gAe(t.platformInfo,{...t,source:e,stage:"vertex",modules:i}),fs:gAe(t.platformInfo,{...t,source:r,stage:"fragment",modules:i}),getUniforms:vAe(i)}}function UFe(t,e){let{source:r,stage:i,modules:n,hookFunctions:o=[],inject:s={},log:a}=e;JL(typeof r=="string","shader source must be a string");let u=r,p="",m=fX(o),x={},M={},k={};for(let j in s){let H=typeof s[j]=="string"?{injection:s[j],order:0}:s[j],W=/^(v|f)s:(#)?([\w-]+)$/.exec(j);if(W){let Z=W[2],Y=W[3];Z?Y==="decl"?M[j]=[H]:k[j]=[H]:x[j]=[H]}else k[j]=[H]}let F=n;for(let j of F){a&&uX(j,u,a);let H=bAe(j,"wgsl");p+=H;let W=j.injections?.[i]||{};for(let Z in W){let Y=/^(v|f)s:#([\w-]+)$/.exec(Z);if(Y){let ce=Y[2]==="decl"?M:k;ce[Z]=ce[Z]||[],ce[Z].push(W[Z])}else x[Z]=x[Z]||[],x[Z].push(W[Z])}}return p+=AAe,p=XC(p,i,M),p+=dX(m[i],x),p+=u,p=XC(p,i,k),p}function gAe(t,e){let{source:r,stage:i,language:n="glsl",modules:o,defines:s={},hookFunctions:a=[],inject:u={},prologue:p=!0,log:m}=e;JL(typeof r=="string","shader source must be a string");let x=n==="glsl"?mAe(r).version:-1,M=t.shaderLanguageVersion,k=x===100?"#version 100":"#version 300 es",j=r.split(`
`).slice(1).join(`
`),H={};o.forEach(ge=>{Object.assign(H,ge.defines)}),Object.assign(H,s);let W="";switch(n){case"wgsl":break;case"glsl":W=p?`${k}

// ----- PROLOGUE -------------------------
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${hAe(t)}
${i==="fragment"?zFe:""}

// ----- APPLICATION DEFINES -------------------------

${VFe(H)}

`:`${k}
`;break}let Z=fX(a),Y={},ee={},ce={};for(let ge in u){let Se=typeof u[ge]=="string"?{injection:u[ge],order:0}:u[ge],ne=/^(v|f)s:(#)?([\w-]+)$/.exec(ge);if(ne){let pe=ne[2],ue=ne[3];pe?ue==="decl"?ee[ge]=[Se]:ce[ge]=[Se]:Y[ge]=[Se]}else ce[ge]=[Se]}for(let ge of o){m&&uX(ge,j,m);let Se=bAe(ge,i);W+=Se;let ne=ge.instance?.normalizedInjections[i]||{};for(let pe in ne){let ue=/^(v|f)s:#([\w-]+)$/.exec(pe);if(ue){let We=ue[2]==="decl"?ee:ce;We[pe]=We[pe]||[],We[pe].push(ne[pe])}else Y[pe]=Y[pe]||[],Y[pe].push(ne[pe])}}return W+="// ----- MAIN SHADER SOURCE -------------------------",W+=AAe,W=XC(W,i,ee),W+=dX(Z[i],Y),W+=j,W=XC(W,i,ce),n==="glsl"&&x!==M&&(W=fAe(W,i)),W.trim()}function vAe(t){return function(r){let i={};for(let n of t){let o=n.getUniforms?.(r,i);Object.assign(i,o)}return i}}function VFe(t={}){let e="";for(let r in t){let i=t[r];(i||Number.isFinite(i))&&(e+=`#define ${r.toUpperCase()} ${t[r]}
`)}return e}function bAe(t,e){let r;switch(e){case"vertex":r=t.vs||"";break;case"fragment":r=t.fs||"";break;case"wgsl":r=t.source||"";break;default:JL(!1)}if(!t.name)throw new Error("Shader module must have a name");let i=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),n=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(n+=`#define MODULE_${i}
`),n+=`${r}
`,n}var jFe=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,$Fe=/^\s*\#\s*endif\s*$/;function xAe(t,e){let r=t.split(`
`),i=[],n=!0,o=null;for(let s of r){let a=s.match(jFe),u=s.match($Fe);a?(o=a[1],n=!!e?.defines?.[o]):u?n=!0:n&&i.push(s)}return i.join(`
`)}var $1=class t{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return t.defaultShaderAssembler=t.defaultShaderAssembler||new t,t.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(r=>r.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){let r=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==r)}addShaderHook(e,r){r&&(e=Object.assign(r,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){let r=this._getModuleList(e.modules),i=this._hookFunctions,{source:n,getUniforms:o}=yAe({...e,source:e.source,modules:r,hookFunctions:i});return{source:e.platformInfo.shaderLanguage==="wgsl"?xAe(n):n,getUniforms:o,modules:r}}assembleGLSLShaderPair(e){let r=this._getModuleList(e.modules),i=this._hookFunctions;return{..._Ae({...e,vs:e.vs,fs:e.fs,modules:r,hookFunctions:i}),modules:r}}_getModuleList(e=[]){let r=new Array(this._defaultModules.length+e.length),i={},n=0;for(let o=0,s=this._defaultModules.length;o<s;++o){let a=this._defaultModules[o],u=a.name;r[n++]=a,i[u]=!0}for(let o=0,s=e.length;o<s;++o){let a=e[o],u=a.name;i[u]||(r[n++]=a,i[u]=!0)}return r.length=n,a3(r),r}};var WFe=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,GFe=`#version 300 es
${WFe}`;function ZC(t){let{input:e,inputChannels:r,output:i}=t||{};if(!e)return GFe;if(!r)throw new Error("inputChannels");let n=HFe(r),o=wAe(e,r);return`#version 300 es
in ${n} ${e};
out vec4 ${i};
void main() {
  ${i} = ${o};
}`}function HFe(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function wAe(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}Vi();var Tu=class{constructor(e,r){this.name=e,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}},f7=class{constructor(e,r,i){this.name=e,this.type=r,this.attributes=i,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},f0=class extends Tu{constructor(e,r){super(e,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}},p0=class extends Tu{constructor(e,r){super(e,r),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}},f5=class extends Tu{constructor(e,r,i){super(e,i),this.format=r}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}},gg=class extends Tu{constructor(e,r,i,n){super(e,i),this.format=r,this.access=n}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}},r_;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(r_||(r_={}));var p3=class{constructor(e,r,i,n,o,s,a){this.name=e,this.type=r,this.group=i,this.binding=n,this.attributes=o,this.resourceType=s,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},zX=class{constructor(e,r){this.name=e,this.type=r}},UX=class{constructor(e,r,i,n){this.name=e,this.type=r,this.locationType=i,this.location=n,this.interpolation=null}},p7=class{constructor(e,r,i,n){this.name=e,this.type=r,this.locationType=i,this.location=n}},VX=class{constructor(e,r,i,n){this.name=e,this.type=r,this.attributes=i,this.id=n}},jX=class{constructor(e,r,i){this.name=e,this.type=r,this.attributes=i}},$X=class{constructor(e,r=null,i){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=r,this.attributes=i}},WX=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}};function PNe(t){var e=(32768&t)>>15,r=(31744&t)>>10,i=1023&t;return r==0?(e?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):r==31?i?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,r-15)*(1+i/Math.pow(2,10))}var uye=new Float32Array(1),INe=new Int32Array(uye.buffer),oc=new Uint16Array(1);function kNe(t){uye[0]=t;let e=INe[0],r=e>>31&1,i=e>>23&255,n=8388607&e;if(i===255)return oc[0]=r<<15|31744|(n!==0?512:0),oc[0];if(i===0){if(n===0)return oc[0]=r<<15,oc[0];n|=8388608;let o=113;for(;!(8388608&n);)n<<=1,o--;return i=127-o,n&=8388607,i>0?(n=(n>>126-i)+(n>>127-i&1),oc[0]=r<<15|i<<10|n>>13,oc[0]):(oc[0]=r<<15,oc[0])}return i=i-127+15,i>=31?(oc[0]=r<<15|31744,oc[0]):i<=0?i<-10?(oc[0]=r<<15,oc[0]):(n=(8388608|n)>>1-i,oc[0]=r<<15|n>>13,oc[0]):(n>>=13,oc[0]=r<<15|i<<10|n,oc[0])}var oZ=new Uint32Array(1),hye=new Float32Array(oZ.buffer,0,1);function lye(t){let e=112+(t>>6&31)<<23|(63&t)<<17;return oZ[0]=e,hye[0]}function RNe(t,e,r,i,n,o,s,a,u){let p=i*(s>>=n)*(o>>=n)+r*s+e*a;switch(u){case"r8unorm":return[zn(t,p,"8unorm",1)[0]];case"r8snorm":return[zn(t,p,"8snorm",1)[0]];case"r8uint":return[zn(t,p,"8uint",1)[0]];case"r8sint":return[zn(t,p,"8sint",1)[0]];case"rg8unorm":{let m=zn(t,p,"8unorm",2);return[m[0],m[1]]}case"rg8snorm":{let m=zn(t,p,"8snorm",2);return[m[0],m[1]]}case"rg8uint":{let m=zn(t,p,"8uint",2);return[m[0],m[1]]}case"rg8sint":{let m=zn(t,p,"8sint",2);return[m[0],m[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{let m=zn(t,p,"8unorm",4);return[m[0],m[1],m[2],m[3]]}case"rgba8snorm":{let m=zn(t,p,"8snorm",4);return[m[0],m[1],m[2],m[3]]}case"rgba8uint":{let m=zn(t,p,"8uint",4);return[m[0],m[1],m[2],m[3]]}case"rgba8sint":{let m=zn(t,p,"8sint",4);return[m[0],m[1],m[2],m[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{let m=zn(t,p,"8unorm",4);return[m[2],m[1],m[0],m[3]]}case"r16uint":return[zn(t,p,"16uint",1)[0]];case"r16sint":return[zn(t,p,"16sint",1)[0]];case"r16float":return[zn(t,p,"16float",1)[0]];case"rg16uint":{let m=zn(t,p,"16uint",2);return[m[0],m[1]]}case"rg16sint":{let m=zn(t,p,"16sint",2);return[m[0],m[1]]}case"rg16float":{let m=zn(t,p,"16float",2);return[m[0],m[1]]}case"rgba16uint":{let m=zn(t,p,"16uint",4);return[m[0],m[1],m[2],m[3]]}case"rgba16sint":{let m=zn(t,p,"16sint",4);return[m[0],m[1],m[2],m[3]]}case"rgba16float":{let m=zn(t,p,"16float",4);return[m[0],m[1],m[2],m[3]]}case"r32uint":return[zn(t,p,"32uint",1)[0]];case"r32sint":return[zn(t,p,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[zn(t,p,"32float",1)[0]];case"rg32uint":{let m=zn(t,p,"32uint",2);return[m[0],m[1]]}case"rg32sint":{let m=zn(t,p,"32sint",2);return[m[0],m[1]]}case"rg32float":{let m=zn(t,p,"32float",2);return[m[0],m[1]]}case"rgba32uint":{let m=zn(t,p,"32uint",4);return[m[0],m[1],m[2],m[3]]}case"rgba32sint":{let m=zn(t,p,"32sint",4);return[m[0],m[1],m[2],m[3]]}case"rgba32float":{let m=zn(t,p,"32float",4);return[m[0],m[1],m[2],m[3]]}case"rg11b10ufloat":{let m=new Uint32Array(t.buffer,p,1)[0],x=(4192256&m)>>11,M=(4290772992&m)>>22;return[lye(2047&m),lye(x),(function(k){let F=112+(k>>5&31)<<23|(31&k)<<18;return oZ[0]=F,hye[0]})(M),1]}}return null}function zn(t,e,r,i){let n=[0,0,0,0];for(let o=0;o<i;++o)switch(r){case"8unorm":n[o]=t[e]/255,e++;break;case"8snorm":n[o]=t[e]/255*2-1,e++;break;case"8uint":n[o]=t[e],e++;break;case"8sint":n[o]=t[e]-127,e++;break;case"16uint":n[o]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":n[o]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":n[o]=PNe(t[e]|t[e+1]<<8),e+=2;break;case"32uint":case"32sint":n[o]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":n[o]=new Float32Array(t.buffer,e,1)[0],e+=4}return n}function Hn(t,e,r,i,n){for(let o=0;o<i;++o)switch(r){case"8unorm":t[e]=255*n[o],e++;break;case"8snorm":t[e]=.5*(n[o]+1)*255,e++;break;case"8uint":t[e]=n[o],e++;break;case"8sint":t[e]=n[o]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=n[o],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=n[o],e+=2;break;case"16float":{let s=kNe(n[o]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=n[o],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=n[o],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=n[o],e+=4}return n}var FX={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}},Sd=class t{constructor(){this.id=t._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,r){if(e){r(b3.instance);for(let i of e)i instanceof Array?this.searchBlock(i,r):i.search(r);r(x3.instance)}}constEvaluate(e,r){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}};Sd._id=0;var b3=class extends Sd{};b3.instance=new b3;var x3=class extends Sd{};x3.instance=new x3;var dye=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]),Fo=class extends Sd{constructor(){super()}},J1=class extends Fo{constructor(e,r,i,n,o,s){super(),this.calls=new Set,this.name=e,this.args=r,this.returnType=i,this.body=n,this.startLine=o,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(let r of this.attributes)e(r);e(this);for(let r of this.args)e(r);this.searchBlock(this.body,e)}},GX=class extends Fo{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}},m7=class extends Fo{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}},p5=class extends Fo{constructor(e,r){super(),this.body=e,this.loopId=r}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}},g7=class extends Fo{constructor(e,r,i,n){super(),this.init=e,this.condition=r,this.increment=i,this.body=n}get astNodeType(){return"for"}search(e){var r,i,n;(r=this.init)===null||r===void 0||r.search(e),(i=this.condition)===null||i===void 0||i.search(e),(n=this.increment)===null||n===void 0||n.search(e),this.searchBlock(this.body,e)}},Nf=class extends Fo{constructor(e,r,i,n,o){super(),this.attributes=null,this.name=e,this.type=r,this.storage=i,this.access=n,this.value=o}get astNodeType(){return"var"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}},m5=class extends Fo{constructor(e,r,i){super(),this.attributes=null,this.name=e,this.type=r,this.value=i}get astNodeType(){return"override"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}},Z1=class extends Fo{constructor(e,r,i,n,o){super(),this.attributes=null,this.name=e,this.type=r,this.storage=i,this.access=n,this.value=o}get astNodeType(){return"let"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}},A3=class extends Fo{constructor(e,r,i,n,o){super(),this.attributes=null,this.name=e,this.type=r,this.storage=i,this.access=n,this.value=o}get astNodeType(){return"const"}constEvaluate(e,r){return this.value.constEvaluate(e,r)}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}},m3,d5,bt,dt;(t=>{t.increment="++",t.decrement="--"})(m3||(m3={})),(t=>{t.parse=function(e){let r=e;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}})(m3||(m3={}));var A7=class extends Fo{constructor(e,r){super(),this.operator=e,this.variable=r}get astNodeType(){return"increment"}search(e){this.variable.search(e)}};(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(d5||(d5={})),(t=>{t.parse=function(e){let r=e;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}})(d5||(d5={}));var y7=class extends Fo{constructor(e,r,i){super(),this.operator=e,this.variable=r,this.value=i}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}},g5=class extends Fo{constructor(e,r){super(),this.name=e,this.args=r}get astNodeType(){return"call"}isBuiltin(){return dye.has(this.name)}search(e){for(let r of this.args)r.search(e);e(this)}},_7=class extends Fo{constructor(e,r){super(),this.body=e,this.continuing=r}get astNodeType(){return"loop"}search(e){var r;this.searchBlock(this.body,e),(r=this.continuing)===null||r===void 0||r.search(e)}},v7=class extends Fo{constructor(e,r){super(),this.condition=e,this.cases=r}get astNodeType(){return"switch"}search(e){e(this);for(let r of this.cases)r.search(e)}},b7=class extends Fo{constructor(e,r,i,n){super(),this.condition=e,this.body=r,this.elseif=i,this.else=n}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}},x7=class extends Fo{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}},HX=class extends Fo{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}},qX=class extends Fo{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}},w7=class extends Fo{constructor(e,r){super(),this.severity=e,this.rule=r}get astNodeType(){return"diagnostic"}},A5=class extends Fo{constructor(e,r){super(),this.name=e,this.type=r}get astNodeType(){return"alias"}},YX=class extends Fo{constructor(){super()}get astNodeType(){return"discard"}},S7=class extends Fo{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}},T7=class extends Fo{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}},jt=class t extends Fo{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let r=e[0];if(r.name==="f32")return r;for(let i=1;i<e.length;++i){let n=t._priority.get(r.name);t._priority.get(e[i].name)<n&&(r=e[i])}return r.name==="x32"?t.i32:r}getTypeName(){return this.name}};jt.x32=new jt("x32"),jt.f32=new jt("f32"),jt.i32=new jt("i32"),jt.u32=new jt("u32"),jt.f16=new jt("f16"),jt.bool=new jt("bool"),jt.void=new jt("void"),jt._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);var M7=class extends jt{constructor(e){super(e)}},Ff=class extends jt{constructor(e,r,i,n){super(e),this.members=r,this.startLine=i,this.endLine=n}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let r=0;r<this.members.length;r++)if(this.members[r].name==e)return r;return-1}search(e){for(let r of this.members)e(r)}},pt=class extends jt{constructor(e,r,i){super(e),this.format=r,this.access=i}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}};pt.vec2f=new pt("vec2",jt.f32,null),pt.vec3f=new pt("vec3",jt.f32,null),pt.vec4f=new pt("vec4",jt.f32,null),pt.vec2i=new pt("vec2",jt.i32,null),pt.vec3i=new pt("vec3",jt.i32,null),pt.vec4i=new pt("vec4",jt.i32,null),pt.vec2u=new pt("vec2",jt.u32,null),pt.vec3u=new pt("vec3",jt.u32,null),pt.vec4u=new pt("vec4",jt.u32,null),pt.vec2h=new pt("vec2",jt.f16,null),pt.vec3h=new pt("vec3",jt.f16,null),pt.vec4h=new pt("vec4",jt.f16,null),pt.vec2b=new pt("vec2",jt.bool,null),pt.vec3b=new pt("vec3",jt.bool,null),pt.vec4b=new pt("vec4",jt.bool,null),pt.mat2x2f=new pt("mat2x2",jt.f32,null),pt.mat2x3f=new pt("mat2x3",jt.f32,null),pt.mat2x4f=new pt("mat2x4",jt.f32,null),pt.mat3x2f=new pt("mat3x2",jt.f32,null),pt.mat3x3f=new pt("mat3x3",jt.f32,null),pt.mat3x4f=new pt("mat3x4",jt.f32,null),pt.mat4x2f=new pt("mat4x2",jt.f32,null),pt.mat4x3f=new pt("mat4x3",jt.f32,null),pt.mat4x4f=new pt("mat4x4",jt.f32,null),pt.mat2x2h=new pt("mat2x2",jt.f16,null),pt.mat2x3h=new pt("mat2x3",jt.f16,null),pt.mat2x4h=new pt("mat2x4",jt.f16,null),pt.mat3x2h=new pt("mat3x2",jt.f16,null),pt.mat3x3h=new pt("mat3x3",jt.f16,null),pt.mat3x4h=new pt("mat3x4",jt.f16,null),pt.mat4x2h=new pt("mat4x2",jt.f16,null),pt.mat4x3h=new pt("mat4x3",jt.f16,null),pt.mat4x4h=new pt("mat4x4",jt.f16,null),pt.mat2x2i=new pt("mat2x2",jt.i32,null),pt.mat2x3i=new pt("mat2x3",jt.i32,null),pt.mat2x4i=new pt("mat2x4",jt.i32,null),pt.mat3x2i=new pt("mat3x2",jt.i32,null),pt.mat3x3i=new pt("mat3x3",jt.i32,null),pt.mat3x4i=new pt("mat3x4",jt.i32,null),pt.mat4x2i=new pt("mat4x2",jt.i32,null),pt.mat4x3i=new pt("mat4x3",jt.i32,null),pt.mat4x4i=new pt("mat4x4",jt.i32,null),pt.mat2x2u=new pt("mat2x2",jt.u32,null),pt.mat2x3u=new pt("mat2x3",jt.u32,null),pt.mat2x4u=new pt("mat2x4",jt.u32,null),pt.mat3x2u=new pt("mat3x2",jt.u32,null),pt.mat3x3u=new pt("mat3x3",jt.u32,null),pt.mat3x4u=new pt("mat3x4",jt.u32,null),pt.mat4x2u=new pt("mat4x2",jt.u32,null),pt.mat4x3u=new pt("mat4x3",jt.u32,null),pt.mat4x4u=new pt("mat4x4",jt.u32,null);var y3=class extends jt{constructor(e,r,i,n){super(e),this.storage=r,this.type=i,this.access=n}get astNodeType(){return"pointer"}},K1=class extends jt{constructor(e,r,i,n){super(e),this.attributes=r,this.format=i,this.count=n}get astNodeType(){return"array"}get isArray(){return!0}},X1=class extends jt{constructor(e,r,i){super(e),this.format=r,this.access=i}get astNodeType(){return"sampler"}},Sh=class extends Sd{constructor(){super(),this.postfix=null}},Ag=class extends Sh{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}},wd=class extends Sh{constructor(e,r){super(),this.type=e,this.args=r}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(let r of this.args)r.search(e)}constEvaluate(e,r){return r&&(r[0]=this.type),e.evalExpression(this,e.context)}},y5=class extends Sh{constructor(e,r){super(),this.cachedReturnValue=null,this.name=e,this.args=r}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return dye.has(this.name)}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){for(let r of this.args)r.search(e);e(this)}},zc=class extends Sh{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,r){return e.evalExpression(this,e.context)}},E7=class extends Sh{constructor(e,r){super(),this.name=e,this.initializer=r}get astNodeType(){return"constExpr"}constEvaluate(e,r){if(this.initializer){let i=e.evalExpression(this.initializer,e.context);return i!==null&&this.postfix?i.getSubData(e,this.postfix,e.context):i}return null}search(e){this.initializer.search(e)}},ta=class extends Sh{constructor(e,r){super(),this.value=e,this.type=r}get astNodeType(){return"literalExpr"}constEvaluate(e,r){return r!==void 0&&(r[0]=this.type),this.value}get isScalar(){return this.value instanceof ft}get isVector(){return this.value instanceof Fe||this.value instanceof pi}get scalarValue(){return this.value instanceof ft?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof Fe||this.value instanceof pi?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}},C7=class extends Sh{constructor(e,r){super(),this.type=e,this.value=r}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}};var n_=class extends Sh{constructor(e){super(),this.index=e}search(e){this.index.search(e)}},P7=class extends Sh{constructor(){super()}},Rs=class extends P7{constructor(e,r){super(),this.operator=e,this.right=r}get astNodeType(){return"unaryOp"}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}},wh=class extends P7{constructor(e,r,i){super(),this.operator=e,this.left=r,this.right=i}get astNodeType(){return"binaryOp"}_getPromotedType(e,r){return e.name===r.name?e:e.name==="f32"||r.name==="f32"?jt.f32:e.name==="u32"||r.name==="u32"?jt.u32:jt.i32}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}},I7=class extends Sd{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}},_3=class extends Sh{constructor(){super()}get astNodeType(){return"default"}},k7=class extends I7{constructor(e,r){super(r),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}},R7=class extends I7{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}},O7=class extends Sd{constructor(e,r,i){super(),this.name=e,this.type=r,this.attributes=i}get astNodeType(){return"argument"}},XX=class extends Sd{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}},D7=class extends Sd{constructor(e,r,i){super(),this.name=e,this.type=r,this.attributes=i}get astNodeType(){return"member"}},L7=class extends Sd{constructor(e,r){super(),this.name=e,this.value=r}get astNodeType(){return"attribute"}},Td=class t{constructor(e,r){this.parent=null,this.typeInfo=e,this.parent=r,this.id=t._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,r,i,n){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,r,i){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}};Td._id=0;var _5=class extends Td{constructor(){super(new Tu("void",null),null)}toString(){return"void"}};_5.void=new _5;var i_=class extends Td{constructor(e){super(new f5("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,r,i,n){this.reference.setDataValue(e,r,i,n)}getSubData(e,r,i){return r?this.reference.getSubData(e,r,i):this}toString(){return`&${this.reference.toString()}`}},ft=class t extends Td{constructor(e,r,i=null){super(r,i),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",r)}clone(){if(this.data instanceof Float32Array)return new t(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new t(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new t(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,r,i,n){if(i)return void console.error("SetDataValue: Scalar data does not support postfix",i);if(!(r instanceof t))return void console.error("SetDataValue: Invalid value",r);let o=r.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?o=Math.floor(o):this.typeInfo.name==="bool"&&(o=o?1:0),this.data[0]=o}getSubData(e,r,i){return r?(console.error("getSubData: Scalar data does not support postfix",r),null):this}toString(){return`${this.value}`}};function ONe(t,e,r){let i=e.length;return i===2?r==="f32"?new Fe(new Float32Array(e),t.getTypeInfo("vec2f")):r==="i32"||r==="bool"?new Fe(new Int32Array(e),t.getTypeInfo("vec2i")):r==="u32"?new Fe(new Uint32Array(e),t.getTypeInfo("vec2u")):r==="f16"?new Fe(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${r}`),null):i===3?r==="f32"?new Fe(new Float32Array(e),t.getTypeInfo("vec3f")):r==="i32"||r==="bool"?new Fe(new Int32Array(e),t.getTypeInfo("vec3i")):r==="u32"?new Fe(new Uint32Array(e),t.getTypeInfo("vec3u")):r==="f16"?new Fe(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${r}`),null):i===4?r==="f32"?new Fe(new Float32Array(e),t.getTypeInfo("vec4f")):r==="i32"||r==="bool"?new Fe(new Int32Array(e),t.getTypeInfo("vec4i")):r==="u32"?new Fe(new Uint32Array(e),t.getTypeInfo("vec4u")):r==="f16"?new Fe(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${r}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}var Fe=class t extends Td{constructor(e,r,i=null){if(super(r,i),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{let n=this.typeInfo.name;n==="vec2f"||n==="vec3f"||n==="vec4f"?this.data=new Float32Array(e):n==="vec2i"||n==="vec3i"||n==="vec4i"?this.data=new Int32Array(e):n==="vec2u"||n==="vec3u"||n==="vec4u"?this.data=new Uint32Array(e):n==="vec2h"||n==="vec3h"||n==="vec4h"?this.data=new Float32Array(e):n==="vec2b"||n==="vec3b"||n==="vec4b"?this.data=new Int32Array(e):n==="vec2"||n==="vec3"||n==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${n}`)}}clone(){if(this.data instanceof Float32Array)return new t(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new t(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new t(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,r,i,n){i instanceof Ag?console.error("TODO: Set vector postfix"):r instanceof t?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,i){if(r===null)return this;let n=e.getTypeInfo("f32");if(this.typeInfo instanceof gg)n=this.typeInfo.format||n;else{let s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?n=e.getTypeInfo("f32"):s==="vec2i"||s==="vec3i"||s==="vec4i"?n=e.getTypeInfo("i32"):s==="vec2b"||s==="vec3b"||s==="vec4b"?n=e.getTypeInfo("bool"):s==="vec2u"||s==="vec3u"||s==="vec4u"?n=e.getTypeInfo("u32"):s==="vec2h"||s==="vec3h"||s==="vec4h"?n=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${s}`)}let o=this;for(;r!==null&&o!==null;){if(r instanceof n_){let s=r.index,a=-1;if(s instanceof ta){if(!(s.value instanceof ft))return console.error(`GetSubData: Invalid array index ${s.value}`),null;a=s.value.value}else{let u=e.evalExpression(s,i);if(!(u instanceof ft))return console.error("GetSubData: Unknown index type",s),null;a=u.value}if(a<0||a>=o.data.length)return console.error("GetSubData: Index out of range",a),null;if(o.data instanceof Float32Array){let u=new Float32Array(o.data.buffer,o.data.byteOffset+4*a,1);return new ft(u,n)}if(o.data instanceof Int32Array){let u=new Int32Array(o.data.buffer,o.data.byteOffset+4*a,1);return new ft(u,n)}if(o.data instanceof Uint32Array){let u=new Uint32Array(o.data.buffer,o.data.byteOffset+4*a,1);return new ft(u,n)}throw"GetSubData: Invalid data type"}if(!(r instanceof Ag))return console.error("GetSubData: Unknown postfix",r),null;{let s=r.value.toLowerCase();if(s.length===1){let u=0;if(s==="x"||s==="r")u=0;else if(s==="y"||s==="g")u=1;else if(s==="z"||s==="b")u=2;else{if(s!=="w"&&s!=="a")return console.error(`GetSubData: Unknown member ${s}`),null;u=3}if(this.data instanceof Float32Array){let p=new Float32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new ft(p,n,this)}if(this.data instanceof Int32Array){let p=new Int32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new ft(p,n,this)}if(this.data instanceof Uint32Array){let p=new Uint32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new ft(p,n,this)}}let a=[];for(let u of s)u==="x"||u==="r"?a.push(this.data[0]):u==="y"||u==="g"?a.push(this.data[1]):u==="z"||u==="b"?a.push(this.data[2]):u==="w"||u==="a"?a.push(this.data[3]):console.error(`GetDataValue: Unknown member ${u}`);o=ONe(e,a,n.name)}r=r.postfix}return o}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}},pi=class t extends Td{constructor(e,r,i=null){super(r,i),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new t(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,r,i,n){i instanceof Ag?console.error("TODO: Set matrix postfix"):r instanceof t?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,i){if(r===null)return this;let n=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof gg)this.typeInfo.format;else if(n.endsWith("f"))e.getTypeInfo("f32");else if(n.endsWith("i"))e.getTypeInfo("i32");else if(n.endsWith("u"))e.getTypeInfo("u32");else{if(!n.endsWith("h"))return console.error(`GetDataValue: Unknown type ${n}`),null;e.getTypeInfo("f16")}if(r instanceof n_){let o=r.index,s=-1;if(o instanceof ta){if(!(o.value instanceof ft))return console.error(`GetDataValue: Invalid array index ${o.value}`),null;s=o.value.value}else{let p=e.evalExpression(o,i);if(!(p instanceof ft))return console.error("GetDataValue: Unknown index type",o),null;s=p.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;let a=n.endsWith("h")?"h":"f",u;if(n==="mat2x2"||n==="mat2x2f"||n==="mat2x2h"||n==="mat3x2"||n==="mat3x2f"||n==="mat3x2h"||n==="mat4x2"||n==="mat4x2f"||n==="mat4x2h")u=new Fe(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${a}`));else if(n==="mat2x3"||n==="mat2x3f"||n==="mat2x3h"||n==="mat3x3"||n==="mat3x3f"||n==="mat3x3h"||n==="mat4x3"||n==="mat4x3f"||n==="mat4x3h")u=new Fe(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${a}`));else{if(n!=="mat2x4"&&n!=="mat2x4f"&&n!=="mat2x4h"&&n!=="mat3x4"&&n!=="mat3x4f"&&n!=="mat3x4h"&&n!=="mat4x4"&&n!=="mat4x4f"&&n!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${n}`),null;u=new Fe(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${a}`))}return r.postfix?u.getSubData(e,r.postfix,i):u}return console.error("GetDataValue: Invalid postfix",r),null}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}},wa=class t extends Td{constructor(e,r,i=0,n=null){super(r,n),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=i}clone(){let e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new t(e.buffer,this.typeInfo,0,null)}setDataValue(e,r,i,n){if(r===null)return void console.log("setDataValue: NULL data.");let o=this.offset,s=this.typeInfo;for(;i;){if(i instanceof n_)if(s instanceof p0){let a=i.index;if(a instanceof ta){if(!(a.value instanceof ft))return void console.error(`SetDataValue: Invalid index type ${a.value}`);o+=a.value.value*s.stride}else{let u=e.evalExpression(a,n);if(!(u instanceof ft))return void console.error("SetDataValue: Unknown index type",a);o+=u.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(i instanceof Ag))return void console.error("SetDataValue: Unknown postfix type",i);{let a=i.value;if(s instanceof f0){let u=!1;for(let p of s.members)if(p.name===a){o+=p.offset,s=p.type,u=!0;break}if(!u)return void console.error(`SetDataValue: Member ${a} not found`)}else if(s instanceof Tu){let u=s.getTypeName(),p=0;if(a==="x"||a==="r")p=0;else if(a==="y"||a==="g")p=1;else if(a==="z"||a==="b")p=2;else{if(a!=="w"&&a!=="a")return void console.error(`SetDataValue: Unknown member ${a}`);p=3}if(!(r instanceof ft))return void console.error("SetDataValue: Invalid value",r);let m=r.value;return u==="vec2f"?void(new Float32Array(this.buffer,o,2)[p]=m):u==="vec3f"?void(new Float32Array(this.buffer,o,3)[p]=m):u==="vec4f"?void(new Float32Array(this.buffer,o,4)[p]=m):u==="vec2i"?void(new Int32Array(this.buffer,o,2)[p]=m):u==="vec3i"?void(new Int32Array(this.buffer,o,3)[p]=m):u==="vec4i"?void(new Int32Array(this.buffer,o,4)[p]=m):u==="vec2u"?void(new Uint32Array(this.buffer,o,2)[p]=m):u==="vec3u"?void(new Uint32Array(this.buffer,o,3)[p]=m):u==="vec4u"?void(new Uint32Array(this.buffer,o,4)[p]=m):void console.error(`SetDataValue: Type ${u} is not a struct`)}}}i=i.postfix}this.setData(e,r,s,o,n)}setData(e,r,i,n,o){let s=i.getTypeName();if(s!=="f32"&&s!=="f16")if(s!=="i32"&&s!=="atomic<i32>"&&s!=="x32")if(s!=="u32"&&s!=="atomic<u32>")if(s!=="bool"){if(s==="vec2f"||s==="vec2h"){let a=new Float32Array(this.buffer,n,2);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1]):(a[0]=r[0],a[1]=r[1]))}if(s==="vec3f"||s==="vec3h"){let a=new Float32Array(this.buffer,n,3);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2]):(a[0]=r[0],a[1]=r[1],a[2]=r[2]))}if(s==="vec4f"||s==="vec4h"){let a=new Float32Array(this.buffer,n,4);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3]))}if(s==="vec2i"){let a=new Int32Array(this.buffer,n,2);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1]):(a[0]=r[0],a[1]=r[1]))}if(s==="vec3i"){let a=new Int32Array(this.buffer,n,3);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2]):(a[0]=r[0],a[1]=r[1],a[2]=r[2]))}if(s==="vec4i"){let a=new Int32Array(this.buffer,n,4);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3]))}if(s==="vec2u"){let a=new Uint32Array(this.buffer,n,2);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1]):(a[0]=r[0],a[1]=r[1]))}if(s==="vec3u"){let a=new Uint32Array(this.buffer,n,3);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2]):(a[0]=r[0],a[1]=r[1],a[2]=r[2]))}if(s==="vec4u"){let a=new Uint32Array(this.buffer,n,4);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3]))}if(s==="vec2b"){let a=new Uint32Array(this.buffer,n,2);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1]):(a[0]=r[0],a[1]=r[1]))}if(s==="vec3b"){let a=new Uint32Array(this.buffer,n,3);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2]):(a[0]=r[0],a[1]=r[1],a[2]=r[2]))}if(s==="vec4b"){let a=new Uint32Array(this.buffer,n,4);return void(r instanceof Fe?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3]))}if(s==="mat2x2f"||s==="mat2x2h"){let a=new Float32Array(this.buffer,n,4);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3]))}if(s==="mat2x3f"||s==="mat2x3h"){let a=new Float32Array(this.buffer,n,6);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5]))}if(s==="mat2x4f"||s==="mat2x4h"){let a=new Float32Array(this.buffer,n,8);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5],a[6]=r.data[6],a[7]=r.data[7]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7]))}if(s==="mat3x2f"||s==="mat3x2h"){let a=new Float32Array(this.buffer,n,6);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5]))}if(s==="mat3x3f"||s==="mat3x3h"){let a=new Float32Array(this.buffer,n,9);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5],a[6]=r.data[6],a[7]=r.data[7],a[8]=r.data[8]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8]))}if(s==="mat3x4f"||s==="mat3x4h"){let a=new Float32Array(this.buffer,n,12);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5],a[6]=r.data[6],a[7]=r.data[7],a[8]=r.data[8],a[9]=r.data[9],a[10]=r.data[10],a[11]=r.data[11]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11]))}if(s==="mat4x2f"||s==="mat4x2h"){let a=new Float32Array(this.buffer,n,8);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5],a[6]=r.data[6],a[7]=r.data[7]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7]))}if(s==="mat4x3f"||s==="mat4x3h"){let a=new Float32Array(this.buffer,n,12);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5],a[6]=r.data[6],a[7]=r.data[7],a[8]=r.data[8],a[9]=r.data[9],a[10]=r.data[10],a[11]=r.data[11]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11]))}if(s==="mat4x4f"||s==="mat4x4h"){let a=new Float32Array(this.buffer,n,16);return void(r instanceof pi?(a[0]=r.data[0],a[1]=r.data[1],a[2]=r.data[2],a[3]=r.data[3],a[4]=r.data[4],a[5]=r.data[5],a[6]=r.data[6],a[7]=r.data[7],a[8]=r.data[8],a[9]=r.data[9],a[10]=r.data[10],a[11]=r.data[11],a[12]=r.data[12],a[13]=r.data[13],a[14]=r.data[14],a[15]=r.data[15]):(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]))}if(r instanceof t){if(i===r.typeInfo)return void new Uint8Array(this.buffer,n,r.buffer.byteLength).set(new Uint8Array(r.buffer));console.error("SetDataValue: Type mismatch",s,r.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else r instanceof ft&&(new Int32Array(this.buffer,n,1)[0]=r.value);else r instanceof ft&&(new Uint32Array(this.buffer,n,1)[0]=r.value);else r instanceof ft&&(new Int32Array(this.buffer,n,1)[0]=r.value);else r instanceof ft&&(new Float32Array(this.buffer,n,1)[0]=r.value)}getSubData(e,r,i){var n,o,s;if(r===null)return this;let a=this.offset,u=this.typeInfo;for(;r;){if(r instanceof n_){let m=r.index,x=m instanceof Sh?e.evalExpression(m,i):m,M=0;if(x instanceof ft?M=x.value:typeof x=="number"?M=x:console.error("GetDataValue: Invalid index type",m),u instanceof p0)a+=M*u.stride,u=u.format;else{let k=u.getTypeName();k==="mat4x4"||k==="mat4x4f"||k==="mat4x4h"?(a+=16*M,u=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${u.getTypeName()} is not an array`)}}else{if(!(r instanceof Ag))return console.error("GetDataValue: Unknown postfix type",r),null;{let m=r.value;if(u instanceof f0){let x=!1;for(let M of u.members)if(M.name===m){a+=M.offset,u=M.type,x=!0;break}if(!x)return console.error(`GetDataValue: Member ${m} not found`),null}else if(u instanceof Tu){let x=u.getTypeName();if(x==="vec2f"||x==="vec3f"||x==="vec4f"||x==="vec2i"||x==="vec3i"||x==="vec4i"||x==="vec2u"||x==="vec3u"||x==="vec4u"||x==="vec2b"||x==="vec3b"||x==="vec4b"||x==="vec2h"||x==="vec3h"||x==="vec4h"||x==="vec2"||x==="vec3"||x==="vec4"){if(m.length>0&&m.length<5){let M="f",k=[];for(let F=0;F<m.length;++F){let j=m[F].toLowerCase(),H=0;if(j==="x"||j==="r")H=0;else if(j==="y"||j==="g")H=1;else if(j==="z"||j==="b")H=2;else{if(j!=="w"&&j!=="a")return console.error(`Unknown member ${m}`),null;H=3}if(m.length===1){if(x.endsWith("f"))return this.buffer.byteLength<a+4*H+4?(console.log("Insufficient buffer data"),null):new ft(new Float32Array(this.buffer,a+4*H,1),e.getTypeInfo("f32"),this);if(x.endsWith("h"))return new ft(new Float32Array(this.buffer,a+4*H,1),e.getTypeInfo("f16"),this);if(x.endsWith("i"))return new ft(new Int32Array(this.buffer,a+4*H,1),e.getTypeInfo("i32"),this);if(x.endsWith("b"))return new ft(new Int32Array(this.buffer,a+4*H,1),e.getTypeInfo("bool"),this);if(x.endsWith("u"))return new ft(new Uint32Array(this.buffer,a+4*H,1),e.getTypeInfo("i32"),this)}if(x==="vec2f")k.push(new Float32Array(this.buffer,a,2)[H]);else if(x==="vec3f"){if(a+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;let W=new Float32Array(this.buffer,a,3);k.push(W[H])}else if(x==="vec4f")k.push(new Float32Array(this.buffer,a,4)[H]);else if(x==="vec2i")M="i",k.push(new Int32Array(this.buffer,a,2)[H]);else if(x==="vec3i")M="i",k.push(new Int32Array(this.buffer,a,3)[H]);else if(x==="vec4i")M="i",k.push(new Int32Array(this.buffer,a,4)[H]);else if(x==="vec2u"){M="u";let W=new Uint32Array(this.buffer,a,2);k.push(W[H])}else x==="vec3u"?(M="u",k.push(new Uint32Array(this.buffer,a,3)[H])):x==="vec4u"&&(M="u",k.push(new Uint32Array(this.buffer,a,4)[H]))}return k.length===2?u=e.getTypeInfo(`vec2${M}`):k.length===3?u=e.getTypeInfo(`vec3${M}`):k.length===4?u=e.getTypeInfo(`vec4${M}`):console.error(`GetDataValue: Invalid vector length ${k.length}`),new Fe(k,u,null)}return console.error(`GetDataValue: Unknown member ${m}`),null}return console.error(`GetDataValue: Type ${x} is not a struct`),null}}}r=r.postfix}let p=u.getTypeName();return p==="f32"?new ft(new Float32Array(this.buffer,a,1),u,this):p==="i32"?new ft(new Int32Array(this.buffer,a,1),u,this):p==="u32"?new ft(new Uint32Array(this.buffer,a,1),u,this):p==="vec2f"?new Fe(new Float32Array(this.buffer,a,2),u,this):p==="vec3f"?new Fe(new Float32Array(this.buffer,a,3),u,this):p==="vec4f"?new Fe(new Float32Array(this.buffer,a,4),u,this):p==="vec2i"?new Fe(new Int32Array(this.buffer,a,2),u,this):p==="vec3i"?new Fe(new Int32Array(this.buffer,a,3),u,this):p==="vec4i"?new Fe(new Int32Array(this.buffer,a,4),u,this):p==="vec2u"?new Fe(new Uint32Array(this.buffer,a,2),u,this):p==="vec3u"?new Fe(new Uint32Array(this.buffer,a,3),u,this):p==="vec4u"?new Fe(new Uint32Array(this.buffer,a,4),u,this):u instanceof gg&&u.name==="atomic"?((n=u.format)===null||n===void 0?void 0:n.name)==="u32"?new ft(new Uint32Array(this.buffer,a,1)[0],u.format,this):((o=u.format)===null||o===void 0?void 0:o.name)==="i32"?new ft(new Int32Array(this.buffer,a,1)[0],u.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=u.format)===null||s===void 0?void 0:s.name}`),null):new t(this.buffer,u,a,this)}toString(){let e="";if(this.typeInfo instanceof p0)if(this.typeInfo.format.name==="f32"){let r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let i=1;i<r.length;++i)e+=`, ${r[i]}`}else if(this.typeInfo.format.name==="i32"){let r=new Int32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let i=1;i<r.length;++i)e+=`, ${r[i]}`}else if(this.typeInfo.format.name==="u32"){let r=new Uint32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let i=1;i<r.length;++i)e+=`, ${r[i]}`}else if(this.typeInfo.format.name==="vec2f"){let r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}]`;for(let i=1;i<r.length/2;++i)e+=`, [${r[2*i]}, ${r[2*i+1]}]`}else if(this.typeInfo.format.name==="vec3f"){let r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}]`;for(let i=4;i<r.length;i+=4)e+=`, [${r[i]}, ${r[i+1]}, ${r[i+2]}]`}else if(this.typeInfo.format.name==="vec4f"){let r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}, ${r[3]}]`;for(let i=4;i<r.length;i+=4)e+=`, [${r[i]}, ${r[i+1]}, ${r[i+2]}, ${r[i+3]}]`}else e="[...]";else this.typeInfo instanceof f0?e+="{...}":e="[...]";return e}},mg=class t extends Td{constructor(e,r,i,n){super(r,null),this.data=e,this.descriptor=i,this.view=n}clone(){return new t(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,r;let i=this.descriptor.size;return i instanceof Array&&i.length>0?(e=i[0])!==null&&e!==void 0?e:0:i instanceof Object&&(r=i.width)!==null&&r!==void 0?r:0}get height(){var e,r;let i=this.descriptor.size;return i instanceof Array&&i.length>1?(e=i[1])!==null&&e!==void 0?e:0:i instanceof Object&&(r=i.height)!==null&&r!==void 0?r:0}get depthOrArrayLayers(){var e,r;let i=this.descriptor.size;return i instanceof Array&&i.length>2?(e=i[2])!==null&&e!==void 0?e:0:i instanceof Object&&(r=i.depthOrArrayLayers)!==null&&r!==void 0?r:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];let r=[this.width,this.height,this.depthOrArrayLayers];for(let i=0;i<r.length;++i)r[i]=Math.max(1,r[i]>>e);return r}get texelByteSize(){let e=this.format,r=FX[e];return r?r.isDepthStencil?4:r.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){let e=this.format,r=FX[e];return!!r&&r.isDepthStencil}getGpuSize(){let e=this.format,r=FX[e],i=this.width;if(!e||i<=0||!r)return-1;let n=this.height,o=this.depthOrArrayLayers,s=this.dimension;return i/r.blockWidth*(s==="1d"?1:n/r.blockHeight)*r.bytesPerBlock*o}getPixel(e,r,i=0,n=0){let o=this.texelByteSize,s=this.bytesPerRow,a=this.height,u=this.data[n];return RNe(new Uint8Array(u),e,r,i,n,a,s,o,this.format)}setPixel(e,r,i,n,o){let s=this.texelByteSize,a=this.bytesPerRow,u=this.height,p=this.data[n];(function(m,x,M,k,F,j,H,W,Z,Y){let ee=k*(H>>=F)*(j>>=F)+M*H+x*W;switch(Z){case"r8unorm":return void Hn(m,ee,"8unorm",1,Y);case"r8snorm":return void Hn(m,ee,"8snorm",1,Y);case"r8uint":return void Hn(m,ee,"8uint",1,Y);case"r8sint":return void Hn(m,ee,"8sint",1,Y);case"rg8unorm":return void Hn(m,ee,"8unorm",2,Y);case"rg8snorm":return void Hn(m,ee,"8snorm",2,Y);case"rg8uint":return void Hn(m,ee,"8uint",2,Y);case"rg8sint":return void Hn(m,ee,"8sint",2,Y);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void Hn(m,ee,"8unorm",4,Y);case"rgba8snorm":return void Hn(m,ee,"8snorm",4,Y);case"rgba8uint":return void Hn(m,ee,"8uint",4,Y);case"rgba8sint":return void Hn(m,ee,"8sint",4,Y);case"r16uint":return void Hn(m,ee,"16uint",1,Y);case"r16sint":return void Hn(m,ee,"16sint",1,Y);case"r16float":return void Hn(m,ee,"16float",1,Y);case"rg16uint":return void Hn(m,ee,"16uint",2,Y);case"rg16sint":return void Hn(m,ee,"16sint",2,Y);case"rg16float":return void Hn(m,ee,"16float",2,Y);case"rgba16uint":return void Hn(m,ee,"16uint",4,Y);case"rgba16sint":return void Hn(m,ee,"16sint",4,Y);case"rgba16float":return void Hn(m,ee,"16float",4,Y);case"r32uint":return void Hn(m,ee,"32uint",1,Y);case"r32sint":return void Hn(m,ee,"32sint",1,Y);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void Hn(m,ee,"32float",1,Y);case"rg32uint":return void Hn(m,ee,"32uint",2,Y);case"rg32sint":return void Hn(m,ee,"32sint",2,Y);case"rg32float":return void Hn(m,ee,"32float",2,Y);case"rgba32uint":return void Hn(m,ee,"32uint",4,Y);case"rgba32sint":return void Hn(m,ee,"32sint",4,Y);case"rgba32float":return void Hn(m,ee,"32float",4,Y);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(p),e,r,i,n,u,a,s,this.format,o)}};(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(dt||(dt={}));var ht=class{constructor(e,r,i){this.name=e,this.type=r,this.rule=i}toString(){return this.name}},Pe=class{};bt=Pe,Pe.none=new ht("",dt.reserved,""),Pe.eof=new ht("EOF",dt.token,""),Pe.reserved={asm:new ht("asm",dt.reserved,"asm"),bf16:new ht("bf16",dt.reserved,"bf16"),do:new ht("do",dt.reserved,"do"),enum:new ht("enum",dt.reserved,"enum"),f16:new ht("f16",dt.reserved,"f16"),f64:new ht("f64",dt.reserved,"f64"),handle:new ht("handle",dt.reserved,"handle"),i8:new ht("i8",dt.reserved,"i8"),i16:new ht("i16",dt.reserved,"i16"),i64:new ht("i64",dt.reserved,"i64"),mat:new ht("mat",dt.reserved,"mat"),premerge:new ht("premerge",dt.reserved,"premerge"),regardless:new ht("regardless",dt.reserved,"regardless"),typedef:new ht("typedef",dt.reserved,"typedef"),u8:new ht("u8",dt.reserved,"u8"),u16:new ht("u16",dt.reserved,"u16"),u64:new ht("u64",dt.reserved,"u64"),unless:new ht("unless",dt.reserved,"unless"),using:new ht("using",dt.reserved,"using"),vec:new ht("vec",dt.reserved,"vec"),void:new ht("void",dt.reserved,"void")},Pe.keywords={array:new ht("array",dt.keyword,"array"),atomic:new ht("atomic",dt.keyword,"atomic"),bool:new ht("bool",dt.keyword,"bool"),f32:new ht("f32",dt.keyword,"f32"),i32:new ht("i32",dt.keyword,"i32"),mat2x2:new ht("mat2x2",dt.keyword,"mat2x2"),mat2x3:new ht("mat2x3",dt.keyword,"mat2x3"),mat2x4:new ht("mat2x4",dt.keyword,"mat2x4"),mat3x2:new ht("mat3x2",dt.keyword,"mat3x2"),mat3x3:new ht("mat3x3",dt.keyword,"mat3x3"),mat3x4:new ht("mat3x4",dt.keyword,"mat3x4"),mat4x2:new ht("mat4x2",dt.keyword,"mat4x2"),mat4x3:new ht("mat4x3",dt.keyword,"mat4x3"),mat4x4:new ht("mat4x4",dt.keyword,"mat4x4"),ptr:new ht("ptr",dt.keyword,"ptr"),sampler:new ht("sampler",dt.keyword,"sampler"),sampler_comparison:new ht("sampler_comparison",dt.keyword,"sampler_comparison"),struct:new ht("struct",dt.keyword,"struct"),texture_1d:new ht("texture_1d",dt.keyword,"texture_1d"),texture_2d:new ht("texture_2d",dt.keyword,"texture_2d"),texture_2d_array:new ht("texture_2d_array",dt.keyword,"texture_2d_array"),texture_3d:new ht("texture_3d",dt.keyword,"texture_3d"),texture_cube:new ht("texture_cube",dt.keyword,"texture_cube"),texture_cube_array:new ht("texture_cube_array",dt.keyword,"texture_cube_array"),texture_multisampled_2d:new ht("texture_multisampled_2d",dt.keyword,"texture_multisampled_2d"),texture_storage_1d:new ht("texture_storage_1d",dt.keyword,"texture_storage_1d"),texture_storage_2d:new ht("texture_storage_2d",dt.keyword,"texture_storage_2d"),texture_storage_2d_array:new ht("texture_storage_2d_array",dt.keyword,"texture_storage_2d_array"),texture_storage_3d:new ht("texture_storage_3d",dt.keyword,"texture_storage_3d"),texture_depth_2d:new ht("texture_depth_2d",dt.keyword,"texture_depth_2d"),texture_depth_2d_array:new ht("texture_depth_2d_array",dt.keyword,"texture_depth_2d_array"),texture_depth_cube:new ht("texture_depth_cube",dt.keyword,"texture_depth_cube"),texture_depth_cube_array:new ht("texture_depth_cube_array",dt.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new ht("texture_depth_multisampled_2d",dt.keyword,"texture_depth_multisampled_2d"),texture_external:new ht("texture_external",dt.keyword,"texture_external"),u32:new ht("u32",dt.keyword,"u32"),vec2:new ht("vec2",dt.keyword,"vec2"),vec3:new ht("vec3",dt.keyword,"vec3"),vec4:new ht("vec4",dt.keyword,"vec4"),bitcast:new ht("bitcast",dt.keyword,"bitcast"),block:new ht("block",dt.keyword,"block"),break:new ht("break",dt.keyword,"break"),case:new ht("case",dt.keyword,"case"),continue:new ht("continue",dt.keyword,"continue"),continuing:new ht("continuing",dt.keyword,"continuing"),default:new ht("default",dt.keyword,"default"),diagnostic:new ht("diagnostic",dt.keyword,"diagnostic"),discard:new ht("discard",dt.keyword,"discard"),else:new ht("else",dt.keyword,"else"),enable:new ht("enable",dt.keyword,"enable"),fallthrough:new ht("fallthrough",dt.keyword,"fallthrough"),false:new ht("false",dt.keyword,"false"),fn:new ht("fn",dt.keyword,"fn"),for:new ht("for",dt.keyword,"for"),function:new ht("function",dt.keyword,"function"),if:new ht("if",dt.keyword,"if"),let:new ht("let",dt.keyword,"let"),const:new ht("const",dt.keyword,"const"),loop:new ht("loop",dt.keyword,"loop"),while:new ht("while",dt.keyword,"while"),private:new ht("private",dt.keyword,"private"),read:new ht("read",dt.keyword,"read"),read_write:new ht("read_write",dt.keyword,"read_write"),return:new ht("return",dt.keyword,"return"),requires:new ht("requires",dt.keyword,"requires"),storage:new ht("storage",dt.keyword,"storage"),switch:new ht("switch",dt.keyword,"switch"),true:new ht("true",dt.keyword,"true"),alias:new ht("alias",dt.keyword,"alias"),type:new ht("type",dt.keyword,"type"),uniform:new ht("uniform",dt.keyword,"uniform"),var:new ht("var",dt.keyword,"var"),override:new ht("override",dt.keyword,"override"),workgroup:new ht("workgroup",dt.keyword,"workgroup"),write:new ht("write",dt.keyword,"write"),r8unorm:new ht("r8unorm",dt.keyword,"r8unorm"),r8snorm:new ht("r8snorm",dt.keyword,"r8snorm"),r8uint:new ht("r8uint",dt.keyword,"r8uint"),r8sint:new ht("r8sint",dt.keyword,"r8sint"),r16uint:new ht("r16uint",dt.keyword,"r16uint"),r16sint:new ht("r16sint",dt.keyword,"r16sint"),r16float:new ht("r16float",dt.keyword,"r16float"),rg8unorm:new ht("rg8unorm",dt.keyword,"rg8unorm"),rg8snorm:new ht("rg8snorm",dt.keyword,"rg8snorm"),rg8uint:new ht("rg8uint",dt.keyword,"rg8uint"),rg8sint:new ht("rg8sint",dt.keyword,"rg8sint"),r32uint:new ht("r32uint",dt.keyword,"r32uint"),r32sint:new ht("r32sint",dt.keyword,"r32sint"),r32float:new ht("r32float",dt.keyword,"r32float"),rg16uint:new ht("rg16uint",dt.keyword,"rg16uint"),rg16sint:new ht("rg16sint",dt.keyword,"rg16sint"),rg16float:new ht("rg16float",dt.keyword,"rg16float"),rgba8unorm:new ht("rgba8unorm",dt.keyword,"rgba8unorm"),rgba8unorm_srgb:new ht("rgba8unorm_srgb",dt.keyword,"rgba8unorm_srgb"),rgba8snorm:new ht("rgba8snorm",dt.keyword,"rgba8snorm"),rgba8uint:new ht("rgba8uint",dt.keyword,"rgba8uint"),rgba8sint:new ht("rgba8sint",dt.keyword,"rgba8sint"),bgra8unorm:new ht("bgra8unorm",dt.keyword,"bgra8unorm"),bgra8unorm_srgb:new ht("bgra8unorm_srgb",dt.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new ht("rgb10a2unorm",dt.keyword,"rgb10a2unorm"),rg11b10float:new ht("rg11b10float",dt.keyword,"rg11b10float"),rg32uint:new ht("rg32uint",dt.keyword,"rg32uint"),rg32sint:new ht("rg32sint",dt.keyword,"rg32sint"),rg32float:new ht("rg32float",dt.keyword,"rg32float"),rgba16uint:new ht("rgba16uint",dt.keyword,"rgba16uint"),rgba16sint:new ht("rgba16sint",dt.keyword,"rgba16sint"),rgba16float:new ht("rgba16float",dt.keyword,"rgba16float"),rgba32uint:new ht("rgba32uint",dt.keyword,"rgba32uint"),rgba32sint:new ht("rgba32sint",dt.keyword,"rgba32sint"),rgba32float:new ht("rgba32float",dt.keyword,"rgba32float"),static_assert:new ht("static_assert",dt.keyword,"static_assert")},Pe.tokens={decimal_float_literal:new ht("decimal_float_literal",dt.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new ht("hex_float_literal",dt.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new ht("int_literal",dt.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new ht("uint_literal",dt.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new ht("name",dt.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new ht("ident",dt.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new ht("and",dt.token,"&"),and_and:new ht("and_and",dt.token,"&&"),arrow:new ht("arrow ",dt.token,"->"),attr:new ht("attr",dt.token,"@"),forward_slash:new ht("forward_slash",dt.token,"/"),bang:new ht("bang",dt.token,"!"),bracket_left:new ht("bracket_left",dt.token,"["),bracket_right:new ht("bracket_right",dt.token,"]"),brace_left:new ht("brace_left",dt.token,"{"),brace_right:new ht("brace_right",dt.token,"}"),colon:new ht("colon",dt.token,":"),comma:new ht("comma",dt.token,","),equal:new ht("equal",dt.token,"="),equal_equal:new ht("equal_equal",dt.token,"=="),not_equal:new ht("not_equal",dt.token,"!="),greater_than:new ht("greater_than",dt.token,">"),greater_than_equal:new ht("greater_than_equal",dt.token,">="),shift_right:new ht("shift_right",dt.token,">>"),less_than:new ht("less_than",dt.token,"<"),less_than_equal:new ht("less_than_equal",dt.token,"<="),shift_left:new ht("shift_left",dt.token,"<<"),modulo:new ht("modulo",dt.token,"%"),minus:new ht("minus",dt.token,"-"),minus_minus:new ht("minus_minus",dt.token,"--"),period:new ht("period",dt.token,"."),plus:new ht("plus",dt.token,"+"),plus_plus:new ht("plus_plus",dt.token,"++"),or:new ht("or",dt.token,"|"),or_or:new ht("or_or",dt.token,"||"),paren_left:new ht("paren_left",dt.token,"("),paren_right:new ht("paren_right",dt.token,")"),semicolon:new ht("semicolon",dt.token,";"),star:new ht("star",dt.token,"*"),tilde:new ht("tilde",dt.token,"~"),underscore:new ht("underscore",dt.token,"_"),xor:new ht("xor",dt.token,"^"),plus_equal:new ht("plus_equal",dt.token,"+="),minus_equal:new ht("minus_equal",dt.token,"-="),times_equal:new ht("times_equal",dt.token,"*="),division_equal:new ht("division_equal",dt.token,"/="),modulo_equal:new ht("modulo_equal",dt.token,"%="),and_equal:new ht("and_equal",dt.token,"&="),or_equal:new ht("or_equal",dt.token,"|="),xor_equal:new ht("xor_equal",dt.token,"^="),shift_right_equal:new ht("shift_right_equal",dt.token,">>="),shift_left_equal:new ht("shift_left_equal",dt.token,"<<=")},Pe.simpleTokens={"@":bt.tokens.attr,"{":bt.tokens.brace_left,"}":bt.tokens.brace_right,":":bt.tokens.colon,",":bt.tokens.comma,"(":bt.tokens.paren_left,")":bt.tokens.paren_right,";":bt.tokens.semicolon},Pe.literalTokens={"&":bt.tokens.and,"&&":bt.tokens.and_and,"->":bt.tokens.arrow,"/":bt.tokens.forward_slash,"!":bt.tokens.bang,"[":bt.tokens.bracket_left,"]":bt.tokens.bracket_right,"=":bt.tokens.equal,"==":bt.tokens.equal_equal,"!=":bt.tokens.not_equal,">":bt.tokens.greater_than,">=":bt.tokens.greater_than_equal,">>":bt.tokens.shift_right,"<":bt.tokens.less_than,"<=":bt.tokens.less_than_equal,"<<":bt.tokens.shift_left,"%":bt.tokens.modulo,"-":bt.tokens.minus,"--":bt.tokens.minus_minus,".":bt.tokens.period,"+":bt.tokens.plus,"++":bt.tokens.plus_plus,"|":bt.tokens.or,"||":bt.tokens.or_or,"*":bt.tokens.star,"~":bt.tokens.tilde,_:bt.tokens.underscore,"^":bt.tokens.xor,"+=":bt.tokens.plus_equal,"-=":bt.tokens.minus_equal,"*=":bt.tokens.times_equal,"/=":bt.tokens.division_equal,"%=":bt.tokens.modulo_equal,"&=":bt.tokens.and_equal,"|=":bt.tokens.or_equal,"^=":bt.tokens.xor_equal,">>=":bt.tokens.shift_right_equal,"<<=":bt.tokens.shift_left_equal},Pe.regexTokens={decimal_float_literal:bt.tokens.decimal_float_literal,hex_float_literal:bt.tokens.hex_float_literal,int_literal:bt.tokens.int_literal,uint_literal:bt.tokens.uint_literal,ident:bt.tokens.ident},Pe.storage_class=[bt.keywords.function,bt.keywords.private,bt.keywords.workgroup,bt.keywords.uniform,bt.keywords.storage],Pe.access_mode=[bt.keywords.read,bt.keywords.write,bt.keywords.read_write],Pe.sampler_type=[bt.keywords.sampler,bt.keywords.sampler_comparison],Pe.sampled_texture_type=[bt.keywords.texture_1d,bt.keywords.texture_2d,bt.keywords.texture_2d_array,bt.keywords.texture_3d,bt.keywords.texture_cube,bt.keywords.texture_cube_array],Pe.multisampled_texture_type=[bt.keywords.texture_multisampled_2d],Pe.storage_texture_type=[bt.keywords.texture_storage_1d,bt.keywords.texture_storage_2d,bt.keywords.texture_storage_2d_array,bt.keywords.texture_storage_3d],Pe.depth_texture_type=[bt.keywords.texture_depth_2d,bt.keywords.texture_depth_2d_array,bt.keywords.texture_depth_cube,bt.keywords.texture_depth_cube_array,bt.keywords.texture_depth_multisampled_2d],Pe.texture_external_type=[bt.keywords.texture_external],Pe.any_texture_type=[...bt.sampled_texture_type,...bt.multisampled_texture_type,...bt.storage_texture_type,...bt.depth_texture_type,...bt.texture_external_type],Pe.texel_format=[bt.keywords.r8unorm,bt.keywords.r8snorm,bt.keywords.r8uint,bt.keywords.r8sint,bt.keywords.r16uint,bt.keywords.r16sint,bt.keywords.r16float,bt.keywords.rg8unorm,bt.keywords.rg8snorm,bt.keywords.rg8uint,bt.keywords.rg8sint,bt.keywords.r32uint,bt.keywords.r32sint,bt.keywords.r32float,bt.keywords.rg16uint,bt.keywords.rg16sint,bt.keywords.rg16float,bt.keywords.rgba8unorm,bt.keywords.rgba8unorm_srgb,bt.keywords.rgba8snorm,bt.keywords.rgba8uint,bt.keywords.rgba8sint,bt.keywords.bgra8unorm,bt.keywords.bgra8unorm_srgb,bt.keywords.rgb10a2unorm,bt.keywords.rg11b10float,bt.keywords.rg32uint,bt.keywords.rg32sint,bt.keywords.rg32float,bt.keywords.rgba16uint,bt.keywords.rgba16sint,bt.keywords.rgba16float,bt.keywords.rgba32uint,bt.keywords.rgba32sint,bt.keywords.rgba32float],Pe.const_literal=[bt.tokens.int_literal,bt.tokens.uint_literal,bt.tokens.decimal_float_literal,bt.tokens.hex_float_literal,bt.keywords.true,bt.keywords.false],Pe.literal_or_ident=[bt.tokens.ident,bt.tokens.int_literal,bt.tokens.uint_literal,bt.tokens.decimal_float_literal,bt.tokens.hex_float_literal,bt.tokens.name],Pe.element_count_expression=[bt.tokens.int_literal,bt.tokens.uint_literal,bt.tokens.ident],Pe.template_types=[bt.keywords.vec2,bt.keywords.vec3,bt.keywords.vec4,bt.keywords.mat2x2,bt.keywords.mat2x3,bt.keywords.mat2x4,bt.keywords.mat3x2,bt.keywords.mat3x3,bt.keywords.mat3x4,bt.keywords.mat4x2,bt.keywords.mat4x3,bt.keywords.mat4x4,bt.keywords.atomic,bt.keywords.bitcast,...bt.any_texture_type],Pe.attribute_name=[bt.tokens.ident,bt.keywords.block,bt.keywords.diagnostic],Pe.assignment_operators=[bt.tokens.equal,bt.tokens.plus_equal,bt.tokens.minus_equal,bt.tokens.times_equal,bt.tokens.division_equal,bt.tokens.modulo_equal,bt.tokens.and_equal,bt.tokens.or_equal,bt.tokens.xor_equal,bt.tokens.shift_right_equal,bt.tokens.shift_left_equal],Pe.increment_operators=[bt.tokens.plus_plus,bt.tokens.minus_minus];var B7=class{constructor(e,r,i,n,o){this.type=e,this.lexeme=r,this.line=i,this.start=n,this.end=o}toString(){return this.lexeme}isTemplateType(){return Pe.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==Pe.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}},ZX=class{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new B7(Pe.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}let r=Pe.simpleTokens[e];if(r)return this._addToken(r),!0;let i=Pe.none,n=this._isAlpha(e),o=e==="_";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(n){let s=Pe.keywords[e];if(s)return this._addToken(s),!0}if(n||o)return this._addToken(Pe.tokens.ident),!0;for(;;){let s=this._findType(e),a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(Pe.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(Pe.tokens.minus_minus),!0;let u=this._tokens.length-1;if((Pe.literal_or_ident.indexOf(this._tokens[u].type)!=-1||this._tokens[u].type==Pe.tokens.paren_right)&&a!=">")return this._addToken(s),!0}if(e==">"&&(a==">"||a=="=")){let u=!1,p=this._tokens.length-1;for(let m=0;m<5&&p>=0&&Pe.assignment_operators.indexOf(this._tokens[p].type)===-1;++m,--p)if(this._tokens[p].type===Pe.tokens.less_than){p>0&&this._tokens[p-1].isArrayOrTemplateType()&&(u=!0);break}if(u)return this._addToken(s),!0}if(s===Pe.none){let u=e,p=0,m=2;for(let x=0;x<m;++x)if(u+=this._peekAhead(x),s=this._findType(u),s!==Pe.none){p=x;break}if(s===Pe.none)return i!==Pe.none&&(this._current--,this._addToken(i),!0);e=u,this._current+=p+1}if(i=s,this._isAtEnd())break;e+=this._advance()}return i!==Pe.none&&(this._addToken(i),!0)}_findType(e){for(let i in Pe.regexTokens){let n=Pe.regexTokens[i];if(this._match(e,n.rule))return n}return Pe.literalTokens[e]||Pe.none}_match(e,r){let i=r.exec(e);return i&&i.index==0&&i[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let r=this._source[this._current];return e=e||0,e++,this._current+=e,r}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){let r=this._source.substring(this._start,this._current);this._tokens.push(new B7(e,r,this._line,this._start,this._current))}};function fr(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}var F7=new Float32Array(1),DNe=new Uint32Array(F7.buffer),LNe=new Uint32Array(F7.buffer),N7=new Int32Array(1),BNe=new Float32Array(N7.buffer),FNe=new Uint32Array(N7.buffer),z7=new Uint32Array(1),NNe=new Float32Array(z7.buffer),zNe=new Int32Array(z7.buffer);function cye(t,e,r){if(e===r)return t;if(e==="f32"){if(r==="i32"||r==="x32")return F7[0]=t,DNe[0];if(r==="u32")return F7[0]=t,LNe[0]}else if(e==="i32"||e==="x32"){if(r==="f32")return N7[0]=t,BNe[0];if(r==="u32")return N7[0]=t,FNe[0]}else if(e==="u32"){if(r==="f32")return z7[0]=t,NNe[0];if(r==="i32"||r==="x32")return z7[0]=t,zNe[0]}return console.error(`Unsupported cast from ${e} to ${r}`),t}var KX=class{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}},g3=class{constructor(e,r){this.align=e,this.size=r}},Q1=class t{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new WX,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(let r of e)r instanceof J1&&this._functions.set(r.name,new KX(r));for(let r of e)if(r instanceof Ff){let i=this.getTypeInfo(r,null);i instanceof f0&&this.structs.push(i)}for(let r of e)if(r instanceof A5)this.aliases.push(this._getAliasInfo(r));else{if(r instanceof m5){let i=r,n=this._getAttributeNum(i.attributes,"id",0),o=i.type!=null?this.getTypeInfo(i.type,i.attributes):null;this.overrides.push(new VX(i.name,o,i.attributes,n));continue}if(this._isUniformVar(r)){let i=r,n=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),s=this.getTypeInfo(i.type,i.attributes),a=new p3(i.name,s,n,o,i.attributes,r_.Uniform,i.access);a.access||(a.access="read"),this.uniforms.push(a);continue}if(this._isStorageVar(r)){let i=r,n=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),s=this.getTypeInfo(i.type,i.attributes),a=this._isStorageTexture(s),u=new p3(i.name,s,n,o,i.attributes,a?r_.StorageTexture:r_.Storage,i.access);u.access||(u.access="read"),this.storage.push(u);continue}if(this._isTextureVar(r)){let i=r,n=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),s=this.getTypeInfo(i.type,i.attributes),a=this._isStorageTexture(s),u=new p3(i.name,s,n,o,i.attributes,a?r_.StorageTexture:r_.Texture,i.access);u.access||(u.access="read"),a?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(r)){let i=r,n=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),s=this.getTypeInfo(i.type,i.attributes),a=new p3(i.name,s,n,o,i.attributes,r_.Sampler,i.access);this.samplers.push(a);continue}}for(let r of e)if(r instanceof J1){let i=this._getAttribute(r,"vertex"),n=this._getAttribute(r,"fragment"),o=this._getAttribute(r,"compute"),s=i||n||o,a=new $X(r.name,s?.name,r.attributes);a.attributes=r.attributes,a.startLine=r.startLine,a.endLine=r.endLine,this.functions.push(a),this._functions.get(r.name).info=a,s&&(this._functions.get(r.name).inUse=!0,a.inUse=!0,a.resources=this._findResources(r,!!s),a.inputs=this._getInputs(r.args),a.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(a)),a.arguments=r.args.map(u=>new jX(u.name,this.getTypeInfo(u.type,u.attributes),u.attributes)),a.returnType=r.returnType?this.getTypeInfo(r.returnType,r.attributes):null;continue}for(let r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(let r of this._functions.values())r.node.search(i=>{var n,o,s;if(i instanceof L7){if(i.value)if(fr(i.value))for(let a of i.value)for(let u of this.overrides)a===u.name&&((n=r.info)===null||n===void 0||n.overrides.push(u));else for(let a of this.overrides)i.value===a.name&&((o=r.info)===null||o===void 0||o.overrides.push(a))}else if(i instanceof zc)for(let a of this.overrides)i.name===a.name&&((s=r.info)===null||s===void 0||s.overrides.push(a))});for(let r of this.uniforms)this._markStructsInUse(r.type);for(let r of this.storage)this._markStructsInUse(r.type)}getFunctionInfo(e){for(let r of this.functions)if(r.name==e)return r;return null}getStructInfo(e){for(let r of this.structs)if(r.name==e)return r;return null}getOverrideInfo(e){for(let r of this.overrides)if(r.name==e)return r;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(let r of e.members)this._markStructsInUse(r.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{let r=this._getAlias(e.name);r&&this._markStructsInUse(r)}}_addCalls(e,r){var i;for(let n of e.calls){let o=(i=this._functions.get(n.name))===null||i===void 0?void 0:i.info;o&&r.add(o)}}findResource(e,r,i){if(i){for(let n of this.entry.compute)if(n.name===i){for(let o of n.resources)if(o.group==e&&o.binding==r)return o}for(let n of this.entry.vertex)if(n.name===i){for(let o of n.resources)if(o.group==e&&o.binding==r)return o}for(let n of this.entry.fragment)if(n.name===i){for(let o of n.resources)if(o.group==e&&o.binding==r)return o}}for(let n of this.uniforms)if(n.group==e&&n.binding==r)return n;for(let n of this.storage)if(n.group==e&&n.binding==r)return n;for(let n of this.textures)if(n.group==e&&n.binding==r)return n;for(let n of this.samplers)if(n.group==e&&n.binding==r)return n;return null}_findResource(e){for(let r of this.uniforms)if(r.name==e)return r;for(let r of this.storage)if(r.name==e)return r;for(let r of this.textures)if(r.name==e)return r;for(let r of this.samplers)if(r.name==e)return r;return null}_markStructsFromAST(e){let r=this.getTypeInfo(e,null);this._markStructsInUse(r)}_findResources(e,r){let i=[],n=this,o=[];return e.search(s=>{if(s instanceof b3)o.push({});else if(s instanceof x3)o.pop();else if(s instanceof Nf){let a=s;r&&a.type!==null&&this._markStructsFromAST(a.type),o.length>0&&(o[o.length-1][a.name]=a)}else if(s instanceof wd){let a=s;r&&a.type!==null&&this._markStructsFromAST(a.type)}else if(s instanceof Z1){let a=s;r&&a.type!==null&&this._markStructsFromAST(a.type),o.length>0&&(o[o.length-1][a.name]=a)}else if(s instanceof zc){let a=s;if(o.length>0&&o[o.length-1][a.name])return;let u=n._findResource(a.name);u&&i.push(u)}else if(s instanceof y5){let a=s,u=n._functions.get(a.name);u&&(r&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=n._findResources(u.node,r)),i.push(...u.resources))}else if(s instanceof g5){let a=s,u=n._functions.get(a.name);u&&(r&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=n._findResources(u.node,r)),i.push(...u.resources))}}),[...new Map(i.map(s=>[s.name,s])).values()]}getBindGroups(){let e=[];function r(i,n){i>=e.length&&(e.length=i+1),e[i]===void 0&&(e[i]=[]),n>=e[i].length&&(e[i].length=n+1)}for(let i of this.uniforms)r(i.group,i.binding),e[i.group][i.binding]=i;for(let i of this.storage)r(i.group,i.binding),e[i.group][i.binding]=i;for(let i of this.textures)r(i.group,i.binding),e[i.group][i.binding]=i;for(let i of this.samplers)r(i.group,i.binding),e[i.group][i.binding]=i;return e}_getOutputs(e,r=void 0){if(r===void 0&&(r=[]),e instanceof Ff)this._getStructOutputs(e,r);else{let i=this._getOutputInfo(e);i!==null&&r.push(i)}return r}_getStructOutputs(e,r){for(let i of e.members)if(i.type instanceof Ff)this._getStructOutputs(i.type,r);else{let n=this._getAttribute(i,"location")||this._getAttribute(i,"builtin");if(n!==null){let o=this.getTypeInfo(i.type,i.type.attributes),s=this._parseInt(n.value),a=new p7(i.name,o,n.name,s);r.push(a)}}}_getOutputInfo(e){let r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){let i=this.getTypeInfo(e,e.attributes),n=this._parseInt(r.value);return new p7("",i,r.name,n)}return null}_getInputs(e,r=void 0){r===void 0&&(r=[]);for(let i of e)if(i.type instanceof Ff)this._getStructInputs(i.type,r);else{let n=this._getInputInfo(i);n!==null&&r.push(n)}return r}_getStructInputs(e,r){for(let i of e.members)if(i.type instanceof Ff)this._getStructInputs(i.type,r);else{let n=this._getInputInfo(i);n!==null&&r.push(n)}}_getInputInfo(e){let r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){let i=this._getAttribute(e,"interpolation"),n=this.getTypeInfo(e.type,e.attributes),o=this._parseInt(r.value),s=new UX(e.name,n,r.name,o);return i!==null&&(s.interpolation=this._parseString(i.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);let r=parseInt(e);return isNaN(r)?e:r}_getAlias(e){for(let r of this.aliases)if(r.name==e)return r.type;return null}_getAliasInfo(e){return new zX(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(let r of this.structs)if(r.name==e)return r;for(let r of this.aliases)if(r.name==e)return r.type;return null}getTypeInfo(e,r=null){if(this._types.has(e))return this._types.get(e);if(e instanceof y3){let n=e.type?this.getTypeInfo(e.type,e.attributes):null,o=new f5(e.name,n,r);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof K1){let n=e,o=n.format?this.getTypeInfo(n.format,n.attributes):null,s=new p0(n.name,r);return s.format=o,s.count=n.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Ff){let n=e,o=new f0(n.name,r);o.startLine=n.startLine,o.endLine=n.endLine;for(let s of n.members){let a=this.getTypeInfo(s.type,s.attributes);o.members.push(new f7(s.name,a,s.attributes))}return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof X1){let n=e,o=n.format instanceof jt,s=n.format?o?this.getTypeInfo(n.format,null):new Tu(n.format,null):null,a=new gg(n.name,s,r,n.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof pt){let n=e,o=n.format?this.getTypeInfo(n.format,null):null,s=new gg(n.name,o,r,n.access);return this._types.set(e,s),this._updateTypeInfo(s),s}let i=new Tu(e.name,r);return this._types.set(e,i),this._updateTypeInfo(i),i}_updateTypeInfo(e){var r,i,n;let o=this._getTypeSize(e);if(e.size=(r=o?.size)!==null&&r!==void 0?r:0,e instanceof p0&&e.format){let s=this._getTypeSize(e.format);e.stride=Math.max((i=s?.size)!==null&&i!==void 0?i:0,(n=s?.align)!==null&&n!==void 0?n:0),this._updateTypeInfo(e.format)}e instanceof f5&&this._updateTypeInfo(e.format),e instanceof f0&&this._updateStructInfo(e)}_updateStructInfo(e){var r;let i=0,n=0,o=0,s=0;for(let a=0,u=e.members.length;a<u;++a){let p=e.members[a],m=this._getTypeSize(p);if(!m)continue;(r=this._getAlias(p.type.name))!==null&&r!==void 0||p.type;let x=m.align,M=m.size;i=this._roundUp(x,i+n),n=M,o=i,s=Math.max(s,x),p.offset=i,p.size=M,this._updateTypeInfo(p.type)}e.size=this._roundUp(s,o+n),e.align=s}_getTypeSize(e){var r,i;if(e==null)return null;let n=this._getAttributeNum(e.attributes,"size",0),o=this._getAttributeNum(e.attributes,"align",0);if(e instanceof f7&&(e=e.type),e instanceof Tu){let s=this._getAlias(e.name);s!==null&&(e=s)}{let s=t._typeInfo[e.name];if(s!==void 0){let a=((r=e.format)===null||r===void 0?void 0:r.name)==="f16"?2:1;return new g3(Math.max(o,s.align/a),Math.max(n,s.size/a))}}{let s=t._typeInfo[e.name.substring(0,e.name.length-1)];if(s){let a=e.name[e.name.length-1]==="h"?2:1;return new g3(Math.max(o,s.align/a),Math.max(n,s.size/a))}}if(e instanceof p0){let s=e,a=8,u=8,p=this._getTypeSize(s.format);return p!==null&&(u=p.size,a=p.align),u=s.count*this._getAttributeNum((i=e?.attributes)!==null&&i!==void 0?i:null,"stride",this._roundUp(a,u)),n&&(u=n),new g3(Math.max(o,a),Math.max(n,u))}if(e instanceof f0){let s=0,a=0,u=0,p=0,m=0;for(let x of e.members){let M=this._getTypeSize(x.type);M!==null&&(s=Math.max(M.align,s),u=this._roundUp(M.align,u+p),p=M.size,m=u)}return a=this._roundUp(s,m+p),new g3(Math.max(o,s),Math.max(n,a))}return null}_isUniformVar(e){return e instanceof Nf&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Nf&&e.storage=="storage"}_isTextureVar(e){return e instanceof Nf&&e.type!==null&&t._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Nf&&e.type!==null&&t._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,r){let i=e;if(!i||!i.attributes)return null;let n=i.attributes;for(let o of n)if(o.name==r)return o;return null}_getAttributeNum(e,r,i){if(e===null)return i;for(let n of e)if(n.name==r){let o=n!==null&&n.value!==null?n.value:i;return o instanceof Array&&(o=o[0]),typeof o=="number"?o:typeof o=="string"?parseInt(o):i}return i}_roundUp(e,r){return Math.ceil(r/e)*e}};Q1._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Q1._textureTypes=Pe.any_texture_type.map(t=>t.name),Q1._samplerTypes=Pe.sampler_type.map(t=>t.name);var sZ=0,QX=class t{constructor(e,r,i){this.id=sZ++,this.name=e,this.value=r,this.node=i}clone(){return new t(this.name,this.value,this.node)}},JX=class t{constructor(e){this.id=sZ++,this.name=e.name,this.node=e}clone(){return new t(this.node)}},eZ=class t{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=sZ++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var r;return this.variables.has(e)?(r=this.variables.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var r;return this.functions.has(e)?(r=this.functions.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getFunction(e):null}createVariable(e,r,i){this.variables.set(e,new QX(e,r,i??null))}setVariable(e,r,i){let n=this.getVariable(e);n!==null?n.value=r:this.createVariable(e,r,i)}getVariableValue(e){var r;let i=this.getVariable(e);return(r=i?.value)!==null&&r!==void 0?r:null}clone(){return new t(this)}},tZ=class{evalExpression(e,r){return null}getTypeInfo(e){return null}getVariableName(e,r){return""}},rZ=class{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,r){let i=this.exec.evalExpression(e.args[0],r),n=!0;if(i instanceof Fe)return i.data.forEach(o=>{o||(n=!1)}),new ft(n?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe){let n=i.data.some(o=>o);return new ft(n?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,r){let i=this.exec.evalExpression(e.args[2],r);if(!(i instanceof ft))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return i.value?this.exec.evalExpression(e.args[1],r):this.exec.evalExpression(e.args[0],r)}ArrayLength(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.evalExpression(i,r);if(n instanceof wa&&n.typeInfo.size===0){let o=n.typeInfo,s=n.buffer.byteLength/o.stride;return new ft(s,this.getTypeInfo("u32"))}return new ft(n.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.abs(o)),i.typeInfo);let n=i;return new ft(Math.abs(n.value),n.typeInfo)}Acos(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.acos(o)),i.typeInfo);let n=i;return new ft(Math.acos(n.value),i.typeInfo)}Acosh(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.acosh(o)),i.typeInfo);let n=i;return new ft(Math.acosh(n.value),i.typeInfo)}Asin(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.asin(o)),i.typeInfo);let n=i;return new ft(Math.asin(n.value),i.typeInfo)}Asinh(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.asinh(o)),i.typeInfo);let n=i;return new ft(Math.asinh(n.value),i.typeInfo)}Atan(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.atan(o)),i.typeInfo);let n=i;return new ft(Math.atan(n.value),i.typeInfo)}Atanh(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.atanh(o)),i.typeInfo);let n=i;return new ft(Math.atanh(n.value),i.typeInfo)}Atan2(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe)return new Fe(i.data.map((a,u)=>Math.atan2(a,n.data[u])),i.typeInfo);let o=i,s=n;return new ft(Math.atan2(o.value,s.value),i.typeInfo)}Ceil(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.ceil(o)),i.typeInfo);let n=i;return new ft(Math.ceil(n.value),i.typeInfo)}_clamp(e,r,i){return Math.min(Math.max(e,r),i)}Clamp(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(i instanceof Fe&&n instanceof Fe&&o instanceof Fe)return new Fe(i.data.map((p,m)=>this._clamp(p,n.data[m],o.data[m])),i.typeInfo);let s=i,a=n,u=o;return new ft(this._clamp(s.value,a.value,u.value),i.typeInfo)}Cos(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.cos(o)),i.typeInfo);let n=i;return new ft(Math.cos(n.value),i.typeInfo)}Cosh(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.cosh(o)),i.typeInfo);let n=i;return new ft(Math.cos(n.value),i.typeInfo)}CountLeadingZeros(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.clz32(o)),i.typeInfo);let n=i;return new ft(Math.clz32(n.value),i.typeInfo)}_countOneBits(e){let r=0;for(;e!==0;)1&e&&r++,e>>=1;return r}CountOneBits(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>this._countOneBits(o)),i.typeInfo);let n=i;return new ft(this._countOneBits(n.value),i.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let r=0;for(;!(1&e);)e>>=1,r++;return r}CountTrailingZeros(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>this._countTrailingZeros(o)),i.typeInfo);let n=i;return new ft(this._countTrailingZeros(n.value),i.typeInfo)}Cross(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe){if(i.data.length!==3||n.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;let o=i.data,s=n.data;return new Fe([o[1]*s[2]-s[1]*o[2],o[2]*s[0]-s[2]*o[0],o[0]*s[1]-s[0]*o[1]],i.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,r){let i=this.exec.evalExpression(e.args[0],r),n=180/Math.PI;return i instanceof Fe?new Fe(i.data.map(o=>o*n),i.typeInfo):new ft(i.value*n,this.getTypeInfo("f32"))}Determinant(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof pi){let n=i.data,o=i.typeInfo.getTypeName(),s=o.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(o==="mat2x2"||o==="mat2x2f"||o==="mat2x2h")return new ft(n[0]*n[3]-n[1]*n[2],s);if(o==="mat2x3"||o==="mat2x3f"||o==="mat2x3h")return new ft(n[0]*(n[4]*n[8]-n[5]*n[7])-n[1]*(n[3]*n[8]-n[5]*n[6])+n[2]*(n[3]*n[7]-n[4]*n[6]),s);if(o==="mat2x4"||o==="mat2x4f"||o==="mat2x4h")console.error(`TODO: Determinant for ${o}`);else if(o==="mat3x2"||o==="mat3x2f"||o==="mat3x2h")console.error(`TODO: Determinant for ${o}`);else{if(o==="mat3x3"||o==="mat3x3f"||o==="mat3x3h")return new ft(n[0]*(n[4]*n[8]-n[5]*n[7])-n[1]*(n[3]*n[8]-n[5]*n[6])+n[2]*(n[3]*n[7]-n[4]*n[6]),s);o==="mat3x4"||o==="mat3x4f"||o==="mat3x4h"||o==="mat4x2"||o==="mat4x2f"||o==="mat4x2h"||o==="mat4x3"||o==="mat4x3f"||o==="mat4x3h"?console.error(`TODO: Determinant for ${o}`):o!=="mat4x4"&&o!=="mat4x4f"&&o!=="mat4x4h"||console.error(`TODO: Determinant for ${o}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe){let a=0;for(let u=0;u<i.data.length;++u)a+=(i.data[u]-n.data[u])*(i.data[u]-n.data[u]);return new ft(Math.sqrt(a),this.getTypeInfo("f32"))}let o=i,s=n;return new ft(Math.abs(o.value-s.value),i.typeInfo)}_dot(e,r){let i=0;for(let n=0;n<e.length;++n)i+=r[n]*e[n];return i}Dot(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);return i instanceof Fe&&n instanceof Fe?new ft(this._dot(i.data,n.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,r){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,r){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.exp(o)),i.typeInfo);let n=i;return new ft(Math.exp(n.value),i.typeInfo)}Exp2(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.pow(2,o)),i.typeInfo);let n=i;return new ft(Math.pow(2,n.value),i.typeInfo)}ExtractBits(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(n.typeInfo.name!=="u32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(o.typeInfo.name!=="u32"&&o.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;let s=n.value,a=o.value;if(i instanceof Fe)return new Fe(i.data.map(p=>p>>s&(1<<a)-1),i.typeInfo);if(i.typeInfo.name!=="i32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;let u=i.value;return new ft(u>>s&(1<<a)-1,this.getTypeInfo("i32"))}FaceForward(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(i instanceof Fe&&n instanceof Fe&&o instanceof Fe){let s=this._dot(n.data,o.data);return new Fe(s<0?Array.from(i.data):i.data.map(a=>-a),i.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>this._firstLeadingBit(o)),i.typeInfo);let n=i;return new ft(this._firstLeadingBit(n.value),i.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>this._firstTrailingBit(o)),i.typeInfo);let n=i;return new ft(this._firstTrailingBit(n.value),i.typeInfo)}Floor(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.floor(o)),i.typeInfo);let n=i;return new ft(Math.floor(n.value),i.typeInfo)}Fma(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(i instanceof Fe&&n instanceof Fe&&o instanceof Fe)return i.data.length!==n.data.length||i.data.length!==o.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new Fe(i.data.map((p,m)=>p*n.data[m]+o.data[m]),i.typeInfo);let s=i,a=n,u=o;return new ft(s.value*a.value+u.value,s.typeInfo)}Fract(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>o-Math.floor(o)),i.typeInfo);let n=i;return new ft(n.value-Math.floor(n.value),i.typeInfo)}Frexp(e,r){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r),s=this.exec.evalExpression(e.args[3],r);if(o.typeInfo.name!=="u32"&&o.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;let a=o.value,u=(1<<s.value)-1<<a,p=~u;if(i instanceof Fe&&n instanceof Fe)return new Fe(i.data.map((M,k)=>M&p|n.data[k]<<a&u),i.typeInfo);let m=i.value,x=n.value;return new ft(m&p|x<<a&u,i.typeInfo)}InverseSqrt(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>1/Math.sqrt(o)),i.typeInfo);let n=i;return new ft(1/Math.sqrt(n.value),i.typeInfo)}Ldexp(e,r){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe){let o=0;return i.data.forEach(s=>{o+=s*s}),new ft(Math.sqrt(o),this.getTypeInfo("f32"))}let n=i;return new ft(Math.abs(n.value),i.typeInfo)}Log(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.log(o)),i.typeInfo);let n=i;return new ft(Math.log(n.value),i.typeInfo)}Log2(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.log2(o)),i.typeInfo);let n=i;return new ft(Math.log2(n.value),i.typeInfo)}Max(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe)return new Fe(i.data.map((a,u)=>Math.max(a,n.data[u])),i.typeInfo);let o=i,s=n;return new ft(Math.max(o.value,s.value),i.typeInfo)}Min(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe)return new Fe(i.data.map((a,u)=>Math.min(a,n.data[u])),i.typeInfo);let o=i,s=n;return new ft(Math.min(o.value,s.value),i.typeInfo)}Mix(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(i instanceof Fe&&n instanceof Fe&&o instanceof Fe)return new Fe(i.data.map((u,p)=>i.data[p]*(1-o.data[p])+n.data[p]*o.data[p]),i.typeInfo);let s=n,a=o;return new ft(i.value*(1-a.value)+s.value*a.value,i.typeInfo)}Modf(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe)return new Fe(i.data.map((s,a)=>s%n.data[a]),i.typeInfo);let o=n;return new ft(i.value%o.value,i.typeInfo)}Normalize(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe){let n=this.Length(e,r).value;return new Fe(i.data.map(o=>o/n),i.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe)return new Fe(i.data.map((a,u)=>Math.pow(a,n.data[u])),i.typeInfo);let o=i,s=n;return new ft(Math.pow(o.value,s.value),i.typeInfo)}QuantizeToF16(e,r){let i=this.exec.evalExpression(e.args[0],r);return i instanceof Fe?new Fe(i.data.map(n=>n),i.typeInfo):new ft(i.value,i.typeInfo)}Radians(e,r){let i=this.exec.evalExpression(e.args[0],r);return i instanceof Fe?new Fe(i.data.map(n=>n*Math.PI/180),i.typeInfo):new ft(i.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(i instanceof Fe&&n instanceof Fe){let o=this._dot(i.data,n.data);return new Fe(i.data.map((s,a)=>s-2*o*n.data[a]),i.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(i instanceof Fe&&n instanceof Fe&&o instanceof ft){let s=this._dot(n.data,i.data);return new Fe(i.data.map((a,u)=>{let p=1-o.value*o.value*(1-s*s);if(p<0)return 0;let m=Math.sqrt(p);return o.value*a-(o.value*s+m)*n.data[u]}),i.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,r){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.round(o)),i.typeInfo);let n=i;return new ft(Math.round(n.value),i.typeInfo)}Saturate(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.min(Math.max(o,0),1)),i.typeInfo);let n=i;return new ft(Math.min(Math.max(n.value,0),1),i.typeInfo)}Sign(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.sign(o)),i.typeInfo);let n=i;return new ft(Math.sign(n.value),i.typeInfo)}Sin(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.sin(o)),i.typeInfo);let n=i;return new ft(Math.sin(n.value),i.typeInfo)}Sinh(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.sinh(o)),i.typeInfo);let n=i;return new ft(Math.sinh(n.value),i.typeInfo)}_smoothstep(e,r,i){let n=Math.min(Math.max((i-e)/(r-e),0),1);return n*n*(3-2*n)}SmoothStep(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r),o=this.exec.evalExpression(e.args[2],r);if(o instanceof Fe&&i instanceof Fe&&n instanceof Fe)return new Fe(o.data.map((p,m)=>this._smoothstep(i.data[m],n.data[m],p)),o.typeInfo);let s=i,a=n,u=o;return new ft(this._smoothstep(s.value,a.value,u.value),o.typeInfo)}Sqrt(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.sqrt(o)),i.typeInfo);let n=i;return new ft(Math.sqrt(n.value),i.typeInfo)}Step(e,r){let i=this.exec.evalExpression(e.args[0],r),n=this.exec.evalExpression(e.args[1],r);if(n instanceof Fe&&i instanceof Fe)return new Fe(n.data.map((s,a)=>s<i.data[a]?0:1),n.typeInfo);let o=i;return new ft(n.value<o.value?0:1,o.typeInfo)}Tan(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.tan(o)),i.typeInfo);let n=i;return new ft(Math.tan(n.value),i.typeInfo)}Tanh(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.tanh(o)),i.typeInfo);let n=i;return new ft(Math.tanh(n.value),i.typeInfo)}_getTransposeType(e){let r=e.getTypeName();return r==="mat2x2f"||r==="mat2x2h"?e:r==="mat2x3f"?this.getTypeInfo("mat3x2f"):r==="mat2x3h"?this.getTypeInfo("mat3x2h"):r==="mat2x4f"?this.getTypeInfo("mat4x2f"):r==="mat2x4h"?this.getTypeInfo("mat4x2h"):r==="mat3x2f"?this.getTypeInfo("mat2x3f"):r==="mat3x2h"?this.getTypeInfo("mat2x3h"):r==="mat3x3f"||r==="mat3x3h"?e:r==="mat3x4f"?this.getTypeInfo("mat4x3f"):r==="mat3x4h"?this.getTypeInfo("mat4x3h"):r==="mat4x2f"?this.getTypeInfo("mat2x4f"):r==="mat4x2h"?this.getTypeInfo("mat2x4h"):r==="mat4x3f"?this.getTypeInfo("mat3x4f"):r==="mat4x3h"?this.getTypeInfo("mat3x4h"):(r==="mat4x4f"||r==="mat4x4h"||console.error(`Invalid matrix type ${r}`),e)}Transpose(e,r){let i=this.exec.evalExpression(e.args[0],r);if(!(i instanceof pi))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;let n=this._getTransposeType(i.typeInfo);if(i.typeInfo.name==="mat2x2"||i.typeInfo.name==="mat2x2f"||i.typeInfo.name==="mat2x2h"){let o=i.data;return new pi([o[0],o[2],o[1],o[3]],n)}if(i.typeInfo.name==="mat2x3"||i.typeInfo.name==="mat2x3f"||i.typeInfo.name==="mat2x3h"){let o=i.data;return new pi([o[0],o[3],o[6],o[1],o[4],o[7]],n)}if(i.typeInfo.name==="mat2x4"||i.typeInfo.name==="mat2x4f"||i.typeInfo.name==="mat2x4h"){let o=i.data;return new pi([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13]],n)}if(i.typeInfo.name==="mat3x2"||i.typeInfo.name==="mat3x2f"||i.typeInfo.name==="mat3x2h"){let o=i.data;return new pi([o[0],o[3],o[1],o[4],o[2],o[5]],n)}if(i.typeInfo.name==="mat3x3"||i.typeInfo.name==="mat3x3f"||i.typeInfo.name==="mat3x3h"){let o=i.data;return new pi([o[0],o[3],o[6],o[1],o[4],o[7],o[2],o[5],o[8]],n)}if(i.typeInfo.name==="mat3x4"||i.typeInfo.name==="mat3x4f"||i.typeInfo.name==="mat3x4h"){let o=i.data;return new pi([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14]],n)}if(i.typeInfo.name==="mat4x2"||i.typeInfo.name==="mat4x2f"||i.typeInfo.name==="mat4x2h"){let o=i.data;return new pi([o[0],o[4],o[1],o[5],o[2],o[6]],n)}if(i.typeInfo.name==="mat4x3"||i.typeInfo.name==="mat4x3f"||i.typeInfo.name==="mat4x3h"){let o=i.data;return new pi([o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]],n)}if(i.typeInfo.name==="mat4x4"||i.typeInfo.name==="mat4x4f"||i.typeInfo.name==="mat4x4h"){let o=i.data;return new pi([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14],o[3],o[7],o[11],o[15]],n)}return console.error(`Invalid matrix type ${i.typeInfo.name}`),null}Trunc(e,r){let i=this.exec.evalExpression(e.args[0],r);if(i instanceof Fe)return new Fe(i.data.map(o=>Math.trunc(o)),i.typeInfo);let n=i;return new ft(Math.trunc(n.value),i.typeInfo)}Dpdx(e,r){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,r){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,r){return console.error("TODO: dpdxFine"),null}Dpdy(e,r){return console.error("TODO: dpdy"),null}DpdyCoarse(e,r){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,r){return console.error("TODO: dpdyFine"),null}Fwidth(e,r){return console.error("TODO: fwidth"),null}FwidthCoarse(e,r){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,r){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,r){let i=e.args[0],n=e.args.length>1?this.exec.evalExpression(e.args[1],r).value:0;if(i instanceof zc){let o=i.name,s=r.getVariableValue(o);if(s instanceof mg){if(n<0||n>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;let a=s.getMipLevelSize(n),u=s.dimension;return u==="1d"?new ft(a[0],this.getTypeInfo("u32")):u==="3d"?new Fe(a,this.getTypeInfo("vec3u")):u==="2d"?new Fe(a.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${u} not found. Line ${e.line}`),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,r){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,r){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,r){let i=e.args[0],n=this.exec.evalExpression(e.args[1],r),o=e.args.length>2?this.exec.evalExpression(e.args[2],r).value:0;if(!(n instanceof Fe)||n.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(i instanceof zc){let s=i.name,a=r.getVariableValue(s);if(a instanceof mg){let u=Math.floor(n.data[0]),p=Math.floor(n.data[1]);if(u<0||u>=a.width||p<0||p>=a.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;let m=a.getPixel(u,p,0,o);return m===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new Fe(m,this.getTypeInfo("vec4f"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,r){let i=e.args[0];if(i instanceof zc){let n=i.name,o=r.getVariableValue(n);return o instanceof mg?new ft(o.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${n} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,r){let i=e.args[0];if(i instanceof zc){let n=i.name,o=r.getVariableValue(n);return o instanceof mg?new ft(o.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${n} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,r){let i=e.args[0];if(i instanceof zc){let n=i.name,o=r.getVariableValue(n);return o instanceof mg?new ft(o.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${n} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,r){return console.error("TODO: textureSample"),null}TextureSampleBias(e,r){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,r){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,r){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,r){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,r){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,r){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,r){let i=e.args[0],n=this.exec.evalExpression(e.args[1],r),o=e.args.length===4?this.exec.evalExpression(e.args[2],r).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],r).data:this.exec.evalExpression(e.args[2],r).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(n instanceof Fe)||n.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(i instanceof zc){let a=i.name,u=r.getVariableValue(a);if(u instanceof mg){let p=u.getMipLevelSize(0),m=Math.floor(n.data[0]),x=Math.floor(n.data[1]);return m<0||m>=p[0]||x<0||x>=p[1]?(console.error(`Texture ${a} out of bounds. Line ${e.line}`),null):(u.setPixel(m,x,0,o,Array.from(s)),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r);return r.getVariable(n).value.getSubData(this.exec,i.postfix,r)}AtomicStore(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r);return u instanceof ft&&a instanceof ft&&(u.value=a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),null}AtomicAdd(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value+=a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicSub(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value-=a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicMax(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value=Math.max(u.value,a.value)),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicMin(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value=Math.min(u.value,a.value)),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicAnd(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value=u.value&a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicOr(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value=u.value|a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicXor(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value=u.value^a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicExchange(e,r){let i=e.args[0];i instanceof Rs&&(i=i.right);let n=this.exec.getVariableName(i,r),o=r.getVariable(n),s=e.args[1],a=this.exec.evalExpression(s,r),u=o.value.getSubData(this.exec,i.postfix,r),p=new ft(u.value,u.typeInfo);return u instanceof ft&&a instanceof ft&&(u.value=a.value),o.value instanceof wa&&o.value.setDataValue(this.exec,u,i.postfix,r),p}AtomicCompareExchangeWeak(e,r){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,r){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,r){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,r){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,r){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,r){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,r){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,r){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,r){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,r){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,r){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,r){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,r){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,r){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,r){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,r){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,r){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,r){return null}TextureBarrier(e,r){return null}WorkgroupBarrier(e,r){return null}WorkgroupUniformLoad(e,r){return null}SubgroupAdd(e,r){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,r){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,r){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,r){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,r){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,r){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,r){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,r){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,r){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,r){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,r){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,r){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,r){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,r){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,r){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,r){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,r){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,r){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,r){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,r){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,r){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,r){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,r){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,r){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,r){return console.error("TODO: quadSwapY"),null}},NX={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Nc={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]},v3=class t extends tZ{constructor(e,r){var i;super(),this.ast=e??[],this.reflection=new Q1,this.reflection.updateAST(this.ast),this.context=(i=r?.clone())!==null&&i!==void 0?i:new eZ,this.builtins=new rZ(this),this.typeInfo={bool:this.getTypeInfo(jt.bool),i32:this.getTypeInfo(jt.i32),u32:this.getTypeInfo(jt.u32),f32:this.getTypeInfo(jt.f32),f16:this.getTypeInfo(jt.f16),vec2f:this.getTypeInfo(pt.vec2f),vec2u:this.getTypeInfo(pt.vec2u),vec2i:this.getTypeInfo(pt.vec2i),vec2h:this.getTypeInfo(pt.vec2h),vec3f:this.getTypeInfo(pt.vec3f),vec3u:this.getTypeInfo(pt.vec3u),vec3i:this.getTypeInfo(pt.vec3i),vec3h:this.getTypeInfo(pt.vec3h),vec4f:this.getTypeInfo(pt.vec4f),vec4u:this.getTypeInfo(pt.vec4u),vec4i:this.getTypeInfo(pt.vec4i),vec4h:this.getTypeInfo(pt.vec4h),mat2x2f:this.getTypeInfo(pt.mat2x2f),mat2x3f:this.getTypeInfo(pt.mat2x3f),mat2x4f:this.getTypeInfo(pt.mat2x4f),mat3x2f:this.getTypeInfo(pt.mat3x2f),mat3x3f:this.getTypeInfo(pt.mat3x3f),mat3x4f:this.getTypeInfo(pt.mat3x4f),mat4x2f:this.getTypeInfo(pt.mat4x2f),mat4x3f:this.getTypeInfo(pt.mat4x3f),mat4x4f:this.getTypeInfo(pt.mat4x4f)}}getVariableValue(e){var r,i;let n=(i=(r=this.context.getVariable(e))===null||r===void 0?void 0:r.value)!==null&&i!==void 0?i:null;if(n===null)return null;if(n instanceof ft)return n.value;if(n instanceof Fe||n instanceof pi)return Array.from(n.data);if(n instanceof wa&&n.typeInfo instanceof p0){if(n.typeInfo.format.name==="u32")return Array.from(new Uint32Array(n.buffer,n.offset,n.typeInfo.count));if(n.typeInfo.format.name==="i32")return Array.from(new Int32Array(n.buffer,n.offset,n.typeInfo.count));if(n.typeInfo.format.name==="f32")return Array.from(new Float32Array(n.buffer,n.offset,n.typeInfo.count))}return console.error(`Unsupported return variable type ${n.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,r,i,n){let o=this.context.clone();(n=n??{}).constants&&this._setOverrides(n.constants,o),this._execStatements(this.ast,o);let s=o.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof r=="number")r=[r,1,1];else{if(r.length===0)return void console.error("Invalid dispatch count");r.length===1?r=[r[0],1,1]:r.length===2?r=[r[0],r[1],1]:r.length>3&&(r=[r[0],r[1],r[2]])}let a=r[0],u=r[1],p=r[2],m=this.getTypeInfo("vec3u");o.setVariable("@num_workgroups",new Fe(r,m));let x=this.reflection.getFunctionInfo(e);x===null&&console.error(`Function ${e} not found in reflection data`);for(let M in i)for(let k in i[M]){let F=i[M][k];o.variables.forEach(j=>{var H;let W=j.node;if(W?.attributes){let Z=null,Y=null;for(let ee of W.attributes)ee.name==="binding"?Z=ee.value:ee.name==="group"&&(Y=ee.value);if(k==Z&&M==Y){let ee=!1;for(let ce of x.resources)if(ce.name===j.name&&ce.group===parseInt(M)&&ce.binding===parseInt(k)){ee=!0;break}if(ee)if(F.texture!==void 0&&F.descriptor!==void 0){let ce=new mg(F.texture,this.getTypeInfo(W.type),F.descriptor,(H=F.texture.view)!==null&&H!==void 0?H:null);j.value=ce}else F.uniform!==void 0?j.value=new wa(F.uniform,this.getTypeInfo(W.type)):j.value=new wa(F,this.getTypeInfo(W.type))}}})}for(let M=0;M<p;++M)for(let k=0;k<u;++k)for(let F=0;F<a;++F)o.setVariable("@workgroup_id",new Fe([F,k,M],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[F,k,M],o)}execStatement(e,r){if(e instanceof x7)return this.evalExpression(e.value,r);if(e instanceof S7){if(e.condition){let i=this.evalExpression(e.condition,r);if(!(i instanceof ft))throw new Error("Invalid break-if condition");if(!i.value)return null}return t._breakObj}if(e instanceof T7)return t._continueObj;if(e instanceof Z1)this._let(e,r);else if(e instanceof Nf)this._var(e,r);else if(e instanceof A3)this._const(e,r);else if(e instanceof J1)this._function(e,r);else{if(e instanceof b7)return this._if(e,r);if(e instanceof v7)return this._switch(e,r);if(e instanceof g7)return this._for(e,r);if(e instanceof m7)return this._while(e,r);if(e instanceof _7)return this._loop(e,r);if(e instanceof p5){let i=r.clone();return i.currentFunctionName=r.currentFunctionName,this._execStatements(e.body,i)}if(e instanceof y7)this._assign(e,r);else if(e instanceof A7)this._increment(e,r);else{if(e instanceof Ff)return null;if(e instanceof m5){let i=e.name;r.getVariable(i)===null&&r.setVariable(i,new ft(0,this.getTypeInfo("u32")))}else if(e instanceof g5)this._call(e,r);else{if(e instanceof w7||e instanceof A5)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,r){return e instanceof wh?this._evalBinaryOp(e,r):e instanceof ta?this._evalLiteral(e,r):e instanceof zc?this._evalVariable(e,r):e instanceof y5?this._evalCall(e,r):e instanceof wd?this._evalCreate(e,r):e instanceof E7?this._evalConst(e,r):e instanceof C7?this._evalBitcast(e,r):e instanceof Rs?this._evalUnaryOp(e,r):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var r;if(e instanceof jt){let n=this.reflection.getTypeInfo(e);if(n!==null)return n}let i=(r=this.typeInfo[e])!==null&&r!==void 0?r:null;return i!==null||(i=this.reflection.getTypeInfoByName(e)),i}_setOverrides(e,r){for(let i in e){let n=e[i],o=this.reflection.getOverrideInfo(i);o!==null?(o.type===null&&(o.type=this.getTypeInfo("u32")),o.type.name==="u32"||o.type.name==="i32"||o.type.name==="f32"||o.type.name==="f16"?r.setVariable(i,new ft(n,o.type)):o.type.name==="bool"?r.setVariable(i,new ft(n?1:0,o.type)):o.type.name==="vec2"||o.type.name==="vec3"||o.type.name==="vec4"||o.type.name==="vec2f"||o.type.name==="vec3f"||o.type.name==="vec4f"||o.type.name==="vec2i"||o.type.name==="vec3i"||o.type.name==="vec4i"||o.type.name==="vec2u"||o.type.name==="vec3u"||o.type.name==="vec4u"||o.type.name==="vec2h"||o.type.name==="vec3h"||o.type.name==="vec4h"?r.setVariable(i,new Fe(n,o.type)):console.error(`Invalid constant type for ${i}`)):console.error(`Override ${i} does not exist in the shader.`)}}_dispatchWorkgroup(e,r,i){let n=[1,1,1];for(let m of e.node.attributes)if(m.name==="workgroup_size"){if(m.value.length>0){let x=i.getVariableValue(m.value[0]);n[0]=x instanceof ft?x.value:parseInt(m.value[0])}if(m.value.length>1){let x=i.getVariableValue(m.value[1]);n[1]=x instanceof ft?x.value:parseInt(m.value[1])}if(m.value.length>2){let x=i.getVariableValue(m.value[2]);n[2]=x instanceof ft?x.value:parseInt(m.value[2])}}let o=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");i.setVariable("@workgroup_size",new Fe(n,o));let a=n[0],u=n[1],p=n[2];for(let m=0,x=0;m<p;++m)for(let M=0;M<u;++M)for(let k=0;k<a;++k,++x){let F=[k,M,m],j=[k+r[0]*n[0],M+r[1]*n[1],m+r[2]*n[2]];i.setVariable("@local_invocation_id",new Fe(F,o)),i.setVariable("@global_invocation_id",new Fe(j,o)),i.setVariable("@local_invocation_index",new ft(x,s)),this._dispatchExec(e,i)}}_dispatchExec(e,r){for(let i of e.node.args)for(let n of i.attributes)if(n.name==="builtin"){let o=`@${n.value}`,s=r.getVariable(o);s!==void 0&&r.variables.set(i.name,s)}this._execStatements(e.node.body,r)}getVariableName(e,r){for(;e instanceof Rs;)e=e.right;return e instanceof zc?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,r){for(let i of e){if(i instanceof Array){let o=r.clone(),s=this._execStatements(i,o);if(s)return s;continue}let n=this.execStatement(i,r);if(n)return n}return null}_call(e,r){let i=r.clone();i.currentFunctionName=e.name;let n=r.getFunction(e.name);if(n){for(let o=0;o<n.node.args.length;++o){let s=n.node.args[o],a=this.evalExpression(e.args[o],i);i.setVariable(s.name,a,s)}this._execStatements(n.node.body,i)}else e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)&&this._evalCreate(e,r)}_increment(e,r){let i=this.getVariableName(e.variable,r),n=r.getVariable(i);n?e.operator==="++"?n.value instanceof ft?n.value.value++:console.error(`Variable ${i} is not a scalar. Line ${e.line}`):e.operator==="--"?n.value instanceof ft?n.value.value--:console.error(`Variable ${i} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${i} not found. Line ${e.line}`)}_getVariableData(e,r){if(e instanceof zc){let i=this.getVariableName(e,r),n=r.getVariable(i);return n===null?(console.error(`Variable ${i} not found. Line ${e.line}`),null):n.value.getSubData(this,e.postfix,r)}if(e instanceof Rs){if(e.operator==="*"){let i=this._getVariableData(e.right,r);return i instanceof i_?i.reference.getSubData(this,e.postfix,r):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){let i=this._getVariableData(e.right,r);return new i_(i)}}return null}_assign(e,r){let i=null,n="<var>",o=null;if(e.variable instanceof Rs){let u=this._getVariableData(e.variable,r),p=this.evalExpression(e.value,r),m=e.operator;if(m==="="){if(u instanceof ft||u instanceof Fe||u instanceof pi){if(p instanceof ft||p instanceof Fe||p instanceof pi&&u.data.length===p.data.length)return void u.data.set(p.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(u instanceof wa&&p instanceof wa&&u.buffer.byteLength-u.offset>=p.buffer.byteLength-p.offset)return void(u.buffer.byteLength%4==0?new Uint32Array(u.buffer,u.offset,u.typeInfo.size/4).set(new Uint32Array(p.buffer,p.offset,p.typeInfo.size/4)):new Uint8Array(u.buffer,u.offset,u.typeInfo.size).set(new Uint8Array(p.buffer,p.offset,p.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(m==="+=")return u instanceof ft||u instanceof Fe||u instanceof pi?p instanceof ft||p instanceof Fe||p instanceof pi?void u.data.set(p.data.map((x,M)=>u.data[M]+x)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(m==="-=")return(u instanceof ft||u instanceof Fe||u instanceof pi)&&(p instanceof ft||p instanceof Fe||p instanceof pi)?void u.data.set(p.data.map((x,M)=>u.data[M]-x)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof Rs){if(e.variable.operator==="*"){n=this.getVariableName(e.variable.right,r);let u=r.getVariable(n);if(!(u&&u.value instanceof i_))return void console.error(`Variable ${n} is not a pointer. Line ${e.line}`);i=u.value.reference;let p=e.variable.postfix;if(!p){let m=e.variable.right;for(;m instanceof Rs;){if(m.postfix){p=m.postfix;break}m=m.right}}p&&(i=i.getSubData(this,p,r))}}else{o=e.variable.postfix,n=this.getVariableName(e.variable,r);let u=r.getVariable(n);if(u===null)return void console.error(`Variable ${n} not found. Line ${e.line}`);i=u.value}if(i instanceof i_&&(i=i.reference),i===null)return void console.error(`Variable ${n} not found. Line ${e.line}`);let s=this.evalExpression(e.value,r),a=e.operator;if(a!=="="){let u=i.getSubData(this,o,r);if(u instanceof Fe&&s instanceof ft){let p=u.data,m=s.value;if(a==="+=")for(let x=0;x<p.length;++x)p[x]+=m;else if(a==="-=")for(let x=0;x<p.length;++x)p[x]-=m;else if(a==="*=")for(let x=0;x<p.length;++x)p[x]*=m;else if(a==="/=")for(let x=0;x<p.length;++x)p[x]/=m;else if(a==="%=")for(let x=0;x<p.length;++x)p[x]%=m;else if(a==="&=")for(let x=0;x<p.length;++x)p[x]&=m;else if(a==="|=")for(let x=0;x<p.length;++x)p[x]|=m;else if(a==="^=")for(let x=0;x<p.length;++x)p[x]^=m;else if(a==="<<=")for(let x=0;x<p.length;++x)p[x]<<=m;else if(a===">>=")for(let x=0;x<p.length;++x)p[x]>>=m;else console.error(`Invalid operator ${a}. Line ${e.line}`)}else if(u instanceof Fe&&s instanceof Fe){let p=u.data,m=s.data;if(p.length!==m.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(a==="+=")for(let x=0;x<p.length;++x)p[x]+=m[x];else if(a==="-=")for(let x=0;x<p.length;++x)p[x]-=m[x];else if(a==="*=")for(let x=0;x<p.length;++x)p[x]*=m[x];else if(a==="/=")for(let x=0;x<p.length;++x)p[x]/=m[x];else if(a==="%=")for(let x=0;x<p.length;++x)p[x]%=m[x];else if(a==="&=")for(let x=0;x<p.length;++x)p[x]&=m[x];else if(a==="|=")for(let x=0;x<p.length;++x)p[x]|=m[x];else if(a==="^=")for(let x=0;x<p.length;++x)p[x]^=m[x];else if(a==="<<=")for(let x=0;x<p.length;++x)p[x]<<=m[x];else if(a===">>=")for(let x=0;x<p.length;++x)p[x]>>=m[x];else console.error(`Invalid operator ${a}. Line ${e.line}`)}else{if(!(u instanceof ft&&s instanceof ft))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);a==="+="?u.value+=s.value:a==="-="?u.value-=s.value:a==="*="?u.value*=s.value:a==="/="?u.value/=s.value:a==="%="?u.value%=s.value:a==="&="?u.value&=s.value:a==="|="?u.value|=s.value:a==="^="?u.value^=s.value:a==="<<="?u.value<<=s.value:a===">>="?u.value>>=s.value:console.error(`Invalid operator ${a}. Line ${e.line}`)}return void(i instanceof wa&&i.setDataValue(this,u,o,r))}if(i instanceof wa)i.setDataValue(this,s,o,r);else if(o){if(!(i instanceof Fe||i instanceof pi))return void console.error(`Variable ${n} is not a vector or matrix. Line ${e.line}`);if(o instanceof n_){let u=this.evalExpression(o.index,r).value;if(i instanceof Fe){if(!(s instanceof ft))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[u]=s.value}else{if(!(i instanceof pi))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);{let p=this.evalExpression(o.index,r).value;if(p<0)return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);if(!(s instanceof Fe))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);{let m=i.typeInfo.getTypeName();if(m==="mat2x2"||m==="mat2x2f"||m==="mat2x2h"){if(!(p<2&&s.data.length===2))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[2*p]=s.data[0],i.data[2*p+1]=s.data[1]}else if(m==="mat2x3"||m==="mat2x3f"||m==="mat2x3h"){if(!(p<2&&s.data.length===3))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[3*p]=s.data[0],i.data[3*p+1]=s.data[1],i.data[3*p+2]=s.data[2]}else if(m==="mat2x4"||m==="mat2x4f"||m==="mat2x4h"){if(!(p<2&&s.data.length===4))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[4*p]=s.data[0],i.data[4*p+1]=s.data[1],i.data[4*p+2]=s.data[2],i.data[4*p+3]=s.data[3]}else if(m==="mat3x2"||m==="mat3x2f"||m==="mat3x2h"){if(!(p<3&&s.data.length===2))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[2*p]=s.data[0],i.data[2*p+1]=s.data[1]}else if(m==="mat3x3"||m==="mat3x3f"||m==="mat3x3h"){if(!(p<3&&s.data.length===3))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[3*p]=s.data[0],i.data[3*p+1]=s.data[1],i.data[3*p+2]=s.data[2]}else if(m==="mat3x4"||m==="mat3x4f"||m==="mat3x4h"){if(!(p<3&&s.data.length===4))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[4*p]=s.data[0],i.data[4*p+1]=s.data[1],i.data[4*p+2]=s.data[2],i.data[4*p+3]=s.data[3]}else if(m==="mat4x2"||m==="mat4x2f"||m==="mat4x2h"){if(!(p<4&&s.data.length===2))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[2*p]=s.data[0],i.data[2*p+1]=s.data[1]}else if(m==="mat4x3"||m==="mat4x3f"||m==="mat4x3h"){if(!(p<4&&s.data.length===3))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[3*p]=s.data[0],i.data[3*p+1]=s.data[1],i.data[3*p+2]=s.data[2]}else{if(m!=="mat4x4"&&m!=="mat4x4f"&&m!=="mat4x4h")return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);if(!(p<4&&s.data.length===4))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);i.data[4*p]=s.data[0],i.data[4*p+1]=s.data[1],i.data[4*p+2]=s.data[2],i.data[4*p+3]=s.data[3]}}}}}else if(o instanceof Ag){let u=o.value;if(!(i instanceof Fe))return void console.error(`Invalid assignment to ${u}. Variable ${n} is not a vector. Line ${e.line}`);if(s instanceof ft){if(u.length>1)return void console.error(`Invalid assignment to ${u} for variable ${n}. Line ${e.line}`);if(u==="x")i.data[0]=s.value;else if(u==="y"){if(i.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${n}. Line ${e.line}`);i.data[1]=s.value}else if(u==="z"){if(i.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${n}. Line ${e.line}`);i.data[2]=s.value}else if(u==="w"){if(i.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${n}. Line ${e.line}`);i.data[3]=s.value}}else{if(!(s instanceof Fe))return void console.error(`Invalid assignment to ${n}. Line ${e.line}`);if(u.length!==s.data.length)return void console.error(`Invalid assignment to ${u} for variable ${n}. Line ${e.line}`);for(let p=0;p<u.length;++p){let m=u[p];if(m==="x"||m==="r")i.data[0]=s.data[p];else if(m==="y"||m==="g"){if(s.data.length<2)return void console.error(`Invalid assignment to ${m} for variable ${n}. Line ${e.line}`);i.data[1]=s.data[p]}else if(m==="z"||m==="b"){if(s.data.length<3)return void console.error(`Invalid assignment to ${m} for variable ${n}. Line ${e.line}`);i.data[2]=s.data[p]}else{if(m!=="w"&&m!=="a")return void console.error(`Invalid assignment to ${m} for variable ${n}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${m} for variable ${n}. Line ${e.line}`);i.data[3]=s.data[p]}}}}}else i instanceof ft&&s instanceof ft?i.value=s.value:i instanceof Fe&&s instanceof Fe||i instanceof pi&&s instanceof pi?i.data.set(s.data):console.error(`Invalid assignment to ${n}. Line ${e.line}`)}_function(e,r){let i=new JX(e);r.functions.set(e.name,i)}_const(e,r){let i=null;e.value!==null&&(i=this.evalExpression(e.value,r)),r.createVariable(e.name,i,e)}_let(e,r){let i=null;if(e.value!==null){if(i=this.evalExpression(e.value,r),i===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Rs||(i=i.clone())}else{let n=e.type.name;if(n==="f32"||n==="i32"||n==="u32"||n==="bool"||n==="f16"||n==="vec2"||n==="vec3"||n==="vec4"||n==="vec2f"||n==="vec3f"||n==="vec4f"||n==="vec2i"||n==="vec3i"||n==="vec4i"||n==="vec2u"||n==="vec3u"||n==="vec4u"||n==="vec2h"||n==="vec3h"||n==="vec4h"||n==="vec2b"||n==="vec3b"||n==="vec4b"||n==="mat2x2"||n==="mat2x3"||n==="mat2x4"||n==="mat3x2"||n==="mat3x3"||n==="mat3x4"||n==="mat4x2"||n==="mat4x3"||n==="mat4x4"||n==="mat2x2f"||n==="mat2x3f"||n==="mat2x4f"||n==="mat3x2f"||n==="mat3x3f"||n==="mat3x4f"||n==="mat4x2f"||n==="mat4x3f"||n==="mat4x4f"||n==="mat2x2h"||n==="mat2x3h"||n==="mat2x4h"||n==="mat3x2h"||n==="mat3x3h"||n==="mat3x4h"||n==="mat4x2h"||n==="mat4x3h"||n==="mat4x4h"||n==="array"){let o=new wd(e.type,[]);i=this._evalCreate(o,r)}}r.createVariable(e.name,i,e)}_var(e,r){let i=null;if(e.value!==null){if(i=this.evalExpression(e.value,r),i===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Rs||(i=i.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);let n=e.type.name;if(n==="f32"||n==="i32"||n==="u32"||n==="bool"||n==="f16"||n==="vec2"||n==="vec3"||n==="vec4"||n==="vec2f"||n==="vec3f"||n==="vec4f"||n==="vec2i"||n==="vec3i"||n==="vec4i"||n==="vec2u"||n==="vec3u"||n==="vec4u"||n==="vec2h"||n==="vec3h"||n==="vec4h"||n==="vec2b"||n==="vec3b"||n==="vec4b"||n==="mat2x2"||n==="mat2x3"||n==="mat2x4"||n==="mat3x2"||n==="mat3x3"||n==="mat3x4"||n==="mat4x2"||n==="mat4x3"||n==="mat4x4"||n==="mat2x2f"||n==="mat2x3f"||n==="mat2x4f"||n==="mat3x2f"||n==="mat3x3f"||n==="mat3x4f"||n==="mat4x2f"||n==="mat4x3f"||n==="mat4x4f"||n==="mat2x2h"||n==="mat2x3h"||n==="mat2x4h"||n==="mat3x2h"||n==="mat3x3h"||n==="mat3x4h"||n==="mat4x2h"||n==="mat4x3h"||n==="mat4x4h"||e.type instanceof K1||e.type instanceof Ff||e.type instanceof pt){let o=new wd(e.type,[]);i=this._evalCreate(o,r)}}r.createVariable(e.name,i,e)}_switch(e,r){r=r.clone();let i=this.evalExpression(e.condition,r);if(!(i instanceof ft))return console.error(`Invalid if condition. Line ${e.line}`),null;let n=null;for(let o of e.cases)if(o instanceof k7)for(let s of o.selectors){if(s instanceof _3){n=o;continue}let a=this.evalExpression(s,r);if(!(a instanceof ft))return console.error(`Invalid case selector. Line ${e.line}`),null;if(a.value===i.value)return this._execStatements(o.body,r)}else o instanceof R7&&(n=o);return n?this._execStatements(n.body,r):null}_if(e,r){r=r.clone();let i=this.evalExpression(e.condition,r);if(!(i instanceof ft))return console.error(`Invalid if condition. Line ${e.line}`),null;if(i.value)return this._execStatements(e.body,r);for(let n of e.elseif){let o=this.evalExpression(n.condition,r);if(!(o instanceof ft))return console.error(`Invalid if condition. Line ${e.line}`),null;if(o.value)return this._execStatements(n.body,r)}return e.else?this._execStatements(e.else,r):null}_getScalarValue(e){return e instanceof ft?e.value:(console.error("Expected scalar value.",e),0)}_for(e,r){for(r=r.clone(),this.execStatement(e.init,r);this._getScalarValue(this.evalExpression(e.condition,r));){let i=this._execStatements(e.body,r);if(i===t._breakObj)break;if(i!==null&&i!==t._continueObj)return i;this.execStatement(e.increment,r)}return null}_loop(e,r){for(r=r.clone();;){let i=this._execStatements(e.body,r);if(i===t._breakObj)break;if(i===t._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,r)===t._breakObj)break}else if(i!==null)return i}return null}_while(e,r){for(r=r.clone();this._getScalarValue(this.evalExpression(e.condition,r));){let i=this._execStatements(e.body,r);if(i===t._breakObj)break;if(i!==t._continueObj&&i!==null)return i}return null}_evalBitcast(e,r){let i=this.evalExpression(e.value,r),n=e.type;if(i instanceof ft){let o=cye(i.value,i.typeInfo.name,n.name);return new ft(o,this.getTypeInfo(n))}if(i instanceof Fe){let o=i.typeInfo.getTypeName(),s="";if(o.endsWith("f"))s="f32";else if(o.endsWith("i"))s="i32";else if(o.endsWith("u"))s="u32";else if(o.endsWith("b"))s="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${o}. Line ${e.line}`),null;s="f16"}let a=n.getTypeName(),u="";if(a.endsWith("f"))u="f32";else if(a.endsWith("i"))u="i32";else if(a.endsWith("u"))u="u32";else if(a.endsWith("b"))u="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${u}. Line ${e.line}`),null;u="f16"}let p=(function(m,x,M){if(x===M)return m;let k=new Array(m.length);for(let F=0;F<m.length;F++)k[F]=cye(m[F],x,M);return k})(Array.from(i.data),s,u);return new Fe(p,this.getTypeInfo(n))}return console.error(`TODO: bitcast for ${i.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,r){return r.getVariableValue(e.name).clone().getSubData(this,e.postfix,r)}_evalCreate(e,r){var i;if(e instanceof wd){if(e.type===null)return _5.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,r);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,r);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,r)}}let n=e instanceof wd?e.type.name:e.name,o=e instanceof wd?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(o===null)return console.error(`Unknown type ${n}. Line ${e.line}`),null;if(o.size===0)return null;let s=new wa(new ArrayBuffer(o.size),o,0);if(o instanceof f0){if(e.args)for(let a=0;a<e.args.length;++a){let u=o.members[a],p=e.args[a],m=this.evalExpression(p,r);s.setData(this,m,u.type,u.offset,r)}}else if(o instanceof p0){let a=0;if(e.args)for(let u=0;u<e.args.length;++u){let p=e.args[u],m=this.evalExpression(p,r);o.format===null&&(((i=m.typeInfo)===null||i===void 0?void 0:i.name)==="x32"?o.format=this.getTypeInfo("i32"):o.format=m.typeInfo),s.setData(this,m,o.format,a,r),a+=o.stride}}else console.error(`Unknown type "${n}". Line ${e.line}`);return e instanceof wd?s.getSubData(this,e.postfix,r):s}_evalLiteral(e,r){let i=this.getTypeInfo(e.type),n=i.name;return n==="x32"||n==="u32"||n==="f32"||n==="f16"||n==="i32"||n==="bool"?new ft(e.scalarValue,i):n==="vec2"||n==="vec3"||n==="vec4"||n==="vec2f"||n==="vec3f"||n==="vec4f"||n==="vec2h"||n==="vec3h"||n==="vec4h"||n==="vec2i"||n==="vec3i"||n==="vec4i"||n==="vec2u"||n==="vec3u"||n==="vec4u"?this._callConstructorVec(e,r):n==="mat2x2"||n==="mat2x3"||n==="mat2x4"||n==="mat3x2"||n==="mat3x3"||n==="mat3x4"||n==="mat4x2"||n==="mat4x3"||n==="mat4x4"||n==="mat2x2f"||n==="mat2x3f"||n==="mat2x4f"||n==="mat3x2f"||n==="mat3x3f"||n==="mat3x4f"||n==="mat4x2f"||n==="mat4x3f"||n==="mat4x4f"||n==="mat2x2h"||n==="mat2x3h"||n==="mat2x4h"||n==="mat3x2h"||n==="mat3x3h"||n==="mat3x4h"||n==="mat4x2h"||n==="mat4x3h"||n==="mat4x4h"?this._callConstructorMatrix(e,r):e.value}_evalVariable(e,r){let i=r.getVariableValue(e.name);return i===null?i:i.getSubData(this,e.postfix,r)}_maxFormatTypeInfo(e){let r=e[0];if(r.name==="f32")return r;for(let i=1;i<e.length;++i){let n=t._priority.get(r.name);t._priority.get(e[i].name)<n&&(r=e[i])}return r.name==="x32"?this.getTypeInfo("i32"):r}_evalUnaryOp(e,r){let i=this.evalExpression(e.right,r);if(e.operator==="&")return new i_(i);if(e.operator==="*")return i instanceof i_?i.reference.getSubData(this,e.postfix,r):(console.error(`Invalid dereference. Line ${e.line}`),null);let n=i instanceof ft?i.value:i instanceof Fe?Array.from(i.data):null;switch(e.operator){case"+":{if(fr(n)){let a=n.map((u,p)=>+u);return new Fe(a,i.typeInfo)}let o=n,s=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new ft(+o,s)}case"-":{if(fr(n)){let a=n.map((u,p)=>-u);return new Fe(a,i.typeInfo)}let o=n,s=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new ft(-o,s)}case"!":{if(fr(n)){let a=n.map((u,p)=>u?0:1);return new Fe(a,i.typeInfo)}let o=n,s=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new ft(o?0:1,s)}case"~":{if(fr(n)){let a=n.map((u,p)=>~u);return new Fe(a,i.typeInfo)}let o=n,s=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new ft(~o,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,r){let i=this.evalExpression(e.left,r),n=this.evalExpression(e.right,r),o=i instanceof ft?i.value:i instanceof Fe||i instanceof pi?Array.from(i.data):null,s=n instanceof ft?n.value:n instanceof Fe||n instanceof pi?Array.from(n.data):null;switch(e.operator){case"+":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k+x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M+m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m+M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a+u,p)}case"-":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k-x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M-m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m-M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a-u,p)}case"*":{if(fr(o)&&fr(s)){let m=o,x=s;if(i instanceof pi&&n instanceof pi){let M=(function(H,W,Z,Y){if(Nc[W.name]===void 0||Nc[Y.name]===void 0)return null;let ee=Nc[W.name][0],ce=Nc[W.name][1],ge=Nc[Y.name][0];if(ee!==Nc[Y.name][1])return null;let Se=new Array(ge*ce);for(let ne=0;ne<ce;ne++)for(let pe=0;pe<ge;pe++){let ue=0;for(let Le=0;Le<ee;Le++)ue+=H[Le*ce+ne]*Z[pe*ee+Le];Se[ne*ge+pe]=ue}return Se})(m,i.typeInfo,x,n.typeInfo);if(M===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;let k=Nc[n.typeInfo.name][0],F=Nc[i.typeInfo.name][1],j=this.getTypeInfo(`mat${k}x${F}f`);return new pi(M,j)}if(i instanceof pi&&n instanceof Fe){let M=(function(k,F,j,H){if(Nc[F.name]===void 0||NX[H.name]===void 0)return null;let W=Nc[F.name][0],Z=Nc[F.name][1];if(W!==j.length)return null;let Y=new Array(Z);for(let ee=0;ee<Z;ee++){let ce=0;for(let ge=0;ge<W;ge++)ce+=k[ge*Z+ee]*j[ge];Y[ee]=ce}return Y})(m,i.typeInfo,x,n.typeInfo);return M===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Fe(M,n.typeInfo)}if(i instanceof Fe&&n instanceof pi){let M=(function(k,F,j,H){if(NX[F.name]===void 0||Nc[H.name]===void 0)return null;let W=Nc[H.name][0],Z=Nc[H.name][1];if(Z!==k.length)return null;let Y=[];for(let ee=0;ee<W;ee++){let ce=0;for(let ge=0;ge<Z;ge++)ce+=k[ge]*j[ge*W+ee];Y[ee]=ce}return Y})(m,i.typeInfo,x,n.typeInfo);return M===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Fe(M,i.typeInfo)}{if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k*x[F]);return new Fe(M,i.typeInfo)}}if(fr(o)){let m=s,x=o.map((M,k)=>M*m);return i instanceof pi?new pi(x,i.typeInfo):new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m*M);return n instanceof pi?new pi(x,n.typeInfo):new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a*u,p)}case"%":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k%x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M%m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m%M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a%u,p)}case"/":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k/x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M/m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m/M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a/u,p)}case"&":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k&x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M&m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m&M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a&u,p)}case"|":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k|x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M|m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m|M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a|u,p)}case"^":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k^x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M^m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m^M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a^u,p)}case"<<":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k<<x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M<<m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m<<M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a<<u,p)}case">>":{if(fr(o)&&fr(s)){let m=o,x=s;if(m.length!==x.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let M=m.map((k,F)=>k>>x[F]);return new Fe(M,i.typeInfo)}if(fr(o)){let m=s,x=o.map((M,k)=>M>>m);return new Fe(x,i.typeInfo)}if(fr(s)){let m=o,x=s.map((M,k)=>m>>M);return new Fe(x,n.typeInfo)}let a=o,u=s,p=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new ft(a>>u,p)}case">":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m>u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p>a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a>p?1:0);return new Fe(u,n.typeInfo)}return new ft(o>s?1:0,this.getTypeInfo("bool"));case"<":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m<u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p<a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a<p?1:0);return new Fe(u,n.typeInfo)}return new ft(o<s?1:0,this.getTypeInfo("bool"));case"==":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m===u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p==a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a==p?1:0);return new Fe(u,n.typeInfo)}return new ft(o===s?1:0,this.getTypeInfo("bool"));case"!=":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m!==u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p!==a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a!==p?1:0);return new Fe(u,n.typeInfo)}return new ft(o!==s?1:0,this.getTypeInfo("bool"));case">=":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m>=u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p>=a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a>=p?1:0);return new Fe(u,n.typeInfo)}return new ft(o>=s?1:0,this.getTypeInfo("bool"));case"<=":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m<=u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p<=a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a<=p?1:0);return new Fe(u,n.typeInfo)}return new ft(o<=s?1:0,this.getTypeInfo("bool"));case"&&":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m&&u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p&&a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a&&p?1:0);return new Fe(u,n.typeInfo)}return new ft(o&&s?1:0,this.getTypeInfo("bool"));case"||":if(fr(o)&&fr(s)){let a=o,u=s;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;let p=a.map((m,x)=>m||u[x]?1:0);return new Fe(p,i.typeInfo)}if(fr(o)){let a=s,u=o.map((p,m)=>p||a?1:0);return new Fe(u,i.typeInfo)}if(fr(s)){let a=o,u=s.map((p,m)=>a||p?1:0);return new Fe(u,n.typeInfo)}return new ft(o||s?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,r){if(e.cachedReturnValue!==null)return e.cachedReturnValue;let i=r.clone();i.currentFunctionName=e.name;let n=r.getFunction(e.name);if(!n)return e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)?this._evalCreate(e,r):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let o=0;o<n.node.args.length;++o){let s=n.node.args[o],a=this.evalExpression(e.args[o],i);i.createVariable(s.name,a,s)}return this._execStatements(n.node.body,i)}_callBuiltinFunction(e,r){switch(e.name){case"all":return this.builtins.All(e,r);case"any":return this.builtins.Any(e,r);case"select":return this.builtins.Select(e,r);case"arrayLength":return this.builtins.ArrayLength(e,r);case"abs":return this.builtins.Abs(e,r);case"acos":return this.builtins.Acos(e,r);case"acosh":return this.builtins.Acosh(e,r);case"asin":return this.builtins.Asin(e,r);case"asinh":return this.builtins.Asinh(e,r);case"atan":return this.builtins.Atan(e,r);case"atanh":return this.builtins.Atanh(e,r);case"atan2":return this.builtins.Atan2(e,r);case"ceil":return this.builtins.Ceil(e,r);case"clamp":return this.builtins.Clamp(e,r);case"cos":return this.builtins.Cos(e,r);case"cosh":return this.builtins.Cosh(e,r);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,r);case"countOneBits":return this.builtins.CountOneBits(e,r);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,r);case"cross":return this.builtins.Cross(e,r);case"degrees":return this.builtins.Degrees(e,r);case"determinant":return this.builtins.Determinant(e,r);case"distance":return this.builtins.Distance(e,r);case"dot":return this.builtins.Dot(e,r);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,r);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,r);case"exp":return this.builtins.Exp(e,r);case"exp2":return this.builtins.Exp2(e,r);case"extractBits":return this.builtins.ExtractBits(e,r);case"faceForward":return this.builtins.FaceForward(e,r);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,r);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,r);case"floor":return this.builtins.Floor(e,r);case"fma":return this.builtins.Fma(e,r);case"fract":return this.builtins.Fract(e,r);case"frexp":return this.builtins.Frexp(e,r);case"insertBits":return this.builtins.InsertBits(e,r);case"inverseSqrt":return this.builtins.InverseSqrt(e,r);case"ldexp":return this.builtins.Ldexp(e,r);case"length":return this.builtins.Length(e,r);case"log":return this.builtins.Log(e,r);case"log2":return this.builtins.Log2(e,r);case"max":return this.builtins.Max(e,r);case"min":return this.builtins.Min(e,r);case"mix":return this.builtins.Mix(e,r);case"modf":return this.builtins.Modf(e,r);case"normalize":return this.builtins.Normalize(e,r);case"pow":return this.builtins.Pow(e,r);case"quantizeToF16":return this.builtins.QuantizeToF16(e,r);case"radians":return this.builtins.Radians(e,r);case"reflect":return this.builtins.Reflect(e,r);case"refract":return this.builtins.Refract(e,r);case"reverseBits":return this.builtins.ReverseBits(e,r);case"round":return this.builtins.Round(e,r);case"saturate":return this.builtins.Saturate(e,r);case"sign":return this.builtins.Sign(e,r);case"sin":return this.builtins.Sin(e,r);case"sinh":return this.builtins.Sinh(e,r);case"smoothstep":return this.builtins.SmoothStep(e,r);case"sqrt":return this.builtins.Sqrt(e,r);case"step":return this.builtins.Step(e,r);case"tan":return this.builtins.Tan(e,r);case"tanh":return this.builtins.Tanh(e,r);case"transpose":return this.builtins.Transpose(e,r);case"trunc":return this.builtins.Trunc(e,r);case"dpdx":return this.builtins.Dpdx(e,r);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,r);case"dpdxFine":return this.builtins.DpdxFine(e,r);case"dpdy":return this.builtins.Dpdy(e,r);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,r);case"dpdyFine":return this.builtins.DpdyFine(e,r);case"fwidth":return this.builtins.Fwidth(e,r);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,r);case"fwidthFine":return this.builtins.FwidthFine(e,r);case"textureDimensions":return this.builtins.TextureDimensions(e,r);case"textureGather":return this.builtins.TextureGather(e,r);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,r);case"textureLoad":return this.builtins.TextureLoad(e,r);case"textureNumLayers":return this.builtins.TextureNumLayers(e,r);case"textureNumLevels":return this.builtins.TextureNumLevels(e,r);case"textureNumSamples":return this.builtins.TextureNumSamples(e,r);case"textureSample":return this.builtins.TextureSample(e,r);case"textureSampleBias":return this.builtins.TextureSampleBias(e,r);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,r);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,r);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,r);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,r);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,r);case"textureStore":return this.builtins.TextureStore(e,r);case"atomicLoad":return this.builtins.AtomicLoad(e,r);case"atomicStore":return this.builtins.AtomicStore(e,r);case"atomicAdd":return this.builtins.AtomicAdd(e,r);case"atomicSub":return this.builtins.AtomicSub(e,r);case"atomicMax":return this.builtins.AtomicMax(e,r);case"atomicMin":return this.builtins.AtomicMin(e,r);case"atomicAnd":return this.builtins.AtomicAnd(e,r);case"atomicOr":return this.builtins.AtomicOr(e,r);case"atomicXor":return this.builtins.AtomicXor(e,r);case"atomicExchange":return this.builtins.AtomicExchange(e,r);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,r);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,r);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,r);case"pack4xI8":return this.builtins.Pack4xI8(e,r);case"pack4xU8":return this.builtins.Pack4xU8(e,r);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,r);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,r);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,r);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,r);case"pack2x16float":return this.builtins.Pack2x16float(e,r);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,r);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,r);case"unpack4xI8":return this.builtins.Unpack4xI8(e,r);case"unpack4xU8":return this.builtins.Unpack4xU8(e,r);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,r);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,r);case"unpack2x16float":return this.builtins.Unpack2x16float(e,r);case"storageBarrier":return this.builtins.StorageBarrier(e,r);case"textureBarrier":return this.builtins.TextureBarrier(e,r);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,r);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,r);case"subgroupAdd":return this.builtins.SubgroupAdd(e,r);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,r);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,r);case"subgroupAll":return this.builtins.SubgroupAll(e,r);case"subgroupAnd":return this.builtins.SubgroupAnd(e,r);case"subgroupAny":return this.builtins.SubgroupAny(e,r);case"subgroupBallot":return this.builtins.SubgroupBallot(e,r);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,r);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,r);case"subgroupElect":return this.builtins.SubgroupElect(e,r);case"subgroupMax":return this.builtins.SubgroupMax(e,r);case"subgroupMin":return this.builtins.SubgroupMin(e,r);case"subgroupMul":return this.builtins.SubgroupMul(e,r);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,r);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,r);case"subgroupOr":return this.builtins.SubgroupOr(e,r);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,r);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,r);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,r);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,r);case"subgroupXor":return this.builtins.SubgroupXor(e,r);case"quadBroadcast":return this.builtins.QuadBroadcast(e,r);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,r);case"quadSwapX":return this.builtins.QuadSwapX(e,r);case"quadSwapY":return this.builtins.QuadSwapY(e,r)}let i=r.getFunction(e.name);if(i){let n=r.clone();for(let o=0;o<i.node.args.length;++o){let s=i.node.args[o],a=this.evalExpression(e.args[o],n);n.setVariable(s.name,a,s)}return this._execStatements(i.node.body,n)}return null}_callConstructorValue(e,r){if(!e.args||e.args.length===0)return new ft(0,this.getTypeInfo(e.type));let i=this.evalExpression(e.args[0],r);return i.typeInfo=this.getTypeInfo(e.type),i.getSubData(this,e.postfix,r).clone()}_callConstructorVec(e,r){let i=this.getTypeInfo(e.type),n=e.type.getTypeName(),o=NX[n];if(o===void 0)return console.error(`Invalid vec constructor ${n}. Line ${e.line}`),null;let s=[];if(e instanceof ta)if(e.isVector){let a=e.vectorValue;for(let u of a)s.push(u)}else s.push(e.scalarValue);else if(e.args)for(let a of e.args){let u=this.evalExpression(a,r);if(u instanceof Fe){let p=u.data;for(let m=0;m<p.length;++m){let x=p[m];s.push(x)}}else if(u instanceof ft){let p=u.value;s.push(p)}}if(e.type instanceof pt&&e.type.format===null&&(e.type.format=pt.f32),s.length===0){let a=new Array(o).fill(0);return new Fe(a,i).getSubData(this,e.postfix,r)}if(s.length===1)for(;s.length<o;)s.push(s[0]);return s.length<o?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new Fe(s.length>o?s.slice(0,o):s,i).getSubData(this,e.postfix,r)}_callConstructorMatrix(e,r){let i=this.getTypeInfo(e.type),n=e.type.getTypeName(),o=Nc[n];if(o===void 0)return console.error(`Invalid matrix constructor ${n}. Line ${e.line}`),null;let s=[];if(e instanceof ta)if(e.isVector){let a=e.vectorValue;for(let u of a)s.push(u)}else s.push(e.scalarValue);else if(e.args)for(let a of e.args){let u=this.evalExpression(a,r);u instanceof Fe?s.push(...u.data):u instanceof ft?s.push(u.value):u instanceof pi&&s.push(...u.data)}if(i instanceof gg&&i.format===null&&(i.format=this.getTypeInfo("f32")),s.length===0){let a=new Array(o[2]).fill(0);return new pi(a,i).getSubData(this,e.postfix,r)}return s.length!==o[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new pi(s,i).getSubData(this,e.postfix,r)}};v3._breakObj=new Td(new Tu("BREAK",null),null),v3._continueObj=new Td(new Tu("CONTINUE",null),null),v3._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);var iZ=class{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}},nZ=class{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new iZ,this._exec=new v3,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;let r=[];for(;!this._isAtEnd();){let i=this._global_decl_or_directive();if(!i)break;r.push(i)}if(this._deferArrayCountEval.length>0){for(let i of this._deferArrayCountEval){let n=i.arrayType,o=i.countNode;if(o instanceof zc){let s=o.name,a=this._context.constants.get(s);if(a)try{let u=a.constEvaluate(this._exec);n.count=u}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(let i of r)i.search(n=>{n instanceof D7||n instanceof y3?n.type=this._forwardType(n.type):n instanceof K1?n.format=this._forwardType(n.format):n instanceof Nf||n instanceof Z1||n instanceof A3?n.type=this._forwardType(n.type):n instanceof J1?n.returnType=this._forwardType(n.returnType):n instanceof O7&&(n.type=this._forwardType(n.type))});return r}_forwardType(e){if(e instanceof M7){let r=this._getType(e.name);if(r)return r}else e instanceof y3?e.type=this._forwardType(e.type):e instanceof K1&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){let r=new ZX(e);this._tokens=r.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,r){return e.line=r??this._currentLine,e}_error(e,r){return{token:e,message:r,toString:()=>`${r}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==Pe.eof}_match(e){if(e instanceof ht)return!!this._check(e)&&(this._advance(),!0);for(let r=0,i=e.length;r<i;++r){let n=e[r];if(this._check(n))return this._advance(),!0}return!1}_consume(e,r){if(this._check(e))return this._advance();throw this._error(this._peek(),`${r}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;let r=this._peek();if(e instanceof Array){let i=r.type,n=!1;for(let o of e){if(i===o)return!0;o===Pe.tokens.name&&(n=!0)}if(n){let o=Pe.tokens.name.rule.exec(r.lexeme);if(o&&o.index==0&&o[0]==r.lexeme)return!0}return!1}if(r.type===e)return!0;if(e===Pe.tokens.name){let i=Pe.tokens.name.rule.exec(r.lexeme);return i&&i.index==0&&i[0]==r.lexeme}return!1}_advance(){var e,r;return this._currentLine=(r=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(Pe.tokens.semicolon)&&!this._isAtEnd(););if(this._match(Pe.keywords.alias)){let r=this._type_alias();return this._consume(Pe.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(Pe.keywords.diagnostic)){let r=this._diagnostic();return this._consume(Pe.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(Pe.keywords.requires)){let r=this._requires_directive();return this._consume(Pe.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(Pe.keywords.enable)){let r=this._enable_directive();return this._consume(Pe.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}let e=this._attribute();if(this._check(Pe.keywords.var)){let r=this._global_variable_decl();return r!=null&&(r.attributes=e),this._consume(Pe.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(Pe.keywords.override)){let r=this._override_variable_decl();return r!=null&&(r.attributes=e),this._consume(Pe.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(Pe.keywords.let)){let r=this._global_let_decl();return r!=null&&(r.attributes=e),this._consume(Pe.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(Pe.keywords.const)){let r=this._global_const_decl();return r!=null&&(r.attributes=e),this._consume(Pe.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(Pe.keywords.struct)){let r=this._struct_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}if(this._check(Pe.keywords.fn)){let r=this._function_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}return null}_function_decl(){if(!this._match(Pe.keywords.fn))return null;let e=this._currentLine,r=this._consume(Pe.tokens.ident,"Expected function name.").toString();this._consume(Pe.tokens.paren_left,"Expected '(' for function arguments.");let i=[];if(!this._check(Pe.tokens.paren_right))do{if(this._check(Pe.tokens.paren_right))break;let a=this._attribute(),u=this._consume(Pe.tokens.name,"Expected argument name.").toString();this._consume(Pe.tokens.colon,"Expected ':' for argument type.");let p=this._attribute(),m=this._type_decl();m!=null&&(m.attributes=p,i.push(this._updateNode(new O7(u,m,a))))}while(this._match(Pe.tokens.comma));this._consume(Pe.tokens.paren_right,"Expected ')' after function arguments.");let n=null;if(this._match(Pe.tokens.arrow)){let a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}let o=this._compound_statement(),s=this._currentLine;return this._updateNode(new J1(r,i,n,o,e,s),e)}_compound_statement(){let e=[];for(this._consume(Pe.tokens.brace_left,"Expected '{' for block.");!this._check(Pe.tokens.brace_right);){let r=this._statement();r!==null&&e.push(r)}return this._consume(Pe.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(Pe.tokens.semicolon)&&!this._isAtEnd(););if(this._check(Pe.tokens.attr)&&this._attribute(),this._check(Pe.keywords.if))return this._if_statement();if(this._check(Pe.keywords.switch))return this._switch_statement();if(this._check(Pe.keywords.loop))return this._loop_statement();if(this._check(Pe.keywords.for))return this._for_statement();if(this._check(Pe.keywords.while))return this._while_statement();if(this._check(Pe.keywords.continuing))return this._continuing_statement();if(this._check(Pe.keywords.static_assert))return this._static_assert_statement();if(this._check(Pe.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(Pe.keywords.return))e=this._return_statement();else if(this._check([Pe.keywords.var,Pe.keywords.let,Pe.keywords.const]))e=this._variable_statement();else if(this._match(Pe.keywords.discard))e=this._updateNode(new YX);else if(this._match(Pe.keywords.break)){let r=this._updateNode(new S7);if(this._currentLoop.length>0){let i=this._currentLoop[this._currentLoop.length-1];r.loopId=i.id}e=r,this._check(Pe.keywords.if)&&(this._advance(),r.condition=this._optional_paren_expression())}else if(this._match(Pe.keywords.continue)){let r=this._updateNode(new T7);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${r.line}`);{let i=this._currentLoop[this._currentLoop.length-1];r.loopId=i.id}e=r}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(Pe.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(Pe.keywords.static_assert))return null;let e=this._currentLine,r=this._optional_paren_expression();return this._updateNode(new GX(r),e)}_while_statement(){if(!this._match(Pe.keywords.while))return null;let e=this._updateNode(new m7(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(Pe.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){let e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(Pe.keywords.continuing))return null;let r=this._currentLine,i=this._compound_statement();return this._updateNode(new p5(i,e),r)}_for_statement(){if(!this._match(Pe.keywords.for))return null;this._consume(Pe.tokens.paren_left,"Expected '('.");let e=this._updateNode(new g7(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(Pe.tokens.semicolon)?null:this._for_init(),this._consume(Pe.tokens.semicolon,"Expected ';'."),e.condition=this._check(Pe.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(Pe.tokens.semicolon,"Expected ';'."),e.increment=this._check(Pe.tokens.paren_right)?null:this._for_increment(),this._consume(Pe.tokens.paren_right,"Expected ')'."),this._check(Pe.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(Pe.keywords.var)){let e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(Pe.tokens.equal)&&(r=this._short_circuit_or_expression()),this._updateNode(new Nf(e.name,e.type,e.storage,e.access,r),e.line)}if(this._match(Pe.keywords.let)){let e=this._currentLine,r=this._consume(Pe.tokens.name,"Expected name for let.").toString(),i=null;if(this._match(Pe.tokens.colon)){let o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}this._consume(Pe.tokens.equal,"Expected '=' for let.");let n=this._short_circuit_or_expression();return this._updateNode(new Z1(r,i,null,null,n),e)}if(this._match(Pe.keywords.const)){let e=this._currentLine,r=this._consume(Pe.tokens.name,"Expected name for const.").toString(),i=null;if(this._match(Pe.tokens.colon)){let o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}this._consume(Pe.tokens.equal,"Expected '=' for const.");let n=this._short_circuit_or_expression();return i===null&&n instanceof ta&&(i=n.type),this._updateNode(new A3(r,i,null,null,n),e)}return null}_increment_decrement_statement(){let e=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(Pe.increment_operators))return this._current=e,null;let i=this._consume(Pe.increment_operators,"Expected increment operator");return this._updateNode(new A7(i.type===Pe.tokens.plus_plus?m3.increment:m3.decrement,r))}_assignment_statement(){let e=null,r=this._currentLine;if(this._check(Pe.tokens.brace_right))return null;let i=this._match(Pe.tokens.underscore);if(i||(e=this._unary_expression()),!i&&e==null)return null;let n=this._consume(Pe.assignment_operators,"Expected assignment operator."),o=this._short_circuit_or_expression();return this._updateNode(new y7(d5.parse(n.lexeme),e,o),r)}_func_call_statement(){if(!this._check(Pe.tokens.ident))return null;let e=this._currentLine,r=this._current,i=this._consume(Pe.tokens.ident,"Expected function name."),n=this._argument_expression_list();return n===null?(this._current=r,null):this._updateNode(new g5(i.lexeme,n),e)}_loop_statement(){if(!this._match(Pe.keywords.loop))return null;this._check(Pe.tokens.attr)&&this._attribute(),this._consume(Pe.tokens.brace_left,"Expected '{' for loop.");let e=this._updateNode(new _7([],null));this._currentLoop.push(e);let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let i of r)e.body.push(i);else e.body.push(r);if(r instanceof p5){e.continuing=r;break}r=this._statement()}return this._currentLoop.pop(),this._consume(Pe.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(Pe.keywords.switch))return null;let e=this._updateNode(new v7(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(Pe.tokens.attr)&&this._attribute(),this._consume(Pe.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(Pe.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){let e=[],r=!1;for(;this._check([Pe.keywords.default,Pe.keywords.case]);){if(this._match(Pe.keywords.case)){let i=this._case_selectors();for(let o of i)if(o instanceof _3){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");r=!0;break}this._match(Pe.tokens.colon),this._check(Pe.tokens.attr)&&this._attribute(),this._consume(Pe.tokens.brace_left,"Exected '{' for switch case.");let n=this._case_body();this._consume(Pe.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new k7(i,n)))}if(this._match(Pe.keywords.default)){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(Pe.tokens.colon),this._check(Pe.tokens.attr)&&this._attribute(),this._consume(Pe.tokens.brace_left,"Exected '{' for switch default.");let i=this._case_body();this._consume(Pe.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new R7(i)))}}return e}_case_selectors(){let e=[];for(this._match(Pe.keywords.default)?e.push(this._updateNode(new _3)):e.push(this._shift_expression());this._match(Pe.tokens.comma);)this._match(Pe.keywords.default)?e.push(this._updateNode(new _3)):e.push(this._shift_expression());return e}_case_body(){if(this._match(Pe.keywords.fallthrough))return this._consume(Pe.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);let r=this._case_body();return r.length==0?e:[...e,r[0]]}_if_statement(){if(!this._match(Pe.keywords.if))return null;let e=this._currentLine,r=this._optional_paren_expression();this._check(Pe.tokens.attr)&&this._attribute();let i=this._compound_statement(),n=[];this._match_elseif()&&(this._check(Pe.tokens.attr)&&this._attribute(),n=this._elseif_statement(n));let o=null;return this._match(Pe.keywords.else)&&(this._check(Pe.tokens.attr)&&this._attribute(),o=this._compound_statement()),this._updateNode(new b7(r,i,n,o),e)}_match_elseif(){return this._tokens[this._current].type===Pe.keywords.else&&this._tokens[this._current+1].type===Pe.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){let r=this._optional_paren_expression(),i=this._compound_statement();return e.push(this._updateNode(new XX(r,i))),this._match_elseif()&&(this._check(Pe.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(Pe.keywords.return))return null;let e=this._short_circuit_or_expression();return this._updateNode(new x7(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(Pe.tokens.or_or);)e=this._updateNode(new wh(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(Pe.tokens.and_and);)e=this._updateNode(new wh(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(Pe.tokens.or);)e=this._updateNode(new wh(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(Pe.tokens.xor);)e=this._updateNode(new wh(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(Pe.tokens.and);)e=this._updateNode(new wh(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){let e=this._relational_expression();return this._match([Pe.tokens.equal_equal,Pe.tokens.not_equal])?this._updateNode(new wh(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([Pe.tokens.less_than,Pe.tokens.greater_than,Pe.tokens.less_than_equal,Pe.tokens.greater_than_equal]);)e=this._updateNode(new wh(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([Pe.tokens.shift_left,Pe.tokens.shift_right]);)e=this._updateNode(new wh(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([Pe.tokens.plus,Pe.tokens.minus]);)e=this._updateNode(new wh(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([Pe.tokens.star,Pe.tokens.forward_slash,Pe.tokens.modulo]);)e=this._updateNode(new wh(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([Pe.tokens.minus,Pe.tokens.bang,Pe.tokens.tilde,Pe.tokens.star,Pe.tokens.and])?this._updateNode(new Rs(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){let e=this._primary_expression(),r=this._postfix_expression();return r&&(e.postfix=r),e}_postfix_expression(){if(this._match(Pe.tokens.bracket_left)){let e=this._short_circuit_or_expression();this._consume(Pe.tokens.bracket_right,"Expected ']'.");let r=this._updateNode(new n_(e)),i=this._postfix_expression();return i&&(r.postfix=i),r}if(this._match(Pe.tokens.period)){let e=this._consume(Pe.tokens.name,"Expected member name."),r=this._postfix_expression(),i=this._updateNode(new Ag(e.lexeme));return r&&(i.postfix=r),i}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){let r=this._getStruct(e);if(r!==null)return r;switch(e){case"void":return jt.void;case"bool":return jt.bool;case"i32":return jt.i32;case"u32":return jt.u32;case"f32":return jt.f32;case"f16":return jt.f16;case"vec2f":return pt.vec2f;case"vec3f":return pt.vec3f;case"vec4f":return pt.vec4f;case"vec2i":return pt.vec2i;case"vec3i":return pt.vec3i;case"vec4i":return pt.vec4i;case"vec2u":return pt.vec2u;case"vec3u":return pt.vec3u;case"vec4u":return pt.vec4u;case"vec2h":return pt.vec2h;case"vec3h":return pt.vec3h;case"vec4h":return pt.vec4h;case"mat2x2f":return pt.mat2x2f;case"mat2x3f":return pt.mat2x3f;case"mat2x4f":return pt.mat2x4f;case"mat3x2f":return pt.mat3x2f;case"mat3x3f":return pt.mat3x3f;case"mat3x4f":return pt.mat3x4f;case"mat4x2f":return pt.mat4x2f;case"mat4x3f":return pt.mat4x3f;case"mat4x4f":return pt.mat4x4f;case"mat2x2h":return pt.mat2x2h;case"mat2x3h":return pt.mat2x3h;case"mat2x4h":return pt.mat2x4h;case"mat3x2h":return pt.mat3x2h;case"mat3x3h":return pt.mat3x3h;case"mat3x4h":return pt.mat3x4h;case"mat4x2h":return pt.mat4x2h;case"mat4x3h":return pt.mat4x3h;case"mat4x4h":return pt.mat4x4h;case"mat2x2i":return pt.mat2x2i;case"mat2x3i":return pt.mat2x3i;case"mat2x4i":return pt.mat2x4i;case"mat3x2i":return pt.mat3x2i;case"mat3x3i":return pt.mat3x3i;case"mat3x4i":return pt.mat3x4i;case"mat4x2i":return pt.mat4x2i;case"mat4x3i":return pt.mat4x3i;case"mat4x4i":return pt.mat4x4i;case"mat2x2u":return pt.mat2x2u;case"mat2x3u":return pt.mat2x3u;case"mat2x4u":return pt.mat2x4u;case"mat3x2u":return pt.mat3x2u;case"mat3x3u":return pt.mat3x3u;case"mat3x4u":return pt.mat3x4u;case"mat4x2u":return pt.mat4x2u;case"mat4x3u":return pt.mat4x3u;case"mat4x4u":return pt.mat4x4u}return null}_validateTypeRange(e,r){if(r.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(r.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(Pe.tokens.ident)){let i=this._previous().toString();if(this._check(Pe.tokens.paren_left)){let n=this._argument_expression_list(),o=this._getType(i);return o!==null?this._updateNode(new wd(o,n)):this._updateNode(new y5(i,n))}if(this._context.constants.has(i)){let n=this._context.constants.get(i);return this._updateNode(new E7(i,n.value))}return this._updateNode(new zc(i))}if(this._match(Pe.tokens.int_literal)){let i=this._previous().toString(),n=i.endsWith("i")||i.endsWith("i")?jt.i32:i.endsWith("u")||i.endsWith("U")?jt.u32:jt.x32,o=parseInt(i);return this._validateTypeRange(o,n),this._updateNode(new ta(new ft(o,this._exec.getTypeInfo(n)),n))}if(this._match(Pe.tokens.uint_literal)){let i=parseInt(this._previous().toString());return this._validateTypeRange(i,jt.u32),this._updateNode(new ta(new ft(i,this._exec.getTypeInfo(jt.u32)),jt.u32))}if(this._match([Pe.tokens.decimal_float_literal,Pe.tokens.hex_float_literal])){let i=this._previous().toString(),n=i.endsWith("h");n&&(i=i.substring(0,i.length-1));let o=parseFloat(i);this._validateTypeRange(o,n?jt.f16:jt.f32);let s=n?jt.f16:jt.f32;return this._updateNode(new ta(new ft(o,this._exec.getTypeInfo(s)),s))}if(this._match([Pe.keywords.true,Pe.keywords.false])){let i=this._previous().toString()===Pe.keywords.true.rule;return this._updateNode(new ta(new ft(i?1:0,this._exec.getTypeInfo(jt.bool)),jt.bool))}if(this._check(Pe.tokens.paren_left))return this._paren_expression();if(this._match(Pe.keywords.bitcast)){this._consume(Pe.tokens.less_than,"Expected '<'.");let i=this._type_decl();this._consume(Pe.tokens.greater_than,"Expected '>'.");let n=this._paren_expression();return this._updateNode(new C7(i,n))}let e=this._type_decl(),r=this._argument_expression_list();return this._updateNode(new wd(e,r))}_argument_expression_list(){if(!this._match(Pe.tokens.paren_left))return null;let e=[];do{if(this._check(Pe.tokens.paren_right))break;let r=this._short_circuit_or_expression();e.push(r)}while(this._match(Pe.tokens.comma));return this._consume(Pe.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(Pe.tokens.paren_left);let e=this._short_circuit_or_expression();return this._match(Pe.tokens.paren_right),e}_paren_expression(){this._consume(Pe.tokens.paren_left,"Expected '('.");let e=this._short_circuit_or_expression();return this._consume(Pe.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(Pe.keywords.struct))return null;let e=this._currentLine,r=this._consume(Pe.tokens.ident,"Expected name for struct.").toString();this._consume(Pe.tokens.brace_left,"Expected '{' for struct body.");let i=[];for(;!this._check(Pe.tokens.brace_right);){let s=this._attribute(),a=this._consume(Pe.tokens.name,"Expected variable name.").toString();this._consume(Pe.tokens.colon,"Expected ':' for struct member type.");let u=this._attribute(),p=this._type_decl();p!=null&&(p.attributes=u),this._check(Pe.tokens.brace_right)?this._match(Pe.tokens.comma):this._consume(Pe.tokens.comma,"Expected ',' for struct member."),i.push(this._updateNode(new D7(a,p,s)))}this._consume(Pe.tokens.brace_right,"Expected '}' after struct body.");let n=this._currentLine,o=this._updateNode(new Ff(r,i,e,n),e);return this._context.structs.set(r,o),o}_global_variable_decl(){let e=this._variable_decl();if(!e)return null;if(this._match(Pe.tokens.equal)){let r=this._const_expression();e.value=r}if(e.type!==null&&e.value instanceof ta){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof ta&&(e.type=e.value.type.name==="x32"?jt.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){let e=this._override_decl();return e&&this._match(Pe.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(Pe.keywords.const))return null;let r=this._consume(Pe.tokens.name,"Expected variable name"),i=this._currentLine,n=null;if(this._match(Pe.tokens.colon)){let u=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=u)}let o=null;this._consume(Pe.tokens.equal,"const declarations require an assignment");let s=this._short_circuit_or_expression();try{let u=[jt.f32],p=s.constEvaluate(this._exec,u);p instanceof ft&&this._validateTypeRange(p.value,u[0]),u[0]instanceof pt&&u[0].format===null&&p.typeInfo instanceof gg&&p.typeInfo.format!==null&&(p.typeInfo.format.name==="f16"?u[0].format=jt.f16:p.typeInfo.format.name==="f32"?u[0].format=jt.f32:p.typeInfo.format.name==="i32"?u[0].format=jt.i32:p.typeInfo.format.name==="u32"?u[0].format=jt.u32:p.typeInfo.format.name==="bool"?u[0].format=jt.bool:console.error(`TODO: impelement template format type ${p.typeInfo.format.name}`)),o=this._updateNode(new ta(p,u[0])),this._exec.context.setVariable(r.toString(),p)}catch{o=s}if(n!==null&&o instanceof ta){if(o.type.name!=="x32"&&n.getTypeName()!==o.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${o.type.name} to ${n.name}. Line:${this._currentLine}`);o.type=n,o.isScalar&&this._validateTypeRange(o.scalarValue,o.type)}else n===null&&o instanceof ta&&(n=(e=o?.type)!==null&&e!==void 0?e:jt.f32,n===jt.x32&&(n=jt.i32));let a=this._updateNode(new A3(r.toString(),n,"","",o),i);return this._context.constants.set(a.name,a),a}_global_let_decl(){if(!this._match(Pe.keywords.let))return null;let e=this._currentLine,r=this._consume(Pe.tokens.name,"Expected variable name"),i=null;if(this._match(Pe.tokens.colon)){let o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}let n=null;if(this._match(Pe.tokens.equal)&&(n=this._const_expression()),i!==null&&n instanceof ta){if(n.type.name!=="x32"&&i.getTypeName()!==n.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${n.type.name} to ${i.name}. Line:${this._currentLine}`);n.type=i}else i===null&&n instanceof ta&&(i=n.type.name==="x32"?jt.i32:n.type);return n instanceof ta&&n.isScalar&&this._validateTypeRange(n.scalarValue,i),this._updateNode(new Z1(r.toString(),i,"","",n),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(Pe.keywords.var))return null;let e=this._currentLine,r="",i="";this._match(Pe.tokens.less_than)&&(r=this._consume(Pe.storage_class,"Expected storage_class.").toString(),this._match(Pe.tokens.comma)&&(i=this._consume(Pe.access_mode,"Expected access_mode.").toString()),this._consume(Pe.tokens.greater_than,"Expected '>'."));let n=this._consume(Pe.tokens.name,"Expected variable name"),o=null;if(this._match(Pe.tokens.colon)){let s=this._attribute();o=this._type_decl(),o!=null&&(o.attributes=s)}return this._updateNode(new Nf(n.toString(),o,r,i,null),e)}_override_decl(){if(!this._match(Pe.keywords.override))return null;let e=this._consume(Pe.tokens.name,"Expected variable name"),r=null;if(this._match(Pe.tokens.colon)){let i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}return this._updateNode(new m5(e.toString(),r,null))}_diagnostic(){this._consume(Pe.tokens.paren_left,"Expected '('");let e=this._consume(Pe.tokens.ident,"Expected severity control name.");this._consume(Pe.tokens.comma,"Expected ','");let r=this._consume(Pe.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(Pe.tokens.period)&&(r+=`.${this._consume(Pe.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(Pe.tokens.paren_right,"Expected ')'"),this._updateNode(new w7(e.toString(),r))}_enable_directive(){let e=this._consume(Pe.tokens.ident,"identity expected.");return this._updateNode(new HX(e.toString()))}_requires_directive(){let e=[this._consume(Pe.tokens.ident,"identity expected.").toString()];for(;this._match(Pe.tokens.comma);){let r=this._consume(Pe.tokens.ident,"identity expected.");e.push(r.toString())}return this._updateNode(new qX(e))}_type_alias(){let e=this._consume(Pe.tokens.ident,"identity expected.");this._consume(Pe.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let i=this._updateNode(new A5(e.toString(),r));return this._context.aliases.set(i.name,i),i}_type_decl(){if(this._check([Pe.tokens.ident,...Pe.texel_format,Pe.keywords.bool,Pe.keywords.f32,Pe.keywords.i32,Pe.keywords.u32])){let i=this._advance().toString();if(this._context.structs.has(i))return this._context.structs.get(i);if(this._context.aliases.has(i))return this._context.aliases.get(i).type;if(!this._getType(i)){let n=this._updateNode(new M7(i));return this._forwardTypeCount++,n}return this._updateNode(new jt(i))}let e=this._texture_sampler_types();if(e)return e;if(this._check(Pe.template_types)){let i=this._advance().toString(),n=null,o=null;return this._match(Pe.tokens.less_than)&&(n=this._type_decl(),o=null,this._match(Pe.tokens.comma)&&(o=this._consume(Pe.access_mode,"Expected access_mode for pointer").toString()),this._consume(Pe.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new pt(i,n,o))}if(this._match(Pe.keywords.ptr)){let i=this._previous().toString();this._consume(Pe.tokens.less_than,"Expected '<' for pointer.");let n=this._consume(Pe.storage_class,"Expected storage_class for pointer");this._consume(Pe.tokens.comma,"Expected ',' for pointer.");let o=this._type_decl(),s=null;return this._match(Pe.tokens.comma)&&(s=this._consume(Pe.access_mode,"Expected access_mode for pointer").toString()),this._consume(Pe.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new y3(i,n.toString(),o,s))}let r=this._attribute();if(this._match(Pe.keywords.array)){let i=null,n=-1,o=this._previous(),s=null;if(this._match(Pe.tokens.less_than)){i=this._type_decl(),this._context.aliases.has(i.name)&&(i=this._context.aliases.get(i.name).type);let u="";if(this._match(Pe.tokens.comma)){s=this._shift_expression();try{u=s.constEvaluate(this._exec).toString(),s=null}catch{u="1"}}this._consume(Pe.tokens.greater_than,"Expected '>' for array."),n=u?parseInt(u):0}let a=this._updateNode(new K1(o.toString(),r,i,n));return s&&this._deferArrayCountEval.push({arrayType:a,countNode:s}),a}return null}_texture_sampler_types(){if(this._match(Pe.sampler_type))return this._updateNode(new X1(this._previous().toString(),null,null));if(this._match(Pe.depth_texture_type))return this._updateNode(new X1(this._previous().toString(),null,null));if(this._match(Pe.sampled_texture_type)||this._match(Pe.multisampled_texture_type)){let e=this._previous();this._consume(Pe.tokens.less_than,"Expected '<' for sampler type.");let r=this._type_decl();return this._consume(Pe.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new X1(e.toString(),r,null))}if(this._match(Pe.storage_texture_type)){let e=this._previous();this._consume(Pe.tokens.less_than,"Expected '<' for sampler type.");let r=this._consume(Pe.texel_format,"Invalid texel format.").toString();this._consume(Pe.tokens.comma,"Expected ',' after texel format.");let i=this._consume(Pe.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(Pe.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new X1(e.toString(),r,i))}return null}_attribute(){let e=[];for(;this._match(Pe.tokens.attr);){let r=this._consume(Pe.attribute_name,"Expected attribute name"),i=this._updateNode(new L7(r.toString(),null));if(this._match(Pe.tokens.paren_left)){if(i.value=this._consume(Pe.literal_or_ident,"Expected attribute value").toString(),this._check(Pe.tokens.comma)){this._advance();do{let n=this._consume(Pe.literal_or_ident,"Expected attribute value").toString();i.value instanceof Array||(i.value=[i.value]),i.value.push(n)}while(this._match(Pe.tokens.comma))}this._consume(Pe.tokens.paren_right,"Expected ')'")}e.push(i)}return e.length==0?null:e}},U7=class extends Q1{constructor(e){super(),e&&this.update(e)}update(e){let r=new nZ().parse(e);this.updateAST(r)}};function aZ(t){let e={attributes:[],bindings:[]},r;try{r=UNe(t)}catch(o){return Pt.error(o.message)(),e}for(let o of r.uniforms){let s=[];for(let a of o.type?.members||[])s.push({name:a.name,type:fye(a.type)});e.bindings.push({type:"uniform",name:o.name,group:o.group,location:o.binding,members:s})}for(let o of r.textures)e.bindings.push({type:"texture",name:o.name,group:o.group,location:o.binding});for(let o of r.samplers)e.bindings.push({type:"sampler",name:o.name,group:o.group,location:o.binding});let i=r.entry.vertex[0],n=i?.inputs.length||0;for(let o=0;o<n;o++){let s=i.inputs[o];if(s.locationType==="location"){let a=fye(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:a})}}return e}function fye(t){return t?.format?`${t.name}<${t.format.name}>`:t.name}function UNe(t){try{return new U7(t)}catch(e){if(e instanceof Error)throw e;let r="WGSL parse error";throw typeof e=="object"&&e?.message&&(r+=`: ${e.message} `),typeof e=="object"&&e?.token&&(r+=e.token.line||""),new Error(r,{cause:e})}}var VNe=1/Math.PI*180,jNe=1/180*Math.PI,$Ne={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...$Ne}};var ms=globalThis.mathgl.config;function v5(t,{precision:e=ms.precision}={}){return t=WNe(t),`${parseFloat(t.toPrecision(e))}`}function zf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function w3(t,e){return lZ(t,r=>r*jNe,e)}function o_(t,e){return lZ(t,r=>r*VNe,e)}function Rn(t,e,r){return lZ(t,i=>Math.max(e,Math.min(r,i)))}function sc(t,e,r){return zf(t)?t.map((i,n)=>sc(i,e[n],r)):r*e+(1-r)*t}function ra(t,e,r){let i=ms.EPSILON;r&&(ms.EPSILON=r);try{if(t===e)return!0;if(zf(t)&&zf(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!ra(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=ms.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{ms.EPSILON=i}}function WNe(t){return Math.round(t/ms.EPSILON)*ms.EPSILON}function GNe(t){return t.clone?t.clone():new Array(t.length)}function lZ(t,e,r){if(zf(t)){let i=t;r=r||GNe(i);for(let n=0;n<r.length&&n<i.length;++n){let o=typeof t=="number"?t:t[n];r[n]=e(o,n,r)}return r}return e(t)}var s_=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,r=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+r];return this.check()}toArray(e=[],r=0){for(let i=0;i<this.ELEMENTS;++i)e[r+i]=this[i];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:zf(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ms)}formatString(e){let r="";for(let i=0;i<this.ELEMENTS;++i)r+=(i>0?", ":"")+v5(this[i],e);return`${e.printTypes?this.constructor.name:""}[${r}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!ra(this[r],e[r]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==e[r])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,r,i){if(i===void 0)return this.lerp(this,e,r);for(let n=0;n<this.ELEMENTS;++n){let o=e[n],s=typeof r=="number"?r:r[n];this[n]=o+i*(s-o)}return this.check()}min(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(e[r],this[r]);return this.check()}max(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(e[r],this[r]);return this.check()}clamp(e,r){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),r[i]);return this.check()}add(...e){for(let r of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=r[i];return this.check()}subtract(...e){for(let r of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=r[i];return this.check()}scale(e){if(typeof e=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;else for(let r=0;r<this.ELEMENTS&&r<e.length;++r)this[r]*=e[r];return this.check()}multiplyByScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}check(){if(ms.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(this[r]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=e;return this.check()}addScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,r){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),r);return this.check()}get elements(){return this}};function HNe(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function On(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function a_(t,e,r=""){if(ms.debug&&!HNe(t,e))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return t}function m0(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}var S3=class extends s_{get x(){return this[0]}set x(e){this[0]=On(e)}get y(){return this[1]}set y(e){this[1]=On(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*this[r];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let r=0;for(let i=0;i<this.ELEMENTS;++i){let n=this[i]-e[i];r+=n*n}return On(r)}dot(e){let r=0;for(let i=0;i<this.ELEMENTS;++i)r+=this[i]*e[i];return On(r)}normalize(){let e=this.magnitude();if(e!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=e;return this.check()}multiply(...e){for(let r of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=r[i];return this.check()}divide(...e){for(let r of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=r[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return m0(e>=0&&e<this.ELEMENTS,"index is out of range"),On(this[e])}setComponent(e,r){return m0(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=r,this.check()}addVectors(e,r){return this.copy(e).add(r)}subVectors(e,r){return this.copy(e).subtract(r)}multiplyVectors(e,r){return this.copy(e).multiply(r)}addScaledVector(e,r){return this.add(new this.constructor(e).multiplyScalar(r))}};var Wa={};nl(Wa,{add:()=>KNe,angle:()=>mze,ceil:()=>QNe,clone:()=>qNe,copy:()=>XNe,create:()=>pye,cross:()=>cze,dist:()=>Sze,distance:()=>yye,div:()=>wze,divide:()=>Aye,dot:()=>lze,equals:()=>_ze,exactEquals:()=>yze,floor:()=>JNe,forEach:()=>Eze,fromValues:()=>YNe,inverse:()=>sze,len:()=>vze,length:()=>vye,lerp:()=>uze,max:()=>tze,min:()=>eze,mul:()=>xze,multiply:()=>gye,negate:()=>oze,normalize:()=>aze,random:()=>hze,rotate:()=>pze,round:()=>rze,scale:()=>ize,scaleAndAdd:()=>nze,set:()=>ZNe,sqrDist:()=>Tze,sqrLen:()=>Mze,squaredDistance:()=>_ye,squaredLength:()=>bye,str:()=>Aze,sub:()=>bze,subtract:()=>mye,transformMat2:()=>dze,transformMat2d:()=>fze,transformMat3:()=>cZ,transformMat4:()=>uZ,zero:()=>gze});var _o=typeof Float32Array<"u"?Float32Array:Array,g0=Math.random;function Md(t){return t>=0?Math.round(t):t%.5===0?Math.floor(t):Math.round(t)}var k9t=Math.PI/180;function pye(){let t=new _o(2);return _o!=Float32Array&&(t[0]=0,t[1]=0),t}function qNe(t){let e=new _o(2);return e[0]=t[0],e[1]=t[1],e}function YNe(t,e){let r=new _o(2);return r[0]=t,r[1]=e,r}function XNe(t,e){return t[0]=e[0],t[1]=e[1],t}function ZNe(t,e,r){return t[0]=e,t[1]=r,t}function KNe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function mye(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function gye(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function Aye(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function QNe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function JNe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function eze(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function tze(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function rze(t,e){return t[0]=Md(e[0]),t[1]=Md(e[1]),t}function ize(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function nze(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}function yye(t,e){let r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)}function _ye(t,e){let r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function vye(t){let e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function bye(t){let e=t[0],r=t[1];return e*e+r*r}function oze(t,e){return t[0]=-e[0],t[1]=-e[1],t}function sze(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function aze(t,e){let r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t}function lze(t,e){return t[0]*e[0]+t[1]*e[1]}function cze(t,e,r){let i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}function uze(t,e,r,i){let n=e[0],o=e[1];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t}function hze(t,e){e=e===void 0?1:e;let r=g0()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function dze(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t}function fze(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t}function cZ(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t}function uZ(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t}function pze(t,e,r,i){let n=e[0]-r[0],o=e[1]-r[1],s=Math.sin(i),a=Math.cos(i);return t[0]=n*a-o*s+r[0],t[1]=n*s+o*a+r[1],t}function mze(t,e){let r=t[0],i=t[1],n=e[0],o=e[1],s=Math.sqrt((r*r+i*i)*(n*n+o*o)),a=s&&(r*n+i*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function gze(t){return t[0]=0,t[1]=0,t}function Aze(t){return`vec2(${t[0]}, ${t[1]})`}function yze(t,e){return t[0]===e[0]&&t[1]===e[1]}function _ze(t,e){let r=t[0],i=t[1],n=e[0],o=e[1];return Math.abs(r-n)<=1e-6*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=1e-6*Math.max(1,Math.abs(i),Math.abs(o))}var vze=vye,bze=mye,xze=gye,wze=Aye,Sze=yye,Tze=_ye,Mze=bye,Eze=(function(){let t=pye();return function(e,r,i,n,o,s){let a,u;for(r||(r=2),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,a=i;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}})();function xye(t,e,r){let i=e[0],n=e[1],o=r[3]*i+r[7]*n||1;return t[0]=(r[0]*i+r[4]*n)/o,t[1]=(r[1]*i+r[5]*n)/o,t}function V7(t,e,r){let i=e[0],n=e[1],o=e[2],s=r[3]*i+r[7]*n+r[11]*o||1;return t[0]=(r[0]*i+r[4]*n+r[8]*o)/s,t[1]=(r[1]*i+r[5]*n+r[9]*o)/s,t[2]=(r[2]*i+r[6]*n+r[10]*o)/s,t}function wye(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t[2]=e[2],t}function Sye(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t[2]=e[2],t[3]=e[3],t}function j7(t,e,r){let i=e[0],n=e[1],o=e[2];return t[0]=r[0]*i+r[3]*n+r[6]*o,t[1]=r[1]*i+r[4]*n+r[7]*o,t[2]=r[2]*i+r[5]*n+r[8]*o,t[3]=e[3],t}var Ol={};nl(Ol,{add:()=>kze,angle:()=>mZ,bezier:()=>Wze,ceil:()=>Rze,clone:()=>Cze,copy:()=>Pze,create:()=>$7,cross:()=>eb,dist:()=>Jze,distance:()=>Cye,div:()=>Qze,divide:()=>Eye,dot:()=>b5,equals:()=>Xze,exactEquals:()=>Yze,floor:()=>Oze,forEach:()=>rUe,fromValues:()=>G7,hermite:()=>$ze,inverse:()=>Uze,len:()=>gZ,length:()=>W7,lerp:()=>Vze,max:()=>Lze,min:()=>Dze,mul:()=>Kze,multiply:()=>Mye,negate:()=>zze,normalize:()=>hZ,random:()=>Gze,rotateX:()=>dZ,rotateY:()=>fZ,rotateZ:()=>pZ,round:()=>Bze,scale:()=>Fze,scaleAndAdd:()=>Nze,set:()=>Ize,slerp:()=>jze,sqrDist:()=>eUe,sqrLen:()=>tUe,squaredDistance:()=>Pye,squaredLength:()=>Iye,str:()=>qze,sub:()=>Zze,subtract:()=>Tye,transformMat3:()=>x5,transformMat4:()=>tb,transformQuat:()=>w5,zero:()=>Hze});function $7(){let t=new _o(3);return _o!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Cze(t){let e=new _o(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function W7(t){let e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function G7(t,e,r){let i=new _o(3);return i[0]=t,i[1]=e,i[2]=r,i}function Pze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ize(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}function kze(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Tye(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Mye(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Eye(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Rze(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Oze(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Dze(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function Lze(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function Bze(t,e){return t[0]=Md(e[0]),t[1]=Md(e[1]),t[2]=Md(e[2]),t}function Fze(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Nze(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}function Cye(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+i*i+n*n)}function Pye(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n}function Iye(t){let e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function zze(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Uze(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function hZ(t,e){let r=e[0],i=e[1],n=e[2],o=r*r+i*i+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function b5(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function eb(t,e,r){let i=e[0],n=e[1],o=e[2],s=r[0],a=r[1],u=r[2];return t[0]=n*u-o*a,t[1]=o*s-i*u,t[2]=i*a-n*s,t}function Vze(t,e,r,i){let n=e[0],o=e[1],s=e[2];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s),t}function jze(t,e,r,i){let n=Math.acos(Math.min(Math.max(b5(e,r),-1),1)),o=Math.sin(n),s=Math.sin((1-i)*n)/o,a=Math.sin(i*n)/o;return t[0]=s*e[0]+a*r[0],t[1]=s*e[1]+a*r[1],t[2]=s*e[2]+a*r[2],t}function $ze(t,e,r,i,n,o){let s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,p=s*(o-1),m=s*(3-2*o);return t[0]=e[0]*a+r[0]*u+i[0]*p+n[0]*m,t[1]=e[1]*a+r[1]*u+i[1]*p+n[1]*m,t[2]=e[2]*a+r[2]*u+i[2]*p+n[2]*m,t}function Wze(t,e,r,i,n,o){let s=1-o,a=s*s,u=o*o,p=a*s,m=3*o*a,x=3*u*s,M=u*o;return t[0]=e[0]*p+r[0]*m+i[0]*x+n[0]*M,t[1]=e[1]*p+r[1]*m+i[1]*x+n[1]*M,t[2]=e[2]*p+r[2]*m+i[2]*x+n[2]*M,t}function Gze(t,e){e=e===void 0?1:e;let r=g0()*2*Math.PI,i=g0()*2-1,n=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t[2]=i*e,t}function tb(t,e,r){let i=e[0],n=e[1],o=e[2],s=r[3]*i+r[7]*n+r[11]*o+r[15];return s=s||1,t[0]=(r[0]*i+r[4]*n+r[8]*o+r[12])/s,t[1]=(r[1]*i+r[5]*n+r[9]*o+r[13])/s,t[2]=(r[2]*i+r[6]*n+r[10]*o+r[14])/s,t}function x5(t,e,r){let i=e[0],n=e[1],o=e[2];return t[0]=i*r[0]+n*r[3]+o*r[6],t[1]=i*r[1]+n*r[4]+o*r[7],t[2]=i*r[2]+n*r[5]+o*r[8],t}function w5(t,e,r){let i=r[0],n=r[1],o=r[2],s=r[3],a=e[0],u=e[1],p=e[2],m=n*p-o*u,x=o*a-i*p,M=i*u-n*a,k=n*M-o*x,F=o*m-i*M,j=i*x-n*m,H=s*2;return m*=H,x*=H,M*=H,k*=2,F*=2,j*=2,t[0]=a+m+k,t[1]=u+x+F,t[2]=p+M+j,t}function dZ(t,e,r,i){let n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),o[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function fZ(t,e,r,i){let n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),o[1]=n[1],o[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function pZ(t,e,r,i){let n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),o[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function mZ(t,e){let r=t[0],i=t[1],n=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt((r*r+i*i+n*n)*(o*o+s*s+a*a)),p=u&&b5(t,e)/u;return Math.acos(Math.min(Math.max(p,-1),1))}function Hze(t){return t[0]=0,t[1]=0,t[2]=0,t}function qze(t){return`vec3(${t[0]}, ${t[1]}, ${t[2]})`}function Yze(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Xze(t,e){let r=t[0],i=t[1],n=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=1e-6*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-a)<=1e-6*Math.max(1,Math.abs(n),Math.abs(a))}var Zze=Tye,Kze=Mye,Qze=Eye,Jze=Cye,eUe=Pye,gZ=W7,tUe=Iye,rUe=(function(){let t=$7();return function(e,r,i,n,o,s){let a,u;for(r||(r=3),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,a=i;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();var AZ=[0,0,0],H7,lr=class t extends S3{static get ZERO(){return H7||(H7=new t(0,0,0),Object.freeze(H7)),H7}constructor(e=0,r=0,i=0){super(-0,-0,-0),arguments.length===1&&zf(e)?this.copy(e):(ms.debug&&(On(e),On(r),On(i)),this[0]=e,this[1]=r,this[2]=i)}set(e,r,i){return this[0]=e,this[1]=r,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return ms.debug&&(On(e.x),On(e.y),On(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=On(e)}angle(e){return mZ(this,e)}cross(e){return eb(this,this,e),this.check()}rotateX({radians:e,origin:r=AZ}){return dZ(this,this,r,e),this.check()}rotateY({radians:e,origin:r=AZ}){return fZ(this,this,r,e),this.check()}rotateZ({radians:e,origin:r=AZ}){return pZ(this,this,r,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return tb(this,this,e),this.check()}transformAsVector(e){return V7(this,this,e),this.check()}transformByMatrix3(e){return x5(this,this,e),this.check()}transformByMatrix2(e){return wye(this,this,e),this.check()}transformByQuaternion(e){return w5(this,this,e),this.check()}};var q7,Y7=class t extends S3{static get ZERO(){return q7||(q7=new t(0,0,0,0),Object.freeze(q7)),q7}constructor(e=0,r=0,i=0,n=0){super(-0,-0,-0,-0),zf(e)&&arguments.length===1?this.copy(e):(ms.debug&&(On(e),On(r),On(i),On(n)),this[0]=e,this[1]=r,this[2]=i,this[3]=n)}set(e,r,i,n){return this[0]=e,this[1]=r,this[2]=i,this[3]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return ms.debug&&(On(e.x),On(e.y),On(e.z),On(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=On(e)}get w(){return this[3]}set w(e){this[3]=On(e)}transform(e){return tb(this,this,e),this.check()}transformByMatrix3(e){return j7(this,this,e),this.check()}transformByMatrix2(e){return Sye(this,this,e),this.check()}transformByQuaternion(e){return w5(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}};var M3=class extends s_{toString(){let e="[";if(ms.printRowMajor){e+="row-major:";for(let r=0;r<this.RANK;++r)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+r]}`}else{e+="column-major:";for(let r=0;r<this.ELEMENTS;++r)e+=` ${this[r]}`}return e+="]",e}getElementIndex(e,r){return r*this.RANK+e}getElement(e,r){return this[r*this.RANK+e]}setElement(e,r,i){return this[r*this.RANK+e]=On(i),this}getColumn(e,r=new Array(this.RANK).fill(-0)){let i=e*this.RANK;for(let n=0;n<this.RANK;++n)r[n]=this[i+n];return r}setColumn(e,r){let i=e*this.RANK;for(let n=0;n<this.RANK;++n)this[i+n]=r[n];return this}};function kye(){let t=new _o(9);return _o!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Rye(t,e){if(t===e){let r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Oye(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],u=e[6],p=e[7],m=e[8],x=m*s-a*p,M=-m*o+a*u,k=p*o-s*u,F=r*x+i*M+n*k;return F?(F=1/F,t[0]=x*F,t[1]=(-m*i+n*p)*F,t[2]=(a*i-n*s)*F,t[3]=M*F,t[4]=(m*r-n*u)*F,t[5]=(-a*r+n*o)*F,t[6]=k*F,t[7]=(-p*r+i*u)*F,t[8]=(s*r-i*o)*F,t):null}function Dye(t){let e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],s=t[5],a=t[6],u=t[7],p=t[8];return e*(p*o-s*u)+r*(-p*n+s*a)+i*(u*n-o*a)}function yZ(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],u=e[5],p=e[6],m=e[7],x=e[8],M=r[0],k=r[1],F=r[2],j=r[3],H=r[4],W=r[5],Z=r[6],Y=r[7],ee=r[8];return t[0]=M*i+k*s+F*p,t[1]=M*n+k*a+F*m,t[2]=M*o+k*u+F*x,t[3]=j*i+H*s+W*p,t[4]=j*n+H*a+W*m,t[5]=j*o+H*u+W*x,t[6]=Z*i+Y*s+ee*p,t[7]=Z*n+Y*a+ee*m,t[8]=Z*o+Y*u+ee*x,t}function Lye(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],u=e[5],p=e[6],m=e[7],x=e[8],M=r[0],k=r[1];return t[0]=i,t[1]=n,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=M*i+k*s+p,t[7]=M*n+k*a+m,t[8]=M*o+k*u+x,t}function Bye(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],u=e[5],p=e[6],m=e[7],x=e[8],M=Math.sin(r),k=Math.cos(r);return t[0]=k*i+M*s,t[1]=k*n+M*a,t[2]=k*o+M*u,t[3]=k*s-M*i,t[4]=k*a-M*n,t[5]=k*u-M*o,t[6]=p,t[7]=m,t[8]=x,t}function _Z(t,e,r){let i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Fye(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=r+r,a=i+i,u=n+n,p=r*s,m=i*s,x=i*a,M=n*s,k=n*a,F=n*u,j=o*s,H=o*a,W=o*u;return t[0]=1-x-F,t[3]=m-W,t[6]=M+H,t[1]=m+W,t[4]=1-p-F,t[7]=k-j,t[2]=M-H,t[5]=k+j,t[8]=1-p-x,t}var vZ;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(vZ||(vZ={}));var iUe=Object.freeze([1,0,0,0,1,0,0,0,1]),gs=class extends M3{static get IDENTITY(){return oUe()}static get ZERO(){return nUe()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return vZ}constructor(e,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):r.length>0?this.copy([e,...r]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(iUe)}fromObject(e){return this.check()}fromQuaternion(e){return Fye(this,e),this.check()}set(e,r,i,n,o,s,a,u,p){return this[0]=e,this[1]=r,this[2]=i,this[3]=n,this[4]=o,this[5]=s,this[6]=a,this[7]=u,this[8]=p,this.check()}setRowMajor(e,r,i,n,o,s,a,u,p){return this[0]=e,this[1]=n,this[2]=a,this[3]=r,this[4]=o,this[5]=u,this[6]=i,this[7]=s,this[8]=p,this.check()}determinant(){return Dye(this)}transpose(){return Rye(this,this),this.check()}invert(){return Oye(this,this),this.check()}multiplyLeft(e){return yZ(this,e,this),this.check()}multiplyRight(e){return yZ(this,this,e),this.check()}rotate(e){return Bye(this,this,e),this.check()}scale(e){return Array.isArray(e)?_Z(this,this,e):_Z(this,this,[e,e]),this.check()}translate(e){return Lye(this,this,e),this.check()}transform(e,r){let i;switch(e.length){case 2:i=cZ(r||[-0,-0],e,this);break;case 3:i=x5(r||[-0,-0,-0],e,this);break;case 4:i=j7(r||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return a_(i,e.length),i}transformVector(e,r){return this.transform(e,r)}transformVector2(e,r){return this.transform(e,r)}transformVector3(e,r){return this.transform(e,r)}},X7,Z7=null;function nUe(){return X7||(X7=new gs([0,0,0,0,0,0,0,0,0]),Object.freeze(X7)),X7}function oUe(){return Z7||(Z7=new gs,Object.freeze(Z7)),Z7}var ia={};nl(ia,{add:()=>IUe,adjoint:()=>hUe,clone:()=>aUe,copy:()=>lUe,create:()=>sUe,decompose:()=>bUe,determinant:()=>wZ,equals:()=>DUe,exactEquals:()=>OUe,frob:()=>PUe,fromQuat:()=>IZ,fromQuat2:()=>yUe,fromRotation:()=>pUe,fromRotationTranslation:()=>Uye,fromRotationTranslationScale:()=>xUe,fromRotationTranslationScaleOrigin:()=>wUe,fromScaling:()=>fUe,fromTranslation:()=>dUe,fromValues:()=>cUe,fromXRotation:()=>mUe,fromYRotation:()=>gUe,fromZRotation:()=>AUe,frustum:()=>kZ,getRotation:()=>vUe,getScaling:()=>Vye,getTranslation:()=>_Ue,identity:()=>zye,invert:()=>xZ,lookAt:()=>DZ,mul:()=>LUe,multiply:()=>S5,multiplyScalar:()=>kUe,multiplyScalarAndAdd:()=>RUe,ortho:()=>OZ,orthoNO:()=>$ye,orthoZO:()=>MUe,perspective:()=>RZ,perspectiveFromFieldOfView:()=>TUe,perspectiveNO:()=>jye,perspectiveZO:()=>SUe,rotate:()=>MZ,rotateX:()=>EZ,rotateY:()=>CZ,rotateZ:()=>PZ,scale:()=>TZ,set:()=>uUe,str:()=>CUe,sub:()=>BUe,subtract:()=>Wye,targetTo:()=>EUe,translate:()=>SZ,transpose:()=>bZ});function sUe(){let t=new _o(16);return _o!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function aUe(t){let e=new _o(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function lUe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function cUe(t,e,r,i,n,o,s,a,u,p,m,x,M,k,F,j){let H=new _o(16);return H[0]=t,H[1]=e,H[2]=r,H[3]=i,H[4]=n,H[5]=o,H[6]=s,H[7]=a,H[8]=u,H[9]=p,H[10]=m,H[11]=x,H[12]=M,H[13]=k,H[14]=F,H[15]=j,H}function uUe(t,e,r,i,n,o,s,a,u,p,m,x,M,k,F,j,H){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=p,t[9]=m,t[10]=x,t[11]=M,t[12]=k,t[13]=F,t[14]=j,t[15]=H,t}function zye(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bZ(t,e){if(t===e){let r=e[1],i=e[2],n=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=n,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function xZ(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],u=e[6],p=e[7],m=e[8],x=e[9],M=e[10],k=e[11],F=e[12],j=e[13],H=e[14],W=e[15],Z=r*a-i*s,Y=r*u-n*s,ee=r*p-o*s,ce=i*u-n*a,ge=i*p-o*a,Se=n*p-o*u,ne=m*j-x*F,pe=m*H-M*F,ue=m*W-k*F,Le=x*H-M*j,We=x*W-k*j,ze=M*W-k*H,rt=Z*ze-Y*We+ee*Le+ce*ue-ge*pe+Se*ne;return rt?(rt=1/rt,t[0]=(a*ze-u*We+p*Le)*rt,t[1]=(n*We-i*ze-o*Le)*rt,t[2]=(j*Se-H*ge+W*ce)*rt,t[3]=(M*ge-x*Se-k*ce)*rt,t[4]=(u*ue-s*ze-p*pe)*rt,t[5]=(r*ze-n*ue+o*pe)*rt,t[6]=(H*ee-F*Se-W*Y)*rt,t[7]=(m*Se-M*ee+k*Y)*rt,t[8]=(s*We-a*ue+p*ne)*rt,t[9]=(i*ue-r*We-o*ne)*rt,t[10]=(F*ge-j*ee+W*Z)*rt,t[11]=(x*ee-m*ge-k*Z)*rt,t[12]=(a*pe-s*Le-u*ne)*rt,t[13]=(r*Le-i*pe+n*ne)*rt,t[14]=(j*Y-F*ce-H*Z)*rt,t[15]=(m*ce-x*Y+M*Z)*rt,t):null}function hUe(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],u=e[6],p=e[7],m=e[8],x=e[9],M=e[10],k=e[11],F=e[12],j=e[13],H=e[14],W=e[15],Z=r*a-i*s,Y=r*u-n*s,ee=r*p-o*s,ce=i*u-n*a,ge=i*p-o*a,Se=n*p-o*u,ne=m*j-x*F,pe=m*H-M*F,ue=m*W-k*F,Le=x*H-M*j,We=x*W-k*j,ze=M*W-k*H;return t[0]=a*ze-u*We+p*Le,t[1]=n*We-i*ze-o*Le,t[2]=j*Se-H*ge+W*ce,t[3]=M*ge-x*Se-k*ce,t[4]=u*ue-s*ze-p*pe,t[5]=r*ze-n*ue+o*pe,t[6]=H*ee-F*Se-W*Y,t[7]=m*Se-M*ee+k*Y,t[8]=s*We-a*ue+p*ne,t[9]=i*ue-r*We-o*ne,t[10]=F*ge-j*ee+W*Z,t[11]=x*ee-m*ge-k*Z,t[12]=a*pe-s*Le-u*ne,t[13]=r*Le-i*pe+n*ne,t[14]=j*Y-F*ce-H*Z,t[15]=m*ce-x*Y+M*Z,t}function wZ(t){let e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],s=t[5],a=t[6],u=t[7],p=t[8],m=t[9],x=t[10],M=t[11],k=t[12],F=t[13],j=t[14],H=t[15],W=e*s-r*o,Z=e*a-i*o,Y=r*a-i*s,ee=p*F-m*k,ce=p*j-x*k,ge=m*j-x*F,Se=e*ge-r*ce+i*ee,ne=o*ge-s*ce+a*ee,pe=p*Y-m*Z+x*W,ue=k*Y-F*Z+j*W;return u*Se-n*ne+H*pe-M*ue}function S5(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],u=e[5],p=e[6],m=e[7],x=e[8],M=e[9],k=e[10],F=e[11],j=e[12],H=e[13],W=e[14],Z=e[15],Y=r[0],ee=r[1],ce=r[2],ge=r[3];return t[0]=Y*i+ee*a+ce*x+ge*j,t[1]=Y*n+ee*u+ce*M+ge*H,t[2]=Y*o+ee*p+ce*k+ge*W,t[3]=Y*s+ee*m+ce*F+ge*Z,Y=r[4],ee=r[5],ce=r[6],ge=r[7],t[4]=Y*i+ee*a+ce*x+ge*j,t[5]=Y*n+ee*u+ce*M+ge*H,t[6]=Y*o+ee*p+ce*k+ge*W,t[7]=Y*s+ee*m+ce*F+ge*Z,Y=r[8],ee=r[9],ce=r[10],ge=r[11],t[8]=Y*i+ee*a+ce*x+ge*j,t[9]=Y*n+ee*u+ce*M+ge*H,t[10]=Y*o+ee*p+ce*k+ge*W,t[11]=Y*s+ee*m+ce*F+ge*Z,Y=r[12],ee=r[13],ce=r[14],ge=r[15],t[12]=Y*i+ee*a+ce*x+ge*j,t[13]=Y*n+ee*u+ce*M+ge*H,t[14]=Y*o+ee*p+ce*k+ge*W,t[15]=Y*s+ee*m+ce*F+ge*Z,t}function SZ(t,e,r){let i=r[0],n=r[1],o=r[2],s,a,u,p,m,x,M,k,F,j,H,W;return e===t?(t[12]=e[0]*i+e[4]*n+e[8]*o+e[12],t[13]=e[1]*i+e[5]*n+e[9]*o+e[13],t[14]=e[2]*i+e[6]*n+e[10]*o+e[14],t[15]=e[3]*i+e[7]*n+e[11]*o+e[15]):(s=e[0],a=e[1],u=e[2],p=e[3],m=e[4],x=e[5],M=e[6],k=e[7],F=e[8],j=e[9],H=e[10],W=e[11],t[0]=s,t[1]=a,t[2]=u,t[3]=p,t[4]=m,t[5]=x,t[6]=M,t[7]=k,t[8]=F,t[9]=j,t[10]=H,t[11]=W,t[12]=s*i+m*n+F*o+e[12],t[13]=a*i+x*n+j*o+e[13],t[14]=u*i+M*n+H*o+e[14],t[15]=p*i+k*n+W*o+e[15]),t}function TZ(t,e,r){let i=r[0],n=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function MZ(t,e,r,i){let n=i[0],o=i[1],s=i[2],a=Math.sqrt(n*n+o*o+s*s),u,p,m,x,M,k,F,j,H,W,Z,Y,ee,ce,ge,Se,ne,pe,ue,Le,We,ze,rt,at;return a<1e-6?null:(a=1/a,n*=a,o*=a,s*=a,p=Math.sin(r),u=Math.cos(r),m=1-u,x=e[0],M=e[1],k=e[2],F=e[3],j=e[4],H=e[5],W=e[6],Z=e[7],Y=e[8],ee=e[9],ce=e[10],ge=e[11],Se=n*n*m+u,ne=o*n*m+s*p,pe=s*n*m-o*p,ue=n*o*m-s*p,Le=o*o*m+u,We=s*o*m+n*p,ze=n*s*m+o*p,rt=o*s*m-n*p,at=s*s*m+u,t[0]=x*Se+j*ne+Y*pe,t[1]=M*Se+H*ne+ee*pe,t[2]=k*Se+W*ne+ce*pe,t[3]=F*Se+Z*ne+ge*pe,t[4]=x*ue+j*Le+Y*We,t[5]=M*ue+H*Le+ee*We,t[6]=k*ue+W*Le+ce*We,t[7]=F*ue+Z*Le+ge*We,t[8]=x*ze+j*rt+Y*at,t[9]=M*ze+H*rt+ee*at,t[10]=k*ze+W*rt+ce*at,t[11]=F*ze+Z*rt+ge*at,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function EZ(t,e,r){let i=Math.sin(r),n=Math.cos(r),o=e[4],s=e[5],a=e[6],u=e[7],p=e[8],m=e[9],x=e[10],M=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+p*i,t[5]=s*n+m*i,t[6]=a*n+x*i,t[7]=u*n+M*i,t[8]=p*n-o*i,t[9]=m*n-s*i,t[10]=x*n-a*i,t[11]=M*n-u*i,t}function CZ(t,e,r){let i=Math.sin(r),n=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],p=e[8],m=e[9],x=e[10],M=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-p*i,t[1]=s*n-m*i,t[2]=a*n-x*i,t[3]=u*n-M*i,t[8]=o*i+p*n,t[9]=s*i+m*n,t[10]=a*i+x*n,t[11]=u*i+M*n,t}function PZ(t,e,r){let i=Math.sin(r),n=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],p=e[4],m=e[5],x=e[6],M=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+p*i,t[1]=s*n+m*i,t[2]=a*n+x*i,t[3]=u*n+M*i,t[4]=p*n-o*i,t[5]=m*n-s*i,t[6]=x*n-a*i,t[7]=M*n-u*i,t}function dUe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function fUe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pUe(t,e,r){let i=r[0],n=r[1],o=r[2],s=Math.sqrt(i*i+n*n+o*o),a,u,p;return s<1e-6?null:(s=1/s,i*=s,n*=s,o*=s,u=Math.sin(e),a=Math.cos(e),p=1-a,t[0]=i*i*p+a,t[1]=n*i*p+o*u,t[2]=o*i*p-n*u,t[3]=0,t[4]=i*n*p-o*u,t[5]=n*n*p+a,t[6]=o*n*p+i*u,t[7]=0,t[8]=i*o*p+n*u,t[9]=n*o*p-i*u,t[10]=o*o*p+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function mUe(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gUe(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function AUe(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Uye(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=i+i,u=n+n,p=o+o,m=i*a,x=i*u,M=i*p,k=n*u,F=n*p,j=o*p,H=s*a,W=s*u,Z=s*p;return t[0]=1-(k+j),t[1]=x+Z,t[2]=M-W,t[3]=0,t[4]=x-Z,t[5]=1-(m+j),t[6]=F+H,t[7]=0,t[8]=M+W,t[9]=F-H,t[10]=1-(m+k),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function yUe(t,e){let r=new _o(3),i=-e[0],n=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],p=e[6],m=e[7],x=i*i+n*n+o*o+s*s;return x>0?(r[0]=(a*s+m*i+u*o-p*n)*2/x,r[1]=(u*s+m*n+p*i-a*o)*2/x,r[2]=(p*s+m*o+a*n-u*i)*2/x):(r[0]=(a*s+m*i+u*o-p*n)*2,r[1]=(u*s+m*n+p*i-a*o)*2,r[2]=(p*s+m*o+a*n-u*i)*2),Uye(t,e,r),t}function _Ue(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Vye(t,e){let r=e[0],i=e[1],n=e[2],o=e[4],s=e[5],a=e[6],u=e[8],p=e[9],m=e[10];return t[0]=Math.sqrt(r*r+i*i+n*n),t[1]=Math.sqrt(o*o+s*s+a*a),t[2]=Math.sqrt(u*u+p*p+m*m),t}function vUe(t,e){let r=new _o(3);Vye(r,e);let i=1/r[0],n=1/r[1],o=1/r[2],s=e[0]*i,a=e[1]*n,u=e[2]*o,p=e[4]*i,m=e[5]*n,x=e[6]*o,M=e[8]*i,k=e[9]*n,F=e[10]*o,j=s+m+F,H=0;return j>0?(H=Math.sqrt(j+1)*2,t[3]=.25*H,t[0]=(x-k)/H,t[1]=(M-u)/H,t[2]=(a-p)/H):s>m&&s>F?(H=Math.sqrt(1+s-m-F)*2,t[3]=(x-k)/H,t[0]=.25*H,t[1]=(a+p)/H,t[2]=(M+u)/H):m>F?(H=Math.sqrt(1+m-s-F)*2,t[3]=(M-u)/H,t[0]=(a+p)/H,t[1]=.25*H,t[2]=(x+k)/H):(H=Math.sqrt(1+F-s-m)*2,t[3]=(a-p)/H,t[0]=(M+u)/H,t[1]=(x+k)/H,t[2]=.25*H),t}function bUe(t,e,r,i){e[0]=i[12],e[1]=i[13],e[2]=i[14];let n=i[0],o=i[1],s=i[2],a=i[4],u=i[5],p=i[6],m=i[8],x=i[9],M=i[10];r[0]=Math.sqrt(n*n+o*o+s*s),r[1]=Math.sqrt(a*a+u*u+p*p),r[2]=Math.sqrt(m*m+x*x+M*M);let k=1/r[0],F=1/r[1],j=1/r[2],H=n*k,W=o*F,Z=s*j,Y=a*k,ee=u*F,ce=p*j,ge=m*k,Se=x*F,ne=M*j,pe=H+ee+ne,ue=0;return pe>0?(ue=Math.sqrt(pe+1)*2,t[3]=.25*ue,t[0]=(ce-Se)/ue,t[1]=(ge-Z)/ue,t[2]=(W-Y)/ue):H>ee&&H>ne?(ue=Math.sqrt(1+H-ee-ne)*2,t[3]=(ce-Se)/ue,t[0]=.25*ue,t[1]=(W+Y)/ue,t[2]=(ge+Z)/ue):ee>ne?(ue=Math.sqrt(1+ee-H-ne)*2,t[3]=(ge-Z)/ue,t[0]=(W+Y)/ue,t[1]=.25*ue,t[2]=(ce+Se)/ue):(ue=Math.sqrt(1+ne-H-ee)*2,t[3]=(W-Y)/ue,t[0]=(ge+Z)/ue,t[1]=(ce+Se)/ue,t[2]=.25*ue),t}function xUe(t,e,r,i){let n=e[0],o=e[1],s=e[2],a=e[3],u=n+n,p=o+o,m=s+s,x=n*u,M=n*p,k=n*m,F=o*p,j=o*m,H=s*m,W=a*u,Z=a*p,Y=a*m,ee=i[0],ce=i[1],ge=i[2];return t[0]=(1-(F+H))*ee,t[1]=(M+Y)*ee,t[2]=(k-Z)*ee,t[3]=0,t[4]=(M-Y)*ce,t[5]=(1-(x+H))*ce,t[6]=(j+W)*ce,t[7]=0,t[8]=(k+Z)*ge,t[9]=(j-W)*ge,t[10]=(1-(x+F))*ge,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function wUe(t,e,r,i,n){let o=e[0],s=e[1],a=e[2],u=e[3],p=o+o,m=s+s,x=a+a,M=o*p,k=o*m,F=o*x,j=s*m,H=s*x,W=a*x,Z=u*p,Y=u*m,ee=u*x,ce=i[0],ge=i[1],Se=i[2],ne=n[0],pe=n[1],ue=n[2],Le=(1-(j+W))*ce,We=(k+ee)*ce,ze=(F-Y)*ce,rt=(k-ee)*ge,at=(1-(M+W))*ge,Wt=(H+Z)*ge,It=(F+Y)*Se,Bt=(H-Z)*Se,Qt=(1-(M+j))*Se;return t[0]=Le,t[1]=We,t[2]=ze,t[3]=0,t[4]=rt,t[5]=at,t[6]=Wt,t[7]=0,t[8]=It,t[9]=Bt,t[10]=Qt,t[11]=0,t[12]=r[0]+ne-(Le*ne+rt*pe+It*ue),t[13]=r[1]+pe-(We*ne+at*pe+Bt*ue),t[14]=r[2]+ue-(ze*ne+Wt*pe+Qt*ue),t[15]=1,t}function IZ(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=r+r,a=i+i,u=n+n,p=r*s,m=i*s,x=i*a,M=n*s,k=n*a,F=n*u,j=o*s,H=o*a,W=o*u;return t[0]=1-x-F,t[1]=m+W,t[2]=M-H,t[3]=0,t[4]=m-W,t[5]=1-p-F,t[6]=k+j,t[7]=0,t[8]=M+H,t[9]=k-j,t[10]=1-p-x,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function kZ(t,e,r,i,n,o,s){let a=1/(r-e),u=1/(n-i),p=1/(o-s);return t[0]=o*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*u,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(n+i)*u,t[10]=(s+o)*p,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*p,t[15]=0,t}function jye(t,e,r,i,n){let o=1/Math.tan(e/2);if(t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0){let s=1/(i-n);t[10]=(n+i)*s,t[14]=2*n*i*s}else t[10]=-1,t[14]=-2*i;return t}var RZ=jye;function SUe(t,e,r,i,n){let o=1/Math.tan(e/2);if(t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0){let s=1/(i-n);t[10]=n*s,t[14]=n*i*s}else t[10]=-1,t[14]=-i;return t}function TUe(t,e,r,i){let n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+a),p=2/(n+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=-((s-a)*u*.5),t[9]=(n-o)*p*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t}function $ye(t,e,r,i,n,o,s){let a=1/(e-r),u=1/(i-n),p=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*p,t[11]=0,t[12]=(e+r)*a,t[13]=(n+i)*u,t[14]=(s+o)*p,t[15]=1,t}var OZ=$ye;function MUe(t,e,r,i,n,o,s){let a=1/(e-r),u=1/(i-n),p=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=p,t[11]=0,t[12]=(e+r)*a,t[13]=(n+i)*u,t[14]=o*p,t[15]=1,t}function DZ(t,e,r,i){let n,o,s,a,u,p,m,x,M,k,F=e[0],j=e[1],H=e[2],W=i[0],Z=i[1],Y=i[2],ee=r[0],ce=r[1],ge=r[2];return Math.abs(F-ee)<1e-6&&Math.abs(j-ce)<1e-6&&Math.abs(H-ge)<1e-6?zye(t):(x=F-ee,M=j-ce,k=H-ge,n=1/Math.sqrt(x*x+M*M+k*k),x*=n,M*=n,k*=n,o=Z*k-Y*M,s=Y*x-W*k,a=W*M-Z*x,n=Math.sqrt(o*o+s*s+a*a),n?(n=1/n,o*=n,s*=n,a*=n):(o=0,s=0,a=0),u=M*a-k*s,p=k*o-x*a,m=x*s-M*o,n=Math.sqrt(u*u+p*p+m*m),n?(n=1/n,u*=n,p*=n,m*=n):(u=0,p=0,m=0),t[0]=o,t[1]=u,t[2]=x,t[3]=0,t[4]=s,t[5]=p,t[6]=M,t[7]=0,t[8]=a,t[9]=m,t[10]=k,t[11]=0,t[12]=-(o*F+s*j+a*H),t[13]=-(u*F+p*j+m*H),t[14]=-(x*F+M*j+k*H),t[15]=1,t)}function EUe(t,e,r,i){let n=e[0],o=e[1],s=e[2],a=i[0],u=i[1],p=i[2],m=n-r[0],x=o-r[1],M=s-r[2],k=m*m+x*x+M*M;k>0&&(k=1/Math.sqrt(k),m*=k,x*=k,M*=k);let F=u*M-p*x,j=p*m-a*M,H=a*x-u*m;return k=F*F+j*j+H*H,k>0&&(k=1/Math.sqrt(k),F*=k,j*=k,H*=k),t[0]=F,t[1]=j,t[2]=H,t[3]=0,t[4]=x*H-M*j,t[5]=M*F-m*H,t[6]=m*j-x*F,t[7]=0,t[8]=m,t[9]=x,t[10]=M,t[11]=0,t[12]=n,t[13]=o,t[14]=s,t[15]=1,t}function CUe(t){return`mat4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]}, ${t[9]}, ${t[10]}, ${t[11]}, ${t[12]}, ${t[13]}, ${t[14]}, ${t[15]})`}function PUe(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8]+t[9]*t[9]+t[10]*t[10]+t[11]*t[11]+t[12]*t[12]+t[13]*t[13]+t[14]*t[14]+t[15]*t[15])}function IUe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Wye(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function kUe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function RUe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t}function OUe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function DUe(t,e){let r=t[0],i=t[1],n=t[2],o=t[3],s=t[4],a=t[5],u=t[6],p=t[7],m=t[8],x=t[9],M=t[10],k=t[11],F=t[12],j=t[13],H=t[14],W=t[15],Z=e[0],Y=e[1],ee=e[2],ce=e[3],ge=e[4],Se=e[5],ne=e[6],pe=e[7],ue=e[8],Le=e[9],We=e[10],ze=e[11],rt=e[12],at=e[13],Wt=e[14],It=e[15];return Math.abs(r-Z)<=1e-6*Math.max(1,Math.abs(r),Math.abs(Z))&&Math.abs(i-Y)<=1e-6*Math.max(1,Math.abs(i),Math.abs(Y))&&Math.abs(n-ee)<=1e-6*Math.max(1,Math.abs(n),Math.abs(ee))&&Math.abs(o-ce)<=1e-6*Math.max(1,Math.abs(o),Math.abs(ce))&&Math.abs(s-ge)<=1e-6*Math.max(1,Math.abs(s),Math.abs(ge))&&Math.abs(a-Se)<=1e-6*Math.max(1,Math.abs(a),Math.abs(Se))&&Math.abs(u-ne)<=1e-6*Math.max(1,Math.abs(u),Math.abs(ne))&&Math.abs(p-pe)<=1e-6*Math.max(1,Math.abs(p),Math.abs(pe))&&Math.abs(m-ue)<=1e-6*Math.max(1,Math.abs(m),Math.abs(ue))&&Math.abs(x-Le)<=1e-6*Math.max(1,Math.abs(x),Math.abs(Le))&&Math.abs(M-We)<=1e-6*Math.max(1,Math.abs(M),Math.abs(We))&&Math.abs(k-ze)<=1e-6*Math.max(1,Math.abs(k),Math.abs(ze))&&Math.abs(F-rt)<=1e-6*Math.max(1,Math.abs(F),Math.abs(rt))&&Math.abs(j-at)<=1e-6*Math.max(1,Math.abs(j),Math.abs(at))&&Math.abs(H-Wt)<=1e-6*Math.max(1,Math.abs(H),Math.abs(Wt))&&Math.abs(W-It)<=1e-6*Math.max(1,Math.abs(W),Math.abs(It))}var LUe=S5,BUe=Wye;var Mu={};nl(Mu,{add:()=>LZ,ceil:()=>FUe,clone:()=>Hye,copy:()=>Yye,create:()=>Gye,cross:()=>GUe,dist:()=>JUe,distance:()=>Jye,div:()=>QUe,divide:()=>Qye,dot:()=>NZ,equals:()=>XUe,exactEquals:()=>t_e,floor:()=>NUe,forEach:()=>iVe,fromValues:()=>qye,inverse:()=>WUe,len:()=>tVe,length:()=>K7,lerp:()=>zZ,max:()=>UUe,min:()=>zUe,mul:()=>KUe,multiply:()=>Kye,negate:()=>$Ue,normalize:()=>FZ,random:()=>HUe,round:()=>VUe,scale:()=>BZ,scaleAndAdd:()=>jUe,set:()=>Xye,sqrDist:()=>eVe,sqrLen:()=>rVe,squaredDistance:()=>e_e,squaredLength:()=>Q7,str:()=>YUe,sub:()=>ZUe,subtract:()=>Zye,transformMat4:()=>UZ,transformQuat:()=>VZ,zero:()=>qUe});function Gye(){let t=new _o(4);return _o!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Hye(t){let e=new _o(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function qye(t,e,r,i){let n=new _o(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}function Yye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Xye(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}function LZ(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Zye(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Kye(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Qye(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function FUe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function NUe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function zUe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function UUe(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function VUe(t,e){return t[0]=Md(e[0]),t[1]=Md(e[1]),t[2]=Md(e[2]),t[3]=Md(e[3]),t}function BZ(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function jUe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}function Jye(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+i*i+n*n+o*o)}function e_e(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],o=e[3]-t[3];return r*r+i*i+n*n+o*o}function K7(t){let e=t[0],r=t[1],i=t[2],n=t[3];return Math.sqrt(e*e+r*r+i*i+n*n)}function Q7(t){let e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n}function $Ue(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function WUe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function FZ(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=r*r+i*i+n*n+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=i*s,t[2]=n*s,t[3]=o*s,t}function NZ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function GUe(t,e,r,i){let n=r[0]*i[1]-r[1]*i[0],o=r[0]*i[2]-r[2]*i[0],s=r[0]*i[3]-r[3]*i[0],a=r[1]*i[2]-r[2]*i[1],u=r[1]*i[3]-r[3]*i[1],p=r[2]*i[3]-r[3]*i[2],m=e[0],x=e[1],M=e[2],k=e[3];return t[0]=x*p-M*u+k*a,t[1]=-(m*p)+M*s-k*o,t[2]=m*u-x*s+k*n,t[3]=-(m*a)+x*o-M*n,t}function zZ(t,e,r,i){let n=e[0],o=e[1],s=e[2],a=e[3];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s),t[3]=a+i*(r[3]-a),t}function HUe(t,e){e=e===void 0?1:e;let r,i,n,o,s,a;do r=g0()*2-1,i=g0()*2-1,s=r*r+i*i;while(s>=1);do n=g0()*2-1,o=g0()*2-1,a=n*n+o*o;while(a>=1);let u=Math.sqrt((1-s)/a);return t[0]=e*r,t[1]=e*i,t[2]=e*n*u,t[3]=e*o*u,t}function UZ(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*s,t[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*s,t[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*s,t[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*s,t}function VZ(t,e,r){let i=e[0],n=e[1],o=e[2],s=r[0],a=r[1],u=r[2],p=r[3],m=p*i+a*o-u*n,x=p*n+u*i-s*o,M=p*o+s*n-a*i,k=-s*i-a*n-u*o;return t[0]=m*p+k*-s+x*-u-M*-a,t[1]=x*p+k*-a+M*-s-m*-u,t[2]=M*p+k*-u+m*-a-x*-s,t[3]=e[3],t}function qUe(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function YUe(t){return`vec4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}function t_e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function XUe(t,e){let r=t[0],i=t[1],n=t[2],o=t[3],s=e[0],a=e[1],u=e[2],p=e[3];return Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=1e-6*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-u)<=1e-6*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-p)<=1e-6*Math.max(1,Math.abs(o),Math.abs(p))}var ZUe=Zye,KUe=Kye,QUe=Qye,JUe=Jye,eVe=e_e,tVe=K7,rVe=Q7,iVe=(function(){let t=Gye();return function(e,r,i,n,o,s){let a,u;for(r||(r=4),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,a=i;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var WZ;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(WZ||(WZ={}));var nVe=45*Math.PI/180,oVe=1,jZ=.1,$Z=500,sVe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),mn=class extends M3{static get IDENTITY(){return lVe()}static get ZERO(){return aVe()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return WZ}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,r,i,n,o,s,a,u,p,m,x,M,k,F,j,H){return this[0]=e,this[1]=r,this[2]=i,this[3]=n,this[4]=o,this[5]=s,this[6]=a,this[7]=u,this[8]=p,this[9]=m,this[10]=x,this[11]=M,this[12]=k,this[13]=F,this[14]=j,this[15]=H,this.check()}setRowMajor(e,r,i,n,o,s,a,u,p,m,x,M,k,F,j,H){return this[0]=e,this[1]=o,this[2]=p,this[3]=k,this[4]=r,this[5]=s,this[6]=m,this[7]=F,this[8]=i,this[9]=a,this[10]=x,this[11]=j,this[12]=n,this[13]=u,this[14]=M,this[15]=H,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(sVe)}fromObject(e){return this.check()}fromQuaternion(e){return IZ(this,e),this.check()}frustum(e){let{left:r,right:i,bottom:n,top:o,near:s=jZ,far:a=$Z}=e;return a===1/0?cVe(this,r,i,n,o,s):kZ(this,r,i,n,o,s,a),this.check()}lookAt(e){let{eye:r,center:i=[0,0,0],up:n=[0,1,0]}=e;return DZ(this,r,i,n),this.check()}ortho(e){let{left:r,right:i,bottom:n,top:o,near:s=jZ,far:a=$Z}=e;return OZ(this,r,i,n,o,s,a),this.check()}orthographic(e){let{fovy:r=nVe,aspect:i=oVe,focalDistance:n=1,near:o=jZ,far:s=$Z}=e;r_e(r);let a=r/2,u=n*Math.tan(a),p=u*i;return this.ortho({left:-p,right:p,bottom:-u,top:u,near:o,far:s})}perspective(e){let{fovy:r=45*Math.PI/180,aspect:i=1,near:n=.1,far:o=500}=e;return r_e(r),RZ(this,r,i,n,o),this.check()}determinant(){return wZ(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let i=this.getScale(r),n=1/i[0],o=1/i[1],s=1/i[2];return e[0]=this[0]*n,e[1]=this[1]*o,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*n,e[5]=this[5]*o,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*n,e[9]=this[9]*o,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let i=this.getScale(r),n=1/i[0],o=1/i[1],s=1/i[2];return e[0]=this[0]*n,e[1]=this[1]*o,e[2]=this[2]*s,e[3]=this[4]*n,e[4]=this[5]*o,e[5]=this[6]*s,e[6]=this[8]*n,e[7]=this[9]*o,e[8]=this[10]*s,e}transpose(){return bZ(this,this),this.check()}invert(){return xZ(this,this),this.check()}multiplyLeft(e){return S5(this,e,this),this.check()}multiplyRight(e){return S5(this,this,e),this.check()}rotateX(e){return EZ(this,this,e),this.check()}rotateY(e){return CZ(this,this,e),this.check()}rotateZ(e){return PZ(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,r){return MZ(this,this,e,r),this.check()}scale(e){return TZ(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return SZ(this,this,e),this.check()}transform(e,r){return e.length===4?(r=UZ(r||[-0,-0,-0,-0],e,this),a_(r,4),r):this.transformAsPoint(e,r)}transformAsPoint(e,r){let{length:i}=e,n;switch(i){case 2:n=uZ(r||[-0,-0],e,this);break;case 3:n=tb(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return a_(n,e.length),n}transformAsVector(e,r){let i;switch(e.length){case 2:i=xye(r||[-0,-0],e,this);break;case 3:i=V7(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return a_(i,e.length),i}transformPoint(e,r){return this.transformAsPoint(e,r)}transformVector(e,r){return this.transformAsPoint(e,r)}transformDirection(e,r){return this.transformAsVector(e,r)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,r,i){return this.identity().translate([e,r,i])}},J7,e9;function aVe(){return J7||(J7=new mn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(J7)),J7}function lVe(){return e9||(e9=new mn,Object.freeze(e9)),e9}function r_e(t){if(t>Math.PI*2)throw Error("expected radians")}function cVe(t,e,r,i,n,o){let s=2*o/(r-e),a=2*o/(n-i),u=(r+e)/(r-e),p=(n+i)/(n-i),m=-1,x=-1,M=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=p,t[10]=m,t[11]=x,t[12]=0,t[13]=0,t[14]=M,t[15]=0,t}function i_e(){let t=new _o(4);return _o!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function n_e(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function GZ(t,e,r){r=r*.5;let i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t}function HZ(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],u=r[1],p=r[2],m=r[3];return t[0]=i*m+s*a+n*p-o*u,t[1]=n*m+s*u+o*a-i*p,t[2]=o*m+s*p+i*u-n*a,t[3]=s*m-i*a-n*u-o*p,t}function o_e(t,e,r){r*=.5;let i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u+s*a,t[1]=n*u+o*a,t[2]=o*u-n*a,t[3]=s*u-i*a,t}function s_e(t,e,r){r*=.5;let i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u-o*a,t[1]=n*u+s*a,t[2]=o*u+i*a,t[3]=s*u-n*a,t}function a_e(t,e,r){r*=.5;let i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u+n*a,t[1]=n*u-i*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t}function l_e(t,e){let r=e[0],i=e[1],n=e[2];return t[0]=r,t[1]=i,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),t}function T5(t,e,r,i){let n=e[0],o=e[1],s=e[2],a=e[3],u=r[0],p=r[1],m=r[2],x=r[3],M,k,F,j,H;return M=n*u+o*p+s*m+a*x,M<0&&(M=-M,u=-u,p=-p,m=-m,x=-x),1-M>1e-6?(k=Math.acos(M),H=Math.sin(k),F=Math.sin((1-i)*k)/H,j=Math.sin(i*k)/H):(F=1-i,j=i),t[0]=F*n+j*u,t[1]=F*o+j*p,t[2]=F*s+j*m,t[3]=F*a+j*x,t}function c_e(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=r*r+i*i+n*n+o*o,a=s?1/s:0;return t[0]=-r*a,t[1]=-i*a,t[2]=-n*a,t[3]=o*a,t}function u_e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function qZ(t,e){let r=e[0]+e[4]+e[8],i;if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[n*3+n]&&(n=2);let o=(n+1)%3,s=(n+2)%3;i=Math.sqrt(e[n*3+n]-e[o*3+o]-e[s*3+s]+1),t[n]=.5*i,i=.5/i,t[3]=(e[o*3+s]-e[s*3+o])*i,t[o]=(e[o*3+n]+e[n*3+o])*i,t[s]=(e[s*3+n]+e[n*3+s])*i}return t}var h_e=LZ;var d_e=BZ,f_e=NZ,p_e=zZ,m_e=K7;var g_e=Q7;var A_e=FZ;var y_e=(function(){let t=$7(),e=G7(1,0,0),r=G7(0,1,0);return function(i,n,o){let s=b5(n,o);return s<-.999999?(eb(t,e,n),gZ(t)<1e-6&&eb(t,r,n),hZ(t,t),GZ(i,t,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(eb(t,n,o),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+s,A_e(i,i))}})(),uBt=(function(){let t=i_e(),e=i_e();return function(r,i,n,o,s,a){return T5(t,i,s,a),T5(e,n,o,a),T5(r,t,e,2*a*(1-a)),r}})(),hBt=(function(){let t=kye();return function(e,r,i,n){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],A_e(e,qZ(e,t))}})();var hVe=[0,0,0,1],E3=class extends s_{constructor(e=0,r=0,i=0,n=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,r,i,n)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,r,i,n){return this[0]=e,this[1]=r,this[2]=i,this[3]=n,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return qZ(this,e),this.check()}fromAxisRotation(e,r){return GZ(this,e,r),this.check()}identity(){return n_e(this),this.check()}setAxisAngle(e,r){return this.fromAxisRotation(e,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=On(e)}get y(){return this[1]}set y(e){this[1]=On(e)}get z(){return this[2]}set z(e){this[2]=On(e)}get w(){return this[3]}set w(e){this[3]=On(e)}len(){return m_e(this)}lengthSquared(){return g_e(this)}dot(e){return f_e(this,e)}rotationTo(e,r){return y_e(this,e,r),this.check()}add(e){return h_e(this,this,e),this.check()}calculateW(){return l_e(this,this),this.check()}conjugate(){return u_e(this,this),this.check()}invert(){return c_e(this,this),this.check()}lerp(e,r,i){return i===void 0?this.lerp(this,e,r):(p_e(this,e,r,i),this.check())}multiplyRight(e){return HZ(this,this,e),this.check()}multiplyLeft(e){return HZ(this,e,this),this.check()}normalize(){let e=this.len(),r=e>0?1/e:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,e===0&&(this[3]=1),this.check()}rotateX(e){return o_e(this,this,e),this.check()}rotateY(e){return s_e(this,this,e),this.check()}rotateZ(e){return a_e(this,this,e),this.check()}scale(e){return d_e(this,this,e),this.check()}slerp(e,r,i){let n,o,s;switch(arguments.length){case 1:({start:n=hVe,target:o,ratio:s}=e);break;case 2:n=this,o=e,s=r;break;default:n=e,o=r,s=i}return T5(this,n,o,s),this.check()}transformVector4(e,r=new Y7){return VZ(r,e,this),a_(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,r){return this.setAxisAngle(e,r)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}};var __e=1e-6,dVe=6371e3,yg=class t{constructor({phi:e=0,theta:r=0,radius:i=1,bearing:n,pitch:o,altitude:s,radiusScale:a=dVe}={}){this.phi=e,this.theta=r,this.radius=i||s||1,this.radiusScale=a||1,n!==void 0&&(this.bearing=n),o!==void 0&&(this.pitch=o),this.check()}toString(){return this.formatString(ms)}formatString({printTypes:e=!1}){let r=v5;return`${e?"Spherical":""}[rho:${r(this.radius)},theta:${r(this.theta)},phi:${r(this.phi)}]`}equals(e){return ra(this.radius,e.radius)&&ra(this.theta,e.theta)&&ra(this.phi,e.phi)}exactEquals(e){return this.radius===e.radius&&this.theta===e.theta&&this.phi===e.phi}get bearing(){return 180-o_(this.phi)}set bearing(e){this.phi=Math.PI-w3(e)}get pitch(){return o_(this.theta)}set pitch(e){this.theta=w3(e)}get longitude(){return o_(this.phi)}get latitude(){return o_(this.theta)}get lng(){return o_(this.phi)}get lat(){return o_(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(e,r,i){return this.radius=e,this.phi=r,this.theta=i,this.check()}clone(){return new t().copy(this)}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this.check()}fromLngLatZ([e,r,i]){return this.radius=1+i/this.radiusScale,this.phi=w3(r),this.theta=w3(e),this.check()}fromVector3(e){return this.radius=W7(e),this.radius>0&&(this.theta=Math.atan2(e[0],e[1]),this.phi=Math.acos(Rn(e[2]/this.radius,-1,1))),this.check()}toVector3(){return new lr(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(__e,Math.min(Math.PI-__e,this.phi)),this}check(){if(!Number.isFinite(this.phi)||!Number.isFinite(this.theta)||!(this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}};var M5={};nl(M5,{EPSILON1:()=>fVe,EPSILON10:()=>xVe,EPSILON11:()=>wVe,EPSILON12:()=>SVe,EPSILON13:()=>TVe,EPSILON14:()=>MVe,EPSILON15:()=>EVe,EPSILON16:()=>CVe,EPSILON17:()=>PVe,EPSILON18:()=>IVe,EPSILON19:()=>kVe,EPSILON2:()=>pVe,EPSILON20:()=>RVe,EPSILON3:()=>mVe,EPSILON4:()=>gVe,EPSILON5:()=>AVe,EPSILON6:()=>yVe,EPSILON7:()=>_Ve,EPSILON8:()=>vVe,EPSILON9:()=>bVe,PI_OVER_FOUR:()=>DVe,PI_OVER_SIX:()=>LVe,PI_OVER_TWO:()=>OVe,TWO_PI:()=>BVe});var fVe=.1,pVe=.01,mVe=.001,gVe=1e-4,AVe=1e-5,yVe=1e-6,_Ve=1e-7,vVe=1e-8,bVe=1e-9,xVe=1e-10,wVe=1e-11,SVe=1e-12,TVe=1e-13,MVe=1e-14,EVe=1e-15,CVe=1e-16,PVe=1e-17,IVe=1e-18,kVe=1e-19,RVe=1e-20,OVe=Math.PI/2,DVe=Math.PI/4,LVe=Math.PI/6,BVe=Math.PI*2;function YZ(t,e=[],r=0){let i=Math.fround(t),n=t-i;return e[r]=i,e[r+1]=n,e}function v_e(t){return t-Math.fround(t)}function b_e(t){let e=new Float32Array(32);for(let r=0;r<4;++r)for(let i=0;i<4;++i){let n=r*4+i;YZ(t[i*4+r],e,n*2)}return e}var FVe=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,XZ={name:"fp32",vs:FVe};var x_e=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`;var NVe={ONE:1},ZZ={name:"fp64arithmetic",vs:x_e,defaultUniforms:NVe,uniformTypes:{ONE:"f32"},fp64ify:YZ,fp64LowPart:v_e,fp64ifyMatrix4:b_e};var zVe=[0,1,1,1],UVe=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,VVe=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,t9={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:zVe},vs:UVe,fs:VVe,getUniforms:jVe};function jVe(t={},e){let r={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;let i=t.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=i}if(t.highlightColor){let i=Array.from(t.highlightColor,n=>n/255);Number.isFinite(i[3])||(i[3]=1),r.highlightColor=i}return t.isActive!==void 0&&(r.isActive=!!t.isActive,r.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(r.useFloatColors=!!t.useFloatColors),r}Vi();var KZ=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`;var w_e=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`;var $Ve=5,WVe=255,E5;(function(t){t[t.POINT=0]="POINT",t[t.DIRECTIONAL=1]="DIRECTIONAL"})(E5||(E5={}));var rb={props:{},uniforms:{},name:"lighting",defines:{},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:E5.POINT,directionalLightCount:0,pointLightCount:0,ambientColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:w_e,vs:KZ,fs:KZ,getUniforms:GVe};function GVe(t,e={}){if(t=t&&{...t},!t)return{...rb.defaultUniforms};t.lights&&(t={...t,...qVe(t.lights),lights:void 0});let{ambientLight:r,pointLights:i,directionalLights:n}=t||{};if(!(r||i&&i.length>0||n&&n.length>0))return{...rb.defaultUniforms,enabled:0};let s={...rb.defaultUniforms,...e,...HVe({ambientLight:r,pointLights:i,directionalLights:n})};return t.enabled!==void 0&&(s.enabled=t.enabled?1:0),s}function HVe({ambientLight:t,pointLights:e=[],directionalLights:r=[]}){let i={};i.ambientColor=QZ(t);let n=0;for(let o of e){i.lightType=E5.POINT;let s=n;i[`lightColor${s}`]=QZ(o),i[`lightPosition${s}`]=o.position,i[`lightAttenuation${s}`]=o.attenuation||[1,0,0],n++}for(let o of r){i.lightType=E5.DIRECTIONAL;let s=n;i[`lightColor${s}`]=QZ(o),i[`lightDirection${s}`]=o.direction,n++}return n>$Ve&&Pt.warn("MAX_LIGHTS exceeded")(),i.directionalLightCount=r.length,i.pointLightCount=e.length,i}function qVe(t){let e={pointLights:[],directionalLights:[]};for(let r of t||[])switch(r.type){case"ambient":e.ambientLight=r;break;case"directional":e.directionalLights?.push(r);break;case"point":e.pointLights?.push(r);break;default:}return e}function QZ(t={}){let{color:e=[0,0,0],intensity:r=1}=t;return e.map(i=>i*r/WVe)}var r9=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,i9=`#define MAX_LIGHTS 3

uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`;var n9=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`;var _g={props:{},name:"gouraudMaterial",vs:i9.replace("phongMaterial","gouraudMaterial"),fs:r9.replace("phongMaterial","gouraudMaterial"),source:n9.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:!0},dependencies:[rb],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){let e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{..._g.defaultUniforms,...e}}};var ib={name:"phongMaterial",dependencies:[rb],source:n9,vs:r9,fs:i9,defines:{LIGHTING_FRAGMENT:!0},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){let e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...ib.defaultUniforms,...e}}};var S_e=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,JZ={name:"layer",vs:S_e,fs:S_e,getUniforms:t=>({opacity:Math.pow(t.opacity,.45454545454545453)}),uniformTypes:{opacity:"f32"}};var YVe=`

struct ColorUniforms {
  opacity: f32,
};

var<private> color: ColorUniforms = ColorUniforms(1.0);
// TODO (kaapp) avoiding binding index collisions to handle layer opacity 
// requires some thought.
// @group(0) @binding(0) var<uniform> color: ColorUniforms;

@must_use
fn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {
    return vec4(fragColor.rgb * fragColor.a, fragColor.a); 
};
`,C3={name:"color",dependencies:[],source:YVe,getUniforms:t=>({}),uniformTypes:{opacity:"f32"}};var XVe=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,T_e="#define SMOOTH_EDGE_RADIUS 0.5",ZVe=`${T_e}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,KVe=`${T_e}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,o9={name:"geometry",source:XVe,vs:ZVe,fs:KVe};var qn;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(qn||(qn={}));var Ko;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(Ko||(Ko={}));var ei;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(ei||(ei={}));var M_e="compute",eK="auto",C5="manipulation",nb="none",P5="pan-x",I5="pan-y";function tK(t){if(t.includes(nb))return nb;let e=t.includes(P5),r=t.includes(I5);return e&&r?nb:e||r?e?P5:I5:t.includes(C5)?C5:eK}var k5=class{constructor(e,r){this.actions="",this.manager=e,this.set(r)}set(e){e===M_e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(let r of this.manager.recognizers)r.options.enable&&(e=e.concat(r.getTouchAction()));return tK(e.join(" "))}};function P3(t){return t.trim().split(/\s+/g)}function s9(t,e,r){if(t)for(let i of P3(e))t.addEventListener(i,r,!1)}function a9(t,e,r){if(t)for(let i of P3(e))t.removeEventListener(i,r,!1)}function rK(t){return(t.ownerDocument||t).defaultView}function iK(t,e){let r=t;for(;r;){if(r===e)return!0;r=r.parentNode}return!1}function l9(t){let e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let r=0,i=0,n=0;for(;n<e;)r+=t[n].clientX,i+=t[n].clientY,n++;return{x:Math.round(r/e),y:Math.round(i/e)}}function nK(t){let e=[],r=0;for(;r<t.pointers.length;)e[r]={clientX:Math.round(t.pointers[r].clientX),clientY:Math.round(t.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:e,center:l9(e),deltaX:t.deltaX,deltaY:t.deltaY}}function c9(t,e){let r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)}function oK(t,e){let r=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(r*r+i*i)}function E_e(t,e){let r=e.x-t.x,i=e.y-t.y;return Math.atan2(i,r)*180/Math.PI}function sK(t,e){let r=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.atan2(i,r)*180/Math.PI}function u9(t,e){return t===e?Ko.None:Math.abs(t)>=Math.abs(e)?t<0?Ko.Left:Ko.Right:e<0?Ko.Up:Ko.Down}function C_e(t,e){let r=e.center,i=t.offsetDelta,n=t.prevDelta,o=t.prevInput;return(e.eventType===qn.Start||o?.eventType===qn.End)&&(n=t.prevDelta={x:o?.deltaX||0,y:o?.deltaY||0},i=t.offsetDelta={x:r.x,y:r.y}),{deltaX:n.x+(r.x-i.x),deltaY:n.y+(r.y-i.y)}}function h9(t,e,r){return{x:e/t||0,y:r/t||0}}function P_e(t,e){return oK(e[0],e[1])/oK(t[0],t[1])}function I_e(t,e){return sK(e[1],e[0])-sK(t[1],t[0])}function k_e(t,e){let r=t.lastInterval||e,i=e.timeStamp-r.timeStamp,n,o,s,a;if(e.eventType!==qn.Cancel&&(i>25||r.velocity===void 0)){let u=e.deltaX-r.deltaX,p=e.deltaY-r.deltaY,m=h9(i,u,p);o=m.x,s=m.y,n=Math.abs(m.x)>Math.abs(m.y)?m.x:m.y,a=u9(u,p),t.lastInterval=e}else n=r.velocity,o=r.velocityX,s=r.velocityY,a=r.direction;e.velocity=n,e.velocityX=o,e.velocityY=s,e.direction=a}function R_e(t,e){let{session:r}=t,{pointers:i}=e,{length:n}=i;r.firstInput||(r.firstInput=nK(e)),n>1&&!r.firstMultiple?r.firstMultiple=nK(e):n===1&&(r.firstMultiple=!1);let{firstInput:o,firstMultiple:s}=r,a=s?s.center:o.center,u=e.center=l9(i);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=E_e(a,u),e.distance=c9(a,u);let{deltaX:p,deltaY:m}=C_e(r,e);e.deltaX=p,e.deltaY=m,e.offsetDirection=u9(e.deltaX,e.deltaY);let x=h9(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=x.x,e.overallVelocityY=x.y,e.overallVelocity=Math.abs(x.x)>Math.abs(x.y)?x.x:x.y,e.scale=s?P_e(s.pointers,i):1,e.rotation=s?I_e(s.pointers,i):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length;let M=t.element;return iK(e.srcEvent.target,M)&&(M=e.srcEvent.target),e.target=M,k_e(r,e),e}function O_e(t,e,r){let i=r.pointers.length,n=r.changedPointers.length,o=e&qn.Start&&i-n===0,s=e&(qn.End|qn.Cancel)&&i-n===0;r.isFirst=!!o,r.isFinal=!!s,o&&(t.session={}),r.eventType=e;let a=R_e(t,r);t.emit("hammer.input",a),t.recognize(a),t.session.prevInput=a}var R5=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,r){O_e(this.manager,e,r)}init(){s9(this.element,this.evEl,this.domHandler),s9(this.target,this.evTarget,this.domHandler),s9(rK(this.element),this.evWin,this.domHandler)}destroy(){a9(this.element,this.evEl,this.domHandler),a9(this.target,this.evTarget,this.domHandler),a9(rK(this.element),this.evWin,this.domHandler)}};var JVe={pointerdown:qn.Start,pointermove:qn.Move,pointerup:qn.End,pointercancel:qn.Cancel,pointerout:qn.Cancel},eje="pointerdown",tje="pointermove pointerup pointercancel",O5=class extends R5{constructor(e){super(e),this.evEl=eje,this.evWin=tje,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){let{store:r}=this,i=!1,n=JVe[e.type],o=e.pointerType,s=o==="touch",a=r.findIndex(u=>u.pointerId===e.pointerId);n&qn.Start&&(e.buttons||s)?a<0&&(r.push(e),a=r.length-1):n&(qn.End|qn.Cancel)&&(i=!0),!(a<0)&&(r[a]=e,this.callback(n,{pointers:r,changedPointers:[e],eventType:n,pointerType:o,srcEvent:e}),i&&r.splice(a,1))}};var rje=["","webkit","Moz","MS","ms","o"];function D_e(t,e){let r=e[0].toUpperCase()+e.slice(1);for(let i of rje){let n=i?i+r:e;if(n in t)return n}}var ije=1,L_e=2,B_e={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}},D5=class{constructor(e,r){this.options={...B_e,...r,cssProps:{...B_e.cssProps,...r.cssProps},inputTarget:r.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new O5(this),this.touchAction=new k5(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?L_e:ije}recognize(e){let{session:r}=this;if(r.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let i,{recognizers:n}=this,{curRecognizer:o}=r;(!o||o&&o.state&ei.Recognized)&&(o=r.curRecognizer=null);let s=0;for(;s<n.length;)i=n[s],r.stopped!==L_e&&(!o||i===o||i.canRecognizeWith(o))?i.recognize(e):i.reset(),!o&&i.state&(ei.Began|ei.Changed|ei.Ended)&&(o=r.curRecognizer=i),s++}get(e){let{recognizers:r}=this;for(let i=0;i<r.length;i++)if(r[i].options.event===e)return r[i];return null}add(e){if(Array.isArray(e)){for(let i of e)this.add(i);return this}let r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(let i of e)this.remove(i);return this}let r=typeof e=="string"?this.get(e):e;if(r){let{recognizers:i}=this,n=i.indexOf(r);n!==-1&&(i.splice(n,1),this.touchAction.update())}return this}on(e,r){if(!e||!r)return;let{handlers:i}=this;for(let n of P3(e))i[n]=i[n]||[],i[n].push(r)}off(e,r){if(!e)return;let{handlers:i}=this;for(let n of P3(e))r?i[n]&&i[n].splice(i[n].indexOf(r),1):delete i[n]}emit(e,r){let i=this.handlers[e]&&this.handlers[e].slice();if(!i||!i.length)return;let n=r;n.type=e,n.preventDefault=function(){r.srcEvent.preventDefault()};let o=0;for(;o<i.length;)i[o](n),o++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){let{element:r}=this;if(r){for(let[i,n]of Object.entries(this.options.cssProps)){let o=D_e(r.style,i);e?(this.oldCssProps[o]=r.style[o],r.style[o]=n):r.style[o]=this.oldCssProps[o]||""}e||(this.oldCssProps={})}}};var nje=1;function F_e(){return nje++}function aK(t){return t&ei.Cancelled?"cancel":t&ei.Ended?"end":t&ei.Changed?"move":t&ei.Began?"start":""}var vg=class{constructor(e){this.options=e,this.id=F_e(),this.state=ei.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(let n of e)this.recognizeWith(n);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;let{simultaneous:i}=this;return i[r.id]||(i[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(let i of e)this.dropRecognizeWith(i);return this}let r;return typeof e=="string"?r=this.manager.get(e):r=e,r&&delete this.simultaneous[r.id],this}requireFailure(e){if(Array.isArray(e)){for(let n of e)this.requireFailure(n);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;let{requireFail:i}=this;return i.indexOf(r)===-1&&(i.push(r),r.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(let i of e)this.dropRequireFailure(i);return this}let r;if(typeof e=="string"?r=this.manager.get(e):r=e,r){let i=this.requireFail.indexOf(r);i>-1&&this.requireFail.splice(i,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;let{state:r}=this;r<ei.Ended&&this.manager.emit(this.options.event+aK(r),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),r>=ei.Ended&&this.manager.emit(this.options.event+aK(r),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=ei.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(ei.Failed|ei.Possible)))return!1;e++}return!0}recognize(e){let r={...e};if(!this.options.enable){this.reset(),this.state=ei.Failed;return}this.state&(ei.Recognized|ei.Cancelled|ei.Failed)&&(this.state=ei.Possible),this.state=this.process(r),this.state&(ei.Began|ei.Changed|ei.Ended|ei.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}};var bg=class extends vg{attrTest(e){let r=this.options.pointers;return r===0||e.pointers.length===r}process(e){let{state:r}=this,{eventType:i}=e,n=r&(ei.Began|ei.Changed),o=this.attrTest(e);return n&&(i&qn.Cancel||!o)?r|ei.Cancelled:n||o?i&qn.End?r|ei.Ended:r&ei.Began?r|ei.Changed:ei.Began:ei.Failed}};var ob=class extends vg{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[C5]}process(e){let{options:r}=this,i=e.pointers.length===r.pointers,n=e.distance<r.threshold,o=e.deltaTime<r.time;if(this.reset(),e.eventType&qn.Start&&this.count===0)return this.failTimeout();if(n&&o&&i){if(e.eventType!==qn.End)return this.failTimeout();let s=this.pTime?e.timeStamp-this.pTime<r.interval:!0,a=!this.pCenter||c9(this.pCenter,e.center)<r.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!a||!s?this.count=1:this.count+=1,this._input=e,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=ei.Recognized,this.tryEmit(this._input)},r.interval),ei.Began):ei.Recognized}return ei.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=ei.Failed},this.options.interval),ei.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===ei.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}};var oje=["","start","move","end","cancel","up","down","left","right"],l_=class extends bg{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Ko.All,...e}),this.pX=null,this.pY=null}getTouchAction(){let{options:{direction:e}}=this,r=[];return e&Ko.Horizontal&&r.push(I5),e&Ko.Vertical&&r.push(P5),r}getEventNames(){return oje.map(e=>this.options.event+e)}directionTest(e){let{options:r}=this,i=!0,{distance:n}=e,{direction:o}=e,s=e.deltaX,a=e.deltaY;return o&r.direction||(r.direction&Ko.Horizontal?(o=s===0?Ko.None:s<0?Ko.Left:Ko.Right,i=s!==this.pX,n=Math.abs(e.deltaX)):(o=a===0?Ko.None:a<0?Ko.Up:Ko.Down,i=a!==this.pY,n=Math.abs(e.deltaY))),e.direction=o,i&&n>r.threshold&&!!(o&r.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&ei.Began)||!(this.state&ei.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;let r=Ko[e.direction].toLowerCase();r&&(e.additionalEvent=this.options.event+r),super.emit(e)}};var sje=["","start","move","end","cancel","in","out"],I3=class extends bg{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[nb]}getEventNames(){return sje.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&ei.Began))}emit(e){if(e.scale!==1){let r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}super.emit(e)}};var A0=class{constructor(e,r,i){this.element=e,this.callback=r,this.options=i}};var N_e=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Lzt=typeof window<"u"?window:global;var uje=N_e.indexOf("firefox")!==-1,z_e=4.000244140625,hje=40,dje=.25,d9=class extends A0{constructor(e,r,i){super(e,r,{enable:!0,...i}),this.handleEvent=n=>{if(!this.options.enable)return;let o=n.deltaY;globalThis.WheelEvent&&(uje&&n.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(o/=globalThis.devicePixelRatio),n.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(o*=hje)),o!==0&&o%z_e===0&&(o=Math.floor(o/z_e)),n.shiftKey&&o&&(o=o*dje),this.callback({type:"wheel",center:{x:n.clientX,y:n.clientY},delta:-o,srcEvent:n,pointerType:"mouse",target:n.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,r){e==="wheel"&&(this.options.enable=r)}};var U_e=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],f9=class extends A0{constructor(e,r,i){super(e,r,{enable:!0,...i}),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;let{enable:n}=this.options;this.enableMoveEvent=n,this.enableLeaveEvent=n,this.enableEnterEvent=n,this.enableOutEvent=n,this.enableOverEvent=n,U_e.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){U_e.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){switch(e){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break;default:}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break;default:}}_emit(e,r){this.callback({type:e,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}};var V_e=["keydown","keyup"],p9=class extends A0{constructor(e,r,i){super(e,r,{enable:!0,tabIndex:0,...i}),this.handleEvent=n=>{let o=n.target||n.srcElement;o.tagName==="INPUT"&&o.type==="text"||o.tagName==="TEXTAREA"||(this.enableDownEvent&&n.type==="keydown"&&this.callback({type:"keydown",srcEvent:n,key:n.key,target:n.target}),this.enableUpEvent&&n.type==="keyup"&&this.callback({type:"keyup",srcEvent:n,key:n.key,target:n.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",V_e.forEach(n=>e.addEventListener(n,this.handleEvent))}destroy(){V_e.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){e==="keydown"&&(this.enableDownEvent=r),e==="keyup"&&(this.enableUpEvent=r)}};var m9=class extends A0{constructor(e,r,i){super(e,r,i),this.handleEvent=n=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,r){e==="contextmenu"&&(this.options.enable=r)}};var fje={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},pje=0,mje=1,gje=2,Aje=1,yje=2,_je=4;function j_e(t){let e=fje[t.srcEvent.type];if(!e)return null;let{buttons:r,button:i}=t.srcEvent,n=!1,o=!1,s=!1;return e===2?(n=!!(r&Aje),o=!!(r&_je),s=!!(r&yje)):(n=i===pje,o=i===mje,s=i===gje),{leftButton:n,middleButton:o,rightButton:s}}function $_e(t,e){let r=t.center;if(!r)return null;let i=e.getBoundingClientRect(),n=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1,s={x:(r.x-i.left-e.clientLeft)/n,y:(r.y-i.top-e.clientTop)/o};return{center:r,offsetCenter:s}}var vje={srcElement:"root",priority:0},g9=class{constructor(e,r){this.handleEvent=i=>{if(this.isEmpty())return;let n=this._normalizeEvent(i),o=i.srcEvent.target;for(;o&&o!==n.rootElement;){if(this._emit(n,o),n.handled)return;o=o.parentNode}this._emit(n,"root")},this.eventManager=e,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,r,i,n=!1,o=!1){let{handlers:s,handlersByElement:a}=this,u={...vje,...i},p=a.get(u.srcElement);p||(p=[],a.set(u.srcElement,p));let m={type:e,handler:r,srcElement:u.srcElement,priority:u.priority};n&&(m.once=!0),o&&(m.passive=!0),s.push(m),this._active=this._active||!m.passive;let x=p.length-1;for(;x>=0&&!(p[x].priority>=m.priority);)x--;p.splice(x+1,0,m)}remove(e,r){let{handlers:i,handlersByElement:n}=this;for(let o=i.length-1;o>=0;o--){let s=i[o];if(s.type===e&&s.handler===r){i.splice(o,1);let a=n.get(s.srcElement);a.splice(a.indexOf(s),1),a.length===0&&n.delete(s.srcElement)}}this._active=i.some(o=>!o.passive)}_emit(e,r){let i=this.handlersByElement.get(r);if(i){let n=!1,o=()=>{e.handled=!0},s=()=>{e.handled=!0,n=!0},a=[];for(let u=0;u<i.length;u++){let{type:p,handler:m,once:x}=i[u];if(m({...e,type:p,stopPropagation:o,stopImmediatePropagation:s}),x&&a.push(i[u]),n)break}for(let u=0;u<a.length;u++){let{type:p,handler:m}=a[u];this.remove(p,m)}}}_normalizeEvent(e){let r=this.eventManager.getElement();return{...e,...j_e(e),...$_e(e,r),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}};function bje(t){if("recognizer"in t)return t;let e,r=Array.isArray(t)?[...t]:[t];if(typeof r[0]=="function"){let i=r.shift(),n=r.shift()||{};e=new i(n)}else e=r.shift();return{recognizer:e,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}var L5=class{constructor(e=null,r={}){if(this._onBasicInput=i=>{this.manager.emit(i.srcEvent.type,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=e,!!e){this.manager=new D5(e,this.options);for(let i of this.options.recognizers){let{recognizer:n,recognizeWith:o,requireFailure:s}=bje(i);this.manager.add(n),o&&n.recognizeWith(o),s&&n.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new d9(e,this._onOtherEvent,{enable:!1}),this.moveInput=new f9(e,this._onOtherEvent,{enable:!1}),this.keyInput=new p9(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new m9(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,r,i){this._addEventHandler(e,r,i,!1)}once(e,r,i){this._addEventHandler(e,r,i,!0)}watch(e,r,i){this._addEventHandler(e,r,i,!1,!0)}off(e,r){this._removeEventHandler(e,r)}_toggleRecognizer(e,r){let{manager:i}=this;if(!i)return;let n=i.get(e);n&&(n.set({enable:r}),i.touchAction.update()),this.wheelInput?.enableEventType(e,r),this.moveInput?.enableEventType(e,r),this.keyInput?.enableEventType(e,r),this.contextmenuInput?.enableEventType(e,r)}_addEventHandler(e,r,i,n,o){if(typeof e!="string"){i=r;for(let[p,m]of Object.entries(e))this._addEventHandler(p,m,i,n,o);return}let{manager:s,events:a}=this;if(!s)return;let u=a.get(e);if(!u){let p=this._getRecognizerName(e)||e;u=new g9(this,p),a.set(e,u),s&&s.on(e,u.handleEvent)}u.add(e,r,i,n,o),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,r){if(typeof e!="string"){for(let[o,s]of Object.entries(e))this._removeEventHandler(o,s);return}let{events:i}=this,n=i.get(e);if(n&&(n.remove(e,r),n.isEmpty())){let{recognizerName:o}=n,s=!1;for(let a of i.values())if(a.recognizerName===o&&!a.isEmpty()){s=!0;break}s||this._toggleRecognizer(o,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(r=>r.getEventNames().includes(e))?.options.event}};var Gr={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Gr,"IDENTITY",{get:()=>(mr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});var Ga={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},As={common:0,meters:1,pixels:2},B5={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},lK={multipan:[l_,{threshold:10,direction:Ko.Vertical,pointers:2}],pinch:[I3,{},null,["multipan"]],pan:[l_,{threshold:1},["pinch"],["multipan"]],dblclick:[ob,{event:"dblclick",taps:2}],click:[ob,{event:"click"},null,["dblclick"]]};function xje(t,e){if(t===e)return!0;if(Array.isArray(t)){let r=t.length;if(!e||e.length!==r)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}return!1}function y0(t){let e={},r;return i=>{for(let n in i)if(!xje(i[n],e[n])){r=t(i),e=i;break}return r}}var W_e=[0,0,0,0],wje=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],G_e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Sje=[0,0,0],H_e=[0,0,0],Tje=y0(Eje);function cK(t,e,r=H_e){r.length<3&&(r=[r[0],r[1],0]);let i=r,n,o=!0;switch(e===Gr.LNGLAT_OFFSETS||e===Gr.METER_OFFSETS?n=r:n=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Ga.WEB_MERCATOR:(e===Gr.LNGLAT||e===Gr.CARTESIAN)&&(n=[0,0,0],o=!1);break;case Ga.WEB_MERCATOR_AUTO_OFFSET:e===Gr.LNGLAT?i=n:e===Gr.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],n=t.unprojectPosition(i),i[0]-=r[0],i[1]-=r[1],i[2]-=r[2]);break;case Ga.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case Ga.GLOBE:o=!1,n=null;break;default:o=!1}return{geospatialOrigin:n,shaderCoordinateOrigin:i,offsetMode:o}}function Mje(t,e,r){let{viewMatrixUncentered:i,projectionMatrix:n}=t,{viewMatrix:o,viewProjectionMatrix:s}=t,a=W_e,u=W_e,p=t.cameraPosition,{geospatialOrigin:m,shaderCoordinateOrigin:x,offsetMode:M}=cK(t,e,r);return M&&(u=t.projectPosition(m||x),p=[p[0]-u[0],p[1]-u[1],p[2]-u[2]],u[3]=1,a=Mu.transformMat4([],u,s),o=i||o,s=ia.multiply([],n,o),s=ia.multiply([],s,wje)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:u,cameraPosCommon:p,shaderCoordinateOrigin:x,geospatialOrigin:m}}function q_e({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:i=Gr.DEFAULT,coordinateOrigin:n=H_e,autoWrapLongitude:o=!1}){i===Gr.DEFAULT&&(i=t.isGeospatial?Gr.LNGLAT:Gr.CARTESIAN);let s=Tje({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:n});return s.wrapLongitude=o,s.modelMatrix=r||G_e,s}function Eje({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i}){let{projectionCenter:n,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:u,geospatialOrigin:p}=Mje(t,r,i),m=t.getDistanceScales(),x=[t.width*e,t.height*e],M=Mu.transformMat4([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,k={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:u,commonOrigin:s.slice(0,3),center:n,pseudoMeters:!!t._pseudoMeters,viewportSize:x,devicePixelRatio:e,focalDistance:M,commonUnitsPerMeter:m.unitsPerMeter,commonUnitsPerWorldUnit:m.unitsPerMeter,commonUnitsPerWorldUnit2:Sje,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:G_e,cameraPosition:a};if(p){let F=t.getDistanceScales(p);switch(r){case Gr.METER_OFFSETS:k.commonUnitsPerWorldUnit=F.unitsPerMeter,k.commonUnitsPerWorldUnit2=F.unitsPerMeter2;break;case Gr.LNGLAT:case Gr.LNGLAT_OFFSETS:t._pseudoMeters||(k.commonUnitsPerMeter=F.unitsPerMeter),k.commonUnitsPerWorldUnit=F.unitsPerDegree,k.commonUnitsPerWorldUnit2=F.unitsPerDegree2;break;case Gr.CARTESIAN:k.commonUnitsPerWorldUnit=[1,1,F.unitsPerMeter[2]],k.commonUnitsPerWorldUnit2=[0,0,F.unitsPerMeter2[2]];break;default:break}}return k}var Cje=Object.keys(Gr).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Gr[t]};`).join(""),Pje=Object.keys(Ga).map(t=>`const PROJECTION_MODE_${t}: i32 = ${Ga[t]};`).join(""),Ije=Object.keys(As).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${As[t]};`).join(""),kje=`${Cje}
${Pje}
${Ije}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,Y_e=`${kje}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the z\u2011axis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`;var Rje=Object.keys(Gr).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Gr[t]};`).join(""),Oje=Object.keys(Ga).map(t=>`const int PROJECTION_MODE_${t} = ${Ga[t]};`).join(""),Dje=Object.keys(As).map(t=>`const int UNIT_${t.toUpperCase()} = ${As[t]};`).join(""),X_e=`${Rje}
${Oje}
${Dje}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`;var Lje={};function Bje(t=Lje){return"viewport"in t?q_e(t):{}}var Uf={name:"project",dependencies:[XZ,o9],source:Y_e,vs:X_e,getUniforms:Bje,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}};var Fje=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,Nje=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,No={name:"project32",dependencies:[Uf],source:Fje,vs:Nje};function uK(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function c_(t,e){let r=Mu.transformMat4([],e,t);return Mu.scale(r,r,1/r[3]),r}function hK(t,e){let r=t%e;return r<0?e+r:r}function Z_e(t,e,r){return r*e+(1-r)*t}function F5(t,e,r){return t<e?e:t>r?r:t}function zje(t){return Math.log(t)*Math.LOG2E}var k3=Math.log2||zje;function Vf(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}var jf=Math.PI,K_e=jf/4,Ed=jf/180,dK=180/jf,R3=512,A9=4003e4,Cd=85.051129,Q_e=1.5;function N5(t){return Math.pow(2,t)}function y9(t){return k3(t)}function Ha(t){let[e,r]=t;Vf(Number.isFinite(e)),Vf(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");let i=e*Ed,n=r*Ed,o=R3*(i+jf)/(2*jf),s=R3*(jf+Math.log(Math.tan(K_e+n*.5)))/(2*jf);return[o,s]}function Eu(t){let[e,r]=t,i=e/R3*(2*jf)-jf,n=2*(Math.atan(Math.exp(r/R3*(2*jf)-jf))-K_e);return[i*dK,n*dK]}function z5(t){let{latitude:e}=t;Vf(Number.isFinite(e));let r=Math.cos(e*Ed);return y9(A9*r)-9}function sb(t){let e=Math.cos(t*Ed);return R3/A9/e}function O3(t){let{latitude:e,longitude:r,highPrecision:i=!1}=t;Vf(Number.isFinite(e)&&Number.isFinite(r));let n=R3,o=Math.cos(e*Ed),s=n/360,a=s/o,u=n/A9/o,p={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[s,a,u],degreesPerUnit:[1/s,1/a,1/u]};if(i){let m=Ed*Math.tan(e*Ed)/o,x=s*m/2,M=n/A9*m,k=M/a*u;p.unitsPerDegree2=[0,x,M],p.unitsPerMeter2=[k,0,k]}return p}function U5(t,e){let[r,i,n]=t,[o,s,a]=e,{unitsPerMeter:u,unitsPerMeter2:p}=O3({longitude:r,latitude:i,highPrecision:!0}),m=Ha(t);m[0]+=o*(u[0]+p[0]*s),m[1]+=s*(u[1]+p[1]*s);let x=Eu(m),M=(n||0)+(a||0);return Number.isFinite(n)||Number.isFinite(a)?[x[0],x[1],M]:x}function _9(t){let{height:e,pitch:r,bearing:i,altitude:n,scale:o,center:s}=t,a=uK();ia.translate(a,a,[0,0,-n]),ia.rotateX(a,a,-r*Ed),ia.rotateZ(a,a,i*Ed);let u=o/e;return ia.scale(a,a,[u,u,u]),s&&ia.translate(a,a,Ol.negate([],s)),a}function fK(t){let{width:e,height:r,altitude:i,pitch:n=0,offset:o,center:s,scale:a,nearZMultiplier:u=1,farZMultiplier:p=1}=t,{fovy:m=xg(Q_e)}=t;i!==void 0&&(m=xg(i));let x=m*Ed,M=n*Ed,k=wg(m),F=k;s&&(F+=s[2]*a/Math.cos(M)/r);let j=x*(.5+(o?o[1]:0)/r),H=Math.sin(j)*F/Math.sin(F5(Math.PI/2-M-j,.01,Math.PI-.01)),W=Math.sin(M)*H+F,Z=F*10,Y=Math.min(W*p,Z);return{fov:x,aspect:e/r,focalDistance:k,near:u,far:Y}}function xg(t){return 2*Math.atan(.5/t)*dK}function wg(t){return .5/Math.tan(.5*t*Ed)}function D3(t,e){let[r,i,n=0]=t;return Vf(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(n)),c_(e,[r,i,n,1])}function Pd(t,e,r=0){let[i,n,o]=t;if(Vf(Number.isFinite(i)&&Number.isFinite(n),"invalid pixel coordinate"),Number.isFinite(o))return c_(e,[i,n,o,1]);let s=c_(e,[i,n,0,1]),a=c_(e,[i,n,1,1]),u=s[2],p=a[2],m=u===p?0:((r||0)-u)/(p-u);return Wa.lerp([],s,a,m)}function v9(t){let{width:e,height:r,bounds:i,minExtent:n=0,maxZoom:o=24,offset:s=[0,0]}=t,[[a,u],[p,m]]=i,x=Uje(t.padding),M=Ha([a,F5(m,-Cd,Cd)]),k=Ha([p,F5(u,-Cd,Cd)]),F=[Math.max(Math.abs(k[0]-M[0]),n),Math.max(Math.abs(k[1]-M[1]),n)],j=[e-x.left-x.right-Math.abs(s[0])*2,r-x.top-x.bottom-Math.abs(s[1])*2];Vf(j[0]>0&&j[1]>0);let H=j[0]/F[0],W=j[1]/F[1],Z=(x.right-x.left)/2/H,Y=(x.top-x.bottom)/2/W,ee=[(k[0]+M[0])/2+Z,(k[1]+M[1])/2+Y],ce=Eu(ee),ge=Math.min(o,k3(Math.abs(Math.min(H,W))));return Vf(Number.isFinite(ge)),{longitude:ce[0],latitude:ce[1],zoom:ge}}function Uje(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Vf(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}var J_e=Math.PI/180;function b9(t,e=0){let{width:r,height:i,unproject:n}=t,o={targetZ:e},s=n([0,i],o),a=n([r,i],o),u,p,m=t.fovy?.5*t.fovy*J_e:Math.atan(.5/t.altitude),x=(90-t.pitch)*J_e;return m>x-.01?(u=eve(t,0,e),p=eve(t,r,e)):(u=n([0,0],o),p=n([r,0],o)),[s,a,p,u]}function eve(t,e,r){let{pixelUnprojectionMatrix:i}=t,n=c_(i,[e,0,1,1]),o=c_(i,[e,t.height,1,1]),a=(r*t.distanceScales.unitsPerMeter[2]-n[2])/(o[2]-n[2]),u=Wa.lerp([],n,o,a),p=Eu(u);return p.push(r),p}var tve=512;function pK(t){let{width:e,height:r,pitch:i=0}=t,{longitude:n,latitude:o,zoom:s,bearing:a=0}=t;(n<-180||n>180)&&(n=hK(n+180,360)-180),(a<-180||a>180)&&(a=hK(a+180,360)-180);let u=k3(r/tve);if(s<=u)s=u,o=0;else{let p=r/2/Math.pow(2,s),m=Eu([0,p])[1];if(o<m)o=m;else{let x=Eu([0,tve-p])[1];o>x&&(o=x)}}return{width:e,height:r,longitude:n,latitude:o,zoom:s,pitch:i,bearing:a}}var rve=.01,jje=["longitude","latitude","zoom"],ive={curve:1.414,speed:1.2};function mK(t,e,r,i){let{startZoom:n,startCenterXY:o,uDelta:s,w0:a,u1:u,S:p,rho:m,rho2:x,r0:M}=nve(t,e,i);if(u<rve){let ee={};for(let ce of jje){let ge=t[ce],Se=e[ce];ee[ce]=Z_e(ge,Se,r)}return ee}let k=r*p,F=Math.cosh(M)/Math.cosh(M+m*k),j=a*((Math.cosh(M)*Math.tanh(M+m*k)-Math.sinh(M))/x)/u,H=1/F,W=n+y9(H),Z=Wa.scale([],s,j);Wa.add(Z,Z,o);let Y=Eu(Z);return{longitude:Y[0],latitude:Y[1],zoom:W}}function gK(t,e,r){let i={...ive,...r},{screenSpeed:n,speed:o,maxDuration:s}=i,{S:a,rho:u}=nve(t,e,i),p=1e3*a,m;return Number.isFinite(n)?m=p/(n/u):m=p/o,Number.isFinite(s)&&m>s?0:m}function nve(t,e,r){r=Object.assign({},ive,r);let i=r.curve,n=t.zoom,o=[t.longitude,t.latitude],s=N5(n),a=e.zoom,u=[e.longitude,e.latitude],p=N5(a-n),m=Ha(o),x=Ha(u),M=Wa.sub([],x,m),k=Math.max(t.width,t.height),F=k/p,j=Wa.length(M)*s,H=Math.max(j,rve),W=i*i,Z=(F*F-k*k+W*W*H*H)/(2*k*W*H),Y=(F*F-k*k-W*W*H*H)/(2*F*W*H),ee=Math.log(Math.sqrt(Z*Z+1)-Z),ce=Math.log(Math.sqrt(Y*Y+1)-Y),ge=(ce-ee)/i;return{startZoom:n,startCenterXY:m,uDelta:M,w0:k,u1:j,S:ge,rho:i,rho2:W,r0:ee,r1:ce}}var ove=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,Wje=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Gje=`
${ove}
${Wje}
`,Hje=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,qje=`
${ove}
${Hje}
`,Yje=y0(Jje),Xje=y0(e$e),Zje=[0,0,0,1],Kje=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Qje(t,e){let[r,i,n]=t,o=Pd([r,i,n],e);return Number.isFinite(n)?o:[o[0],o[1],0]}function Jje({viewport:t,center:e}){return new mn(t.viewProjectionMatrix).invert().transform(e)}function e$e({viewport:t,shadowMatrices:e}){let r=[],i=t.pixelUnprojectionMatrix,n=t.isGeospatial?void 0:1,o=[[0,0,n],[t.width,0,n],[0,t.height,n],[t.width,t.height,n],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>Qje(s,i));for(let s of e){let a=s.clone().translate(new lr(t.center).negate()),u=o.map(m=>a.transform(m)),p=new mn().ortho({left:Math.min(...u.map(m=>m[0])),right:Math.max(...u.map(m=>m[0])),bottom:Math.min(...u.map(m=>m[1])),top:Math.max(...u.map(m=>m[1])),near:Math.min(...u.map(m=>-m[2])),far:Math.max(...u.map(m=>-m[2]))});r.push(p.multiplyRight(s))}return r}function t$e(t){let{shadowEnabled:e=!0,project:r}=t;if(!e||!r||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};let i=Uf.getUniforms(r),n=Yje({viewport:r.viewport,center:i.center}),o=[],s=Xje({shadowMatrices:t.shadowMatrices,viewport:r.viewport}).slice();for(let u=0;u<t.shadowMatrices.length;u++){let p=s[u],m=p.clone().translate(new lr(r.viewport.center).negate());i.coordinateSystem===Gr.LNGLAT&&i.projectionMode===Ga.WEB_MERCATOR?(s[u]=m,o[u]=n):(s[u]=p.clone().multiplyRight(Kje),o[u]=m.transform(n))}let a={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||Zje,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let u=0;u<s.length;u++)a[`viewProjectionMatrix${u}`]=s[u],a[`projectCenter${u}`]=o[u];for(let u=0;u<2;u++)a[`shadow_uShadowMap${u}`]=t.shadowMaps&&t.shadowMaps[u]||t.dummyShadowMap;return a}var x9={name:"shadow",dependencies:[Uf],vs:Gje,fs:qje,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:t$e,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}};var Os={...t9,defaultUniforms:{...t9.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}};var r$e=[o9],i$e=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],n$e=[];function sve(t){let e=$1.getDefaultShaderAssembler();for(let i of r$e)e.addDefaultModule(i);e._hookFunctions.length=0;let r=t==="glsl"?i$e:n$e;for(let i of r)e.addShaderHook(i);return e}var o$e=[255,255,255],s$e=1,a$e=0,w9=class{constructor(e={}){this.type="ambient";let{color:r=o$e}=e,{intensity:i=s$e}=e;this.id=e.id||`ambient-${a$e++}`,this.color=r,this.intensity=i}};var l$e=[255,255,255],c$e=1,u$e=[0,0,-1],h$e=0,V5=class{constructor(e={}){this.type="directional";let{color:r=l$e}=e,{intensity:i=c$e}=e,{direction:n=u$e}=e,{_shadow:o=!1}=e;this.id=e.id||`directional-${h$e++}`,this.color=r,this.intensity=i,this.type="directional",this.direction=new lr(n).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}};var j5=class{constructor(e,r={id:"pass"}){let{id:i}=r;this.id=i,this.device=e,this.props={...r}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}};var Id=class extends j5{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){let[r,i]=this.device.canvasContext.getDrawingBufferSize(),n=e.clearCanvas??!0,o=e.clearColor??(n?[0,0,0,0]:!1),s=n?1:!1,a=n?0:!1,u=e.colorMask??15,p={viewport:[0,0,r,i]};e.colorMask&&(p.colorMask=u),e.scissorRect&&(p.scissorRect=e.scissorRect);let m=this.device.beginRenderPass({framebuffer:e.target,parameters:p,clearColor:o,clearDepth:s,clearStencil:a});try{return this._drawLayers(m,e)}finally{m.end(),this.device.submit()}}_drawLayers(e,r){let{target:i,shaderModuleProps:n,viewports:o,views:s,onViewportActive:a,clearStack:u=!0}=r;r.pass=r.pass||"unknown",u&&(this._lastRenderIndex=-1);let p=[];for(let m of o){let x=s&&s[m.id];a?.(m);let M=this._getDrawLayerParams(m,r),k=m.subViewports||[m];for(let F of k){let j=this._drawLayersInViewport(e,{target:i,shaderModuleProps:n,viewport:F,view:x,pass:r.pass,layers:r.layers},M);p.push(j)}}return p}_getDrawLayerParams(e,{layers:r,pass:i,isPicking:n=!1,layerFilter:o,cullRect:s,effects:a,shaderModuleProps:u},p=!1){let m=[],x=lve(this._lastRenderIndex+1),M={layer:r[0],viewport:e,isPicking:n,renderPass:i,cullRect:s},k={};for(let F=0;F<r.length;F++){let j=r[F],H=this._shouldDrawLayer(j,M,o,k),W={shouldDrawLayer:H};H&&!p&&(W.shouldDrawLayer=!0,W.layerRenderIndex=x(j,H),W.shaderModuleProps=this._getShaderModuleProps(j,a,i,u),W.layerParameters={...j.context.deck?.props.parameters,...this.getLayerParameters(j,F,e)}),m[F]=W}return m}_drawLayersInViewport(e,{layers:r,shaderModuleProps:i,pass:n,target:o,viewport:s,view:a},u){let p=d$e(this.device,{shaderModuleProps:i,target:o,viewport:s});if(a){let{clear:x,clearColor:M,clearDepth:k,clearStencil:F}=a.props;if(x){let j=[0,0,0,0],H=1,W=0;Array.isArray(M)?j=[...M.slice(0,3),M[3]||255].map(Y=>Y/255):M===!1&&(j=!1),k!==void 0&&(H=k),F!==void 0&&(W=F),this.device.beginRenderPass({framebuffer:o,parameters:{viewport:p,scissorRect:p},clearColor:j,clearDepth:H,clearStencil:W}).end()}}let m={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:p});for(let x=0;x<r.length;x++){let M=r[x],k=u[x],{shouldDrawLayer:F}=k;if(F&&M.props.pickable&&m.pickableCount++,M.isComposite&&m.compositeCount++,M.isDrawable&&k.shouldDrawLayer){let{layerRenderIndex:j,shaderModuleProps:H,layerParameters:W}=k;m.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,j),H.project&&(H.project.viewport=s),M.context.renderPass=e;try{M._drawLayer({renderPass:e,shaderModuleProps:H,uniforms:{layerIndex:j},parameters:W})}catch(Z){M.raiseError(Z,`drawing ${M} to ${n}`)}}}return m}shouldDrawLayer(e){return!0}getShaderModuleProps(e,r,i){return null}getLayerParameters(e,r,i){return e.props.parameters}_shouldDrawLayer(e,r,i,n){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(i){let a=r.layer.id;if(a in n||(n[a]=i(r)),!n[a])return!1}return e.activateViewport(r.viewport),!0}_getShaderModuleProps(e,r,i,n){let o=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,a={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:o,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(r)for(let u of r)ave(a,u.getShaderModuleProps?.(e,a));return ave(a,this.getShaderModuleProps(e,r,a),n)}};function lve(t=0,e={}){let r={},i=(n,o)=>{let s=n.props._offset,a=n.id,u=n.parent&&n.parent.id,p;if(u&&!(u in e)&&i(n.parent,!1),u in r){let m=r[u]=r[u]||lve(e[u],e);p=m(n,o),r[a]=m}else Number.isFinite(s)?(p=s+(e[u]||0),r[a]=null):p=t;return o&&p>=t&&(t=p+1),e[a]=p,p};return i}function d$e(t,{shaderModuleProps:e,target:r,viewport:i}){let n=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,o]=t.canvasContext.getDrawingBufferSize(),s=r?r.height:o,a=i;return[a.x*n,s-(a.y+a.height)*n,a.width*n,a.height*n]}function ave(t,...e){for(let r of e)if(r)for(let i in r)t[i]?Object.assign(t[i],r[i]):t[i]=r[i];return t}var $5=class extends Id{constructor(e,r){super(e,r);let i=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),n=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[i],depthStencilAttachment:n})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){let r=this.fbo,i=this.device.canvasContext.cssToDeviceRatio(),n=e.viewports[0],o=n.width*i,s=n.height*i,a=[1,1,1,1];(o!==r.width||s!==r.height)&&r.resize({width:o,height:s}),super.render({...e,clearColor:a,target:r,pass:"shadow"})}getLayerParameters(e,r,i){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,r,i){return{shadow:{project:i.project,drawToShadowMap:!0}}}};var f$e={color:[255,255,255],intensity:1},cve=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],p$e=[0,0,0,200/255],L3=class{constructor(e={}){this.id="lighting-effect",this.shadowColor=p$e,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;let{device:r,deck:i}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),i._addDefaultShaderModule(x9),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(let r in e){let i=e[r];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break;default:}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:r,viewports:i,onViewportActive:n,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:r,viewports:i,onViewportActive:n,views:o,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,r){let i=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},n={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},o=e.props.material;return{shadow:i,lighting:n,phongMaterial:o,gouraudMaterial:o}}cleanup(e){for(let r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(x9))}_calculateMatrices(){let e=[];for(let r of this.directionalLights){let i=new mn().lookAt({eye:new lr(r.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let r=0;r<this.directionalLights.length;r++){let i=new $5(e);this.shadowPasses[r]=i}}_applyDefaultLights(){let{ambientLight:e,pointLights:r,directionalLights:i}=this;!e&&r.length===0&&i.length===0&&(this.ambientLight=new w9(f$e),this.directionalLights.push(new V5(cve[0]),new V5(cve[1])))}};var AK=class{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,r,{size:i=1,type:n,padding:o=0,copy:s=!1,initialize:a=!1,maxCount:u}){let p=n||e&&e.constructor||Float32Array,m=r*i+o;if(ArrayBuffer.isView(e)){if(m<=e.length)return e;if(m*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new p(e.buffer,0,m)}let x=1/0;u&&(x=u*i+o);let M=this._allocate(p,m,a,x);return e&&s?M.set(e):a||M.fill(0,0,4),this._release(e),M}release(e){this._release(e)}_allocate(e,r,i,n){let o=Math.max(Math.ceil(r*this.opts.overAlloc),1);o>n&&(o=n);let s=this._pool,a=e.BYTES_PER_ELEMENT*o,u=s.findIndex(p=>p.byteLength>=a);if(u>=0){let p=new e(s.splice(u,1)[0],0,o);return i&&p.fill(0),p}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;let r=this._pool,{buffer:i}=e,{byteLength:n}=i,o=r.findIndex(s=>s.byteLength>=n);o<0?r.push(i):(o>0||r.length<this.opts.poolSize)&&r.splice(o,0,i),r.length>this.opts.poolSize&&r.shift()}},$f=new AK;function F3(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ab(t,e){let r=t%e;return r<0?e+r:r}function hve(t){return[t[12],t[13],t[14]]}function dve(t){return{left:B3(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:B3(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:B3(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:B3(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:B3(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:B3(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}var uve=new lr;function B3(t,e,r,i){uve.set(t,e,r);let n=uve.len();return{distance:i/n,normal:new lr(-t/n,-e/n,-r/n)}}function m$e(t){return t-Math.fround(t)}var W5;function S9(t,e){let{size:r=1,startIndex:i=0}=e,n=e.endIndex!==void 0?e.endIndex:t.length,o=(n-i)/r;W5=$f.allocate(W5,o,{type:Float32Array,size:r*2});let s=i,a=0;for(;s<n;){for(let u=0;u<r;u++){let p=t[s++];W5[a+u]=p,W5[a+u+r]=m$e(p)}a+=r*2}return W5.subarray(0,o*r*2)}function fve(t){let e=null,r=!1;for(let i of t)i&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}var g$e=Math.PI/180,A$e=F3(),pve=[0,0,0],y$e={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function _$e({width:t,height:e,orthographic:r,fovyRadians:i,focalDistance:n,padding:o,near:s,far:a}){let u=t/e,p=r?new mn().orthographic({fovy:i,aspect:u,focalDistance:n,near:s,far:a}):new mn().perspective({fovy:i,aspect:u,near:s,far:a});if(o){let{left:m=0,right:x=0,top:M=0,bottom:k=0}=o,F=Rn((m+t-x)/2,0,t)-t/2,j=Rn((M+e-k)/2,0,e)-e/2;p[8]-=F*2/t,p[9]+=j*2/e}return p}var T9=class t{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||y$e,this.focalDistance=e.focalDistance||1,this.position=e.position||pve,this.modelMatrix=e.modelMatrix||null;let{longitude:r,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(r),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Ga.WEB_MERCATOR:Ga.WEB_MERCATOR_AUTO_OFFSET:Ga.IDENTITY}equals(e){return e instanceof t?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&ra(e.projectionMatrix,this.projectionMatrix)&&ra(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:r=!0}={}){let i=this.projectPosition(e),n=D3(i,this.pixelProjectionMatrix),[o,s]=n,a=r?s:this.height-s;return e.length===2?[o,a]:[o,a,n[2]]}unproject(e,{topLeft:r=!0,targetZ:i}={}){let[n,o,s]=e,a=r?o:this.height-o,u=i&&i*this.distanceScales.unitsPerMeter[2],p=Pd([n,a,s],this.pixelUnprojectionMatrix,u),[m,x,M]=this.unprojectPosition(p);return Number.isFinite(s)?[m,x,M]:Number.isFinite(i)?[m,x,i]:[m,x]}projectPosition(e){let[r,i]=this.projectFlat(e),n=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,i,n]}unprojectPosition(e){let[r,i]=this.unprojectFlat(e),n=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[r,i,n]}projectFlat(e){if(this.isGeospatial){let r=Ha(e);return r[1]=Rn(r[1],-318,830),r}return e}unprojectFlat(e){return this.isGeospatial?Eu(e):e}getBounds(e={}){let r={targetZ:e.z||0},i=this.unproject([0,0],r),n=this.unproject([this.width,0],r),o=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(i[0],n[0],o[0],s[0]),Math.min(i[1],n[1],o[1],s[1]),Math.max(i[0],n[0],o[0],s[0]),Math.max(i[1],n[1],o[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?O3({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:r,width:i=1,height:n=1}){return e<this.x+this.width&&this.x<e+i&&r<this.y+this.height&&this.y<r+n}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,dve(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,r){return null}_initProps(e){let r=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=z5({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||O3({latitude:i,longitude:r}));let n=Math.pow(2,this.zoom);this.scale=n;let{position:o,modelMatrix:s}=e,a=pve;if(o&&(a=s?new mn(s).transformAsVector(o,[]):o),this.isGeospatial){let u=this.projectPosition([r,i,0]);this.center=new lr(a).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(a)}_initMatrices(e){let{viewMatrix:r=A$e,projectionMatrix:i=null,orthographic:n=!1,fovyRadians:o,fovy:s=75,near:a=.1,far:u=1e3,padding:p=null,focalDistance:m=1}=e;this.viewMatrixUncentered=r,this.viewMatrix=new mn().multiplyRight(r).translate(new lr(this.center).negate()),this.projectionMatrix=i||_$e({width:this.width,height:this.height,orthographic:n,fovyRadians:o||s*g$e,focalDistance:m,padding:p,near:a,far:u});let x=F3();ia.multiply(x,x,this.projectionMatrix),ia.multiply(x,x,this.viewMatrix),this.viewProjectionMatrix=x,this.viewMatrixInverse=ia.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=hve(this.viewMatrixInverse);let M=F3(),k=F3();ia.scale(M,M,[this.width/2,-this.height/2,1]),ia.translate(M,M,[1,-1,0]),ia.multiply(k,M,this.viewProjectionMatrix),this.pixelProjectionMatrix=k,this.pixelUnprojectionMatrix=ia.invert(F3(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||mr.warn("Pixel project matrix not invertible")()}};T9.displayName="Viewport";var kd=T9;var M9=class t extends kd{constructor(e={}){let{latitude:r=0,longitude:i=0,zoom:n=0,pitch:o=0,bearing:s=0,nearZMultiplier:a=.1,farZMultiplier:u=1.01,nearZ:p,farZ:m,orthographic:x=!1,projectionMatrix:M,repeat:k=!1,worldOffset:F=0,position:j,padding:H,legacyMeterSizes:W=!1}=e,{width:Z,height:Y,altitude:ee=1.5}=e,ce=Math.pow(2,n);Z=Z||1,Y=Y||1;let ge,Se=null;if(M)ee=M[5]/2,ge=xg(ee);else{e.fovy?(ge=e.fovy,ee=wg(ge)):ge=xg(ee);let pe;if(H){let{top:ue=0,bottom:Le=0}=H;pe=[0,Rn((ue+Y-Le)/2,0,Y)-Y/2]}Se=fK({width:Z,height:Y,scale:ce,center:j&&[0,0,j[2]*sb(r)],offset:pe,pitch:o,fovy:ge,nearZMultiplier:a,farZMultiplier:u}),Number.isFinite(p)&&(Se.near=p),Number.isFinite(m)&&(Se.far=m)}let ne=_9({height:Y,pitch:o,bearing:s,scale:ce,altitude:ee});F&&(ne=new mn().translate([512*F,0,0]).multiplyLeft(ne)),super({...e,width:Z,height:Y,viewMatrix:ne,longitude:i,latitude:r,zoom:n,...Se,fovy:ge,focalDistance:ee}),this.latitude=r,this.longitude=i,this.zoom=n,this.pitch=o,this.bearing=s,this.altitude=ee,this.fovy=ge,this.orthographic=x,this._subViewports=k?[]:null,this._pseudoMeters=W,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){let e=this.getBounds(),r=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let n=r;n<=i;n++){let o=n?new t({...this,worldOffset:n}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);let[r,i]=this.projectFlat(e),n=(e[2]||0)*sb(e[1]);return[r,i,n]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);let[r,i]=this.unprojectFlat(e),n=(e[2]||0)/sb(i);return[r,i,n]}addMetersToLngLat(e,r){return U5(e,r)}panByPosition(e,r){let i=Pd(r,this.pixelUnprojectionMatrix),n=this.projectFlat(e),o=Wa.add([],n,Wa.negate([],i)),s=Wa.add([],this.center,o),[a,u]=this.unprojectFlat(s);return{longitude:a,latitude:u}}getBounds(e={}){let r=b9(this,e.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(e,r={}){let{width:i,height:n}=this,{longitude:o,latitude:s,zoom:a}=v9({width:i,height:n,bounds:e,...r});return new t({width:i,height:n,longitude:o,latitude:s,zoom:a})}};M9.displayName="WebMercatorViewport";var Th=M9;var mve=[0,0,0];function yK(t,e,r=!1){let i=e.projectPosition(t);if(r&&e instanceof Th){let[n,o,s=0]=t,a=e.getDistanceScales([n,o]);i[2]=s*a.unitsPerMeter[2]}return i}function v$e(t){let{viewport:e,modelMatrix:r,coordinateOrigin:i}=t,{coordinateSystem:n,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return n===Gr.DEFAULT&&(n=e.isGeospatial?Gr.LNGLAT:Gr.CARTESIAN),o===void 0&&(o=n),s===void 0&&(s=i),{viewport:e,coordinateSystem:n,coordinateOrigin:i,modelMatrix:r,fromCoordinateSystem:o,fromCoordinateOrigin:s}}function _K(t,{viewport:e,modelMatrix:r,coordinateSystem:i,coordinateOrigin:n,offsetMode:o}){let[s,a,u=0]=t;switch(r&&([s,a,u]=Mu.transformMat4([],[s,a,u,1],r)),i){case Gr.LNGLAT:return yK([s,a,u],e,o);case Gr.LNGLAT_OFFSETS:return yK([s+n[0],a+n[1],u+(n[2]||0)],e,o);case Gr.METER_OFFSETS:return yK(U5(n,[s,a,u]),e,o);case Gr.CARTESIAN:default:return e.isGeospatial?[s+n[0],a+n[1],u+n[2]]:e.projectPosition([s,a,u])}}function gve(t,e){let{viewport:r,coordinateSystem:i,coordinateOrigin:n,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=v$e(e),{autoOffset:u=!0}=e,{geospatialOrigin:p=mve,shaderCoordinateOrigin:m=mve,offsetMode:x=!1}=u?cK(r,i,n):{},M=_K(t,{viewport:r,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:x});if(x){let k=r.projectPosition(p||m);Ol.sub(M,M,k)}return M}var b$e=1,x$e=1,lb=class{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){let{delay:r=0,duration:i=Number.POSITIVE_INFINITY,rate:n=1,repeat:o=1}=e,s=b$e++,a={time:0,delay:r,duration:i,rate:n,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(e){this.channels.delete(e);for(let[r,i]of this.animations)i.channel===e&&this.detachAnimation(r)}isFinished(e){let r=this.channels.get(e);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(e){if(e===void 0)return this.time;let r=this.channels.get(e);return r===void 0?-1:r.time}setTime(e){this.time=Math.max(0,e);let r=this.channels.values();for(let n of r)this._setChannelTime(n,this.time);let i=this.animations.values();for(let n of i){let{animation:o,channel:s}=n;o.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,r){let i=x$e++;return this.animations.set(i,{animation:e,channel:r}),e.setTime(this.getTime(r)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,r){let i=r-e.delay,n=e.duration*e.repeat;i>=n?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}};Vi();function Ave(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function yve(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}n3();var w$e=0,G5=class t{static defaultAnimationLoopProps={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:u3.stats.get(`animation-loop-${w$e++}`),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...t.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error("No device provided");this.stats=e.stats||new Su({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){let r=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=Ave(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(yve(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){let e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");let r=e?.canvas,i=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:r,useDevicePixels:i,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;let{width:e,height:r,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=r,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){let e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";let r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(r);let i=this.props.onAddHTML(r);i&&(r.innerHTML=i)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};let[e,r]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1],i=1,n=this.device?.getDefaultCanvasContext().canvas;return n&&n.clientHeight?i=n.clientWidth/n.clientHeight:e>0&&r>0&&(i=e/r),{width:e,height:r,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}};Vi();Vi();var vK={};function Rd(t="id"){vK[t]=vK[t]||1;let e=vK[t]++;return`${t}-${e}`}var E9=class{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||Rd("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&vn.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(let e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}};function _ve(t,e){if(e instanceof E9)return e;let r=S$e(t,e),{attributes:i,bufferLayout:n}=T$e(t,e);return new E9({topology:e.topology||"triangle-list",bufferLayout:n,vertexCount:e.vertexCount,indices:r,attributes:i})}function S$e(t,e){if(!e.indices)return;let r=e.indices.value;return t.createBuffer({usage:vn.INDEX,data:r})}function T$e(t,e){let r=[],i={};for(let[o,s]of Object.entries(e.attributes)){let a=o;switch(o){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}if(s){i[a]=t.createBuffer({data:s.value,id:`${o}-buffer`});let{value:u,size:p,normalized:m}=s;r.push({name:a,format:_X(u,p,m)})}}let n=e._calculateVertexCount(e.attributes,e.indices);return{attributes:i,bufferLayout:r,vertexCount:n}}Vi();var C9=class t{static defaultProps={...Bf.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new t(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);let r={...Bf.defaultProps,...e},i=this._renderPipelineCache,n=this._hashRenderPipeline(r),o=i[n]?.pipeline;return o?(i[n].useCount++,this.debug&&Pt.warn(`${this}: ${i[n].pipeline} reused, count=${i[n].useCount}, (id=${e.id})`)()):(o=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:Rd("unnamed-cached")}),o.hash=n,i[n]={pipeline:o,useCount:1},this.debug&&Pt.warn(`${this}: ${o} created, count=${i[n].useCount}`)()),o}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);let r={...d3.defaultProps,...e},i=this._computePipelineCache,n=this._hashComputePipeline(r),o=i[n]?.pipeline;return o?(i[n].useCount++,this.debug&&Pt.warn(`${this}: ${i[n].pipeline} reused, count=${i[n].useCount}, (id=${e.id})`)()):(o=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0}),o.hash=n,i[n]={pipeline:o,useCount:1},this.debug&&Pt.warn(`${this}: ${o} created, count=${i[n].useCount}`)()),o}release(e){if(!this.cachingEnabled){e.destroy();return}let r=this._getCache(e),i=e.hash;r[i].useCount--,r[i].useCount===0?(this._destroyPipeline(e),this.debug&&Pt.warn(`${this}: ${e} released and destroyed`)()):r[i].useCount<0?(Pt.error(`${this}: ${e} released, useCount < 0, resetting`)(),r[i].useCount=0):this.debug&&Pt.warn(`${this}: ${e} released, count=${r[i].useCount}`)()}_destroyPipeline(e){let r=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete r[e.hash],e.destroy(),!0}}_getCache(e){let r;if(e instanceof d3&&(r=this._computePipelineCache),e instanceof Bf&&(r=this._renderPipelineCache),!r)throw new Error(`${this}`);if(!r[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return r}_hashComputePipeline(e){let{type:r}=this.device,i=this._getHash(e.shader.source);return`${r}/C/${i}`}_hashRenderPipeline(e){let r=e.vs?this._getHash(e.vs.source):0,i=e.fs?this._getHash(e.fs.source):0,n="-",o=this._getHash(JSON.stringify(e.bufferLayout)),{type:s}=this.device;switch(s){case"webgl":return`${s}/R/${r}/${i}V${n}BL${o}`;case"webgpu":default:let a=this._getHash(JSON.stringify(e.parameters));return`${s}/R/${r}/${i}V${n}T${e.topology}P${a}BL${o}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};Vi();var P9=class t{static defaultProps={...q1.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new t(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);let r=this._hashShader(e),i=this._cache[r];if(i)i.useCount++,this.debug&&Pt.warn(`${this}: Reusing shader ${i.shader.id} count=${i.useCount}`)();else{let n=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[r]=i={shader:n,useCount:1},this.debug&&Pt.warn(`${this}: Created new shader ${n.id}`)()}return i.shader}release(e){if(!this.cachingEnabled){e.destroy();return}let r=this._hashShader(e),i=this._cache[r];if(i)if(i.useCount--,i.useCount===0)this.destroyPolicy==="unused"&&(delete this._cache[r],i.shader.destroy(),this.debug&&Pt.warn(`${this}: Releasing shader ${e.id}, destroyed`)());else{if(i.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&Pt.warn(`${this}: Releasing shader ${e.id} count=${i.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}};function vve(t,e){let r={},i="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[i]:"N/A"}};for(let n of t.attributes)if(n){let o=`${n.location} ${n.name}: ${n.type}`;r[`in ${o}`]={[i]:n.stepMode||"vertex"}}for(let n of t.varyings||[]){let o=`${n.location} ${n.name}`;r[`out ${o}`]={[i]:JSON.stringify(n)}}return r}var hl=null,bK=null;function bve(t,{id:e,minimap:r,opaque:i,top:n="0",left:o="0",rgbaScale:s=1}){hl||(hl=document.createElement("canvas"),hl.id=e,hl.title=e,hl.style.zIndex="100",hl.style.position="absolute",hl.style.top=n,hl.style.left=o,hl.style.border="blue 5px solid",hl.style.transform="scaleY(-1)",document.body.appendChild(hl),bK=hl.getContext("2d")),(hl.width!==t.width||hl.height!==t.height)&&(hl.width=t.width/2,hl.height=t.height/2,hl.style.width="400px",hl.style.height="400px");let a=t.device.readPixelsToArrayWebGL(t),u=bK?.createImageData(t.width,t.height);if(u){for(let m=0;m<a.length;m+=4)u.data[0+m+0]=a[m+0]*s,u.data[0+m+1]=a[m+1]*s,u.data[0+m+2]=a[m+2]*s,u.data[0+m+3]=i?255:a[m+3]*s;bK?.putImageData(u,0,0)}}function I9(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!I9(t[i],e[i],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){let i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(let o of i)if(!e.hasOwnProperty(o)||!I9(t[o],e[o],r-1))return!1;return!0}return!1}Vi();var N3=class{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(r=>r.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,r){let i=[...e];for(let n of r){let o=i.findIndex(s=>s.name===n.name);o<0?i.push(n):i[o]=n}return i}getBufferIndex(e){let r=this.bufferLayouts.findIndex(i=>i.name===e);return r===-1&&Pt.warn(`BufferLayout: Missing buffer for "${e}".`)(),r}};function xve(t,e){let r=Object.fromEntries(t.attributes.map(n=>[n.name,n.location])),i=e.slice();return i.sort((n,o)=>{let s=n.attributes?n.attributes.map(m=>m.attribute):[n.name],a=o.attributes?o.attributes.map(m=>m.attribute):[o.name],u=Math.min(...s.map(m=>r[m])),p=Math.min(...a.map(m=>r[m]));return u-p}),i}Vi();function wve(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Sve(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function xK(t){return wve(t)||Sve(t)}function M$e(t){return xK(t)||typeof t=="number"||typeof t=="boolean"}function Tve(t){let e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{let i=t[r];M$e(i)?e.uniforms[r]=i:e.bindings[r]=i}),e}var k9=class{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,r){Object.assign(this.options,r);let i=l3(Object.values(e).filter(n=>n.dependencies));for(let n of i)e[n.name]=n;Pt.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(let[n,o]of Object.entries(e))this._addModule(o),o.name&&n!==o.name&&!this.options.disableWarnings&&Pt.warn(`Module name: ${n} vs ${o.name}`)()}destroy(){}setProps(e){for(let r of Object.keys(e)){let i=r,n=e[i]||{},o=this.modules[i];if(!o){this.options.disableWarnings||Pt.warn(`Module ${r} not found`)();continue}let s=this.moduleUniforms[i],a=this.moduleBindings[i],u=o.getUniforms?.(n,s)||n,{uniforms:p,bindings:m}=Tve(u);this.moduleUniforms[i]={...s,...p},this.moduleBindings[i]={...a,...m}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){let e={};for(let r of Object.values(this.moduleBindings))Object.assign(e,r);return e}getDebugTable(){let e={};for(let[r,i]of Object.entries(this.moduleUniforms))for(let[n,o]of Object.entries(i))e[`${r}.${n}`]={type:this.modules[r].uniformTypes?.[n],value:String(o)};return e}_addModule(e){let r=e.name;this.moduleUniforms[r]=e.defaultUniforms||{},this.moduleBindings[r]={}}};Vi();var E$e="";async function Mve(t,e){let r=new Image;return r.crossOrigin=e?.crossOrigin||"anonymous",r.src=t.startsWith("http")?t:E$e+t,await r.decode(),e?await createImageBitmap(r,e):await createImageBitmap(r)}var C$e=["+X","-X","+Y","-Y","+Z","-Z"];var P$e=["+X","-X","+Y","-Y","+Z","-Z"],z3=class t{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,r){this.device=e;let i=Rd("async-texture");this.props={...t.defaultProps,id:i,...r},this.id=this.props.id,r={...r},typeof r?.data=="string"&&r.dimension==="2d"&&(r.data=Mve(r.data)),r.mipmaps&&(r.mipLevels="auto"),this.ready=new Promise((n,o)=>{this.resolveReady=()=>{this.isReady=!0,n()},this.rejectReady=o}),this.initAsync(r)}async initAsync(e){let r=e.data,i=await Eve(r).then(void 0,this.rejectReady);if(this.destroyed)return;let n=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(i);if(!n)throw new Error("Texture size could not be determined");let o={...n,...e,data:void 0,mipLevels:1},s=this.device.getMipLevelCount(o.width,o.height);if(o.mipLevels=this.props.mipLevels==="auto"?s:Math.min(s,this.props.mipLevels),this.texture=this.device.createTexture(o),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,i);break;case"2d":this._setTexture2DData(i);break;case"3d":this._setTexture3DData(this.texture,i);break;case"2d-array":this._setTextureArrayData(this.texture,i);break;case"cube":this._setTextureCubeData(this.texture,i);break;case"cube-array":this._setTextureCubeArrayData(this.texture,i);break}this.props.mipmaps&&this.generateMipmaps(),Pt.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof Lf?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){let r=this.texture;this.texture=r.clone(e),r.destroy()}return!0}isTextureLevelData(e){let r=e?.data;return ArrayBuffer.isView(r)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){let i=Object.values(e)[0];return{width:i.width,height:i.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,r){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,r=0){if(!this.texture)throw new Error("Texture not initialized");let i=this._normalizeTextureData(e);i.length>1&&this.props.mipmaps!==!1&&Pt.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let n=0;n<i.length;n++){let o=i[n];this.device.isExternalImage(o)?this.texture.copyExternalImage({image:o,depth:r,mipLevel:n,flipY:!0}):this.texture.copyImageData({data:o.data,mipLevel:n})}}_setTexture3DData(e,r){if(this.texture?.props.dimension!=="3d")throw new Error(this.id);for(let i=0;i<r.length;i++)this._setTexture2DData(r[i],i)}_setTextureCubeData(e,r){if(this.texture?.props.dimension!=="cube")throw new Error(this.id);for(let[i,n]of Object.entries(r)){let o=P$e.indexOf(i);this._setTexture2DData(n,o)}}_setTextureArrayData(e,r){if(this.texture?.props.dimension!=="2d-array")throw new Error(this.id);for(let i=0;i<r.length;i++)this._setTexture2DData(r[i],i)}_setTextureCubeArrayData(e,r){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,r,i,n=0){Array.isArray(r)&&r.length>1&&this.props.mipmaps!==!1&&Pt.warn(`${this.id} has mipmap and multiple LODs.`)();let o=C$e.indexOf(i);this._setTexture2DData(r,o)}_normalizeTextureData(e){let r=this.texture,i;return ArrayBuffer.isView(e)?i=[{data:e,width:r.width,height:r.height}]:Array.isArray(e)?i=e:i=[e],i}static defaultProps={...ps.defaultProps,data:null,mipmaps:!1}};async function Eve(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(Eve));if(t&&typeof t=="object"&&t.constructor===Object){let e=t,r=await Promise.all(Object.values(e)),i=Object.keys(e),n={};for(let o=0;o<i.length;o++)n[i[o]]=r[o];return n}return t}var cb=2,I$e=1e4,bn=class t{static defaultProps={...Bf.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:$1.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,r){this.props={...t.defaultProps,...r},r=this.props,this.id=r.id||Rd("model"),this.device=e,Object.assign(this.userData,r.userData);let i=Object.fromEntries(this.props.modules?.map(u=>[u.name,u])||[]),n=r.shaderInputs||new k9(i,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(n);let o=R$e(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){let{source:u,getUniforms:p}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:o,...this.props,modules:s});this.source=u,this._getModuleUniforms=p,this.props.shaderLayout||=aZ(this.source)}else{let{vs:u,fs:p,getUniforms:m}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:o,...this.props,modules:s});this.vs=u,this.fs=p,this._getModuleUniforms=m}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||C9.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||P9.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");let e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){let r=this._areBindingsLoading();if(r)return Pt.info(cb,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let i;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();let n=this._getBindings();this.pipeline.setBindings(n,{disableWarnings:this.props.disableWarnings});let{indexBuffer:o}=this.vertexArray,s=o?o.byteLength/(o.indexType==="uint32"?4:2):void 0;i=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),i?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",i}setGeometry(e){this._gpuGeometry?.destroy();let r=e&&_ve(this.device,e);if(r){this.setTopology(r.topology||"triangle-list");let i=new N3(this.bufferLayout);this.bufferLayout=i.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){let r=new N3(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){I9(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new h5(this.shaderInputs.modules);for(let[r,i]of Object.entries(this.shaderInputs.modules))if(k$e(i)){let n=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=n}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,r){let i=r?.disableWarnings??this.props.disableWarnings;e.indices&&Pt.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=xve(this.pipeline.shaderLayout,this.bufferLayout);let n=new N3(this.bufferLayout);for(let[o,s]of Object.entries(e)){let a=n.getBufferLayout(o);if(!a){i||Pt.warn(`Model(${this.id}): Missing layout for buffer "${o}".`)();continue}let u=n.getAttributeNamesForBuffer(a),p=!1;for(let m of u){let x=this._attributeInfos[m];if(x){let M=this.device.type==="webgpu"?n.getBufferIndex(x.bufferName):x.location;this.vertexArray.setBuffer(M,s),p=!0}}!p&&!i&&Pt.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${o}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,r){for(let[i,n]of Object.entries(e)){let o=this._attributeInfos[i];o?this.vertexArray.setConstantWebGL(o.location,n):(r?.disableWarnings??this.props.disableWarnings)||Pt.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${i}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(let e of Object.values(this.bindings))if(e instanceof z3&&!e.isReady)return e.id;return!1}_getBindings(){let e={};for(let[r,i]of Object.entries(this.bindings))i instanceof z3?i.isReady&&(e[r]=i.texture):e[r]=i;return e}_getBindingsUpdateTimestamp(){let e=0;for(let r of Object.values(this.bindings))r instanceof H1?e=Math.max(e,r.texture.updateTimestamp):r instanceof vn||r instanceof ps?e=Math.max(e,r.updateTimestamp):r instanceof z3?e=r.texture?Math.max(e,r.texture.updateTimestamp):1/0:r instanceof Lf||(e=Math.max(e,r.buffer.updateTimestamp));return e}_setGeometryAttributes(e){let r={...e.attributes};for(let[i]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(n=>n.name===i)&&i!=="positions"&&delete r[i];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,r=null;this.pipeline&&(Pt.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;let i=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders}),n=null;this.source?n=i:this.fs&&(n=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:i,fs:n}),this._attributeInfos=c7(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){let e=Pt.level>3?0:I$e;Pt.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,Pt.group(cb,`>>> DRAWING MODEL ${this.id}`,{collapsed:Pt.level<=2})())}_logDrawCallEnd(){if(this._logOpen){let e=vve(this.pipeline.shaderLayout,this.id);Pt.table(cb,e)();let r=this.shaderInputs.getDebugTable();Pt.table(cb,r)();let i=this._getAttributeDebugTable();Pt.table(cb,this._attributeInfos)(),Pt.table(cb,i)(),Pt.groupEnd(cb)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){let r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;let i=e.props.framebuffer;i&&bve(i,{id:i.id,minimap:!0})}_getAttributeDebugTable(){let e={};for(let[r,i]of Object.entries(this._attributeInfos)){let n=this.vertexArray.attributes[i.location];e[i.location]={name:r,type:i.shaderType,values:n?this._getBufferOrConstantValues(n,i.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){let{indexBuffer:r}=this.vertexArray,i=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);e.indices={name:"indices",type:r.indexType,values:i.toString()}}return e}_getBufferOrConstantValues(e,r){let i=G1(r);return(e instanceof vn?new i(e.debugData):e).toString()}};function k$e(t){return!!(t.uniformTypes&&!O$e(t.uniformTypes))}function R$e(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function O$e(t){for(let e in t)return!1;return!0}Vi();var u_=class t{device;model;transformFeedback;static defaultProps={...bn.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,r=t.defaultProps){if(!t.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new bn(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||ZC(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);let r=this.device.beginRenderPass(e);this.model.draw(r),r.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){let r=this.getBuffer(e);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof vn)return r.readAsync();let{buffer:i,byteOffset:n=0,byteLength:o=i.byteLength}=r;return i.readAsync(n,o)}};var D$e="transform_output",U3=class{device;model;sampler;currentIndex=0;samplerTextureMap=null;bindings=[];resources={};constructor(e,r){this.device=e,this.sampler=e.createSampler({addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",minFilter:"nearest",magFilter:"nearest",mipmapFilter:"nearest"}),this.model=new bn(this.device,{id:r.id||Rd("texture-transform-model"),fs:r.fs||ZC({input:r.targetTextureVarying,inputChannels:r.targetTextureChannels,output:D$e}),vertexCount:r.vertexCount,...r}),this._initialize(r),Object.seal(this)}destroy(){this.model.destroy();for(let e of this.bindings)e.framebuffer?.destroy()}delete(){this.destroy()}run(e){let{framebuffer:r}=this.bindings[this.currentIndex],i=this.device.beginRenderPass({framebuffer:r,...e});this.model.draw(i),i.end(),this.device.submit()}getTargetTexture(){let{targetTexture:e}=this.bindings[this.currentIndex];return e}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}_initialize(e){this._updateBindings(e)}_updateBindings(e){this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e)}_updateBinding(e,{sourceBuffers:r,sourceTextures:i,targetTexture:n}){if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),n){e.targetTexture=n;let{width:o,height:s}=n;e.framebuffer&&e.framebuffer.destroy(),e.framebuffer=this.device.createFramebuffer({id:"transform-framebuffer",width:o,height:s,colorAttachments:[n]}),e.framebuffer.resize({width:o,height:s})}return e}_setSourceTextureParameters(){let e=this.currentIndex,{sourceTextures:r}=this.bindings[e];for(let i in r)r[i].sampler=this.sampler}};var Ds=class{id;topology;vertexCount;indices;attributes;userData={};constructor(e){let{attributes:r={},indices:i=null,vertexCount:n=null}=e;this.id=e.id||Rd("geometry"),this.topology=e.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(let[o,s]of Object.entries(r)){let a=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(a.value))throw new Error(`${this._print(o)}: must be typed array or object with value as typed array`);if((o==="POSITION"||o==="positions")&&!a.size&&(a.size=3),o==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=a}else this.attributes[o]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=n||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,r){return this}_calculateVertexCount(e,r){if(r)return r.value.length;let i=1/0;for(let n of Object.values(e)){let{value:o,size:s,constant:a}=n;!a&&o&&s!==void 0&&s>=1&&(i=Math.min(i,o.length/s))}return i}};var L$e={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"},ub=class extends Id{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:i,viewports:n,onViewportActive:o,pickingFBO:s,deviceRect:{x:a,y:u,width:p,height:m},cullRect:x,effects:M,pass:k="picking",pickZ:F,shaderModuleProps:j}){this.pickZ=F;let H=this._resetColorEncoder(F),W=[a,u,p,m],Z=super.render({target:s,layers:e,layerFilter:r,views:i,viewports:n,onViewportActive:o,cullRect:x,effects:M?.filter(ee=>ee.useInPicking),pass:k,isPicking:!0,shaderModuleProps:j,clearColor:[0,0,0,0],colorMask:15,scissorRect:W});return this._colorEncoderState=null,{decodePickingColor:H&&F$e.bind(null,H),stats:Z}}shouldDrawLayer(e){let{pickable:r,operation:i}=e.props;return r&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getShaderModuleProps(e,r,i){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,r,i){let n={...e.props.parameters},{pickable:o,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?n.blend=!1:o&&s.includes("draw")&&(Object.assign(n,L$e),n.blend=!0,n.blendColor=B$e(this._colorEncoderState,e,i)),n}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}};function B$e(t,e,r){let{byLayer:i,byAlpha:n}=t,o,s=i.get(e);return s?(s.viewports.push(r),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:e,viewports:[r]},i.set(e,s),n[o]=s):(mr.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}function F$e(t,e){let r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}var h_={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},V3=Symbol.for("component"),Od=Symbol.for("propTypes"),R9=Symbol.for("deprecatedProps"),Sg=Symbol.for("asyncPropDefaults"),_0=Symbol.for("asyncPropOriginal"),Wf=Symbol.for("asyncPropResolved");function Uc(t,e=()=>!0){return Array.isArray(t)?Cve(t,e,[]):e(t)?[t]:[]}function Cve(t,e,r){let i=-1;for(;++i<t.length;){let n=t[i];Array.isArray(n)?Cve(n,e,r):e(n)&&r.push(n)}return r}function wK({target:t,source:e,start:r=0,count:i=1}){let n=e.length,o=i*n,s=0;for(let a=r;s<n;s++)t[a++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+o-s),s=o);return t}n3();var H5=class{constructor(e,r,i){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=i,this.setData(r)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,r){if(e===this._data&&!r)return;this._data=e;let i=++this._loadCount,n=e;typeof e=="string"&&(n=e_(e)),n instanceof Promise?(this.isLoaded=!1,this._loader=n.then(o=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===i&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(let o of this._subscribers)o.onChange(this.getData())}};var q5=class{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:r,forceUpdate:i=!1,persistent:n=!0}){let o=this._resources[e];o?o.setData(r,i):(o=new H5(e,r,this._context),this._resources[e]=o),o.persistent=n}remove(e){let r=this._resources[e];r&&(r.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){let r=this._consumers[e];if(r){for(let i in r){let n=r[i],o=this._resources[n.resourceId];o&&o.unsubscribe(n)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:r,consumerId:i,requestId:n="default"}){let{_resources:o,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));let a=o[e];if(this._track(i,n,a,r),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(let e in this._resources)this._resources[e].delete()}_track(e,r,i,n){let o=this._consumers,s=o[e]=o[e]||{},a=s[r],u=a&&a.resourceId&&this._resources[a.resourceId];u&&(u.unsubscribe(a),this.prune()),i&&(a?(a.onChange=n,a.resourceId=i.id):a={onChange:n,resourceId:i.id},s[r]=a,i.subscribe(a))}_prune(){this._pruneRequest=null;for(let e of Object.keys(this._resources)){let r=this._resources[e];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[e])}}};var N$e="layerManager.setLayers",z$e="layerManager.activateViewport",Y5=class{constructor(e,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{ks(z$e,this,a),a&&(this.context.viewport=a)};let{deck:i,stats:n,viewport:o,timeline:s}=r||{};this.layers=[],this.resourceManager=new q5({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:i,shaderAssembler:sve(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[JZ],renderPass:void 0,stats:n||new Su({id:"deck.gl"}),viewport:o||new kd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new lb,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(let e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(let i of this.layers){let n=i.getNeedsRedraw(e);r=r||n}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(r=>e.find(i=>r.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,r){ks(N$e,this,r,e),this._lastRenderedLayers=e;let i=Uc(e,Boolean);for(let n of i)n.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){let e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){let{defaultShaderModules:r}=this.context;r.find(i=>i.name===e.name)||(r.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){let{defaultShaderModules:r}=this.context,i=r.findIndex(n=>n.name===e.name);i>=0&&(r.splice(i,1),this._defaultShaderModulesChanged=!0)}_handleError(e,r,i){i.raiseError(r,`${e} of ${i}`)}_updateLayers(e,r){let i={};for(let s of e)i[s.id]?mr.warn(`Multiple old layers with same id ${s.id}`)():i[s.id]=s;if(this._defaultShaderModulesChanged){for(let s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}let n=[];this._updateSublayersRecursively(r,i,n),this._finalizeOldLayers(i);let o=!1;for(let s of n)if(s.hasUniformTransition()){o=`Uniform transition in ${s}`;break}this._needsUpdate=o,this.layers=n}_updateSublayersRecursively(e,r,i){for(let n of e){n.context=this.context;let o=r[n.id];o===null&&mr.warn(`Multiple new layers with same id ${n.id}`)(),r[n.id]=null;let s=null;try{this._debug&&o!==n&&n.validateProps(),o?(this._transferLayerState(o,n),this._updateLayer(n)):this._initializeLayer(n),i.push(n),s=n.isComposite?n.getSubLayers():null}catch(a){this._handleError("matching",a,n)}s&&this._updateSublayersRecursively(s,r,i)}}_finalizeOldLayers(e){for(let r in e){let i=e[r];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=h_.INITIALIZED}catch(r){this._handleError("initialization",r,e)}}_transferLayerState(e,r){r._transferState(e),r.lifecycle=h_.MATCHED,r!==e&&(e.lifecycle=h_.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(r){this._handleError("update",r,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=h_.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=h_.FINALIZED}catch(r){this._handleError("finalization",r,e)}}};function vo(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!vo(t[i],e[i],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){let i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(let o of i)if(!e.hasOwnProperty(o)||!vo(t[o],e[o],r-1))return!1;return!0}return!1}var X5=class{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(let e in this.controllers){let r=this.controllers[e];r&&r.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(let e in this.controllers){let r=this.controllers[e];r&&r.updateTransition()}}getViewports(e){return e?this._viewports.filter(r=>r.containsPixel(e)):this._viewports}getViews(){let e={};return this.views.forEach(r=>{e[r.id]=r}),e}getView(e){return this.views.find(r=>r.id===e)}getViewState(e){let r=typeof e=="string"?this.getView(e):e,i=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,r){let i=this.getViewports(),n={x:e[0],y:e[1]};for(let o=i.length-1;o>=0;--o){let s=i[o];if(s.containsPixel(n)){let a=e.slice();return a[0]-=s.x,a[1]-=s.y,s.unproject(a,r)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,r){(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Uc(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!vo(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):mr.warn("missing `viewState` or `initialViewState`")()}_createController(e,r){let i=r.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>this.getView(e.id)?.makeViewport({viewState:o,width:this.width,height:this.height})})}_updateController(e,r,i,n){let o=e.controller;if(o&&i){let s={...r,...o,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!n||n.constructor!==o.type)&&(n=this._createController(e,s)),n&&n.setProps(s),n}return null}_rebuildViewports(){let{views:e}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let n=e.length;n--;){let o=e[n],s=this.getViewState(o),a=o.makeViewport({viewState:s,width:this.width,height:this.height}),u=r[o.id],p=!!o.controller;p&&!u&&(i=!0),(i||!p)&&u&&(u.finalize(),u=null),this.controllers[o.id]=this._updateController(o,s,a,u),a&&this._viewports.unshift(a)}for(let n in r){let o=r[n];o&&!this.controllers[n]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,r){return e.length!==r.length?!0:e.some((i,n)=>!e[n].equals(r[n]))}};var U$e=/([0-9]+\.?[0-9]*)(%|px)/;function Tg(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":let e=U$e.exec(t);if(e&&e.length>=3){let r=e[2]==="%",i=parseFloat(e[1]);return{position:r?i/100:i,relative:r}}default:throw new Error(`Could not parse position string ${t}`)}}function Mg(t,e){return t.relative?Math.round(t.position*e):t.position}var na=class{constructor(e){let{id:r,x:i=0,y:n=0,width:o="100%",height:s="100%",padding:a=null}=e;this.id=r||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Tg(i),this._y=Tg(n),this._width=Tg(o),this._height=Tg(s),this._padding=a&&{left:Tg(a.left||0),right:Tg(a.right||0),top:Tg(a.top||0),bottom:Tg(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&vo(this.props,e.props,2)}clone(e){let r=this.constructor;return new r({...this.props,...e})}makeViewport({width:e,height:r,viewState:i}){i=this.filterViewState(i);let n=this.getDimensions({width:e,height:r});if(!n.height||!n.width)return null;let o=this.getViewportType(i);return new o({...i,...this.props,...n})}getViewStateId(){let{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;let r={...e};for(let i in this.props.viewState)i!=="id"&&(r[i]=this.props.viewState[i]);return r}return e}getDimensions({width:e,height:r}){let i={x:Mg(this._x,e),y:Mg(this._y,r),width:Mg(this._width,e),height:Mg(this._height,r)};return this._padding&&(i.padding={left:Mg(this._padding.left,e),top:Mg(this._padding.top,r),right:Mg(this._padding.right,e),bottom:Mg(this._padding.bottom,r)}),i}get controller(){let e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}};var Gf=class{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){let{_timeline:e,settings:r}=this;this._handle=e.addChannel({delay:e.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};var Pve=()=>{},SK={BREAK:1,SNAP_TO_END:2,IGNORE:3},V$e=t=>t,j$e=SK.BREAK,Z5=class{constructor(e){this._onTransitionUpdate=r=>{let{time:i,settings:{interpolator:n,startProps:o,endProps:s,duration:a,easing:u}}=r,p=u(i/a),m=n.interpolateProps(o,s,p);this.propsInTransition=this.getControllerState({...this.props,...m}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Gf(e.timeline),this.onViewStateChange=e.onViewStateChange||Pve,this.onStateChange=e.onStateChange||Pve}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let r=!1,i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let n=i;if(this.transition.inProgress){let{interruption:o,endProps:s}=this.transition.settings;n={...i,...o===SK.SNAP_TO_END?s:this.propsInTransition||i}}this._triggerTransition(n,e),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(e){let{transitionDuration:r,transitionInterpolator:i}=e;return(r>0||r==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,r){return this.transition.inProgress?this.transition.settings.interruption===SK.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(e,r):!0}_triggerTransition(e,r){let i=this.getControllerState(e),n=this.getControllerState(r).shortestPathFrom(i),o=r.transitionInterpolator,s=o.getDuration?o.getDuration(e,r):r.transitionDuration;if(s===0)return;let a=o.initializeProps(e,n);this.propsInTransition={};let u={duration:s,easing:r.transitionEasing||V$e,interpolator:o,interruption:r.transitionInterruption||j$e,startProps:a.start,endProps:a.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(r)}}};function Pr(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}var hb=class{constructor(e){let{compare:r,extract:i,required:n}=e;this._propsToCompare=r,this._propsToExtract=i||r,this._requiredProps=n}arePropsEqual(e,r){for(let i of this._propsToCompare)if(!(i in e)||!(i in r)||!ra(e[i],r[i]))return!1;return!0}initializeProps(e,r){let i={},n={};for(let o of this._propsToExtract)(o in e||o in r)&&(i[o]=e[o],n[o]=r[o]);return this._checkRequiredProps(i),this._checkRequiredProps(n),{start:i,end:n}}getDuration(e,r){return r.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(r=>{let i=e[r];Pr(Number.isFinite(i)||Array.isArray(i),`${r} is required for transition`)})}};var $$e=["longitude","latitude","zoom","bearing","pitch"],W$e=["longitude","latitude","zoom"],dl=class extends hb{constructor(e={}){let r=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:$$e,required:W$e},super(i.transitionProps),this.opts=i}initializeProps(e,r){let i=super.initializeProps(e,r),{makeViewport:n,around:o}=this.opts;if(n&&o){let s=n(e),a=n(r),u=s.unproject(o);i.start.around=o,Object.assign(i.end,{around:a.project(u),aroundPosition:u,width:r.width,height:r.height})}return i}interpolateProps(e,r,i){let n={};for(let o of this._propsToExtract)n[o]=sc(e[o]||0,r[o]||0,i);if(r.aroundPosition&&this.opts.makeViewport){let o=this.opts.makeViewport({...r,...n});Object.assign(n,o.panByPosition(r.aroundPosition,sc(e.around,r.around,i)))}return n}};var Eg={transitionDuration:0},G$e=300,O9=t=>1-(1-t)*(1-t),j3={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},db={},Mh=class{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new Z5({...e,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(let e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;let r=this._eventStartBlocked;switch(e.type){case"panstart":return r?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return r?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return r?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){let{x:r,y:i}=this.props,{offsetCenter:n}=e;return[n.x-r,n.y-i]}isPointInBounds(e,r){let{width:i,height:n}=this.props;if(r&&r.handled)return!1;let o=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=n;return o&&r&&r.stopPropagation(),o}isFunctionKeyPressed(e){let{srcEvent:r}=e;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){let r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=r}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:r}=e;this.inertia=Number.isFinite(r)?r:r===!0?G$e:0;let{scrollZoom:i=!0,dragPan:n=!0,dragRotate:o=!0,doubleClickZoom:s=!0,touchZoom:a=!0,touchRotate:u=!1,keyboard:p=!0}=e,m=!!this.onViewStateChange;this.toggleEvents(j3.WHEEL,m&&i),this.toggleEvents(j3.PAN,m),this.toggleEvents(j3.PINCH,m&&(a||u)),this.toggleEvents(j3.MULTI_PAN,m&&u),this.toggleEvents(j3.DOUBLE_CLICK,m&&s),this.toggleEvents(j3.KEYBOARD,m&&p),this.scrollZoom=i,this.dragPan=n,this.dragRotate=o,this.doubleClickZoom=s,this.touchZoom=a,this.touchRotate=u,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,r){this.eventManager&&e.forEach(i=>{this._events[i]!==r&&(this._events[i]=r,r?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,r=null,i={}){let n={...e.getViewportProps(),...r},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),o){let s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:n,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){let r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);let n=this.controllerState[i?"panStart":"rotateStart"]({pos:r});return this._panMove=i,this.updateViewport(n,Eg,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;let r=this.getCenter(e),i=this.controllerState.pan({pos:r});return this.updateViewport(i,Eg,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){let{inertia:r}=this;if(this.dragPan&&r&&e.velocity){let i=this.getCenter(e),n=[i[0]+e.velocityX*r/2,i[1]+e.velocityY*r/2],o=this.controllerState.pan({pos:n}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:O9},{isDragging:!1,isPanning:!0})}else{let i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;let r=this.getCenter(e),i=this.controllerState.rotate({pos:r});return this.updateViewport(i,Eg,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){let{inertia:r}=this;if(this.dragRotate&&r&&e.velocity){let i=this.getCenter(e),n=[i[0]+e.velocityX*r/2,i[1]+e.velocityY*r/2],o=this.controllerState.rotate({pos:n}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:O9},{isDragging:!1,isRotating:!0})}else{let i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;let r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;e.srcEvent.preventDefault();let{speed:i=.01,smooth:n=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=e,s=2/(1+Math.exp(-Math.abs(o*i)));o<0&&s!==0&&(s=1/s);let a=n?{...this._getTransitionProps({around:r}),transitionDuration:250}:Eg,u=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(u,a,{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){let r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let i=this.controllerState.rotateStart({pos:r});return this.updateViewport(i,Eg,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;let r=this.getCenter(e);r[0]-=e.deltaX;let i=this.controllerState.rotate({pos:r});return this.updateViewport(i,Eg,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;let{inertia:r}=this;if(this.touchRotate&&r&&e.velocityY){let i=this.getCenter(e),n=[i[0],i[1]+=e.velocityY*r/2],o=this.controllerState.rotate({pos:n});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:O9},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{let i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){let r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let i=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return db._startPinchRotation=e.rotation,db._lastPinchEvent=e,this.updateViewport(i,Eg,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){let{scale:i}=e,n=this.getCenter(e);r=r.zoom({pos:n,scale:i})}if(this.touchRotate){let{rotation:i}=e;r=r.rotate({deltaAngleX:db._startPinchRotation-i})}return this.updateViewport(r,Eg,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),db._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;let{inertia:r}=this,{_lastPinchEvent:i}=db;if(this.touchZoom&&r&&i&&e.scale!==i.scale){let n=this.getCenter(e),o=this.controllerState.rotateEnd(),s=Math.log2(e.scale),a=(s-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),u=Math.pow(2,s+a*r/2);o=o.zoom({pos:n,scale:u}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:r,transitionEasing:O9},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{let n=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return db._startPinchRotation=null,db._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;let r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let i=this.isFunctionKeyPressed(e),n=this.controllerState.zoom({pos:r,scale:i?.5:2});return this.updateViewport(n,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;let r=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:n,rotateSpeedX:o,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this,u,p={};switch(e.srcEvent.code){case"Minus":u=r?a.zoomOut(i).zoomOut(i):a.zoomOut(i),p.isZooming=!0;break;case"Equal":u=r?a.zoomIn(i).zoomIn(i):a.zoomIn(i),p.isZooming=!0;break;case"ArrowLeft":r?(u=a.rotateLeft(o),p.isRotating=!0):(u=a.moveLeft(n),p.isPanning=!0);break;case"ArrowRight":r?(u=a.rotateRight(o),p.isRotating=!0):(u=a.moveRight(n),p.isPanning=!0);break;case"ArrowUp":r?(u=a.rotateUp(s),p.isRotating=!0):(u=a.moveUp(n),p.isPanning=!0);break;case"ArrowDown":r?(u=a.rotateDown(s),p.isRotating=!0):(u=a.moveDown(n),p.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),p),!0}_getTransitionProps(e){let{transition:r}=this;return!r||!r.transitionInterpolator?Eg:e?{...r,transitionInterpolator:new dl({...e,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}};var Cg=class{constructor(e,r){this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}};var Ive=5,H$e=1.2,K5=class extends Cg{constructor(e){let{width:r,height:i,latitude:n,longitude:o,zoom:s,bearing:a=0,pitch:u=0,altitude:p=1.5,position:m=[0,0,0],maxZoom:x=20,minZoom:M=0,maxPitch:k=60,minPitch:F=0,startPanLngLat:j,startZoomLngLat:H,startRotatePos:W,startBearing:Z,startPitch:Y,startZoom:ee,normalize:ce=!0}=e;Pr(Number.isFinite(o)),Pr(Number.isFinite(n)),Pr(Number.isFinite(s)),super({width:r,height:i,latitude:n,longitude:o,zoom:s,bearing:a,pitch:u,altitude:p,maxZoom:x,minZoom:M,maxPitch:k,minPitch:F,normalize:ce,position:m},{startPanLngLat:j,startZoomLngLat:H,startRotatePos:W,startBearing:Z,startPitch:Y,startZoom:ee}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:r}){let i=this.getState().startPanLngLat||this._unproject(r);if(!i)return this;let o=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:i=0}){let{startRotatePos:n,startBearing:o,startPitch:s}=this.getState();if(!n||o===void 0||s===void 0)return this;let a;return e?a=this._getNewRotation(e,n,s,o):a={bearing:o+r,pitch:s+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:i}){let{startZoom:n,startZoomLngLat:o}=this.getState();if(o||(n=this.getViewportProps().zoom,o=this._unproject(r)||this._unproject(e)),!o)return this;let{maxZoom:s,minZoom:a}=this.getViewportProps(),u=n+Math.log2(i);u=Rn(u,a,s);let p=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...p.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){let r=e.getViewportProps(),i={...this.getViewportProps()},{bearing:n,longitude:o}=i;return Math.abs(n-r.bearing)>180&&(i.bearing=n<0?n+360:n-360),Math.abs(o-r.longitude)>180&&(i.longitude=o<0?o+360:o-360),i}applyConstraints(e){let{maxZoom:r,minZoom:i,zoom:n}=e;e.zoom=Rn(n,i,r);let{maxPitch:o,minPitch:s,pitch:a}=e;e.pitch=Rn(a,s,o);let{normalize:u=!0}=e;return u&&Object.assign(e,pK(e)),e}_zoomFromCenter(e){let{width:r,height:i}=this.getViewportProps();return this.zoom({pos:[r/2,i/2],scale:e})}_panFromCenter(e){let{width:r,height:i}=this.getViewportProps();return this.pan({startPos:[r/2,i/2],pos:[r/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){let r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_getNewRotation(e,r,i,n){let o=e[0]-r[0],s=e[1]-r[1],a=e[1],u=r[1],{width:p,height:m}=this.getViewportProps(),x=o/p,M=0;s>0?Math.abs(m-u)>Ive&&(M=s/(u-m)*H$e):s<0&&u>Ive&&(M=1-a/u),M=Rn(M,-1,1);let{minPitch:k,maxPitch:F}=this.getViewportProps(),j=n+180*x,H=i;return M>0?H=i+M*(F-i):M<0&&(H=i-M*(k-i)),{pitch:H,bearing:j}}},Q5=class extends Mh{constructor(){super(...arguments),this.ControllerState=K5,this.transition={transitionDuration:300,transitionInterpolator:new dl({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];let r=this.props;super.setProps(e),(!r||r.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}};var D9=class extends na{constructor(e={}){super(e)}getViewportType(){return Th}get ControllerType(){return Q5}};D9.displayName="MapView";var d_=D9;var q$e=new L3;function Y$e(t,e){let r=t.order??1/0,i=e.order??1/0;return r-i}var J5=class{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){let r=this._defaultEffects;if(!r.find(i=>i.id===e.id)){let i=r.findIndex(n=>Y$e(n,e)>0);i<0?r.push(e):r.splice(i,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(vo(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(e){let r={};for(let n of this.effects)r[n.id]=n;let i=[];for(let n of e){let o=r[n.id],s=n;o&&o!==n?o.setProps?(o.setProps(n.props),s=o):o.cleanup(this._context):o||n.setup(this._context),i.push(s),delete r[n.id]}for(let n in r)r[n].cleanup(this._context);this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(n=>n instanceof L3)||this._resolvedEffects.push(q$e),this._needsRedraw="effects changed"}finalize(){for(let e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}};var eP=class extends Id{shouldDrawLayer(e){let{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}};var X$e="deckRenderer.renderLayers",tP=class{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new eP(e),this.pickLayersPass=new ub(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;let r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};i.effects&&this._preRender(i.effects,i);let n=this.lastPostProcessEffect?this.renderBuffers[0]:i.target;this.lastPostProcessEffect&&(i.clearColor=[0,0,0,0],i.clearCanvas=!0);let o=r.render({...i,target:n});i.effects&&(this.lastPostProcessEffect&&(i.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(i.effects,i)),this.renderCount++,ks(X$e,this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){let{renderBuffers:e}=this;for(let r of e)r.delete();e.length=0}_preRender(e,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(let i of e)r.preRenderStats[i.id]=i.preRender(r),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){let{renderBuffers:e}=this,r=this.device.canvasContext.getDrawingBufferSize(),[i,n]=r;e.length===0&&[0,1].map(o=>{let s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:i,height:n});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${o}`,colorAttachments:[s]}))});for(let o of e)o.resize(r)}_postRender(e,r){let{renderBuffers:i}=this,n={...r,inputBuffer:i[0],swapBuffer:i[1]};for(let o of e)if(o.postRender){n.target=o.id===this.lastPostProcessEffect?r.target:void 0;let s=o.postRender(n);n.inputBuffer=s,n.swapBuffer=s===i[0]?i[1]:i[0]}}};var Z$e={pickedColor:null,pickedObjectIndex:-1};function TK({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:i,deviceRadius:n,deviceRect:o}){let{x:s,y:a,width:u,height:p}=o,m=n*n,x=-1,M=0;for(let k=0;k<p;k++){let F=k+a-i,j=F*F;if(j>m)M+=4*u;else for(let H=0;H<u;H++){if(t[M+3]-1>=0){let Z=H+s-r,Y=Z*Z+j;Y<=m&&(m=Y,x=M)}M+=4}}if(x>=0){let k=t.slice(x,x+4),F=e(k);if(F){let j=Math.floor(x/4/u),H=x/4-j*u;return{...F,pickedColor:k,pickedX:s+H,pickedY:a+j}}mr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Z$e}function MK({pickedColors:t,decodePickingColor:e}){let r=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){let o=t.slice(i,i+4),s=o.join(",");if(!r.has(s)){let a=e(o);a?r.set(s,{...a,color:o}):mr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function L9({pickInfo:t,viewports:e,pixelRatio:r,x:i,y:n,z:o}){let s=e[0];e.length>1&&(s=K$e(t?.pickedViewports||e,{x:i,y:n}));let a;if(s){let u=[i-s.x,n-s.y];o!==void 0&&(u[2]=o),a=s.unproject(u)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:i,y:n,pixel:[i,n],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:r}}function EK(t){let{pickInfo:e,lastPickedInfo:r,mode:i,layers:n}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,u=s?[s]:[];if(i==="hover"){let x=r.index,M=r.layerId,k=s?s.props.id:null;if(k!==M||a!==x){if(k!==M){let F=n.find(j=>j.props.id===M);F&&u.unshift(F)}r.layerId=k,r.index=a,r.info=null}}let p=L9(t),m=new Map;return m.set(null,p),u.forEach(x=>{let M={...p};x===s&&(M.color=o,M.index=a,M.picked=!0),M=B9({layer:x,info:M,mode:i});let k=M.layer;x===s&&i==="hover"&&(r.info=M),m.set(k.id,M),i==="hover"&&k.updateAutoHighlight(M)}),m}function B9({layer:t,info:e,mode:r}){for(;t&&e;){let i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:i}),t=t.parent}return e}function K$e(t,e){for(let r=t.length-1;r>=0;r--){let i=t[r];if(i.containsPixel(e))return i}return t[0]}var rP=class{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new ub(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:r,layers:i,viewports:n},o=this.lastPickedInfo.info){let s=o&&o.layer&&o.layer.id,a=o&&o.viewport&&o.viewport.id,u=s?i.find(M=>M.id===s):null,p=a&&n.find(M=>M.id===a)||n[0],m=p&&p.unproject([e-p.x,r-p.y]);return{...o,...{x:e,y:r,viewport:p,coordinate:m,layer:u}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){let r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}let{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;let r=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return r.length?r:null}async _pickClosestObjectAsync({layers:e,views:r,viewports:i,x:n,y:o,radius:s=0,depth:a=1,mode:u="query",unproject3D:p,onViewportActive:m,effects:x}){let M=this.device.canvasContext.cssToDeviceRatio(),k=this._getPickable(e);if(!k||i.length===0)return{result:[],emptyInfo:L9({viewports:i,x:n,y:o,pixelRatio:M})};this._resizeBuffer();let F=this.device.canvasContext.cssToDevicePixels([n,o],!0),j=[F.x+Math.floor(F.width/2),F.y+Math.floor(F.height/2)],H=Math.round(s*M),{width:W,height:Z}=this.pickingFBO,Y=this._getPickingRect({deviceX:j[0],deviceY:j[1],deviceRadius:H,deviceWidth:W,deviceHeight:Z}),ee={x:n-s,y:o-s,width:s*2+1,height:s*2+1},ce,ge=[],Se=new Set;for(let ne=0;ne<a;ne++){let pe;if(Y){let Le=this._drawAndSample({layers:k,views:r,viewports:i,onViewportActive:m,deviceRect:Y,cullRect:ee,effects:x,pass:`picking:${u}`});pe=TK({...Le,deviceX:j[0],deviceY:j[1],deviceRadius:H,deviceRect:Y})}else pe={pickedColor:null,pickedObjectIndex:-1};let ue;if(pe.pickedLayer&&p&&this.depthFBO){let{pickedColors:Le}=this._drawAndSample({layers:[pe.pickedLayer],views:r,viewports:i,onViewportActive:m,deviceRect:{x:pe.pickedX,y:pe.pickedY,width:1,height:1},cullRect:ee,effects:x,pass:`picking:${u}:z`},!0);Le[3]&&(ue=Le[0])}pe.pickedLayer&&ne+1<a&&(Se.add(pe.pickedLayer),pe.pickedLayer.disablePickingIndex(pe.pickedObjectIndex)),ce=EK({pickInfo:pe,lastPickedInfo:this.lastPickedInfo,mode:u,layers:k,viewports:i,x:n,y:o,z:ue,pixelRatio:M});for(let Le of ce.values())Le.layer&&ge.push(Le);if(!pe.pickedColor)break}for(let ne of Se)ne.restorePickingColors();return{result:ge,emptyInfo:ce.get(null)}}_pickClosestObject({layers:e,views:r,viewports:i,x:n,y:o,radius:s=0,depth:a=1,mode:u="query",unproject3D:p,onViewportActive:m,effects:x}){let M=this.device.canvasContext.cssToDeviceRatio(),k=this._getPickable(e);if(!k||i.length===0)return{result:[],emptyInfo:L9({viewports:i,x:n,y:o,pixelRatio:M})};this._resizeBuffer();let F=this.device.canvasContext.cssToDevicePixels([n,o],!0),j=[F.x+Math.floor(F.width/2),F.y+Math.floor(F.height/2)],H=Math.round(s*M),{width:W,height:Z}=this.pickingFBO,Y=this._getPickingRect({deviceX:j[0],deviceY:j[1],deviceRadius:H,deviceWidth:W,deviceHeight:Z}),ee={x:n-s,y:o-s,width:s*2+1,height:s*2+1},ce,ge=[],Se=new Set;for(let ne=0;ne<a;ne++){let pe;if(Y){let Le=this._drawAndSample({layers:k,views:r,viewports:i,onViewportActive:m,deviceRect:Y,cullRect:ee,effects:x,pass:`picking:${u}`});pe=TK({...Le,deviceX:j[0],deviceY:j[1],deviceRadius:H,deviceRect:Y})}else pe={pickedColor:null,pickedObjectIndex:-1};let ue;if(pe.pickedLayer&&p&&this.depthFBO){let{pickedColors:Le}=this._drawAndSample({layers:[pe.pickedLayer],views:r,viewports:i,onViewportActive:m,deviceRect:{x:pe.pickedX,y:pe.pickedY,width:1,height:1},cullRect:ee,effects:x,pass:`picking:${u}:z`},!0);Le[3]&&(ue=Le[0])}pe.pickedLayer&&ne+1<a&&(Se.add(pe.pickedLayer),pe.pickedLayer.disablePickingIndex(pe.pickedObjectIndex)),ce=EK({pickInfo:pe,lastPickedInfo:this.lastPickedInfo,mode:u,layers:k,viewports:i,x:n,y:o,z:ue,pixelRatio:M});for(let Le of ce.values())Le.layer&&ge.push(Le);if(!pe.pickedColor)break}for(let ne of Se)ne.restorePickingColors();return{result:ge,emptyInfo:ce.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:r,viewports:i,x:n,y:o,width:s=1,height:a=1,mode:u="query",maxObjects:p=null,onViewportActive:m,effects:x}){let M=this._getPickable(e);if(!M||i.length===0)return[];this._resizeBuffer();let k=this.device.canvasContext.cssToDeviceRatio(),F=this.device.canvasContext.cssToDevicePixels([n,o],!0),j=F.x,H=F.y+F.height,W=this.device.canvasContext.cssToDevicePixels([n+s,o+a],!0),Z=W.x+W.width,Y=W.y,ee={x:j,y:Y,width:Z-j,height:H-Y},ce=this._drawAndSample({layers:M,views:r,viewports:i,onViewportActive:m,deviceRect:ee,cullRect:{x:n,y:o,width:s,height:a},effects:x,pass:`picking:${u}`}),ge=MK(ce),Se=new Map,ne=[],pe=Number.isFinite(p);for(let ue=0;ue<ge.length&&!(pe&&ne.length>=p);ue++){let Le=ge[ue],We={color:Le.pickedColor,layer:null,index:Le.pickedObjectIndex,picked:!0,x:n,y:o,pixelRatio:k};We=B9({layer:Le.pickedLayer,info:We,mode:u});let ze=We.layer.id;Se.has(ze)||Se.set(ze,new Set);let rt=Se.get(ze),at=We.object??We.index;rt.has(at)||(rt.add(at),ne.push(We))}return ne}_pickVisibleObjects({layers:e,views:r,viewports:i,x:n,y:o,width:s=1,height:a=1,mode:u="query",maxObjects:p=null,onViewportActive:m,effects:x}){let M=this._getPickable(e);if(!M||i.length===0)return[];this._resizeBuffer();let k=this.device.canvasContext.cssToDeviceRatio(),F=this.device.canvasContext.cssToDevicePixels([n,o],!0),j=F.x,H=F.y+F.height,W=this.device.canvasContext.cssToDevicePixels([n+s,o+a],!0),Z=W.x+W.width,Y=W.y,ee={x:j,y:Y,width:Z-j,height:H-Y},ce=this._drawAndSample({layers:M,views:r,viewports:i,onViewportActive:m,deviceRect:ee,cullRect:{x:n,y:o,width:s,height:a},effects:x,pass:`picking:${u}`}),ge=MK(ce),Se=new Map,ne=[],pe=Number.isFinite(p);for(let ue=0;ue<ge.length&&!(pe&&ne.length>=p);ue++){let Le=ge[ue],We={color:Le.pickedColor,layer:null,index:Le.pickedObjectIndex,picked:!0,x:n,y:o,pixelRatio:k};We=B9({layer:Le.pickedLayer,info:We,mode:u});let ze=We.layer.id;Se.has(ze)||Se.set(ze,new Set);let rt=Se.get(ze),at=We.object??We.index;rt.has(at)||(rt.add(at),ne.push(We))}return ne}async _drawAndSampleAsync({layers:e,views:r,viewports:i,onViewportActive:n,deviceRect:o,cullRect:s,effects:a,pass:u},p=!1){let m=p?this.depthFBO:this.pickingFBO,x={layers:e,layerFilter:this.layerFilter,views:r,viewports:i,onViewportActive:n,pickingFBO:m,deviceRect:o,cullRect:s,effects:a,pass:u,pickZ:p,preRenderStats:{},isPicking:!0};for(let Z of a)Z.useInPicking&&(x.preRenderStats[Z.id]=Z.preRender(x));let{decodePickingColor:M}=this.pickLayersPass.render(x),{x:k,y:F,width:j,height:H}=o,W=new(p?Float32Array:Uint8Array)(j*H*4);return this.device.readPixelsToArrayWebGL(m,{sourceX:k,sourceY:F,sourceWidth:j,sourceHeight:H,target:W}),{pickedColors:W,decodePickingColor:M}}_drawAndSample({layers:e,views:r,viewports:i,onViewportActive:n,deviceRect:o,cullRect:s,effects:a,pass:u},p=!1){let m=p?this.depthFBO:this.pickingFBO,x={layers:e,layerFilter:this.layerFilter,views:r,viewports:i,onViewportActive:n,pickingFBO:m,deviceRect:o,cullRect:s,effects:a,pass:u,pickZ:p,preRenderStats:{},isPicking:!0};for(let Z of a)Z.useInPicking&&(x.preRenderStats[Z.id]=Z.preRender(x));let{decodePickingColor:M}=this.pickLayersPass.render(x),{x:k,y:F,width:j,height:H}=o,W=new(p?Float32Array:Uint8Array)(j*H*4);return this.device.readPixelsToArrayWebGL(m,{sourceX:k,sourceY:F,sourceWidth:j,sourceHeight:H,target:W}),{pickedColors:W,decodePickingColor:M}}_getPickingRect({deviceX:e,deviceY:r,deviceRadius:i,deviceWidth:n,deviceHeight:o}){let s=Math.max(0,e-i),a=Math.max(0,r-i),u=Math.min(n,e+i+1)-s,p=Math.min(o,r+i+1)-a;return u<=0||p<=0?null:{x:s,y:a,width:u,height:p}}};var Q$e={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},J$e="top-left",kve="__root",F9=class{constructor({deck:e,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,r?.classList.add("deck-widget-container"),this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!vo(e.widgets,this.widgets,1)){let r=e.widgets.filter(Boolean);this._setWidgets(r)}}finalize(){for(let e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(let e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(r=>r.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:r}){let i=e.reduce((n,o)=>(n[o.id]=o,n),{});for(let n of this.getWidgets()){let{viewId:o}=n;if(o){let s=i[o];s&&(n.onViewportChange&&n.onViewportChange(s),n.onRedraw?.({viewports:[s],layers:r}))}else{if(n.onViewportChange)for(let s of e)n.onViewportChange(s);n.onRedraw?.({viewports:e,layers:r})}}this.lastViewports=i,this._updateContainers()}onHover(e,r){for(let i of this.getWidgets()){let{viewId:n}=i;(!n||n===e.viewport?.id)&&i.onHover?.(e,r)}}onEvent(e,r){let i=B5[r.type];if(i)for(let n of this.getWidgets()){let{viewId:o}=n;(!o||o===e.viewport?.id)&&n[i]?.(e,r)}}_setWidgets(e){let r={};for(let i of this.resolvedWidgets)r[i.id]=i;this.resolvedWidgets.length=0;for(let i of this.defaultWidgets)r[i.id]=null,this.resolvedWidgets.push(i);for(let i of e){let n=r[i.id];n?n.viewId!==i.viewId||n.placement!==i.placement?(this._removeWidget(n),this._addWidget(i)):i!==n&&(n.setProps(i.props),i=n):this._addWidget(i),r[i.id]=null,this.resolvedWidgets.push(i)}for(let i in r){let n=r[i];n&&this._removeWidget(n)}this.widgets=e}_addWidget(e){let{viewId:r=null,placement:i=J$e}=e;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:r}),e.rootElement&&this._getContainer(r,i).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,r){let i=e||kve,n=this.containers[i];n||(n=document.createElement("div"),n.style.pointerEvents="none",n.style.position="absolute",n.style.overflow="hidden",this.parentElement?.append(n),this.containers[i]=n);let o=n.querySelector(`.${r}`);return o||(o=globalThis.document.createElement("div"),o.className=r,o.style.position="absolute",o.style.zIndex="2",Object.assign(o.style,Q$e[r]),n.append(o)),o}_updateContainers(){let e=this.deck.width,r=this.deck.height;for(let i in this.containers){let n=this.lastViewports[i]||null,o=i===kve||n,s=this.containers[i];o?(s.style.display="block",s.style.left=`${n?n.x:0}px`,s.style.top=`${n?n.y:0}px`,s.style.width=`${n?n.width:e}px`,s.style.height=`${n?n.height:r}px`):s.style.display="none"}}};function CK(t,e){e&&Object.entries(e).map(([r,i])=>{r.startsWith("--")?t.style.setProperty(r,i):t.style[r]=i})}function Rve(t,e){e&&Object.keys(e).map(r=>{r.startsWith("--")?t.style.removeProperty(r):t.style[r]=""})}var qa=class{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){let r=this.props,i=this.rootElement;i&&r.className!==e.className&&(r.className&&i.classList.remove(r.className),e.className&&i.classList.add(e.className)),i&&!vo(r.style,e.style,1)&&(Rve(i,r.style),CK(i,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){let e=["deck-widget",this.className,this.props.className],r=document.createElement("div");return e.filter(i=>typeof i=="string"&&i.length>0).forEach(i=>r.classList.add(i)),CK(r,this.props.style),r}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,r){}onClick(e,r){}onDrag(e,r){}onDragStart(e,r){}onDragEnd(e,r){}};qa.defaultProps={id:"widget",style:{},className:""};var eWe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"},iP=class extends qa{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){let e=document.createElement("div");return e.className=this.className,Object.assign(e.style,eWe),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){let{deck:r}=this,i=r&&r.props.getTooltip;if(!i)return;let n=i(e);this.lastViewport=e.viewport,this.setTooltip(n,e.x,e.y)}setTooltip(e,r,i){let n=this.rootElement;if(n){if(typeof e=="string")n.innerText=e;else if(e)e.text&&(n.innerText=e.text),e.html&&(n.innerHTML=e.html),e.className&&(n.className=e.className);else{this.isVisible=!1,n.style.display="none";return}this.isVisible=!0,n.style.display="block",n.style.transform=`translate(${r}px, ${i}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(n.style,e.style)}}};iP.defaultProps={...qa.defaultProps};Vi();lB();n3();function m_(){}var oGe=({isDragging:t})=>t?"grabbing":"grab",rbe={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:m_,onWebGLInitialized:m_,onResize:m_,onViewStateChange:m_,onInteractionStateChange:m_,onBeforeRender:m_,onAfterRender:m_,onLoad:m_,onError:t=>mr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:oGe,getTooltip:null,debug:!1,drawPickingColors:!1},hP=class{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Su({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=i=>{let{_pickRequest:n}=this;if(i.type==="pointerleave")n.x=-1,n.y=-1,n.radius=0;else{if(i.leftButton||i.rightButton)return;{let o=i.offsetCenter;if(!o)return;n.x=o.x,n.y=o.y,n.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:n.x,y:n.y}),n.event=i},this._onEvent=i=>{let n=B5[i.type],o=i.offsetCenter;if(!n||!o||!this.layerManager)return;let s=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:o.x,y:o.y,layers:s,viewports:this.getViewports(o)},this._lastPointerDownInfo),{layer:u}=a,p=u&&(u[n]||u.props[n]),m=this.props[n],x=!1;p&&(x=p.call(u,a,i)),x||(m?.(a,i),this.widgetManager.onEvent(a,i))},this._onPointerDown=i=>{if(this.device?.type==="webgpu")return;let n=i.offsetCenter,o=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=o.result[0]||o.emptyInfo},this.props={...rbe,...e},e=this.props,e.viewState&&e.initialViewState&&mr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let r=this.device;!r&&e.gl&&(e.gl instanceof WebGLRenderingContext&&mr.error("WebGL1 context not supported.")(),r=uP.attach(e.gl,this.props.deviceProps)),r||(r=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(r,e),this.setProps(e),e._typedArrayManagerProps&&$f.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&mr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&mr.removed("onLayerClick","onClick")(),e.initialViewState&&!vo(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);let r=Object.create(this.props);if(Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),mr.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(r),e.useDevicePixels!==void 0&&this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){this.device.canvasContext.props.useDevicePixels=e.useDevicePixels;let i=this.device.canvasContext.canvas,n={target:i,contentBoxSize:[{inlineSize:i.clientWidth,blockSize:i.clientHeight}],devicePixelContentBoxSize:[{inlineSize:i.clientWidth,blockSize:i.clientHeight}],borderBoxSize:[{inlineSize:i.clientWidth,blockSize:i.clientHeight}]};this.device.canvasContext._handleResize([n])}this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);let i=this.viewManager.needsRedraw(e),n=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return r=r||i||n||o||s,r}redraw(e){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=e||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return Pr(this.viewManager),this.viewManager.views}getViewports(e){return Pr(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){let r=this._pick("pickObject","pickObject Time",e).result;return r.length?r[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,r=!1){for(let i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:r})}_removeResources(e){for(let r of e)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,r,i){Pr(this.deckPicker);let{stats:n}=this;n.get("Pick Count").incrementCount(),n.get(r).timeStart();let o=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return n.get(r).timeEnd(),o}_createCanvas(e){let r=e.canvas;return typeof r=="string"&&(r=document.getElementById(r),Pr(r)),r||(r=document.createElement("canvas"),r.id=e.id||"deckgl-overlay",e.width&&typeof e.width=="number"&&(r.width=e.width),e.height&&typeof e.height=="number"&&(r.height=e.height),(e.parent||document.body).appendChild(r)),Object.assign(r.style,e.style),r}_setCanvasSize(e){if(!this.canvas)return;let{width:r,height:i}=e;if(r||r===0){let n=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=n}if(i||i===0){let n=Number.isFinite(i)?`${i}px`:i;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=n}}_updateCanvasSize(){let{canvas:e}=this;if(!e)return;let r=e.clientWidth??e.width,i=e.clientHeight??e.height;(r!==this.width||i!==this.height)&&(this.width=r,this.height=i,this.viewManager?.setProps({width:r,height:i}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(e,r){let{gl:i,onError:n}=r;return new G5({device:e,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:n})}_createDevice(e){let r=this.props.deviceProps?.createCanvasContext,i=typeof r=="object"?r:void 0,n={adapters:[],...e.deviceProps};n.adapters.includes(uP)||n.adapters.push(uP);let o={alphaMode:this.props.deviceProps?.type==="webgpu"?"premultiplied":void 0};return u3.createDevice({_reuseDevices:!0,type:"webgl",...n,createCanvasContext:{...o,...i,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let{views:e}=this.props,r=Array.isArray(e)?e:e?[e]:[new d_({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){let{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;let{_pickRequest:e}=this;if(e.event){let{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let n=i,o=!1;for(let s of r)n=s,o=s.layer?.onHover(s,e.event)||o;o||(this.props.onHover?.(n,e.event),this.widgetManager.onHover(n,e.event)),e.event=null}}_updateCursor(){let e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);let r=new lb;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new L5(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(lK).map(n=>{let[o,s,a,u]=lK[n],p=this.props.eventRecognizerOptions?.[n],m={...s,...p,event:n};return{recognizer:new o(m),recognizeWith:a,requestFailure:u}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(let n in B5)this.eventManager.on(n,this._onEvent);this.viewManager=new X5({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});let i=this.viewManager.getViewports()[0];this.layerManager=new Y5(this.device,{deck:this,stats:this.stats,viewport:i,timeline:r}),this.effectManager=new J5({deck:this,device:this.device}),this.deckRenderer=new tP(this.device),this.deckPicker=new rP(this.device),this.widgetManager=new F9({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new iP),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,r){let{device:i,gl:n}=this.layerManager.context;this.props.onBeforeRender({device:i,gl:n});let o={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(o),o.pass==="screen"&&this.widgetManager.onRedraw({viewports:o.viewports,layers:o.layers}),this.props.onAfterRender({device:i,gl:n})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),mr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){let r=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){let{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();let r=this.animationLoop.stats;e.get("GPU Time").addTime(r.get("GPU Time").lastTiming),e.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){let{metrics:e,stats:r}=this;e.fps=r.get("frameRate").getHz(),e.setPropsTime=r.get("setProps Time").time,e.updateAttributesTime=r.get("Update Attributes").time,e.framesRedrawn=r.get("Redraw Count").count,e.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,e.pickCount=r.get("Pick Count").count,e.gpuTime=r.get("GPU Time").time,e.cpuTime=r.get("CPU Time").time,e.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=r.get("CPU Time").getAverageTime();let i=u3.stats.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}};hP.defaultProps=rbe;hP.VERSION=rAe;var g_=hP;Vi();Vi();function ibe(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return G1(t)}}var nbe=W1;function dP(t,e,r){let i=r==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${i}x${e.size}`:e.type,byteOffset:e.offset||0}}function A_(t){return t.stride||t.size*t.bytesPerElement}function obe(t,e){return t.type===e.type&&t.size===e.size&&A_(t)===A_(e)&&(t.offset||0)===(e.offset||0)}function KK(t,e){e.offset&&mr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();let r=A_(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,n=e.elementOffset||0,o=i*r+n*t.bytesPerElement+(t.offset||0);return{...e,offset:o,stride:r}}function sGe(t,e){let r=KK(t,e);return{high:r,low:{...r,offset:r.offset+t.size*4}}}var fP=class{constructor(e,r,i){this._buffer=null,this.device=e,this.id=r.id||"",this.size=r.size||1;let n=r.logicalType||r.type,o=n==="float64",{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let a;o?a="float32":!n&&r.isIndexed?a="uint32":a=n||"float32";let u=ibe(n||a);this.doublePrecision=o,o&&r.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...r,defaultType:u,defaultValue:s,logicalType:n,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){let e=this.getAccessor();return e.vertexOffset?e.vertexOffset*A_(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),$f.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,r=null){let i={};if(this.state.constant){let n=this.value;if(r){let o=KK(this.getAccessor(),r),s=o.offset/n.BYTES_PER_ELEMENT,a=o.size||this.size;i[e]=n.subarray(s,s+a)}else i[e]=n}else i[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?i[`${e}64Low`]=i[e]:i[`${e}64Low`]=new Float32Array(this.size)),i}_getBufferLayout(e=this.id,r=null){let i=this.getAccessor(),n=[],o={name:this.id,byteStride:A_(i),attributes:n};if(this.doublePrecision){let s=sGe(i,r||{});n.push(dP(e,{...i,...s.high},this.device.type),dP(`${e}64Low`,{...i,...s.low},this.device.type))}else if(r){let s=KK(i,r);n.push(dP(e,{...i,...s},this.device.type))}else n.push(dP(e,i,this.device.type));return o}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){let r=Array.from(this.value);e=[r,r]}else{let{value:r,numInstances:i,size:n}=this,o=i*n;if(r&&o&&r.length>=o){let s=new Array(n).fill(1/0),a=new Array(n).fill(-1/0);for(let u=0;u<o;)for(let p=0;p<n;p++){let m=r[u++];m<s[p]&&(s[p]=m),m>a[p]&&(a[p]=m)}e=[s,a]}}return this.state.bounds=e,e}setData(e){let{state:r}=this,i;ArrayBuffer.isView(e)?i={value:e}:e instanceof vn?i={buffer:e}:i=e;let n={...this.settings,...i};if(ArrayBuffer.isView(i.value)){if(!i.type)if(this.doublePrecision&&i.value instanceof Float64Array)n.type="float32";else{let s=nbe(i.value);n.type=n.normalized?s.replace("int","norm"):s}n.bytesPerElement=i.value.BYTES_PER_ELEMENT,n.stride=A_(n)}if(r.bounds=null,i.constant){let o=i.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!r.constant||!this._areValuesEqual(o,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(o)?o:new Float32Array(o)}else if(i.buffer){let o=i.buffer;r.externalBuffer=o,r.constant=!1,this.value=i.value||null}else if(i.value){this._checkExternalBuffer(i);let o=i.value;r.externalBuffer=null,r.constant=!1,this.value=o;let{buffer:s}=this,a=A_(n),u=(n.vertexOffset||0)*a;if(this.doublePrecision&&o instanceof Float64Array&&(o=S9(o,n)),this.settings.isIndexed){let m=this.settings.defaultType;o.constructor!==m&&(o=new m(o))}let p=o.byteLength+u+a*2;(!s||s.byteLength<p)&&(s=this._createBuffer(p)),s.write(o,u)}return this.setAccessor(n),!0}updateSubBuffer(e={}){this.state.bounds=null;let r=this.value,{startOffset:i=0,endOffset:n}=e;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?S9(r,{size:this.size,startIndex:i,endIndex:n}):r.subarray(i,n),i*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,r=!1){let{state:i}=this,n=i.allocatedValue,o=$f.allocate(n,e+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=o;let{byteOffset:s}=this,{buffer:a}=this;return(!a||a.byteLength<o.byteLength+s)&&(a=this._createBuffer(o.byteLength+s),r&&n&&a.write(n instanceof Float64Array?S9(n,this):n,s)),i.allocatedValue=o,i.constant=!1,i.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){let{value:r}=e;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);let i=this.settings.defaultType,n=!1;if(this.doublePrecision&&(n=r.BYTES_PER_ELEMENT<4),n)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof i)&&this.settings.normalized&&!("normalized"in e)&&mr.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(e).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(r=>r/255);case"unorm16":return new Float32Array(e).map(r=>r/65535);default:return e}}_normalizeValue(e,r,i){let{defaultValue:n,size:o}=this.settings;if(Number.isFinite(e))return r[i]=e,r;if(!e){let s=o;for(;--s>=0;)r[i+s]=n[s];return r}switch(o){case 4:r[i+3]=Number.isFinite(e[3])?e[3]:n[3];case 3:r[i+2]=Number.isFinite(e[2])?e[2]:n[2];case 2:r[i+1]=Number.isFinite(e[1])?e[1]:n[1];case 1:r[i+0]=Number.isFinite(e[0])?e[0]:n[0];break;default:let s=o;for(;--s>=0;)r[i+s]=Number.isFinite(e[s])?e[s]:n[s]}return r}_areValuesEqual(e,r){if(!e||!r)return!1;let{size:i}=this;for(let n=0;n<i;n++)if(e[n]!==r[n])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();let{isIndexed:r,type:i}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(r?vn.INDEX:vn.VERTEX)|vn.COPY_DST,indexType:r?i:void 0,byteLength:e}),this._buffer}};var sbe=[],abe=[];function Vc(t,e=0,r=1/0){let i=sbe,n={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(abe.length=t.length,i=abe):i=sbe,(e>0||Number.isFinite(r))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,r),n.index=e-1),{iterable:i,objectInfo:n}}function dB(t){return t&&t[Symbol.asyncIterator]}function fB(t,e){let{size:r,stride:i,offset:n,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,u=i?i/a:r,p=n?n/a:0,m=Math.floor((t.length-p)/u);return(x,{index:M,target:k})=>{if(!o){let W=M*u+p;for(let Z=0;Z<r;Z++)k[Z]=t[W+Z];return k}let F=o[M],j=o[M+1]||m,H;if(s){H=new Array(j-F);for(let W=F;W<j;W++){let Z=W*u+p;k=new Array(r);for(let Y=0;Y<r;Y++)k[Y]=t[Z+Y];H[W-F]=k}}else if(u===r)H=t.subarray(F*r+p,j*r+p);else{H=new t.constructor((j-F)*r);let W=0;for(let Z=F;Z<j;Z++){let Y=Z*u+p;for(let ee=0;ee<r;ee++)H[W++]=t[Y+ee]}}return H}}var lbe=[],pP=[[0,1/0]];function cbe(t,e){if(t===pP||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;let r=[],i=t.length,n=0;for(let o=0;o<i;o++){let s=t[o];s[1]<e[0]?(r.push(s),n=o+1):s[0]>e[1]?r.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return r.splice(n,0,e),r}var lGe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function pB(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});let r=t.type||"interpolation";return{...lGe[r],...e,...t,type:r}}var mb=class extends fP{constructor(e,r){super(e,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:pP}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){let r=this.state.needsRedraw;return this.state.needsRedraw=r&&!e,r}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var r;(r=this.state).layoutChanged||(r.layoutChanged=!obe(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){let{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;let{accessor:r}=this.settings,i=this.settings.transition,n=Array.isArray(r)?e[r.find(o=>e[o])]:e[r];return pB(n,i)}setNeedsUpdate(e=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),r){let{startRow:i=0,endRow:n=1/0}=r;this.state.updateRanges=cbe(this.state.updateRanges,[i,n])}else this.state.updateRanges=pP}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=lbe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){let{state:r,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,r.updateRanges!==pP),!0):!1}updateBuffer({numInstances:e,data:r,props:i,context:n}){if(!this.needsUpdate())return!1;let{state:{updateRanges:o},settings:{update:s,noAlloc:a}}=this,u=!0;if(s){for(let[p,m]of o)s.call(n,this,{data:r,startRow:p,endRow:m,props:i,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(let[p,m]of o){let x=Number.isFinite(p)?this.getVertexOffset(p):0,M=Number.isFinite(m)?this.getVertexOffset(m):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:x,endOffset:M})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e,r){let i=this.device.type==="webgpu";if(i||r===void 0||typeof r=="function"){if(i&&typeof r!="function"){let s=this._normalizeValue(r,[],0);this._areValuesEqual(s,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}let n=this.settings.transform&&e?this.settings.transform.call(e,r):r;return this.setData({constant:!0,value:n})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){let{state:r}=this;return e?(this.clearNeedsUpdate(),r.lastExternalBuffer===e||(r.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(e,r=null){let{state:i,settings:n}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(n.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),n.transform||r!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});let s=e;Pr(ArrayBuffer.isView(s.value),`invalid ${n.accessor}`);let a=!!s.size&&s.size!==this.size;return i.binaryAccessor=fB(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){let{startIndices:r}=this;return(r?e<r.length?r[e]:this.numInstances:e)*this.size}getValue(){let e=this.settings.shaderAttributes,r=super.getValue();if(!e)return r;for(let i in e)Object.assign(r,super.getValue(i,e[i]));return r}getBufferLayout(e){this.state.layoutChanged=!1;let r=this.settings.shaderAttributes,i=super._getBufferLayout(),{stepMode:n}=this.settings;if(n==="dynamic"?i.stepMode=e?e.isInstanced?"instance":"vertex":"instance":i.stepMode=n??"vertex",!r)return i;for(let o in r){let s=super._getBufferLayout(o,r[o]);i.attributes.push(...s.attributes)}return i}_autoUpdater(e,{data:r,startRow:i,endRow:n,props:o,numInstances:s}){if(e.constant&&this.context.device.type!=="webgpu")return;let{settings:a,state:u,value:p,size:m,startIndices:x}=e,{accessor:M,transform:k}=a,F=u.binaryAccessor||(typeof M=="function"?M:o[M]);typeof F!="function"&&typeof M=="string"&&(F=()=>o[M]),Pr(typeof F=="function",`accessor "${M}" is not a function`);let j=e.getVertexOffset(i),{iterable:H,objectInfo:W}=Vc(r,i,n);for(let Z of H){W.index++;let Y=F(Z,W);if(k&&(Y=k.call(this,Y)),x){let ee=(W.index<x.length-1?x[W.index+1]:s)-x[W.index];if(Y&&Array.isArray(Y[0])){let ce=j;for(let ge of Y)e._normalizeValue(ge,p,ce),ce+=m}else Y&&Y.length>m?p.set(Y,j):(e._normalizeValue(Y,W.target,0),wK({target:p,source:W.target,start:j,count:ee}));j+=ee*m}else e._normalizeValue(Y,p,j),j+=m}}_validateAttributeUpdaters(){let{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){let{value:e}=this,r=Math.min(4,this.size);if(e&&e.length>=r){let i=!0;switch(r){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error(`Illegal attribute generated for ${this.id}`)}}};function QK(t){let{source:e,target:r,start:i=0,size:n,getData:o}=t,s=t.end||r.length,a=e.length,u=s-i;if(a>u){r.set(e.subarray(0,u),i);return}if(r.set(e,i),!o)return;let p=a;for(;p<u;){let m=o(p,e);for(let x=0;x<n;x++)r[i+p]=m[x]||0,p++}}function ube({source:t,target:e,size:r,getData:i,sourceStartIndices:n,targetStartIndices:o}){if(!n||!o)return QK({source:t,target:e,size:r,getData:i}),e;let s=0,a=0,u=i&&((m,x)=>i(m+a,x)),p=Math.min(n.length,o.length);for(let m=1;m<p;m++){let x=n[m]*r,M=o[m]*r;QK({source:t.subarray(s,x),target:e,start:a,end:M,size:r,getData:u}),s=x,a=M}return a<e.length&&QK({source:[],target:e,start:a,size:r,getData:u}),e}function hbe(t){let{device:e,settings:r,value:i}=t,n=new mb(e,r);return n.setData({value:i instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),n}function mB(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function gB(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function AB(t){t.push(t.shift())}function dbe(t,e){let{doublePrecision:r,settings:i,value:n,size:o}=t,s=r&&n instanceof Float64Array?2:1,a=0,{shaderAttributes:u}=t.settings;if(u)for(let p of Object.values(u))a=Math.max(a,p.vertexOffset??0);return(i.noAlloc?n.length:(e+a)*o)*s}function yB({device:t,source:e,target:r}){return(!r||r.byteLength<e.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),r}function _B({device:t,buffer:e,attribute:r,fromLength:i,toLength:n,fromStartIndices:o,getData:s=a=>a}){let a=r.doublePrecision&&r.value instanceof Float64Array?2:1,u=r.size*a,p=r.byteOffset,m=r.settings.bytesPerElement<4?p/r.settings.bytesPerElement*4:p,x=r.startIndices,M=o&&x,k=r.isConstant;if(!M&&e&&i>=n)return e;let F=r.value instanceof Float64Array?Float32Array:r.value.constructor,j=k?r.value:new F(r.getBuffer().readSyncWebGL(p,n*F.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!k){let Y=s;s=(ee,ce)=>r.normalizeConstant(Y(ee,ce))}let H=k?(Y,ee)=>s(j,ee):(Y,ee)=>s(j.subarray(Y+p,Y+p+u),ee),W=e?new Float32Array(e.readSyncWebGL(m,i*4).buffer):new Float32Array(0),Z=new Float32Array(n);return ube({source:W,target:Z,sourceStartIndices:o,targetStartIndices:x,size:u,getData:H}),(!e||e.byteLength<Z.byteLength+m)&&(e?.destroy(),e=t.createBuffer({byteLength:Z.byteLength+m,usage:35050})),e.write(Z,m),e}var q3=class{constructor({device:e,attribute:r,timeline:i}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new Gf(i),this.attribute=r,this.attributeInTransition=hbe(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(e,r,i=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=dbe(this.attribute,r),this.transition.start({...e,duration:i})}update(){let e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(let e of this.buffers)e.destroy();this.buffers.length=0}};var mP=class extends q3{constructor({device:e,attribute:r,timeline:i}){super({device:e,attribute:r,timeline:i}),this.type="interpolation",this.transform=dGe(e,r)}start(e,r){let i=this.currentLength,n=this.currentStartIndices;if(super.start(e,r,e.duration),e.duration<=0){this.transition.cancel();return}let{buffers:o,attribute:s}=this;AB(o),o[0]=_B({device:this.device,buffer:o[0],attribute:s,fromLength:i,toLength:this.currentLength,fromStartIndices:n,getData:e.enter}),o[1]=yB({device:this.device,source:o[0],target:o[1]}),this.setBuffer(o[1]);let{transform:a}=this,u=a.model,p=Math.floor(this.currentLength/s.size);pbe(s)&&(p/=2),u.setVertexCount(p),s.isConstant?(u.setAttributes({aFrom:o[0]}),u.setConstantAttributes({aTo:s.value})):u.setAttributes({aFrom:o[0],aTo:s.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:o[1]})}onUpdate(){let{duration:e,easing:r}=this.settings,{time:i}=this.transition,n=i/e;r&&(n=r(n));let{model:o}=this.transform,s={time:n};o.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},cGe=`uniform interpolationUniforms {
  float time;
} interpolation;
`,fbe={name:"interpolation",vs:cGe,uniformTypes:{time:"f32"}},uGe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,hGe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function pbe(t){return t.doublePrecision&&t.value instanceof Float64Array}function dGe(t,e){let r=e.size,i=mB(r),n=gB(r),o=e.getBufferLayout();return pbe(e)?new u_(t,{vs:hGe,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:n,byteOffset:0},{attribute:"aFrom64Low",format:n,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:n,byteOffset:0},{attribute:"aTo64Low",format:n,byteOffset:4*r}]}],modules:[ZZ,fbe],defines:{ATTRIBUTE_TYPE:i,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new u_(t,{vs:uGe,bufferLayout:[{name:"aFrom",format:n},{name:"aTo",format:o.attributes[0].format}],modules:[fbe],defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"],disableWarnings:!0})}var gP=class extends q3{constructor({device:e,attribute:r,timeline:i}){super({device:e,attribute:r,timeline:i}),this.type="spring",this.texture=yGe(e),this.framebuffer=_Ge(e,this.texture),this.transform=AGe(e,r)}start(e,r){let i=this.currentLength,n=this.currentStartIndices;super.start(e,r);let{buffers:o,attribute:s}=this;for(let u=0;u<2;u++)o[u]=_B({device:this.device,buffer:o[u],attribute:s,fromLength:i,toLength:this.currentLength,fromStartIndices:n,getData:e.enter});o[2]=yB({device:this.device,source:o[0],target:o[2]}),this.setBuffer(o[1]);let{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?a.setConstantAttributes({aTo:s.value}):a.setAttributes({aTo:s.getBuffer()})}onUpdate(){let{buffers:e,transform:r,framebuffer:i,transition:n}=this,o=this.settings;r.model.setAttributes({aPrev:e[0],aCur:e[1]}),r.transformFeedback.setBuffers({vNext:e[2]});let s={stiffness:o.stiffness,damping:o.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:i,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),AB(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(i)[0]>0||n.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}},fGe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,pGe={name:"spring",vs:fGe,uniformTypes:{damping:"f32",stiffness:"f32"}},mGe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,gGe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function AGe(t,e){let r=mB(e.size),i=gB(e.size);return new u_(t,{vs:mGe,fs:gGe,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[pGe],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function yGe(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}function _Ge(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}var vGe={interpolation:mP,spring:gP},AP=class{constructor(e,{id:r,timeline:i}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(let e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:r,numInstances:i}){this.numInstances=i||1;for(let n in e){let o=e[n],s=o.getTransitionSetting(r);s&&this._updateAttribute(n,o,s)}for(let n in this.transitions){let o=e[n];(!o||!o.getTransitionSetting(r))&&this._removeTransition(n)}}hasAttribute(e){let r=this.transitions[e];return r&&r.inProgress}getAttributes(){let e={};for(let r in this.transitions){let i=this.transitions[r];i.inProgress&&(e[r]=i.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(let r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);let e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,r,i){let n=this.transitions[e],o=!n||n.type!==i.type;if(o){n&&this._removeTransition(e);let s=vGe[i.type];s?this.transitions[e]=new s({attribute:r,timeline:this.timeline,device:this.device}):(mr.error(`unsupported transition type '${i.type}'`)(),o=!1)}(o||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}};var mbe="attributeManager.invalidate",bGe="attributeManager.updateStart",xGe="attributeManager.updateEnd",wGe="attribute.updateStart",SGe="attribute.allocate",TGe="attribute.updateEnd",T0=class{constructor(e,{id:r="attribute-manager",stats:i,timeline:n}={}){this.mergeBoundsMemoized=y0(fve),this.id=r,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new AP(e,{id:`${r}-transitions`,timeline:n}),Object.seal(this)}finalize(){for(let e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){let r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(let r of e)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(e,r){let i=this._invalidateTrigger(e,r);ks(mbe,this,e,i)}invalidateAll(e){for(let r in this.attributes)this.attributes[r].setNeedsUpdate(r,e);ks(mbe,this,"all")}update({data:e,numInstances:r,startIndices:i=null,transitions:n,props:o={},buffers:s={},context:a={}}){let u=!1;ks(bGe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(let p in this.attributes){let m=this.attributes[p],x=m.settings.accessor;m.startIndices=i,m.numInstances=r,o[p]&&mr.removed(`props.${p}`,`data.attributes.${p}`)(),m.setExternalBuffer(s[p])||m.setBinaryValue(typeof x=="string"?s[x]:void 0,e.startIndices)||typeof x=="string"&&!s[x]&&m.setConstantValue(a,o[x])||m.needsUpdate()&&(u=!0,this._updateAttribute({attribute:m,numInstances:r,data:e,props:o,context:a})),this.needsRedraw=this.needsRedraw||m.needsRedraw()}u&&ks(xGe,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:n})}updateTransition(){let{attributeTransitionManager:e}=this,r=e.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){let r=e.map(i=>this.attributes[i]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(e={clearChangedFlags:!1}){let{attributes:r,attributeTransitionManager:i}=this,n={...i.getAttributes()};for(let o in r){let s=r[o];s.needsRedraw(e)&&!i.hasAttribute(o)&&(n[o]=s)}return n}getBufferLayouts(e){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(e))}_add(e,r){for(let i in e){let n=e[i],o={...n,id:i,size:n.isIndexed&&1||n.size||1,...r};this.attributes[i]=new mb(this.device,o)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){let e={};for(let r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(n=>{e[n]||(e[n]=[]),e[n].push(r)});this.updateTriggers=e}_invalidateTrigger(e,r){let{attributes:i,updateTriggers:n}=this,o=n[e];return o&&o.forEach(s=>{let a=i[s];a&&a.setNeedsUpdate(a.id,r)}),o}_updateAttribute(e){let{attribute:r,numInstances:i}=e;if(ks(wGe,r),r.constant){r.setConstantValue(e.context,r.value);return}r.allocate(i)&&ks(SGe,r,i),r.updateBuffer(e)&&(this.needsRedraw=!0,ks(TGe,r,i))}};Vi();lB();var yP=class extends Gf{get value(){return this._value}_onUpdate(){let{time:e,settings:{fromValue:r,toValue:i,duration:n,easing:o}}=this,s=o(e/n);this._value=sc(r,i,s)}};var gbe=1e-5;function Abe(t,e,r,i,n){let o=e-t,a=(r-e)*n,u=-o*i;return a+u+o+e}function MGe(t,e,r,i,n){if(Array.isArray(r)){let o=[];for(let s=0;s<r.length;s++)o[s]=Abe(t[s],e[s],r[s],i,n);return o}return Abe(t,e,r,i,n)}function ybe(t,e){if(Array.isArray(t)){let r=0;for(let i=0;i<t.length;i++){let n=t[i]-e[i];r+=n*n}return Math.sqrt(r)}return Math.abs(t-e)}var _P=class extends Gf{get value(){return this._currValue}_onUpdate(){let{fromValue:e,toValue:r,damping:i,stiffness:n}=this.settings,{_prevValue:o=e,_currValue:s=e}=this,a=MGe(o,s,r,i,n),u=ybe(a,r),p=ybe(a,s);u<gbe&&p<gbe&&(a=r,this.end()),this._prevValue=s,this._currValue=a}};var EGe={interpolation:yP,spring:_P},vP=class{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,r,i,n){let{transitions:o}=this;if(o.has(e)){let u=o.get(e),{value:p=u.settings.fromValue}=u;r=p,this.remove(e)}if(n=pB(n),!n)return;let s=EGe[n.type];if(!s){mr.error(`unsupported transition type '${n.type}'`)();return}let a=new s(this.timeline);a.start({...n,fromValue:r,toValue:i}),o.set(e,a)}remove(e){let{transitions:r}=this;r.has(e)&&(r.get(e).cancel(),r.delete(e))}update(){let e={};for(let[r,i]of this.transitions)i.update(),e[r]=i.value,i.inProgress||this.remove(r);return e}clear(){for(let e of this.transitions.keys())this.remove(e)}};function vbe(t){let e=t[Od];for(let r in e){let i=e[r],{validate:n}=i;if(n&&!n(t[r],i))throw new Error(`Invalid prop ${r}: ${t[r]}`)}}function bbe(t,e){let r=bP({newProps:t,oldProps:e,propTypes:t[Od],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=PGe(t,e),n=!1;return i||(n=IGe(t,e)),{dataChanged:i,propsChanged:r,updateTriggersChanged:n,extensionsChanged:kGe(t,e),transitionsChanged:CGe(t,e)}}function CGe(t,e){if(!t.transitions)return!1;let r={},i=t[Od],n=!1;for(let o in t.transitions){let s=i[o],a=s&&s.type;(a==="number"||a==="color"||a==="array")&&JK(t[o],e[o],s)&&(r[o]=!0,n=!0)}return n?r:!1}function bP({newProps:t,oldProps:e,ignoreProps:r={},propTypes:i={},triggerName:n="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${n} changed shallowly`;if(typeof e!="object"||e===null)return`${n} changed shallowly`;for(let o of Object.keys(t))if(!(o in r)){if(!(o in e))return`${n}.${o} added`;let s=JK(t[o],e[o],i[o]);if(s)return`${n}.${o} ${s}`}for(let o of Object.keys(e))if(!(o in r)){if(!(o in t))return`${n}.${o} dropped`;if(!Object.hasOwnProperty.call(t,o)){let s=JK(t[o],e[o],i[o]);if(s)return`${n}.${o} ${s}`}}return!1}function JK(t,e,r){let i=r&&r.equal;return i&&!i(t,e,r)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function PGe(t,e){if(e===null)return"oldProps is null, initial diff";let r=!1,{dataComparator:i,_dataDiff:n}=t;return i?i(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied"),r&&n&&(r=n(t.data,e.data)||r),r}function IGe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&_be(t,e,"all"))return{all:!0};let r={},i=!1;for(let n in t.updateTriggers)n!=="all"&&_be(t,e,n)&&(r[n]=!0,i=!0);return i?r:!1}function kGe(t,e){if(e===null)return!0;let r=e.extensions,{extensions:i}=t;if(i===r)return!1;if(!r||!i||i.length!==r.length)return!0;for(let n=0;n<i.length;n++)if(!i[n].equals(r[n]))return!0;return!1}function _be(t,e,r){let i=t.updateTriggers[r];i=i??{};let n=e.updateTriggers[r];return n=n??{},bP({oldProps:n,newProps:i,triggerName:r})}var RGe="count(): argument not an object",OGe="count(): argument not a container";function xbe(t){if(!LGe(t))throw new Error(RGe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(DGe(t))return Object.keys(t).length;throw new Error(OGe)}function DGe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function LGe(t){return t!==null&&typeof t=="object"}function gb(t,e){if(!e)return t;let r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){let i=r.modules.findIndex(n=>n.name==="project32");i>=0&&r.modules.splice(i,1)}if("inject"in e)if(!t.inject)r.inject=e.inject;else{let i={...t.inject};for(let n in e.inject)i[n]=(i[n]||"")+e.inject[n];r.inject=i}return r}Vi();var BGe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},eQ={};function wbe(t,e,r,i){if(r instanceof ps)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let n=null;r.compressed&&(n={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});let{width:o,height:s}=r.data,a=e.createTexture({...r,sampler:{...BGe,...n,...i},mipLevels:e.getMipLevelCount(o,s)});return a.generateMipmapsWebGL(),eQ[a.id]=t,a}function Sbe(t,e){!e||!(e instanceof ps)||eQ[e.id]===t&&(e.delete(),delete eQ[e.id])}var FGe={boolean:{validate(t,e){return!0},equal(t,e,r){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||tQ(t)&&(t.length===3||t.length===4)},equal(t,e,r){return vo(t,e,1)}},accessor:{validate(t,e){let r=vB(t);return r==="function"||r===vB(e.value)},equal(t,e,r){return typeof e=="function"?!0:vo(t,e,1)}},array:{validate(t,e){return e.optional&&!t||tQ(t)},equal(t,e,r){let{compare:i}=r,n=Number.isInteger(i)?i:i?1:0;return i?vo(t,e,n):t===e}},object:{equal(t,e,r){if(r.ignore)return!0;let{compare:i}=r,n=Number.isInteger(i)?i:i?1:0;return i?vo(t,e,n):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,r){return!r.compare&&r.ignore!==!1||t===e}},data:{transform:(t,e,r)=>{if(!t)return t;let{dataTransform:i}=r.props;return i?i(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,r)=>{let i=r.context;return!i||!i.device?null:wbe(r.id,i.device,t,{...e.parameters,...r.props.textureParameters})},release:(t,e,r)=>{Sbe(r.id,t)}}};function Tbe(t){let e={},r={},i={};for(let[n,o]of Object.entries(t)){let s=o?.deprecatedFor;if(s)i[n]=Array.isArray(s)?s:[s];else{let a=NGe(n,o);e[n]=a,r[n]=a.value}}return{propTypes:e,defaultProps:r,deprecatedProps:i}}function NGe(t,e){switch(vB(e)){case"object":return xP(t,e);case"array":return xP(t,{type:"array",value:e,compare:!1});case"boolean":return xP(t,{type:"boolean",value:e});case"number":return xP(t,{type:"number",value:e});case"function":return xP(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function xP(t,e){return"type"in e?{name:t,...FGe[e.type],...e}:"value"in e?{name:t,type:vB(e.value),...e}:{name:t,type:"object",value:e}}function tQ(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function vB(t){return tQ(t)?"array":t===null?"null":typeof t}function Mbe(t,e){let r;for(let o=e.length-1;o>=0;o--){let s=e[o];"extensions"in s&&(r=s.extensions)}let i=rQ(t.constructor,r),n=Object.create(i);n[V3]=t,n[_0]={},n[Wf]={};for(let o=0;o<e.length;++o){let s=e[o];for(let a in s)n[a]=s[a]}return Object.freeze(n),n}var zGe="_mergedDefaultProps";function rQ(t,e){if(!(t instanceof bB.constructor))return{};let r=zGe;if(e)for(let n of e){let o=n.constructor;o&&(r+=`:${o.extensionName||o.name}`)}let i=Ebe(t,r);return i||(t[r]=UGe(t,e||[]))}function UGe(t,e){if(!t.prototype)return null;let i=Object.getPrototypeOf(t),n=rQ(i),o=Ebe(t,"defaultProps")||{},s=Tbe(o),a=Object.assign(Object.create(null),n,s.defaultProps),u=Object.assign(Object.create(null),n?.[Od],s.propTypes),p=Object.assign(Object.create(null),n?.[R9],s.deprecatedProps);for(let m of e){let x=rQ(m.constructor);x&&(Object.assign(a,x),Object.assign(u,x[Od]),Object.assign(p,x[R9]))}return VGe(a,t),$Ge(a,u),jGe(a,p),a[Od]=u,a[R9]=p,e.length===0&&!iQ(t,"_propTypes")&&(t._propTypes=u),a}function VGe(t,e){let r=GGe(e);Object.defineProperties(t,{id:{writable:!0,value:r}})}function jGe(t,e){for(let r in e)Object.defineProperty(t,r,{enumerable:!1,set(i){let n=`${this.id}: ${r}`;for(let o of e[r])iQ(this,o)||(this[o]=i);mr.deprecated(n,e[r].join("/"))()}})}function $Ge(t,e){let r={},i={};for(let n in e){let o=e[n],{name:s,value:a}=o;o.async&&(r[s]=a,i[s]=WGe(s))}t[Sg]=r,t[_0]={},Object.defineProperties(t,i)}function WGe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||dB(e)?this[_0][t]=e:this[Wf][t]=e},get(){if(this[Wf]){if(t in this[Wf])return this[Wf][t]||this[Sg][t];if(t in this[_0]){let e=this[V3]&&this[V3].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Sg][t]}}return this[Sg][t]}}}function iQ(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ebe(t,e){return iQ(t,e)&&t[e]}function GGe(t){let e=t.componentName;return e||mr.warn(`${t.name}.componentName not specified`)(),e||t.name}var HGe=0,wP=class{constructor(...e){this.props=Mbe(this,e),this.id=this.props.id,this.count=HGe++}clone(e){let{props:r}=this,i={};for(let n in r[Sg])n in r[Wf]?i[n]=r[Wf][n]:n in r[_0]&&(i[n]=r[_0][n]);return new this.constructor({...r,...i,...e})}};wP.componentName="Component";wP.defaultProps={};var bB=wP;var qGe=Object.freeze({}),SP=class{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(let e in this.asyncProps){let r=this.asyncProps[e];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||qGe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){let r=this.asyncProps[e];return r&&r.resolvedValue}isAsyncPropLoading(e){if(e){let r=this.asyncProps[e];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(let r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(e,r){this._watchPromise(e,Promise.resolve(r))}setAsyncProps(e){this.component=e[V3]||this.component;let r=e[Wf]||{},i=e[_0]||e,n=e[Sg]||{};for(let o in r){let s=r[o];this._createAsyncPropData(o,n[o]),this._updateAsyncProp(o,s),r[o]=this.getAsyncProp(o)}for(let o in i){let s=i[o];this._createAsyncPropData(o,n[o]),this._updateAsyncProp(o,s)}}_fetch(e,r){return null}_onResolve(e,r){}_onError(e,r){}_updateAsyncProp(e,r){if(this._didAsyncInputValueChange(e,r)){if(typeof r=="string"&&(r=this._fetch(e,r)),r instanceof Promise){this._watchPromise(e,r);return}if(dB(r)){this._resolveAsyncIterable(e,r);return}this._setPropValue(e,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(let e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,r){let i=this.asyncProps[e];return r===i.resolvedValue||r===i.lastValue?!1:(i.lastValue=r,!0)}_setPropValue(e,r){this._freezeAsyncOldProps();let i=this.asyncProps[e];i&&(r=this._postProcessValue(i,r),i.resolvedValue=r,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,r,i){let n=this.asyncProps[e];n&&i>=n.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),n.resolvedValue=r,n.resolvedLoadCount=i,this.onAsyncPropUpdated(e,r))}_watchPromise(e,r){let i=this.asyncProps[e];if(i){i.pendingLoadCount++;let n=i.pendingLoadCount;r.then(o=>{this.component&&(o=this._postProcessValue(i,o),this._setAsyncPropValue(e,o,n),this._onResolve(e,o))}).catch(o=>{this._onError(e,o)})}}async _resolveAsyncIterable(e,r){if(e!=="data"){this._setPropValue(e,r);return}let i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;let n=i.pendingLoadCount,o=[],s=0;for await(let a of r){if(!this.component)return;let{dataTransform:u}=this.component.props;u?o=u(a,o):o=o.concat(a),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(e,o,n)}this._onResolve(e,o)}_postProcessValue(e,r){let i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(r,i,this.component):r}_createAsyncPropData(e,r){if(!this.asyncProps[e]){let n=this.component&&this.component.props[Od];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}};var TP=class extends SP{constructor({attributeManager:e,layer:r}){super(r),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,r){let i=this.layer,n=i?.props.fetch;return n?n(r,{propName:e,layer:i}):super._fetch(e,r)}_onResolve(e,r){let i=this.layer;if(i){let n=i.props.onDataLoad;e==="data"&&n&&n(r,{propName:e,layer:i})}}_onError(e,r){let i=this.layer;i&&i.raiseError(r,`loading ${e} of ${this.layer}`)}};var YGe="layer.changeFlag",XGe="layer.initialize",ZGe="layer.update",KGe="layer.finalize",QGe="layer.matched",Cbe=2**24-1,JGe=Object.freeze([]),eHe=y0(({oldViewport:t,viewport:e})=>t.equals(e)),Xf=new Uint8ClampedArray(0),tHe={data:{type:"data",value:JGe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:i,loadOptions:n,signal:o})=>{let{resourceManager:s}=r.context;n=n||r.getLoadOptions(),i=i||r.props.loaders,o&&(n={...n,fetch:{...n?.fetch,signal:o}});let a=s.contains(t);return!a&&!n&&(s.add({resourceId:t,data:e_(t,i),persistent:!1}),a=!0),a?s.subscribe({resourceId:t,onChange:u=>r.internalState?.reloadAsyncProp(e,u),consumerId:r.id,requestId:e}):e_(t,i,n)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Gr.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},MP=class extends bB{constructor(){super(...arguments),this.internalState=null,this.lifecycle=h_.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Pr(this.internalState);let r=this.internalState.viewport||this.context.viewport,i=_K(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[n,o,s]=D3(i,r.pixelProjectionMatrix);return e.length===2?[n,o]:[n,o,s]}unproject(e){return Pr(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,r){Pr(this.internalState);let i=this.internalState.viewport||this.context.viewport;return gve(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){let e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(let r of this.getModels())r.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){let{coordinateSystem:e}=this.props;return e===Gr.DEFAULT||e===Gr.LNGLAT||e===Gr.CARTESIAN}onHover(e,r){return this.props.onHover&&this.props.onHover(e,r)||!1}onClick(e,r){return this.props.onClick&&this.props.onClick(e,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,r=[]){return r[0]=e+1&255,r[1]=e+1>>8&255,r[2]=e+1>>8>>8&255,r}decodePickingColor(e){Pr(e instanceof Uint8Array);let[r,i,n]=e;return r+i*256+n*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:xbe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=gb(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(let r of this.props.extensions)e=gb(e,r.getShaders.call(this,r));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){let r=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&r)if(Array.isArray(i))for(let n of i)r.invalidateAll(n);else r.invalidateAll();if(r){let{props:n}=e,o=this.internalState.hasPickingBuffer,s=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(o!==s){this.internalState.hasPickingBuffer=s;let{pickingColors:a,instancePickingColors:u}=r.attributes,p=a||u;p&&(s&&p.constant&&(p.constant=!1,r.invalidate(p.id)),!p.value&&!s&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(e){for(let i of this.getModels())i.destroy();let r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(let r of this.getModels())r.draw(e.renderPass)}getPickingInfo({info:e,mode:r,sourceLayer:i}){let{index:n}=e;return n>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[n]),e}raiseError(e,r){r&&(e=new Error(`${r}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;let r=this.internalState.viewport;this.internalState.viewport=e,(!r||!eHe({oldViewport:r,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){let r=this.getAttributeManager();r&&(e==="all"?r.invalidateAll():r.invalidate(e))}updateAttributes(e){let r=!1;for(let i in e)e[i].layoutChanged()&&(r=!0);for(let i of this.getModels())this._setModelAttributes(i,e,r)}_updateAttributes(){let e=this.getAttributeManager();if(!e)return;let r=this.props,i=this.getNumInstances(),n=this.getStartIndices();e.update({data:r.data,numInstances:i,startIndices:n,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});let o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){let e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){let{uniformTransitions:e}=this.internalState;if(e.active){let r=e.update(),i=Object.create(this.props);for(let n in r)Object.defineProperty(i,n,{value:r[n]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:r}){if(e.constant)return;let i=Math.floor(Xf.length/4);if(this.internalState.usesPickingColorCache=!0,i<r){r>Cbe&&mr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Xf=$f.allocate(Xf,r,{size:4,copy:!0,maxCount:Math.max(r,Cbe)});let n=Math.floor(Xf.length/4),o=[0,0,0];for(let s=i;s<n;s++)this.encodePickingColor(s,o),Xf[s*4+0]=o[0],Xf[s*4+1]=o[1],Xf[s*4+2]=o[2],Xf[s*4+3]=0}e.value=Xf.subarray(0,r*4)}_setModelAttributes(e,r,i=!1){if(!Object.keys(r).length)return;if(i){let a=this.getAttributeManager();e.setBufferLayout(a.getBufferLayouts(e)),r=a.getAttributes()}let n=e.userData?.excludeAttributes||{},o={},s={};for(let a in r){if(n[a])continue;let u=r[a].getValue();for(let p in u){let m=u[p];m instanceof vn?r[a].settings.isIndexed?e.setIndexBuffer(m):o[p]=m:m&&(s[p]=m)}}e.setAttributes(o),e.setConstantAttributes(s)}disablePickingIndex(e){let r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(e);return}let{pickingColors:i,instancePickingColors:n}=this.getAttributeManager().attributes,o=i||n,s=o&&r.attributes&&r.attributes[o.id];if(s&&s.value){let a=s.value,u=this.encodePickingColor(e);for(let p=0;p<r.length;p++){let m=o.getVertexOffset(p);a[m]===u[0]&&a[m+1]===u[1]&&a[m+2]===u[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){let{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,n=r||i;if(!n)return;let o=n.getVertexOffset(e),s=n.getVertexOffset(e+1);n.buffer.write(new Uint8Array(s-o),o)}restorePickingColors(){let{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,i=e||r;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==Xf.buffer&&(i.value=Xf.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Pr(!this.internalState),Pr(Number.isFinite(this.props.coordinateSystem)),ks(XGe,this);let e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new TP({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(mr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new vP(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(let r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ks(QGe,this,this===e);let{state:r,internalState:i}=e;this!==e&&(this.internalState=i,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){let e=this.needsUpdate();if(ks(ZGe,this,e),!e)return;let r=this.props,i=this.context,n=this.internalState,o=i.viewport,s=this._updateUniformTransition();n.propsInTransition=s,i.viewport=n.viewport||o,this.props=s;try{let a=this._getUpdateParams(),u=this.getModels();if(i.device)this.updateState(a);else try{this.updateState(a)}catch{}for(let m of this.props.extensions)m.updateState.call(this,a,m);this.setNeedsRedraw(),this._updateAttributes();let p=this.getModels()[0]!==u[0];this._postUpdate(a,p)}finally{i.viewport=o,this.props=r,this._clearChangeFlags(),n.needsUpdate=!1,n.resetOldProps()}}_finalize(){ks(KGe,this),this.finalizeState(this.context);for(let e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:r=null,uniforms:i={},parameters:n={}}){this._updateAttributeTransition();let o=this.props,s=this.context;this.props=this.internalState.propsInTransition||o;try{r&&this.setShaderModuleProps(r);let{getPolygonOffset:a}=this.props,u=a&&a(i)||[0,0];s.device instanceof pb&&s.device.setParametersWebGL({polygonOffset:u});for(let p of this.getModels())p.device.type==="webgpu"?p.setParameters({...p.parameters,...n}):p.setParameters(n);if(s.device instanceof pb)s.device.withParametersWebGL(n,()=>{let p={renderPass:e,shaderModuleProps:r,uniforms:i,parameters:n,context:s};for(let m of this.props.extensions)m.draw.call(this,p,m);this.draw(p)});else{let p={renderPass:e,shaderModuleProps:r,uniforms:i,parameters:n,context:s};for(let m of this.props.extensions)m.draw.call(this,p,m);this.draw(p)}}finally{this.props=o}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;let{changeFlags:r}=this.internalState;for(let n in e)if(e[n]){let o=!1;switch(n){case"dataChanged":let s=e[n],a=r[n];s&&Array.isArray(a)&&(r.dataChanged=Array.isArray(s)?a.concat(s):s,o=!0);default:r[n]||(r[n]=e[n],o=!0)}o&&ks(YGe,this,n,e)}let i=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=i,r.somethingChanged=i||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,r){let i=bbe(e,r);if(i.updateTriggersChanged)for(let n in i.updateTriggersChanged)i.updateTriggersChanged[n]&&this.invalidateAttribute(n);if(i.transitionsChanged)for(let n in i.transitionsChanged)this.internalState.uniformTransitions.add(n,r[n],e[n],e.transitions?.[n]);return this.setChangeFlags(i)}validateProps(){vbe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){let r={highlightedObjectColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(r.highlightColor=i(e)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){let e=this.context;return new T0(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,r){let{props:i,oldProps:n}=e,o=this.state.model;o?.isInstanced&&o.setInstanceCount(this.getNumInstances());let{autoHighlight:s,highlightedObjectIndex:a,highlightColor:u}=i;if(r||n.autoHighlight!==s||n.highlightedObjectIndex!==a||n.highlightColor!==u){let p={};Array.isArray(u)&&(p.highlightColor=u),(r||n.autoHighlight!==s||a!==n.highlightedObjectIndex)&&(p.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:p})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;let i=this.getAttributeManager(),n=i?i.getNeedsRedraw(e):!1;if(r=r||n,r)for(let o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};MP.defaultProps=tHe;MP.layerName="Layer";var Mo=MP;var rHe="compositeLayer.renderLayers",xB=class extends Mo{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){let{object:r}=e;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(e.object=r.__source.object,e.index=r.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,r){return r&&r.length}getSubLayerClass(e,r){let{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||r}getSubLayerRow(e,r,i){return e.__source={parent:this,object:r,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){let r={index:-1,data:this.props.data,target:[]};return(i,n)=>i&&i.__source?(r.index=i.__source.index,e(i.__source.object,r)):e(i,n)}return e}getSubLayerProps(e={}){let{opacity:r,pickable:i,visible:n,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:u,highlightColor:p,coordinateSystem:m,coordinateOrigin:x,wrapLongitude:M,positionFormat:k,modelMatrix:F,extensions:j,fetch:H,operation:W,_subLayerProps:Z}=this.props,Y={id:"",updateTriggers:{},opacity:r,pickable:i,visible:n,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:u,highlightColor:p,coordinateSystem:m,coordinateOrigin:x,wrapLongitude:M,positionFormat:k,modelMatrix:F,extensions:j,fetch:H,operation:W},ee=Z&&e.id&&Z[e.id],ce=ee&&ee.updateTriggers,ge=e.id||"sublayer";if(ee){let Se=this.props[Od],ne=e.type?e.type._propTypes:{};for(let pe in ee){let ue=ne[pe]||Se[pe];ue&&ue.type==="accessor"&&(ee[pe]=this.getSubLayerAccessor(ee[pe]))}}Object.assign(Y,e,ee),Y.id=`${this.props.id}-${ge}`,Y.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...ce};for(let Se of j){let ne=Se.getSubLayerProps.call(this,Se);ne&&Object.assign(Y,ne,{updateTriggers:Object.assign(Y.updateTriggers,ne.updateTriggers)})}return Y}_updateAutoHighlight(e){for(let r of this.getSubLayers())r.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,r){let i=this.internalState.subLayers,n=!i||this.needsUpdate();if(n){let o=this.renderLayers();i=Uc(o,Boolean),this.internalState.subLayers=i}ks(rHe,this,n,i);for(let o of i)o.parent=this}};xB.layerName="CompositeLayer";var ji=xB;var wB=Math.PI/180,Pbe=180/Math.PI,SB=6370972,Y3=256;function iHe(){let t=Y3/SB,e=Math.PI/180*Y3;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}var M0=class extends kd{constructor(e={}){let{longitude:r=0,zoom:i=0,nearZMultiplier:n=.5,farZMultiplier:o=1,resolution:s=10}=e,{latitude:a=0,height:u,altitude:p=1.5,fovy:m}=e;a=Math.max(Math.min(a,Cd),-Cd),u=u||1,m?p=wg(m):m=xg(p);let x=1/Math.PI/Math.cos(a*Math.PI/180),M=Math.pow(2,i)*x,k=e.nearZ??n,F=e.farZ??(p+Y3*2*M/u)*o,j=new mn().lookAt({eye:[0,-p,0],up:[0,0,1]});j.rotateX(a*wB),j.rotateZ(-r*wB),j.scale(M/u),super({...e,height:u,viewMatrix:j,longitude:r,latitude:a,zoom:i,distanceScales:iHe(),fovy:m,focalDistance:p,near:k,far:F}),this.scale=M,this.latitude=a,this.longitude=r,this.resolution=s}get projectionMode(){return Ga.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){let r={targetZ:e.z||0},i=this.unproject([0,this.height/2],r),n=this.unproject([this.width/2,0],r),o=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return o[0]<this.longitude&&(o[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],o[0],n[0],s[0]),Math.min(i[1],o[1],n[1],s[1]),Math.max(i[0],o[0],n[0],s[0]),Math.max(i[1],o[1],n[1],s[1])]}unproject(e,{topLeft:r=!0,targetZ:i}={}){let[n,o,s]=e,a=r?o:this.height-o,{pixelUnprojectionMatrix:u}=this,p;if(Number.isFinite(s))p=nQ(u,[n,a,s,1]);else{let k=nQ(u,[n,a,-1,1]),F=nQ(u,[n,a,1,1]),j=((i||0)/SB+1)*Y3,H=Ol.sqrLen(Ol.sub([],k,F)),W=Ol.sqrLen(k),Z=Ol.sqrLen(F),ee=4*((4*W*Z-(H-W-Z)**2)/16)/H,ce=Math.sqrt(W-ee),ge=Math.sqrt(Math.max(0,j*j-ee)),Se=(ce-ge)/Math.sqrt(H);p=Ol.lerp([],k,F,Se)}let[m,x,M]=this.unprojectPosition(p);return Number.isFinite(s)?[m,x,M]:Number.isFinite(i)?[m,x,i]:[m,x]}projectPosition(e){let[r,i,n=0]=e,o=r*wB,s=i*wB,a=Math.cos(s),u=(n/SB+1)*Y3;return[Math.sin(o)*a*u,-Math.cos(o)*a*u,Math.sin(s)*u]}unprojectPosition(e){let[r,i,n]=e,o=Ol.len(e),s=Math.asin(n/o),u=Math.atan2(r,-i)*Pbe,p=s*Pbe,m=(o/Y3-1)*SB;return[u,p,m]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,r){let i=this.unproject(r);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}};function nQ(t,e){let r=Mu.transformMat4([],e,t);return Mu.scale(r,r,1/r[3]),r}var oQ=Math.PI/180;function nHe({height:t,focalDistance:e,orbitAxis:r,rotationX:i,rotationOrbit:n,zoom:o}){let s=r==="Z"?[0,0,1]:[0,1,0],a=r==="Z"?[0,-e,0]:[0,0,e],u=new mn().lookAt({eye:a,up:s});u.rotateX(i*oQ),r==="Z"?u.rotateZ(n*oQ):u.rotateY(n*oQ);let p=Math.pow(2,o)/t;return u.scale(p),u}var EP=class extends kd{constructor(e){let{height:r,projectionMatrix:i,fovy:n=50,orbitAxis:o="Z",target:s=[0,0,0],rotationX:a=0,rotationOrbit:u=0,zoom:p=0}=e,m=i?i[5]/2:wg(n);super({...e,longitude:void 0,viewMatrix:nHe({height:r||1,focalDistance:m,orbitAxis:o,rotationX:a,rotationOrbit:u,zoom:p}),fovy:n,focalDistance:m,position:s,zoom:p}),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:r=!0}={}){let[i,n,o=this.projectedCenter[2]]=e,s=r?n:this.height-n,[a,u,p]=Pd([i,s,o],this.pixelUnprojectionMatrix);return[a,u,p]}panByPosition(e,r){let i=this.project(e),n=[this.width/2+i[0]-r[0],this.height/2+i[1]-r[1],this.projectedCenter[2]];return{target:this.unproject(n)}}};var oHe=new mn().lookAt({eye:[0,0,1]});function sHe({width:t,height:e,near:r,far:i,padding:n}){let o=-t/2,s=t/2,a=-e/2,u=e/2;if(n){let{left:p=0,right:m=0,top:x=0,bottom:M=0}=n,k=Rn((p+t-m)/2,0,t)-t/2,F=Rn((x+e-M)/2,0,e)-e/2;o-=k,s-=k,a+=F,u+=F}return new mn().ortho({left:o,right:s,bottom:a,top:u,near:r,far:i})}var CP=class extends kd{constructor(e){let{width:r,height:i,near:n=.1,far:o=1e3,zoom:s=0,target:a=[0,0,0],padding:u=null,flipY:p=!0}=e,m=Array.isArray(s)?s[0]:s,x=Array.isArray(s)?s[1]:s,M=Math.min(m,x),k=Math.pow(2,M),F;if(m!==x){let j=Math.pow(2,m),H=Math.pow(2,x);F={unitsPerMeter:[j/k,H/k,1],metersPerUnit:[k/j,k/H,1]}}super({...e,longitude:void 0,position:a,viewMatrix:oHe.clone().scale([k,k*(p?-1:1),k]),projectionMatrix:sHe({width:r||1,height:i||1,padding:u,near:n,far:o}),zoom:M,distanceScales:F})}projectFlat([e,r]){let{unitsPerMeter:i}=this.distanceScales;return[e*i[0],r*i[1]]}unprojectFlat([e,r]){let{metersPerUnit:i}=this.distanceScales;return[e*i[0],r*i[1]]}panByPosition(e,r){let i=Pd(r,this.pixelUnprojectionMatrix),n=this.projectFlat(e),o=Wa.add([],n,Wa.negate([],i)),s=Wa.add([],this.center,o);return{target:this.unprojectFlat(s)}}};var PP=class extends kd{constructor(e){let{longitude:r,latitude:i,modelMatrix:n,bearing:o=0,pitch:s=0,up:a=[0,0,1]}=e,p=new yg({bearing:o,pitch:s===-90?1e-4:90+s}).toVector3().normalize(),m=n?new mn(n).transformAsVector(p):p,x=Number.isFinite(i)?z5({latitude:i}):0,M=Math.pow(2,x),k=new mn().lookAt({eye:[0,0,0],center:m,up:a}).scale(M);super({...e,zoom:x,viewMatrix:k}),this.latitude=i,this.longitude=r}};var Ab=20,Ibe=500,sQ=class t extends Cg{constructor(e){let{width:r,height:i,position:n=[0,0,0],bearing:o=0,pitch:s=0,longitude:a=null,latitude:u=null,maxPitch:p=90,minPitch:m=-90,startRotatePos:x,startBearing:M,startPitch:k,startZoomPosition:F,startPanPos:j,startPanPosition:H}=e;super({width:r,height:i,position:n,bearing:o,pitch:s,longitude:a,latitude:u,maxPitch:p,minPitch:m},{startRotatePos:x,startBearing:M,startPitch:k,startZoomPosition:F,startPanPos:j,startPanPosition:H}),this.makeViewport=e.makeViewport}panStart({pos:e}){let{position:r}=this.getViewportProps();return this._getUpdatedState({startPanPos:e,startPanPosition:r})}pan({pos:e}){if(!e)return this;let{startPanPos:r=[0,0],startPanPosition:i=[0,0]}=this.getState(),{width:n,height:o,bearing:s,pitch:a}=this.getViewportProps(),u=Ibe*(e[0]-r[0])/n,p=Ibe*(e[1]-r[1])/o,m=new yg({bearing:s,pitch:a}),x=new yg({bearing:s,pitch:-90}),M=m.toVector3().normalize(),k=x.toVector3().cross(M).normalize();return this._getUpdatedState({position:new lr(i).add(k.scale(u)).add(M.scale(p))})}panEnd(){return this._getUpdatedState({startPanPos:null,startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:i=0}){let{startRotatePos:n,startBearing:o,startPitch:s}=this.getState(),{width:a,height:u}=this.getViewportProps();if(!n||o===void 0||s===void 0)return this;let p;if(e){let m=(e[0]-n[0])/a,x=(e[1]-n[1])/u;p={bearing:o-m*180,pitch:s-x*90}}else p={bearing:o-r,pitch:s-i};return this._getUpdatedState(p)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({pos:e,scale:r}){let i=this.getViewportProps(),n=this.getState().startZoomPosition||i.position,o=this.makeViewport(i),{projectionMatrix:s,width:a}=o,p=2*Math.atan(1/s[0])*(e[0]/a-.5),m=this.getDirection(!0);return this._move(m.rotateZ({radians:-p}),Math.log2(r)*Ab,n)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(e=Ab){let r=this.getDirection(!0);return this._move(r.rotateZ({radians:Math.PI/2}),e)}moveRight(e=Ab){let r=this.getDirection(!0);return this._move(r.rotateZ({radians:-Math.PI/2}),e)}moveUp(e=Ab){let r=this.getDirection(!0);return this._move(r,e)}moveDown(e=Ab){let r=this.getDirection(!0);return this._move(r.negate(),e)}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}zoomIn(e=Ab){return this._move(new lr(0,0,1),e)}zoomOut(e=Ab){return this._move(new lr(0,0,-1),e)}shortestPathFrom(e){let r=e.getViewportProps(),i={...this.getViewportProps()},{bearing:n,longitude:o}=i;return Math.abs(n-r.bearing)>180&&(i.bearing=n<0?n+360:n-360),o!==null&&r.longitude!==null&&Math.abs(o-r.longitude)>180&&(i.longitude=o<0?o+360:o-360),i}_move(e,r,i=this.getViewportProps().position){let n=e.scale(r);return this._getUpdatedState({position:new lr(i).add(n)})}getDirection(e=!1){return new yg({bearing:this.getViewportProps().bearing,pitch:e?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(e){return new t({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){let{pitch:r,maxPitch:i,minPitch:n,longitude:o,bearing:s}=e;return e.pitch=Rn(r,n,i),o!==null&&(o<-180||o>180)&&(e.longitude=ab(o+180,360)-180),(s<-180||s>180)&&(e.bearing=ab(s+180,360)-180),e}},IP=class extends Mh{constructor(){super(...arguments),this.ControllerState=sQ,this.transition={transitionDuration:300,transitionInterpolator:new dl(["position","pitch","bearing"])}}};var TB=class extends na{constructor(e={}){super(e)}getViewportType(){return PP}get ControllerType(){return IP}};TB.displayName="FirstPersonView";var aQ=TB;var kP=class extends Cg{constructor(e){let{width:r,height:i,rotationX:n=0,rotationOrbit:o=0,target:s=[0,0,0],zoom:a=0,minRotationX:u=-90,maxRotationX:p=90,minZoom:m=-1/0,maxZoom:x=1/0,startPanPosition:M,startRotatePos:k,startRotationX:F,startRotationOrbit:j,startZoomPosition:H,startZoom:W}=e;super({width:r,height:i,rotationX:n,rotationOrbit:o,target:s,zoom:a,minRotationX:u,maxRotationX:p,minZoom:m,maxZoom:x},{startPanPosition:M,startRotatePos:k,startRotationX:F,startRotationOrbit:j,startZoomPosition:H,startZoom:W}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:r}){let i=this.getState().startPanPosition||r;if(!i)return this;let o=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:i=0}){let{startRotatePos:n,startRotationX:o,startRotationOrbit:s}=this.getState(),{width:a,height:u}=this.getViewportProps();if(!n||o===void 0||s===void 0)return this;let p;if(e){let m=(e[0]-n[0])/a,x=(e[1]-n[1])/u;(o<-90||o>90)&&(m*=-1),p={rotationX:o+x*180,rotationOrbit:s+m*180}}else p={rotationX:o+i,rotationOrbit:s+r};return this._getUpdatedState(p)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){let r=e.getViewportProps(),i={...this.getViewportProps()},{rotationOrbit:n}=i;return Math.abs(n-r.rotationOrbit)>180&&(i.rotationOrbit=n<0?n+360:n-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:i}){let{startZoom:n,startZoomPosition:o}=this.getState();if(o||(n=this.getViewportProps().zoom,o=this._unproject(r)||this._unproject(e)),!o)return this;let s=this._calculateNewZoom({scale:i,startZoom:n}),a=this.makeViewport({...this.getViewportProps(),zoom:s});return this._getUpdatedState({zoom:s,...a.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){let r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_calculateNewZoom({scale:e,startZoom:r}){let{maxZoom:i,minZoom:n}=this.getViewportProps();r===void 0&&(r=this.getViewportProps().zoom);let o=r+Math.log2(e);return Rn(o,n,i)}_panFromCenter(e){let{width:r,height:i,target:n}=this.getViewportProps();return this.pan({startPosition:n,pos:[r/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){let{maxZoom:r,minZoom:i,zoom:n,maxRotationX:o,minRotationX:s,rotationOrbit:a}=e;return e.zoom=Array.isArray(n)?[Rn(n[0],i,r),Rn(n[1],i,r)]:Rn(n,i,r),e.rotationX=Rn(e.rotationX,s,o),(a<-180||a>180)&&(e.rotationOrbit=ab(a+180,360)-180),e}},RP=class extends Mh{constructor(){super(...arguments),this.ControllerState=kP,this.transition={transitionDuration:300,transitionInterpolator:new dl({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})}}};var MB=class extends na{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}getViewportType(){return EP}get ControllerType(){return RP}};MB.displayName="OrbitView";var lQ=MB;var cQ=class extends kP{constructor(e){super(e),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:r}){let{maxZoom:i,minZoom:n}=this.getViewportProps();r===void 0&&(r=this.getViewportProps().zoom);let o=Math.log2(e);if(Array.isArray(r)){let[s,a]=r;switch(this.zoomAxis){case"X":s=Rn(s+o,n,i);break;case"Y":a=Rn(a+o,n,i);break;default:let u=Math.min(s+o,a+o);u<n&&(o+=n-u),u=Math.max(s+o,a+o),u>i&&(o+=i-u),s+=o,a+=o}return[s,a]}return Rn(r+o,n,i)}},OP=class extends Mh{constructor(){super(...arguments),this.ControllerState=cQ,this.transition={transitionDuration:300,transitionInterpolator:new dl(["target","zoom"])},this.dragMode="pan"}_onPanRotate(){return!1}};var EB=class extends na{constructor(e={}){super(e)}getViewportType(){return CP}get ControllerType(){return OP}};EB.displayName="OrthographicView";var uQ=EB;var hQ=class extends K5{applyConstraints(e){let{maxZoom:r,minZoom:i,zoom:n}=e;e.zoom=Rn(n,i,r);let{longitude:o,latitude:s}=e;return(o<-180||o>180)&&(e.longitude=ab(o+180,360)-180),e.latitude=Rn(s,-Cd,Cd),e}},DP=class extends Mh{constructor(){super(...arguments),this.ControllerState=hQ,this.transition={transitionDuration:300,transitionInterpolator:new dl(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}};var CB=class extends na{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?Th:M0}get ControllerType(){return DP}};CB.displayName="GlobeView";var yb=CB;var LP=class{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&vo(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){let{defaultProps:r}=e.constructor,i={updateTriggers:{}};for(let n in r)if(n in this.props){let o=r[n],s=this.props[n];i[n]=s,o&&o.type==="accessor"&&(i.updateTriggers[n]=this.props.updateTriggers[n],typeof s=="function"&&(i[n]=this.getSubLayerAccessor(s)))}return i}initializeState(e,r){}updateState(e,r){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,r){}finalizeState(e,r){}};LP.defaultProps={};LP.extensionName="LayerExtension";var Pg=LP;var dQ={bearing:0,pitch:0,position:[0,0,0]},aHe={speed:1.2,curve:1.414},E0=class extends hb{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),this.opts={...aHe,...e}}interpolateProps(e,r,i){let n=mK(e,r,i,this.opts);for(let o in dQ)n[o]=sc(e[o]||dQ[o],r[o]||dQ[o],i);return n}getDuration(e,r){let{transitionDuration:i}=r;return i==="auto"&&(i=gK(e,r,this.opts)),i}};Vi();var y_=class{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;let{attributes:r={}}=e;this.typedArrayManager=$f,this.attributes={},this._attributeDefs=r,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);let{data:r,buffers:i={},getGeometry:n,geometryBuffer:o,positionFormat:s,dataChanged:a,normalize:u=!0}=this.opts;if(this.data=r,this.getGeometry=n,this.positionSize=o&&o.size||(s==="XY"?2:3),this.buffers=i,this.normalize=u,o&&(Pr(r.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),u||(i.vertexPositions=o)),this.geometryBuffer=i.vertexPositions,Array.isArray(a))for(let p of a)this._rebuildGeometry(p);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:r}){this._rebuildGeometry({startRow:e,endRow:r})}getGeometryFromBuffer(e){let r=e.value||e;return ArrayBuffer.isView(r)?fB(r,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,r){let{attributes:i,buffers:n,_attributeDefs:o,typedArrayManager:s}=this;for(let a in o)if(a in n)s.release(i[a]),i[a]=null;else{let u=o[a];u.copy=r,i[a]=s.allocate(i[a],e,u)}}_forEachGeometry(e,r,i){let{data:n,getGeometry:o}=this,{iterable:s,objectInfo:a}=Vc(n,r,i);for(let u of s){a.index++;let p=o?o(u,a):null;e(p,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:r,vertexStarts:i,instanceCount:n}=this,{data:o,geometryBuffer:s}=this,{startRow:a=0,endRow:u=1/0}=e||{},p={};if(e||(r=[0],i=[0]),this.normalize||!s)this._forEachGeometry((x,M)=>{let k=x&&this.normalizeGeometry(x);p[M]=k,i[M+1]=i[M]+(k?this.getGeometrySize(k):0)},a,u),n=i[i.length-1];else if(i=o.startIndices,n=i[o.length]||0,ArrayBuffer.isView(s))n=n||s.length/this.positionSize;else if(s instanceof vn){let x=this.positionSize*4;n=n||s.byteLength/x}else if(s.buffer){let x=s.stride||this.positionSize*4;n=n||s.buffer.byteLength/x}else if(s.value){let x=s.value,M=s.stride/x.BYTES_PER_ELEMENT||this.positionSize;n=n||x.length/M}this._allocate(n,!!e),this.indexStarts=r,this.vertexStarts=i,this.instanceCount=n;let m={};this._forEachGeometry((x,M)=>{let k=p[M]||x;m.vertexStart=i[M],m.indexStart=r[M];let F=M<i.length-1?i[M+1]:n;m.geometrySize=F-i[M],m.geometryIndex=M,this.updateGeometryAttributes(k,m)},a,u),this.vertexCount=r[r.length-1]}};function Ze(t){return t!=null}function PB(t){return(Array.isArray(t)?t[0]:t)instanceof yb}function kbe(t,e){return{longitude:Number.isFinite(e.longitude)?e.longitude:0,latitude:Number.isFinite(e.latitude)?e.latitude:0,zoom:Number.isFinite(e.zoom)?e.zoom:0,...Number.isFinite(e.minZoom)?{minZoom:e.minZoom}:0,...Number.isFinite(e.maxZoom)?{maxZoom:e.maxZoom}:0}}function Rbe(t,e){let{longitude:r,latitude:i,zoom:n,pitch:o,bearing:s,transitionDuration:a,curve:u,speed:p,screenSpeed:m}=t,x=new E0({...Ze(u)&&{curve:u},...Ze(p)&&{speed:p},...Ze(m)&&{screenSpeed:m}});e({longitude:r,latitude:i,zoom:n,pitch:o,bearing:s,transitionDuration:a,transitionInterpolator:x})}var NF=Tt($t(),1);var Kwe=Tt($t(),1);var yQ={};nl(yQ,{compareArrayLike:()=>AQ,joinUint8Arrays:()=>Ih,memcpy:()=>NP,rebaseValueOffsets:()=>FB,toArrayBufferView:()=>Zi,toArrayBufferViewAsyncIterator:()=>Kf,toArrayBufferViewIterator:()=>P0,toBigInt64Array:()=>BB,toBigUint64Array:()=>mHe,toFloat32Array:()=>gHe,toFloat32ArrayAsyncIterator:()=>RHe,toFloat32ArrayIterator:()=>SHe,toFloat64Array:()=>AHe,toFloat64ArrayAsyncIterator:()=>OHe,toFloat64ArrayIterator:()=>THe,toInt16Array:()=>dHe,toInt16ArrayAsyncIterator:()=>CHe,toInt16ArrayIterator:()=>vHe,toInt32Array:()=>_b,toInt32ArrayAsyncIterator:()=>PHe,toInt32ArrayIterator:()=>bHe,toInt8Array:()=>hHe,toInt8ArrayAsyncIterator:()=>EHe,toInt8ArrayIterator:()=>_He,toUint16Array:()=>fHe,toUint16ArrayAsyncIterator:()=>IHe,toUint16ArrayIterator:()=>xHe,toUint32Array:()=>pHe,toUint32ArrayAsyncIterator:()=>kHe,toUint32ArrayIterator:()=>wHe,toUint8Array:()=>ii,toUint8ArrayAsyncIterator:()=>gQ,toUint8ArrayIterator:()=>mQ,toUint8ClampedArray:()=>yHe,toUint8ClampedArrayAsyncIterator:()=>DHe,toUint8ClampedArrayIterator:()=>MHe});var Obe=new TextDecoder("utf-8"),BP=Obe.decode.bind(Obe),lHe=new TextEncoder,C0=t=>lHe.encode(t);var cHe=t=>typeof t=="number",Dbe=t=>typeof t=="boolean",Ya=t=>typeof t=="function",jc=t=>t!=null&&Object(t)===t,Ph=t=>jc(t)&&Ya(t.then);var Zf=t=>jc(t)&&Ya(t[Symbol.iterator]),Dd=t=>jc(t)&&Ya(t[Symbol.asyncIterator]),IB=t=>jc(t)&&jc(t.schema);var kB=t=>jc(t)&&"done"in t&&"value"in t;var RB=t=>jc(t)&&Ya(t.stat)&&cHe(t.fd);var OB=t=>jc(t)&&FP(t.body),DB=t=>"_getDOMStream"in t&&"_getNodeStream"in t,Lbe=t=>jc(t)&&Ya(t.abort)&&Ya(t.getWriter)&&!DB(t),FP=t=>jc(t)&&Ya(t.cancel)&&Ya(t.getReader)&&!DB(t),Bbe=t=>jc(t)&&Ya(t.end)&&Ya(t.write)&&Dbe(t.writable)&&!DB(t),LB=t=>jc(t)&&Ya(t.read)&&Ya(t.pipe)&&Dbe(t.readable)&&!DB(t),Fbe=t=>jc(t)&&Ya(t.clear)&&Ya(t.bytes)&&Ya(t.position)&&Ya(t.setPosition)&&Ya(t.capacity)&&Ya(t.getBufferIdentifier)&&Ya(t.createLong);var pQ=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function uHe(t){let e=t[0]?[t[0]]:[],r,i,n,o;for(let s,a,u=0,p=0,m=t.length;++u<m;){if(s=e[p],a=t[u],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset){a&&(e[++p]=a);continue}if({byteOffset:r,byteLength:n}=s,{byteOffset:i,byteLength:o}=a,r+n<i||i+o<r){a&&(e[++p]=a);continue}e[p]=new Uint8Array(s.buffer,r,i-r+o)}return e}function NP(t,e,r=0,i=e.byteLength){let n=t.byteLength,o=new Uint8Array(t.buffer,t.byteOffset,n),s=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,n));return o.set(s,r),t}function Ih(t,e){let r=uHe(t),i=r.reduce((m,x)=>m+x.byteLength,0),n,o,s,a=0,u=-1,p=Math.min(e||Number.POSITIVE_INFINITY,i);for(let m=r.length;++u<m;){if(n=r[u],o=n.subarray(0,Math.min(n.length,p-a)),p<=a+o.length){o.length<n.length?r[u]=n.subarray(o.length):o.length===n.length&&u++,s?NP(s,o,a):s=o;break}NP(s||(s=new Uint8Array(p)),o,a),a+=o.length}return[s||new Uint8Array(0),r.slice(u),i-(s?s.byteLength:0)]}function Zi(t,e){let r=kB(e)?e.value:e;return r instanceof t?t===Uint8Array?new t(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=C0(r)),r instanceof ArrayBuffer?new t(r):r instanceof pQ?new t(r):Fbe(r)?Zi(t,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new t(0):new t(r.buffer,r.byteOffset,r.byteLength/t.BYTES_PER_ELEMENT):t.from(r)):new t(0)}var hHe=t=>Zi(Int8Array,t),dHe=t=>Zi(Int16Array,t),_b=t=>Zi(Int32Array,t),BB=t=>Zi(BigInt64Array,t),ii=t=>Zi(Uint8Array,t),fHe=t=>Zi(Uint16Array,t),pHe=t=>Zi(Uint32Array,t),mHe=t=>Zi(BigUint64Array,t),gHe=t=>Zi(Float32Array,t),AHe=t=>Zi(Float64Array,t),yHe=t=>Zi(Uint8ClampedArray,t),fQ=t=>(t.next(),t);function*P0(t,e){let r=function*(n){yield n},i=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof pQ?r(e):Zf(e)?e:r(e);return yield*fQ((function*(n){let o=null;do o=n.next(yield Zi(t,o));while(!o.done)})(i[Symbol.iterator]())),new t}var _He=t=>P0(Int8Array,t),vHe=t=>P0(Int16Array,t),bHe=t=>P0(Int32Array,t),mQ=t=>P0(Uint8Array,t),xHe=t=>P0(Uint16Array,t),wHe=t=>P0(Uint32Array,t),SHe=t=>P0(Float32Array,t),THe=t=>P0(Float64Array,t),MHe=t=>P0(Uint8ClampedArray,t);function Kf(t,e){return Ah(this,arguments,function*(){if(Ph(e))return yield Bi(yield Bi(yield*p2(If(Kf(t,yield Bi(e))))));let i=function(s){return Ah(this,arguments,function*(){yield yield Bi(yield Bi(s))})},n=function(s){return Ah(this,arguments,function*(){yield Bi(yield*p2(If(fQ((function*(a){let u=null;do u=a.next(yield u?.value);while(!u.done)})(s[Symbol.iterator]())))))})},o=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof pQ?i(e):Zf(e)?n(e):Dd(e)?e:i(e);return yield Bi(yield*p2(If(fQ((function(s){return Ah(this,arguments,function*(){let a=null;do a=yield Bi(s.next(yield yield Bi(Zi(t,a))));while(!a.done)})})(o[Symbol.asyncIterator]()))))),yield Bi(new t)})}var EHe=t=>Kf(Int8Array,t),CHe=t=>Kf(Int16Array,t),PHe=t=>Kf(Int32Array,t),gQ=t=>Kf(Uint8Array,t),IHe=t=>Kf(Uint16Array,t),kHe=t=>Kf(Uint32Array,t),RHe=t=>Kf(Float32Array,t),OHe=t=>Kf(Float64Array,t),DHe=t=>Kf(Uint8ClampedArray,t);function FB(t,e,r){if(t!==0){r=r.slice(0,e);for(let i=-1,n=r.length;++i<n;)r[i]+=t}return r.subarray(0,e)}function AQ(t,e){let r=0,i=t.length;if(i!==e.length)return!1;if(i>0)do if(t[r]!==e[r])return!1;while(++r<i);return!0}var Dl={fromIterable(t){return NB(LHe(t))},fromAsyncIterable(t){return NB(BHe(t))},fromDOMStream(t){return NB(FHe(t))},fromNodeStream(t){return NB(NHe(t))},toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},NB=t=>(t.next(),t);function*LHe(t){let e,r=!1,i=[],n,o,s,a=0;function u(){return o==="peek"?Ih(i,s)[0]:([n,i,a]=Ih(i,s),n)}({cmd:o,size:s}=(yield null)||{cmd:"read",size:0});let p=mQ(t)[Symbol.iterator]();try{do if({done:e,value:n}=Number.isNaN(s-a)?p.next():p.next(s-a),!e&&n.byteLength>0&&(i.push(n),a+=n.byteLength),e||s<=a)do({cmd:o,size:s}=yield u());while(s<a);while(!e)}catch(m){r=!0,typeof p.throw=="function"&&p.throw(m)}finally{r===!1&&typeof p.return=="function"&&p.return(null)}return null}function BHe(t){return Ah(this,arguments,function*(){let r,i=!1,n=[],o,s,a,u=0;function p(){return s==="peek"?Ih(n,a)[0]:([o,n,u]=Ih(n,a),o)}({cmd:s,size:a}=(yield yield Bi(null))||{cmd:"read",size:0});let m=gQ(t)[Symbol.asyncIterator]();try{do if({done:r,value:o}=Number.isNaN(a-u)?yield Bi(m.next()):yield Bi(m.next(a-u)),!r&&o.byteLength>0&&(n.push(o),u+=o.byteLength),r||a<=u)do({cmd:s,size:a}=yield yield Bi(p()));while(a<u);while(!r)}catch(x){i=!0,typeof m.throw=="function"&&(yield Bi(m.throw(x)))}finally{i===!1&&typeof m.return=="function"&&(yield Bi(m.return(new Uint8Array(0))))}return yield Bi(null)})}function FHe(t){return Ah(this,arguments,function*(){let r=!1,i=!1,n=[],o,s,a,u=0;function p(){return s==="peek"?Ih(n,a)[0]:([o,n,u]=Ih(n,a),o)}({cmd:s,size:a}=(yield yield Bi(null))||{cmd:"read",size:0});let m=new vQ(t);try{do if({done:r,value:o}=Number.isNaN(a-u)?yield Bi(m.read()):yield Bi(m.read(a-u)),!r&&o.byteLength>0&&(n.push(ii(o)),u+=o.byteLength),r||a<=u)do({cmd:s,size:a}=yield yield Bi(p()));while(a<u);while(!r)}catch(x){i=!0,yield Bi(m.cancel(x))}finally{i===!1?yield Bi(m.cancel()):t.locked&&m.releaseLock()}return yield Bi(null)})}var vQ=class{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return Sr(this,void 0,void 0,function*(){let{reader:r,source:i}=this;r&&(yield r.cancel(e).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(e){return Sr(this,void 0,void 0,function*(){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=yield this.reader.read();return!r.done&&(r.value=ii(r)),r})}},_Q=(t,e)=>{let r=n=>i([e,n]),i;return[e,r,new Promise(n=>(i=n)&&t.once(e,r))]};function NHe(t){return Ah(this,arguments,function*(){let r=[],i="error",n=!1,o=null,s,a,u=0,p=[],m;function x(){return s==="peek"?Ih(p,a)[0]:([m,p,u]=Ih(p,a),m)}if({cmd:s,size:a}=(yield yield Bi(null))||{cmd:"read",size:0},t.isTTY)return yield yield Bi(new Uint8Array(0)),yield Bi(null);try{r[0]=_Q(t,"end"),r[1]=_Q(t,"error");do{if(r[2]=_Q(t,"readable"),[i,o]=yield Bi(Promise.race(r.map(k=>k[2]))),i==="error")break;if((n=i==="end")||(Number.isFinite(a-u)?(m=ii(t.read(a-u)),m.byteLength<a-u&&(m=ii(t.read()))):m=ii(t.read()),m.byteLength>0&&(p.push(m),u+=m.byteLength)),n||a<=u)do({cmd:s,size:a}=yield yield Bi(x()));while(a<u)}while(!n)}finally{yield Bi(M(r,i==="error"?o:null))}return yield Bi(null);function M(k,F){return m=p=null,new Promise((j,H)=>{for(let[W,Z]of k)t.off(W,Z);try{let W=t.destroy;W&&W.call(t,F),F=void 0}catch(W){F=W||F}finally{F!=null?H(F):j()}})}})}var Un;(function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"})(Un||(Un={}));var bo;(function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"})(bo||(bo={}));var Dn;(function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"})(Dn||(Dn={}));var Bs;(function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"})(Bs||(Bs={}));var Br;(function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"})(Br||(Br={}));var Eo;(function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Eo||(Eo={}));var I0=new Int32Array(2),zB=new Float32Array(I0.buffer),UB=new Float64Array(I0.buffer),X3=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var zP;(function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"})(zP||(zP={}));var Ll=class t{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(e){return new t(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return I0[0]=this.readInt32(e),zB[0]}readFloat64(e){return I0[X3?0:1]=this.readInt32(e),I0[X3?1:0]=this.readInt32(e+4),UB[0]}writeInt8(e,r){this.bytes_[e]=r}writeUint8(e,r){this.bytes_[e]=r}writeInt16(e,r){this.bytes_[e]=r,this.bytes_[e+1]=r>>8}writeUint16(e,r){this.bytes_[e]=r,this.bytes_[e+1]=r>>8}writeInt32(e,r){this.bytes_[e]=r,this.bytes_[e+1]=r>>8,this.bytes_[e+2]=r>>16,this.bytes_[e+3]=r>>24}writeUint32(e,r){this.bytes_[e]=r,this.bytes_[e+1]=r>>8,this.bytes_[e+2]=r>>16,this.bytes_[e+3]=r>>24}writeInt64(e,r){this.writeInt32(e,Number(BigInt.asIntN(32,r))),this.writeInt32(e+4,Number(BigInt.asIntN(32,r>>BigInt(32))))}writeUint64(e,r){this.writeUint32(e,Number(BigInt.asUintN(32,r))),this.writeUint32(e+4,Number(BigInt.asUintN(32,r>>BigInt(32))))}writeFloat32(e,r){zB[0]=r,this.writeInt32(e,I0[0])}writeFloat64(e,r){UB[0]=r,this.writeInt32(e,I0[X3?0:1]),this.writeInt32(e+4,I0[X3?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let r=0;r<4;r++)e+=String.fromCharCode(this.readInt8(this.position_+4+r));return e}__offset(e,r){let i=e-this.readInt32(e);return r<this.readInt16(i)?this.readInt16(i+r):0}__union(e,r){return e.bb_pos=r+this.readInt32(r),e.bb=this,e}__string(e,r){e+=this.readInt32(e);let i=this.readInt32(e);e+=4;let n=this.bytes_.subarray(e,e+i);return r===zP.UTF8_BYTES?n:this.text_decoder_.decode(n)}__union_with_string(e,r){return typeof e=="string"?this.__string(r):this.__union(e,r)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+4}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(e.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let r=0;r<4;r++)if(e.charCodeAt(r)!=this.readInt8(this.position()+4+r))return!1;return!0}createScalarList(e,r){let i=[];for(let n=0;n<r;++n){let o=e(n);o!==null&&i.push(o)}return i}createObjList(e,r){let i=[];for(let n=0;n<r;++n){let o=e(n);o!==null&&i.push(o.unpack())}return i}};var vb=class t{constructor(e){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let r;e?r=e:r=1024,this.bb=Ll.allocate(r),this.space=r}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,r){e>this.minalign&&(this.minalign=e);let i=~(this.bb.capacity()-this.space+r)+1&e-1;for(;this.space<i+e+r;){let n=this.bb.capacity();this.bb=t.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(i)}pad(e){for(let r=0;r<e;r++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,r,i){(this.force_defaults||r!=i)&&(this.addInt8(r),this.slot(e))}addFieldInt16(e,r,i){(this.force_defaults||r!=i)&&(this.addInt16(r),this.slot(e))}addFieldInt32(e,r,i){(this.force_defaults||r!=i)&&(this.addInt32(r),this.slot(e))}addFieldInt64(e,r,i){(this.force_defaults||r!==i)&&(this.addInt64(r),this.slot(e))}addFieldFloat32(e,r,i){(this.force_defaults||r!=i)&&(this.addFloat32(r),this.slot(e))}addFieldFloat64(e,r,i){(this.force_defaults||r!=i)&&(this.addFloat64(r),this.slot(e))}addFieldOffset(e,r,i){(this.force_defaults||r!=i)&&(this.addOffset(r),this.slot(e))}addFieldStruct(e,r,i){r!=i&&(this.nested(r),this.slot(e))}nested(e){if(e!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(e){this.vtable!==null&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){let r=e.capacity();if(r&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let i=r<<1,n=Ll.allocate(i);return n.setPosition(i-r),n.bytes().set(e.bytes(),i-r),n}addOffset(e){this.prep(4,0),this.writeInt32(this.offset()-e+4)}startObject(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(let r=0;r<e;r++)this.vtable[r]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let e=this.offset(),r=this.vtable_in_use-1;for(;r>=0&&this.vtable[r]==0;r--);let i=r+1;for(;r>=0;r--)this.addInt16(this.vtable[r]!=0?e-this.vtable[r]:0);let n=2;this.addInt16(e-this.object_start);let o=(i+n)*2;this.addInt16(o);let s=0,a=this.space;e:for(r=0;r<this.vtables.length;r++){let u=this.bb.capacity()-this.vtables[r];if(o==this.bb.readInt16(u)){for(let p=2;p<o;p+=2)if(this.bb.readInt16(a+p)!=this.bb.readInt16(u+p))continue e;s=this.vtables[r];break}}return s?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,s-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,r,i){let n=i?4:0;if(r){let o=r;if(this.prep(this.minalign,8+n),o.length!=4)throw new TypeError("FlatBuffers: file identifier must be length "+4);for(let s=3;s>=0;s--)this.writeInt8(o.charCodeAt(s))}this.prep(this.minalign,4+n),this.addOffset(e),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,r){this.finish(e,r,!0)}requiredField(e,r){let i=this.bb.capacity()-e,n=i-this.bb.readInt32(i);if(!(r<this.bb.readInt16(n)&&this.bb.readInt16(n+r)!=0))throw new TypeError("FlatBuffers: field "+r+" must be set")}startVector(e,r,i){this.notNested(),this.vector_num_elems=r,this.prep(4,e*r),this.prep(i,e*r)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);let r=this.createString(e);return this.string_maps.set(e,r),r}createString(e){if(e==null)return 0;let r;return e instanceof Uint8Array?r=e:r=this.text_encoder.encode(e),this.addInt8(0),this.startVector(1,r.length,1),this.bb.setPosition(this.space-=r.length),this.bb.bytes().set(r,this.space),this.endVector()}createByteVector(e){return e==null?0:(this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector())}createObjectOffset(e){return e===null?0:typeof e=="string"?this.createString(e):e.pack(this)}createObjectOffsetList(e){let r=[];for(let i=0;i<e.length;++i){let n=e[i];if(n!==null)r.push(this.createObjectOffset(n));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return r}createStructOffsetList(e,r){return r(this,e.length),this.createObjectOffsetList(e.slice().reverse()),this.endVector()}};var bb;(function(t){t[t.BUFFER=0]="BUFFER"})(bb||(bb={}));var $c;(function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"})($c||($c={}));var Ig=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsBodyCompression(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}codec(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):$c.LZ4_FRAME}method(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):bb.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,r){e.addFieldInt8(0,r,$c.LZ4_FRAME)}static addMethod(e,r){e.addFieldInt8(1,r,bb.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,r,i){return t.startBodyCompression(e),t.addCodec(e,r),t.addMethod(e,i),t.endBodyCompression(e)}};var Z3=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,r,i){return e.prep(8,16),e.writeInt64(BigInt(i??0)),e.writeInt64(BigInt(r??0)),e.offset()}};var K3=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,r,i){return e.prep(8,16),e.writeInt64(BigInt(i??0)),e.writeInt64(BigInt(r??0)),e.offset()}};var Cu=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsRecordBatch(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}length(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}nodes(e,r){let i=this.bb.__offset(this.bb_pos,6);return i?(r||new K3).__init(this.bb.__vector(this.bb_pos+i)+e*16,this.bb):null}nodesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new Z3).__init(this.bb.__vector(this.bb_pos+i)+e*16,this.bb):null}buffersLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){let r=this.bb.__offset(this.bb_pos,10);return r?(e||new Ig).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,r){e.addFieldInt64(0,r,BigInt("0"))}static addNodes(e,r){e.addFieldOffset(1,r,0)}static startNodesVector(e,r){e.startVector(16,r,8)}static addBuffers(e,r){e.addFieldOffset(2,r,0)}static startBuffersVector(e,r){e.startVector(16,r,8)}static addCompression(e,r){e.addFieldOffset(3,r,0)}static endRecordBatch(e){return e.endObject()}};var kg=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsDictionaryBatch(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}id(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}data(e){let r=this.bb.__offset(this.bb_pos,6);return r?(e||new Cu).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isDelta(){let e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startDictionaryBatch(e){e.startObject(3)}static addId(e,r){e.addFieldInt64(0,r,BigInt("0"))}static addData(e,r){e.addFieldOffset(1,r,0)}static addIsDelta(e,r){e.addFieldInt8(2,+r,0)}static endDictionaryBatch(e){return e.endObject()}};var __;(function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"})(__||(__={}));var UP;(function(t){t[t.DenseArray=0]="DenseArray"})(UP||(UP={}));var Jf=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsInt(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){let e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startInt(e){e.startObject(2)}static addBitWidth(e,r){e.addFieldInt32(0,r,0)}static addIsSigned(e,r){e.addFieldInt8(1,+r,0)}static endInt(e){return e.endObject()}static createInt(e,r,i){return t.startInt(e),t.addBitWidth(e,r),t.addIsSigned(e,i),t.endInt(e)}};var k0=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsDictionaryEncoding(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}id(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}indexType(e){let r=this.bb.__offset(this.bb_pos,6);return r?(e||new Jf).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isOrdered(){let e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}dictionaryKind(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):UP.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,r){e.addFieldInt64(0,r,BigInt("0"))}static addIndexType(e,r){e.addFieldOffset(1,r,0)}static addIsOrdered(e,r){e.addFieldInt8(2,+r,0)}static addDictionaryKind(e,r){e.addFieldInt16(3,r,UP.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}};var Xa=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsKeyValue(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}key(e){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,e):null}value(e){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,r){e.addFieldOffset(0,r,0)}static addValue(e,r){e.addFieldOffset(1,r,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,r,i){return t.startKeyValue(e),t.addKey(e,r),t.addValue(e,i),t.endKeyValue(e)}};var VP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsBinary(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBinary(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return t.startBinary(e),t.endBinary(e)}};var jP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsBool(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBool(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return t.startBool(e),t.endBool(e)}};var v_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsDate(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}unit(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Bs.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,r){e.addFieldInt16(0,r,Bs.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,r){return t.startDate(e),t.addUnit(e,r),t.endDate(e)}};var R0=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsDecimal(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDecimal(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}precision(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,r){e.addFieldInt32(0,r,0)}static addScale(e,r){e.addFieldInt32(1,r,0)}static addBitWidth(e,r){e.addFieldInt32(2,r,128)}static endDecimal(e){return e.endObject()}static createDecimal(e,r,i,n){return t.startDecimal(e),t.addPrecision(e,r),t.addScale(e,i),t.addBitWidth(e,n),t.endDecimal(e)}};var b_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsDuration(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDuration(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}unit(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Br.MILLISECOND}static startDuration(e){e.startObject(1)}static addUnit(e,r){e.addFieldInt16(0,r,Br.MILLISECOND)}static endDuration(e){return e.endObject()}static createDuration(e,r){return t.startDuration(e),t.addUnit(e,r),t.endDuration(e)}};var x_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsFixedSizeBinary(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeBinary(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,r){e.addFieldInt32(0,r,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,r){return t.startFixedSizeBinary(e),t.addByteWidth(e,r),t.endFixedSizeBinary(e)}};var w_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsFixedSizeList(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeList(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}listSize(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,r){e.addFieldInt32(0,r,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,r){return t.startFixedSizeList(e),t.addListSize(e,r),t.endFixedSizeList(e)}};var S_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsFloatingPoint(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}precision(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Dn.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,r){e.addFieldInt16(0,r,Dn.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,r){return t.startFloatingPoint(e),t.addPrecision(e,r),t.endFloatingPoint(e)}};var T_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsInterval(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}unit(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Eo.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,r){e.addFieldInt16(0,r,Eo.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,r){return t.startInterval(e),t.addUnit(e,r),t.endInterval(e)}};var $P=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsLargeBinary(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsLargeBinary(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startLargeBinary(e){e.startObject(0)}static endLargeBinary(e){return e.endObject()}static createLargeBinary(e){return t.startLargeBinary(e),t.endLargeBinary(e)}};var WP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsLargeUtf8(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsLargeUtf8(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startLargeUtf8(e){e.startObject(0)}static endLargeUtf8(e){return e.endObject()}static createLargeUtf8(e){return t.startLargeUtf8(e),t.endLargeUtf8(e)}};var GP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsList(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsList(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return t.startList(e),t.endList(e)}};var M_=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsMap(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){let e=this.bb.__offset(this.bb_pos,4);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startMap(e){e.startObject(1)}static addKeysSorted(e,r){e.addFieldInt8(0,+r,0)}static endMap(e){return e.endObject()}static createMap(e,r){return t.startMap(e),t.addKeysSorted(e,r),t.endMap(e)}};var HP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsNull(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNull(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return t.startNull(e),t.endNull(e)}};var qP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsStruct_(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return t.startStruct_(e),t.endStruct_(e)}};var Rg=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsTime(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}unit(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Br.MILLISECOND}bitWidth(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,r){e.addFieldInt16(0,r,Br.MILLISECOND)}static addBitWidth(e,r){e.addFieldInt32(1,r,32)}static endTime(e){return e.endObject()}static createTime(e,r,i){return t.startTime(e),t.addUnit(e,r),t.addBitWidth(e,i),t.endTime(e)}};var Og=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsTimestamp(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}unit(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Br.SECOND}timezone(e){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,r){e.addFieldInt16(0,r,Br.SECOND)}static addTimezone(e,r){e.addFieldOffset(1,r,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,r,i){return t.startTimestamp(e),t.addUnit(e,r),t.addTimezone(e,i),t.endTimestamp(e)}};var ep=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsUnion(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}mode(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):bo.Sparse}typeIds(e){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.readInt32(this.bb.__vector(this.bb_pos+r)+e*4):0}typeIdsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){let e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,r){e.addFieldInt16(0,r,bo.Sparse)}static addTypeIds(e,r){e.addFieldOffset(1,r,0)}static createTypeIdsVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addInt32(r[i]);return e.endVector()}static startTypeIdsVector(e,r){e.startVector(4,r,4)}static endUnion(e){return e.endObject()}static createUnion(e,r,i){return t.startUnion(e),t.addMode(e,r),t.addTypeIds(e,i),t.endUnion(e)}};var YP=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsUtf8(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUtf8(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return t.startUtf8(e),t.endUtf8(e)}};var xo;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList",t[t.RunEndEncoded=22]="RunEndEncoded"})(xo||(xo={}));var ac=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsField(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}name(e){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,e):null}nullable(){let e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}typeType(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):xo.NONE}type(e){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.__union(e,this.bb_pos+r):null}dictionary(e){let r=this.bb.__offset(this.bb_pos,12);return r?(e||new k0).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}children(e,r){let i=this.bb.__offset(this.bb_pos,14);return i?(r||new t).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}childrenLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,r){let i=this.bb.__offset(this.bb_pos,16);return i?(r||new Xa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,r){e.addFieldOffset(0,r,0)}static addNullable(e,r){e.addFieldInt8(1,+r,0)}static addTypeType(e,r){e.addFieldInt8(2,r,xo.NONE)}static addType(e,r){e.addFieldOffset(3,r,0)}static addDictionary(e,r){e.addFieldOffset(4,r,0)}static addChildren(e,r){e.addFieldOffset(5,r,0)}static createChildrenVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addOffset(r[i]);return e.endVector()}static startChildrenVector(e,r){e.startVector(4,r,4)}static addCustomMetadata(e,r){e.addFieldOffset(6,r,0)}static createCustomMetadataVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addOffset(r[i]);return e.endVector()}static startCustomMetadataVector(e,r){e.startVector(4,r,4)}static endField(e){return e.endObject()}};var Pu=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsSchema(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}endianness(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):__.Little}fields(e,r){let i=this.bb.__offset(this.bb_pos,6);return i?(r||new ac).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}fieldsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new Xa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.readInt64(this.bb.__vector(this.bb_pos+r)+e*8):BigInt(0)}featuresLength(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,r){e.addFieldInt16(0,r,__.Little)}static addFields(e,r){e.addFieldOffset(1,r,0)}static createFieldsVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addOffset(r[i]);return e.endVector()}static startFieldsVector(e,r){e.startVector(4,r,4)}static addCustomMetadata(e,r){e.addFieldOffset(2,r,0)}static createCustomMetadataVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addOffset(r[i]);return e.endVector()}static startCustomMetadataVector(e,r){e.startVector(4,r,4)}static addFeatures(e,r){e.addFieldOffset(3,r,0)}static createFeaturesVector(e,r){e.startVector(8,r.length,8);for(let i=r.length-1;i>=0;i--)e.addInt64(r[i]);return e.endVector()}static startFeaturesVector(e,r){e.startVector(8,r,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,r){e.finish(r)}static finishSizePrefixedSchemaBuffer(e,r){e.finish(r,void 0,!0)}static createSchema(e,r,i,n,o){return t.startSchema(e),t.addEndianness(e,r),t.addFields(e,i),t.addCustomMetadata(e,n),t.addFeatures(e,o),t.endSchema(e)}};var tn;(function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"})(tn||(tn={}));var Qe;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t[t.DurationSecond=-27]="DurationSecond",t[t.DurationMillisecond=-28]="DurationMillisecond",t[t.DurationMicrosecond=-29]="DurationMicrosecond",t[t.DurationNanosecond=-30]="DurationNanosecond",t[t.IntervalMonthDayNano=-31]="IntervalMonthDayNano"})(Qe||(Qe={}));var un;(function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"})(un||(un={}));var UQ={};nl(UQ,{clampRange:()=>a6,createElementComparator:()=>I_,wrapIndex:()=>wb});var bQ={};nl(bQ,{valueToString:()=>tp});function tp(t){if(t===null)return"null";if(t===void 0)return"undefined";switch(typeof t){case"number":return`${t}`;case"bigint":return`${t}`;case"string":return`"${t}"`}return typeof t[Symbol.toPrimitive]=="function"?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map(e=>tp(e))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,(e,r)=>typeof r=="bigint"?`${r}`:r)}var TQ={};nl(TQ,{BN:()=>ZP,bigNumToBigInt:()=>zbe,bigNumToNumber:()=>SQ,bigNumToString:()=>eS,isArrowBigNumSymbol:()=>Nbe});function Tn(t){if(typeof t=="bigint"&&(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER))throw new TypeError(`${t} is not safe to convert to a number.`);return Number(t)}function xQ(t,e){return Tn(t/e)+Tn(t%e)/Tn(e)}var Nbe=Symbol.for("isArrowBigNum");function rp(t,...e){return e.length===0?Object.setPrototypeOf(Zi(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}rp.prototype[Nbe]=!0;rp.prototype.toJSON=function(){return`"${eS(this)}"`};rp.prototype.valueOf=function(t){return SQ(this,t)};rp.prototype.toString=function(){return eS(this)};rp.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return SQ(this);case"string":return eS(this);case"default":return zbe(this)}return eS(this)};function Q3(...t){return rp.apply(this,t)}function J3(...t){return rp.apply(this,t)}function XP(...t){return rp.apply(this,t)}Object.setPrototypeOf(Q3.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(J3.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(XP.prototype,Object.create(Uint32Array.prototype));Object.assign(Q3.prototype,rp.prototype,{constructor:Q3,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(J3.prototype,rp.prototype,{constructor:J3,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(XP.prototype,rp.prototype,{constructor:XP,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});var zHe=BigInt(4294967296)*BigInt(4294967296),UHe=zHe-BigInt(1);function SQ(t,e){let{buffer:r,byteOffset:i,byteLength:n,signed:o}=t,s=new BigUint64Array(r,i,n/8),a=o&&s.at(-1)&BigInt(1)<<BigInt(63),u=BigInt(0),p=0;if(a){for(let m of s)u|=(m^UHe)*(BigInt(1)<<BigInt(64*p++));u*=BigInt(-1),u-=BigInt(1)}else for(let m of s)u|=m*(BigInt(1)<<BigInt(64*p++));if(typeof e=="number"&&e>0){let m=BigInt("1".padEnd(e+1,"0")),x=u/m,M=a?-(u%m):u%m,k=Tn(x),F=`${M}`.padStart(e,"0");return+`${a&&k===0?"-":""}${k}.${F}`}return Tn(u)}function eS(t){if(t.byteLength===8)return`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`;if(!t.signed)return wQ(t);let e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);if(new Int16Array([e.at(-1)])[0]>=0)return wQ(t);e=e.slice();let i=1;for(let o=0;o<e.length;o++){let s=e[o],a=~s+i;e[o]=a,i&=s===0?1:0}return`-${wQ(e)}`}function zbe(t){return t.byteLength===8?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:eS(t)}function wQ(t){let e="",r=new Uint32Array(2),i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),n=new Uint32Array((i=new Uint16Array(i).reverse()).buffer),o=-1,s=i.length-1;do{for(r[0]=i[o=0];o<s;)i[o++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+i[o];i[o]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,e=`${r[0]}${e}`}while(n[0]||n[1]||n[2]||n[3]);return e??"0"}var ZP=class t{static new(e,r){switch(r){case!0:return new Q3(e);case!1:return new J3(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Q3(e)}return e.byteLength===16?new XP(e):new J3(e)}static signed(e){return new Q3(e)}static unsigned(e){return new J3(e)}static decimal(e){return new XP(e)}constructor(e,r){return t.new(e,r)}};var Ube,Vbe,jbe,$be,Wbe,Gbe,Hbe,qbe,Ybe,Xbe,Zbe,Kbe,Qbe,Jbe,exe,txe,rxe,ixe,nxe,oxe,sxe,axe,or=class t{static isNull(e){return e?.typeId===Qe.Null}static isInt(e){return e?.typeId===Qe.Int}static isFloat(e){return e?.typeId===Qe.Float}static isBinary(e){return e?.typeId===Qe.Binary}static isLargeBinary(e){return e?.typeId===Qe.LargeBinary}static isUtf8(e){return e?.typeId===Qe.Utf8}static isLargeUtf8(e){return e?.typeId===Qe.LargeUtf8}static isBool(e){return e?.typeId===Qe.Bool}static isDecimal(e){return e?.typeId===Qe.Decimal}static isDate(e){return e?.typeId===Qe.Date}static isTime(e){return e?.typeId===Qe.Time}static isTimestamp(e){return e?.typeId===Qe.Timestamp}static isInterval(e){return e?.typeId===Qe.Interval}static isDuration(e){return e?.typeId===Qe.Duration}static isList(e){return e?.typeId===Qe.List}static isStruct(e){return e?.typeId===Qe.Struct}static isUnion(e){return e?.typeId===Qe.Union}static isFixedSizeBinary(e){return e?.typeId===Qe.FixedSizeBinary}static isFixedSizeList(e){return e?.typeId===Qe.FixedSizeList}static isMap(e){return e?.typeId===Qe.Map}static isDictionary(e){return e?.typeId===Qe.Dictionary}static isDenseUnion(e){return t.isUnion(e)&&e.mode===bo.Dense}static isSparseUnion(e){return t.isUnion(e)&&e.mode===bo.Sparse}constructor(e){this.typeId=e}};Ube=Symbol.toStringTag;or[Ube]=(t=>(t.children=null,t.ArrayType=Array,t.OffsetArrayType=Int32Array,t[Symbol.toStringTag]="DataType"))(or.prototype);var fl=class extends or{constructor(){super(Qe.Null)}toString(){return"Null"}};Vbe=Symbol.toStringTag;fl[Vbe]=(t=>t[Symbol.toStringTag]="Null")(fl.prototype);var Fs=class extends or{constructor(e,r){super(Qe.Int),this.isSigned=e,this.bitWidth=r}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};jbe=Symbol.toStringTag;Fs[jbe]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(Fs.prototype);var KP=class extends Fs{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},QP=class extends Fs{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},ip=class extends Fs{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},JP=class extends Fs{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}},e6=class extends Fs{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},t6=class extends Fs{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},r6=class extends Fs{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},i6=class extends Fs{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(KP.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(QP.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(ip.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(JP.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(e6.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(t6.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(r6.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(i6.prototype,"ArrayType",{value:BigUint64Array});var pl=class extends or{constructor(e){super(Qe.Float),this.precision=e}get ArrayType(){switch(this.precision){case Dn.HALF:return Uint16Array;case Dn.SINGLE:return Float32Array;case Dn.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};$be=Symbol.toStringTag;pl[$be]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(pl.prototype);var n6=class extends pl{constructor(){super(Dn.HALF)}},o6=class extends pl{constructor(){super(Dn.SINGLE)}},xb=class extends pl{constructor(){super(Dn.DOUBLE)}};Object.defineProperty(n6.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(o6.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(xb.prototype,"ArrayType",{value:Float64Array});var Bd=class extends or{constructor(){super(Qe.Binary)}toString(){return"Binary"}};Wbe=Symbol.toStringTag;Bd[Wbe]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Bd.prototype);var O0=class extends or{constructor(){super(Qe.LargeBinary)}toString(){return"LargeBinary"}};Gbe=Symbol.toStringTag;O0[Gbe]=(t=>(t.ArrayType=Uint8Array,t.OffsetArrayType=BigInt64Array,t[Symbol.toStringTag]="LargeBinary"))(O0.prototype);var Fd=class extends or{constructor(){super(Qe.Utf8)}toString(){return"Utf8"}};Hbe=Symbol.toStringTag;Fd[Hbe]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(Fd.prototype);var D0=class extends or{constructor(){super(Qe.LargeUtf8)}toString(){return"LargeUtf8"}};qbe=Symbol.toStringTag;D0[qbe]=(t=>(t.ArrayType=Uint8Array,t.OffsetArrayType=BigInt64Array,t[Symbol.toStringTag]="LargeUtf8"))(D0.prototype);var Iu=class extends or{constructor(){super(Qe.Bool)}toString(){return"Bool"}};Ybe=Symbol.toStringTag;Iu[Ybe]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(Iu.prototype);var Nd=class extends or{constructor(e,r,i=128){super(Qe.Decimal),this.scale=e,this.precision=r,this.bitWidth=i}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};Xbe=Symbol.toStringTag;Nd[Xbe]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Nd.prototype);var zd=class extends or{constructor(e){super(Qe.Date),this.unit=e}toString(){return`Date${(this.unit+1)*32}<${Bs[this.unit]}>`}get ArrayType(){return this.unit===Bs.DAY?Int32Array:BigInt64Array}};Zbe=Symbol.toStringTag;zd[Zbe]=(t=>(t.unit=null,t[Symbol.toStringTag]="Date"))(zd.prototype);var Ud=class extends or{constructor(e,r){super(Qe.Time),this.unit=e,this.bitWidth=r}toString(){return`Time${this.bitWidth}<${Br[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};Kbe=Symbol.toStringTag;Ud[Kbe]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Ud.prototype);var Vd=class extends or{constructor(e,r){super(Qe.Timestamp),this.unit=e,this.timezone=r}toString(){return`Timestamp<${Br[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};Qbe=Symbol.toStringTag;Vd[Qbe]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Timestamp"))(Vd.prototype);var jd=class extends or{constructor(e){super(Qe.Interval),this.unit=e}toString(){return`Interval<${Eo[this.unit]}>`}};Jbe=Symbol.toStringTag;jd[Jbe]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(jd.prototype);var $d=class extends or{constructor(e){super(Qe.Duration),this.unit=e}toString(){return`Duration<${Br[this.unit]}>`}};exe=Symbol.toStringTag;$d[exe]=(t=>(t.unit=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Duration"))($d.prototype);var Za=class extends or{constructor(e){super(Qe.List),this.children=[e]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};txe=Symbol.toStringTag;Za[txe]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Za.prototype);var so=class extends or{constructor(e){super(Qe.Struct),this.children=e}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};rxe=Symbol.toStringTag;so[rxe]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(so.prototype);var ku=class extends or{constructor(e,r,i){super(Qe.Union),this.mode=e,this.children=i,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((n,o,s)=>(n[o]=s)&&n||n,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}};ixe=Symbol.toStringTag;ku[ixe]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(ku.prototype);var Wd=class extends or{constructor(e){super(Qe.FixedSizeBinary),this.byteWidth=e}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};nxe=Symbol.toStringTag;Wd[nxe]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Wd.prototype);var lc=class extends or{constructor(e,r){super(Qe.FixedSizeList),this.listSize=e,this.children=[r]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};oxe=Symbol.toStringTag;lc[oxe]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(lc.prototype);var Ru=class extends or{constructor(e,r=!1){var i,n,o;if(super(Qe.Map),this.children=[e],this.keysSorted=r,e&&(e.name="entries",!((i=e?.type)===null||i===void 0)&&i.children)){let s=(n=e?.type)===null||n===void 0?void 0:n.children[0];s&&(s.name="key");let a=(o=e?.type)===null||o===void 0?void 0:o.children[1];a&&(a.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}};sxe=Symbol.toStringTag;Ru[sxe]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Ru.prototype);var VHe=(t=>()=>++t)(-1),Ou=class extends or{constructor(e,r,i,n){super(Qe.Dictionary),this.indices=r,this.dictionary=e,this.isOrdered=n||!1,this.id=i==null?VHe():Tn(i)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};axe=Symbol.toStringTag;Ou[axe]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Ou.prototype);function kh(t){let e=t;switch(t.typeId){case Qe.Decimal:return t.bitWidth/32;case Qe.Interval:return e.unit===Eo.MONTH_DAY_NANO?4:1+e.unit;case Qe.FixedSizeList:return e.listSize;case Qe.FixedSizeBinary:return e.byteWidth;default:return 1}}var Hr=class{visitMany(e,...r){return e.map((i,n)=>this.visit(i,...r.map(o=>o[n])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,r=!0){return jHe(this,e,r)}getVisitFnByTypeId(e,r=!0){return tS(this,e,r)}visitNull(e,...r){return null}visitBool(e,...r){return null}visitInt(e,...r){return null}visitFloat(e,...r){return null}visitUtf8(e,...r){return null}visitLargeUtf8(e,...r){return null}visitBinary(e,...r){return null}visitLargeBinary(e,...r){return null}visitFixedSizeBinary(e,...r){return null}visitDate(e,...r){return null}visitTimestamp(e,...r){return null}visitTime(e,...r){return null}visitDecimal(e,...r){return null}visitList(e,...r){return null}visitStruct(e,...r){return null}visitUnion(e,...r){return null}visitDictionary(e,...r){return null}visitInterval(e,...r){return null}visitDuration(e,...r){return null}visitFixedSizeList(e,...r){return null}visitMap(e,...r){return null}};function jHe(t,e,r=!0){return typeof e=="number"?tS(t,e,r):typeof e=="string"&&e in Qe?tS(t,Qe[e],r):e&&e instanceof or?tS(t,lxe(e),r):e?.type&&e.type instanceof or?tS(t,lxe(e.type),r):tS(t,Qe.NONE,r)}function tS(t,e,r=!0){let i=null;switch(e){case Qe.Null:i=t.visitNull;break;case Qe.Bool:i=t.visitBool;break;case Qe.Int:i=t.visitInt;break;case Qe.Int8:i=t.visitInt8||t.visitInt;break;case Qe.Int16:i=t.visitInt16||t.visitInt;break;case Qe.Int32:i=t.visitInt32||t.visitInt;break;case Qe.Int64:i=t.visitInt64||t.visitInt;break;case Qe.Uint8:i=t.visitUint8||t.visitInt;break;case Qe.Uint16:i=t.visitUint16||t.visitInt;break;case Qe.Uint32:i=t.visitUint32||t.visitInt;break;case Qe.Uint64:i=t.visitUint64||t.visitInt;break;case Qe.Float:i=t.visitFloat;break;case Qe.Float16:i=t.visitFloat16||t.visitFloat;break;case Qe.Float32:i=t.visitFloat32||t.visitFloat;break;case Qe.Float64:i=t.visitFloat64||t.visitFloat;break;case Qe.Utf8:i=t.visitUtf8;break;case Qe.LargeUtf8:i=t.visitLargeUtf8;break;case Qe.Binary:i=t.visitBinary;break;case Qe.LargeBinary:i=t.visitLargeBinary;break;case Qe.FixedSizeBinary:i=t.visitFixedSizeBinary;break;case Qe.Date:i=t.visitDate;break;case Qe.DateDay:i=t.visitDateDay||t.visitDate;break;case Qe.DateMillisecond:i=t.visitDateMillisecond||t.visitDate;break;case Qe.Timestamp:i=t.visitTimestamp;break;case Qe.TimestampSecond:i=t.visitTimestampSecond||t.visitTimestamp;break;case Qe.TimestampMillisecond:i=t.visitTimestampMillisecond||t.visitTimestamp;break;case Qe.TimestampMicrosecond:i=t.visitTimestampMicrosecond||t.visitTimestamp;break;case Qe.TimestampNanosecond:i=t.visitTimestampNanosecond||t.visitTimestamp;break;case Qe.Time:i=t.visitTime;break;case Qe.TimeSecond:i=t.visitTimeSecond||t.visitTime;break;case Qe.TimeMillisecond:i=t.visitTimeMillisecond||t.visitTime;break;case Qe.TimeMicrosecond:i=t.visitTimeMicrosecond||t.visitTime;break;case Qe.TimeNanosecond:i=t.visitTimeNanosecond||t.visitTime;break;case Qe.Decimal:i=t.visitDecimal;break;case Qe.List:i=t.visitList;break;case Qe.Struct:i=t.visitStruct;break;case Qe.Union:i=t.visitUnion;break;case Qe.DenseUnion:i=t.visitDenseUnion||t.visitUnion;break;case Qe.SparseUnion:i=t.visitSparseUnion||t.visitUnion;break;case Qe.Dictionary:i=t.visitDictionary;break;case Qe.Interval:i=t.visitInterval;break;case Qe.IntervalDayTime:i=t.visitIntervalDayTime||t.visitInterval;break;case Qe.IntervalYearMonth:i=t.visitIntervalYearMonth||t.visitInterval;break;case Qe.IntervalMonthDayNano:i=t.visitIntervalMonthDayNano||t.visitInterval;break;case Qe.Duration:i=t.visitDuration;break;case Qe.DurationSecond:i=t.visitDurationSecond||t.visitDuration;break;case Qe.DurationMillisecond:i=t.visitDurationMillisecond||t.visitDuration;break;case Qe.DurationMicrosecond:i=t.visitDurationMicrosecond||t.visitDuration;break;case Qe.DurationNanosecond:i=t.visitDurationNanosecond||t.visitDuration;break;case Qe.FixedSizeList:i=t.visitFixedSizeList;break;case Qe.Map:i=t.visitMap;break}if(typeof i=="function")return i;if(!r)return()=>null;throw new Error(`Unrecognized type '${Qe[e]}'`)}function lxe(t){switch(t.typeId){case Qe.Null:return Qe.Null;case Qe.Int:{let{bitWidth:e,isSigned:r}=t;switch(e){case 8:return r?Qe.Int8:Qe.Uint8;case 16:return r?Qe.Int16:Qe.Uint16;case 32:return r?Qe.Int32:Qe.Uint32;case 64:return r?Qe.Int64:Qe.Uint64}return Qe.Int}case Qe.Float:switch(t.precision){case Dn.HALF:return Qe.Float16;case Dn.SINGLE:return Qe.Float32;case Dn.DOUBLE:return Qe.Float64}return Qe.Float;case Qe.Binary:return Qe.Binary;case Qe.LargeBinary:return Qe.LargeBinary;case Qe.Utf8:return Qe.Utf8;case Qe.LargeUtf8:return Qe.LargeUtf8;case Qe.Bool:return Qe.Bool;case Qe.Decimal:return Qe.Decimal;case Qe.Time:switch(t.unit){case Br.SECOND:return Qe.TimeSecond;case Br.MILLISECOND:return Qe.TimeMillisecond;case Br.MICROSECOND:return Qe.TimeMicrosecond;case Br.NANOSECOND:return Qe.TimeNanosecond}return Qe.Time;case Qe.Timestamp:switch(t.unit){case Br.SECOND:return Qe.TimestampSecond;case Br.MILLISECOND:return Qe.TimestampMillisecond;case Br.MICROSECOND:return Qe.TimestampMicrosecond;case Br.NANOSECOND:return Qe.TimestampNanosecond}return Qe.Timestamp;case Qe.Date:switch(t.unit){case Bs.DAY:return Qe.DateDay;case Bs.MILLISECOND:return Qe.DateMillisecond}return Qe.Date;case Qe.Interval:switch(t.unit){case Eo.DAY_TIME:return Qe.IntervalDayTime;case Eo.YEAR_MONTH:return Qe.IntervalYearMonth;case Eo.MONTH_DAY_NANO:return Qe.IntervalMonthDayNano}return Qe.Interval;case Qe.Duration:switch(t.unit){case Br.SECOND:return Qe.DurationSecond;case Br.MILLISECOND:return Qe.DurationMillisecond;case Br.MICROSECOND:return Qe.DurationMicrosecond;case Br.NANOSECOND:return Qe.DurationNanosecond}return Qe.Duration;case Qe.Map:return Qe.Map;case Qe.List:return Qe.List;case Qe.Struct:return Qe.Struct;case Qe.Union:switch(t.mode){case bo.Dense:return Qe.DenseUnion;case bo.Sparse:return Qe.SparseUnion}return Qe.Union;case Qe.FixedSizeBinary:return Qe.FixedSizeBinary;case Qe.FixedSizeList:return Qe.FixedSizeList;case Qe.Dictionary:return Qe.Dictionary}throw new Error(`Unrecognized type '${Qe[t.typeId]}'`)}Hr.prototype.visitInt8=null;Hr.prototype.visitInt16=null;Hr.prototype.visitInt32=null;Hr.prototype.visitInt64=null;Hr.prototype.visitUint8=null;Hr.prototype.visitUint16=null;Hr.prototype.visitUint32=null;Hr.prototype.visitUint64=null;Hr.prototype.visitFloat16=null;Hr.prototype.visitFloat32=null;Hr.prototype.visitFloat64=null;Hr.prototype.visitDateDay=null;Hr.prototype.visitDateMillisecond=null;Hr.prototype.visitTimestampSecond=null;Hr.prototype.visitTimestampMillisecond=null;Hr.prototype.visitTimestampMicrosecond=null;Hr.prototype.visitTimestampNanosecond=null;Hr.prototype.visitTimeSecond=null;Hr.prototype.visitTimeMillisecond=null;Hr.prototype.visitTimeMicrosecond=null;Hr.prototype.visitTimeNanosecond=null;Hr.prototype.visitDenseUnion=null;Hr.prototype.visitSparseUnion=null;Hr.prototype.visitIntervalDayTime=null;Hr.prototype.visitIntervalYearMonth=null;Hr.prototype.visitIntervalMonthDayNano=null;Hr.prototype.visitDuration=null;Hr.prototype.visitDurationSecond=null;Hr.prototype.visitDurationMillisecond=null;Hr.prototype.visitDurationMicrosecond=null;Hr.prototype.visitDurationNanosecond=null;var MQ={};nl(MQ,{float64ToUint16:()=>s6,uint16ToFloat64:()=>jB});var cxe=new Float64Array(1),rS=new Uint32Array(cxe.buffer);function jB(t){let e=(t&31744)>>10,r=(t&1023)/1024,i=Math.pow(-1,(t&32768)>>15);switch(e){case 31:return i*(r?Number.NaN:1/0);case 0:return i*(r?6103515625e-14*r:0)}return i*Math.pow(2,e-15)*(1+r)}function s6(t){if(t!==t)return 32256;cxe[0]=t;let e=(rS[1]&2147483648)>>16&65535,r=rS[1]&2146435072,i=0;return r>=1089470464?rS[0]>0?r=31744:(r=(r&2080374784)>>16,i=(rS[1]&1048575)>>10):r<=1056964608?(i=1048576+(rS[1]&1048575),i=1048576+(i<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,i=(rS[1]&1048575)+512>>10),e|r|i&65535}var ti=class extends Hr{};function hi(t){return(e,r,i)=>{if(e.setValid(r,i!=null))return t(e,r,i)}}var $He=(t,e,r)=>{t[e]=Math.floor(r/864e5)},uxe=(t,e,r,i)=>{if(r+1<e.length){let n=Tn(e[r]),o=Tn(e[r+1]);t.set(i.subarray(0,o-n),n)}},WHe=({offset:t,values:e},r,i)=>{let n=t+r;i?e[n>>3]|=1<<n%8:e[n>>3]&=~(1<<n%8)},Dg=({values:t},e,r)=>{t[e]=r},EQ=({values:t},e,r)=>{t[e]=r},hxe=({values:t},e,r)=>{t[e]=s6(r)},GHe=(t,e,r)=>{switch(t.type.precision){case Dn.HALF:return hxe(t,e,r);case Dn.SINGLE:case Dn.DOUBLE:return EQ(t,e,r)}},$B=({values:t},e,r)=>{$He(t,e,r.valueOf())},WB=({values:t},e,r)=>{t[e]=BigInt(r)},CQ=({stride:t,values:e},r,i)=>{e.set(i.subarray(0,t),t*r)},dxe=({values:t,valueOffsets:e},r,i)=>uxe(t,e,r,i),fxe=({values:t,valueOffsets:e},r,i)=>uxe(t,e,r,C0(i)),PQ=(t,e,r)=>{t.type.unit===Bs.DAY?$B(t,e,r):WB(t,e,r)},GB=({values:t},e,r)=>{t[e]=BigInt(r/1e3)},HB=({values:t},e,r)=>{t[e]=BigInt(r)},qB=({values:t},e,r)=>{t[e]=BigInt(r*1e3)},YB=({values:t},e,r)=>{t[e]=BigInt(r*1e6)},IQ=(t,e,r)=>{switch(t.type.unit){case Br.SECOND:return GB(t,e,r);case Br.MILLISECOND:return HB(t,e,r);case Br.MICROSECOND:return qB(t,e,r);case Br.NANOSECOND:return YB(t,e,r)}},XB=({values:t},e,r)=>{t[e]=r},ZB=({values:t},e,r)=>{t[e]=r},KB=({values:t},e,r)=>{t[e]=r},QB=({values:t},e,r)=>{t[e]=r},kQ=(t,e,r)=>{switch(t.type.unit){case Br.SECOND:return XB(t,e,r);case Br.MILLISECOND:return ZB(t,e,r);case Br.MICROSECOND:return KB(t,e,r);case Br.NANOSECOND:return QB(t,e,r)}},RQ=({values:t,stride:e},r,i)=>{t.set(i.subarray(0,e),e*r)},HHe=(t,e,r)=>{let i=t.children[0],n=t.valueOffsets,o=Bl.getVisitFn(i);if(Array.isArray(r))for(let s=-1,a=n[e],u=n[e+1];a<u;)o(i,a++,r[++s]);else for(let s=-1,a=n[e],u=n[e+1];a<u;)o(i,a++,r.get(++s))},qHe=(t,e,r)=>{let i=t.children[0],{valueOffsets:n}=t,o=Bl.getVisitFn(i),{[e]:s,[e+1]:a}=n,u=r instanceof Map?r.entries():Object.entries(r);for(let p of u)if(o(i,s,p),++s>=a)break},YHe=(t,e)=>(r,i,n,o)=>i&&r(i,t,e[o]),XHe=(t,e)=>(r,i,n,o)=>i&&r(i,t,e.get(o)),ZHe=(t,e)=>(r,i,n,o)=>i&&r(i,t,e.get(n.name)),KHe=(t,e)=>(r,i,n,o)=>i&&r(i,t,e[n.name]),QHe=(t,e,r)=>{let i=t.type.children.map(o=>Bl.getVisitFn(o.type)),n=r instanceof Map?ZHe(e,r):r instanceof Or?XHe(e,r):Array.isArray(r)?YHe(e,r):KHe(e,r);t.type.children.forEach((o,s)=>n(i[s],t.children[s],o,s))},JHe=(t,e,r)=>{t.type.mode===bo.Dense?pxe(t,e,r):mxe(t,e,r)},pxe=(t,e,r)=>{let i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];Bl.visit(n,t.valueOffsets[e],r)},mxe=(t,e,r)=>{let i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];Bl.visit(n,e,r)},eqe=(t,e,r)=>{var i;(i=t.dictionary)===null||i===void 0||i.set(t.values[e],r)},OQ=(t,e,r)=>{switch(t.type.unit){case Eo.YEAR_MONTH:return eF(t,e,r);case Eo.DAY_TIME:return JB(t,e,r);case Eo.MONTH_DAY_NANO:return tF(t,e,r)}},JB=({values:t},e,r)=>{t.set(r.subarray(0,2),2*e)},eF=({values:t},e,r)=>{t[e]=r[0]*12+r[1]%12},tF=({values:t,stride:e},r,i)=>{t.set(i.subarray(0,e),e*r)},rF=({values:t},e,r)=>{t[e]=r},iF=({values:t},e,r)=>{t[e]=r},nF=({values:t},e,r)=>{t[e]=r},oF=({values:t},e,r)=>{t[e]=r},DQ=(t,e,r)=>{switch(t.type.unit){case Br.SECOND:return rF(t,e,r);case Br.MILLISECOND:return iF(t,e,r);case Br.MICROSECOND:return nF(t,e,r);case Br.NANOSECOND:return oF(t,e,r)}},tqe=(t,e,r)=>{let{stride:i}=t,n=t.children[0],o=Bl.getVisitFn(n);if(Array.isArray(r))for(let s=-1,a=e*i;++s<i;)o(n,a+s,r[s]);else for(let s=-1,a=e*i;++s<i;)o(n,a+s,r.get(s))};ti.prototype.visitBool=hi(WHe);ti.prototype.visitInt=hi(Dg);ti.prototype.visitInt8=hi(Dg);ti.prototype.visitInt16=hi(Dg);ti.prototype.visitInt32=hi(Dg);ti.prototype.visitInt64=hi(Dg);ti.prototype.visitUint8=hi(Dg);ti.prototype.visitUint16=hi(Dg);ti.prototype.visitUint32=hi(Dg);ti.prototype.visitUint64=hi(Dg);ti.prototype.visitFloat=hi(GHe);ti.prototype.visitFloat16=hi(hxe);ti.prototype.visitFloat32=hi(EQ);ti.prototype.visitFloat64=hi(EQ);ti.prototype.visitUtf8=hi(fxe);ti.prototype.visitLargeUtf8=hi(fxe);ti.prototype.visitBinary=hi(dxe);ti.prototype.visitLargeBinary=hi(dxe);ti.prototype.visitFixedSizeBinary=hi(CQ);ti.prototype.visitDate=hi(PQ);ti.prototype.visitDateDay=hi($B);ti.prototype.visitDateMillisecond=hi(WB);ti.prototype.visitTimestamp=hi(IQ);ti.prototype.visitTimestampSecond=hi(GB);ti.prototype.visitTimestampMillisecond=hi(HB);ti.prototype.visitTimestampMicrosecond=hi(qB);ti.prototype.visitTimestampNanosecond=hi(YB);ti.prototype.visitTime=hi(kQ);ti.prototype.visitTimeSecond=hi(XB);ti.prototype.visitTimeMillisecond=hi(ZB);ti.prototype.visitTimeMicrosecond=hi(KB);ti.prototype.visitTimeNanosecond=hi(QB);ti.prototype.visitDecimal=hi(RQ);ti.prototype.visitList=hi(HHe);ti.prototype.visitStruct=hi(QHe);ti.prototype.visitUnion=hi(JHe);ti.prototype.visitDenseUnion=hi(pxe);ti.prototype.visitSparseUnion=hi(mxe);ti.prototype.visitDictionary=hi(eqe);ti.prototype.visitInterval=hi(OQ);ti.prototype.visitIntervalDayTime=hi(JB);ti.prototype.visitIntervalYearMonth=hi(eF);ti.prototype.visitIntervalMonthDayNano=hi(tF);ti.prototype.visitDuration=hi(DQ);ti.prototype.visitDurationSecond=hi(rF);ti.prototype.visitDurationMillisecond=hi(iF);ti.prototype.visitDurationMicrosecond=hi(nF);ti.prototype.visitDurationNanosecond=hi(oF);ti.prototype.visitFixedSizeList=hi(tqe);ti.prototype.visitMap=hi(qHe);var Bl=new ti;var np=Symbol.for("parent"),iS=Symbol.for("rowIndex"),E_=class{constructor(e,r){return this[np]=e,this[iS]=r,new Proxy(this,rqe)}toArray(){return Object.values(this.toJSON())}toJSON(){let e=this[iS],r=this[np],i=r.type.children,n={};for(let o=-1,s=i.length;++o<s;)n[i[o].name]=Ta.visit(r.children[o],e);return n}toString(){return`{${[...this].map(([e,r])=>`${tp(e)}: ${tp(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new LQ(this[np],this[iS])}},LQ=class{constructor(e,r){this.childIndex=0,this.children=e.children,this.rowIndex=r,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,Ta.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(E_.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[np]:{writable:!0,enumerable:!1,configurable:!1,value:null},[iS]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var BQ=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[np].type.children.map(r=>r.name)}has(e,r){return e[np].type.children.some(i=>i.name===r)}getOwnPropertyDescriptor(e,r){if(e[np].type.children.some(i=>i.name===r))return{writable:!0,enumerable:!0,configurable:!0}}get(e,r){if(Reflect.has(e,r))return e[r];let i=e[np].type.children.findIndex(n=>n.name===r);if(i!==-1){let n=Ta.visit(e[np].children[i],e[iS]);return Reflect.set(e,r,n),n}}set(e,r,i){let n=e[np].type.children.findIndex(o=>o.name===r);return n!==-1?(Bl.visit(e[np].children[n],e[iS],i),Reflect.set(e,r,i)):Reflect.has(e,r)||typeof r=="symbol"?Reflect.set(e,r,i):!1}},rqe=new BQ;var qr=class extends Hr{};function ai(t){return(e,r)=>e.getValid(r)?t(e,r):null}var iqe=(t,e)=>864e5*t[e],nqe=(t,e)=>null,gxe=(t,e,r)=>{if(r+1>=e.length)return null;let i=Tn(e[r]),n=Tn(e[r+1]);return t.subarray(i,n)},oqe=({offset:t,values:e},r)=>{let i=t+r;return(e[i>>3]&1<<i%8)!==0},Axe=({values:t},e)=>iqe(t,e),yxe=({values:t},e)=>Tn(t[e]),C_=({stride:t,values:e},r)=>e[t*r],sqe=({stride:t,values:e},r)=>jB(e[t*r]),_xe=({values:t},e)=>t[e],aqe=({stride:t,values:e},r)=>e.subarray(t*r,t*(r+1)),vxe=({values:t,valueOffsets:e},r)=>gxe(t,e,r),bxe=({values:t,valueOffsets:e},r)=>{let i=gxe(t,e,r);return i!==null?BP(i):null},lqe=({values:t},e)=>t[e],cqe=({type:t,values:e},r)=>t.precision!==Dn.HALF?e[r]:jB(e[r]),uqe=(t,e)=>t.type.unit===Bs.DAY?Axe(t,e):yxe(t,e),xxe=({values:t},e)=>1e3*Tn(t[e]),wxe=({values:t},e)=>Tn(t[e]),Sxe=({values:t},e)=>xQ(t[e],BigInt(1e3)),Txe=({values:t},e)=>xQ(t[e],BigInt(1e6)),hqe=(t,e)=>{switch(t.type.unit){case Br.SECOND:return xxe(t,e);case Br.MILLISECOND:return wxe(t,e);case Br.MICROSECOND:return Sxe(t,e);case Br.NANOSECOND:return Txe(t,e)}},Mxe=({values:t},e)=>t[e],Exe=({values:t},e)=>t[e],Cxe=({values:t},e)=>t[e],Pxe=({values:t},e)=>t[e],dqe=(t,e)=>{switch(t.type.unit){case Br.SECOND:return Mxe(t,e);case Br.MILLISECOND:return Exe(t,e);case Br.MICROSECOND:return Cxe(t,e);case Br.NANOSECOND:return Pxe(t,e)}},fqe=({values:t,stride:e},r)=>ZP.decimal(t.subarray(e*r,e*(r+1))),pqe=(t,e)=>{let{valueOffsets:r,stride:i,children:n}=t,{[e*i]:o,[e*i+1]:s}=r,u=n[0].slice(o,s-o);return new Or([u])},mqe=(t,e)=>{let{valueOffsets:r,children:i}=t,{[e]:n,[e+1]:o}=r,s=i[0];return new L0(s.slice(n,o-n))},gqe=(t,e)=>new E_(t,e),Aqe=(t,e)=>t.type.mode===bo.Dense?Ixe(t,e):kxe(t,e),Ixe=(t,e)=>{let r=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[r];return Ta.visit(i,t.valueOffsets[e])},kxe=(t,e)=>{let r=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[r];return Ta.visit(i,e)},yqe=(t,e)=>{var r;return(r=t.dictionary)===null||r===void 0?void 0:r.get(t.values[e])},_qe=(t,e)=>t.type.unit===Eo.MONTH_DAY_NANO?Dxe(t,e):t.type.unit===Eo.DAY_TIME?Rxe(t,e):Oxe(t,e),Rxe=({values:t},e)=>t.subarray(2*e,2*(e+1)),Oxe=({values:t},e)=>{let r=t[e],i=new Int32Array(2);return i[0]=Math.trunc(r/12),i[1]=Math.trunc(r%12),i},Dxe=({values:t},e)=>t.subarray(4*e,4*(e+1)),Lxe=({values:t},e)=>t[e],Bxe=({values:t},e)=>t[e],Fxe=({values:t},e)=>t[e],Nxe=({values:t},e)=>t[e],vqe=(t,e)=>{switch(t.type.unit){case Br.SECOND:return Lxe(t,e);case Br.MILLISECOND:return Bxe(t,e);case Br.MICROSECOND:return Fxe(t,e);case Br.NANOSECOND:return Nxe(t,e)}},bqe=(t,e)=>{let{stride:r,children:i}=t,o=i[0].slice(e*r,r);return new Or([o])};qr.prototype.visitNull=ai(nqe);qr.prototype.visitBool=ai(oqe);qr.prototype.visitInt=ai(lqe);qr.prototype.visitInt8=ai(C_);qr.prototype.visitInt16=ai(C_);qr.prototype.visitInt32=ai(C_);qr.prototype.visitInt64=ai(_xe);qr.prototype.visitUint8=ai(C_);qr.prototype.visitUint16=ai(C_);qr.prototype.visitUint32=ai(C_);qr.prototype.visitUint64=ai(_xe);qr.prototype.visitFloat=ai(cqe);qr.prototype.visitFloat16=ai(sqe);qr.prototype.visitFloat32=ai(C_);qr.prototype.visitFloat64=ai(C_);qr.prototype.visitUtf8=ai(bxe);qr.prototype.visitLargeUtf8=ai(bxe);qr.prototype.visitBinary=ai(vxe);qr.prototype.visitLargeBinary=ai(vxe);qr.prototype.visitFixedSizeBinary=ai(aqe);qr.prototype.visitDate=ai(uqe);qr.prototype.visitDateDay=ai(Axe);qr.prototype.visitDateMillisecond=ai(yxe);qr.prototype.visitTimestamp=ai(hqe);qr.prototype.visitTimestampSecond=ai(xxe);qr.prototype.visitTimestampMillisecond=ai(wxe);qr.prototype.visitTimestampMicrosecond=ai(Sxe);qr.prototype.visitTimestampNanosecond=ai(Txe);qr.prototype.visitTime=ai(dqe);qr.prototype.visitTimeSecond=ai(Mxe);qr.prototype.visitTimeMillisecond=ai(Exe);qr.prototype.visitTimeMicrosecond=ai(Cxe);qr.prototype.visitTimeNanosecond=ai(Pxe);qr.prototype.visitDecimal=ai(fqe);qr.prototype.visitList=ai(pqe);qr.prototype.visitStruct=ai(gqe);qr.prototype.visitUnion=ai(Aqe);qr.prototype.visitDenseUnion=ai(Ixe);qr.prototype.visitSparseUnion=ai(kxe);qr.prototype.visitDictionary=ai(yqe);qr.prototype.visitInterval=ai(_qe);qr.prototype.visitIntervalDayTime=ai(Rxe);qr.prototype.visitIntervalYearMonth=ai(Oxe);qr.prototype.visitIntervalMonthDayNano=ai(Dxe);qr.prototype.visitDuration=ai(vqe);qr.prototype.visitDurationSecond=ai(Lxe);qr.prototype.visitDurationMillisecond=ai(Bxe);qr.prototype.visitDurationMicrosecond=ai(Fxe);qr.prototype.visitDurationNanosecond=ai(Nxe);qr.prototype.visitFixedSizeList=ai(bqe);qr.prototype.visitMap=ai(mqe);var Ta=new qr;var P_=Symbol.for("keys"),oS=Symbol.for("vals"),nS=Symbol.for("kKeysAsStrings"),FQ=Symbol.for("_kKeysAsStrings"),L0=class{constructor(e){return this[P_]=new Or([e.children[0]]).memoize(),this[oS]=e.children[1],new Proxy(this,new zQ)}get[nS](){return this[FQ]||(this[FQ]=Array.from(this[P_].toArray(),String))}[Symbol.iterator](){return new NQ(this[P_],this[oS])}get size(){return this[P_].length}toArray(){return Object.values(this.toJSON())}toJSON(){let e=this[P_],r=this[oS],i={};for(let n=-1,o=e.length;++n<o;)i[e.get(n)]=Ta.visit(r,n);return i}toString(){return`{${[...this].map(([e,r])=>`${tp(e)}: ${tp(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},NQ=class{constructor(e,r){this.keys=e,this.vals=r,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){let e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),Ta.visit(this.vals,e)]})}},zQ=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[nS]}has(e,r){return e[nS].includes(r)}getOwnPropertyDescriptor(e,r){if(e[nS].indexOf(r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,r){if(Reflect.has(e,r))return e[r];let i=e[nS].indexOf(r);if(i!==-1){let n=Ta.visit(Reflect.get(e,oS),i);return Reflect.set(e,r,n),n}}set(e,r,i){let n=e[nS].indexOf(r);return n!==-1?(Bl.visit(Reflect.get(e,oS),n,i),Reflect.set(e,r,i)):Reflect.has(e,r)?Reflect.set(e,r,i):!1}};Object.defineProperties(L0.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[P_]:{writable:!0,enumerable:!1,configurable:!1,value:null},[oS]:{writable:!0,enumerable:!1,configurable:!1,value:null},[FQ]:{writable:!0,enumerable:!1,configurable:!1,value:null}});var zxe;function a6(t,e,r,i){let{length:n=0}=t,o=typeof e!="number"?0:e,s=typeof r!="number"?n:r;return o<0&&(o=(o%n+n)%n),s<0&&(s=(s%n+n)%n),s<o&&(zxe=o,o=s,s=zxe),s>n&&(s=n),i?i(t,o,s):[o,s]}var wb=(t,e)=>t<0?e+t:t,Uxe=t=>t!==t;function I_(t){if(typeof t!=="object"||t===null)return Uxe(t)?Uxe:r=>r===t;if(t instanceof Date){let r=t.valueOf();return i=>i instanceof Date?i.valueOf()===r:!1}return ArrayBuffer.isView(t)?r=>r?AQ(t,r):!1:t instanceof Map?wqe(t):Array.isArray(t)?xqe(t):t instanceof Or?Sqe(t):Tqe(t,!0)}function xqe(t){let e=[];for(let r=-1,i=t.length;++r<i;)e[r]=I_(t[r]);return sF(e)}function wqe(t){let e=-1,r=[];for(let i of t.values())r[++e]=I_(i);return sF(r)}function Sqe(t){let e=[];for(let r=-1,i=t.length;++r<i;)e[r]=I_(t.get(r));return sF(e)}function Tqe(t,e=!1){let r=Object.keys(t);if(!e&&r.length===0)return()=>!1;let i=[];for(let n=-1,o=r.length;++n<o;)i[n]=I_(t[r[n]]);return sF(i,r)}function sF(t,e){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return Mqe(t,r);case Map:return Vxe(t,r,r.keys());case L0:case E_:case Object:case void 0:return Vxe(t,r,e||Object.keys(r))}return r instanceof Or?Eqe(t,r):!1}}function Mqe(t,e){let r=t.length;if(e.length!==r)return!1;for(let i=-1;++i<r;)if(!t[i](e[i]))return!1;return!0}function Eqe(t,e){let r=t.length;if(e.length!==r)return!1;for(let i=-1;++i<r;)if(!t[i](e.get(i)))return!1;return!0}function Vxe(t,e,r){let i=r[Symbol.iterator](),n=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),o=e instanceof Map?e.values():Object.values(e)[Symbol.iterator](),s=0,a=t.length,u=o.next(),p=i.next(),m=n.next();for(;s<a&&!p.done&&!m.done&&!u.done&&!(p.value!==m.value||!t[s](u.value));++s,p=i.next(),m=n.next(),u=o.next());return s===a&&p.done&&m.done&&u.done?!0:(i.return&&i.return(),n.return&&n.return(),o.return&&o.return(),!1)}var VQ={};nl(VQ,{BitIterator:()=>Sb,getBit:()=>jxe,getBool:()=>lF,packBools:()=>Mb,popcnt_array:()=>$xe,popcnt_bit_range:()=>l6,popcnt_uint32:()=>aF,setBool:()=>Cqe,truncateBitmap:()=>Tb});function lF(t,e,r,i){return(r&1<<i)!==0}function jxe(t,e,r,i){return(r&1<<i)>>i}function Cqe(t,e,r){return r?!!(t[e>>3]|=1<<e%8)||!0:!(t[e>>3]&=~(1<<e%8))&&!1}function Tb(t,e,r){let i=r.byteLength+7&-8;if(t>0||r.byteLength<i){let n=new Uint8Array(i);return n.set(t%8===0?r.subarray(t>>3):Mb(new Sb(r,t,e,null,lF)).subarray(0,i)),n}return r}function Mb(t){let e=[],r=0,i=0,n=0;for(let s of t)s&&(n|=1<<i),++i===8&&(e[r++]=n,n=i=0);(r===0||i>0)&&(e[r++]=n);let o=new Uint8Array(e.length+7&-8);return o.set(e),o}var Sb=class{constructor(e,r,i,n,o){this.bytes=e,this.length=i,this.context=n,this.get=o,this.bit=r%8,this.byteIndex=r>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function l6(t,e,r){if(r-e<=0)return 0;if(r-e<8){let o=0;for(let s of new Sb(t,e,r-e,t,jxe))o+=s;return o}let i=r>>3<<3,n=e+(e%8===0?0:8-e%8);return l6(t,e,n)+l6(t,i,r)+$xe(t,n>>3,i-n>>3)}function $xe(t,e,r){let i=0,n=Math.trunc(e),o=new DataView(t.buffer,t.byteOffset,t.byteLength),s=r===void 0?t.byteLength:n+r;for(;s-n>=4;)i+=aF(o.getUint32(n)),n+=4;for(;s-n>=2;)i+=aF(o.getUint16(n)),n+=2;for(;s-n>=1;)i+=aF(o.getUint8(n)),n+=1;return i}function aF(t){let e=Math.trunc(t);return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}var Pqe=-1,Ji=class t{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){let{type:e}=this;return or.isSparseUnion(e)?this.children.some(r=>r.nullable):or.isDenseUnion(e)?this.children.some(r=>r.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let e=0,{valueOffsets:r,values:i,nullBitmap:n,typeIds:o}=this;return r&&(e+=r.byteLength),i&&(e+=i.byteLength),n&&(e+=n.byteLength),o&&(e+=o.byteLength),this.children.reduce((s,a)=>s+a.byteLength,e)}get nullCount(){if(or.isUnion(this.type))return this.children.reduce((i,n)=>i+n.nullCount,0);let e=this._nullCount,r;return e<=Pqe&&(r=this.nullBitmap)&&(this._nullCount=e=r.length===0?0:this.length-l6(r,this.offset,this.offset+this.length)),e}constructor(e,r,i,n,o,s=[],a){this.type=e,this.children=s,this.dictionary=a,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1));let u;o instanceof t?(this.stride=o.stride,this.values=o.values,this.typeIds=o.typeIds,this.nullBitmap=o.nullBitmap,this.valueOffsets=o.valueOffsets):(this.stride=kh(e),o&&((u=o[0])&&(this.valueOffsets=u),(u=o[1])&&(this.values=u),(u=o[2])&&(this.nullBitmap=u),(u=o[3])&&(this.typeIds=u)))}getValid(e){let{type:r}=this;if(or.isUnion(r)){let i=r,n=this.children[i.typeIdToChildIndex[this.typeIds[e]]],o=i.mode===bo.Dense?this.valueOffsets[e]:e;return n.getValid(o)}if(this.nullable&&this.nullCount>0){let i=this.offset+e;return(this.nullBitmap[i>>3]&1<<i%8)!==0}return!0}setValid(e,r){let i,{type:n}=this;if(or.isUnion(n)){let o=n,s=this.children[o.typeIdToChildIndex[this.typeIds[e]]],a=o.mode===bo.Dense?this.valueOffsets[e]:e;i=s.getValid(a),s.setValid(a,r)}else{let{nullBitmap:o}=this,{offset:s,length:a}=this,u=s+e,p=1<<u%8,m=u>>3;(!o||o.byteLength<=m)&&(o=new Uint8Array((s+a+63&-64)>>3).fill(255),this.nullCount>0?(o.set(Tb(s,a,this.nullBitmap),0),Object.assign(this,{nullBitmap:o})):Object.assign(this,{nullBitmap:o,_nullCount:0}));let x=o[m];i=(x&p)!==0,o[m]=r?x|p:x&~p}return i!==!!r&&(this._nullCount=this.nullCount+(r?-1:1)),r}clone(e=this.type,r=this.offset,i=this.length,n=this._nullCount,o=this,s=this.children){return new t(e,r,i,n,o,s,this.dictionary)}slice(e,r){let{stride:i,typeId:n,children:o}=this,s=+(this._nullCount===0)-1,a=n===16?i:1,u=this._sliceBuffers(e,r,i,n);return this.clone(this.type,this.offset+e,r,s,u,o.length===0||this.valueOffsets?o:this._sliceChildren(o,a*e,a*r))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===Qe.Null)return this.clone(this.type,0,e,0);let{length:r,nullCount:i}=this,n=new Uint8Array((e+63&-64)>>3).fill(255,0,r>>3);n[r>>3]=(1<<r-(r&-8))-1,i>0&&n.set(Tb(this.offset,r,this.nullBitmap),0);let o=this.buffers;return o[un.VALIDITY]=n,this.clone(this.type,0,e,i+(e-r),o)}_sliceBuffers(e,r,i,n){let o,{buffers:s}=this;return(o=s[un.TYPE])&&(s[un.TYPE]=o.subarray(e,e+r)),(o=s[un.OFFSET])&&(s[un.OFFSET]=o.subarray(e,e+r+1))||(o=s[un.DATA])&&(s[un.DATA]=n===6?o:o.subarray(i*e,i*(e+r))),s}_sliceChildren(e,r,i){return e.map(n=>n.slice(r,i))}};Ji.prototype.children=Object.freeze([]);var jQ=class t extends Hr{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){let{["type"]:r,["offset"]:i=0,["length"]:n=0}=e;return new Ji(r,i,n,n)}visitBool(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length>>3,["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitInt(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length,["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitFloat(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length,["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitUtf8(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.data),o=ii(e.nullBitmap),s=_b(e.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[s,n,o])}visitLargeUtf8(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.data),o=ii(e.nullBitmap),s=BB(e.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[s,n,o])}visitBinary(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.data),o=ii(e.nullBitmap),s=_b(e.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[s,n,o])}visitLargeBinary(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.data),o=ii(e.nullBitmap),s=BB(e.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[s,n,o])}visitFixedSizeBinary(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitDate(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitTimestamp(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitTime(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitDecimal(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitList(e){let{["type"]:r,["offset"]:i=0,["child"]:n}=e,o=ii(e.nullBitmap),s=_b(e.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[s,void 0,o],[n])}visitStruct(e){let{["type"]:r,["offset"]:i=0,["children"]:n=[]}=e,o=ii(e.nullBitmap),{length:s=n.reduce((u,{length:p})=>Math.max(u,p),0),nullCount:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,void 0,o],n)}visitUnion(e){let{["type"]:r,["offset"]:i=0,["children"]:n=[]}=e,o=Zi(r.ArrayType,e.typeIds),{["length"]:s=o.length,["nullCount"]:a=-1}=e;if(or.isSparseUnion(r))return new Ji(r,i,s,a,[void 0,void 0,void 0,o],n);let u=_b(e.valueOffsets);return new Ji(r,i,s,a,[u,void 0,void 0,o],n)}visitDictionary(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.indices.ArrayType,e.data),{["dictionary"]:s=new Or([new t().visit({type:r.dictionary})])}=e,{["length"]:a=o.length,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[void 0,o,n],[],s)}visitInterval(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitDuration(e){let{["type"]:r,["offset"]:i=0}=e,n=ii(e.nullBitmap),o=Zi(r.ArrayType,e.data),{["length"]:s=o.length,["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,o,n])}visitFixedSizeList(e){let{["type"]:r,["offset"]:i=0,["child"]:n=new t().visit({type:r.valueType})}=e,o=ii(e.nullBitmap),{["length"]:s=n.length/kh(r),["nullCount"]:a=e.nullBitmap?-1:0}=e;return new Ji(r,i,s,a,[void 0,void 0,o],[n])}visitMap(e){let{["type"]:r,["offset"]:i=0,["child"]:n=new t().visit({type:r.childType})}=e,o=ii(e.nullBitmap),s=_b(e.valueOffsets),{["length"]:a=s.length-1,["nullCount"]:u=e.nullBitmap?-1:0}=e;return new Ji(r,i,a,u,[s,void 0,o],[n])}},Iqe=new jQ;function Dr(t){return Iqe.visit(t)}var c6=class{constructor(e=0,r){this.numChunks=e,this.getChunkIterator=r,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function Wxe(t){return t.some(e=>e.nullable)}function cF(t){return t.reduce((e,r)=>e+r.nullCount,0)}function uF(t){return t.reduce((e,r,i)=>(e[i+1]=e[i]+r.length,e),new Uint32Array(t.length+1))}function hF(t,e,r,i){let n=[];for(let o=-1,s=t.length;++o<s;){let a=t[o],u=e[o],{length:p}=a;if(u>=i)break;if(r>=u+p)continue;if(u>=r&&u+p<=i){n.push(a);continue}let m=Math.max(0,r-u),x=Math.min(i-u,p);n.push(a.slice(m,x-m))}return n.length===0&&n.push(t[0].slice(0,0)),n}function $Q(t,e,r,i){let n=0,o=0,s=e.length-1;do{if(n>=s-1)return r<e[s]?i(t,n,r-e[n]):null;o=n+Math.trunc((s-n)*.5),r<e[o]?s=o:n=o}while(n<s)}function u6(t,e){return t.getValid(e)}function sS(t){function e(r,i,n){return t(r[i],n)}return function(r){let i=this.data;return $Q(i,this._offsets,r,e)}}function dF(t){let e;function r(i,n,o){return t(i[n],o,e)}return function(i,n){let o=this.data;e=n;let s=$Q(o,this._offsets,i,r);return e=void 0,s}}function fF(t){let e;function r(i,n,o){let s=o,a=0,u=0;for(let p=n-1,m=i.length;++p<m;){let x=i[p];if(~(a=t(x,e,s)))return u+a;s=0,u+=x.length}return-1}return function(i,n){e=i;let o=this.data,s=typeof n!="number"?r(o,0,0):$Q(o,this._offsets,n,r);return e=void 0,s}}var Yr=class extends Hr{};function kqe(t,e){return e===null&&t.length>0?0:-1}function Rqe(t,e){let{nullBitmap:r}=t;if(!r||t.nullCount<=0)return-1;let i=0;for(let n of new Sb(r,t.offset+(e||0),t.length,r,lF)){if(!n)return i;++i}return-1}function vi(t,e,r){if(e===void 0)return-1;if(e===null)switch(t.typeId){case Qe.Union:break;case Qe.Dictionary:break;default:return Rqe(t,r)}let i=Ta.getVisitFn(t),n=I_(e);for(let o=(r||0)-1,s=t.length;++o<s;)if(n(i(t,o)))return o;return-1}function Gxe(t,e,r){let i=Ta.getVisitFn(t),n=I_(e);for(let o=(r||0)-1,s=t.length;++o<s;)if(n(i(t,o)))return o;return-1}Yr.prototype.visitNull=kqe;Yr.prototype.visitBool=vi;Yr.prototype.visitInt=vi;Yr.prototype.visitInt8=vi;Yr.prototype.visitInt16=vi;Yr.prototype.visitInt32=vi;Yr.prototype.visitInt64=vi;Yr.prototype.visitUint8=vi;Yr.prototype.visitUint16=vi;Yr.prototype.visitUint32=vi;Yr.prototype.visitUint64=vi;Yr.prototype.visitFloat=vi;Yr.prototype.visitFloat16=vi;Yr.prototype.visitFloat32=vi;Yr.prototype.visitFloat64=vi;Yr.prototype.visitUtf8=vi;Yr.prototype.visitLargeUtf8=vi;Yr.prototype.visitBinary=vi;Yr.prototype.visitLargeBinary=vi;Yr.prototype.visitFixedSizeBinary=vi;Yr.prototype.visitDate=vi;Yr.prototype.visitDateDay=vi;Yr.prototype.visitDateMillisecond=vi;Yr.prototype.visitTimestamp=vi;Yr.prototype.visitTimestampSecond=vi;Yr.prototype.visitTimestampMillisecond=vi;Yr.prototype.visitTimestampMicrosecond=vi;Yr.prototype.visitTimestampNanosecond=vi;Yr.prototype.visitTime=vi;Yr.prototype.visitTimeSecond=vi;Yr.prototype.visitTimeMillisecond=vi;Yr.prototype.visitTimeMicrosecond=vi;Yr.prototype.visitTimeNanosecond=vi;Yr.prototype.visitDecimal=vi;Yr.prototype.visitList=vi;Yr.prototype.visitStruct=vi;Yr.prototype.visitUnion=vi;Yr.prototype.visitDenseUnion=Gxe;Yr.prototype.visitSparseUnion=Gxe;Yr.prototype.visitDictionary=vi;Yr.prototype.visitInterval=vi;Yr.prototype.visitIntervalDayTime=vi;Yr.prototype.visitIntervalYearMonth=vi;Yr.prototype.visitIntervalMonthDayNano=vi;Yr.prototype.visitDuration=vi;Yr.prototype.visitDurationSecond=vi;Yr.prototype.visitDurationMillisecond=vi;Yr.prototype.visitDurationMicrosecond=vi;Yr.prototype.visitDurationNanosecond=vi;Yr.prototype.visitFixedSizeList=vi;Yr.prototype.visitMap=vi;var Eb=new Yr;var Xr=class extends Hr{};function li(t){let{type:e}=t;if(t.nullCount===0&&t.stride===1&&(or.isInt(e)&&e.bitWidth!==64||or.isTime(e)&&e.bitWidth!==64||or.isFloat(e)&&e.precision!==Dn.HALF))return new c6(t.data.length,i=>{let n=t.data[i];return n.values.subarray(0,n.length)[Symbol.iterator]()});let r=0;return new c6(t.data.length,i=>{let o=t.data[i].length,s=t.slice(r,r+o);return r+=o,new WQ(s)})}var WQ=class{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};Xr.prototype.visitNull=li;Xr.prototype.visitBool=li;Xr.prototype.visitInt=li;Xr.prototype.visitInt8=li;Xr.prototype.visitInt16=li;Xr.prototype.visitInt32=li;Xr.prototype.visitInt64=li;Xr.prototype.visitUint8=li;Xr.prototype.visitUint16=li;Xr.prototype.visitUint32=li;Xr.prototype.visitUint64=li;Xr.prototype.visitFloat=li;Xr.prototype.visitFloat16=li;Xr.prototype.visitFloat32=li;Xr.prototype.visitFloat64=li;Xr.prototype.visitUtf8=li;Xr.prototype.visitLargeUtf8=li;Xr.prototype.visitBinary=li;Xr.prototype.visitLargeBinary=li;Xr.prototype.visitFixedSizeBinary=li;Xr.prototype.visitDate=li;Xr.prototype.visitDateDay=li;Xr.prototype.visitDateMillisecond=li;Xr.prototype.visitTimestamp=li;Xr.prototype.visitTimestampSecond=li;Xr.prototype.visitTimestampMillisecond=li;Xr.prototype.visitTimestampMicrosecond=li;Xr.prototype.visitTimestampNanosecond=li;Xr.prototype.visitTime=li;Xr.prototype.visitTimeSecond=li;Xr.prototype.visitTimeMillisecond=li;Xr.prototype.visitTimeMicrosecond=li;Xr.prototype.visitTimeNanosecond=li;Xr.prototype.visitDecimal=li;Xr.prototype.visitList=li;Xr.prototype.visitStruct=li;Xr.prototype.visitUnion=li;Xr.prototype.visitDenseUnion=li;Xr.prototype.visitSparseUnion=li;Xr.prototype.visitDictionary=li;Xr.prototype.visitInterval=li;Xr.prototype.visitIntervalDayTime=li;Xr.prototype.visitIntervalYearMonth=li;Xr.prototype.visitIntervalMonthDayNano=li;Xr.prototype.visitDuration=li;Xr.prototype.visitDurationSecond=li;Xr.prototype.visitDurationMillisecond=li;Xr.prototype.visitDurationMicrosecond=li;Xr.prototype.visitDurationNanosecond=li;Xr.prototype.visitFixedSizeList=li;Xr.prototype.visitMap=li;var aS=new Xr;var Hxe,qxe={},Yxe={},Or=class t{constructor(e){var r,i,n;let o=e[0]instanceof t?e.flatMap(a=>a.data):e;if(o.length===0||o.some(a=>!(a instanceof Ji)))throw new TypeError("Vector constructor expects an Array of Data instances.");let s=(r=o[0])===null||r===void 0?void 0:r.type;switch(o.length){case 0:this._offsets=[0];break;case 1:{let{get:a,set:u,indexOf:p}=qxe[s.typeId],m=o[0];this.isValid=x=>u6(m,x),this.get=x=>a(m,x),this.set=(x,M)=>u(m,x,M),this.indexOf=x=>p(m,x),this._offsets=[0,m.length];break}default:Object.setPrototypeOf(this,Yxe[s.typeId]),this._offsets=uF(o);break}this.data=o,this.type=s,this.stride=kh(s),this.numChildren=(n=(i=s.children)===null||i===void 0?void 0:i.length)!==null&&n!==void 0?n:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((e,r)=>e+r.byteLength,0)}get nullable(){return Wxe(this.data)}get nullCount(){return cF(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Qe[this.type.typeId]}Vector`}isValid(e){return!1}get(e){return null}at(e){return this.get(wb(e,this.length))}set(e,r){}indexOf(e,r){return-1}includes(e,r){return this.indexOf(e,r)>-1}[Symbol.iterator](){return aS.visit(this)}concat(...e){return new t(this.data.concat(e.flatMap(r=>r.data).flat(Number.POSITIVE_INFINITY)))}slice(e,r){return new t(a6(this,e,r,({data:i,_offsets:n},o,s)=>hF(i,n,o,s)))}toJSON(){return[...this]}toArray(){let{type:e,data:r,length:i,stride:n,ArrayType:o}=this;switch(e.typeId){case Qe.Int:case Qe.Float:case Qe.Decimal:case Qe.Time:case Qe.Timestamp:switch(r.length){case 0:return new o;case 1:return r[0].values.subarray(0,i*n);default:return r.reduce((s,{values:a,length:u})=>(s.array.set(a.subarray(0,u*n),s.offset),s.offset+=u*n,s),{array:new o(i*n),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(e){var r;return this.getChildAt((r=this.type.children)===null||r===void 0?void 0:r.findIndex(i=>i.name===e))}getChildAt(e){return e>-1&&e<this.numChildren?new t(this.data.map(({children:r})=>r[e])):null}get isMemoized(){return or.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(or.isDictionary(this.type)){let e=new pF(this.data[0].dictionary),r=this.data.map(i=>{let n=i.clone();return n.dictionary=e,n});return new t(r)}return new pF(this)}unmemoize(){if(or.isDictionary(this.type)&&this.isMemoized){let e=this.data[0].dictionary.unmemoize(),r=this.data.map(i=>{let n=i.clone();return n.dictionary=e,n});return new t(r)}return this}};Hxe=Symbol.toStringTag;Or[Hxe]=(t=>{t.type=or.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;let e=Object.keys(Qe).map(r=>Qe[r]).filter(r=>typeof r=="number"&&r!==Qe.NONE);for(let r of e){let i=Ta.getVisitFnByTypeId(r),n=Bl.getVisitFnByTypeId(r),o=Eb.getVisitFnByTypeId(r);qxe[r]={get:i,set:n,indexOf:o},Yxe[r]=Object.create(t,{isValid:{value:sS(u6)},get:{value:sS(Ta.getVisitFnByTypeId(r))},set:{value:dF(Bl.getVisitFnByTypeId(r))},indexOf:{value:fF(Eb.getVisitFnByTypeId(r))}})}return"Vector"})(Or.prototype);var pF=class t extends Or{constructor(e){super(e.data);let r=this.get,i=this.set,n=this.slice,o=new Array(this.length);Object.defineProperty(this,"get",{value(s){let a=o[s];if(a!==void 0)return a;let u=r.call(this,s);return o[s]=u,u}}),Object.defineProperty(this,"set",{value(s,a){i.call(this,s,a),o[s]=a}}),Object.defineProperty(this,"slice",{value:(s,a)=>new t(n.call(this,s,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Or(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function Xxe(t){if(!t||t.length<=0)return function(n){return!0};let e="",r=t.filter(i=>i===i);return r.length>0&&(e=`
    switch (x) {${r.map(i=>`
        case ${Oqe(i)}:`).join("")}
            return false;
    }`),t.length!==r.length&&(e=`if (x !== x) return false;
${e}`),new Function("x",`${e}
return true;`)}function Oqe(t){return typeof t!="bigint"?tp(t):`${tp(t)}n`}function GQ(t,e){let r=Math.ceil(t)*e-1;return(r-r%64+64||64)/e}function Zxe(t,e=0){return t.length>=e?t.subarray(0,e):NP(new t.constructor(e),t,0)}var op=class{constructor(e,r=0,i=1){this.length=Math.ceil(r/i),this.buffer=new e(this.length),this.stride=i,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,r){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;let r=this.stride,i=this.length*r,n=this.buffer.length;i>=n&&this._resize(n===0?GQ(i*1,this.BYTES_PER_ELEMENT):GQ(i*2,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=GQ(e*this.stride,this.BYTES_PER_ELEMENT);let r=Zxe(this.buffer,e);return this.clear(),r}clear(){return this.length=0,this.buffer=new this.ArrayType,this}_resize(e){return this.buffer=Zxe(this.buffer,e)}},Lg=class extends op{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,r){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=r,this}},lS=class extends Lg{constructor(){super(Uint8Array,0,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,r){let{buffer:i}=this.reserve(e-this.length+1),n=e>>3,o=e%8,s=i[n]>>o&1;return r?s===0&&(i[n]|=1<<o,++this.numValid):s===1&&(i[n]&=~(1<<o),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},cS=class extends Lg{constructor(e){super(e.OffsetArrayType,1,1)}append(e){return this.set(this.length-1,e)}set(e,r){let i=this.length-1,n=this.reserve(e-i+1).buffer;return i<e++&&i>=0&&n.fill(n[i],i,e),n[e]=n[e-1]+r,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0),super.flush(e+1)}};var Qo=class{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}constructor({type:e,nullValues:r}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=r,this.stride=kh(e),this._nulls=new lS,r&&r.length>0&&(this._isValid=Xxe(r))}toVector(){return new Or([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0,{_offsets:r,_values:i,_nulls:n,_typeIds:o,children:s}=this;return r&&(e+=r.byteLength),i&&(e+=i.byteLength),n&&(e+=n.byteLength),o&&(e+=o.byteLength),s.reduce((a,u)=>a+u.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((r,i)=>r+i.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,r){return this.setValid(e,this.isValid(r))&&this.setValue(e,r),this}setValue(e,r){this._setValue(this,e,r)}setValid(e,r){return this.length=this._nulls.set(e,+r).length,r}addChild(e,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){let e,r,i,n,{type:o,length:s,nullCount:a,_typeIds:u,_offsets:p,_values:m,_nulls:x}=this;(r=u?.flush(s))?n=p?.flush(s):(n=p?.flush(s))?e=m?.flush(p.last()):e=m?.flush(s),a>0&&(i=x?.flush(s));let M=this.children.map(k=>k.flush());return this.clear(),Dr({type:o,length:s,nullCount:a,children:M,child:M[0],data:e,typeIds:r,nullBitmap:i,valueOffsets:n})}finish(){this.finished=!0;for(let e of this.children)e.finish();return this}clear(){var e,r,i,n;this.length=0,(e=this._nulls)===null||e===void 0||e.clear(),(r=this._values)===null||r===void 0||r.clear(),(i=this._offsets)===null||i===void 0||i.clear(),(n=this._typeIds)===null||n===void 0||n.clear();for(let o of this.children)o.clear();return this}};Qo.prototype.length=1;Qo.prototype.stride=1;Qo.prototype.children=null;Qo.prototype.finished=!1;Qo.prototype.nullValues=null;Qo.prototype._isValid=()=>!0;var Ma=class extends Qo{constructor(e){super(e),this._values=new Lg(this.ArrayType,0,this.stride)}setValue(e,r){let i=this._values;return i.reserve(e-i.length+1),super.setValue(e,r)}},Du=class extends Qo{constructor(e){super(e),this._pendingLength=0,this._offsets=new cS(e.type)}setValue(e,r){let i=this._pending||(this._pending=new Map),n=i.get(e);n&&(this._pendingLength-=n.length),this._pendingLength+=r instanceof L0?r[P_].length:r.length,i.set(e,r)}setValid(e,r){return super.setValid(e,r)?!0:((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let e=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,r),this}};var Cb=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,r,i,n){return e.prep(8,24),e.writeInt64(BigInt(n??0)),e.pad(4),e.writeInt32(i),e.writeInt64(BigInt(r??0)),e.offset()}};var Rh=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsFooter(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}version(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Un.V1}schema(e){let r=this.bb.__offset(this.bb_pos,6);return r?(e||new Pu).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dictionaries(e,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new Cb).__init(this.bb.__vector(this.bb_pos+i)+e*24,this.bb):null}dictionariesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,r){let i=this.bb.__offset(this.bb_pos,10);return i?(r||new Cb).__init(this.bb.__vector(this.bb_pos+i)+e*24,this.bb):null}recordBatchesLength(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,r){let i=this.bb.__offset(this.bb_pos,12);return i?(r||new Xa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,r){e.addFieldInt16(0,r,Un.V1)}static addSchema(e,r){e.addFieldOffset(1,r,0)}static addDictionaries(e,r){e.addFieldOffset(2,r,0)}static startDictionariesVector(e,r){e.startVector(24,r,8)}static addRecordBatches(e,r){e.addFieldOffset(3,r,0)}static startRecordBatchesVector(e,r){e.startVector(24,r,8)}static addCustomMetadata(e,r){e.addFieldOffset(4,r,0)}static createCustomMetadataVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addOffset(r[i]);return e.endVector()}static startCustomMetadataVector(e,r){e.startVector(4,r,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,r){e.finish(r)}static finishSizePrefixedFooterBuffer(e,r){e.finish(r,void 0,!0)}};var Ln=class t{constructor(e=[],r,i,n=Un.V5){this.fields=e||[],this.metadata=r||new Map,i||(i=HQ(this.fields)),this.dictionaries=i,this.metadataVersion=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(e=>e.name)}toString(){return`Schema<{ ${this.fields.map((e,r)=>`${r}: ${e}`).join(", ")} }>`}select(e){let r=new Set(e),i=this.fields.filter(n=>r.has(n.name));return new t(i,this.metadata)}selectAt(e){let r=e.map(i=>this.fields[i]).filter(Boolean);return new t(r,this.metadata)}assign(...e){let r=e[0]instanceof t?e[0]:Array.isArray(e[0])?new t(e[0]):new t(e),i=[...this.fields],n=mF(mF(new Map,this.metadata),r.metadata),o=r.fields.filter(a=>{let u=i.findIndex(p=>p.name===a.name);return~u?(i[u]=a.clone({metadata:mF(mF(new Map,i[u].metadata),a.metadata)}))&&!1:!0}),s=HQ(o,new Map);return new t([...i,...o],n,new Map([...this.dictionaries,...s]))}};Ln.prototype.fields=null;Ln.prototype.metadata=null;Ln.prototype.dictionaries=null;var Mi=class t{static new(...e){let[r,i,n,o]=e;return e[0]&&typeof e[0]=="object"&&({name:r}=e[0],i===void 0&&(i=e[0].type),n===void 0&&(n=e[0].nullable),o===void 0&&(o=e[0].metadata)),new t(`${r}`,i,n,o)}constructor(e,r,i=!1,n){this.name=e,this.type=r,this.nullable=i,this.metadata=n||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...e){let[r,i,n,o]=e;return!e[0]||typeof e[0]!="object"?[r=this.name,i=this.type,n=this.nullable,o=this.metadata]=e:{name:r=this.name,type:i=this.type,nullable:n=this.nullable,metadata:o=this.metadata}=e[0],t.new(r,i,n,o)}};Mi.prototype.type=null;Mi.prototype.name=null;Mi.prototype.nullable=null;Mi.prototype.metadata=null;function mF(t,e){return new Map([...t||new Map,...e||new Map])}function HQ(t,e=new Map){for(let r=-1,i=t.length;++r<i;){let o=t[r].type;if(or.isDictionary(o)){if(!e.has(o.id))e.set(o.id,o.dictionary);else if(e.get(o.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&HQ(o.children,e)}return e}var Dqe=vb,Lqe=Ll,Bg=class{static decode(e){e=new Lqe(ii(e));let r=Rh.getRootAsFooter(e),i=Ln.decode(r.schema(),new Map,r.version());return new qQ(i,r)}static encode(e){let r=new Dqe,i=Ln.encode(r,e.schema);Rh.startRecordBatchesVector(r,e.numRecordBatches);for(let s of[...e.recordBatches()].slice().reverse())Fg.encode(r,s);let n=r.endVector();Rh.startDictionariesVector(r,e.numDictionaries);for(let s of[...e.dictionaryBatches()].slice().reverse())Fg.encode(r,s);let o=r.endVector();return Rh.startFooter(r),Rh.addSchema(r,i),Rh.addVersion(r,Un.V5),Rh.addRecordBatches(r,n),Rh.addDictionaries(r,o),Rh.finishFooterBuffer(r,Rh.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(e,r=Un.V5,i,n){this.schema=e,this.version=r,i&&(this._recordBatches=i),n&&(this._dictionaryBatches=n)}*recordBatches(){for(let e,r=-1,i=this.numRecordBatches;++r<i;)(e=this.getRecordBatch(r))&&(yield e)}*dictionaryBatches(){for(let e,r=-1,i=this.numDictionaries;++r<i;)(e=this.getDictionaryBatch(r))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}};var qQ=class extends Bg{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(e,r){super(e,r.version()),this._footer=r}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){let r=this._footer.recordBatches(e);if(r)return Fg.decode(r)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){let r=this._footer.dictionaries(e);if(r)return Fg.decode(r)}return null}},Fg=class t{static decode(e){return new t(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,r){let{metaDataLength:i}=r,n=BigInt(r.offset),o=BigInt(r.bodyLength);return Cb.createBlock(e,n,i,o)}constructor(e,r,i){this.metaDataLength=e,this.offset=Tn(i),this.bodyLength=Tn(r)}};var sp=class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,r){return this.bb_pos=e,this.bb=r,this}static getRootAsMessage(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,r){return e.setPosition(e.position()+4),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}version(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Un.V1}headerType(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):tn.NONE}header(e){let r=this.bb.__offset(this.bb_pos,8);return r?this.bb.__union(e,this.bb_pos+r):null}bodyLength(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}customMetadata(e,r){let i=this.bb.__offset(this.bb_pos,12);return i?(r||new Xa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,r){e.addFieldInt16(0,r,Un.V1)}static addHeaderType(e,r){e.addFieldInt8(1,r,tn.NONE)}static addHeader(e,r){e.addFieldOffset(2,r,0)}static addBodyLength(e,r){e.addFieldInt64(3,r,BigInt("0"))}static addCustomMetadata(e,r){e.addFieldOffset(4,r,0)}static createCustomMetadataVector(e,r){e.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)e.addOffset(r[i]);return e.endVector()}static startCustomMetadataVector(e,r){e.startVector(4,r,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,r){e.finish(r)}static finishSizePrefixedMessageBuffer(e,r){e.finish(r,void 0,!0)}static createMessage(e,r,i,n,o,s){return t.startMessage(e),t.addVersion(e,r),t.addHeaderType(e,i),t.addHeader(e,n),t.addBodyLength(e,o),t.addCustomMetadata(e,s),t.endMessage(e)}};var YQ=class extends Hr{visit(e,r){return e==null||r==null?void 0:super.visit(e,r)}visitNull(e,r){return HP.startNull(r),HP.endNull(r)}visitInt(e,r){return Jf.startInt(r),Jf.addBitWidth(r,e.bitWidth),Jf.addIsSigned(r,e.isSigned),Jf.endInt(r)}visitFloat(e,r){return S_.startFloatingPoint(r),S_.addPrecision(r,e.precision),S_.endFloatingPoint(r)}visitBinary(e,r){return VP.startBinary(r),VP.endBinary(r)}visitLargeBinary(e,r){return $P.startLargeBinary(r),$P.endLargeBinary(r)}visitBool(e,r){return jP.startBool(r),jP.endBool(r)}visitUtf8(e,r){return YP.startUtf8(r),YP.endUtf8(r)}visitLargeUtf8(e,r){return WP.startLargeUtf8(r),WP.endLargeUtf8(r)}visitDecimal(e,r){return R0.startDecimal(r),R0.addScale(r,e.scale),R0.addPrecision(r,e.precision),R0.addBitWidth(r,e.bitWidth),R0.endDecimal(r)}visitDate(e,r){return v_.startDate(r),v_.addUnit(r,e.unit),v_.endDate(r)}visitTime(e,r){return Rg.startTime(r),Rg.addUnit(r,e.unit),Rg.addBitWidth(r,e.bitWidth),Rg.endTime(r)}visitTimestamp(e,r){let i=e.timezone&&r.createString(e.timezone)||void 0;return Og.startTimestamp(r),Og.addUnit(r,e.unit),i!==void 0&&Og.addTimezone(r,i),Og.endTimestamp(r)}visitInterval(e,r){return T_.startInterval(r),T_.addUnit(r,e.unit),T_.endInterval(r)}visitDuration(e,r){return b_.startDuration(r),b_.addUnit(r,e.unit),b_.endDuration(r)}visitList(e,r){return GP.startList(r),GP.endList(r)}visitStruct(e,r){return qP.startStruct_(r),qP.endStruct_(r)}visitUnion(e,r){ep.startTypeIdsVector(r,e.typeIds.length);let i=ep.createTypeIdsVector(r,e.typeIds);return ep.startUnion(r),ep.addMode(r,e.mode),ep.addTypeIds(r,i),ep.endUnion(r)}visitDictionary(e,r){let i=this.visit(e.indices,r);return k0.startDictionaryEncoding(r),k0.addId(r,BigInt(e.id)),k0.addIsOrdered(r,e.isOrdered),i!==void 0&&k0.addIndexType(r,i),k0.endDictionaryEncoding(r)}visitFixedSizeBinary(e,r){return x_.startFixedSizeBinary(r),x_.addByteWidth(r,e.byteWidth),x_.endFixedSizeBinary(r)}visitFixedSizeList(e,r){return w_.startFixedSizeList(r),w_.addListSize(r,e.listSize),w_.endFixedSizeList(r)}visitMap(e,r){return M_.startMap(r),M_.addKeysSorted(r,e.keysSorted),M_.endMap(r)}},gF=new YQ;function ewe(t,e=new Map){return new Ln(Bqe(t,e),AF(t.metadata),e)}function XQ(t){return new Ca(t.count,rwe(t.columns),iwe(t.columns),null)}function twe(t){return new cc(XQ(t.data),t.id,t.isDelta)}function Bqe(t,e){return(t.fields||[]).filter(Boolean).map(r=>Mi.fromJSON(r,e))}function Kxe(t,e){return(t.children||[]).filter(Boolean).map(r=>Mi.fromJSON(r,e))}function rwe(t){return(t||[]).reduce((e,r)=>[...e,new Gd(r.count,Fqe(r.VALIDITY)),...rwe(r.children)],[])}function iwe(t,e=[]){for(let r=-1,i=(t||[]).length;++r<i;){let n=t[r];n.VALIDITY&&e.push(new Ea(e.length,n.VALIDITY.length)),n.TYPE_ID&&e.push(new Ea(e.length,n.TYPE_ID.length)),n.OFFSET&&e.push(new Ea(e.length,n.OFFSET.length)),n.DATA&&e.push(new Ea(e.length,n.DATA.length)),e=iwe(n.children,e)}return e}function Fqe(t){return(t||[]).reduce((e,r)=>e+ +(r===0),0)}function nwe(t,e){let r,i,n,o,s,a;return!e||!(o=t.dictionary)?(s=Jxe(t,Kxe(t,e)),n=new Mi(t.name,s,t.nullable,AF(t.metadata))):e.has(r=o.id)?(i=(i=o.indexType)?Qxe(i):new ip,a=new Ou(e.get(r),i,r,o.isOrdered),n=new Mi(t.name,a,t.nullable,AF(t.metadata))):(i=(i=o.indexType)?Qxe(i):new ip,e.set(r,s=Jxe(t,Kxe(t,e))),a=new Ou(s,i,r,o.isOrdered),n=new Mi(t.name,a,t.nullable,AF(t.metadata))),n||null}function AF(t=[]){return new Map(t.map(({key:e,value:r})=>[e,r]))}function Qxe(t){return new Fs(t.isSigned,t.bitWidth)}function Jxe(t,e){let r=t.type.name;switch(r){case"NONE":return new fl;case"null":return new fl;case"binary":return new Bd;case"largebinary":return new O0;case"utf8":return new Fd;case"largeutf8":return new D0;case"bool":return new Iu;case"list":return new Za((e||[])[0]);case"struct":return new so(e||[]);case"struct_":return new so(e||[])}switch(r){case"int":{let i=t.type;return new Fs(i.isSigned,i.bitWidth)}case"floatingpoint":{let i=t.type;return new pl(Dn[i.precision])}case"decimal":{let i=t.type;return new Nd(i.scale,i.precision,i.bitWidth)}case"date":{let i=t.type;return new zd(Bs[i.unit])}case"time":{let i=t.type;return new Ud(Br[i.unit],i.bitWidth)}case"timestamp":{let i=t.type;return new Vd(Br[i.unit],i.timezone)}case"interval":{let i=t.type;return new jd(Eo[i.unit])}case"duration":{let i=t.type;return new $d(Br[i.unit])}case"union":{let i=t.type,[n,...o]=(i.mode+"").toLowerCase(),s=n.toUpperCase()+o.join("");return new ku(bo[s],i.typeIds||[],e||[])}case"fixedsizebinary":{let i=t.type;return new Wd(i.byteWidth)}case"fixedsizelist":{let i=t.type;return new lc(i.listSize,(e||[])[0])}case"map":{let i=t.type;return new Ru((e||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var Nqe=vb,zqe=Ll,Lu=class t{static fromJSON(e,r){let i=new t(0,Un.V5,r);return i._createHeader=Uqe(e,r),i}static decode(e){e=new zqe(ii(e));let r=sp.getRootAsMessage(e),i=r.bodyLength(),n=r.version(),o=r.headerType(),s=new t(i,n,o);return s._createHeader=Vqe(r,o),s}static encode(e){let r=new Nqe,i=-1;return e.isSchema()?i=Ln.encode(r,e.header()):e.isRecordBatch()?i=Ca.encode(r,e.header()):e.isDictionaryBatch()&&(i=cc.encode(r,e.header())),sp.startMessage(r),sp.addVersion(r,Un.V5),sp.addHeader(r,i),sp.addHeaderType(r,e.headerType),sp.addBodyLength(r,BigInt(e.bodyLength)),sp.finishMessageBuffer(r,sp.endMessage(r)),r.asUint8Array()}static from(e,r=0){if(e instanceof Ln)return new t(0,Un.V5,tn.Schema,e);if(e instanceof Ca)return new t(r,Un.V5,tn.RecordBatch,e);if(e instanceof cc)return new t(r,Un.V5,tn.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get compression(){return this._compression}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===tn.Schema}isRecordBatch(){return this.headerType===tn.RecordBatch}isDictionaryBatch(){return this.headerType===tn.DictionaryBatch}constructor(e,r,i,n){this._version=r,this._headerType=i,this.body=new Uint8Array(0),this._compression=n?.compression,n&&(this._createHeader=()=>n),this._bodyLength=Tn(e)}},Ca=class{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}get compression(){return this._compression}constructor(e,r,i,n){this._nodes=r,this._buffers=i,this._length=Tn(e),this._compression=n}},cc=class{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,r,i=!1){this._data=e,this._isDelta=i,this._id=Tn(r)}},Ea=class{constructor(e,r){this.offset=Tn(e),this.length=Tn(r)}},Gd=class{constructor(e,r){this.length=Tn(e),this.nullCount=Tn(r)}},Pb=class{constructor(e,r=bb.BUFFER){this.type=e,this.method=r}};function Uqe(t,e){return(()=>{switch(e){case tn.Schema:return Ln.fromJSON(t);case tn.RecordBatch:return Ca.fromJSON(t);case tn.DictionaryBatch:return cc.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${tn[e]}, type: ${e} }`)})}function Vqe(t,e){return(()=>{switch(e){case tn.Schema:return Ln.decode(t.header(new Pu),new Map,t.version());case tn.RecordBatch:return Ca.decode(t.header(new Cu),t.version());case tn.DictionaryBatch:return cc.decode(t.header(new kg),t.version())}throw new Error(`Unrecognized Message type: { name: ${tn[e]}, type: ${e} }`)})}Mi.encode=Qqe;Mi.decode=Zqe;Mi.fromJSON=nwe;Ln.encode=Kqe;Ln.decode=jqe;Ln.fromJSON=ewe;Ca.encode=Jqe;Ca.decode=$qe;Ca.fromJSON=XQ;cc.encode=eYe;cc.decode=Wqe;cc.fromJSON=twe;Gd.encode=tYe;Gd.decode=Hqe;Ea.encode=rYe;Ea.decode=Gqe;Pb.encode=cwe;Pb.decode=lwe;function jqe(t,e=new Map,r=Un.V5){let i=Xqe(t,e);return new Ln(i,yF(t),e,r)}function $qe(t,e=Un.V5){return new Ca(t.length(),qqe(t),Yqe(t,e),lwe(t.compression()))}function Wqe(t,e=Un.V5){return new cc(Ca.decode(t.data(),e),t.id(),t.isDelta())}function Gqe(t){return new Ea(t.offset(),t.length())}function Hqe(t){return new Gd(t.length(),t.nullCount())}function qqe(t){let e=[];for(let r,i=-1,n=-1,o=t.nodesLength();++i<o;)(r=t.nodes(i))&&(e[++n]=Gd.decode(r));return e}function Yqe(t,e){let r=[];for(let i,n=-1,o=-1,s=t.buffersLength();++n<s;)(i=t.buffers(n))&&(e<Un.V4&&(i.bb_pos+=8*(n+1)),r[++o]=Ea.decode(i));return r}function Xqe(t,e){let r=[];for(let i,n=-1,o=-1,s=t.fieldsLength();++n<s;)(i=t.fields(n))&&(r[++o]=Mi.decode(i,e));return r}function owe(t,e){let r=[];for(let i,n=-1,o=-1,s=t.childrenLength();++n<s;)(i=t.children(n))&&(r[++o]=Mi.decode(i,e));return r}function Zqe(t,e){let r,i,n,o,s,a;return!e||!(a=t.dictionary())?(n=awe(t,owe(t,e)),i=new Mi(t.name(),n,t.nullable(),yF(t))):e.has(r=Tn(a.id()))?(o=(o=a.indexType())?swe(o):new ip,s=new Ou(e.get(r),o,r,a.isOrdered()),i=new Mi(t.name(),s,t.nullable(),yF(t))):(o=(o=a.indexType())?swe(o):new ip,e.set(r,n=awe(t,owe(t,e))),s=new Ou(n,o,r,a.isOrdered()),i=new Mi(t.name(),s,t.nullable(),yF(t))),i||null}function yF(t){let e=new Map;if(t)for(let r,i,n=-1,o=Math.trunc(t.customMetadataLength());++n<o;)(r=t.customMetadata(n))&&(i=r.key())!=null&&e.set(i,r.value());return e}function swe(t){return new Fs(t.isSigned(),t.bitWidth())}function awe(t,e){let r=t.typeType();switch(r){case xo.NONE:return new fl;case xo.Null:return new fl;case xo.Binary:return new Bd;case xo.LargeBinary:return new O0;case xo.Utf8:return new Fd;case xo.LargeUtf8:return new D0;case xo.Bool:return new Iu;case xo.List:return new Za((e||[])[0]);case xo.Struct_:return new so(e||[])}switch(r){case xo.Int:{let i=t.type(new Jf);return new Fs(i.isSigned(),i.bitWidth())}case xo.FloatingPoint:{let i=t.type(new S_);return new pl(i.precision())}case xo.Decimal:{let i=t.type(new R0);return new Nd(i.scale(),i.precision(),i.bitWidth())}case xo.Date:{let i=t.type(new v_);return new zd(i.unit())}case xo.Time:{let i=t.type(new Rg);return new Ud(i.unit(),i.bitWidth())}case xo.Timestamp:{let i=t.type(new Og);return new Vd(i.unit(),i.timezone())}case xo.Interval:{let i=t.type(new T_);return new jd(i.unit())}case xo.Duration:{let i=t.type(new b_);return new $d(i.unit())}case xo.Union:{let i=t.type(new ep);return new ku(i.mode(),i.typeIdsArray()||[],e||[])}case xo.FixedSizeBinary:{let i=t.type(new x_);return new Wd(i.byteWidth())}case xo.FixedSizeList:{let i=t.type(new w_);return new lc(i.listSize(),(e||[])[0])}case xo.Map:{let i=t.type(new M_);return new Ru((e||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${xo[r]}" (${r})`)}function lwe(t){return t?new Pb(t.codec(),t.method()):null}function Kqe(t,e){let r=e.fields.map(o=>Mi.encode(t,o));Pu.startFieldsVector(t,r.length);let i=Pu.createFieldsVector(t,r),n=e.metadata&&e.metadata.size>0?Pu.createCustomMetadataVector(t,[...e.metadata].map(([o,s])=>{let a=t.createString(`${o}`),u=t.createString(`${s}`);return Xa.startKeyValue(t),Xa.addKey(t,a),Xa.addValue(t,u),Xa.endKeyValue(t)})):-1;return Pu.startSchema(t),Pu.addFields(t,i),Pu.addEndianness(t,iYe?__.Little:__.Big),n!==-1&&Pu.addCustomMetadata(t,n),Pu.endSchema(t)}function Qqe(t,e){let r=-1,i=-1,n=-1,o=e.type,s=e.typeId;or.isDictionary(o)?(s=o.dictionary.typeId,n=gF.visit(o,t),i=gF.visit(o.dictionary,t)):i=gF.visit(o,t);let a=(o.children||[]).map(m=>Mi.encode(t,m)),u=ac.createChildrenVector(t,a),p=e.metadata&&e.metadata.size>0?ac.createCustomMetadataVector(t,[...e.metadata].map(([m,x])=>{let M=t.createString(`${m}`),k=t.createString(`${x}`);return Xa.startKeyValue(t),Xa.addKey(t,M),Xa.addValue(t,k),Xa.endKeyValue(t)})):-1;return e.name&&(r=t.createString(e.name)),ac.startField(t),ac.addType(t,i),ac.addTypeType(t,s),ac.addChildren(t,u),ac.addNullable(t,!!e.nullable),r!==-1&&ac.addName(t,r),n!==-1&&ac.addDictionary(t,n),p!==-1&&ac.addCustomMetadata(t,p),ac.endField(t)}function Jqe(t,e){let r=e.nodes||[],i=e.buffers||[];Cu.startNodesVector(t,r.length);for(let a of r.slice().reverse())Gd.encode(t,a);let n=t.endVector();Cu.startBuffersVector(t,i.length);for(let a of i.slice().reverse())Ea.encode(t,a);let o=t.endVector(),s=null;return e.compression!==null&&(s=cwe(t,e.compression)),Cu.startRecordBatch(t),Cu.addLength(t,BigInt(e.length)),Cu.addNodes(t,n),Cu.addBuffers(t,o),e.compression!==null&&s&&Cu.addCompression(t,s),Cu.endRecordBatch(t)}function cwe(t,e){return Ig.startBodyCompression(t),Ig.addCodec(t,e.type),Ig.addMethod(t,e.method),Ig.endBodyCompression(t)}function eYe(t,e){let r=Ca.encode(t,e.data);return kg.startDictionaryBatch(t),kg.addId(t,BigInt(e.id)),kg.addIsDelta(t,e.isDelta),kg.addData(t,r),kg.endDictionaryBatch(t)}function tYe(t,e){return K3.createFieldNode(t,BigInt(e.length),BigInt(e.nullCount))}function rYe(t,e){return Z3.createBuffer(t,BigInt(e.offset),BigInt(e.length))}var iYe=(()=>{let t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256})();var zo=Object.freeze({done:!0,value:void 0}),h6=class{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},Ib=class{tee(){return this._getDOMStream().tee()}pipe(e,r){return this._getNodeStream().pipe(e,r)}pipeTo(e,r){return this._getDOMStream().pipeTo(e,r)}pipeThrough(e,r){return this._getDOMStream().pipeThrough(e,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},_F=class extends Ib{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return Sr(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){let{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(zo);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return Dl.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return Dl.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return Sr(this,void 0,void 0,function*(){return yield this.abort(e),zo})}return(e){return Sr(this,void 0,void 0,function*(){return yield this.close(),zo})}read(e){return Sr(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return Sr(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,i)=>{this.resolvers.push({resolve:r,reject:i})}):Promise.resolve(zo)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var B0=class extends _F{write(e){if((e=ii(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?BP(this.toUint8Array(!0)):this.toUint8Array(!1).then(BP)}toUint8Array(e=!1){return e?Ih(this._values)[0]:Sr(this,void 0,void 0,function*(){var r,i,n,o;let s=[],a=0;try{for(var u=!0,p=If(this),m;m=yield p.next(),r=m.done,!r;u=!0){o=m.value,u=!1;let x=o;s.push(x),a+=x.byteLength}}catch(x){i={error:x}}finally{try{!u&&!r&&(n=p.return)&&(yield n.call(p))}finally{if(i)throw i.error}}return Ih(s,a)[0]})}},F0=class{constructor(e){e&&(this.source=new ZQ(Dl.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}},Hd=class t{constructor(e){e instanceof t?this.source=e.source:e instanceof B0?this.source=new Ng(Dl.fromAsyncIterable(e)):LB(e)?this.source=new Ng(Dl.fromNodeStream(e)):FP(e)?this.source=new Ng(Dl.fromDOMStream(e)):OB(e)?this.source=new Ng(Dl.fromDOMStream(e.body)):Zf(e)?this.source=new Ng(Dl.fromIterable(e)):Ph(e)?this.source=new Ng(Dl.fromAsyncIterable(e)):Dd(e)&&(this.source=new Ng(Dl.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}},ZQ=class{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,r="read"){return this.source.next({cmd:r,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||zo)}return(e){return Object.create(this.source.return&&this.source.return(e)||zo)}},Ng=class{constructor(e){this.source=e,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}cancel(e){return Sr(this,void 0,void 0,function*(){yield this.return(e)})}get closed(){return this._closedPromise}read(e){return Sr(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return Sr(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(e){return Sr(this,arguments,void 0,function*(r,i="read"){return yield this.source.next({cmd:i,size:r})})}throw(e){return Sr(this,void 0,void 0,function*(){let r=this.source.throw&&(yield this.source.throw(e))||zo;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}return(e){return Sr(this,void 0,void 0,function*(){let r=this.source.return&&(yield this.source.return(e))||zo;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}};var d6=class extends F0{constructor(e,r){super(),this.position=0,this.buffer=ii(e),this.size=r===void 0?this.buffer.byteLength:r}readInt32(e){let{buffer:r,byteOffset:i}=this.readAt(e,4);return new DataView(r,i).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){let{buffer:r,size:i,position:n}=this;return r&&n<i?(typeof e!="number"&&(e=Number.POSITIVE_INFINITY),this.position=Math.min(i,n+Math.min(i-n,e)),r.subarray(n,this.position)):null}readAt(e,r){let i=this.buffer,n=Math.min(this.size,e+r);return i?i.subarray(e,n):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}},k_=class extends Hd{constructor(e,r){super(),this.position=0,this._handle=e,typeof r=="number"?this.size=r:this._pending=Sr(this,void 0,void 0,function*(){this.size=(yield e.stat()).size,delete this._pending})}readInt32(e){return Sr(this,void 0,void 0,function*(){let{buffer:r,byteOffset:i}=yield this.readAt(e,4);return new DataView(r,i).getInt32(0,!0)})}seek(e){return Sr(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(e,this.size),e<this.size})}read(e){return Sr(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:r,size:i,position:n}=this;if(r&&n<i){typeof e!="number"&&(e=Number.POSITIVE_INFINITY);let o=n,s=0,a=0,u=Math.min(i,o+Math.min(i-o,e)),p=new Uint8Array(Math.max(0,(this.position=u)-o));for(;(o+=a)<u&&(s+=a)<p.byteLength;)({bytesRead:a}=yield r.read(p,s,p.byteLength-s,o));return p}return null})}readAt(e,r){return Sr(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:i,size:n}=this;if(i&&e+r<n){let o=Math.min(n,e+r),s=new Uint8Array(o-e);return(yield i.read(s,0,r,e)).buffer}return new Uint8Array(r)})}close(){return Sr(this,void 0,void 0,function*(){let e=this._handle;this._handle=null,e&&(yield e.close())})}throw(e){return Sr(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}return(e){return Sr(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}};var QQ={};nl(QQ,{BaseInt64:()=>f6,Int128:()=>p6,Int64:()=>zg,Uint64:()=>ys});function uS(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}var hS=8,KQ=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],f6=class{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([e.buffer[1]>>>16,e.buffer[1]&65535,e.buffer[0]>>>16,e.buffer[0]&65535]),n=r[3]*i[3];this.buffer[0]=n&65535;let o=n>>>16;return n=r[2]*i[3],o+=n,n=r[3]*i[2]>>>0,o+=n,this.buffer[0]+=o<<16,this.buffer[1]=o>>>0<n?65536:0,this.buffer[1]+=o>>>16,this.buffer[1]+=r[1]*i[3]+r[2]*i[2]+r[3]*i[1],this.buffer[1]+=r[0]*i[3]+r[1]*i[2]+r[2]*i[1]+r[3]*i[0]<<16,this}_plus(e){let r=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${uS(this.buffer[1])} ${uS(this.buffer[0])}`}},ys=class t extends f6{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,r=new Uint32Array(2)){return t.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(2)){return t.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(2)){let i=e.length,n=new t(r);for(let o=0;o<i;){let s=hS<i-o?hS:i-o,a=new t(new Uint32Array([Number.parseInt(e.slice(o,o+s),10),0])),u=new t(new Uint32Array([KQ[s],0]));n.times(u),n.plus(a),o+=s}return n}static convertArray(e){let r=new Uint32Array(e.length*2);for(let i=-1,n=e.length;++i<n;)t.from(e[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(e,r){return new t(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new t(new Uint32Array(e.buffer)).plus(r)}},zg=class t extends f6{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){let r=this.buffer[1]<<0,i=e.buffer[1]<<0;return r<i||r===i&&this.buffer[0]<e.buffer[0]}static from(e,r=new Uint32Array(2)){return t.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(2)){return t.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(2)){let i=e.startsWith("-"),n=e.length,o=new t(r);for(let s=i?1:0;s<n;){let a=hS<n-s?hS:n-s,u=new t(new Uint32Array([Number.parseInt(e.slice(s,s+a),10),0])),p=new t(new Uint32Array([KQ[a],0]));o.times(p),o.plus(u),s+=a}return i?o.negate():o}static convertArray(e){let r=new Uint32Array(e.length*2);for(let i=-1,n=e.length;++i<n;)t.from(e[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(e,r){return new t(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new t(new Uint32Array(e.buffer)).plus(r)}},p6=class t{constructor(e){this.buffer=e}high(){return new zg(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new zg(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(e){let r=new ys(new Uint32Array([this.buffer[3],0])),i=new ys(new Uint32Array([this.buffer[2],0])),n=new ys(new Uint32Array([this.buffer[1],0])),o=new ys(new Uint32Array([this.buffer[0],0])),s=new ys(new Uint32Array([e.buffer[3],0])),a=new ys(new Uint32Array([e.buffer[2],0])),u=new ys(new Uint32Array([e.buffer[1],0])),p=new ys(new Uint32Array([e.buffer[0],0])),m=ys.multiply(o,p);this.buffer[0]=m.low();let x=new ys(new Uint32Array([m.high(),0]));return m=ys.multiply(n,p),x.plus(m),m=ys.multiply(o,u),x.plus(m),this.buffer[1]=x.low(),this.buffer[3]=x.lessThan(m)?1:0,this.buffer[2]=x.high(),new ys(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(ys.multiply(i,p)).plus(ys.multiply(n,u)).plus(ys.multiply(o,a)),this.buffer[3]+=ys.multiply(r,p).plus(ys.multiply(i,u)).plus(ys.multiply(n,a)).plus(ys.multiply(o,s)).low(),this}plus(e){let r=new Uint32Array(4);return r[3]=this.buffer[3]+e.buffer[3]>>>0,r[2]=this.buffer[2]+e.buffer[2]>>>0,r[1]=this.buffer[1]+e.buffer[1]>>>0,r[0]=this.buffer[0]+e.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${uS(this.buffer[3])} ${uS(this.buffer[2])} ${uS(this.buffer[1])} ${uS(this.buffer[0])}`}static multiply(e,r){return new t(new Uint32Array(e.buffer)).times(r)}static add(e,r){return new t(new Uint32Array(e.buffer)).plus(r)}static from(e,r=new Uint32Array(4)){return t.fromString(typeof e=="string"?e:e.toString(),r)}static fromNumber(e,r=new Uint32Array(4)){return t.fromString(e.toString(),r)}static fromString(e,r=new Uint32Array(4)){let i=e.startsWith("-"),n=e.length,o=new t(r);for(let s=i?1:0;s<n;){let a=hS<n-s?hS:n-s,u=new t(new Uint32Array([Number.parseInt(e.slice(s,s+a),10),0,0,0])),p=new t(new Uint32Array([KQ[a],0,0,0]));o.times(p),o.plus(u),s+=a}return i?o.negate():o}static convertArray(e){let r=new Uint32Array(e.length*4);for(let i=-1,n=e.length;++i<n;)t.from(e[i],new Uint32Array(r.buffer,r.byteOffset+16*i,4));return r}};var tJ={};nl(tJ,{toIntervalDayTimeInt32Array:()=>JQ,toIntervalDayTimeObjects:()=>nYe,toIntervalMonthDayNanoInt32Array:()=>eJ,toIntervalMonthDayNanoObjects:()=>oYe});function JQ(t){var e,r;let i=t.length,n=new Int32Array(i*2);for(let o=0,s=0;o<i;o++){let a=t[o];n[s++]=(e=a.days)!==null&&e!==void 0?e:0,n[s++]=(r=a.milliseconds)!==null&&r!==void 0?r:0}return n}function eJ(t){var e,r;let i=t.length,n=new Int32Array(i*4);for(let o=0,s=0;o<i;o++){let a=t[o];n[s++]=(e=a.months)!==null&&e!==void 0?e:0,n[s++]=(r=a.days)!==null&&r!==void 0?r:0;let u=a.nanoseconds;u?(n[s++]=Number(BigInt(u)&BigInt(4294967295)),n[s++]=Number(BigInt(u)>>BigInt(32))):s+=2}return n}function nYe(t){let e=t.length,r=new Array(e/2);for(let i=0,n=0;i<e;i+=2)r[n++]={days:t[i],milliseconds:t[i+1]};return r}function oYe(t,e){let r=t.length,i=new Array(r/4);for(let n=0,o=0;n<r;n+=4){let s=BigInt(t[n+3])<<BigInt(32)|BigInt(t[n+2]>>>0);i[o++]={months:t[n],days:t[n+1],nanoseconds:e?`${s}`:s}}return i}var dS=class extends Hr{constructor(e,r,i,n,o=Un.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=r,this.buffers=i,this.dictionaries=n,this.metadataVersion=o}visit(e){return super.visit(e instanceof Mi?e.type:e)}visitNull(e,{length:r}=this.nextFieldNode()){return Dr({type:e,length:r})}visitBool(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitInt(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitFloat(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitUtf8(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeUtf8(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitBinary(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeBinary(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitFixedSizeBinary(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDate(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitTimestamp(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitTime(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDecimal(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitList(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}visitStruct(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),children:this.visitMany(e.children)})}visitUnion(e,{length:r,nullCount:i}=this.nextFieldNode()){return this.metadataVersion<Un.V5&&this.readNullBitmap(e,i),e.mode===bo.Sparse?this.visitSparseUnion(e,{length:r,nullCount:i}):this.visitDenseUnion(e,{length:r,nullCount:i})}visitDenseUnion(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,typeIds:this.readTypeIds(e),valueOffsets:this.readOffsets(e),children:this.visitMany(e.children)})}visitSparseUnion(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,typeIds:this.readTypeIds(e),children:this.visitMany(e.children)})}visitDictionary(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e.indices),dictionary:this.readDictionary(e)})}visitInterval(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDuration(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitFixedSizeList(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),child:this.visit(e.children[0])})}visitMap(e,{length:r,nullCount:i}=this.nextFieldNode()){return Dr({type:e,length:r,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,r,i=this.nextBufferRange()){return r>0&&this.readData(e,i)||new Uint8Array(0)}readOffsets(e,r){return this.readData(e,r)}readTypeIds(e,r){return this.readData(e,r)}readData(e,{length:r,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+r)}readDictionary(e){return this.dictionaries.get(e.id)}},vF=class extends dS{constructor(e,r,i,n,o){super(new Uint8Array(0),r,i,n,o),this.sources=e}readNullBitmap(e,r,{offset:i}=this.nextBufferRange()){return r<=0?new Uint8Array(0):Mb(this.sources[i])}readOffsets(e,{offset:r}=this.nextBufferRange()){return Zi(Uint8Array,Zi(e.OffsetArrayType,this.sources[r]))}readTypeIds(e,{offset:r}=this.nextBufferRange()){return Zi(Uint8Array,Zi(e.ArrayType,this.sources[r]))}readData(e,{offset:r}=this.nextBufferRange()){let{sources:i}=this;if(or.isTimestamp(e))return Zi(Uint8Array,zg.convertArray(i[r]));if((or.isInt(e)||or.isTime(e))&&e.bitWidth===64||or.isDuration(e))return Zi(Uint8Array,zg.convertArray(i[r]));if(or.isDate(e)&&e.unit===Bs.MILLISECOND)return Zi(Uint8Array,zg.convertArray(i[r]));if(or.isDecimal(e))return Zi(Uint8Array,p6.convertArray(i[r]));if(or.isBinary(e)||or.isLargeBinary(e)||or.isFixedSizeBinary(e))return sYe(i[r]);if(or.isBool(e))return Mb(i[r]);if(or.isUtf8(e)||or.isLargeUtf8(e))return C0(i[r].join(""));if(or.isInterval(e))switch(e.unit){case Eo.DAY_TIME:return JQ(i[r]);case Eo.MONTH_DAY_NANO:return eJ(i[r]);default:break}return Zi(Uint8Array,Zi(e.ArrayType,i[r].map(n=>+n)))}};function sYe(t){let e=t.join(""),r=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)r[i>>1]=Number.parseInt(e.slice(i,i+2),16);return r}var bF=class extends dS{constructor(e,r,i,n,o){super(new Uint8Array(0),r,i,n,o),this.bodyChunks=e}readData(e,r=this.nextBufferRange()){return this.bodyChunks[this.buffersIndex]}};var kb=class extends Du{constructor(e){super(e),this._values=new op(Uint8Array)}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,ii(r))}_flushPending(e,r){let i=this._offsets,n=this._values.reserve(r).buffer,o=0;for(let[s,a]of e)if(a===void 0)i.set(s,0);else{let u=a.length;n.set(a,o),i.set(s,u),o+=u}}};var Rb=class extends Du{constructor(e){super(e),this._values=new op(Uint8Array)}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,ii(r))}_flushPending(e,r){let i=this._offsets,n=this._values.reserve(r).buffer,o=0;for(let[s,a]of e)if(a===void 0)i.set(s,BigInt(0));else{let u=a.length;n.set(a,o),i.set(s,BigInt(u)),o+=u}}};var R_=class extends Qo{constructor(e){super(e),this._values=new lS}setValue(e,r){this._values.set(e,+r)}};var O_=class extends Ma{};O_.prototype._setValue=PQ;var fS=class extends O_{};fS.prototype._setValue=$B;var pS=class extends O_{};pS.prototype._setValue=WB;var mS=class extends Ma{};mS.prototype._setValue=RQ;var m6=class extends Qo{constructor({type:e,nullValues:r,dictionaryHashFunction:i}){super({type:new Ou(e.dictionary,e.indices,e.id,e.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Ob({type:this.type.indices,nullValues:r}),this.dictionary=Ob({type:this.type.dictionary,nullValues:null}),typeof i=="function"&&(this.valueToKey=i)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,r){let i=this.indices;return r=i.setValid(e,r),this.length=i.length,r}setValue(e,r){let i=this._keysToIndices,n=this.valueToKey(r),o=i[n];return o===void 0&&(i[n]=o=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(e,o)}flush(){let e=this.type,r=this._dictionary,i=this.dictionary.toVector(),n=this.indices.flush().clone(e);return n.dictionary=r?r.concat(i):i,this.finished||(this._dictionaryOffset+=i.length),this._dictionary=n.dictionary,this.clear(),n}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return typeof e=="string"?e:`${e}`}};var gS=class extends Ma{};gS.prototype._setValue=CQ;var g6=class extends Qo{setValue(e,r){let[i]=this.children,n=e*this.stride;for(let o=-1,s=this.stride;++o<s;)i.set(n+o,r[o])}setValid(e,r){return super.setValid(e,r)||this.children[0].setValid((e+1)*this.stride-1,!1),r}addChild(e,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let i=this.children.push(e);return this.type=new lc(this.type.listSize,new Mi(r,e.type,!0)),i}};var D_=class extends Ma{setValue(e,r){this._values.set(e,r)}},A6=class extends D_{setValue(e,r){super.setValue(e,s6(r))}},y6=class extends D_{},_6=class extends D_{};var Ug=class extends Ma{};Ug.prototype._setValue=OQ;var AS=class extends Ug{};AS.prototype._setValue=JB;var yS=class extends Ug{};yS.prototype._setValue=eF;var _S=class extends Ug{};_S.prototype._setValue=tF;var N0=class extends Ma{};N0.prototype._setValue=DQ;var vS=class extends N0{};vS.prototype._setValue=rF;var bS=class extends N0{};bS.prototype._setValue=iF;var xS=class extends N0{};xS.prototype._setValue=nF;var wS=class extends N0{};wS.prototype._setValue=oF;var Oh=class extends Ma{setValue(e,r){this._values.set(e,r)}},v6=class extends Oh{},b6=class extends Oh{},x6=class extends Oh{},w6=class extends Oh{},S6=class extends Oh{},T6=class extends Oh{},M6=class extends Oh{},E6=class extends Oh{};var C6=class extends Du{constructor(e){super(e),this._offsets=new cS(e.type)}addChild(e,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new Za(new Mi(r,e.type,!0)),this.numChildren-1}_flushPending(e){let r=this._offsets,[i]=this.children;for(let[n,o]of e)if(typeof o>"u")r.set(n,0);else{let s=o,a=s.length,u=r.set(n,a).buffer[n];for(let p=-1;++p<a;)i.set(u+p,s[p])}}};var P6=class extends Du{set(e,r){return super.set(e,r)}setValue(e,r){let i=r instanceof Map?r:new Map(Object.entries(r)),n=this._pending||(this._pending=new Map),o=n.get(e);o&&(this._pendingLength-=o.size),this._pendingLength+=i.size,n.set(e,i)}addChild(e,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new Ru(new Mi(r,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){let r=this._offsets,[i]=this.children;for(let[n,o]of e)if(o===void 0)r.set(n,0);else{let{[n]:s,[n+1]:a}=r.set(n,o.size).buffer;for(let u of o.entries())if(i.set(s,u),++s>=a)break}}};var I6=class extends Qo{setValue(e,r){}setValid(e,r){return this.length=Math.max(e+1,this.length),r}};var k6=class extends Qo{setValue(e,r){let{children:i,type:n}=this;switch(Array.isArray(r)||r.constructor){case!0:return n.children.forEach((o,s)=>i[s].set(e,r[s]));case Map:return n.children.forEach((o,s)=>i[s].set(e,r.get(o.name)));default:return n.children.forEach((o,s)=>i[s].set(e,r[o.name]))}}setValid(e,r){return super.setValid(e,r)||this.children.forEach(i=>i.setValid(e,r)),r}addChild(e,r=`${this.numChildren}`){let i=this.children.push(e);return this.type=new so([...this.type.children,new Mi(r,e.type,!0)]),i}};var z0=class extends Ma{};z0.prototype._setValue=IQ;var SS=class extends z0{};SS.prototype._setValue=GB;var TS=class extends z0{};TS.prototype._setValue=HB;var MS=class extends z0{};MS.prototype._setValue=qB;var ES=class extends z0{};ES.prototype._setValue=YB;var U0=class extends Ma{};U0.prototype._setValue=kQ;var CS=class extends U0{};CS.prototype._setValue=XB;var PS=class extends U0{};PS.prototype._setValue=ZB;var IS=class extends U0{};IS.prototype._setValue=KB;var kS=class extends U0{};kS.prototype._setValue=QB;var Db=class extends Qo{constructor(e){super(e),this._typeIds=new Lg(Int8Array,0,1),typeof e.valueToChildTypeId=="function"&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,r){return this.set(this.length,e,r)}set(e,r,i){return i===void 0&&(i=this._valueToChildTypeId(this,r,e)),this.setValue(e,r,i),this}setValue(e,r,i){this._typeIds.set(e,i);let n=this.type.typeIdToChildIndex[i],o=this.children[n];o?.set(e,r),this.length=Math.max(e+1,this.length)}addChild(e,r=`${this.children.length}`){let i=this.children.push(e),{type:{children:n,mode:o,typeIds:s}}=this,a=[...n,new Mi(r,e.type)];return this.type=new ku(o,[...s,i],a),i}_valueToChildTypeId(e,r,i){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},R6=class extends Db{},O6=class extends Db{constructor(e){super(e),this._offsets=new Lg(Int32Array)}setValue(e,r,i){let n=this._typeIds.set(e,i).buffer[e],o=this.getChildAt(this.type.typeIdToChildIndex[n]),s=this._offsets.set(e,o.length).buffer[e];o?.set(s,r),this.length=Math.max(e+1,this.length)}};var RS=class extends Du{constructor(e){super(e),this._values=new op(Uint8Array)}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,C0(r))}_flushPending(e,r){}};RS.prototype._flushPending=kb.prototype._flushPending;var OS=class extends Du{constructor(e){super(e),this._values=new op(Uint8Array)}get byteLength(){let e=this._pendingLength+this.length*4;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,r){return super.setValue(e,C0(r))}_flushPending(e,r){}};OS.prototype._flushPending=Rb.prototype._flushPending;var rJ=class extends Hr{visitNull(){return I6}visitBool(){return R_}visitInt(){return Oh}visitInt8(){return v6}visitInt16(){return b6}visitInt32(){return x6}visitInt64(){return w6}visitUint8(){return S6}visitUint16(){return T6}visitUint32(){return M6}visitUint64(){return E6}visitFloat(){return D_}visitFloat16(){return A6}visitFloat32(){return y6}visitFloat64(){return _6}visitUtf8(){return RS}visitLargeUtf8(){return OS}visitBinary(){return kb}visitLargeBinary(){return Rb}visitFixedSizeBinary(){return gS}visitDate(){return O_}visitDateDay(){return fS}visitDateMillisecond(){return pS}visitTimestamp(){return z0}visitTimestampSecond(){return SS}visitTimestampMillisecond(){return TS}visitTimestampMicrosecond(){return MS}visitTimestampNanosecond(){return ES}visitTime(){return U0}visitTimeSecond(){return CS}visitTimeMillisecond(){return PS}visitTimeMicrosecond(){return IS}visitTimeNanosecond(){return kS}visitDecimal(){return mS}visitList(){return C6}visitStruct(){return k6}visitUnion(){return Db}visitDenseUnion(){return O6}visitSparseUnion(){return R6}visitDictionary(){return m6}visitInterval(){return Ug}visitIntervalDayTime(){return AS}visitIntervalYearMonth(){return yS}visitIntervalMonthDayNano(){return _S}visitDuration(){return N0}visitDurationSecond(){return vS}visitDurationMillisecond(){return bS}visitDurationMicrosecond(){return xS}visitDurationNanosecond(){return wS}visitFixedSizeList(){return g6}visitMap(){return P6}},hwe=new rJ;var Zr=class extends Hr{compareSchemas(e,r){return e===r||r instanceof e.constructor&&this.compareManyFields(e.fields,r.fields)}compareManyFields(e,r){return e===r||Array.isArray(e)&&Array.isArray(r)&&e.length===r.length&&e.every((i,n)=>this.compareFields(i,r[n]))}compareFields(e,r){return e===r||r instanceof e.constructor&&e.name===r.name&&e.nullable===r.nullable&&this.visit(e.type,r.type)}};function Wc(t,e){return e instanceof t.constructor}function Lb(t,e){return t===e||Wc(t,e)}function Vg(t,e){return t===e||Wc(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function xF(t,e){return t===e||Wc(t,e)&&t.precision===e.precision}function aYe(t,e){return t===e||Wc(t,e)&&t.byteWidth===e.byteWidth}function iJ(t,e){return t===e||Wc(t,e)&&t.unit===e.unit}function D6(t,e){return t===e||Wc(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function L6(t,e){return t===e||Wc(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function lYe(t,e){return t===e||Wc(t,e)&&t.children.length===e.children.length&&V0.compareManyFields(t.children,e.children)}function cYe(t,e){return t===e||Wc(t,e)&&t.children.length===e.children.length&&V0.compareManyFields(t.children,e.children)}function nJ(t,e){return t===e||Wc(t,e)&&t.mode===e.mode&&t.typeIds.every((r,i)=>r===e.typeIds[i])&&V0.compareManyFields(t.children,e.children)}function uYe(t,e){return t===e||Wc(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&V0.visit(t.indices,e.indices)&&V0.visit(t.dictionary,e.dictionary)}function wF(t,e){return t===e||Wc(t,e)&&t.unit===e.unit}function B6(t,e){return t===e||Wc(t,e)&&t.unit===e.unit}function hYe(t,e){return t===e||Wc(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&V0.compareManyFields(t.children,e.children)}function dYe(t,e){return t===e||Wc(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&V0.compareManyFields(t.children,e.children)}Zr.prototype.visitNull=Lb;Zr.prototype.visitBool=Lb;Zr.prototype.visitInt=Vg;Zr.prototype.visitInt8=Vg;Zr.prototype.visitInt16=Vg;Zr.prototype.visitInt32=Vg;Zr.prototype.visitInt64=Vg;Zr.prototype.visitUint8=Vg;Zr.prototype.visitUint16=Vg;Zr.prototype.visitUint32=Vg;Zr.prototype.visitUint64=Vg;Zr.prototype.visitFloat=xF;Zr.prototype.visitFloat16=xF;Zr.prototype.visitFloat32=xF;Zr.prototype.visitFloat64=xF;Zr.prototype.visitUtf8=Lb;Zr.prototype.visitLargeUtf8=Lb;Zr.prototype.visitBinary=Lb;Zr.prototype.visitLargeBinary=Lb;Zr.prototype.visitFixedSizeBinary=aYe;Zr.prototype.visitDate=iJ;Zr.prototype.visitDateDay=iJ;Zr.prototype.visitDateMillisecond=iJ;Zr.prototype.visitTimestamp=D6;Zr.prototype.visitTimestampSecond=D6;Zr.prototype.visitTimestampMillisecond=D6;Zr.prototype.visitTimestampMicrosecond=D6;Zr.prototype.visitTimestampNanosecond=D6;Zr.prototype.visitTime=L6;Zr.prototype.visitTimeSecond=L6;Zr.prototype.visitTimeMillisecond=L6;Zr.prototype.visitTimeMicrosecond=L6;Zr.prototype.visitTimeNanosecond=L6;Zr.prototype.visitDecimal=Lb;Zr.prototype.visitList=lYe;Zr.prototype.visitStruct=cYe;Zr.prototype.visitUnion=nJ;Zr.prototype.visitDenseUnion=nJ;Zr.prototype.visitSparseUnion=nJ;Zr.prototype.visitDictionary=uYe;Zr.prototype.visitInterval=wF;Zr.prototype.visitIntervalDayTime=wF;Zr.prototype.visitIntervalYearMonth=wF;Zr.prototype.visitIntervalMonthDayNano=wF;Zr.prototype.visitDuration=B6;Zr.prototype.visitDurationSecond=B6;Zr.prototype.visitDurationMillisecond=B6;Zr.prototype.visitDurationMicrosecond=B6;Zr.prototype.visitDurationNanosecond=B6;Zr.prototype.visitFixedSizeList=hYe;Zr.prototype.visitMap=dYe;var V0=new Zr;function Bb(t,e){return V0.compareSchemas(t,e)}function dwe(t,e){return V0.compareFields(t,e)}function fwe(t,e){return V0.visit(t,e)}function Ob(t){let e=t.type,r=new(hwe.getVisitFn(e)())(t);if(e.children&&e.children.length>0){let i=t.children||[],n={nullValues:t.nullValues},o=Array.isArray(i)?((s,a)=>i[a]||n):(({name:s})=>i[s]||n);for(let[s,a]of e.children.entries()){let{type:u}=a,p=o(a,s);r.children.push(Ob(Object.assign(Object.assign({},p),{type:u})))}}return r}function SF(t,e){return fYe(t,e.map(r=>r.data.concat()))}function fYe(t,e){let r=[...t.fields],i=[],n={numBatches:e.reduce((x,M)=>Math.max(x,M.length),0)},o=0,s=0,a=-1,u=e.length,p,m=[];for(;n.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<u;)m[a]=p=e[a].shift(),s=Math.min(s,p?p.length:s);Number.isFinite(s)&&(m=pYe(r,s,m,e,n),s>0&&(i[o++]=Dr({type:new so(r),length:s,nullCount:0,children:m.slice()})))}return[t=t.assign(r),i.map(x=>new Ns(t,x))]}function pYe(t,e,r,i,n){var o;let s=(e+63&-64)>>3;for(let a=-1,u=i.length;++a<u;){let p=r[a],m=p?.length;if(m>=e)m===e?r[a]=p:(r[a]=p.slice(0,e),n.numBatches=Math.max(n.numBatches,i[a].unshift(p.slice(e,m-e))));else{let x=t[a];t[a]=x.clone({nullable:!0}),r[a]=(o=p?._changeLengthAndBackfillNullBitmap(e))!==null&&o!==void 0?o:Dr({type:x.type,length:e,nullCount:e,nullBitmap:new Uint8Array(s)})}}return r}var mwe,Fl=class t{constructor(...e){var r,i;if(e.length===0)return this.batches=[],this.schema=new Ln([]),this._offsets=[0],this;let n,o;e[0]instanceof Ln&&(n=e.shift()),e.at(-1)instanceof Uint32Array&&(o=e.pop());let s=u=>{if(u){if(u instanceof Ns)return[u];if(u instanceof t)return u.batches;if(u instanceof Ji){if(u.type instanceof so)return[new Ns(new Ln(u.type.children),u)]}else{if(Array.isArray(u))return u.flatMap(p=>s(p));if(typeof u[Symbol.iterator]=="function")return[...u].flatMap(p=>s(p));if(typeof u=="object"){let p=Object.keys(u),m=p.map(k=>new Or([u[k]])),x=n??new Ln(p.map((k,F)=>new Mi(String(k),m[F].type,m[F].nullable))),[,M]=SF(x,m);return M.length===0?[new Ns(u)]:M}}}return[]},a=e.flatMap(u=>s(u));if(n=(i=n??((r=a[0])===null||r===void 0?void 0:r.schema))!==null&&i!==void 0?i:new Ln([]),!(n instanceof Ln))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let u of a){if(!(u instanceof Ns))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Bb(n,u.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=n,this.batches=a,this._offsets=o??uF(this.data)}get data(){return this.batches.map(({data:e})=>e)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,r)=>e+r.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=cF(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}at(e){return this.get(wb(e,this.numRows))}set(e,r){}indexOf(e,r){return-1}[Symbol.iterator](){return this.batches.length>0?aS.visit(new Or(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...e){let r=this.schema,i=this.data.concat(e.flatMap(({data:n})=>n));return new t(r,i.map(n=>new Ns(r,n)))}slice(e,r){let i=this.schema;[e,r]=a6({length:this.numRows},e,r);let n=hF(this.data,this._offsets,e,r);return new t(i,n.map(o=>new Ns(i,o)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(r=>r.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){let r=this.data.map(i=>i.children[e]);if(r.length===0){let{type:i}=this.schema.fields[e],n=Dr({type:i,length:0,nullCount:0});r.push(n._changeLengthAndBackfillNullBitmap(this.numRows))}return new Or(r)}return null}setChild(e,r){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(n=>n.name===e),r)}setChildAt(e,r){let i=this.schema,n=[...this.batches];if(e>-1&&e<this.numCols){r||(r=new Or([Dr({type:new fl,length:this.numRows})]));let o=i.fields.slice(),s=o[e].clone({type:r.type}),a=this.schema.fields.map((u,p)=>this.getChildAt(p));[o[e],a[e]]=[s,r],[i,n]=SF(i,a)}return new t(i,n)}select(e){let r=this.schema.fields.reduce((i,n,o)=>i.set(n.name,o),new Map);return this.selectAt(e.map(i=>r.get(i)).filter(i=>i>-1))}selectAt(e){let r=this.schema.selectAt(e),i=this.batches.map(n=>n.selectAt(e));return new t(r,i)}assign(e){let r=this.schema.fields,[i,n]=e.schema.fields.reduce((a,u,p)=>{let[m,x]=a,M=r.findIndex(k=>k.name===u.name);return~M?x[M]=p:m.push(p),a},[[],[]]),o=this.schema.assign(e.schema),s=[...r.map((a,u)=>[u,n[u]]).map(([a,u])=>u===void 0?this.getChildAt(a):e.getChildAt(u)),...i.map(a=>e.getChildAt(a))].filter(Boolean);return new t(...SF(o,s))}};mwe=Symbol.toStringTag;Fl[mwe]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=sS(u6),t.get=sS(Ta.getVisitFn(Qe.Struct)),t.set=dF(Bl.getVisitFn(Qe.Struct)),t.indexOf=fF(Eb.getVisitFn(Qe.Struct)),"Table"))(Fl.prototype);var Awe,Ns=class t{constructor(...e){switch(e.length){case 2:{if([this.schema]=e,!(this.schema instanceof Ln))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Dr({nullCount:0,type:new so(this.schema.fields),children:this.schema.fields.map(r=>Dr({type:r.type,nullCount:0}))})]=e,!(this.data instanceof Ji))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=gwe(this.schema,this.data.children);break}case 1:{let[r]=e,{fields:i,children:n,length:o}=Object.keys(r).reduce((u,p,m)=>(u.children[m]=r[p],u.length=Math.max(u.length,r[p].length),u.fields[m]=Mi.new({name:p,type:r[p].type,nullable:!0}),u),{length:0,fields:new Array,children:new Array}),s=new Ln(i),a=Dr({type:new so(i),length:o,children:n,nullCount:0});[this.schema,this.data]=gwe(s,a.children,o);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=ywe(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return Ta.visit(this.data,e)}at(e){return this.get(wb(e,this.numRows))}set(e,r){return Bl.visit(this.data,e,r)}indexOf(e,r){return Eb.visit(this.data,e,r)}[Symbol.iterator](){return aS.visit(new Or([this.data]))}toArray(){return[...this]}concat(...e){return new Fl(this.schema,[this,...e])}slice(e,r){let[i]=new Or([this.data]).slice(e,r).data;return new t(this.schema,i)}getChild(e){var r;return this.getChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new Or([this.data.children[e]]):null}setChild(e,r){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(n=>n.name===e),r)}setChildAt(e,r){let i=this.schema,n=this.data;if(e>-1&&e<this.numCols){r||(r=new Or([Dr({type:new fl,length:this.numRows})]));let o=i.fields.slice(),s=n.children.slice(),a=o[e].clone({type:r.type});[o[e],s[e]]=[a,r.data[0]],i=new Ln(o,new Map(this.schema.metadata)),n=Dr({type:new so(o),children:s})}return new t(i,n)}select(e){let r=this.schema.select(e),i=new so(r.fields),n=[];for(let o of e){let s=this.schema.fields.findIndex(a=>a.name===o);~s&&(n[s]=this.data.children[s])}return new t(r,Dr({type:i,length:this.numRows,children:n}))}selectAt(e){let r=this.schema.selectAt(e),i=e.map(o=>this.data.children[o]).filter(Boolean),n=Dr({type:new so(r.fields),length:this.numRows,children:i});return new t(r,n)}};Awe=Symbol.toStringTag;Ns[Awe]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Ns.prototype);function gwe(t,e,r=e.reduce((i,n)=>Math.max(i,n.length),0)){var i;let n=[...t.fields],o=[...e],s=(r+63&-64)>>3;for(let[a,u]of t.fields.entries()){let p=e[a];(!p||p.length!==r)&&(n[a]=u.clone({nullable:!0}),o[a]=(i=p?._changeLengthAndBackfillNullBitmap(r))!==null&&i!==void 0?i:Dr({type:u.type,length:r,nullCount:r,nullBitmap:new Uint8Array(s)}))}return[t.assign(n),Dr({type:new so(n),length:r,children:o})]}function ywe(t,e,r=new Map){var i,n;if(((i=t?.length)!==null&&i!==void 0?i:0)>0&&t?.length===e?.length)for(let o=-1,s=t.length;++o<s;){let{type:a}=t[o],u=e[o];for(let p of[u,...((n=u?.dictionary)===null||n===void 0?void 0:n.data)||[]])ywe(a.children,p?.children,r);if(or.isDictionary(a)){let{id:p}=a;if(!r.has(p))u?.dictionary&&r.set(p,u.dictionary);else if(r.get(p)!==u.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return r}var Fb=class extends Ns{constructor(e){let r=e.fields.map(n=>Dr({type:n.type})),i=Dr({type:new so(e.fields),nullCount:0,children:r});super(e,i)}};var sJ=t=>`Expected ${tn[t]} Message in stream, but was null or length 0.`,aJ=t=>`Header pointer of flatbuffer-encoded ${tn[t]} Message is null or length 0.`,_we=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,vwe=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`,DS=class{constructor(e){this.source=e instanceof F0?e:new F0(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done?zo:e.value===-1&&(e=this.readMetadataLength()).done?zo:(e=this.readMetadata(e.value)).done?zo:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let r;if((r=this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(sJ(e));return r.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);let r=ii(this.source.read(e));if(r.byteLength<e)throw new Error(vwe(e,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(e=!1){let r=tn.Schema,i=this.readMessage(r),n=i?.header();if(e&&!n)throw new Error(aJ(r));return n}readMetadataLength(){let e=this.source.read(TF),r=e&&new Ll(e),i=r?.readInt32(0)||0;return{done:i===0,value:i}}readMetadata(e){let r=this.source.read(e);if(!r)return zo;if(r.byteLength<e)throw new Error(_we(e,r.byteLength));return{done:!1,value:Lu.decode(r)}}},F6=class{constructor(e,r){this.source=e instanceof Hd?e:RB(e)?new k_(e,r):new Hd(e)}[Symbol.asyncIterator](){return this}next(){return Sr(this,void 0,void 0,function*(){let e;return(e=yield this.readMetadataLength()).done?zo:e.value===-1&&(e=yield this.readMetadataLength()).done?zo:(e=yield this.readMetadata(e.value)).done?zo:e})}throw(e){return Sr(this,void 0,void 0,function*(){return yield this.source.throw(e)})}return(e){return Sr(this,void 0,void 0,function*(){return yield this.source.return(e)})}readMessage(e){return Sr(this,void 0,void 0,function*(){let r;if((r=yield this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(sJ(e));return r.value})}readMessageBody(e){return Sr(this,void 0,void 0,function*(){if(e<=0)return new Uint8Array(0);let r=ii(yield this.source.read(e));if(r.byteLength<e)throw new Error(vwe(e,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()})}readSchema(){return Sr(this,arguments,void 0,function*(e=!1){let r=tn.Schema,i=yield this.readMessage(r),n=i?.header();if(e&&!n)throw new Error(aJ(r));return n})}readMetadataLength(){return Sr(this,void 0,void 0,function*(){let e=yield this.source.read(TF),r=e&&new Ll(e),i=r?.readInt32(0)||0;return{done:i===0,value:i}})}readMetadata(e){return Sr(this,void 0,void 0,function*(){let r=yield this.source.read(e);if(!r)return zo;if(r.byteLength<e)throw new Error(_we(e,r.byteLength));return{done:!1,value:Lu.decode(r)}})}},N6=class extends DS{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof h6?e:new h6(e)}next(){let{_json:e}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Lu.fromJSON(e.schema,tn.Schema)};if(this._dictionaryIndex<e.dictionaries.length){let r=e.dictionaries[this._dictionaryIndex++];return this._body=r.data.columns,{done:!1,value:Lu.fromJSON(r,tn.DictionaryBatch)}}if(this._batchIndex<e.batches.length){let r=e.batches[this._batchIndex++];return this._body=r.columns,{done:!1,value:Lu.fromJSON(r,tn.RecordBatch)}}return this._body=[],zo}readMessageBody(e){return r(this._body);function r(i){return(i||[]).reduce((n,o)=>[...n,...o.VALIDITY&&[o.VALIDITY]||[],...o.TYPE_ID&&[o.TYPE_ID]||[],...o.OFFSET&&[o.OFFSET]||[],...o.DATA&&[o.DATA]||[],...r(o.children)],[])}}readMessage(e){let r;if((r=this.next()).done)return null;if(e!=null&&r.value.headerType!==e)throw new Error(sJ(e));return r.value}readSchema(){let e=tn.Schema,r=this.readMessage(e),i=r?.header();if(!r||!i)throw new Error(aJ(e));return i}},TF=4,oJ="ARROW1",LS=new Uint8Array(oJ.length);for(let t=0;t<oJ.length;t+=1)LS[t]=oJ.codePointAt(t);function MF(t,e=0){for(let r=-1,i=LS.length;++r<i;)if(LS[r]!==t[e+r])return!1;return!0}var BS=LS.length,lJ=BS+TF,bwe=BS*2+TF;var cJ=class{constructor(){this.LZ4_FRAME_MAGIC=new Uint8Array([4,34,77,24]),this.MIN_HEADER_LENGTH=7}isValidCodecEncode(e){let r=new Uint8Array([1,2,3,4,5,6,7,8]),i=e.encode(r);return this._isValidCompressed(i)}_isValidCompressed(e){return this._hasMinimumLength(e)&&this._hasValidMagicNumber(e)&&this._hasValidVersion(e)}_hasMinimumLength(e){return e.length>=this.MIN_HEADER_LENGTH}_hasValidMagicNumber(e){return this.LZ4_FRAME_MAGIC.every((r,i)=>e[i]===r)}_hasValidVersion(e){return(e[4]&192)>>6===1}},uJ=class{constructor(){this.ZSTD_MAGIC=new Uint8Array([40,181,47,253]),this.MIN_HEADER_LENGTH=6}isValidCodecEncode(e){let r=new Uint8Array([1,2,3,4,5,6,7,8]),i=e.encode(r);return this._isValidCompressed(i)}_isValidCompressed(e){return this._hasMinimumLength(e)&&this._hasValidMagicNumber(e)}_hasMinimumLength(e){return e.length>=this.MIN_HEADER_LENGTH}_hasValidMagicNumber(e){return this.ZSTD_MAGIC.every((r,i)=>e[i]===r)}},xwe={[$c.LZ4_FRAME]:new cJ,[$c.ZSTD]:new uJ};var hJ=class{constructor(){this.registry={}}set(e,r){if(r?.encode&&typeof r.encode=="function"&&!xwe[e].isValidCodecEncode(r))throw new Error(`Encoder for ${$c[e]} is not valid.`);this.registry[e]=r}get(e){var r;return((r=this.registry)===null||r===void 0?void 0:r[e])||null}},FS=new hJ;var Dh=class t extends Ib{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){let r=this._impl.open(e);return Ph(r)?r.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Dl.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Dl.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,r){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof t?e:IB(e)?gYe(e):RB(e)?_Ye(e):Ph(e)?Sr(this,void 0,void 0,function*(){return yield t.from(yield e)}):OB(e)||FP(e)||LB(e)||Dd(e)?yYe(new Hd(e)):AYe(new F0(e))}static readAll(e){return e instanceof t?e.isSync()?wwe(e):Swe(e):IB(e)||ArrayBuffer.isView(e)||Zf(e)||kB(e)?wwe(e):Swe(e)}},jg=class extends Dh{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Ah(this,arguments,function*(){yield Bi(yield*p2(If(this[Symbol.iterator]())))})}},Nb=class extends Dh{constructor(e){super(e),this._impl=e}readAll(){return Sr(this,void 0,void 0,function*(){var e,r,i,n;let o=new Array;try{for(var s=!0,a=If(this),u;u=yield a.next(),e=u.done,!e;s=!0){n=u.value,s=!1;let p=n;o.push(p)}}catch(p){r={error:p}}finally{try{!s&&!e&&(i=a.return)&&(yield i.call(a))}finally{if(r)throw r.error}}return o})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},zb=class extends jg{constructor(e){super(e),this._impl=e}},EF=class extends Nb{constructor(e){super(e),this._impl=e}},CF=class{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,r){let i;if(e.compression!=null){let o=FS.get(e.compression.type);if(o?.decode&&typeof o.decode=="function"){let{decommpressedBody:s,buffers:a}=this._decompressBuffers(e,r,o);i=this._loadCompressedVectors(e,s,this.schema.fields),e=new Ca(e.length,e.nodes,a,null)}else throw new Error("Record batch is compressed but codec not found")}else i=this._loadVectors(e,r,this.schema.fields);let n=Dr({type:new so(this.schema.fields),length:e.length,children:i});return new Ns(this.schema,n)}_loadDictionaryBatch(e,r){let{id:i,isDelta:n}=e,{dictionaries:o,schema:s}=this,a=o.get(i),u=s.dictionaries.get(i),p;if(e.data.compression!=null){let m=FS.get(e.data.compression.type);if(m?.decode&&typeof m.decode=="function"){let{decommpressedBody:x,buffers:M}=this._decompressBuffers(e.data,r,m);p=this._loadCompressedVectors(e.data,x,[u]),e=new cc(new Ca(e.data.length,e.data.nodes,M,null),i,n)}else throw new Error("Dictionary batch is compressed but codec not found")}else p=this._loadVectors(e.data,r,[u]);return(a&&n?a.concat(new Or(p)):new Or(p)).memoize()}_loadVectors(e,r,i){return new dS(r,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}_loadCompressedVectors(e,r,i){return new bF(r,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}_decompressBuffers(e,r,i){let n=[],o=[],s=0;for(let{offset:a,length:u}of e.buffers){if(u===0){n.push(new Uint8Array(0)),o.push(new Ea(s,0));continue}let p=new Ll(r.subarray(a,a+u)),m=Tn(p.readInt64(0)),x=p.bytes().subarray(8),M=m===-1?x:i.decode(x);n.push(M);let k=(s+7&-8)-s;s+=k,o.push(new Ea(s,M.length)),s+=M.length}return{decommpressedBody:n,buffers:o}}},NS=class extends CF{constructor(e,r){super(r),this._reader=IB(e)?new N6(this._handle=e):new DS(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=Mwe(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):zo}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):zo}next(){if(this.closed)return zo;let e,{_reader:r}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let i=e.header(),n=r.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let i=e.header(),n=r.readMessageBody(e.bodyLength),o=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Fb(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}},zS=class extends CF{constructor(e,r){super(r),this._reader=new F6(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return Sr(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(e){return Sr(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=Mwe(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(e){return Sr(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):zo})}return(e){return Sr(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):zo})}next(){return Sr(this,void 0,void 0,function*(){if(this.closed)return zo;let e,{_reader:r}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;let i=e.header(),n=yield r.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;let i=e.header(),n=yield r.readMessageBody(e.bodyLength),o=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,o)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Fb(this.schema)}):yield this.return()})}_readNextMessageAndValidate(e){return Sr(this,void 0,void 0,function*(){return yield this._reader.readMessage(e)})}},PF=class extends NS{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,r){super(e instanceof d6?e:new d6(e),r)}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var r;if(this.closed)return null;this._footer||this.open();let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(e);if(i&&this._handle.seek(i.offset)){let n=this._reader.readMessage(tn.RecordBatch);if(n?.isRecordBatch()){let o=n.header(),s=this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(o,s)}}return null}_readDictionaryBatch(e){var r;let i=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(e);if(i&&this._handle.seek(i.offset)){let n=this._reader.readMessage(tn.DictionaryBatch);if(n?.isDictionaryBatch()){let o=n.header(),s=this._reader.readMessageBody(n.bodyLength),a=this._loadDictionaryBatch(o,s);this.dictionaries.set(o.id,a)}}}_readFooter(){let{_handle:e}=this,r=e.size-lJ,i=e.readInt32(r),n=e.readAt(r-i,i);return Bg.decode(n)}_readNextMessageAndValidate(e){var r;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(e)}return null}},dJ=class extends zS{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,...r){let i=typeof r[0]!="number"?r.shift():void 0,n=r[0]instanceof Map?r.shift():void 0;super(e instanceof k_?e:new k_(e,i),n)}isFile(){return!0}isAsync(){return!0}open(e){let r=Object.create(null,{open:{get:()=>super.open}});return Sr(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield r.open.call(this,e)})}readRecordBatch(e){return Sr(this,void 0,void 0,function*(){var r;if(this.closed)return null;this._footer||(yield this.open());let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(e);if(i&&(yield this._handle.seek(i.offset))){let n=yield this._reader.readMessage(tn.RecordBatch);if(n?.isRecordBatch()){let o=n.header(),s=yield this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(o,s)}}return null})}_readDictionaryBatch(e){return Sr(this,void 0,void 0,function*(){var r;let i=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(e);if(i&&(yield this._handle.seek(i.offset))){let n=yield this._reader.readMessage(tn.DictionaryBatch);if(n?.isDictionaryBatch()){let o=n.header(),s=yield this._reader.readMessageBody(n.bodyLength),a=this._loadDictionaryBatch(o,s);this.dictionaries.set(o.id,a)}}})}_readFooter(){return Sr(this,void 0,void 0,function*(){let{_handle:e}=this;e._pending&&(yield e._pending);let r=e.size-lJ,i=yield e.readInt32(r),n=yield e.readAt(r-i,i);return Bg.decode(n)})}_readNextMessageAndValidate(e){return Sr(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&(yield this._handle.seek(r.offset)))return yield this._reader.readMessage(e)}return null})}},fJ=class extends NS{constructor(e,r){super(e,r)}_loadVectors(e,r,i){return new vF(r,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}};function Mwe(t,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:t.autoDestroy}function*wwe(t){let e=Dh.from(t);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}function Swe(t){return Ah(this,arguments,function*(){let r=yield Bi(Dh.from(t));try{if(!(yield Bi(r.open({autoDestroy:!1}))).closed)do yield yield Bi(r);while(!(yield Bi(r.reset().open())).closed)}finally{yield Bi(r.cancel())}})}function gYe(t){return new jg(new fJ(t))}function AYe(t){let e=t.peek(BS+7&-8);return e&&e.byteLength>=4?MF(e)?new zb(new PF(t.read())):new jg(new NS(t)):new jg(new NS((function*(){})()))}function yYe(t){return Sr(this,void 0,void 0,function*(){let e=yield t.peek(BS+7&-8);return e&&e.byteLength>=4?MF(e)?new zb(new PF(yield t.read())):new Nb(new zS(t)):new Nb(new zS((function(){return Ah(this,arguments,function*(){})})()))})}function _Ye(t){return Sr(this,void 0,void 0,function*(){let{size:e}=yield t.stat(),r=new k_(t,e);return e>=bwe&&MF(yield r.readAt(0,BS+7&-8))?new EF(new dJ(r)):new Nb(new zS(r))})}var _s=class t extends Hr{static assemble(...e){let r=n=>n.flatMap(o=>Array.isArray(o)?r(o):o instanceof Ns?o.data.children:o.data),i=new t;return i.visitMany(r(e)),i}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(e){if(e instanceof Or)return this.visitMany(e.data),this;let{type:r}=e;if(!or.isDictionary(r)){let{length:i}=e;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(or.isUnion(r))this.nodes.push(new Gd(i,0));else{let{nullCount:n}=e;or.isNull(r)||ap.call(this,n<=0?new Uint8Array(0):Tb(e.offset,i,e.nullBitmap)),this.nodes.push(new Gd(i,n))}}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.clone(e.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function ap(t){let e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new Ea(this._byteLength,e)),this._byteLength+=e,this}function vYe(t){var e;let{type:r,length:i,typeIds:n,valueOffsets:o}=t;if(ap.call(this,n),r.mode===bo.Sparse)return pJ.call(this,t);if(r.mode===bo.Dense){if(t.offset<=0)return ap.call(this,o),pJ.call(this,t);{let s=new Int32Array(i),a=Object.create(null),u=Object.create(null);for(let p,m,x=-1;++x<i;)(p=n[x])!==void 0&&((m=a[p])===void 0&&(m=a[p]=o[x]),s[x]=o[x]-m,u[p]=((e=u[p])!==null&&e!==void 0?e:0)+1);ap.call(this,s),this.visitMany(t.children.map((p,m)=>{let x=r.typeIds[m],M=a[x],k=u[x];return p.slice(M,Math.min(i,k))}))}}return this}function bYe(t){let e;return t.nullCount>=t.length?ap.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?ap.call(this,Tb(t.offset,t.length,e)):ap.call(this,Mb(t.values))}function $g(t){return ap.call(this,t.values.subarray(0,t.length*t.stride))}function IF(t){let{length:e,values:r,valueOffsets:i}=t,n=Tn(i[0]),o=Tn(i[e]),s=Math.min(o-n,r.byteLength-n);return ap.call(this,FB(-n,e+1,i)),ap.call(this,r.subarray(n,n+s)),this}function mJ(t){let{length:e,valueOffsets:r}=t;if(r){let{[0]:i,[e]:n}=r;return ap.call(this,FB(-i,e+1,r)),this.visit(t.children[0].slice(i,n-i))}return this.visit(t.children[0])}function pJ(t){return this.visitMany(t.type.children.map((e,r)=>t.children[r]).filter(Boolean))[0]}_s.prototype.visitBool=bYe;_s.prototype.visitInt=$g;_s.prototype.visitFloat=$g;_s.prototype.visitUtf8=IF;_s.prototype.visitLargeUtf8=IF;_s.prototype.visitBinary=IF;_s.prototype.visitLargeBinary=IF;_s.prototype.visitFixedSizeBinary=$g;_s.prototype.visitDate=$g;_s.prototype.visitTimestamp=$g;_s.prototype.visitTime=$g;_s.prototype.visitDecimal=$g;_s.prototype.visitList=mJ;_s.prototype.visitStruct=pJ;_s.prototype.visitUnion=vYe;_s.prototype.visitInterval=$g;_s.prototype.visitDuration=$g;_s.prototype.visitFixedSizeList=mJ;_s.prototype.visitMap=mJ;var Ub=class extends Ib{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,r){throw new Error('"throughDOM" not available in this environment')}constructor(e){if(super(),this._position=0,this._started=!1,this._compression=null,this._sink=new B0,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,jc(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1,compressionType:null}),this._autoDestroy=typeof e.autoDestroy=="boolean"?e.autoDestroy:!0,this._writeLegacyIpcFormat=typeof e.writeLegacyIpcFormat=="boolean"?e.writeLegacyIpcFormat:!1,e.compressionType!=null){if(this._writeLegacyIpcFormat)throw new Error("Legacy IPC format does not support columnar compression. Use modern IPC format (writeLegacyIpcFormat=false).");if(Object.values($c).includes(e.compressionType))this._compression=new Pb(e.compressionType);else{let r=Object.values($c).filter(i=>typeof i=="string");throw new Error(`Unsupported compressionType: ${e.compressionType} Available types: ${r.join(", ")}`)}}else this._compression=null}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return Ph(e)?e.then(r=>this.writeAll(r)):Dd(e)?AJ(this,e):gJ(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,r=null){return e===this._sink||e instanceof B0?this._sink=e:(this._sink=new B0,e&&Lbe(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&Bbe(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,(!r||!Bb(r,this._schema))&&(r==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(e){let r=null;if(this._sink){if(e==null)return this.finish()&&void 0;if(e instanceof Fl&&!(r=e.schema))return this.finish()&&void 0;if(e instanceof Ns&&!(r=e.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!Bb(r,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}e instanceof Ns?e instanceof Fb||this._writeRecordBatch(e):e instanceof Fl?this.writeAll(e.batches):Zf(e)&&this.writeAll(e)}_writeMessage(e,r=8){let i=r-1,n=Lu.encode(e),o=n.byteLength,s=this._writeLegacyIpcFormat?4:8,a=o+s+i&~i,u=a-o-s;return e.headerType===tn.RecordBatch?this._recordBatchBlocks.push(new Fg(a,e.bodyLength,this._position)):e.headerType===tn.DictionaryBatch&&this._dictionaryBlocks.push(new Fg(a,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-s)),o>0&&this._write(n),this._writePadding(u)}_write(e){if(this._started){let r=ii(e);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(e){return this._writeMessage(Lu.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(LS)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){let{byteLength:r,nodes:i,bufferRegions:n,buffers:o}=this._assembleRecordBatch(e),s=new Ca(e.numRows,i,n,this._compression),a=Lu.from(s,r);return this._writeDictionaries(e)._writeMessage(a)._writeBodyBuffers(o)}_assembleRecordBatch(e){let{byteLength:r,nodes:i,bufferRegions:n,buffers:o}=_s.assemble(e);return this._compression!=null&&({byteLength:r,bufferRegions:n,buffers:o}=this._compressBodyBuffers(o)),{byteLength:r,nodes:i,bufferRegions:n,buffers:o}}_compressBodyBuffers(e){let r=FS.get(this._compression.type);if(!r?.encode||typeof r.encode!="function")throw new Error(`Codec for compression type "${$c[this._compression.type]}" has invalid encode method`);let i=0,n=[],o=[];for(let a of e){let u=ii(a);if(u.length===0){n.push(new Uint8Array(0),new Uint8Array(0)),o.push(new Ea(i,0));continue}let p=r.encode(u),m=p.length<u.length,x=m?p:u,M=m?x.length:-1,k=new Ll(new Uint8Array(8));k.writeInt64(0,BigInt(M)),n.push(k.bytes(),new Uint8Array(x));let F=(i+7&-8)-i;i+=F;let j=8+x.length;o.push(new Ea(i,j)),i+=j}let s=(i+7&-8)-i;return i+=s,{byteLength:i,bufferRegions:o,buffers:n}}_writeDictionaryBatch(e,r,i=!1){let{byteLength:n,nodes:o,bufferRegions:s,buffers:a}=this._assembleRecordBatch(new Or([e])),u=new Ca(e.length,o,s,this._compression),p=new cc(u,r,i),m=Lu.from(p,n);return this._writeMessage(m)._writeBodyBuffers(a)}_writeBodyBuffers(e){let r=this._compression!=null?2:1,i=new Array(r);for(let n=0;n<e.length;n+=r){let o=0;for(let a=-1;++a<r;)i[a]=e[n+a],o+=i[a].byteLength;if(o===0)continue;for(let a of i)this._write(a);let s=(o+7&-8)-o;s>0&&this._writePadding(s)}return this}_writeDictionaries(e){var r,i;for(let[n,o]of e.dictionaries){let s=(r=o?.data)!==null&&r!==void 0?r:[],a=this._seenDictionaries.get(n),u=(i=this._dictionaryDeltaOffsets.get(n))!==null&&i!==void 0?i:0;if(!a||a.data[0]!==s[0])for(let[p,m]of s.entries())this._writeDictionaryBatch(m,n,p>0);else if(u<s.length)for(let p of s.slice(u))this._writeDictionaryBatch(p,n,!0);this._seenDictionaries.set(n,o),this._dictionaryDeltaOffsets.set(n,s.length)}return this}},z6=class t extends Ub{static writeAll(e,r){let i=new t(r);return Ph(e)?e.then(n=>i.writeAll(n)):Dd(e)?AJ(i,e):gJ(i,e)}},U6=class t extends Ub{static writeAll(e,r){let i=new t(r);return Ph(e)?e.then(n=>i.writeAll(n)):Dd(e)?AJ(i,e):gJ(i,e)}constructor(e){super(e),this._autoDestroy=!0,this._writeLegacyIpcFormat=!1}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch(e,r,i=!1){if(!i&&this._seenDictionaries.has(r))throw new Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch(e,r,i)}_writeFooter(e){let r=Bg.encode(new Bg(e,Un.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};function gJ(t,e){let r=e;e instanceof Fl&&(r=e.batches,t.reset(void 0,e.schema));for(let i of r)t.write(i);return t.finish()}function AJ(t,e){return Sr(this,void 0,void 0,function*(){var r,i,n,o,s,a,u;try{for(r=!0,i=If(e);n=yield i.next(),o=n.done,!o;r=!0){u=n.value,r=!1;let p=u;t.write(p)}}catch(p){s={error:p}}finally{try{!r&&!o&&(a=i.return)&&(yield a.call(i))}finally{if(s)throw s.error}}return t.finish()})}function Ewe(t,e){if(Dd(t))return wYe(t,e);if(Zf(t))return xYe(t,e);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function xYe(t,e){let r=null,i=e?.type==="bytes"||!1,n=e?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},e),{start(s){o(s,r||(r=t[Symbol.iterator]()))},pull(s){r?o(s,r):s.close()},cancel(){r?.return&&r.return(),r=null}}),Object.assign({highWaterMark:i?n:void 0},e));function o(s,a){let u,p=null,m=s.desiredSize||null;for(;!(p=a.next(i?m:null)).done;)if(ArrayBuffer.isView(p.value)&&(u=ii(p.value))&&(m!=null&&i&&(m=m-u.byteLength+1),p.value=u),s.enqueue(p.value),m!=null&&--m<=0)return;s.close()}}function wYe(t,e){let r=null,i=e?.type==="bytes"||!1,n=e?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},e),{start(s){return Sr(this,void 0,void 0,function*(){yield o(s,r||(r=t[Symbol.asyncIterator]()))})},pull(s){return Sr(this,void 0,void 0,function*(){r?yield o(s,r):s.close()})},cancel(){return Sr(this,void 0,void 0,function*(){r?.return&&(yield r.return()),r=null})}}),Object.assign({highWaterMark:i?n:void 0},e));function o(s,a){return Sr(this,void 0,void 0,function*(){let u,p=null,m=s.desiredSize||null;for(;!(p=yield a.next(i?m:null)).done;)if(ArrayBuffer.isView(p.value)&&(u=ii(p.value))&&(m!=null&&i&&(m=m-u.byteLength+1),p.value=u),s.enqueue(p.value),m!=null&&--m<=0)return;s.close()})}}function Iwe(t){return new yJ(t)}var yJ=class{constructor(e){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:i,["queueingStrategy"]:n="count"}=e,o=oue(e,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=Ob(o),this._getSize=n!=="bytes"?Cwe:Pwe;let{["highWaterMark"]:s=n==="bytes"?Math.pow(2,14):1e3}=Object.assign({},r),{["highWaterMark"]:a=n==="bytes"?Math.pow(2,14):1e3}=Object.assign({},i);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:u=>{this._maybeFlush(this._builder,this._controller=u)},start:u=>{this._maybeFlush(this._builder,this._controller=u)}},{highWaterMark:s,size:n!=="bytes"?Cwe:Pwe}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:u=>this._writeValueAndReturnChunkSize(u)})}_writeValueAndReturnChunkSize(e){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(e)),this._bufferedSize-r}_maybeFlush(e,r){r!=null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,e.toVector()),e.finished&&((e.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,e.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(e,r){this._bufferedSize=0,this._controller=null,r==null?e.close():e.enqueue(r)}},Cwe=t=>{var e;return(e=t?.length)!==null&&e!==void 0?e:0},Pwe=t=>{var e;return(e=t?.byteLength)!==null&&e!==void 0?e:0};function kF(t,e){let r=new B0,i=null,n=new ReadableStream({cancel(){return Sr(this,void 0,void 0,function*(){yield r.close()})},start(a){return Sr(this,void 0,void 0,function*(){yield s(a,i||(i=yield o()))})},pull(a){return Sr(this,void 0,void 0,function*(){i?yield s(a,i):a.close()})}});return{writable:new WritableStream(r,Object.assign({highWaterMark:Math.pow(2,14)},t)),readable:n};function o(){return Sr(this,void 0,void 0,function*(){return yield(yield Dh.from(r)).open(e)})}function s(a,u){return Sr(this,void 0,void 0,function*(){let p=a.desiredSize,m=null;for(;!(m=yield u.next()).done;)if(a.enqueue(m.value),p!=null&&--p<=0)return;a.close()})}}function RF(t,e){let r=new this(t),i=new Hd(r),n=new ReadableStream({cancel(){return Sr(this,void 0,void 0,function*(){yield i.cancel()})},pull(s){return Sr(this,void 0,void 0,function*(){yield o(s)})},start(s){return Sr(this,void 0,void 0,function*(){yield o(s)})}},Object.assign({highWaterMark:Math.pow(2,14)},e));return{writable:new WritableStream(r,t),readable:n};function o(s){return Sr(this,void 0,void 0,function*(){let a=null,u=s.desiredSize;for(;a=yield i.read(u||null);)if(s.enqueue(a),u!=null&&(u-=a.byteLength)<=0)return;s.close()})}}function V6(t){let e=Dh.from(t);return Ph(e)?e.then(r=>V6(r)):e.isAsync()?e.readAll().then(r=>new Fl(r)):new Fl(e.readAll())}var HYe=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TQ),QQ),VQ),MQ),yQ),UQ),bQ),tJ),{compareSchemas:Bb,compareFields:dwe,compareTypes:fwe});Dl.toDOMStream=Ewe;Qo.throughDOM=Iwe;Dh.throughDOM=kF;zb.throughDOM=kF;jg.throughDOM=kF;Ub.throughDOM=RF;U6.throughDOM=RF;z6.throughDOM=RF;var mt,j6=null;function US(){return(j6===null||j6.byteLength===0)&&(j6=new Uint8Array(mt.memory.buffer)),j6}var OF=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});OF.decode();var qYe=2146435072,_J=0;function YYe(t,e){return _J+=e,_J>=qYe&&(OF=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),OF.decode(),_J=e),OF.decode(US().subarray(t,t+e))}function lp(t,e){return t=t>>>0,YYe(t,e)}var hc=0,W6=new TextEncoder;"encodeInto"in W6||(W6.encodeInto=function(t,e){let r=W6.encode(t);return e.set(r),{read:t.length,written:r.length}});function cp(t,e,r){if(r===void 0){let a=W6.encode(t),u=e(a.length,1)>>>0;return US().subarray(u,u+a.length).set(a),hc=a.length,u}let i=t.length,n=e(i,1)>>>0,o=US(),s=0;for(;s<i;s++){let a=t.charCodeAt(s);if(a>127)break;o[n+s]=a}if(s!==i){s!==0&&(t=t.slice(s)),n=r(n,i,i=s+t.length*3,1)>>>0;let a=US().subarray(n+s,n+i),u=W6.encodeInto(t,a);s+=u.written,n=r(n,i,s,1)>>>0}return hc=s,n}var Vb=null;function Lh(){return(Vb===null||Vb.buffer.detached===!0||Vb.buffer.detached===void 0&&Vb.buffer!==mt.memory.buffer)&&(Vb=new DataView(mt.memory.buffer)),Vb}function j0(t){let e=mt.__externref_table_alloc();return mt.__wbindgen_export_4.set(e,t),e}function Ka(t,e){try{return t.apply(this,e)}catch(r){let i=j0(r);mt.__wbindgen_exn_store(i)}}function uc(t){return t==null}function VS(t,e){return t=t>>>0,US().subarray(t/1,t/1+e)}function bJ(t){let e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){let n=t.description;return n==null?"Symbol":`Symbol(${n})`}if(e=="function"){let n=t.name;return typeof n=="string"&&n.length>0?`Function(${n})`:"Function"}if(Array.isArray(t)){let n=t.length,o="[";n>0&&(o+=bJ(t[0]));for(let s=1;s<n;s++)o+=", "+bJ(t[s]);return o+="]",o}let r=/\[object ([^\]]+)\]/.exec(toString.call(t)),i;if(r&&r.length>1)i=r[1];else return toString.call(t);if(i=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:i}var kwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>{mt.__wbindgen_export_5.get(t.dtor)(t.a,t.b)});function Rwe(t,e,r,i){let n={a:t,b:e,cnt:1,dtor:r},o=(...s)=>{n.cnt++;let a=n.a;n.a=0;try{return i(a,n.b,...s)}finally{--n.cnt===0?(mt.__wbindgen_export_5.get(n.dtor)(a,n.b),kwe.unregister(n)):n.a=a}};return o.original=n,kwe.register(o,n,n),o}function oa(t){let e=mt.__wbindgen_export_4.get(t);return mt.__externref_table_dealloc(t),e}function G6(t,e){t=t>>>0;let r=Lh(),i=[];for(let n=t;n<t+4*e;n+=4)i.push(mt.__wbindgen_export_4.get(r.getUint32(n,!0)));return mt.__externref_drop_slice(t,e),i}function Hwe(t,e){let r=e(t.length*1,1)>>>0;return US().set(t,r/1),hc=t.length,r}function qwe(t,e){let r=Hwe(t,mt.__wbindgen_malloc),i=hc,n=mt.readParquet(r,i,uc(e)?0:j0(e));if(n[2])throw oa(n[1]);return qS.__wrap(n[0])}function XYe(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`)}var $6=null;function ZYe(){return($6===null||$6.byteLength===0)&&($6=new Uint32Array(mt.memory.buffer)),$6}function KYe(t,e){return t=t>>>0,ZYe().subarray(t/4,t/4+e)}function QYe(t,e){mt.wasm_bindgen__convert__closures_____invoke__hfec9c6c02f6046ed(t,e)}function JYe(t,e,r){mt.closure3789_externref_shim(t,e,r)}function eXe(t,e,r,i){mt.closure3803_externref_shim(t,e,r,i)}var far=Object.freeze({UNCOMPRESSED:0,0:"UNCOMPRESSED",SNAPPY:1,1:"SNAPPY",GZIP:2,2:"GZIP",BROTLI:3,3:"BROTLI",LZ4:4,4:"LZ4",ZSTD:5,5:"ZSTD",LZ4_RAW:6,6:"LZ4_RAW",LZO:7,7:"LZO"}),par=Object.freeze({None:0,0:"None",Chunk:1,1:"Chunk",Page:2,2:"Page"}),mar=Object.freeze({PLAIN:0,0:"PLAIN",PLAIN_DICTIONARY:1,1:"PLAIN_DICTIONARY",RLE:2,2:"RLE",BIT_PACKED:3,3:"BIT_PACKED",DELTA_BINARY_PACKED:4,4:"DELTA_BINARY_PACKED",DELTA_LENGTH_BYTE_ARRAY:5,5:"DELTA_LENGTH_BYTE_ARRAY",DELTA_BYTE_ARRAY:6,6:"DELTA_BYTE_ARRAY",RLE_DICTIONARY:7,7:"RLE_DICTIONARY",BYTE_STREAM_SPLIT:8,8:"BYTE_STREAM_SPLIT"}),gar=Object.freeze({V1:0,0:"V1",V2:1,1:"V2"}),tXe=["bytes"],rXe=["default","no-store","reload","no-cache","force-cache","only-if-cached"],iXe=["omit","same-origin","include"],nXe=["same-origin","no-cors","cors","navigate"],Owe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_columnchunkmetadata_free(t>>>0,1)),jS=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Owe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Owe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_columnchunkmetadata_free(e,0)}filePath(){let e=mt.columnchunkmetadata_filePath(this.__wbg_ptr),r;return e[0]!==0&&(r=lp(e[0],e[1]).slice(),mt.__wbindgen_free(e[0],e[1]*1,1)),r}fileOffset(){return mt.columnchunkmetadata_fileOffset(this.__wbg_ptr)}columnPath(){let e=mt.columnchunkmetadata_columnPath(this.__wbg_ptr);var r=G6(e[0],e[1]).slice();return mt.__wbindgen_free(e[0],e[1]*4,4),r}encodings(){let e=mt.columnchunkmetadata_encodings(this.__wbg_ptr);var r=G6(e[0],e[1]).slice();return mt.__wbindgen_free(e[0],e[1]*4,4),r}numValues(){return mt.columnchunkmetadata_numValues(this.__wbg_ptr)}compression(){return mt.columnchunkmetadata_compression(this.__wbg_ptr)}compressedSize(){return mt.columnchunkmetadata_compressedSize(this.__wbg_ptr)}uncompressedSize(){return mt.columnchunkmetadata_uncompressedSize(this.__wbg_ptr)}};Symbol.dispose&&(jS.prototype[Symbol.dispose]=jS.prototype.free);var Dwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_ffidata_free(t>>>0,1)),$S=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Dwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Dwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_ffidata_free(e,0)}arrayAddr(){return mt.ffidata_arrayAddr(this.__wbg_ptr)>>>0}schemaAddr(){return mt.ffidata_schemaAddr(this.__wbg_ptr)>>>0}};Symbol.dispose&&($S.prototype[Symbol.dispose]=$S.prototype.free);var Lwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_ffischema_free(t>>>0,1)),WS=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Lwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Lwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_ffischema_free(e,0)}addr(){return mt.ffischema_addr(this.__wbg_ptr)>>>0}};Symbol.dispose&&(WS.prototype[Symbol.dispose]=WS.prototype.free);var Bwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_ffistream_free(t>>>0,1)),GS=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Bwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Bwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_ffistream_free(e,0)}numArrays(){return mt.ffistream_numArrays(this.__wbg_ptr)>>>0}schemaAddr(){return mt.ffistream_schemaAddr(this.__wbg_ptr)>>>0}arrayAddr(e){return mt.ffistream_arrayAddr(this.__wbg_ptr,e)>>>0}arrayAddrs(){let e=mt.ffistream_arrayAddrs(this.__wbg_ptr);var r=KYe(e[0],e[1]).slice();return mt.__wbindgen_free(e[0],e[1]*4,4),r}drop(){let e=this.__destroy_into_raw();mt.ffistream_drop(e)}};Symbol.dispose&&(GS.prototype[Symbol.dispose]=GS.prototype.free);var Fwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_filemetadata_free(t>>>0,1)),H6=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Fwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Fwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_filemetadata_free(e,0)}version(){return mt.filemetadata_version(this.__wbg_ptr)}numRows(){return mt.filemetadata_numRows(this.__wbg_ptr)}createdBy(){let e=mt.filemetadata_createdBy(this.__wbg_ptr),r;return e[0]!==0&&(r=lp(e[0],e[1]).slice(),mt.__wbindgen_free(e[0],e[1]*1,1)),r}keyValueMetadata(){let e=mt.filemetadata_keyValueMetadata(this.__wbg_ptr);if(e[2])throw oa(e[1]);return oa(e[0])}};Symbol.dispose&&(H6.prototype[Symbol.dispose]=H6.prototype.free);var oXe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_intounderlyingbytesource_free(t>>>0,1)),DF=class{__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,oXe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_intounderlyingbytesource_free(e,0)}get type(){let e=mt.intounderlyingbytesource_type(this.__wbg_ptr);return tXe[e]}get autoAllocateChunkSize(){return mt.intounderlyingbytesource_autoAllocateChunkSize(this.__wbg_ptr)>>>0}start(e){mt.intounderlyingbytesource_start(this.__wbg_ptr,e)}pull(e){return mt.intounderlyingbytesource_pull(this.__wbg_ptr,e)}cancel(){let e=this.__destroy_into_raw();mt.intounderlyingbytesource_cancel(e)}};Symbol.dispose&&(DF.prototype[Symbol.dispose]=DF.prototype.free);var sXe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_intounderlyingsink_free(t>>>0,1)),LF=class{__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,sXe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_intounderlyingsink_free(e,0)}write(e){return mt.intounderlyingsink_write(this.__wbg_ptr,e)}close(){let e=this.__destroy_into_raw();return mt.intounderlyingsink_close(e)}abort(e){let r=this.__destroy_into_raw();return mt.intounderlyingsink_abort(r,e)}};Symbol.dispose&&(LF.prototype[Symbol.dispose]=LF.prototype.free);var Nwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_intounderlyingsource_free(t>>>0,1)),q6=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Nwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Nwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_intounderlyingsource_free(e,0)}pull(e){return mt.intounderlyingsource_pull(this.__wbg_ptr,e)}cancel(){let e=this.__destroy_into_raw();mt.intounderlyingsource_cancel(e)}};Symbol.dispose&&(q6.prototype[Symbol.dispose]=q6.prototype.free);var zwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_parquetfile_free(t>>>0,1)),Y6=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,zwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,zwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_parquetfile_free(e,0)}static fromUrl(e){let r=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),i=hc;return mt.parquetfile_fromUrl(r,i)}static fromFile(e){return mt.parquetfile_fromFile(e)}metadata(){let e=mt.parquetfile_metadata(this.__wbg_ptr);if(e[2])throw oa(e[1]);return X6.__wrap(e[0])}schema(){let e=mt.parquetfile_schema(this.__wbg_ptr);if(e[2])throw oa(e[1]);return L_.__wrap(e[0])}read(e){return mt.parquetfile_read(this.__wbg_ptr,uc(e)?0:j0(e))}stream(e){return mt.parquetfile_stream(this.__wbg_ptr,uc(e)?0:j0(e))}};Symbol.dispose&&(Y6.prototype[Symbol.dispose]=Y6.prototype.free);var Uwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_parquetmetadata_free(t>>>0,1)),X6=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Uwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Uwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_parquetmetadata_free(e,0)}fileMetadata(){let e=mt.parquetmetadata_fileMetadata(this.__wbg_ptr);return H6.__wrap(e)}numRowGroups(){return mt.parquetmetadata_numRowGroups(this.__wbg_ptr)>>>0}rowGroup(e){let r=mt.parquetmetadata_rowGroup(this.__wbg_ptr,e);return HS.__wrap(r)}rowGroups(){let e=mt.parquetmetadata_rowGroups(this.__wbg_ptr);var r=G6(e[0],e[1]).slice();return mt.__wbindgen_free(e[0],e[1]*4,4),r}};Symbol.dispose&&(X6.prototype[Symbol.dispose]=X6.prototype.free);var Vwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_recordbatch_free(t>>>0,1)),jb=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Vwe.register(r,r.__wbg_ptr,r),r}static __unwrap(e){return e instanceof t?e.__destroy_into_raw():0}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Vwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_recordbatch_free(e,0)}get numRows(){return mt.recordbatch_numRows(this.__wbg_ptr)>>>0}get numColumns(){return mt.recordbatch_numColumns(this.__wbg_ptr)>>>0}get schema(){let e=mt.recordbatch_schema(this.__wbg_ptr);return L_.__wrap(e)}toFFI(){let e=mt.recordbatch_toFFI(this.__wbg_ptr);if(e[2])throw oa(e[1]);return $S.__wrap(e[0])}intoFFI(){let e=this.__destroy_into_raw(),r=mt.recordbatch_intoFFI(e);if(r[2])throw oa(r[1]);return $S.__wrap(r[0])}intoIPCStream(){let e=this.__destroy_into_raw(),r=mt.recordbatch_intoIPCStream(e);if(r[3])throw oa(r[2]);var i=VS(r[0],r[1]).slice();return mt.__wbindgen_free(r[0],r[1]*1,1),i}withSchema(e){XYe(e,L_);var r=e.__destroy_into_raw();let i=mt.recordbatch_withSchema(this.__wbg_ptr,r);if(i[2])throw oa(i[1]);return t.__wrap(i[0])}slice(e,r){let i=mt.recordbatch_slice(this.__wbg_ptr,e,r);return t.__wrap(i)}getArrayMemorySize(){return mt.recordbatch_getArrayMemorySize(this.__wbg_ptr)>>>0}};Symbol.dispose&&(jb.prototype[Symbol.dispose]=jb.prototype.free);var jwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_rowgroupmetadata_free(t>>>0,1)),HS=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,jwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,jwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_rowgroupmetadata_free(e,0)}numColumns(){return mt.rowgroupmetadata_numColumns(this.__wbg_ptr)>>>0}column(e){let r=mt.rowgroupmetadata_column(this.__wbg_ptr,e);return jS.__wrap(r)}columns(){let e=mt.rowgroupmetadata_columns(this.__wbg_ptr);var r=G6(e[0],e[1]).slice();return mt.__wbindgen_free(e[0],e[1]*4,4),r}numRows(){return mt.rowgroupmetadata_numRows(this.__wbg_ptr)}totalByteSize(){return mt.rowgroupmetadata_totalByteSize(this.__wbg_ptr)}compressedSize(){return mt.rowgroupmetadata_compressedSize(this.__wbg_ptr)}};Symbol.dispose&&(HS.prototype[Symbol.dispose]=HS.prototype.free);var $we=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_schema_free(t>>>0,1)),L_=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,$we.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,$we.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_schema_free(e,0)}toFFI(){let e=mt.schema_toFFI(this.__wbg_ptr);if(e[2])throw oa(e[1]);return WS.__wrap(e[0])}intoFFI(){let e=this.__destroy_into_raw(),r=mt.schema_intoFFI(e);if(r[2])throw oa(r[1]);return WS.__wrap(r[0])}intoIPCStream(){let e=this.__destroy_into_raw(),r=mt.schema_intoIPCStream(e);if(r[3])throw oa(r[2]);var i=VS(r[0],r[1]).slice();return mt.__wbindgen_free(r[0],r[1]*1,1),i}withMetadata(e){let r=mt.schema_withMetadata(this.__wbg_ptr,e);if(r[2])throw oa(r[1]);return t.__wrap(r[0])}indexOf(e){let r=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),i=hc,n=mt.schema_indexOf(this.__wbg_ptr,r,i);if(n[2])throw oa(n[1]);return n[0]>>>0}metadata(){let e=mt.schema_metadata(this.__wbg_ptr);if(e[2])throw oa(e[1]);return oa(e[0])}};Symbol.dispose&&(L_.prototype[Symbol.dispose]=L_.prototype.free);var Wwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_table_free(t>>>0,1)),qS=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Wwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Wwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_table_free(e,0)}get schema(){let e=mt.table_schema(this.__wbg_ptr);return L_.__wrap(e)}recordBatch(e){let r=mt.table_recordBatch(this.__wbg_ptr,e);return r===0?void 0:jb.__wrap(r)}recordBatches(){let e=mt.table_recordBatches(this.__wbg_ptr);var r=G6(e[0],e[1]).slice();return mt.__wbindgen_free(e[0],e[1]*4,4),r}get numBatches(){return mt.table_numBatches(this.__wbg_ptr)>>>0}toFFI(){let e=mt.table_toFFI(this.__wbg_ptr);if(e[2])throw oa(e[1]);return GS.__wrap(e[0])}intoFFI(){let e=this.__destroy_into_raw(),r=mt.table_intoFFI(e);if(r[2])throw oa(r[1]);return GS.__wrap(r[0])}intoIPCStream(){let e=this.__destroy_into_raw(),r=mt.table_intoIPCStream(e);if(r[3])throw oa(r[2]);var i=VS(r[0],r[1]).slice();return mt.__wbindgen_free(r[0],r[1]*1,1),i}static fromIPCStream(e){let r=Hwe(e,mt.__wbindgen_malloc),i=hc,n=mt.table_fromIPCStream(r,i);if(n[2])throw oa(n[1]);return t.__wrap(n[0])}getArrayMemorySize(){return mt.table_getArrayMemorySize(this.__wbg_ptr)>>>0}};Symbol.dispose&&(qS.prototype[Symbol.dispose]=qS.prototype.free);var Gwe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_writerproperties_free(t>>>0,1)),Z6=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,Gwe.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Gwe.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_writerproperties_free(e,0)}};Symbol.dispose&&(Z6.prototype[Symbol.dispose]=Z6.prototype.free);var vJ=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>mt.__wbg_writerpropertiesbuilder_free(t>>>0,1)),BF=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,vJ.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,vJ.unregister(this),e}free(){let e=this.__destroy_into_raw();mt.__wbg_writerpropertiesbuilder_free(e,0)}constructor(){let e=mt.writerpropertiesbuilder_new();return this.__wbg_ptr=e>>>0,vJ.register(this,this.__wbg_ptr,this),this}build(){let e=this.__destroy_into_raw(),r=mt.writerpropertiesbuilder_build(e);return Z6.__wrap(r)}setWriterVersion(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setWriterVersion(r,e);return t.__wrap(i)}setDataPageSizeLimit(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setDataPageSizeLimit(r,e);return t.__wrap(i)}setDictionaryPageSizeLimit(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setDictionaryPageSizeLimit(r,e);return t.__wrap(i)}setWriteBatchSize(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setWriteBatchSize(r,e);return t.__wrap(i)}setMaxRowGroupSize(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setMaxRowGroupSize(r,e);return t.__wrap(i)}setCreatedBy(e){let r=this.__destroy_into_raw(),i=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),n=hc,o=mt.writerpropertiesbuilder_setCreatedBy(r,i,n);return t.__wrap(o)}setKeyValueMetadata(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setKeyValueMetadata(r,e);if(i[2])throw oa(i[1]);return t.__wrap(i[0])}setEncoding(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setEncoding(r,e);return t.__wrap(i)}setCompression(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setCompression(r,e);return t.__wrap(i)}setDictionaryEnabled(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setDictionaryEnabled(r,e);return t.__wrap(i)}setStatisticsEnabled(e){let r=this.__destroy_into_raw(),i=mt.writerpropertiesbuilder_setStatisticsEnabled(r,e);return t.__wrap(i)}setColumnEncoding(e,r){let i=this.__destroy_into_raw(),n=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc,s=mt.writerpropertiesbuilder_setColumnEncoding(i,n,o,r);return t.__wrap(s)}setColumnCompression(e,r){let i=this.__destroy_into_raw(),n=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc,s=mt.writerpropertiesbuilder_setColumnCompression(i,n,o,r);return t.__wrap(s)}setColumnDictionaryEnabled(e,r){let i=this.__destroy_into_raw(),n=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc,s=mt.writerpropertiesbuilder_setColumnDictionaryEnabled(i,n,o,r);return t.__wrap(s)}setColumnStatisticsEnabled(e,r){let i=this.__destroy_into_raw(),n=cp(e,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc,s=mt.writerpropertiesbuilder_setColumnStatisticsEnabled(i,n,o,r);return t.__wrap(s)}};Symbol.dispose&&(BF.prototype[Symbol.dispose]=BF.prototype.free);var aXe=new Set(["basic","cors","default"]);async function lXe(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(i){if(t.ok&&aXe.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}let r=await t.arrayBuffer();return await WebAssembly.instantiate(r,e)}else{let r=await WebAssembly.instantiate(t,e);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}}function cXe(){let t={};return t.wbg={},t.wbg.__wbg_Error_e17e777aac105295=function(e,r){return Error(lp(e,r))},t.wbg.__wbg_Number_998bea33bd87c3e0=function(e){return Number(e)},t.wbg.__wbg_String_8f0eb39a4a4c2f66=function(e,r){let i=String(r),n=cp(i,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc;Lh().setInt32(e+4,o,!0),Lh().setInt32(e+0,n,!0)},t.wbg.__wbg_abort_67e1b49bf6614565=function(e){e.abort()},t.wbg.__wbg_abort_d830bf2e9aa6ec5b=function(e,r){e.abort(r)},t.wbg.__wbg_append_72a3c0addd2bce38=function(){return Ka(function(e,r,i,n,o){e.append(lp(r,i),lp(n,o))},arguments)},t.wbg.__wbg_arrayBuffer_2c907ed8e8ef4e35=function(e){return e.arrayBuffer()},t.wbg.__wbg_arrayBuffer_9c99b8e2809e8cbb=function(){return Ka(function(e){return e.arrayBuffer()},arguments)},t.wbg.__wbg_buffer_8d40b1d762fb3c66=function(e){return e.buffer},t.wbg.__wbg_byobRequest_2c036bceca1e6037=function(e){let r=e.byobRequest;return uc(r)?0:j0(r)},t.wbg.__wbg_byteLength_331a6b5545834024=function(e){return e.byteLength},t.wbg.__wbg_byteOffset_49a5b5608000358b=function(e){return e.byteOffset},t.wbg.__wbg_call_13410aac570ffff7=function(){return Ka(function(e,r){return e.call(r)},arguments)},t.wbg.__wbg_call_a5400b25a865cfd8=function(){return Ka(function(e,r,i){return e.call(r,i)},arguments)},t.wbg.__wbg_cancel_8bb5b8f4906b658a=function(e){return e.cancel()},t.wbg.__wbg_catch_c80ecae90cb8ed4e=function(e,r){return e.catch(r)},t.wbg.__wbg_clearTimeout_6222fede17abcb1a=function(e){return clearTimeout(e)},t.wbg.__wbg_close_a1918cff3cac355b=function(e){return e.close()},t.wbg.__wbg_close_cccada6053ee3a65=function(){return Ka(function(e){e.close()},arguments)},t.wbg.__wbg_close_d71a78219dc23e91=function(){return Ka(function(e){e.close()},arguments)},t.wbg.__wbg_columnchunkmetadata_new=function(e){return jS.__wrap(e)},t.wbg.__wbg_done_75ed0ee6dd243d9d=function(e){return e.done},t.wbg.__wbg_enqueue_452bc2343d1c2ff9=function(){return Ka(function(e,r){e.enqueue(r)},arguments)},t.wbg.__wbg_entries_2be2f15bd5554996=function(e){return Object.entries(e)},t.wbg.__wbg_fetch_87aed7f306ec6d63=function(e,r){return e.fetch(r)},t.wbg.__wbg_fetch_f156d10be9a5c88a=function(e){return fetch(e)},t.wbg.__wbg_getReader_48e00749fe3f6089=function(){return Ka(function(e){return e.getReader()},arguments)},t.wbg.__wbg_getWriter_03d7689e275ac6a4=function(){return Ka(function(e){return e.getWriter()},arguments)},t.wbg.__wbg_get_0da715ceaecea5c8=function(e,r){return e[r>>>0]},t.wbg.__wbg_get_458e874b43b18b25=function(){return Ka(function(e,r){return Reflect.get(e,r)},arguments)},t.wbg.__wbg_getdone_f026246f6bbe58d3=function(e){let r=e.done;return uc(r)?16777215:r?1:0},t.wbg.__wbg_getvalue_31e5a08f61e5aa42=function(e){return e.value},t.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,r){return e[r]},t.wbg.__wbg_has_b89e451f638123e3=function(){return Ka(function(e,r){return Reflect.has(e,r)},arguments)},t.wbg.__wbg_headers_29fec3c72865cd75=function(e){return e.headers},t.wbg.__wbg_instanceof_ArrayBuffer_67f3012529f6a2dd=function(e){let r;try{r=e instanceof ArrayBuffer}catch{r=!1}return r},t.wbg.__wbg_instanceof_Response_50fde2cd696850bf=function(e){let r;try{r=e instanceof Response}catch{r=!1}return r},t.wbg.__wbg_instanceof_Uint8Array_9a8378d955933db7=function(e){let r;try{r=e instanceof Uint8Array}catch{r=!1}return r},t.wbg.__wbg_isArray_030cce220591fb41=function(e){return Array.isArray(e)},t.wbg.__wbg_isSafeInteger_1c0d1af5542e102a=function(e){return Number.isSafeInteger(e)},t.wbg.__wbg_iterator_f370b34483c71a1c=function(){return Symbol.iterator},t.wbg.__wbg_length_186546c51cd61acd=function(e){return e.length},t.wbg.__wbg_length_6bb7e81f9d7713e4=function(e){return e.length},t.wbg.__wbg_new_19c25a3f2fa63a02=function(){return new Object},t.wbg.__wbg_new_2e3c58a15f39f5f9=function(e,r){try{var i={a:e,b:r},n=(s,a)=>{let u=i.a;i.a=0;try{return eXe(u,i.b,s,a)}finally{i.a=u}};return new Promise(n)}finally{i.a=i.b=0}},t.wbg.__wbg_new_2ff1f68f3676ea53=function(){return new Map},t.wbg.__wbg_new_638ebfaedbf32a5e=function(e){return new Uint8Array(e)},t.wbg.__wbg_new_66b9434b4e59b63e=function(){return Ka(function(){return new AbortController},arguments)},t.wbg.__wbg_new_99a6a948d5b3f607=function(){return Ka(function(){return new TransformStream},arguments)},t.wbg.__wbg_new_da9dc54c5db29dfa=function(e,r){return new Error(lp(e,r))},t.wbg.__wbg_new_f6e53210afea8e45=function(){return Ka(function(){return new Headers},arguments)},t.wbg.__wbg_newfromslice_074c56947bd43469=function(e,r){return new Uint8Array(VS(e,r))},t.wbg.__wbg_newnoargs_254190557c45b4ec=function(e,r){return new Function(lp(e,r))},t.wbg.__wbg_newwithbyteoffset_6bd4b2a4ca518883=function(e,r){return new Uint8Array(e,r>>>0)},t.wbg.__wbg_newwithbyteoffsetandlength_e8f53910b4d42b45=function(e,r,i){return new Uint8Array(e,r>>>0,i>>>0)},t.wbg.__wbg_newwithintounderlyingsource_b47f6a6a596a7f24=function(e,r){return new ReadableStream(q6.__wrap(e),r)},t.wbg.__wbg_newwithstrandinit_b5d168a29a3fd85f=function(){return Ka(function(e,r,i){return new Request(lp(e,r),i)},arguments)},t.wbg.__wbg_next_5b3530e612fde77d=function(e){return e.next},t.wbg.__wbg_next_692e82279131b03c=function(){return Ka(function(e){return e.next()},arguments)},t.wbg.__wbg_parquetfile_new=function(e){return Y6.__wrap(e)},t.wbg.__wbg_prototypesetcall_3d4a26c1ed734349=function(e,r,i){Uint8Array.prototype.set.call(VS(e,r),i)},t.wbg.__wbg_queueMicrotask_25d0739ac89e8c88=function(e){queueMicrotask(e)},t.wbg.__wbg_queueMicrotask_4488407636f5bf24=function(e){return e.queueMicrotask},t.wbg.__wbg_read_bc925c758aa4d897=function(e){return e.read()},t.wbg.__wbg_readable_e82cff27b968ed1c=function(e){return e.readable},t.wbg.__wbg_ready_4186da3cb500ae7d=function(e){return e.ready},t.wbg.__wbg_recordbatch_new=function(e){return jb.__wrap(e)},t.wbg.__wbg_recordbatch_unwrap=function(e){return jb.__unwrap(e)},t.wbg.__wbg_releaseLock_62151472ae632176=function(e){e.releaseLock()},t.wbg.__wbg_releaseLock_ff29b586502a8221=function(e){e.releaseLock()},t.wbg.__wbg_resolve_4055c623acdd6a1b=function(e){return Promise.resolve(e)},t.wbg.__wbg_respond_6c2c4e20ef85138e=function(){return Ka(function(e,r){e.respond(r>>>0)},arguments)},t.wbg.__wbg_rowgroupmetadata_new=function(e){return HS.__wrap(e)},t.wbg.__wbg_setTimeout_2b339866a2aa3789=function(e,r){return setTimeout(e,r)},t.wbg.__wbg_set_1353b2a5e96bc48c=function(e,r,i){e.set(VS(r,i))},t.wbg.__wbg_set_3f1d0b984ed272ed=function(e,r,i){e[r]=i},t.wbg.__wbg_set_b7f1cf4fae26fe2a=function(e,r,i){return e.set(r,i)},t.wbg.__wbg_setbody_c8460bdf44147df8=function(e,r){e.body=r},t.wbg.__wbg_setcache_90ca4ad8a8ad40d3=function(e,r){e.cache=rXe[r]},t.wbg.__wbg_setcredentials_9cd60d632c9d5dfc=function(e,r){e.credentials=iXe[r]},t.wbg.__wbg_setheaders_0052283e2f3503d1=function(e,r){e.headers=r},t.wbg.__wbg_sethighwatermark_3d5961f834647d41=function(e,r){e.highWaterMark=r},t.wbg.__wbg_setmethod_9b504d5b855b329c=function(e,r,i){e.method=lp(r,i)},t.wbg.__wbg_setmode_a23e1a2ad8b512f8=function(e,r){e.mode=nXe[r]},t.wbg.__wbg_setsignal_8c45ad1247a74809=function(e,r){e.signal=r},t.wbg.__wbg_signal_da4d466ce86118b5=function(e){return e.signal},t.wbg.__wbg_size_8f84e7768fba0589=function(e){return e.size},t.wbg.__wbg_slice_224856d46230c13c=function(){return Ka(function(e,r,i){return e.slice(r,i)},arguments)},t.wbg.__wbg_static_accessor_GLOBAL_8921f820c2ce3f12=function(){let e=typeof global>"u"?null:global;return uc(e)?0:j0(e)},t.wbg.__wbg_static_accessor_GLOBAL_THIS_f0a4409105898184=function(){let e=typeof globalThis>"u"?null:globalThis;return uc(e)?0:j0(e)},t.wbg.__wbg_static_accessor_SELF_995b214ae681ff99=function(){let e=typeof self>"u"?null:self;return uc(e)?0:j0(e)},t.wbg.__wbg_static_accessor_WINDOW_cde3890479c675ea=function(){let e=typeof window>"u"?null:window;return uc(e)?0:j0(e)},t.wbg.__wbg_status_3fea3036088621d6=function(e){return e.status},t.wbg.__wbg_stringify_b98c93d0a190446a=function(){return Ka(function(e){return JSON.stringify(e)},arguments)},t.wbg.__wbg_table_new=function(e){return qS.__wrap(e)},t.wbg.__wbg_then_b33a773d723afa3e=function(e,r,i){return e.then(r,i)},t.wbg.__wbg_then_e22500defe16819f=function(e,r){return e.then(r)},t.wbg.__wbg_toString_78df35411a4fd40c=function(e){return e.toString()},t.wbg.__wbg_url_e5720dfacf77b05e=function(e,r){let i=r.url,n=cp(i,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc;Lh().setInt32(e+4,o,!0),Lh().setInt32(e+0,n,!0)},t.wbg.__wbg_value_dd9372230531eade=function(e){return e.value},t.wbg.__wbg_view_91cc97d57ab30530=function(e){let r=e.view;return uc(r)?0:j0(r)},t.wbg.__wbg_wbindgenbigintgetasi64_ac743ece6ab9bba1=function(e,r){let i=r,n=typeof i=="bigint"?i:void 0;Lh().setBigInt64(e+8,uc(n)?BigInt(0):n,!0),Lh().setInt32(e+0,!uc(n),!0)},t.wbg.__wbg_wbindgenbooleanget_3fe6f642c7d97746=function(e){let r=e,i=typeof r=="boolean"?r:void 0;return uc(i)?16777215:i?1:0},t.wbg.__wbg_wbindgencbdrop_eb10308566512b88=function(e){let r=e.original;return r.cnt--==1?(r.a=0,!0):!1},t.wbg.__wbg_wbindgendebugstring_99ef257a3ddda34d=function(e,r){let i=bJ(r),n=cp(i,mt.__wbindgen_malloc,mt.__wbindgen_realloc),o=hc;Lh().setInt32(e+4,o,!0),Lh().setInt32(e+0,n,!0)},t.wbg.__wbg_wbindgenfunctiontable_aa1084b2969a9cbe=function(){return mt.__wbindgen_export_5},t.wbg.__wbg_wbindgenin_d7a1ee10933d2d55=function(e,r){return e in r},t.wbg.__wbg_wbindgenisbigint_ecb90cc08a5a9154=function(e){return typeof e=="bigint"},t.wbg.__wbg_wbindgenisfunction_8cee7dce3725ae74=function(e){return typeof e=="function"},t.wbg.__wbg_wbindgenisobject_307a53c6bd97fbf8=function(e){let r=e;return typeof r=="object"&&r!==null},t.wbg.__wbg_wbindgenisstring_d4fa939789f003b0=function(e){return typeof e=="string"},t.wbg.__wbg_wbindgenisundefined_c4b71d073b92f3c5=function(e){return e===void 0},t.wbg.__wbg_wbindgenjsvaleq_e6f2ad59ccae1b58=function(e,r){return e===r},t.wbg.__wbg_wbindgenjsvallooseeq_9bec8c9be826bed1=function(e,r){return e==r},t.wbg.__wbg_wbindgenmemory_d84da70f7c42d172=function(){return mt.memory},t.wbg.__wbg_wbindgennumberget_f74b4c7525ac05cb=function(e,r){let i=r,n=typeof i=="number"?i:void 0;Lh().setFloat64(e+8,uc(n)?0:n,!0),Lh().setInt32(e+0,!uc(n),!0)},t.wbg.__wbg_wbindgenstringget_0f16a6ddddef376f=function(e,r){let i=r,n=typeof i=="string"?i:void 0;var o=uc(n)?0:cp(n,mt.__wbindgen_malloc,mt.__wbindgen_realloc),s=hc;Lh().setInt32(e+4,s,!0),Lh().setInt32(e+0,o,!0)},t.wbg.__wbg_wbindgenthrow_451ec1a8469d7eb6=function(e,r){throw new Error(lp(e,r))},t.wbg.__wbg_writable_e5202c9fd57615db=function(e){return e.writable},t.wbg.__wbg_write_2e39e04a4c8c9e9d=function(e,r){return e.write(r)},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,r){return lp(e,r)},t.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(e){return e},t.wbg.__wbindgen_cast_e9d4edd5d697755b=function(e,r){return Rwe(e,r,317,QYe)},t.wbg.__wbindgen_cast_eb8544ce08914b2c=function(e,r){return Rwe(e,r,3778,JYe)},t.wbg.__wbindgen_init_externref_table=function(){let e=mt.__wbindgen_export_4,r=e.grow(4);e.set(0,void 0),e.set(r+0,void 0),e.set(r+1,null),e.set(r+2,!0),e.set(r+3,!1)},t}function uXe(t,e){return mt=t.exports,Ywe.__wbindgen_wasm_module=e,Vb=null,$6=null,j6=null,mt.__wbindgen_start(),mt}async function Ywe(t){if(mt!==void 0)return mt;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("parquet_wasm_bg.wasm",import.meta.url));let e=cXe();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));let{instance:r,module:i}=await lXe(await t,e);return uXe(r,i)}var Xwe=Ywe;var hXe="0.7.1",dXe=`https://cdn.jsdelivr.net/npm/parquet-wasm@${hXe}/esm/parquet_wasm_bg.wasm`,xJ=!1;async function Zwe(){xJ||(await Xwe(dXe),xJ=!0)}function fXe(t){if(!xJ)throw new Error("wasm not ready");console.time("readParquet");let e=qwe(new Uint8Array(t.buffer),{batchSize:Math.pow(2,31)}).intoIPCStream(),r=V6(e);return console.timeEnd("readParquet"),r}function K6(t){let e=[];for(let r of t){let i=fXe(r);i.batches.length!==1&&console.warn("Expected one batch"),e.push(...i.batches)}return new Fl(e)}function wJ(t){return t instanceof Array&&t?.[0]instanceof DataView?t?.[0].byteLength>0?K6(t).getChildAt(0):null:t}var Bh=class{model;callbacks;updateStateCallback;constructor(e,r){this.model=e,this.model.on("change",r),this.updateStateCallback=r,this.callbacks=new Map,this.callbacks.set("change",r)}initRegularAttribute(e,r){this[r]=this.model.get(e),this.model.off(`change:${e}`);let i=()=>{this[r]=this.model.get(e)};this.model.on(`change:${e}`,i),this.callbacks.set(`change:${e}`,i)}initVectorizedAccessor(e,r){this[r]=wJ(this.model.get(e)),this.model.off(`change:${e}`);let i=()=>{this[r]=wJ(this.model.get(e))};this.model.on(`change:${e}`,i),this.callbacks.set(`change:${e}`,i)}finalize(){for(let[e,r]of Object.entries(this.callbacks))this.model.off(e,r)}};var Qwe="https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json",FF=class extends Bh{mode;style;constructor(e,r){super(e,r),this.initRegularAttribute("mode","mode"),this.initRegularAttribute("style","style")}};var pXe="IPY_MODEL_",mXe=pXe.length;async function Gg(t,e,r,i){let n=await gXe(t,e),o={};for(let[s,a]of Object.entries(n))s in r?(o[s]=r[s],delete r[s]):o[s]=await i(a);for(let s of Object.values(r))s.finalize();return o}async function SJ(t,e){let r=e.slice(mXe);return t.get_model(r)}async function gXe(t,e){let r=e.map(o=>SJ(t,o)),i=await Promise.all(r),n={};for(let o=0;o<e.length;o++)n[e[o]]=i[o];return n}function TJ(t,e,r){let[i,n]=(0,NF.useState)(null);return(0,NF.useEffect)(()=>{(async()=>{try{if(!t){n(null);return}let s=await SJ(e,t),a=new FF(s,r);n(a)}catch(s){console.error("Error loading basemap model:",s)}})()},[t]),i}var iU=Tt($t(),1);var Jwe=`uniform brushingUniforms {
  bool enabled;
  highp int target;
  vec2 mousePos;
  float radius;
} brushing;
`,AXe=`
  in vec2 brushingTargets;

  out float brushing_isVisible;

  bool brushing_isPointInRange(vec2 position) {
    if (!brushing.enabled) {
      return true;
    }
    vec2 source_commonspace = project_position(position);
    vec2 target_commonspace = project_position(brushing.mousePos);
    float distance = length((target_commonspace - source_commonspace) / project.commonUnitsPerMeter.xy);

    return distance <= brushing.radius;
  }

  bool brushing_arePointsInRange(vec2 sourcePos, vec2 targetPos) {
    return brushing_isPointInRange(sourcePos) || brushing_isPointInRange(targetPos);
  }

  void brushing_setVisible(bool visible) {
    brushing_isVisible = float(visible);
  }
`,yXe=`
${Jwe}
${AXe}
`,_Xe=`
  in float brushing_isVisible;
`,vXe=`
${Jwe}
${_Xe}
`,bXe={source:0,target:1,custom:2,source_target:3},xXe={"vs:DECKGL_FILTER_GL_POSITION":`
    vec2 brushingTarget;
    vec2 brushingSource;
    if (brushing.target == 3) {
      brushingTarget = geometry.worldPositionAlt.xy;
      brushingSource = geometry.worldPosition.xy;
    } else if (brushing.target == 0) {
      brushingTarget = geometry.worldPosition.xy;
    } else if (brushing.target == 1) {
      brushingTarget = geometry.worldPositionAlt.xy;
    } else {
      brushingTarget = brushingTargets;
    }
    bool visible;
    if (brushing.target == 3) {
      visible = brushing_arePointsInRange(brushingSource, brushingTarget);
    } else {
      visible = brushing_isPointInRange(brushingTarget);
    }
    brushing_setVisible(visible);
  `,"fs:DECKGL_FILTER_COLOR":`
    if (brushing.enabled && brushing_isVisible < 0.5) {
      discard;
    }
  `},e2e={name:"brushing",dependencies:[Uf],vs:yXe,fs:vXe,inject:xXe,getUniforms:t=>{if(!t||!("viewport"in t))return{};let{brushingEnabled:e=!0,brushingRadius:r=1e4,brushingTarget:i="source",mousePosition:n,viewport:o}=t;return{enabled:!!(e&&n&&o.containsPixel(n)),radius:r,target:bXe[i]||0,mousePos:n?o.unproject([n.x-o.x,n.y-o.y]):[0,0]}},uniformTypes:{enabled:"i32",target:"i32",mousePos:"vec2<f32>",radius:"f32"}};var wXe={getBrushingTarget:{type:"accessor",value:[0,0]},brushingTarget:"source",brushingEnabled:!0,brushingRadius:1e4},Q6=class extends Pg{getShaders(){return{modules:[e2e]}}initializeState(e,r){let i=this.getAttributeManager();i&&i.add({brushingTargets:{size:2,stepMode:"dynamic",accessor:"getBrushingTarget"}});let n=()=>{this.getCurrentLayer()?.setNeedsRedraw()};this.state.onMouseMove=n,e.deck&&e.deck.eventManager.on({pointermove:n,pointerleave:n})}finalizeState(e,r){if(e.deck){let i=this.state.onMouseMove;e.deck.eventManager.off({pointermove:i,pointerleave:i})}}draw(e,r){let{viewport:i,mousePosition:n}=e.context,{brushingEnabled:o,brushingRadius:s,brushingTarget:a}=this.props,u={viewport:i,mousePosition:n,brushingEnabled:o,brushingRadius:s,brushingTarget:a};this.setShaderModuleProps({brushing:u})}};Q6.defaultProps=wXe;Q6.extensionName="BrushingExtension";var MJ=Q6;var t2e=`uniform dataFilterUniforms {
  bool useSoftMargin;
  bool enabled;
  bool transformSize;
  bool transformColor;
#ifdef DATAFILTER_TYPE
  DATAFILTER_TYPE min;
  DATAFILTER_TYPE softMin;
  DATAFILTER_TYPE softMax;
  DATAFILTER_TYPE max;
#ifdef DATAFILTER_DOUBLE
  DATAFILTER_TYPE min64High;
  DATAFILTER_TYPE max64High;
#endif
#endif
#ifdef DATACATEGORY_TYPE
  highp uvec4 categoryBitMask;
#endif
} dataFilter;
`,SXe=`
#ifdef DATAFILTER_TYPE
  in DATAFILTER_TYPE filterValues;
#ifdef DATAFILTER_DOUBLE
  in DATAFILTER_TYPE filterValues64Low;
#endif
#endif

#ifdef DATACATEGORY_TYPE
  in DATACATEGORY_TYPE filterCategoryValues;
#endif

out float dataFilter_value;

float dataFilter_reduceValue(float value) {
  return value;
}
float dataFilter_reduceValue(vec2 value) {
  return min(value.x, value.y);
}
float dataFilter_reduceValue(vec3 value) {
  return min(min(value.x, value.y), value.z);
}
float dataFilter_reduceValue(vec4 value) {
  return min(min(value.x, value.y), min(value.z, value.w));
}

#ifdef DATAFILTER_TYPE
  void dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {
    if (dataFilter.useSoftMargin) {
      // smoothstep results are undefined if edge0 \u2265 edge1
      // Fallback to ignore filterSoftRange if it is truncated by filterRange
      DATAFILTER_TYPE leftInRange = mix(
        smoothstep(dataFilter.min, dataFilter.softMin, valueFromMin),
        step(dataFilter.min, valueFromMin),
        step(dataFilter.softMin, dataFilter.min)
      );
      DATAFILTER_TYPE rightInRange = mix(
        1.0 - smoothstep(dataFilter.softMax, dataFilter.max, valueFromMax),
        step(valueFromMax, dataFilter.max),
        step(dataFilter.max, dataFilter.softMax)
      );
      dataFilter_value = dataFilter_reduceValue(leftInRange * rightInRange);
    } else {
      dataFilter_value = dataFilter_reduceValue(
        step(dataFilter.min, valueFromMin) * step(valueFromMax, dataFilter.max)
      );
    }
  }
#endif

#ifdef DATACATEGORY_TYPE
  void dataFilter_setCategoryValue(DATACATEGORY_TYPE category) {
    #if DATACATEGORY_CHANNELS == 1 // One 128-bit mask
    uint dataFilter_masks = dataFilter.categoryBitMask[category / 32u];
    #elif DATACATEGORY_CHANNELS == 2 // Two 64-bit masks
    uvec2 dataFilter_masks = uvec2(
      dataFilter.categoryBitMask[category.x / 32u],
      dataFilter.categoryBitMask[category.y / 32u + 2u]
    );
    #elif DATACATEGORY_CHANNELS == 3 // Three 32-bit masks
    uvec3 dataFilter_masks = dataFilter.categoryBitMask.xyz;
    #else // Four 32-bit masks
    uvec4 dataFilter_masks = dataFilter.categoryBitMask;
    #endif

    // Shift mask and extract relevant bits
    DATACATEGORY_TYPE dataFilter_bits = DATACATEGORY_TYPE(dataFilter_masks) >> (category & 31u);
    dataFilter_bits &= 1u;

    #if DATACATEGORY_CHANNELS == 1
    if(dataFilter_bits == 0u) dataFilter_value = 0.0;
    #else
    if(any(equal(dataFilter_bits, DATACATEGORY_TYPE(0u)))) dataFilter_value = 0.0;
    #endif
  }
#endif
`,r2e=`
${t2e}
${SXe}
`,TXe=`
in float dataFilter_value;
`,i2e=`
${t2e}
${TXe}
`;function n2e(t){if(!t||!("extensions"in t))return{};let{filterRange:e=[-1,1],filterEnabled:r=!0,filterTransformSize:i=!0,filterTransformColor:n=!0,categoryBitMask:o}=t,s=t.filterSoftRange||e;return{...Number.isFinite(e[0])?{min:e[0],softMin:s[0],softMax:s[1],max:e[1]}:{min:e.map(a=>a[0]),softMin:s.map(a=>a[0]),softMax:s.map(a=>a[1]),max:e.map(a=>a[1])},enabled:r,useSoftMargin:!!t.filterSoftRange,transformSize:r&&i,transformColor:r&&n,...o&&{categoryBitMask:o}}}function MXe(t){if(!t||!("extensions"in t))return{};let e=n2e(t);if(Number.isFinite(e.min)){let r=Math.fround(e.min);e.min-=r,e.softMin-=r,e.min64High=r;let i=Math.fround(e.max);e.max-=i,e.softMax-=i,e.max64High=i}else{let r=e.min.map(Math.fround);e.min=e.min.map((n,o)=>n-r[o]),e.softMin=e.softMin.map((n,o)=>n-r[o]),e.min64High=r;let i=e.max.map(Math.fround);e.max=e.max.map((n,o)=>n-i[o]),e.softMax=e.softMax.map((n,o)=>n-i[o]),e.max64High=i}return e}var o2e={"vs:#main-start":`
    dataFilter_value = 1.0;
    if (dataFilter.enabled) {
      #ifdef DATAFILTER_TYPE
        #ifdef DATAFILTER_DOUBLE
          dataFilter_setValue(
            filterValues - dataFilter.min64High + filterValues64Low,
            filterValues - dataFilter.max64High + filterValues64Low
          );
        #else
          dataFilter_setValue(filterValues, filterValues);
        #endif
      #endif

      #ifdef DATACATEGORY_TYPE
        dataFilter_setCategoryValue(filterCategoryValues);
      #endif
    }
  `,"vs:#main-end":`
    if (dataFilter_value == 0.0) {
      gl_Position = vec4(0.);
    }
  `,"vs:DECKGL_FILTER_SIZE":`
    if (dataFilter.transformSize) {
      size = size * dataFilter_value;
    }
  `,"fs:DECKGL_FILTER_COLOR":`
    if (dataFilter_value == 0.0) discard;
    if (dataFilter.transformColor) {
      color.a *= dataFilter_value;
    }
  `};function s2e(t){let{categorySize:e,filterSize:r,fp64:i}=t,n={useSoftMargin:"i32",enabled:"i32",transformSize:"i32",transformColor:"i32"};if(r){let o=r===1?"f32":`vec${r}<f32>`;n.min=o,n.softMin=o,n.softMax=o,n.max=o,i&&(n.min64High=o,n.max64High=o)}return e&&(n.categoryBitMask="vec4<i32>"),n}var a2e={name:"dataFilter",vs:r2e,fs:i2e,inject:o2e,getUniforms:n2e,uniformTypesFromOptions:s2e},l2e={name:"dataFilter",vs:r2e,fs:i2e,inject:o2e,getUniforms:MXe,uniformTypesFromOptions:s2e};var EXe=`#version 300 es
#define SHADER_NAME data-filter-vertex-shader

#ifdef FLOAT_TARGET
  in float filterIndices;
  in float filterPrevIndices;
#else
  in vec2 filterIndices;
  in vec2 filterPrevIndices;
#endif

out vec4 vColor;
const float component = 1.0 / 255.0;

void main() {
  #ifdef FLOAT_TARGET
    dataFilter_value *= float(filterIndices != filterPrevIndices);
    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
    vColor = vec4(0.0, 0.0, 0.0, 1.0);
  #else
    // Float texture is not supported: pack result into 4 channels x 256 px x 64px
    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);
    float col = filterIndices.x;
    float row = filterIndices.y * 4.0;
    float channel = floor(row);
    row = fract(row);
    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));
    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);
  #endif
  gl_PointSize = 1.0;
}
`,CXe=`#version 300 es
#define SHADER_NAME data-filter-fragment-shader
precision highp float;

in vec4 vColor;

out vec4 fragColor;

void main() {
  if (dataFilter_value < 0.5) {
    discard;
  }
  fragColor = vColor;
}
`,PXe=["float32-renderable-webgl","texture-blend-float-webgl"];function c2e(t){return PXe.every(e=>t.features.has(e))}function u2e(t,e){return e?t.createFramebuffer({width:1,height:1,colorAttachments:[t.createTexture({format:"rgba32float",dimension:"2d",width:1,height:1})]}):t.createFramebuffer({width:256,height:64,colorAttachments:[t.createTexture({format:"rgba8unorm",dimension:"2d",width:256,height:64})]})}function h2e(t,e,r,i){return r.defines.NON_INSTANCED_MODEL=1,i&&(r.defines.FLOAT_TARGET=1),new bn(t,{id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,topology:"point-list",disableWarnings:!0,vs:EXe,fs:CXe,bufferLayout:e,...r})}var d2e={blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:"add",blendAlphaOperation:"add",depthCompare:"never"};var kXe={getFilterValue:{type:"accessor",value:0},getFilterCategory:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,optional:!0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterCategories:[0],filterTransformSize:!0,filterTransformColor:!0},RXe={categorySize:0,filterSize:1,fp64:!1,countItems:!1},OXe={1:"uint",2:"uvec2",3:"uvec3",4:"uvec4"},DXe={1:"float",2:"vec2",3:"vec3",4:"vec4"},J6=class extends Pg{constructor(e={}){super({...RXe,...e})}getShaders(e){let{categorySize:r,filterSize:i,fp64:n}=e.opts,o={};r&&(o.DATACATEGORY_TYPE=OXe[r],o.DATACATEGORY_CHANNELS=r),i&&(o.DATAFILTER_TYPE=DXe[i],o.DATAFILTER_DOUBLE=!!n);let s=n?l2e:a2e;return s.uniformTypes=s.uniformTypesFromOptions(e.opts),{modules:[s],defines:o}}initializeState(e,r){let i=this.getAttributeManager(),{categorySize:n,filterSize:o,fp64:s}=r.opts;i&&(o&&i.add({filterValues:{size:o,type:s?"float64":"float32",stepMode:"dynamic",accessor:"getFilterValue"}}),n&&i.add({filterCategoryValues:{size:n,stepMode:"dynamic",accessor:"getFilterCategory",type:"uint32",transform:n===1?u=>r._getCategoryKey.call(this,u,0):u=>u.map((p,m)=>r._getCategoryKey.call(this,p,m))}}));let{device:a}=this.context;if(i&&r.opts.countItems){let u=c2e(a);i.add({filterVertexIndices:{size:u?1:2,vertexOffset:1,type:"unorm8",accessor:(x,{index:M})=>{let k=x&&x.__source?x.__source.index:M;return u?(k+1)%255:[(k+1)%255,Math.floor(k/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});let p=u2e(a,u),m=h2e(a,i.getBufferLayouts({isInstanced:!1}),r.getShaders.call(this,r),u);this.setState({filterFBO:p,filterModel:m})}}updateState({props:e,oldProps:r,changeFlags:i},n){let o=this.getAttributeManager(),{categorySize:s}=n.opts;if(this.state.filterModel){let a=o.attributes.filterValues?.needsUpdate()||o.attributes.filterCategoryValues?.needsUpdate()||e.filterEnabled!==r.filterEnabled||e.filterRange!==r.filterRange||e.filterSoftRange!==r.filterSoftRange||e.filterCategories!==r.filterCategories;a&&this.setState({filterNeedsUpdate:a})}o?.attributes.filterCategoryValues&&((o.attributes.filterCategoryValues.needsUpdate()||!vo(e.filterCategories,r.filterCategories,2))&&this.setState({categoryBitMask:null}),i.dataChanged&&(this.setState({categoryMap:Array(s).fill(0).map(()=>({}))}),o.attributes.filterCategoryValues.setNeedsUpdate("categoryMap")))}draw(e,r){let i=this.state.filterFBO,n=this.state.filterModel,o=this.state.filterNeedsUpdate;this.state.categoryBitMask||r._updateCategoryBitMask.call(this,e,r);let{onFilteredItemsChange:s,extensions:a,filterEnabled:u,filterRange:p,filterSoftRange:m,filterTransformSize:x,filterTransformColor:M,filterCategories:k}=this.props,F={extensions:a,filterEnabled:u,filterRange:p,filterSoftRange:m,filterTransformSize:x,filterTransformColor:M,filterCategories:k};if(this.state.categoryBitMask&&(F.categoryBitMask=this.state.categoryBitMask),this.setShaderModuleProps({dataFilter:F}),o&&s&&n){let j=this.getAttributeManager(),{attributes:{filterValues:H,filterCategoryValues:W,filterVertexIndices:Z}}=j;n.setVertexCount(this.getNumInstances());let Y={...H?.getValue(),...W?.getValue(),...Z?.getValue()};n.setAttributes(Y),n.shaderInputs.setProps({dataFilter:F});let ee=[0,0,i.width,i.height],ce=n.device.beginRenderPass({id:"data-filter-aggregation",framebuffer:i,parameters:{viewport:ee},clearColor:[0,0,0,0]});n.setParameters(d2e),n.draw(ce),ce.end();let ge=n.device.readPixelsToArrayWebGL(i),Se=0;for(let ne=0;ne<ge.length;ne++)Se+=ge[ne];s({id:this.id,count:Se}),this.state.filterNeedsUpdate=!1}}finalizeState(){let e=this.state.filterFBO,r=this.state.filterModel;e?.destroy(),r?.destroy()}_updateCategoryBitMask(e,r){let{categorySize:i}=r.opts;if(!i)return;let{filterCategories:n}=this.props,o=new Uint32Array([0,0,0,0]),s=i===1?[n]:n,a=i===1?128:i===2?64:32;for(let u=0;u<s.length;u++){let p=s[u];for(let m of p){let x=r._getCategoryKey.call(this,m,u);if(x<a){let M=u*(a/32)+Math.floor(x/32);o[M]+=Math.pow(2,x%32)}else mr.warn(`Exceeded maximum number of categories (${a})`)()}}this.state.categoryBitMask=o}_getCategoryKey(e,r){let i=this.state.categoryMap[r];return e in i||(i[e]=Object.keys(i).length),i[e]}};J6.defaultProps=kXe;J6.extensionName="DataFilterExtension";var zF=J6;var f2e={inject:{"vs:#decl":`
in vec2 instanceDashArrays;
in float instanceDashOffsets;
out vec2 vDashArray;
out float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform pathStyleUniforms {
float dashAlignMode;
bool dashGapPickable;
} pathStyle;
in vec2 vDashArray;
in float vDashOffset;
`,"fs:#main-start":`
float solidLength = vDashArray.x;
float gapLength = vDashArray.y;
float unitLength = solidLength + gapLength;
float offset;
if (unitLength > 0.0) {
if (pathStyle.dashAlignMode == 0.0) {
offset = vDashOffset;
} else {
unitLength = vPathLength / round(vPathLength / unitLength);
offset = solidLength / 2.0;
}
float unitOffset = mod(vPathPosition.y + offset, unitLength);
if (gapLength > 0.0 && unitOffset > solidLength) {
if (path.capType <= 0.5) {
if (!(pathStyle.dashGapPickable && bool(picking.isActive))) {
discard;
}
} else {
float distToEnd = length(vec2(
min(unitOffset - solidLength, unitLength - unitOffset),
vPathPosition.x
));
if (distToEnd > 1.0) {
if (!(pathStyle.dashGapPickable && bool(picking.isActive))) {
discard;
}
}
}
}
}
`}},p2e={inject:{"vs:#decl":`
in float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
size *= offsetWidth;
`,"vs:#main-end":`
float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
float offsetDir = sign(instanceOffsets);
vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
vPathPosition.y *= offsetWidth;
vPathLength *= offsetWidth;
`,"fs:#main-start":`
float isInside;
isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
if (isInside == 0.0) {
discard;
}
`}};var LXe={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1},eI=class extends Pg{constructor({dash:e=!1,offset:r=!1,highPrecisionDash:i=!1}={}){super({dash:e||i,offset:r,highPrecisionDash:i})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let r={};e.opts.dash&&(r=gb(r,f2e)),e.opts.offset&&(r=gb(r,p2e));let{inject:i}=r;return{modules:[{name:"pathStyle",inject:i,uniformTypes:{dashAlignMode:"f32",dashGapPickable:"i32"}}]}}initializeState(e,r){let i=this.getAttributeManager();!i||!r.isEnabled(this)||(r.opts.dash&&i.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"},instanceDashOffsets:r.opts.highPrecisionDash?{size:1,accessor:"getPath",transform:r.getDashOffsets.bind(this)}:{size:1,update:n=>{n.constant=!0,n.value=[0]}}}),r.opts.offset&&i.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,r){if(r.isEnabled(this)&&r.opts.dash){let i={dashAlignMode:this.props.dashJustified?1:0,dashGapPickable:!!this.props.dashGapPickable};this.setShaderModuleProps({pathStyle:i})}}getDashOffsets(e){let r=[0],i=this.props.positionFormat==="XY"?2:3,n=Array.isArray(e[0]),o=n?e.length:e.length/i,s,a;for(let u=0;u<o-1;u++)s=n?e[u]:e.slice(u*i,u*i+i),s=this.projectPosition(s),u>0&&(r[u]=r[u-1]+Ol.dist(a,s)),a=s;return r[o-1]=0,r}};eI.defaultProps=LXe;eI.extensionName="PathStyleExtension";var EJ=eI;var BXe=`
in float collisionPriorities;

uniform sampler2D collision_texture;

uniform collisionUniforms {
  bool sort;
  bool enabled;
} collision;

vec2 collision_getCoords(vec4 position) {
  vec4 collision_clipspace = project_common_position_to_clipspace(position);
  return (1.0 + collision_clipspace.xy / collision_clipspace.w) / 2.0;
}

float collision_match(vec2 tex, vec3 pickingColor) {
  vec4 collision_pickingColor = texture(collision_texture, tex);
  float delta = dot(abs(collision_pickingColor.rgb - pickingColor), vec3(1.0));
  float e = 0.001;
  return step(delta, e);
}

float collision_isVisible(vec2 texCoords, vec3 pickingColor) {
  if (!collision.enabled) {
    return 1.0;
  }

  // Visibility test, sample area of 5x5 pixels in order to fade in/out.
  // Due to the locality, the lookups will be cached
  // This reduces the flicker present when objects are shown/hidden
  const int N = 2;
  float accumulator = 0.0;
  vec2 step = vec2(1.0 / project.viewportSize);

  const float floatN = float(N);
  vec2 delta = -floatN * step;
  for(int i = -N; i <= N; i++) {
    delta.x = -step.x * floatN;
    for(int j = -N; j <= N; j++) {
      accumulator += collision_match(texCoords + delta, pickingColor);
      delta.x += step.x;
    }
    delta.y += step.y;
  }

  float W = 2.0 * floatN + 1.0;
  return pow(accumulator / (W * W), 2.2);
}
`,FXe={"vs:#decl":`
  float collision_fade = 1.0;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  if (collision.sort) {
    float collisionPriority = collisionPriorities;
    position.z = -0.001 * collisionPriority * position.w; // Support range -1000 -> 1000
  }

  if (collision.enabled) {
    vec4 collision_common_position = project_position(vec4(geometry.worldPosition, 1.0));
    vec2 collision_texCoords = collision_getCoords(collision_common_position);
    collision_fade = collision_isVisible(collision_texCoords, geometry.pickingColor / 255.0);
    if (collision_fade < 0.0001) {
      // Position outside clip space bounds to discard
      position = vec4(0.0, 0.0, 2.0, 1.0);
    }
  }
  `,"vs:DECKGL_FILTER_COLOR":`
  color.a *= collision_fade;
  `},NXe=t=>{if(!t||!("dummyCollisionMap"in t))return{};let{enabled:e,collisionFBO:r,drawToCollisionMap:i,dummyCollisionMap:n}=t;return{enabled:e&&!i,sort:!!i,collision_texture:!i&&r?r.colorAttachments[0]:n}},m2e={name:"collision",dependencies:[Uf],vs:BXe,inject:FXe,getUniforms:NXe,uniformTypes:{sort:"i32",enabled:"i32"}};var tI=class extends Id{renderCollisionMap(e,r){let n=[0,0,0,0],o=[1,1,e.width-2,e.height-2];this.render({...r,clearColor:n,scissorRect:o,target:e,pass:"collision"})}getLayerParameters(e,r,i){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}getShaderModuleProps(){return{collision:{drawToCollisionMap:!0},picking:{isActive:1,isAttribute:!1},lighting:{enabled:!1}}}};var CJ=2,rI=class{constructor(){this.id="collision-filter-effect",this.props=null,this.useInPicking=!0,this.order=1,this.channels={},this.collisionFBOs={}}setup(e){this.context=e;let{device:r}=e;this.dummyCollisionMap=r.createTexture({width:1,height:1}),this.collisionFilterPass=new tI(r,{id:"default-collision-filter"})}preRender({effects:e,layers:r,layerFilter:i,viewports:n,onViewportActive:o,views:s,isPicking:a,preRenderStats:u={}}){let{device:p}=this.context;if(a)return;let m=r.filter(({props:{visible:H,collisionEnabled:W}})=>H&&W);if(m.length===0){this.channels={};return}let x=e?.filter(H=>H.useInPicking&&u[H.id]),M=u["mask-effect"]?.didRender,k=this._groupByCollisionGroup(p,m),F=n[0],j=!this.lastViewport||!this.lastViewport.equals(F)||M;for(let H in k){let W=this.collisionFBOs[H],Z=k[H],[Y,ee]=p.canvasContext.getPixelSize();W.resize({width:Y/CJ,height:ee/CJ}),this._render(Z,{effects:x,layerFilter:i,onViewportActive:o,views:s,viewport:F,viewportChanged:j})}}_render(e,{effects:r,layerFilter:i,onViewportActive:n,views:o,viewport:s,viewportChanged:a}){let{collisionGroup:u}=e,p=this.channels[u];if(!p)return;let m=a||e===p||!vo(p.layers,e.layers,1)||e.layerBounds.some((x,M)=>!ra(x,p.layerBounds[M]))||e.allLayersLoaded!==p.allLayersLoaded||e.layers.some(x=>x.props.transitions);if(this.channels[u]=e,m){this.lastViewport=s;let x=this.collisionFBOs[u];this.collisionFilterPass.renderCollisionMap(x,{pass:"collision-filter",isPicking:!0,layers:e.layers,effects:r,layerFilter:i,viewports:s?[s]:[],onViewportActive:n,views:o,shaderModuleProps:{collision:{enabled:!0,dummyCollisionMap:this.dummyCollisionMap},project:{devicePixelRatio:x.device.canvasContext.getDevicePixelRatio()/CJ}}})}}_groupByCollisionGroup(e,r){let i={};for(let n of r){let o=n.props.collisionGroup,s=i[o];s||(s={collisionGroup:o,layers:[],layerBounds:[],allLayersLoaded:!0},i[o]=s),s.layers.push(n),s.layerBounds.push(n.getBounds()),n.isLoaded||(s.allLayersLoaded=!1)}for(let n of Object.keys(i))this.collisionFBOs[n]||this.createFBO(e,n),this.channels[n]||(this.channels[n]=i[n]);for(let n of Object.keys(this.collisionFBOs))i[n]||this.destroyFBO(n);return i}getShaderModuleProps(e){let{collisionGroup:r,collisionEnabled:i}=e.props,{collisionFBOs:n,dummyCollisionMap:o}=this,s=n[r];return{collision:{enabled:i&&!!s,collisionFBO:s,dummyCollisionMap:o}}}cleanup(){this.dummyCollisionMap&&(this.dummyCollisionMap.delete(),this.dummyCollisionMap=void 0),this.channels={};for(let e of Object.keys(this.collisionFBOs))this.destroyFBO(e);this.collisionFBOs={},this.lastViewport=void 0}createFBO(e,r){let{width:i,height:n}=e.getDefaultCanvasContext().canvas,o=e.createTexture({format:"rgba8unorm",width:i,height:n,sampler:{minFilter:"nearest",magFilter:"nearest",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),s=e.createTexture({format:"depth16unorm",width:i,height:n});this.collisionFBOs[r]=e.createFramebuffer({id:`collision-${r}`,width:i,height:n,colorAttachments:[o],depthStencilAttachment:s})}destroyFBO(e){let r=this.collisionFBOs[e];r.colorAttachments[0]?.destroy(),r.depthStencilAttachment?.destroy(),r.destroy(),delete this.collisionFBOs[e]}};var zXe={getCollisionPriority:{type:"accessor",value:0},collisionEnabled:!0,collisionGroup:{type:"string",value:"default"},collisionTestProps:{}},iI=class extends Pg{getShaders(){return{modules:[m2e]}}draw({shaderModuleProps:e}){e.collision?.drawToCollisionMap&&(this.props=this.clone(this.props.collisionTestProps).props)}initializeState(e,r){if(this.getAttributeManager()===null)return;this.context.deck?._addDefaultEffect(new rI),this.getAttributeManager().add({collisionPriorities:{size:1,stepMode:"dynamic",accessor:"getCollisionPriority"}})}getNeedsPickingBuffer(){return this.props.collisionEnabled}};iI.defaultProps=zXe;iI.extensionName="CollisionFilterExtension";var PJ=iI;var $b=class extends Bh{static extensionType;constructor(e,r){super(e,r)}},nI=class extends $b{static extensionType="brushing";constructor(e,r,i){super(e,i),r.initRegularAttribute("brushing_enabled","brushingEnabled"),r.initRegularAttribute("brushing_target","brushingTarget"),r.initRegularAttribute("brushing_radius","brushingRadius"),r.initVectorizedAccessor("get_brushing_target","getBrushingTarget"),r.extensionLayerPropertyNames=[...r.extensionLayerPropertyNames,"brushingEnabled","brushingTarget","brushingRadius","getBrushingTarget"]}extensionInstance(){return new MJ}},oI=class extends $b{static extensionType="collision-filter";constructor(e,r,i){super(e,i),r.initRegularAttribute("collision_enabled","collisionEnabled"),r.initRegularAttribute("collision_group","collisionGroup"),r.initRegularAttribute("collision_test_props","collisionTestProps"),r.initVectorizedAccessor("get_collision_priority","getCollisionPriority"),r.extensionLayerPropertyNames=[...r.extensionLayerPropertyNames,"collisionEnabled","collisionGroup","collisionTestProps","getCollisionPriority"]}extensionInstance(){return new PJ}},UF=class extends $b{static extensionType="data-filter";categorySize;filterSize;constructor(e,r,i){super(e,i),this.initRegularAttribute("filter_size","filterSize"),this.initRegularAttribute("category_size","categorySize"),r.initRegularAttribute("filter_categories","filterCategories"),r.initRegularAttribute("filter_enabled","filterEnabled"),r.initRegularAttribute("filter_range","filterRange"),r.initRegularAttribute("filter_soft_range","filterSoftRange"),r.initRegularAttribute("filter_transform_size","filterTransformSize"),r.initRegularAttribute("filter_transform_color","filterTransformColor"),r.initVectorizedAccessor("get_filter_category","getFilterCategory"),r.initVectorizedAccessor("get_filter_value","getFilterValue"),r.extensionLayerPropertyNames=[...r.extensionLayerPropertyNames,"filterCategories","filterEnabled","filterRange","filterSoftRange","filterTransformSize","filterTransformColor","getFilterCategory","getFilterValue"]}extensionInstance(){if(Ze(this.filterSize)){let e={...Ze(this.filterSize)?{filterSize:this.filterSize}:{}};return new zF(e)}else if(Ze(this.categorySize)){let e={...Ze(this.categorySize)?{categorySize:this.categorySize}:{}};return new zF(e)}else return null}},sI=class extends $b{static extensionType="path-style";dash;offset;highPrecisionDash;constructor(e,r,i){super(e,i),this.initRegularAttribute("dash","dash"),this.initRegularAttribute("high_precision_dash","highPrecisionDash"),this.initRegularAttribute("offset","offset"),r.initRegularAttribute("dash_gap_pickable","dashGapPickable"),r.initRegularAttribute("dash_justified","dashJustified"),r.initVectorizedAccessor("get_dash_array","getDashArray"),r.initVectorizedAccessor("get_offset","getOffset"),r.extensionLayerPropertyNames=[...r.extensionLayerPropertyNames,"dashGapPickable","dashJustified","getDashArray","getOffset"]}extensionInstance(){return new EJ({...Ze(this.dash)?{dash:this.dash}:{},...Ze(this.highPrecisionDash)?{highPrecisionDash:this.highPrecisionDash}:{},...Ze(this.offset)?{offset:this.offset}:{}})}};async function IJ(t,e,r){let i=t.get("_extension_type"),n;switch(i){case nI.extensionType:n=new nI(t,e,r);break;case oI.extensionType:n=new oI(t,e,r);break;case UF.extensionType:n=new UF(t,e,r);break;case sI.extensionType:n=new sI(t,e,r);break;default:throw new Error(`no known model for extension type ${i}`)}return n}var Hg=class extends Bh{pickable;visible;opacity;autoHighlight;highlightColor;beforeId;extensions;extensionLayerPropertyNames=[];constructor(e,r){super(e,r),this.initRegularAttribute("pickable","pickable"),this.initRegularAttribute("visible","visible"),this.initRegularAttribute("opacity","opacity"),this.initRegularAttribute("auto_highlight","autoHighlight"),this.initRegularAttribute("highlight_color","highlightColor"),this.initRegularAttribute("before_id","beforeId"),this.initRegularAttribute("selected_bounds","selectedBounds"),this.extensions={}}async loadSubModels(){await this.initLayerExtensions()}extensionInstances(){return Object.values(this.extensions).map(e=>e.extensionInstance()).filter(e=>e!==null)}extensionProps(e){let r={};for(let i of this.extensionLayerPropertyNames){let n=this[i];Ze(n)&&(n instanceof Or?r[i]=n.data[e??0]:r[i]=n)}return r}onClick(e){e.index&&(this.model.set("selected_index",e.index),this.model.save_changes())}baseLayerProps(e){return{extensions:this.extensionInstances(),...this.extensionProps(e),pickable:this.pickable,visible:this.visible,opacity:this.opacity,autoHighlight:this.autoHighlight,...Ze(this.highlightColor)&&{highlightColor:this.highlightColor},onClick:this.onClick.bind(this),...Ze(this.beforeId)&&{beforeId:this.beforeId}}}async initLayerExtensions(){let e=async()=>{let r=this.model.get("extensions"),i=await Gg(this.model.widget_manager,r,this.extensions,async n=>IJ(n,this,this.updateStateCallback));this.extensions=i};await e(),this.model.off("change:extensions"),this.model.on("change:extensions",e),this.callbacks.set("change:extensions",e)}},sa=class extends Hg{table;constructor(e,r){super(e,r),this.initTable("table")}initTable(e){this.table=K6(this.model.get(e)),this.model.off(`change:${e}`);let r=()=>{this.table=K6(this.model.get(e))};this.model.on(`change:${e}`,r),this.callbacks.set(`change:${e}`,r)}};var g2e=`uniform arcUniforms {
  bool greatCircle;
  bool useShortestPath;
  float numSegments;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int widthUnits;
} arc;
`,A2e={name:"arc",vs:g2e,fs:g2e,uniformTypes:{greatCircle:"f32",useShortestPath:"f32",numSegments:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",widthUnits:"i32"}};var y2e=`#version 300 es
#define SHADER_NAME arc-layer-vertex-shader
in vec4 instanceSourceColors;
in vec4 instanceTargetColors;
in vec3 instanceSourcePositions;
in vec3 instanceSourcePositions64Low;
in vec3 instanceTargetPositions;
in vec3 instanceTargetPositions64Low;
in vec3 instancePickingColors;
in float instanceWidths;
in float instanceHeights;
in float instanceTilts;
out vec4 vColor;
out vec2 uv;
out float isValid;
float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {
float deltaZ = targetZ - sourceZ;
float dh = distance * instanceHeights;
if (dh == 0.0) {
return sourceZ + deltaZ * ratio;
}
float unitZ = deltaZ / dh;
float p2 = unitZ * unitZ + 1.0;
float dir = step(deltaZ, 0.0);
float z0 = mix(sourceZ, targetZ, dir);
float r = mix(ratio, 1.0 - ratio, dir);
return sqrt(r * (p2 - r)) * dh + z0;
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
vec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);
dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
return dir_screenspace * offset_direction * width / 2.0;
}
float getSegmentRatio(float index) {
return smoothstep(0.0, 1.0, index / (arc.numSegments - 1.0));
}
vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
float distance = length(source.xy - target.xy);
float z = paraboloid(distance, source.z, target.z, segmentRatio);
float tiltAngle = radians(instanceTilts);
vec2 tiltDirection = normalize(target.xy - source.xy);
vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);
return vec3(
mix(source.xy, target.xy, segmentRatio) + tilt,
z * cos(tiltAngle)
);
}
float getAngularDist (vec2 source, vec2 target) {
vec2 sourceRadians = radians(source);
vec2 targetRadians = radians(target);
vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
vec2 shd_sq = sin_half_delta * sin_half_delta;
float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
return 2.0 * asin(sqrt(a));
}
vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
vec2 lngLat;
if(abs(angularDist - PI) < 0.001) {
lngLat = (1.0 - t) * source.xy + t * target.xy;
} else {
float a = sin((1.0 - t) * angularDist);
float b = sin(t * angularDist);
vec3 p = source3D.yxz * a + target3D.yxz * b;
lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
}
float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);
return vec3(lngLat, z);
}
void main(void) {
geometry.worldPosition = instanceSourcePositions;
geometry.worldPositionAlt = instanceTargetPositions;
float segmentIndex = float(gl_VertexID / 2);
float segmentSide = mod(float(gl_VertexID), 2.) == 0. ? -1. : 1.;
float segmentRatio = getSegmentRatio(segmentIndex);
float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
float nextSegmentRatio = getSegmentRatio(min(arc.numSegments - 1.0, segmentIndex + 1.0));
float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
isValid = 1.0;
uv = vec2(segmentRatio, segmentSide);
geometry.uv = uv;
geometry.pickingColor = instancePickingColors;
vec4 curr;
vec4 next;
vec3 source;
vec3 target;
if ((arc.greatCircle || project.projectionMode == PROJECTION_MODE_GLOBE) && project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);
vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);
if (abs(currPos.x - prevPos.x) > 180.0) {
indexDir = -1.0;
isValid = 0.0;
} else if (abs(currPos.x - nextPos.x) > 180.0) {
indexDir = 1.0;
isValid = 0.0;
}
nextPos = indexDir < 0.0 ? prevPos : nextPos;
nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
if (isValid == 0.0) {
nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
currPos = mix(currPos, nextPos, t);
segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
}
vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
} else {
vec3 source_world = instanceSourcePositions;
vec3 target_world = instanceTargetPositions;
if (arc.useShortestPath) {
source_world.x = mod(source_world.x + 180., 360.0) - 180.;
target_world.x = mod(target_world.x + 180., 360.0) - 180.;
float deltaLng = target_world.x - source_world.x;
if (deltaLng > 180.) target_world.x -= 360.;
if (deltaLng < -180.) source_world.x -= 360.;
}
source = project_position(source_world, instanceSourcePositions64Low);
target = project_position(target_world, instanceTargetPositions64Low);
float antiMeridianX = 0.0;
if (arc.useShortestPath) {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
antiMeridianX = -(project.coordinateOrigin.x + 180.) / 360. * TILE_SIZE;
}
float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);
if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
isValid = 0.0;
indexDir = sign(segmentRatio - thresholdRatio);
segmentRatio = thresholdRatio;
}
}
nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
vec3 currPos = interpolateFlat(source, target, segmentRatio);
vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);
if (arc.useShortestPath) {
if (nextPos.x < antiMeridianX) {
currPos.x += TILE_SIZE;
nextPos.x += TILE_SIZE;
}
}
curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
geometry.position = vec4(currPos, 1.0);
}
float widthPixels = clamp(
project_size_to_pixel(instanceWidths * arc.widthScale, arc.widthUnits),
arc.widthMinPixels, arc.widthMaxPixels
);
vec3 offset = vec3(
getExtrusionOffset((next.xy - curr.xy) * indexDir, segmentSide, widthPixels),
0.0);
DECKGL_FILTER_SIZE(offset, geometry);
DECKGL_FILTER_GL_POSITION(curr, geometry);
gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
vColor = vec4(color.rgb, color.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var _2e=`#version 300 es
#define SHADER_NAME arc-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 uv;
in float isValid;
out vec4 fragColor;
void main(void) {
if (isValid == 0.0) {
discard;
}
fragColor = vColor;
geometry.uv = uv;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var VF=[0,0,0,255],UXe={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:VF},getTargetColor:{type:"accessor",value:VF},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},aI=class extends Mo{getBounds(){return this.getAttributeManager()?.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:y2e,fs:_2e,modules:[No,Os,A2e]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getSourceColor",defaultValue:VF},instanceTargetColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getTargetColor",defaultValue:VF},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{widthUnits:r,widthScale:i,widthMinPixels:n,widthMaxPixels:o,greatCircle:s,wrapLongitude:a,numSegments:u}=this.props,p={numSegments:u,widthUnits:As[r],widthScale:i,widthMinPixels:n,widthMaxPixels:o,greatCircle:s,useShortestPath:a},m=this.state.model;m.shaderInputs.setProps({arc:p}),m.setVertexCount(u*2),m.draw(this.context.renderPass)}_getModel(){return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-strip",isInstanced:!0})}};aI.layerName="ArcLayer";aI.defaultProps=UXe;var jF=aI;var VXe=new Uint32Array([0,2,1,0,3,2]),jXe=new Float32Array([0,1,0,0,1,0,1,1]);function kJ(t,e){if(!e)return $Xe(t);let r=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),n=Math.ceil(r/e)+1,o=Math.ceil(i/e)+1,s=(n-1)*(o-1)*6,a=new Uint32Array(s),u=new Float32Array(n*o*2),p=new Float64Array(n*o*3),m=0,x=0;for(let M=0;M<n;M++){let k=M/(n-1);for(let F=0;F<o;F++){let j=F/(o-1),H=WXe(t,k,j);p[m*3+0]=H[0],p[m*3+1]=H[1],p[m*3+2]=H[2]||0,u[m*2+0]=k,u[m*2+1]=1-j,M>0&&F>0&&(a[x++]=m-o,a[x++]=m-o-1,a[x++]=m-1,a[x++]=m-o,a[x++]=m-1,a[x++]=m),m++}}return{vertexCount:s,positions:p,indices:a,texCoords:u}}function $Xe(t){let e=new Float64Array(12);for(let r=0;r<t.length;r++)e[r*3+0]=t[r][0],e[r*3+1]=t[r][1],e[r*3+2]=t[r][2]||0;return{vertexCount:6,positions:e,indices:VXe,texCoords:jXe}}function WXe(t,e,r){return sc(sc(t[0],t[1],r),sc(t[3],t[2],r),e)}var v2e=`uniform bitmapUniforms {
  vec4 bounds;
  float coordinateConversion;
  float desaturate;
  vec3 tintColor;
  vec4 transparentColor;
} bitmap;
`,b2e={name:"bitmap",vs:v2e,fs:v2e,uniformTypes:{bounds:"vec4<f32>",coordinateConversion:"f32",desaturate:"f32",tintColor:"vec3<f32>",transparentColor:"vec4<f32>"}};var x2e=`#version 300 es
#define SHADER_NAME bitmap-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;

out vec2 vTexCoord;
out vec2 vTexPos;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (bitmap.coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project.commonOrigin.xy;
  } else if (bitmap.coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`;var GXe=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,w2e=`#version 300 es
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

in vec2 vTexCoord;
in vec2 vTexPos;

out vec4 fragColor;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), bitmap.desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * bitmap.tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (bitmap.transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + bitmap.transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(bitmap.transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bitmap.bounds[0]) / (bitmap.bounds[2] - bitmap.bounds[0]),
    (pos.y - bitmap.bounds[3]) / (bitmap.bounds[1] - bitmap.bounds[3])
  );
}

${GXe}

void main(void) {
  vec2 uv = vTexCoord;
  if (bitmap.coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (bitmap.coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture(bitmapTexture, uv);

  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * layer.opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(fragColor, geometry);

  if (bool(picking.isActive) && !bool(picking.isAttribute)) {
    // Since instance information is not used, we can use picking color for pixel index
    fragColor.rgb = packUVsIntoRGB(uv);
  }
}
`;var HXe={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Gr.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}},lI=class extends Mo{getShaders(){return super.getShaders({vs:x2e,fs:w2e,modules:[No,Os,b2e]})}initializeState(){let e=this.getAttributeManager();e.remove(["instancePickingColors"]);let r=!0;e.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:r},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:r},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:r}})}updateState({props:e,oldProps:r,changeFlags:i}){let n=this.getAttributeManager();if(i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),n.invalidateAll()),e.bounds!==r.bounds){let o=this.state.mesh,s=this._createMesh();this.state.model.setVertexCount(s.vertexCount);for(let a in s)o&&o[a]!==s[a]&&n.invalidate(a);this.setState({mesh:s,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==r._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){let{image:r}=this.props,i=e.info;if(!i.color||!r)return i.bitmap=null,i;let{width:n,height:o}=r;i.index=0;let s=qXe(i.color);return i.bitmap={size:{width:n,height:o},uv:s,pixel:[Math.floor(s[0]*n),Math.floor(s[1]*o)]},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){let{bounds:e}=this.props,r=e;return S2e(e)&&(r=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),kJ(r,this.context.viewport.resolution)}_getModel(){return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(e){let{shaderModuleProps:r}=e,{model:i,coordinateConversion:n,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:u,transparentColor:p,tintColor:m}=this.props;if(!(r.picking.isActive&&s)&&a&&i){let x={bitmapTexture:a,bounds:o,coordinateConversion:n,desaturate:u,tintColor:m.slice(0,3).map(M=>M/255),transparentColor:p.map(M=>M/255)};i.shaderInputs.setProps({bitmap:x}),i.draw(this.context.renderPass)}}_getCoordinateUniforms(){let{LNGLAT:e,CARTESIAN:r,DEFAULT:i}=Gr,{_imageCoordinateSystem:n}=this.props;if(n!==i){let{bounds:o}=this.props;if(!S2e(o))throw new Error("_imageCoordinateSystem only supports rectangular bounds");let s=this.context.viewport.resolution?e:r;if(n=n===e?e:r,n===e&&s===r)return{coordinateConversion:-1,bounds:o};if(n===r&&s===e){let a=Ha([o[0],o[1]]),u=Ha([o[2],o[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],u[0],u[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}};lI.layerName="BitmapLayer";lI.defaultProps=HXe;var $F=lI;function qXe(t){let[e,r,i]=t,n=(i&240)/256,o=(i&15)/16;return[(e+o)/256,(r+n)/256]}function S2e(t){return Number.isFinite(t[0])}var T2e=`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeBasis;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,M2e={name:"icon",vs:T2e,fs:T2e,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeBasis:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}};var E2e=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float iconConstraint = icon.sizeBasis == 0.0 ? iconSize.x : iconSize.y;
float instanceScale = iconConstraint == 0.0 ? 0.0 : sizePixels / iconConstraint;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`;var C2e=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var YXe=1024,XXe=4,P2e=()=>{},I2e={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},ZXe={x:0,y:0,width:0,height:0};function KXe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function QXe(t,e,r,i){let n=Math.min(r/e.width,i/e.height),o=Math.floor(e.width*n),s=Math.floor(e.height*n);return n===1?{image:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{image:t.canvas,width:o,height:s})}function cI(t){return t&&(t.id||t.url)}function JXe(t,e,r,i){let{width:n,height:o,device:s}=t,a=s.createTexture({format:"rgba8unorm",width:e,height:r,sampler:i,mipLevels:s.getMipLevelCount(e,r)}),u=s.createCommandEncoder();return u.copyTextureToTexture({sourceTexture:t,destinationTexture:a,width:n,height:o}),u.finish(),a.generateMipmapsWebGL(),t.destroy(),a}function k2e(t,e,r){for(let i=0;i<e.length;i++){let{icon:n,xOffset:o}=e[i],s=cI(n);t[s]={...n,x:o,y:r}}}function eZe({icons:t,buffer:e,mapping:r={},xOffset:i=0,yOffset:n=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let u=0;u<t.length;u++){let p=t[u],m=cI(p);if(!r[m]){let{height:x,width:M}=p;i+M+e>s&&(k2e(r,a,n),i=0,n=o+n+e,o=0,a=[]),a.push({icon:p,xOffset:i}),i=i+M+e,o=Math.max(o,x)}}return a.length>0&&k2e(r,a,n),{mapping:r,rowHeight:o,xOffset:i,yOffset:n,canvasWidth:s,canvasHeight:KXe(o+n+e)}}function tZe(t,e,r){if(!t||!e)return null;r=r||{};let i={},{iterable:n,objectInfo:o}=Vc(t);for(let s of n){o.index++;let a=e(s,o),u=cI(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[u]&&(!r[u]||a.url!==r[u].url)&&(i[u]={...a,source:s,sourceIndex:o.index})}return i}var uI=class{constructor(e,{onUpdate:r=P2e,onError:i=P2e}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=XXe,this._canvasWidth=YXe,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=r,this.onError=i}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){let r=this._autoPacking?cI(e):e;return this._mapping[r]||ZXe}setProps({loadOptions:e,autoPacking:r,iconAtlas:i,iconMapping:n,textureParameters:o}){e&&(this._loadOptions=e),r!==void 0&&(this._autoPacking=r),n&&(this._mapping=n),i&&(this._texture?.delete(),this._texture=null,this._externalTexture=i),o&&(this._samplerParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(e,r){if(!this._autoPacking||typeof document>"u")return;let i=Object.values(tZe(e,r,this._mapping)||{});if(i.length>0){let{mapping:n,xOffset:o,yOffset:s,rowHeight:a,canvasHeight:u}=eZe({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=n,this._xOffset=o,this._yOffset=s,this._canvasHeight=u,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",data:null,width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||I2e,mipLevels:this.device.getMipLevelCount(this._canvasWidth,this._canvasHeight)})),this._texture.height!==this._canvasHeight&&(this._texture=JXe(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||I2e)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i),this._texture?.generateMipmapsWebGL()}}_loadIcons(e){let r=this._canvas.getContext("2d",{willReadFrequently:!0});for(let i of e)this._pendingCount++,e_(i.url,this._loadOptions).then(n=>{let o=cI(i),s=this._mapping[o],{x:a,y:u,width:p,height:m}=s,{image:x,width:M,height:k}=QXe(r,n,p,m);this._texture?.copyExternalImage({image:x,x:a+(p-M)/2,y:u+(m-k)/2,width:M,height:k}),s.width=M,s.height=k,this._texture?.generateMipmapsWebGL(),this.onUpdate()}).catch(n=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:n})}).finally(()=>{this._pendingCount--})}};var R2e=[0,0,0,255],rZe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeBasis:"height",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:R2e},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}},hI=class extends Mo{getShaders(){return super.getShaders({vs:E2e,fs:C2e,modules:[No,Os,M2e]})}initializeState(){this.state={iconManager:new uI(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:R2e},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);let{props:r,oldProps:i,changeFlags:n}=e,o=this.getAttributeManager(),{iconAtlas:s,iconMapping:a,data:u,getIcon:p,textureParameters:m}=r,{iconManager:x}=this.state;if(typeof s=="string")return;let M=s||this.internalState.isAsyncPropLoading("iconAtlas");x.setProps({loadOptions:r.loadOptions,autoPacking:!M,iconAtlas:s,iconMapping:M?a:null,textureParameters:m}),M?i.iconMapping!==r.iconMapping&&o.invalidate("getIcon"):(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&x.packIcons(u,p),n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),o.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){let{sizeScale:r,sizeBasis:i,sizeMinPixels:n,sizeMaxPixels:o,sizeUnits:s,billboard:a,alphaCutoff:u}=this.props,{iconManager:p}=this.state,m=p.getTexture();if(m){let x=this.state.model,M={iconsTexture:m,iconsTextureDim:[m.width,m.height],sizeUnits:As[s],sizeScale:r,sizeBasis:i==="height"?1:0,sizeMinPixels:n,sizeMaxPixels:o,billboard:a,alphaCutoff:u};x.shaderInputs.setProps({icon:M}),x.draw(this.context.renderPass)}}_getModel(){let e=[-1,-1,1,-1,-1,1,1,1];return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ds({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){let r=this.getCurrentLayer()?.props.onIconError;r?r(e):mr.error(e.error.message)()}getInstanceOffset(e){let{width:r,height:i,anchorX:n=r/2,anchorY:o=i/2}=this.state.iconManager.getIconMapping(e);return[r/2-n,i/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){let{x:r,y:i,width:n,height:o}=this.state.iconManager.getIconMapping(e);return[r,i,n,o]}};hI.defaultProps=rZe;hI.layerName="IconLayer";var WF=hI;var iZe=`struct PointCloudUniforms {
  radiusPixels: f32,
  sizeUnits: i32,
};

@group(0) @binding(3)
var<uniform> pointCloud: PointCloudUniforms;
`,O2e=`uniform pointCloudUniforms {
  float radiusPixels;
  highp int sizeUnits;
} pointCloud;
`,D2e={name:"pointCloud",source:iZe,vs:O2e,fs:O2e,uniformTypes:{radiusPixels:"f32",sizeUnits:"i32"}};var L2e=`#version 300 es
#define SHADER_NAME point-cloud-layer-vertex-shader
in vec3 positions;
in vec3 instanceNormals;
in vec4 instanceColors;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec3 instancePickingColors;
out vec4 vColor;
out vec2 unitPosition;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.normal = project_normal(instanceNormals);
unitPosition = positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
vec3 offset = vec3(positions.xy * project_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, instanceColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var B2e=`#version 300 es
#define SHADER_NAME point-cloud-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 unitPosition;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition.xy;
float distToCenter = length(unitPosition);
if (distToCenter > 1.0) {
discard;
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var F2e=`struct ConstantAttributes {
  instanceNormals: vec3<f32>,
  instanceColors: vec4<f32>,
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(1.0, 0.0, 0.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceNormals: vec3<f32>,
  @location(4) instanceColors: vec4<f32>,
  @location(5) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vColor: vec4<f32>,
  @location(1) unitPosition: vec2<f32>,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;
  
  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;
  // geometry.normal = project_normal(instanceNormals);

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  // Find the center of the point and add the current vertex
  let offset = vec3<f32>(attributes.positions.xy * project_unit_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);
  // DECKGL_FILTER_SIZE(offset, geometry);

  varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
  // DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  let clipPixels = project_pixel_size_to_clipspace(offset.xy);
  varyings.position.x += clipPixels.x;
  varyings.position.y += clipPixels.y;

  // Apply lighting
  let lightColor = lighting_getLightColor2(attributes.instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);

  // Apply opacity to instance color, or return instance picking color
  varyings.vColor = vec4(lightColor, attributes.instanceColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(vColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition.xy;

  let distToCenter = length(varyings.unitPosition);
  if (distToCenter > 1.0) {
    discard;
  }

  var fragColor: vec4<f32>;

  fragColor = varyings.vColor;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
}
`;var N2e=[0,0,0,255],z2e=[0,0,1],nZe={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:z2e},getColor:{type:"accessor",value:N2e},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function oZe(t){let{header:e,attributes:r}=t;if(!(!e||!r)&&(t.length=e.vertexCount,r.POSITION&&(r.instancePositions=r.POSITION),r.NORMAL&&(r.instanceNormals=r.NORMAL),r.COLOR_0)){let{size:i,value:n}=r.COLOR_0;r.instanceColors={size:i,type:"unorm8",value:n}}}var dI=class extends Mo{getShaders(){return super.getShaders({vs:L2e,fs:B2e,source:F2e,modules:[No,C3,_g,Os,D2e]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:z2e},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:N2e}})}updateState(e){let{changeFlags:r,props:i}=e;super.updateState(e),r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()),r.dataChanged&&oZe(i.data)}draw({uniforms:e}){let{pointSize:r,sizeUnits:i}=this.props,n=this.state.model,o={sizeUnits:As[i],radiusPixels:r};n.shaderInputs.setProps({pointCloud:o}),this.context.device.type==="webgpu"&&(n.instanceCount=this.props.data.length),n.draw(this.context.renderPass)}_getModel(){let e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,r=[];for(let i=0;i<3;i++){let n=i/3*Math.PI*2;r.push(Math.cos(n)*2,Math.sin(n)*2,0)}return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ds({topology:"triangle-list",attributes:{positions:new Float32Array(r)}}),parameters:e,isInstanced:!0})}};dI.layerName="PointCloudLayer";dI.defaultProps=nZe;var GF=dI;var U2e=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,V2e={name:"scatterplot",vs:U2e,fs:U2e,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}};var j2e=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var $2e=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var W2e=`// Main shaders

struct ScatterplotUniforms {
  radiusScale: f32,
  radiusMinPixels: f32,
  radiusMaxPixels: f32,
  lineWidthScale: f32,
  lineWidthMinPixels: f32,
  lineWidthMaxPixels: f32,
  stroked: f32,
  filled: i32,
  antialiasing: i32,
  billboard: i32,
  radiusUnits: i32,
  lineWidthUnits: i32,
};

struct ConstantAttributeUniforms {
 instancePositions: vec3<f32>,
 instancePositions64Low: vec3<f32>,
 instanceRadius: f32,
 instanceLineWidths: f32,
 instanceFillColors: vec4<f32>,
 instanceLineColors: vec4<f32>,
 instancePickingColors: vec3<f32>,

 instancePositionsConstant: i32,
 instancePositions64LowConstant: i32,
 instanceRadiusConstant: i32,
 instanceLineWidthsConstant: i32,
 instanceFillColorsConstant: i32,
 instanceLineColorsConstant: i32,
 instancePickingColorsConstant: i32
};

@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;

struct ConstantAttributes {
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instanceRadius: f32,
  instanceLineWidths: f32,
  instanceFillColors: vec4<f32>,
  instanceLineColors: vec4<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  0.0,
  0.0,
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceRadius: f32,
  @location(4) instanceLineWidths: f32,
  @location(5) instanceFillColors: vec4<f32>,
  @location(6) instanceLineColors: vec4<f32>,
  @location(7) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vFillColor: vec4<f32>,
  @location(1) vLineColor: vec4<f32>,
  @location(2) unitPosition: vec2<f32>,
  @location(3) innerUnitRadius: f32,
  @location(4) outerRadiusPixels: f32,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;

  // Draw an inline geometry constant array clip space triangle to verify that rendering works.
  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));
  // if (attributes.instanceIndex == 0) {
  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);
  //   return varyings;
  // }

  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  varyings.outerRadiusPixels = clamp(
    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),
    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
  );

  // Multiply out line width and clamp to limits
  let lineWidthPixels = clamp(
    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),
    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
  // Expand geometry to accommodate edge smoothing
  let edgePadding = select(
    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,
    1.0,
    scatterplot.antialiasing != 0
  );

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = edgePadding * attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;

  if (scatterplot.billboard != 0) {
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;
    // DECKGL_FILTER_SIZE(offset, geometry);
    let clipPixels = project_pixel_size_to_clipspace(offset.xy);
    varyings.position.x = clipPixels.x;
    varyings.position.y = clipPixels.y;
  } else {
    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);
    // DECKGL_FILTER_SIZE(offset, geometry);
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
  }

  // Apply opacity to instance color, or return instance picking color
  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);
  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition;

  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;
  let inCircle = select(
    smoothedge(distToCenter, varyings.outerRadiusPixels),
    step(distToCenter, varyings.outerRadiusPixels),
    scatterplot.antialiasing != 0
  );

  if (inCircle == 0.0) {
    discard;
  }

  var fragColor: vec4<f32>;

  if (scatterplot.stroked != 0) {
    let isLine = select(
      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      scatterplot.antialiasing != 0
    );

    if (scatterplot.filled != 0) {
      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);
    }
  } else if (scatterplot.filled == 0) {
    discard;
  } else {
    fragColor = varyings.vFillColor;
  }

  fragColor.a *= inCircle;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
  // return vec4<f32>(0, 0, 1, 1);
}
`;var G2e=[0,0,0,255],sZe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:G2e},getLineColor:{type:"accessor",value:G2e},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},fI=class extends Mo{getShaders(){return super.getShaders({vs:j2e,fs:$2e,source:W2e,modules:[No,C3,Os,V2e]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{radiusUnits:r,radiusScale:i,radiusMinPixels:n,radiusMaxPixels:o,stroked:s,filled:a,billboard:u,antialiasing:p,lineWidthUnits:m,lineWidthScale:x,lineWidthMinPixels:M,lineWidthMaxPixels:k}=this.props,F={stroked:s,filled:a,billboard:u,antialiasing:p,radiusUnits:As[r],radiusScale:i,radiusMinPixels:n,radiusMaxPixels:o,lineWidthUnits:As[m],lineWidthScale:x,lineWidthMinPixels:M,lineWidthMaxPixels:k},j=this.state.model;j.shaderInputs.setProps({scatterplot:F}),this.context.device.type==="webgpu"&&(j.instanceCount=this.props.data.length),j.draw(this.context.renderPass)}_getModel(){let e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,r=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ds({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(r)}}}),isInstanced:!0,parameters:e})}};fI.defaultProps=sZe;fI.layerName="ScatterplotLayer";var Wb=fI;var YS={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Gb(t,e,r={}){return H2e(t,r)!==e?(aZe(t,r),!0):!1}function H2e(t,e={}){return Math.sign(HF(t,e))}var RJ={x:0,y:1,z:2};function HF(t,e={}){let{start:r=0,end:i=t.length,plane:n="xy"}=e,o=e.size||2,s=0,a=RJ[n[0]],u=RJ[n[1]];for(let p=r,m=i-o;p<i;p+=o)s+=(t[p+a]-t[m+a])*(t[p+u]+t[m+u]),m=p;return s/2}function aZe(t,e){let{start:r=0,end:i=t.length,size:n=2}=e,o=(i-r)/n,s=Math.floor(o/2);for(let a=0;a<s;++a){let u=r+a*n,p=r+(o-1-a)*n;for(let m=0;m<n;++m){let x=t[u+m];t[u+m]=t[p+m],t[p+m]=x}}}function Bu(t,e){let r=e.length,i=t.length;if(i>0){let n=!0;for(let o=0;o<r;o++)if(t[i-r+o]!==e[o]){n=!1;break}if(n)return!1}for(let n=0;n<r;n++)t[i+n]=e[n];return!0}function pI(t,e){let r=e.length;for(let i=0;i<r;i++)t[i]=e[i]}function B_(t,e,r,i,n=[]){let o=i+e*r;for(let s=0;s<r;s++)n[s]=t[o+s];return n}function qF(t,e,r,i,n=[]){let o,s;if(r&8)o=(i[3]-t[1])/(e[1]-t[1]),s=3;else if(r&4)o=(i[1]-t[1])/(e[1]-t[1]),s=1;else if(r&2)o=(i[2]-t[0])/(e[0]-t[0]),s=2;else if(r&1)o=(i[0]-t[0])/(e[0]-t[0]),s=0;else return null;for(let a=0;a<t.length;a++)n[a]=(s&1)===a?i[s]:o*(e[a]-t[a])+t[a];return n}function mI(t,e){let r=0;return t[0]<e[0]?r|=1:t[0]>e[2]&&(r|=2),t[1]<e[1]?r|=4:t[1]>e[3]&&(r|=8),r}function gI(t,e){let{size:r=2,broken:i=!1,gridResolution:n=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},u=(a-s)/r,p=[],m=[p],x=B_(t,0,r,s),M,k,F=X2e(x,n,o,[]),j=[];Bu(p,x);for(let H=1;H<u;H++){for(M=B_(t,H,r,s,M),k=mI(M,F);k;){qF(x,M,k,F,j);let W=mI(j,F);W&&(qF(x,j,W,F,j),k=W),Bu(p,j),pI(x,j),uZe(F,n,k),i&&p.length>r&&(p=[],m.push(p),Bu(p,x)),k=mI(M,F)}Bu(p,M),pI(x,M)}return i?m:m[0]}var q2e=0,cZe=1;function AI(t,e=null,r){if(!t.length)return[];let{size:i=2,gridResolution:n=10,gridOffset:o=[0,0],edgeTypes:s=!1}=r||{},a=[],u=[{pos:t,types:s?new Array(t.length/i).fill(cZe):null,holes:e||[]}],p=[[],[]],m=[];for(;u.length;){let{pos:x,types:M,holes:k}=u.shift();hZe(x,i,k[0]||x.length,p),m=X2e(p[0],n,o,m);let F=mI(p[1],m);if(F){let j=Y2e(x,M,i,0,k[0]||x.length,m,F),H={pos:j[0].pos,types:j[0].types,holes:[]},W={pos:j[1].pos,types:j[1].types,holes:[]};u.push(H,W);for(let Z=0;Z<k.length;Z++)j=Y2e(x,M,i,k[Z],k[Z+1]||x.length,m,F),j[0]&&(H.holes.push(H.pos.length),H.pos=YF(H.pos,j[0].pos),s&&(H.types=YF(H.types,j[0].types))),j[1]&&(W.holes.push(W.pos.length),W.pos=YF(W.pos,j[1].pos),s&&(W.types=YF(W.types,j[1].types)))}else{let j={positions:x};s&&(j.edgeTypes=M),k.length&&(j.holeIndices=k),a.push(j)}}return a}function Y2e(t,e,r,i,n,o,s){let a=(n-i)/r,u=[],p=[],m=[],x=[],M=[],k,F,j,H=B_(t,a-1,r,i),W=Math.sign(s&8?H[1]-o[3]:H[0]-o[2]),Z=e&&e[a-1],Y=0,ee=0;for(let ce=0;ce<a;ce++)k=B_(t,ce,r,i,k),F=Math.sign(s&8?k[1]-o[3]:k[0]-o[2]),j=e&&e[i/r+ce],F&&W&&W!==F&&(qF(H,k,s,o,M),Bu(u,M)&&m.push(Z),Bu(p,M)&&x.push(Z)),F<=0?(Bu(u,k)&&m.push(j),Y-=F):m.length&&(m[m.length-1]=q2e),F>=0?(Bu(p,k)&&x.push(j),ee+=F):x.length&&(x[x.length-1]=q2e),pI(H,k),W=F,Z=j;return[Y?{pos:u,types:e&&m}:null,ee?{pos:p,types:e&&x}:null]}function X2e(t,e,r,i){let n=Math.floor((t[0]-r[0])/e)*e+r[0],o=Math.floor((t[1]-r[1])/e)*e+r[1];return i[0]=n,i[1]=o,i[2]=n+e,i[3]=o+e,i}function uZe(t,e,r){r&8?(t[1]+=e,t[3]+=e):r&4?(t[1]-=e,t[3]-=e):r&2?(t[0]+=e,t[2]+=e):r&1&&(t[0]-=e,t[2]-=e)}function hZe(t,e,r,i){let n=1/0,o=-1/0,s=1/0,a=-1/0;for(let u=0;u<r;u+=e){let p=t[u],m=t[u+1];n=p<n?p:n,o=p>o?p:o,s=m<s?m:s,a=m>a?m:a}return i[0][0]=n,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}function YF(t,e){for(let r=0;r<e.length;r++)t.push(e[r]);return t}var dZe=85.051129;function OJ(t,e){let{size:r=2,startIndex:i=0,endIndex:n=t.length,normalize:o=!0}=e||{},s=t.slice(i,n);Z2e(s,r,0,n-i);let a=gI(s,{size:r,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(let u of a)K2e(u,r);return a}function DJ(t,e=null,r){let{size:i=2,normalize:n=!0,edgeTypes:o=!1}=r||{};e=e||[];let s=[],a=[],u=0,p=0;for(let x=0;x<=e.length;x++){let M=e[x]||t.length,k=p,F=fZe(t,i,u,M);for(let j=F;j<M;j++)s[p++]=t[j];for(let j=u;j<F;j++)s[p++]=t[j];Z2e(s,i,k,p),pZe(s,i,k,p,r?.maxLatitude),u=M,a[x]=p}a.pop();let m=AI(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(n)for(let x of m)K2e(x.positions,i);return m}function fZe(t,e,r,i){let n=-1,o=-1;for(let s=r+1;s<i;s+=e){let a=Math.abs(t[s]);a>n&&(n=a,o=s-1)}return o}function pZe(t,e,r,i,n=dZe){let o=t[r],s=t[i-e];if(Math.abs(o-s)>180){let a=B_(t,0,e,r);a[0]+=Math.round((s-o)/360)*360,Bu(t,a),a[1]=Math.sign(a[1])*n,Bu(t,a),a[0]=o,Bu(t,a)}}function Z2e(t,e,r,i){let n=t[0],o;for(let s=r;s<i;s+=e){o=t[s];let a=o-n;(a>180||a<-180)&&(o-=Math.round(a/360)*360),t[s]=n=o}}function K2e(t,e){let r,i=t.length/e;for(let o=0;o<i&&(r=t[o*e],(r+180)%360===0);o++);let n=-Math.round(r/360)*360;if(n!==0)for(let o=0;o<i;o++)t[o*e]+=n}var yI=class extends Ds{constructor(e){let{indices:r,attributes:i}=gZe(e);super({...e,indices:r,attributes:i})}};function gZe(t){let{radius:e,height:r=1,nradial:i=10}=t,{vertices:n}=t;n&&(mr.assert(n.length>=i),n=n.flatMap(k=>[k[0],k[1]]),Gb(n,YS.COUNTER_CLOCKWISE));let o=r>0,s=i+1,a=o?s*3+1:i,u=Math.PI*2/i,p=new Uint16Array(o?i*3*2:0),m=new Float32Array(a*3),x=new Float32Array(a*3),M=0;if(o){for(let k=0;k<s;k++){let F=k*u,j=k%i,H=Math.sin(F),W=Math.cos(F);for(let Z=0;Z<2;Z++)m[M+0]=n?n[j*2]:W*e,m[M+1]=n?n[j*2+1]:H*e,m[M+2]=(1/2-Z)*r,x[M+0]=n?n[j*2]:W,x[M+1]=n?n[j*2+1]:H,M+=3}m[M+0]=m[M-3],m[M+1]=m[M-2],m[M+2]=m[M-1],M+=3}for(let k=o?0:1;k<s;k++){let F=Math.floor(k/2)*Math.sign(.5-k%2),j=F*u,H=(F+i)%i,W=Math.sin(j),Z=Math.cos(j);m[M+0]=n?n[H*2]:Z*e,m[M+1]=n?n[H*2+1]:W*e,m[M+2]=r/2,x[M+2]=1,M+=3}if(o){let k=0;for(let F=0;F<i;F++)p[k++]=F*2+0,p[k++]=F*2+2,p[k++]=F*2+0,p[k++]=F*2+1,p[k++]=F*2+1,p[k++]=F*2+3}return{indices:p,attributes:{POSITION:{size:3,value:m},NORMAL:{size:3,value:x}}}}var Q2e=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,J2e={name:"column",vs:Q2e,fs:Q2e,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}};var e3e=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var t3e=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var XF=[0,0,0,255],AZe={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:XF},getLineColor:{type:"accessor",value:XF},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},_I=class extends Mo{getShaders(){let e={},{flatShading:r}=this.props;return r&&(e.FLAT_SHADING=1),super.getShaders({vs:e3e,fs:t3e,defines:e,modules:[No,r?ib:_g,Os,J2e]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:XF},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:XF},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);let{props:r,oldProps:i,changeFlags:n}=e,o=n.extensionsChanged||r.flatShading!==i.flatShading;o&&(this.state.models?.forEach(a=>a.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());let s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(o||r.diskResolution!==i.diskResolution||r.vertices!==i.vertices||(r.extruded||r.stroked)!==(i.extruded||i.stroked))&&this._updateGeometry(r)}getGeometry(e,r,i){let n=new yI({radius:1,height:i?2:0,vertices:r,nradial:e}),o=0;if(r)for(let s=0;s<e;s++){let a=r[s],u=Math.sqrt(a[0]*a[0]+a[1]*a[1]);o+=u/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),n}_getModels(){let e=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),i=new bn(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),n=new bn(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:i,wireframeModel:n,models:[n,i]}}_updateGeometry({diskResolution:e,vertices:r,extruded:i,stroked:n}){let o=this.getGeometry(e,r,i||n);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3});let s=this.state.fillModel,a=this.state.wireframeModel;s.setGeometry(o),s.setTopology("triangle-strip"),s.setIndexBuffer(null),a.setGeometry(o),a.setTopology("line-list")}draw({uniforms:e}){let{lineWidthUnits:r,lineWidthScale:i,lineWidthMinPixels:n,lineWidthMaxPixels:o,radiusUnits:s,elevationScale:a,extruded:u,filled:p,stroked:m,wireframe:x,offset:M,coverage:k,radius:F,angle:j}=this.props,H=this.state.fillModel,W=this.state.wireframeModel,{fillVertexCount:Z,edgeDistance:Y}=this.state,ee={radius:F,angle:j/180*Math.PI,offset:M,extruded:u,stroked:m,coverage:k,elevationScale:a,edgeDistance:Y,radiusUnits:As[s],widthUnits:As[r],widthScale:i,widthMinPixels:n,widthMaxPixels:o};u&&x&&(W.shaderInputs.setProps({column:{...ee,isStroke:!0}}),W.draw(this.context.renderPass)),p&&(H.setVertexCount(Z),H.shaderInputs.setProps({column:{...ee,isStroke:!1}}),H.draw(this.context.renderPass)),!u&&m&&(H.setVertexCount(Z*2/3),H.shaderInputs.setProps({column:{...ee,isStroke:!0}}),H.draw(this.context.renderPass))}};_I.layerName="ColumnLayer";_I.defaultProps=AZe;var XS=_I;function r3e(t,e,r,i){let n;if(Array.isArray(t[0])){let o=t.length*e;n=new Array(o);for(let s=0;s<t.length;s++)for(let a=0;a<e;a++)n[s*e+a]=t[s][a]||0}else n=t;return r?gI(n,{size:e,gridResolution:r}):i?OJ(n,{size:e}):n}var yZe=1,_Ze=2,LJ=4,vI=class extends y_{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?r3e(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(i3e(e)){let i=0;for(let n of e)i+=this.getGeometrySize(n);return i}let r=this.getPathLength(e);return r<2?0:this.isClosed(e)?r<3?0:r+2:r}updateGeometryAttributes(e,r){if(r.geometrySize!==0)if(e&&i3e(e))for(let i of e){let n=this.getGeometrySize(i);r.geometrySize=n,this.updateGeometryAttributes(i,r),r.vertexStart+=n}else this._updateSegmentTypes(e,r),this._updatePositions(e,r)}_updateSegmentTypes(e,r){let i=this.attributes.segmentTypes,n=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:s}=r;i.fill(0,o,o+s),n?(i[o]=LJ,i[o+s-2]=LJ):(i[o]+=yZe,i[o+s-2]+=_Ze),i[o+s-1]=LJ}_updatePositions(e,r){let{positions:i}=this.attributes;if(!i||!e)return;let{vertexStart:n,geometrySize:o}=r,s=new Array(3);for(let a=n,u=0;u<o;a++,u++)this.getPointOnPath(e,u,s),i[a*3]=s[0],i[a*3+1]=s[1],i[a*3+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,r,i=[]){let{positionSize:n}=this;r*n>=e.length&&(r+=1-e.length/n);let o=r*n;return i[0]=e[o],i[1]=e[o+1],i[2]=n===3&&e[o+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;let{positionSize:r}=this,i=e.length-r;return e[0]===e[i]&&e[1]===e[i+1]&&(r===2||e[2]===e[i+2])}};function i3e(t){return Array.isArray(t[0])}var n3e=`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,o3e={name:"path",vs:n3e,fs:n3e,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}};var s3e=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = path.capType;
} else {
vJointType = path.jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),
path.widthMinPixels, path.widthMaxPixels) / 2.0);
vec3 width;
if (path.billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var a3e=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var l3e=[0,0,0,255],vZe={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:l3e},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},BJ={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},bI=class extends Mo{getShaders(){return super.getShaders({vs:s3e,fs:a3e,modules:[No,Os,o3e]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:BJ,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:BJ,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:BJ,defaultValue:l3e},instancePickingColors:{size:4,type:"uint8",accessor:(i,{index:n,target:o})=>this.encodePickingColor(i&&i.__source?i.__source.index:n,o)}}),this.setState({pathTesselator:new vI({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);let{props:r,changeFlags:i}=e,n=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){let{pathTesselator:s}=this.state,a=r.data.attributes||{};s.updateGeometry({data:r.data,geometryBuffer:a.getPath,buffers:a,normalize:!r._pathType,loop:r._pathType==="loop",getGeometry:r.getPath,positionFormat:r.positionFormat,wrapLongitude:r.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||n.invalidateAll()}i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),n.invalidateAll())}getPickingInfo(e){let r=super.getPickingInfo(e),{index:i}=r,n=this.props.data;return n[0]&&n[0].__source&&(r.object=n.find(o=>o.__source.index===i)),r}disablePickingIndex(e){let r=this.props.data;if(r[0]&&r[0].__source)for(let i=0;i<r.length;i++)r[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){let{jointRounded:r,capRounded:i,billboard:n,miterLimit:o,widthUnits:s,widthScale:a,widthMinPixels:u,widthMaxPixels:p}=this.props,m=this.state.model,x={jointType:Number(r),capType:Number(i),billboard:n,widthUnits:As[s],widthScale:a,miterLimit:o,widthMinPixels:u,widthMaxPixels:p};m.shaderInputs.setProps({path:x}),m.draw(this.context.renderPass)}_getModel(){let e=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ds({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){let{pathTesselator:r}=this.state;e.startIndices=r.vertexStarts,e.value=r.get("positions")}calculateSegmentTypes(e){let{pathTesselator:r}=this.state;e.startIndices=r.vertexStarts,e.value=r.get("segmentTypes")}};bI.defaultProps=vZe;bI.layerName="PathLayer";var up=bI;var y3e=Tt(f3e(),1);var eN=YS.CLOCKWISE,p3e=YS.COUNTER_CLOCKWISE,F_={isClosed:!0};function BZe(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function KS(t){return"positions"in t?t.positions:t}function TI(t){return"holeIndices"in t?t.holeIndices:null}function FZe(t){return Array.isArray(t[0])}function NZe(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function zZe(t){let e=t[0],r=t[t.length-1];return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function UZe(t,e,r,i){for(let n=0;n<e;n++)if(t[r+n]!==t[i-e+n])return!1;return!0}function m3e(t,e,r,i,n){let o=e,s=r.length;for(let a=0;a<s;a++)for(let u=0;u<i;u++)t[o++]=r[a][u]||0;if(!zZe(r))for(let a=0;a<i;a++)t[o++]=r[0][a]||0;return F_.start=e,F_.end=o,F_.size=i,Gb(t,n,F_),o}function g3e(t,e,r,i,n=0,o,s){o=o||r.length;let a=o-n;if(a<=0)return e;let u=e;for(let p=0;p<a;p++)t[u++]=r[n+p];if(!UZe(r,i,n,o))for(let p=0;p<i;p++)t[u++]=r[n+p];return F_.start=e,F_.end=u,F_.size=i,Gb(t,s,F_),u}function tN(t,e){BZe(t);let r=[],i=[];if("positions"in t){let{positions:n,holeIndices:o}=t;if(o){let s=0;for(let a=0;a<=o.length;a++)s=g3e(r,s,n,e,o[a-1],o[a],a===0?eN:p3e),i.push(s);return i.pop(),{positions:r,holeIndices:i}}t=n}if(!FZe(t))return g3e(r,0,t,e,0,r.length,eN),r;if(!NZe(t)){let n=0;for(let[o,s]of t.entries())n=m3e(r,n,s,e,o===0?eN:p3e),i.push(n);return i.pop(),{positions:r,holeIndices:i}}return m3e(r,0,t,e,eN),r}function VJ(t,e,r){let i=t.length/3,n=0;for(let o=0;o<i;o++){let s=(o+1)%i;n+=t[o*3+e]*t[s*3+r],n-=t[s*3+e]*t[o*3+r]}return Math.abs(n/2)}function A3e(t,e,r,i){let n=t.length/3;for(let o=0;o<n;o++){let s=o*3,a=t[s+0],u=t[s+1],p=t[s+2];t[s+e]=a,t[s+r]=u,t[s+i]=p}}function _3e(t,e,r,i){let n=TI(t);n&&(n=n.map(a=>a/e));let o=KS(t),s=i&&e===3;if(r){let a=o.length;o=o.slice();let u=[];for(let p=0;p<a;p+=e){u[0]=o[p],u[1]=o[p+1],s&&(u[2]=o[p+2]);let m=r(u);o[p]=m[0],o[p+1]=m[1],s&&(o[p+2]=m[2])}}if(s){let a=VJ(o,0,1),u=VJ(o,0,2),p=VJ(o,1,2);if(!a&&!u&&!p)return[];a>u&&a>p||(u>p?(r||(o=o.slice()),A3e(o,0,2,1)):(r||(o=o.slice()),A3e(o,2,0,1)))}return(0,y3e.default)(o,n,e)}var MI=class extends y_{constructor(e){let{fp64:r,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:i,size:1}}})}get(e){let{attributes:r}=this;return e==="indices"?r.indices&&r.indices.subarray(0,this.vertexCount):r[e]}updateGeometry(e){super.updateGeometry(e);let r=this.buffers.indices;if(r)this.vertexCount=(r.value||r).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){let r=tN(e,this.positionSize);return this.opts.resolution?AI(KS(r),TI(r),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?DJ(KS(r),TI(r),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):r}return e}getGeometrySize(e){if(b3e(e)){let r=0;for(let i of e)r+=this.getGeometrySize(i);return r}return KS(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,r){if(e&&b3e(e))for(let i of e){let n=this.getGeometrySize(i);r.geometrySize=n,this.updateGeometryAttributes(i,r),r.vertexStart+=n,r.indexStart=this.indexStarts[r.geometryIndex+1]}else{let i=e;this._updateIndices(i,r),this._updatePositions(i,r),this._updateVertexValid(i,r)}}_updateIndices(e,{geometryIndex:r,vertexStart:i,indexStart:n}){let{attributes:o,indexStarts:s,typedArrayManager:a}=this,u=o.indices;if(!u||!e)return;let p=n,m=_3e(e,this.positionSize,this.opts.preproject,this.opts.full3d);u=a.allocate(u,n+m.length,{copy:!0});for(let x=0;x<m.length;x++)u[p++]=m[x]+i;s[r+1]=n+m.length,o.indices=u}_updatePositions(e,{vertexStart:r,geometrySize:i}){let{attributes:{positions:n},positionSize:o}=this;if(!n||!e)return;let s=KS(e);for(let a=r,u=0;u<i;a++,u++){let p=s[u*o],m=s[u*o+1],x=o>2?s[u*o+2]:0;n[a*3]=p,n[a*3+1]=m,n[a*3+2]=x}}_updateVertexValid(e,{vertexStart:r,geometrySize:i}){let{positionSize:n}=this,o=this.attributes.vertexValid,s=e&&TI(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,r):o.fill(1,r,r+i),s)for(let a=0;a<s.length;a++)o[r+s[a]/n-1]=0;o[r+i-1]=0}};function b3e(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}var x3e=`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,w3e={name:"solidPolygon",vs:x3e,fs:x3e,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}};var rN=`in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project.commonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (solidPolygon.extruded) {
pos.z += props.elevations * solidPolygon.elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (solidPolygon.extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * layer.opacity);
} else {
vColor = vec4(colors.rgb, colors.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var S3e=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${rN}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`;var T3e=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${rN}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`;var M3e=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var nN=[0,0,0,255],VZe={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:nN},getLineColor:{type:"accessor",value:nN},material:!0},iN={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},EI=class extends Mo{getShaders(e){return super.getShaders({vs:e==="top"?S3e:T3e,fs:M3e,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[No,_g,Os,w3e]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){let{viewport:e}=this.context,{coordinateSystem:r}=this.props,{_full3d:i}=this.props;e.isGeospatial&&r===Gr.DEFAULT&&(r=Gr.LNGLAT);let n;r===Gr.LNGLAT&&(i?n=e.projectPosition.bind(e):n=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new MI({preproject:n,fp64:this.use64bitPositions(),IndexType:Uint32Array})});let o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:iN,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:"dynamic",transition:iN,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:iN,accessor:"getFillColor",defaultValue:nN},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:iN,accessor:"getLineColor",defaultValue:nN},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:u,target:p})=>this.encodePickingColor(a&&a.__source?a.__source.index:u,p)}})}getPickingInfo(e){let r=super.getPickingInfo(e),{index:i}=r,n=this.props.data;return n[0]&&n[0].__source&&(r.object=n.find(o=>o.__source.index===i)),r}disablePickingIndex(e){let r=this.props.data;if(r[0]&&r[0].__source)for(let i=0;i<r.length;i++)r[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){let{extruded:r,filled:i,wireframe:n,elevationScale:o}=this.props,{topModel:s,sideModel:a,wireframeModel:u,polygonTesselator:p}=this.state,m={extruded:!!r,elevationScale:o,isWireframe:!1};u&&n&&(u.setInstanceCount(p.instanceCount-1),u.shaderInputs.setProps({solidPolygon:{...m,isWireframe:!0}}),u.draw(this.context.renderPass)),a&&i&&(a.setInstanceCount(p.instanceCount-1),a.shaderInputs.setProps({solidPolygon:m}),a.draw(this.context.renderPass)),s&&i&&(s.setVertexCount(p.vertexCount),s.shaderInputs.setProps({solidPolygon:m}),s.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);let{props:r,oldProps:i,changeFlags:n}=e,o=this.getAttributeManager();(n.extensionsChanged||r.filled!==i.filled||r.extruded!==i.extruded)&&(this.state.models?.forEach(a=>a.destroy()),this.setState(this._getModels()),o.invalidateAll())}updateGeometry({props:e,oldProps:r,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){let{polygonTesselator:o}=this.state,s=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:s.getPolygon,buffers:s,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){let{id:e,filled:r,extruded:i}=this.props,n,o,s;if(r){let a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;let u=this.getAttributeManager().getBufferLayouts({isInstanced:!1});n=new bn(this.context.device,{...a,id:`${e}-top`,topology:"triangle-list",bufferLayout:u,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(i){let a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});o=new bn(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:a,geometry:new Ds({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),s=new bn(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:a,geometry:new Ds({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[o,s,n].filter(Boolean),topModel:n,sideModel:o,wireframeModel:s}}calculateIndices(e){let{polygonTesselator:r}=this.state;e.startIndices=r.indexStarts,e.value=r.get("indices")}calculatePositions(e){let{polygonTesselator:r}=this.state;e.startIndices=r.vertexStarts,e.value=r.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}};EI.defaultProps=VZe;EI.layerName="SolidPolygonLayer";var qg=EI;function oN({data:t,getIndex:e,dataRange:r,replace:i}){let{startRow:n=0,endRow:o=1/0}=r,s=t.length,a=s,u=s;for(let M=0;M<s;M++){let k=e(t[M]);if(a>M&&k>=n&&(a=M),k>=o){u=M;break}}let p=a,x=u-a!==i.length?t.slice(u):void 0;for(let M=0;M<i.length;M++)t[p++]=i[M];if(x){for(let M=0;M<x.length;M++)t[p++]=x[M];t.length=p}return{startRow:a,endRow:a+i.length}}var E3e=[0,0,0,255],jZe=[0,0,0,255],$Ze={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:jZe},getLineColor:{type:"accessor",value:E3e},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},CI=class extends ji{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&mr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){let r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(r&&Array.isArray(e.dataChanged)){let i=this.state.paths.slice(),n=e.dataChanged.map(o=>oN({data:i,getIndex:s=>s.__source.index,dataRange:o,replace:this._getPaths(o)}));this.setState({paths:i,pathsDiff:n})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){let{data:r,getPolygon:i,positionFormat:n,_normalize:o}=this.props,s=[],a=n==="XY"?2:3,{startRow:u,endRow:p}=e,{iterable:m,objectInfo:x}=Vc(r,u,p);for(let M of m){x.index++;let k=i(M,x);o&&(k=tN(k,a));let{holeIndices:F}=k,j=k.positions||k;if(F)for(let H=0;H<=F.length;H++){let W=j.slice(F[H-1]||0,F[H]||j.length);s.push(this.getSubLayerRow({path:W},M,x.index))}else s.push(this.getSubLayerRow({path:j},M,x.index))}return s}renderLayers(){let{data:e,_dataDiff:r,stroked:i,filled:n,extruded:o,wireframe:s,_normalize:a,_windingOrder:u,elevationScale:p,transitions:m,positionFormat:x}=this.props,{lineWidthUnits:M,lineWidthScale:k,lineWidthMinPixels:F,lineWidthMaxPixels:j,lineJointRounded:H,lineMiterLimit:W,lineDashJustified:Z}=this.props,{getFillColor:Y,getLineColor:ee,getLineWidth:ce,getLineDashArray:ge,getElevation:Se,getPolygon:ne,updateTriggers:pe,material:ue}=this.props,{paths:Le,pathsDiff:We}=this.state,ze=this.getSubLayerClass("fill",qg),rt=this.getSubLayerClass("stroke",up),at=this.shouldRenderSubLayer("fill",Le)&&new ze({_dataDiff:r,extruded:o,elevationScale:p,filled:n,wireframe:s,_normalize:a,_windingOrder:u,getElevation:Se,getFillColor:Y,getLineColor:o&&s?ee:E3e,material:ue,transitions:m},this.getSubLayerProps({id:"fill",updateTriggers:pe&&{getPolygon:pe.getPolygon,getElevation:pe.getElevation,getFillColor:pe.getFillColor,lineColors:o&&s,getLineColor:pe.getLineColor}}),{data:e,positionFormat:x,getPolygon:ne}),Wt=!o&&i&&this.shouldRenderSubLayer("stroke",Le)&&new rt({_dataDiff:We&&(()=>We),widthUnits:M,widthScale:k,widthMinPixels:F,widthMaxPixels:j,jointRounded:H,miterLimit:W,dashJustified:Z,_pathType:"loop",transitions:m&&{getWidth:m.getLineWidth,getColor:m.getLineColor,getPath:m.getPolygon},getColor:this.getSubLayerAccessor(ee),getWidth:this.getSubLayerAccessor(ce),getDashArray:this.getSubLayerAccessor(ge)},this.getSubLayerProps({id:"stroke",updateTriggers:pe&&{getWidth:pe.getLineWidth,getColor:pe.getLineColor,getDashArray:pe.getLineDashArray}}),{data:Le,positionFormat:x,getPath:It=>It.path});return[!o&&at,Wt,o&&at]}};CI.layerName="PolygonLayer";CI.defaultProps=$Ze;var hp=CI;function C3e(t,e){if(!t)return null;let r="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[r];return r!==-1?WZe(t,i,r):null}function WZe(t,e,r){let i={properties:{...t.properties[e]}};for(let n in t.numericProps)i.properties[n]=t.numericProps[n].value[r];return i}function P3e(t,e){let r={points:null,lines:null,polygons:null};for(let i in r){let n=t[i].globalFeatureIds.value;r[i]=new Uint8ClampedArray(n.length*4);let o=[];for(let s=0;s<n.length;s++)e(n[s],o),r[i][s*4+0]=o[0],r[i][s*4+1]=o[1],r[i][s*4+2]=o[2],r[i][s*4+3]=255}return r}var I3e=`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,k3e={name:"sdf",vs:I3e,fs:I3e,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}};var R3e=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf.enabled) {
float distance = alpha;
alpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);
if (sdf.outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);
color = mix(sdf.outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * layer.opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var jJ=192/256,O3e=[],GZe={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},PI=class extends WF{getShaders(){let e=super.getShaders();return{...e,modules:[...e.modules,k3e],fs:R3e}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(r,{index:i,target:n})=>this.encodePickingColor(i,n)}})}updateState(e){super.updateState(e);let{props:r,oldProps:i}=e,{outlineColor:n}=r;n!==i.outlineColor&&(n=n.map(o=>o/255),n[3]=Number.isFinite(n[3])?n[3]:1,this.setState({outlineColor:n})),!r.sdf&&r.outlineWidth&&mr.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){let{sdf:r,smoothing:i,outlineWidth:n}=this.props,{outlineColor:o}=this.state,s=n?Math.max(i,jJ*(1-n)):-1,a=this.state.model,u={buffer:jJ,outlineBuffer:s,gamma:i,enabled:!!r,outlineColor:o};if(a.shaderInputs.setProps({sdf:u}),super.draw(e),r&&n){let{iconManager:p}=this.state;p.getTexture()&&(a.shaderInputs.setProps({sdf:{...u,outlineBuffer:jJ}}),a.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(r=>super.getInstanceOffset(r)):O3e}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(r=>super.getInstanceIconFrame(r)):O3e}};PI.defaultProps=GZe;PI.layerName="MultiIconLayer";var D3e=PI;var II=class{constructor({fontSize:e=24,buffer:r=3,radius:i=8,cutoff:n=.25,fontFamily:o="sans-serif",fontWeight:s="normal",fontStyle:a="normal",lang:u=null}={}){this.buffer=r,this.cutoff=n,this.radius=i,this.lang=u;let p=this.size=e+r*4,m=this._createCanvas(p),x=this.ctx=m.getContext("2d",{willReadFrequently:!0});x.font=`${a} ${s} ${e}px ${o}`,x.textBaseline="alphabetic",x.textAlign="left",x.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(e){let r=document.createElement("canvas");return r.width=r.height=e,r}draw(e){let{width:r,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:o,actualBoundingBoxRight:s}=this.ctx.measureText(e),a=Math.ceil(i),u=0,p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-o))),m=Math.min(this.size-this.buffer,a+Math.ceil(n)),x=p+2*this.buffer,M=m+2*this.buffer,k=Math.max(x*M,0),F=new Uint8ClampedArray(k),j={data:F,width:x,height:M,glyphWidth:p,glyphHeight:m,glyphTop:a,glyphLeft:u,glyphAdvance:r};if(p===0||m===0)return j;let{ctx:H,buffer:W,gridInner:Z,gridOuter:Y}=this;this.lang&&(H.lang=this.lang),H.clearRect(W,W,p,m),H.fillText(e,W,W+a);let ee=H.getImageData(W,W,p,m);Y.fill(1e20,0,k),Z.fill(0,0,k);for(let ce=0;ce<m;ce++)for(let ge=0;ge<p;ge++){let Se=ee.data[4*(ce*p+ge)+3]/255;if(Se===0)continue;let ne=(ce+W)*x+ge+W;if(Se===1)Y[ne]=0,Z[ne]=1e20;else{let pe=.5-Se;Y[ne]=pe>0?pe*pe:0,Z[ne]=pe<0?pe*pe:0}}L3e(Y,0,0,x,M,x,this.f,this.v,this.z),L3e(Z,W,W,p,m,x,this.f,this.v,this.z);for(let ce=0;ce<k;ce++){let ge=Math.sqrt(Y[ce])-Math.sqrt(Z[ce]);F[ce]=Math.round(255-255*(ge/this.radius+this.cutoff))}return j}};function L3e(t,e,r,i,n,o,s,a,u){for(let p=e;p<e+i;p++)B3e(t,r*o+p,o,n,s,a,u);for(let p=r;p<r+n;p++)B3e(t,p*o+e,1,i,s,a,u)}function B3e(t,e,r,i,n,o,s){o[0]=0,s[0]=-1e20,s[1]=1e20,n[0]=t[e];for(let a=1,u=0,p=0;a<i;a++){n[a]=t[e+a*r];let m=a*a;do{let x=o[u];p=(n[a]-n[x]+m-x*x)/(a-x)/2}while(p<=s[u]&&--u>-1);u++,o[u]=a,s[u]=p,s[u+1]=1e20}for(let a=0,u=0;a<i;a++){for(;s[u+1]<a;)u++;let p=o[u],m=a-p;t[e+a*r]=n[p]+m*m}}var HZe=32,qZe=[];function YZe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function F3e({characterSet:t,getFontWidth:e,fontHeight:r,buffer:i,maxCanvasWidth:n,mapping:o={},xOffset:s=0,yOffset:a=0}){let u=0,p=s,m=r+i*2;for(let x of t)if(!o[x]){let M=e(x);p+M+i*2>n&&(p=0,u++),o[x]={x:p+i,y:a+u*m+i,width:M,height:m,layoutWidth:M,layoutHeight:r},p+=M+i*2}return{mapping:o,xOffset:p,yOffset:a+u*m,canvasHeight:YZe(a+(u+1)*m)}}function N3e(t,e,r,i){let n=0;for(let o=e;o<r;o++){let s=t[o];n+=i[s]?.layoutWidth||0}return n}function z3e(t,e,r,i,n,o){let s=e,a=0;for(let u=e;u<r;u++){let p=N3e(t,u,u+1,n);a+p>i&&(s<u&&o.push(u),s=u,a=0),a+=p}return a}function XZe(t,e,r,i,n,o){let s=e,a=e,u=e,p=0;for(let m=e;m<r;m++)if((t[m]===" "||t[m+1]===" "||m+1===r)&&(u=m+1),u>a){let x=N3e(t,a,u,n);p+x>i&&(s<a&&(o.push(a),s=a,p=0),x>i&&(x=z3e(t,a,u,i,n,o),s=o[o.length-1])),a=u,p+=x}return p}function ZZe(t,e,r,i,n=0,o){o===void 0&&(o=t.length);let s=[];return e==="break-all"?z3e(t,n,o,r,i,s):XZe(t,n,o,r,i,s),s}function KZe(t,e,r,i,n,o){let s=0,a=0;for(let u=e;u<r;u++){let p=t[u],m=i[p];m?(a||(a=m.layoutHeight),n[u]=s+m.layoutWidth/2,s+=m.layoutWidth):(mr.warn(`Missing character: ${p} (${p.codePointAt(0)})`)(),n[u]=s,s+=HZe)}o[0]=s,o[1]=a}function U3e(t,e,r,i,n){let o=Array.from(t),s=o.length,a=new Array(s),u=new Array(s),p=new Array(s),m=(r==="break-word"||r==="break-all")&&isFinite(i)&&i>0,x=[0,0],M=[0,0],k=0,F=0,j=0;for(let H=0;H<=s;H++){let W=o[H];if((W===`
`||H===s)&&(j=H),j>F){let Z=m?ZZe(o,r,i,n,F,j):qZe;for(let Y=0;Y<=Z.length;Y++){let ee=Y===0?F:Z[Y-1],ce=Y<Z.length?Z[Y]:j;KZe(o,ee,ce,n,a,M);for(let ge=ee;ge<ce;ge++){let Se=o[ge],ne=n[Se]?.layoutOffsetY||0;u[ge]=k+M[1]/2+ne,p[ge]=M[0]}k=k+M[1]*e,x[0]=Math.max(x[0],M[0])}F=j}W===`
`&&(a[F]=0,u[F]=0,p[F]=0,F++)}return x[1]=k,{x:a,y:u,rowWidth:p,size:x}}function V3e({value:t,length:e,stride:r,offset:i,startIndices:n,characterSet:o}){let s=t.BYTES_PER_ELEMENT,a=r?r/s:1,u=i?i/s:0,p=n[e]||Math.ceil((t.length-u)/a),m=o&&new Set,x=new Array(e),M=t;if(a>1||u>0){let k=t.constructor;M=new k(p);for(let F=0;F<p;F++)M[F]=t[F*a+u]}for(let k=0;k<e;k++){let F=n[k],j=n[k+1]||p,H=M.subarray(F,j);x[k]=String.fromCodePoint.apply(null,H),m&&H.forEach(m.add,m)}if(m)for(let k of m)o.add(String.fromCodePoint(k));return{texts:x,characterCount:p}}var QS=class{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){let r=this._cache[e];return r&&(this._deleteOrder(e),this._appendOrder(e)),r}set(e,r){this._cache[e]?(this.delete(e),this._cache[e]=r,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=r,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){let r=this._order.indexOf(e);r>=0&&this._order.splice(r,1)}_appendOrder(e){this._order.push(e)}};function QZe(){let t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}var qb={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:QZe(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},j3e=1024,$3e=.9,W3e=1.2,H3e=3,sN=new QS(H3e);function JZe(t,e){let r;typeof e=="string"?r=new Set(Array.from(e)):r=new Set(e);let i=sN.get(t);if(!i)return r;for(let n in i.mapping)r.has(n)&&r.delete(n);return r}function eKe(t,e){for(let r=0;r<t.length;r++)e.data[4*r+3]=t[r]}function G3e(t,e,r,i){t.font=`${i} ${r}px ${e}`,t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function q3e(t){mr.assert(Number.isFinite(t)&&t>=H3e,"Invalid cache limit"),sN=new QS(t)}var kI=class{constructor(){this.props={...qb}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){let{fontSize:e,buffer:r}=this.props;return(e*W3e+r*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();let r=JZe(this._key,this.props.characterSet),i=sN.get(this._key);if(i&&r.size===0){this._atlas!==i&&(this._atlas=i);return}let n=this._generateFontAtlas(r,i);this._atlas=n,sN.set(this._key,n)}_generateFontAtlas(e,r){let{fontFamily:i,fontWeight:n,fontSize:o,buffer:s,sdf:a,radius:u,cutoff:p}=this.props,m=r&&r.data;m||(m=document.createElement("canvas"),m.width=j3e);let x=m.getContext("2d",{willReadFrequently:!0});G3e(x,i,o,n);let{mapping:M,canvasHeight:k,xOffset:F,yOffset:j}=F3e({getFontWidth:H=>x.measureText(H).width,fontHeight:o*W3e,buffer:s,characterSet:e,maxCanvasWidth:j3e,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(m.height!==k){let H=x.getImageData(0,0,m.width,m.height);m.height=k,x.putImageData(H,0,0)}if(G3e(x,i,o,n),a){let H=new II({fontSize:o,buffer:s,radius:u,cutoff:p,fontFamily:i,fontWeight:`${n}`});for(let W of e){let{data:Z,width:Y,height:ee,glyphTop:ce}=H.draw(W);M[W].width=Y,M[W].layoutOffsetY=o*$3e-ce;let ge=x.createImageData(Y,ee);eKe(Z,ge),x.putImageData(ge,M[W].x,M[W].y)}}else for(let H of e)x.fillText(H,M[H].x,M[H].y+s+o*$3e);return{xOffset:F,yOffset:j,mapping:M,data:m,width:m.width,height:m.height}}_getKey(){let{fontFamily:e,fontWeight:r,fontSize:i,buffer:n,sdf:o,radius:s,cutoff:a}=this.props;return o?`${e} ${r} ${i} ${n} ${s} ${a}`:`${e} ${r} ${i} ${n}`}};var Y3e=`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 borderRadius;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,X3e={name:"textBackground",vs:Y3e,fs:Y3e,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",borderRadius:"vec4<f32>",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}};var Z3e=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),
textBackground.sizeMinPixels, textBackground.sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (textBackground.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var K3e=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
float round_rect(vec2 p, vec2 size, vec4 radii) {
vec2 pixelPositionCB = (p - 0.5) * size;
vec2 sizeCB = size * 0.5;
float maxBorderRadius = min(size.x, size.y) * 0.5;
vec4 borderRadius = vec4(min(radii, maxBorderRadius));
borderRadius.xy =
(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;
borderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;
vec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;
return -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);
}
float rect(vec2 p, vec2 size) {
vec2 pixelPosition = p * size;
return min(min(pixelPosition.x, size.x - pixelPosition.x),
min(pixelPosition.y, size.y - pixelPosition.y));
}
vec4 get_stroked_fragColor(float dist) {
float isBorder = smoothedge(dist, vLineWidth);
return mix(vFillColor, vLineColor, isBorder);
}
void main(void) {
geometry.uv = uv;
if (textBackground.borderRadius != vec4(0.0)) {
float distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);
if (textBackground.stroked) {
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
float shapeAlpha = smoothedge(-distToEdge, 0.0);
fragColor.a *= shapeAlpha;
} else {
if (textBackground.stroked) {
float distToEdge = rect(uv, dimensions);
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var tKe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:"object",value:0},padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},RI=class extends Mo{getShaders(){return super.getShaders({vs:Z3e,fs:K3e,modules:[No,Os,X3e]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);let{changeFlags:r}=e;r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){let{billboard:r,sizeScale:i,sizeUnits:n,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:a}=this.props,{padding:u,borderRadius:p}=this.props;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),Array.isArray(p)||(p=[p,p,p,p]);let m=this.state.model,x={billboard:r,stroked:!!a,borderRadius:p,padding:u,sizeUnits:As[n],sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s};m.shaderInputs.setProps({textBackground:x}),m.draw(this.context.renderPass)}_getModel(){let e=[0,0,1,0,0,1,1,1];return new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ds({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}};RI.defaultProps=tKe;RI.layerName="TextBackgroundLayer";var Q3e=RI;var J3e={start:1,middle:0,end:-1},eSe={top:1,center:0,bottom:-1},$J=[0,0,0,255],rKe=1,iKe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:$J},getBorderWidth:{type:"accessor",value:0},backgroundBorderRadius:{type:"object",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:qb.characterSet},fontFamily:qb.fontFamily,fontWeight:qb.fontWeight,lineHeight:rKe,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:$J},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:$J},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},OI=class extends ji{constructor(){super(...arguments),this.getBoundingRect=(e,r)=>{let{size:[i,n]}=this.transformParagraph(e,r),{fontSize:o}=this.state.fontAtlasManager.props;i/=o,n/=o;let{getTextAnchor:s,getAlignmentBaseline:a}=this.props,u=J3e[typeof s=="function"?s(e,r):s],p=eSe[typeof a=="function"?a(e,r):a];return[(u-1)*i/2,(p-1)*n/2,i,n]},this.getIconOffsets=(e,r)=>{let{getTextAnchor:i,getAlignmentBaseline:n}=this.props,{x:o,y:s,rowWidth:a,size:[u,p]}=this.transformParagraph(e,r),m=J3e[typeof i=="function"?i(e,r):i],x=eSe[typeof n=="function"?n(e,r):n],M=o.length,k=new Array(M*2),F=0;for(let j=0;j<M;j++){let H=(1-m)*(u-a[j])/2;k[F++]=(m-1)*u/2+H+o[j],k[F++]=(x-1)*p/2+s[j]}return k}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new kI},this.props.maxWidth>0&&mr.once(1,"v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){let{props:r,oldProps:i,changeFlags:n}=e;(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||r.lineHeight!==i.lineHeight||r.wordBreak!==i.wordBreak||r.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){let{fontSettings:e,fontFamily:r,fontWeight:i}=this.props,{fontAtlasManager:n,characterSet:o}=this.state,s={...e,characterSet:o,fontFamily:r,fontWeight:i};if(!n.mapping)return n.setProps(s),!0;for(let a in s)if(s[a]!==n.props[a])return n.setProps(s),!0;return!1}_updateText(){let{data:e,characterSet:r}=this.props,i=e.attributes?.getText,{getText:n}=this.props,o=e.startIndices,s,a=r==="auto"&&new Set;if(i&&o){let{texts:u,characterCount:p}=V3e({...ArrayBuffer.isView(i)?{value:i}:i,length:e.length,startIndices:o,characterSet:a});s=p,n=(m,{index:x})=>u[x]}else{let{iterable:u,objectInfo:p}=Vc(e);o=[0],s=0;for(let m of u){p.index++;let x=Array.from(n(m,p)||"");a&&x.forEach(a.add,a),s+=x.length,o.push(s)}}this.setState({getText:n,startIndices:o,numInstances:s,characterSet:a||r})}transformParagraph(e,r){let{fontAtlasManager:i}=this.state,n=i.mapping,o=this.state.getText,{wordBreak:s,lineHeight:a,maxWidth:u}=this.props,p=o(e,r)||"";return U3e(p,a,s,u*i.props.fontSize,n)}renderLayers(){let{startIndices:e,numInstances:r,getText:i,fontAtlasManager:{scale:n,atlas:o,mapping:s},styleVersion:a}=this.state,{data:u,_dataDiff:p,getPosition:m,getColor:x,getSize:M,getAngle:k,getPixelOffset:F,getBackgroundColor:j,getBorderColor:H,getBorderWidth:W,backgroundBorderRadius:Z,backgroundPadding:Y,background:ee,billboard:ce,fontSettings:ge,outlineWidth:Se,outlineColor:ne,sizeScale:pe,sizeUnits:ue,sizeMinPixels:Le,sizeMaxPixels:We,transitions:ze,updateTriggers:rt}=this.props,at=this.getSubLayerClass("characters",D3e),Wt=this.getSubLayerClass("background",Q3e);return[ee&&new Wt({getFillColor:j,getLineColor:H,getLineWidth:W,borderRadius:Z,padding:Y,getPosition:m,getSize:M,getAngle:k,getPixelOffset:F,billboard:ce,sizeScale:pe,sizeUnits:ue,sizeMinPixels:Le,sizeMaxPixels:We,transitions:ze&&{getPosition:ze.getPosition,getAngle:ze.getAngle,getSize:ze.getSize,getFillColor:ze.getBackgroundColor,getLineColor:ze.getBorderColor,getLineWidth:ze.getBorderWidth,getPixelOffset:ze.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:rt.getPosition,getAngle:rt.getAngle,getSize:rt.getSize,getFillColor:rt.getBackgroundColor,getLineColor:rt.getBorderColor,getLineWidth:rt.getBorderWidth,getPixelOffset:rt.getPixelOffset,getBoundingRect:{getText:rt.getText,getTextAnchor:rt.getTextAnchor,getAlignmentBaseline:rt.getAlignmentBaseline,styleVersion:a}}}),{data:u.attributes&&u.attributes.background?{length:u.length,attributes:u.attributes.background}:u,_dataDiff:p,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new at({sdf:ge.sdf,smoothing:Number.isFinite(ge.smoothing)?ge.smoothing:qb.smoothing,outlineWidth:Se/(ge.radius||qb.radius),outlineColor:ne,iconAtlas:o,iconMapping:s,getPosition:m,getColor:x,getSize:M,getAngle:k,getPixelOffset:F,billboard:ce,sizeScale:pe*n,sizeUnits:ue,sizeMinPixels:Le*n,sizeMaxPixels:We*n,transitions:ze&&{getPosition:ze.getPosition,getAngle:ze.getAngle,getColor:ze.getColor,getSize:ze.getSize,getPixelOffset:ze.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:rt.getText,getPosition:rt.getPosition,getAngle:rt.getAngle,getColor:rt.getColor,getSize:rt.getSize,getPixelOffset:rt.getPixelOffset,getIconOffsets:{getTextAnchor:rt.getTextAnchor,getAlignmentBaseline:rt.getAlignmentBaseline,styleVersion:a}}}),{data:u,_dataDiff:p,startIndices:e,numInstances:r,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){q3e(e)}};OI.defaultProps=iKe;OI.layerName="TextLayer";var JS=OI;var DI={circle:{type:Wb,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:WF,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:JS,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},LI={type:up,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},aN={type:qg,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function eT({type:t,props:e}){let r={};for(let i in e)r[i]=t.defaultProps[e[i]];return r}function lN(t,e){let{transitions:r,updateTriggers:i}=t.props,n={updateTriggers:{},transitions:r&&{getPosition:r.geometry}};for(let o in e){let s=e[o],a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),n.updateTriggers[s]=i[o],r&&(n.transitions[s]=r[o])),n[s]=a}return n}function rSe(t){if(Array.isArray(t))return t;switch(mr.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return mr.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function WJ(t,e,r={}){let i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:n=0,endRow:o=t.length}=r;for(let s=n;s<o;s++){let a=t[s],{geometry:u}=a;if(u)if(u.type==="GeometryCollection"){mr.assert(Array.isArray(u.geometries),"GeoJSON does not have geometries array");let{geometries:p}=u;for(let m=0;m<p.length;m++){let x=p[m];tSe(x,i,e,a,s)}}else tSe(u,i,e,a,s)}return i}function tSe(t,e,r,i,n){let{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:u,polygonFeatures:p,polygonOutlineFeatures:m}=e;if(!oKe(o,s)){mr.warn(`${o} coordinates are malformed`)();return}switch(o){case"Point":a.push(r({geometry:t},i,n));break;case"MultiPoint":s.forEach(x=>{a.push(r({geometry:{type:"Point",coordinates:x}},i,n))});break;case"LineString":u.push(r({geometry:t},i,n));break;case"MultiLineString":s.forEach(x=>{u.push(r({geometry:{type:"LineString",coordinates:x}},i,n))});break;case"Polygon":p.push(r({geometry:t},i,n)),s.forEach(x=>{m.push(r({geometry:{type:"LineString",coordinates:x}},i,n))});break;case"MultiPolygon":s.forEach(x=>{p.push(r({geometry:{type:"Polygon",coordinates:x}},i,n)),x.forEach(M=>{m.push(r({geometry:{type:"LineString",coordinates:M}},i,n))})});break;default:}}var nKe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function oKe(t,e){let r=nKe[t];for(mr.assert(r,`Unknown GeoJSON type ${t}`);e&&--r>0;)e=e[0];return e&&Number.isFinite(e[0])}function iSe(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function cN(t){return t.geometry.coordinates}function nSe(t,e){let r=iSe(),{pointFeatures:i,lineFeatures:n,polygonFeatures:o,polygonOutlineFeatures:s}=t;return r.points.data=i,r.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),r.points.getPosition=cN,r.lines.data=n,r.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),r.lines.getPath=cN,r.polygons.data=o,r.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),r.polygons.getPolygon=cN,r.polygonsOutline.data=s,r.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),r.polygonsOutline.getPath=cN,r}function oSe(t,e){let r=iSe(),{points:i,lines:n,polygons:o}=t,s=P3e(t,e);r.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:4,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},r.lines.data={length:n.pathIndices.value.length-1,startIndices:n.pathIndices.value,attributes:{...n.attributes,getPath:n.positions,instancePickingColors:{size:4,value:s.lines}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},r.lines._pathType="open";let a=o.positions.value.length/o.positions.size,u=Array(a).fill(1);for(let p of o.primitivePolygonIndices.value)u[p-1]=0;return r.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,instanceVertexValid:{size:1,value:new Uint16Array(u)},pickingColors:{size:4,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},r.polygons._normalize=!1,o.triangles&&(r.polygons.data.attributes.indices=o.triangles.value),r.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:4,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},r.polygonsOutline._pathType="open",r}var sKe=["points","linestrings","polygons"],aKe={...eT(DI.circle),...eT(DI.icon),...eT(DI.text),...eT(LI),...eT(aN),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}},BI=class extends ji{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:r}){if(!r.dataChanged)return;let{data:i}=this.props,n=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:n}),n?this._updateStateBinary({props:e,changeFlags:r}):this._updateStateJSON({props:e,changeFlags:r})}_updateStateBinary({props:e,changeFlags:r}){let i=oSe(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:r}){let i=rSe(e.data),n=this.getSubLayerRow.bind(this),o={},s={};if(Array.isArray(r.dataChanged)){let u=this.state.features;for(let p in u)o[p]=u[p].slice(),s[p]=[];for(let p of r.dataChanged){let m=WJ(i,n,p);for(let x in u)s[x].push(oN({data:o[x],getIndex:M=>M.__source.index,dataRange:p,replace:m[x]}))}}else o=WJ(i,n);let a=nSe(o,s);this.setState({features:o,featuresDiff:s,layerProps:a})}getPickingInfo(e){let r=super.getPickingInfo(e),{index:i,sourceLayer:n}=r;return r.featureType=sKe.find(o=>n.id.startsWith(`${this.id}-${o}-`)),i>=0&&n.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(r.index=this.props.data.points.globalFeatureIds.value[i]),r}_updateAutoHighlight(e){let r=`${this.id}-points-`,i=e.featureType==="points";for(let n of this.getSubLayers())n.id.startsWith(r)===i&&n.updateAutoHighlight(e)}_renderPolygonLayer(){let{extruded:e,wireframe:r}=this.props,{layerProps:i}=this.state,n="polygons-fill",o=this.shouldRenderSubLayer(n,i.polygons?.data)&&this.getSubLayerClass(n,aN.type);if(o){let s=lN(this,aN.props),a=e&&r;return a||delete s.getLineColor,s.updateTriggers.lineColors=a,new o(s,this.getSubLayerProps({id:n,updateTriggers:s.updateTriggers}),i.polygons)}return null}_renderLineLayers(){let{extruded:e,stroked:r}=this.props,{layerProps:i}=this.state,n="polygons-stroke",o="linestrings",s=!e&&r&&this.shouldRenderSubLayer(n,i.polygonsOutline?.data)&&this.getSubLayerClass(n,LI.type),a=this.shouldRenderSubLayer(o,i.lines?.data)&&this.getSubLayerClass(o,LI.type);if(s||a){let u=lN(this,LI.props);return[s&&new s(u,this.getSubLayerProps({id:n,updateTriggers:u.updateTriggers}),i.polygonsOutline),a&&new a(u,this.getSubLayerProps({id:o,updateTriggers:u.updateTriggers}),i.lines)]}return null}_renderPointLayers(){let{pointType:e}=this.props,{layerProps:r,binary:i}=this.state,{highlightedObjectIndex:n}=this.props;!i&&Number.isFinite(n)&&(n=r.points.data.findIndex(a=>a.__source.index===n));let o=new Set(e.split("+")),s=[];for(let a of o){let u=`points-${a}`,p=DI[a],m=p&&this.shouldRenderSubLayer(u,r.points?.data)&&this.getSubLayerClass(u,p.type);if(m){let x=lN(this,p.props),M=r.points;if(a==="text"&&i){let{instancePickingColors:k,...F}=M.data.attributes;M={...M,data:{...M.data,attributes:F}}}s.push(new m(x,this.getSubLayerProps({id:u,updateTriggers:x.updateTriggers,highlightedObjectIndex:n}),M))}}return s}renderLayers(){let{extruded:e}=this.props,r=this._renderPolygonLayer(),i=this._renderLineLayers(),n=this._renderPointLayers();return[!e&&r,i,n,e&&r]}getSubLayerAccessor(e){let{binary:r}=this.state;return!r||typeof e!="function"?super.getSubLayerAccessor(e):(i,n)=>{let{data:o,index:s}=n,a=C3e(o,s);return e(a,n)}}};BI.layerName="GeoJsonLayer";BI.defaultProps=aKe;var GJ=BI;var lKe={...hp.defaultProps},FI=class extends ji{indexToBounds(){return null}renderLayers(){let{elevationScale:e,extruded:r,wireframe:i,filled:n,stroked:o,lineWidthUnits:s,lineWidthScale:a,lineWidthMinPixels:u,lineWidthMaxPixels:p,lineJointRounded:m,lineMiterLimit:x,lineDashJustified:M,getElevation:k,getFillColor:F,getLineColor:j,getLineWidth:H}=this.props,{updateTriggers:W,material:Z,transitions:Y}=this.props,ee=this.getSubLayerClass("cell",hp),{updateTriggers:ce,...ge}=this.indexToBounds()||{};return new ee({filled:n,wireframe:i,extruded:r,elevationScale:e,stroked:o,lineWidthUnits:s,lineWidthScale:a,lineWidthMinPixels:u,lineWidthMaxPixels:p,lineJointRounded:m,lineMiterLimit:x,lineDashJustified:M,material:Z,transitions:Y,getElevation:k,getFillColor:F,getLineColor:j,getLineWidth:H},this.getSubLayerProps({id:"cell",updateTriggers:W&&{...ce,getElevation:W.getElevation,getFillColor:W.getFillColor,getLineColor:W.getLineColor,getLineWidth:W.getLineWidth}}),ge)}};FI.layerName="GeoCellLayer";FI.defaultProps=lKe;var tT=FI;var cKe=Object.defineProperty,VI=(t,e)=>{for(var r in e)cKe(t,r,{get:e[r],enumerable:!0})},Hc={};VI(Hc,{ARRAY_TYPE:()=>zs,EPSILON:()=>Nl,RANDOM:()=>Yb,equals:()=>fKe,setMatrixArrayType:()=>uKe,toRadian:()=>dKe});var Nl=1e-6,zs=typeof Float32Array<"u"?Float32Array:Array,Yb=Math.random;function uKe(t){zs=t}var hKe=Math.PI/180;function dKe(t){return t*hKe}function fKe(t,e){return Math.abs(t-e)<=Nl*Math.max(1,Math.abs(t),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Xb={};VI(Xb,{LDU:()=>IKe,add:()=>kKe,adjoint:()=>xKe,clone:()=>mKe,copy:()=>gKe,create:()=>pKe,determinant:()=>wKe,equals:()=>OKe,exactEquals:()=>RKe,frob:()=>PKe,fromRotation:()=>MKe,fromScaling:()=>EKe,fromValues:()=>yKe,identity:()=>AKe,invert:()=>bKe,mul:()=>BKe,multiply:()=>ESe,multiplyScalar:()=>DKe,multiplyScalarAndAdd:()=>LKe,rotate:()=>SKe,scale:()=>TKe,set:()=>_Ke,str:()=>CKe,sub:()=>FKe,subtract:()=>CSe,transpose:()=>vKe});function pKe(){var t=new zs(4);return zs!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function mKe(t){var e=new zs(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function gKe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function AKe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function yKe(t,e,r,i){var n=new zs(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}function _Ke(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}function vKe(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function bKe(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r*o-n*i;return s?(s=1/s,t[0]=o*s,t[1]=-i*s,t[2]=-n*s,t[3]=r*s,t):null}function xKe(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function wKe(t){return t[0]*t[3]-t[2]*t[1]}function ESe(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],u=r[1],p=r[2],m=r[3];return t[0]=i*a+o*u,t[1]=n*a+s*u,t[2]=i*p+o*m,t[3]=n*p+s*m,t}function SKe(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u+o*a,t[1]=n*u+s*a,t[2]=i*-a+o*u,t[3]=n*-a+s*u,t}function TKe(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],u=r[1];return t[0]=i*a,t[1]=n*a,t[2]=o*u,t[3]=s*u,t}function MKe(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t}function EKe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function CKe(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function PKe(t){return Math.hypot(t[0],t[1],t[2],t[3])}function IKe(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]}function kKe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function CSe(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function RKe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function OKe(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=e[0],a=e[1],u=e[2],p=e[3];return Math.abs(r-s)<=Nl*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=Nl*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-u)<=Nl*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-p)<=Nl*Math.max(1,Math.abs(o),Math.abs(p))}function DKe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function LKe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t}var BKe=ESe,FKe=CSe;function NKe(){var t=new zs(9);return zs!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var XJ={};VI(XJ,{add:()=>KQe,calculateW:()=>UQe,clone:()=>qQe,conjugate:()=>WQe,copy:()=>XQe,create:()=>KJ,dot:()=>WSe,equals:()=>iJe,exactEquals:()=>rJe,exp:()=>USe,fromEuler:()=>GQe,fromMat3:()=>jSe,fromValues:()=>YQe,getAngle:()=>BQe,getAxisAngle:()=>LQe,identity:()=>DQe,invert:()=>$Qe,len:()=>eJe,length:()=>GSe,lerp:()=>JQe,ln:()=>VSe,mul:()=>QQe,multiply:()=>zSe,normalize:()=>see,pow:()=>VQe,random:()=>jQe,rotateX:()=>FQe,rotateY:()=>NQe,rotateZ:()=>zQe,rotationTo:()=>nJe,scale:()=>$Se,set:()=>ZQe,setAxes:()=>sJe,setAxisAngle:()=>NSe,slerp:()=>_N,sqlerp:()=>oJe,sqrLen:()=>tJe,squaredLength:()=>HSe,str:()=>HQe});var cr={};VI(cr,{add:()=>jKe,angle:()=>lQe,bezier:()=>eQe,ceil:()=>$Ke,clone:()=>zKe,copy:()=>UKe,create:()=>nee,cross:()=>yN,dist:()=>gQe,distance:()=>OSe,div:()=>mQe,divide:()=>RSe,dot:()=>oee,equals:()=>dQe,exactEquals:()=>hQe,floor:()=>WKe,forEach:()=>_Qe,fromValues:()=>ZJ,hermite:()=>JKe,inverse:()=>KKe,len:()=>FSe,length:()=>PSe,lerp:()=>QKe,max:()=>HKe,min:()=>GKe,mul:()=>pQe,multiply:()=>kSe,negate:()=>ZKe,normalize:()=>BSe,random:()=>tQe,rotateX:()=>oQe,rotateY:()=>sQe,rotateZ:()=>aQe,round:()=>qKe,scale:()=>YKe,scaleAndAdd:()=>XKe,set:()=>VKe,sqrDist:()=>AQe,sqrLen:()=>yQe,squaredDistance:()=>DSe,squaredLength:()=>LSe,str:()=>uQe,sub:()=>fQe,subtract:()=>ISe,transformMat3:()=>iQe,transformMat4:()=>rQe,transformQuat:()=>nQe,zero:()=>cQe});function nee(){var t=new zs(3);return zs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function zKe(t){var e=new zs(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function PSe(t){var e=t[0],r=t[1],i=t[2];return Math.hypot(e,r,i)}function ZJ(t,e,r){var i=new zs(3);return i[0]=t,i[1]=e,i[2]=r,i}function UKe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function VKe(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t}function jKe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function ISe(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function kSe(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function RSe(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function $Ke(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function WKe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function GKe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function HKe(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function qKe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function YKe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function XKe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t}function OSe(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.hypot(r,i,n)}function DSe(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n}function LSe(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function ZKe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function KKe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function BSe(t,e){var r=e[0],i=e[1],n=e[2],o=r*r+i*i+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function oee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function yN(t,e,r){var i=e[0],n=e[1],o=e[2],s=r[0],a=r[1],u=r[2];return t[0]=n*u-o*a,t[1]=o*s-i*u,t[2]=i*a-n*s,t}function QKe(t,e,r,i){var n=e[0],o=e[1],s=e[2];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s),t}function JKe(t,e,r,i,n,o){var s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,p=s*(o-1),m=s*(3-2*o);return t[0]=e[0]*a+r[0]*u+i[0]*p+n[0]*m,t[1]=e[1]*a+r[1]*u+i[1]*p+n[1]*m,t[2]=e[2]*a+r[2]*u+i[2]*p+n[2]*m,t}function eQe(t,e,r,i,n,o){var s=1-o,a=s*s,u=o*o,p=a*s,m=3*o*a,x=3*u*s,M=u*o;return t[0]=e[0]*p+r[0]*m+i[0]*x+n[0]*M,t[1]=e[1]*p+r[1]*m+i[1]*x+n[1]*M,t[2]=e[2]*p+r[2]*m+i[2]*x+n[2]*M,t}function tQe(t,e){e=e||1;var r=Yb()*2*Math.PI,i=Yb()*2-1,n=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t[2]=i*e,t}function rQe(t,e,r){var i=e[0],n=e[1],o=e[2],s=r[3]*i+r[7]*n+r[11]*o+r[15];return s=s||1,t[0]=(r[0]*i+r[4]*n+r[8]*o+r[12])/s,t[1]=(r[1]*i+r[5]*n+r[9]*o+r[13])/s,t[2]=(r[2]*i+r[6]*n+r[10]*o+r[14])/s,t}function iQe(t,e,r){var i=e[0],n=e[1],o=e[2];return t[0]=i*r[0]+n*r[3]+o*r[6],t[1]=i*r[1]+n*r[4]+o*r[7],t[2]=i*r[2]+n*r[5]+o*r[8],t}function nQe(t,e,r){var i=r[0],n=r[1],o=r[2],s=r[3],a=e[0],u=e[1],p=e[2],m=n*p-o*u,x=o*a-i*p,M=i*u-n*a,k=n*M-o*x,F=o*m-i*M,j=i*x-n*m,H=s*2;return m*=H,x*=H,M*=H,k*=2,F*=2,j*=2,t[0]=a+m+k,t[1]=u+x+F,t[2]=p+M+j,t}function oQe(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),o[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function sQe(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),o[1]=n[1],o[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function aQe(t,e,r,i){var n=[],o=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],o[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),o[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function lQe(t,e){var r=t[0],i=t[1],n=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(r*r+i*i+n*n),p=Math.sqrt(o*o+s*s+a*a),m=u*p,x=m&&oee(t,e)/m;return Math.acos(Math.min(Math.max(x,-1),1))}function cQe(t){return t[0]=0,t[1]=0,t[2]=0,t}function uQe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function hQe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function dQe(t,e){var r=t[0],i=t[1],n=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(r-o)<=Nl*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=Nl*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-a)<=Nl*Math.max(1,Math.abs(n),Math.abs(a))}var fQe=ISe,pQe=kSe,mQe=RSe,gQe=OSe,AQe=DSe,FSe=PSe,yQe=LSe,_Qe=(function(){var t=nee();return function(e,r,i,n,o,s){var a,u;for(r||(r=3),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,a=i;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();function vQe(){var t=new zs(4);return zs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function bQe(t){var e=new zs(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function xQe(t,e,r,i){var n=new zs(4);return n[0]=t,n[1]=e,n[2]=r,n[3]=i,n}function wQe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function SQe(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}function TQe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function MQe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function EQe(t){var e=t[0],r=t[1],i=t[2],n=t[3];return Math.hypot(e,r,i,n)}function CQe(t){var e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n}function PQe(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r*r+i*i+n*n+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=i*s,t[2]=n*s,t[3]=o*s,t}function IQe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function kQe(t,e,r,i){var n=e[0],o=e[1],s=e[2],a=e[3];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s),t[3]=a+i*(r[3]-a),t}function RQe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function OQe(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],s=e[0],a=e[1],u=e[2],p=e[3];return Math.abs(r-s)<=Nl*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=Nl*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-u)<=Nl*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-p)<=Nl*Math.max(1,Math.abs(o),Math.abs(p))}var ddr=(function(){var t=vQe();return function(e,r,i,n,o,s){var a,u;for(r||(r=4),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,a=i;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();function KJ(){var t=new zs(4);return zs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function DQe(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function NSe(t,e,r){r=r*.5;var i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t}function LQe(t,e){var r=Math.acos(e[3])*2,i=Math.sin(r/2);return i>Nl?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),r}function BQe(t,e){var r=WSe(t,e);return Math.acos(2*r*r-1)}function zSe(t,e,r){var i=e[0],n=e[1],o=e[2],s=e[3],a=r[0],u=r[1],p=r[2],m=r[3];return t[0]=i*m+s*a+n*p-o*u,t[1]=n*m+s*u+o*a-i*p,t[2]=o*m+s*p+i*u-n*a,t[3]=s*m-i*a-n*u-o*p,t}function FQe(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u+s*a,t[1]=n*u+o*a,t[2]=o*u-n*a,t[3]=s*u-i*a,t}function NQe(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u-o*a,t[1]=n*u+s*a,t[2]=o*u+i*a,t[3]=s*u-n*a,t}function zQe(t,e,r){r*=.5;var i=e[0],n=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u+n*a,t[1]=n*u-i*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t}function UQe(t,e){var r=e[0],i=e[1],n=e[2];return t[0]=r,t[1]=i,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),t}function USe(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=Math.sqrt(r*r+i*i+n*n),a=Math.exp(o),u=s>0?a*Math.sin(s)/s:0;return t[0]=r*u,t[1]=i*u,t[2]=n*u,t[3]=a*Math.cos(s),t}function VSe(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=Math.sqrt(r*r+i*i+n*n),a=s>0?Math.atan2(s,o)/s:0;return t[0]=r*a,t[1]=i*a,t[2]=n*a,t[3]=.5*Math.log(r*r+i*i+n*n+o*o),t}function VQe(t,e,r){return VSe(t,e),$Se(t,t,r),USe(t,t),t}function _N(t,e,r,i){var n=e[0],o=e[1],s=e[2],a=e[3],u=r[0],p=r[1],m=r[2],x=r[3],M,k,F,j,H;return k=n*u+o*p+s*m+a*x,k<0&&(k=-k,u=-u,p=-p,m=-m,x=-x),1-k>Nl?(M=Math.acos(k),F=Math.sin(M),j=Math.sin((1-i)*M)/F,H=Math.sin(i*M)/F):(j=1-i,H=i),t[0]=j*n+H*u,t[1]=j*o+H*p,t[2]=j*s+H*m,t[3]=j*a+H*x,t}function jQe(t){var e=Yb(),r=Yb(),i=Yb(),n=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=n*Math.sin(2*Math.PI*r),t[1]=n*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t}function $Qe(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],s=r*r+i*i+n*n+o*o,a=s?1/s:0;return t[0]=-r*a,t[1]=-i*a,t[2]=-n*a,t[3]=o*a,t}function WQe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function jSe(t,e){var r=e[0]+e[4]+e[8],i;if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[n*3+n]&&(n=2);var o=(n+1)%3,s=(n+2)%3;i=Math.sqrt(e[n*3+n]-e[o*3+o]-e[s*3+s]+1),t[n]=.5*i,i=.5/i,t[3]=(e[o*3+s]-e[s*3+o])*i,t[o]=(e[o*3+n]+e[n*3+o])*i,t[s]=(e[s*3+n]+e[n*3+s])*i}return t}function GQe(t,e,r,i){var n=.5*Math.PI/180;e*=n,r*=n,i*=n;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(r),u=Math.cos(r),p=Math.sin(i),m=Math.cos(i);return t[0]=o*u*m-s*a*p,t[1]=s*a*m+o*u*p,t[2]=s*u*p-o*a*m,t[3]=s*u*m+o*a*p,t}function HQe(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var qQe=bQe,YQe=xQe,XQe=wQe,ZQe=SQe,KQe=TQe,QQe=zSe,$Se=MQe,WSe=IQe,JQe=kQe,GSe=EQe,eJe=GSe,HSe=CQe,tJe=HSe,see=PQe,rJe=RQe,iJe=OQe,nJe=(function(){var t=nee(),e=ZJ(1,0,0),r=ZJ(0,1,0);return function(i,n,o){var s=oee(n,o);return s<-.999999?(yN(t,e,n),FSe(t)<1e-6&&yN(t,r,n),BSe(t,t),NSe(i,t,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(yN(t,n,o),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+s,see(i,i))}})(),oJe=(function(){var t=KJ(),e=KJ();return function(r,i,n,o,s,a){return _N(t,i,s,a),_N(e,n,o,a),_N(r,t,e,2*a*(1-a)),r}})(),sJe=(function(){var t=NKe();return function(e,r,i,n){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],see(e,jSe(e,t))}})(),Pi={};VI(Pi,{add:()=>hJe,angle:()=>kJe,ceil:()=>dJe,clone:()=>aJe,copy:()=>cJe,create:()=>qSe,cross:()=>wJe,dist:()=>UJe,distance:()=>KSe,div:()=>zJe,divide:()=>ZSe,dot:()=>xJe,equals:()=>LJe,exactEquals:()=>DJe,floor:()=>fJe,forEach:()=>$Je,fromValues:()=>lJe,inverse:()=>vJe,len:()=>BJe,length:()=>JSe,lerp:()=>SJe,max:()=>mJe,min:()=>pJe,mul:()=>NJe,multiply:()=>XSe,negate:()=>_Je,normalize:()=>bJe,random:()=>TJe,rotate:()=>IJe,round:()=>gJe,scale:()=>AJe,scaleAndAdd:()=>yJe,set:()=>uJe,sqrDist:()=>VJe,sqrLen:()=>jJe,squaredDistance:()=>QSe,squaredLength:()=>eTe,str:()=>OJe,sub:()=>FJe,subtract:()=>YSe,transformMat2:()=>MJe,transformMat2d:()=>EJe,transformMat3:()=>CJe,transformMat4:()=>PJe,zero:()=>RJe});function qSe(){var t=new zs(2);return zs!=Float32Array&&(t[0]=0,t[1]=0),t}function aJe(t){var e=new zs(2);return e[0]=t[0],e[1]=t[1],e}function lJe(t,e){var r=new zs(2);return r[0]=t,r[1]=e,r}function cJe(t,e){return t[0]=e[0],t[1]=e[1],t}function uJe(t,e,r){return t[0]=e,t[1]=r,t}function hJe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function YSe(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function XSe(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function ZSe(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function dJe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function fJe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function pJe(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function mJe(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function gJe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function AJe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function yJe(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t}function KSe(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.hypot(r,i)}function QSe(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function JSe(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function eTe(t){var e=t[0],r=t[1];return e*e+r*r}function _Je(t,e){return t[0]=-e[0],t[1]=-e[1],t}function vJe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function bJe(t,e){var r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t}function xJe(t,e){return t[0]*e[0]+t[1]*e[1]}function wJe(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t}function SJe(t,e,r,i){var n=e[0],o=e[1];return t[0]=n+i*(r[0]-n),t[1]=o+i*(r[1]-o),t}function TJe(t,e){e=e||1;var r=Yb()*2*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function MJe(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t}function EJe(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t}function CJe(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t}function PJe(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t}function IJe(t,e,r,i){var n=e[0]-r[0],o=e[1]-r[1],s=Math.sin(i),a=Math.cos(i);return t[0]=n*a-o*s+r[0],t[1]=n*s+o*a+r[1],t}function kJe(t,e){var r=t[0],i=t[1],n=e[0],o=e[1],s=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+o*o),a=s&&(r*n+i*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function RJe(t){return t[0]=0,t[1]=0,t}function OJe(t){return"vec2("+t[0]+", "+t[1]+")"}function DJe(t,e){return t[0]===e[0]&&t[1]===e[1]}function LJe(t,e){var r=t[0],i=t[1],n=e[0],o=e[1];return Math.abs(r-n)<=Nl*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=Nl*Math.max(1,Math.abs(i),Math.abs(o))}var BJe=JSe,FJe=YSe,NJe=XSe,zJe=ZSe,UJe=KSe,VJe=QSe,jJe=eTe,$Je=(function(){var t=qSe();return function(e,r,i,n,o,s){var a,u;for(r||(r=2),i||(i=0),n?u=Math.min(n*r+i,e.length):u=e.length,a=i;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}})(),wN=(1+Math.sqrt(5))/2,fdr=2*Math.PI,vN=2*Math.PI/5,$0=Math.PI/5,sSe=Math.PI/10,WJe=2*Math.atan(wN),QJ=Math.PI-WJe,pdr=-.5*Math.PI+Math.acos(-1/Math.sqrt(3-wN)),SN=(Math.sqrt(5)-1)/2,GJe=3-Math.sqrt(5),HJe=Math.sqrt(3-wN),mdr=Math.sqrt(3)*HJe/wN;Hc.setMatrixArrayType(Float64Array);var aee=class JJ{constructor(e){this.vertices=e,this.isWindingCorrect()||this.vertices.reverse()}getArea(){let e=0,r=this.vertices.length;for(let i=0;i<r;i++){let n=(i+1)%r;e+=(this.vertices[n][0]-this.vertices[i][0])*(this.vertices[n][1]+this.vertices[i][1])}return e}isWindingCorrect(){return this.getArea()>=0}getVertices(){return this.vertices}scale(e){for(let r of this.vertices)Pi.scale(r,r,e);return this}rotate180(){for(let e of this.vertices)Pi.negate(e,e);return this}reflectY(){for(let e of this.vertices)e[1]=-e[1];return this.vertices.reverse(),this}translate(e){for(let r of this.vertices)Pi.add(r,r,e);return this}transform(e){for(let r of this.vertices)Pi.transformMat2(r,r,e);return this}transform2d(e){for(let r of this.vertices)Pi.transformMat2d(r,r,e);return this}clone(){return new JJ(this.vertices.map(r=>Pi.clone(r)))}getCenter(){let e=this.vertices.length;return this.vertices.reduce((i,n)=>[i[0]+n[0]/e,i[1]+n[1]/e],[0,0])}containsPoint(e){if(!this.isWindingCorrect())throw new Error("Pentagon is not counter-clockwise");let r=this.vertices.length,i=1;for(let n=0;n<r;n++){let o=this.vertices[n],s=this.vertices[(n+1)%r],a=o[0]-s[0],u=o[1]-s[1],p=e[0]-o[0],m=e[1]-o[1],x=a*m-u*p;if(x<0){let M=Math.sqrt(p*p+m*m);i=Math.min(i,x/M)}}return i}splitEdges(e){if(e<=1)return this;let r=[],i=this.vertices.length;for(let n=0;n<i;n++){let o=this.vertices[n],s=this.vertices[(n+1)%i];r.push(Pi.clone(o));for(let a=1;a<e;a++){let u=a/e,p=Pi.create();Pi.lerp(p,o,s,u),r.push(p)}}return new JJ(r)}};Hc.setMatrixArrayType(Float64Array);var tTe=[0,0],rTe=[0,1],Zb=[.7885966681787006,1.6149108024237764],iTe=[1.6171013659387945,1.054928690397459],nTe=[Math.cos(sSe),Math.sin(sSe)],qJe=2*Pi.length(Zb)*Math.cos($0),YJe=$0-Math.atan2(Zb[1],Zb[0]),XJe=2*SN/qJe;[tTe,rTe,Zb,iTe,nTe].forEach(t=>{Pi.scale(t,t,XJe),Pi.rotate(t,t,[0,0],YJe)});var ZJe=new aee([tTe,rTe,Zb,iTe,nTe]),oTe=Math.atan2(Zb[1],Zb[0])-$0,KJe=[0,0],bN=SN/Math.cos($0),aSe=oTe+$0,xN=[bN*Math.cos(aSe),bN*Math.sin(aSe)],lSe=oTe-$0,UI=[bN*Math.cos(lSe),bN*Math.sin(lSe)],sTe=new aee([KJe,xN,UI]),aTe=Xb.fromValues(xN[0],xN[1],UI[0],UI[1]),gdr=Xb.invert(Xb.create(),aTe),QJe=new Float64Array([-.0022392098386786394,21308606513250217e-22,-2559257686421274e-24,33701965267802837e-28,-4667545312611249e-30,667492870384816e-32]),JJe=new Float64Array([.0022392089963541657,28831978048607556e-22,508622073997266e-23,102018123778161e-25,21912872306767718e-30,49284235482523806e-33]),eet=class{applyCoefficients(t,e){let r=Math.sin(t),i=Math.cos(t),n=2*(i-r)*(i+r),o,s;return o=n*e[5]+e[4],s=n*o+e[3],o=n*s-o+e[2],s=n*o-s+e[1],o=n*s-o+e[0],t+2*r*i*o}forward(t){return this.applyCoefficients(t,QJe)}inverse(t){return this.applyCoefficients(t,JJe)}};Hc.setMatrixArrayType(Float64Array);var lTe=new eet;function cSe(t){return t*(Math.PI/180)}function uSe(t){return t*(180/Math.PI)}function hSe(t){let e=Pi.length(t),r=Math.atan2(t[1],t[0]);return[e,r]}function tet([t,e]){let r=t*Math.cos(e),i=t*Math.sin(e);return[r,i]}function ret(t,[e,r,i]){let n=[e[0]-i[0],e[1]-i[1]],o=[i[0]-r[0],i[1]-r[1]],s=[t[0]-i[0],t[1]-i[1]],a=o[0]*n[1]-o[1]*n[0],u=(o[0]*s[1]-o[1]*s[0])/a,p=(n[0]*s[1]-n[1]*s[0])/a,m=1-(u+p);return[u,p,m]}function iet(t,[e,r,i]){return[t[0]*e[0]+t[1]*r[0]+t[2]*i[0],t[0]*e[1]+t[1]*r[1]+t[2]*i[1]]}function eee(t){let e=Math.atan2(t[1],t[0]),r=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),i=Math.acos(t[2]/r);return[e,i]}function oT([t,e]){let r=Math.sin(e),i=r*Math.cos(t),n=r*Math.sin(t),o=Math.cos(e);return[i,n,o]}var cTe=93;function net([t,e]){let r=cSe(t+cTe),i=cSe(e),n=lTe.forward(i),o=Math.PI/2-n;return[r,o]}function uTe([t,e]){let r=uSe(t)-cTe,i=Math.PI/2-e,n=lTe.inverse(i),o=uSe(n);return[r,o]}function oet(t){let e=t.map(o=>oT(net(o))),r=cr.create();for(let o of e)cr.add(r,r,o);cr.normalize(r,r);let[i,n]=uTe(eee(r));return(n>89.99||n<-89.99)&&(i=t[0][0]),i=((i+180)%360+360)%360-180,t.map(o=>{let[s,a]=o;for(;s-i>180;)s=s-360;for(;s-i<-180;)s=s+360;return[s,a]})}Hc.setMatrixArrayType(Float64Array);var TN=Math.sqrt(5),MN=Math.sqrt(.2),hTe=Math.sqrt((1-MN)/2),dTe=Math.sqrt((1+MN)/2),uN=.5,dSe=Math.sqrt((2.5-TN)/10),fSe=Math.sqrt((2.5+TN)/10),pSe=Math.sqrt((1+MN)/8),mSe=Math.sqrt((1-MN)/8),gSe=Math.sqrt((3-TN)/8),ASe=Math.sqrt((3+TN)/8),set=[[0,0],[hTe,0],[dSe,uN],[-pSe,gSe],[-pSe,-gSe],[dSe,-uN],[-dTe,0],[-mSe,-ASe],[fSe,-uN],[fSe,uN],[-mSe,ASe],[0,0]],aet=set.map(([t,e])=>[-e,t]),hN=aet.map((t,e)=>e===0?[0,0,0,1]:e===11?[0,-1,0,0]:[...t,0,e<6?dTe:hTe]);Hc.setMatrixArrayType(Float64Array);var fTe=["vu","uw","vw","vw","vw"],NI=["wu","uw","vw","vu","uw"],HJ=["wu","uv","wv","wu","uw"],dN=["vu","uv","wv","wu","uw"],cet=[fTe,dN,HJ,NI,HJ,dN,HJ,NI,NI,NI,dN,dN],uet=[4,2,3,2,0,4,3,2,2,0,3,0],ySe=[0,1,2,4,3,5,7,8,6,11,10,9],dp=[];function het(){fN([0,0],0,hN[0]);for(let t=0;t<5;t++){let e=t*vN,r=e+$0;fN([e,QJ],$0,hN[t+1]),fN([r,Math.PI-QJ],$0,hN[(t+3)%5+6])}fN([0,Math.PI],0,hN[11])}var rT=0;function fN(t,e,r){if(rT>11)throw new Error(`Too many origins: ${rT}`);let i=XJ.create();XJ.conjugate(i,r);let n={id:rT,axis:t,quat:r,inverseQuat:i,angle:e,orientation:cet[rT],firstQuintant:uet[rT]};dp.push(n),rT++}het();dp.sort((t,e)=>ySe.indexOf(t.id)-ySe.indexOf(e.id));dp.forEach((t,e)=>t.id=e);function det(t,e){let r=e.orientation,i=r===fTe||r===NI?-1:1,n=(t-e.firstQuintant+5)%5,o=r[n];return{quintant:(e.firstQuintant+i*n+5)%5,orientation:o}}var fet=class{forward([t,e]){return[Math.tan(e),t]}inverse([t,e]){return[e,Math.atan(t)]}},iT=cr.create(),zI=cr.create(),_Se=cr.create(),vSe=cr.create();function qJ(t,e){cr.lerp(iT,t,e,.5),cr.normalize(iT,iT),cr.cross(iT,t,iT);let r=cr.length(iT);if(r<1e-8){let i=cr.subtract(cr.create(),t,e);return .5*cr.length(i)}return r}function pet(t,e,r){return cr.cross(zI,e,r),cr.dot(t,zI)}function met(t,e,r,i,n){cr.cross(zI,i,n);let o=cr.dot(e,zI),s=cr.dot(r,zI);return cr.scale(_Se,e,s),cr.scale(vSe,r,o),cr.sub(t,vSe,_Se)}function tee(t,e,r,i){let n=cr.angle(e,r);if(n<1e-12)return cr.lerp(t,e,r,i);let o=Math.sin((1-i)*n)/Math.sin(n),s=Math.sin(i*n)/Math.sin(n),a=cr.scale(cr.create(),e,o),u=cr.scale(cr.create(),r,s);return cr.add(t,a,u)}Hc.setMatrixArrayType(Float64Array);var pN=cr.create(),mN=cr.create(),gN=cr.create(),nT=cr.create(),get=class{constructor(t){this._area=null,this.vertices=t,Object.freeze(this.vertices)}getBoundary(t=1,e=!0){let r=[],i=this.vertices.length;for(let n=0;n<i*t;n++){let o=n/t;r.push(this.slerp(o))}return e&&r.push(r[0]),r}slerp(t){let e=this.vertices.length,r=t%1,i=Math.floor(t%e),n=(i+1)%e;return tee(cr.create(),this.vertices[i],this.vertices[n],r)}getTransformedVertices(t){let e=this.vertices.length,r=Math.floor(t%e),i=(r+1)%e,n=(r+e-1)%e,o=cr.clone(this.vertices[r]),s=cr.clone(this.vertices[i]),a=cr.clone(this.vertices[n]);return cr.sub(s,s,o),cr.sub(a,a,o),[o,s,a]}containsPoint(t){let e=this.vertices.length,r=1/0;for(let i=0;i<e;i++){let[n,o,s]=this.getTransformedVertices(i),a=cr.sub(cr.create(),t,n);cr.normalize(a,a),cr.normalize(o,o),cr.normalize(s,s);let u=cr.cross(cr.create(),o,a),p=cr.cross(cr.create(),a,s),m=cr.dot(n,u),x=cr.dot(n,p);r=Math.min(r,m,x)}return r}getTriangleArea(t,e,r){cr.lerp(pN,e,r,.5),cr.lerp(mN,r,t,.5),cr.lerp(gN,t,e,.5),cr.normalize(pN,pN),cr.normalize(mN,mN),cr.normalize(gN,gN);let i=pet(pN,mN,gN),n=Math.max(-1,Math.min(1,i));return Math.abs(n)<1e-8?2*n:Math.asin(n)*2}getArea(){return this._area===null&&(this._area=this._getArea()),this._area}_getArea(){if(this.vertices.length<3)return 0;if(this.vertices.length===3)return this._area=this.getTriangleArea(this.vertices[0],this.vertices[1],this.vertices[2]),this._area;cr.set(nT,0,0,0);for(let e of this.vertices)cr.add(nT,nT,e);cr.normalize(nT,nT);let t=0;for(let e=0;e<this.vertices.length;e++){let r=this.vertices[e],i=this.vertices[(e+1)%this.vertices.length],n=this.getTriangleArea(nT,r,i);isNaN(n)||(t+=n)}return this._area=t,this._area}isWindingCorrect(){if(!(this.getArea()>0))debugger}};Hc.setMatrixArrayType(Float64Array);var AN=class extends get{constructor(t){if(t.length!==3)throw new Error("SphericalTriangleShape requires exactly 3 vertices");super(t)}};Hc.setMatrixArrayType(Float64Array);var Aet=class{forward(t,e,r){let[i,n,o]=e,s=new AN([i,n,o]),a=cr.subtract(cr.create(),t,i);cr.normalize(a,a);let u=met(cr.create(),i,a,n,o);cr.normalize(u,u);let p=qJ(i,t)/qJ(i,u),m=s.getArea(),x=p/m,M=[1-p,x*new AN([i,u,o]).getArea(),x*new AN([i,n,u]).getArea()];return iet(M,r)}inverse(t,e,r){let[i,n,o]=r,s=new AN([i,n,o]),a=ret(t,e),u=1-1e-14;if(a[0]>u)return i;if(a[1]>u)return n;if(a[2]>u)return o;let p=cr.create();cr.cross(p,n,o);let m=s.getArea(),x=1-a[0],k=a[2]/x*m,F=Math.sin(k),j=Math.sin(k/2),H=2*j*j,W=cr.dot(i,n),Z=cr.dot(n,o),Y=cr.dot(o,i),ee=cr.length(p),ce=cr.dot(i,p),ge=F*ce+H*(W*Z-Y),Se=H*ee*(1+W),ne=2/Math.acos(Z)*Math.atan2(Se,ge),pe=tee(cr.create(),n,o,ne),ue=qJ(i,pe),Le=this.safeAcos(x*ue)/this.safeAcos(ue);return tee([0,0,0],i,pe,Le)}safeAcos(t){return t<.001?2*t+t*t*t/3:Math.acos(1-2*t*t)}};Hc.setMatrixArrayType(Float64Array);var Fh=-1,Gc=1,yet=([t,e])=>Pi.fromValues(t-e,e),ree=Pi.fromValues(1,0),iee=Pi.fromValues(0,1),bSe=Pi.negate(Pi.create(),ree),xSe=Pi.negate(Pi.create(),iee),YJ=Pi.fromValues(0,0),_et=(t,[e,r])=>{let i=YJ,n=YJ;switch(e===Gc&&r===Gc?(i=ree,n=iee):e===Fh&&r===Gc?(i=xSe,n=bSe):e===Gc&&r===Fh?(i=iee,n=ree):e===Fh&&r===Fh&&(i=bSe,n=xSe),t){case 0:return YJ;case 1:return i;case 2:return Pi.add(Pi.create(),n,i);case 3:return Pi.scaleAndAdd(Pi.create(),n,i,2);default:throw new Error(`Invalid Quaternary value: ${t}`)}},wSe=t=>[[Gc,Gc],[Gc,Fh],[Gc,Gc],[Fh,Gc]][t],SSe=Pi.fromValues(-1,1);function pTe(t){return Array.from({length:t.length},(e,r)=>t.indexOf(r))}var mTe=[0,1,3,4,5,6,7,2],gTe=[0,1,2,7,3,4,5,6],Adr=pTe(mTe),ydr=pTe(gTe),vet=(t,e,r,i,n)=>{if(e<=0)return;let o=t[e]||0,s=t[e-1],a=r[0]+r[1],u=!0,p=!0;if(i!==(a===0)?(u=o===1||o===2,p=o===1):(u=o<2,p=o===0),!u)return;let m=p?s:s+4,x=n[m];t[e-1]=x%4,t[e]=(o+4+Math.floor(x/4)-Math.floor(m/4))%4},bet=(t,e,r)=>{let i=BigInt(t),n=r==="vu"||r==="wu"||r==="vw",o=r==="wv"||r==="vw",s=r==="wu"||r==="uw";n&&(i=(1n<<BigInt(2*e))-i-1n);let a=xet(i,e,o,s);if(s){let{offset:[u,p],flips:[m,x]}=a;a.offset=[p,u],m===Fh&&Pi.add(a.offset,a.offset,SSe),x===Fh&&Pi.subtract(a.offset,a.offset,SSe)}if(o){let{offset:[u,p],flips:m}=a,x=(1<<e)-(u+p);m[0]=-m[0],a.offset[1]=x,a.flips=m}return a},xet=(t,e,r,i)=>{let n=Pi.create(),o=[Gc,Gc],s=BigInt(t),a=[];for(;s>0n||a.length<e;)a.push(Number(s%4n)),s=s>>2n;let u=i?gTe:mTe;for(let m=a.length-1;m>=0;m--)vet(a,m,o,r,u),Pi.multiply(o,o,wSe(a[m]));o[0]=Gc,o[1]=Gc;for(let m=a.length-1;m>=0;m--){Pi.scale(n,n,2);let x=_et(a[m],o);Pi.add(n,n,x),Pi.multiply(o,o,wSe(a[m]))}let p=a[0]||0;return{flips:o,k:p,offset:yet(n)}};Hc.setMatrixArrayType(Float64Array);var wet=!1,Tet=Pi.clone(UI),Met=Pi.negate(Pi.create(),UI),lee=[0,1,2,3,4].map(t=>{let e=Xb.create();return Xb.fromRotation(e,vN*t),e}),TSe=Pi.create();function Eet(t,e,r){let i=(wet?sTe:ZJe).clone();Pi.transformMat2(TSe,r.offset,aTe),r.flips[0]===Gc&&r.flips[1]===Fh&&i.rotate180();let{k:n}=r,o=r.flips[0]+r.flips[1];return((o===-2||o===2)&&n>1||o===0&&(n===0||n===3))&&i.reflectY(),r.flips[0]===Fh&&r.flips[1]===Fh?i.rotate180():r.flips[0]===Fh?i.translate(Met):r.flips[1]===Fh&&i.translate(Tet),i.translate(TSe),i.scale(1/2**t),i.transform(lee[e]),i}function ATe(t){let e=sTe.clone();return e.transform(lee[t]),e}function Cet(){let t=[];for(let e of lee)t.push(Pi.transformMat2(Pi.create(),xN,e));return t.reverse(),new aee(t)}Hc.setMatrixArrayType(Float64Array);var Pet=class{constructor(){if(this.vertices=[],this.invocations=0,this.addFaceCenters(),this.addVertices(),this.addMidpoints(),this.vertices.length!==62)throw new Error("Failed to construct CRS: vertices length is not 62");Object.freeze(this.vertices)}getVertex(t){this.invocations++,this.invocations===1e4&&console.warn("Too many CRS invocations, results should be cached");for(let e of this.vertices)if(cr.distance(t,e)<1e-5)return e;throw new Error("Failed to find vertex in CRS")}addFaceCenters(){dp.forEach(t=>this.add(oT(t.axis)))}addVertices(){let t=Math.atan(GJe);for(let e of dp)for(let r=0;r<5;r++){let i=(2*r+1)*Math.PI/5,n=oT([i+e.angle,t]);cr.transformQuat(n,n,e.quat),this.add(n)}}addMidpoints(){let t=Math.atan(SN);for(let e of dp)for(let r=0;r<5;r++){let i=2*r*Math.PI/5,n=oT([i+e.angle,t]);cr.transformQuat(n,n,e.quat),this.add(n)}}add(t){let e=cr.normalize(cr.create(),t);return this.vertices.find(i=>cr.distance(e,i)<1e-5)?!1:(this.vertices.push(e),!0)}};Hc.setMatrixArrayType(Float64Array);var Iet=new Pet,ket=class{constructor(){this.faceTriangles=[],this.sphericalTriangles=[],this.polyhedral=new Aet,this.gnomonic=new fet}forward(t,e){let r=dp[e],i=oT(t),n=cr.create();cr.transformQuat(n,i,r.inverseQuat);let o=eee(n),s=this.gnomonic.forward(o);s[1]=s[1]-r.angle;let a=this.getFaceTriangleIndex(s),u=this.shouldReflect(s),p=this.getFaceTriangle(a,u,!1),m=this.getSphericalTriangle(a,e,u);return this.polyhedral.forward(i,m,p)}inverse(t,e){let r=hSe(t),i=this.getFaceTriangleIndex(r),n=this.shouldReflect(r),o=this.getFaceTriangle(i,n,!1),s=this.getSphericalTriangle(i,e,n),a=this.polyhedral.inverse(t,o,s);return eee(a)}shouldReflect(t){let[e,r]=t;return tet([e,this.normalizeGamma(r)])[0]>SN}getFaceTriangleIndex([t,e]){return(Math.floor(e/$0)+10)%10}getFaceTriangle(t,e=!1,r=!1){let i=t;return e&&(i+=r?20:10),this.faceTriangles[i]?this.faceTriangles[i]:(this.faceTriangles[i]=e?this._getReflectedFaceTriangle(t,r):this._getFaceTriangle(t),Object.freeze(this.faceTriangles[i]),this.faceTriangles[i])}_getFaceTriangle(t){let e=Math.floor((t+1)/2)%5,[r,i,n]=ATe(e).getVertices(),o=Pi.create();return Pi.lerp(o,i,n,.5),t%2===0?[r,o,i]:[r,n,o]}_getReflectedFaceTriangle(t,e=!1){let[r,i,n]=this._getFaceTriangle(t).map(a=>Pi.clone(a)),o=t%2===0;Pi.negate(r,r);let s=o?i:n;return Pi.scaleAndAdd(r,r,s,e?1+1/Math.cos(QJ):2),[r,n,i]}getSphericalTriangle(t,e,r=!1){let i=10*e+t;return r&&(i+=120),this.sphericalTriangles[i]?this.sphericalTriangles[i]:(this.sphericalTriangles[i]=this._getSphericalTriangle(t,e,r),Object.freeze(this.sphericalTriangles[i]),this.sphericalTriangles[i])}_getSphericalTriangle(t,e,r=!1){let i=dp[e];return this.getFaceTriangle(t,r,!0).map(s=>{let[a,u]=hSe(s),p=[a,u+i.angle],m=oT(this.gnomonic.inverse(p));return cr.transformQuat(m,m,i.quat),Iet.getVertex(m)})}normalizeGamma(t){let e=t/vN,r=Math.round(e);return(e-r)*vN}},sT=2,Ret=30,Oet=58n,Det=0x3ffffffffffffffn;function Let(t){let e=Ret-1,r=t>>1n;for(;e>-1&&(r&0b1n)===0n;)e-=1,r=r>>(e<sT?1n:2n);return e}function Bet(t){let e=Let(t);if(e===-1)return{origin:dp[0],segment:0,S:0n,resolution:e};let r=Number(t>>58n),i,n;if(e===0)i=dp[r],n=0;else{let p=Math.floor(r/5);i=dp[p],n=(r+i.firstQuintant)%5}if(!i)throw new Error(`Could not parse origin: ${r}`);if(e<sT)return{origin:i,segment:n,S:0n,resolution:e};let o=e-sT+1,s=BigInt(2*o),a=Oet-s,u=(t&Det)>>a;return{origin:i,segment:n,S:u,resolution:e}}Hc.setMatrixArrayType(Float64Array);var _dr=Xb.create(),Fet=new ket;function Net({S:t,segment:e,origin:r,resolution:i}){let{quintant:n,orientation:o}=det(e,r);if(i===sT-1)return ATe(n);if(i===sT-2)return Cet();let s=i-sT+1,a=bet(t,s,o);return Eet(s,n,a)}function yTe(t,{closedRing:e=!0,segments:r="auto"}={closedRing:!0,segments:"auto"}){let{S:i,segment:n,origin:o,resolution:s}=Bet(t);r==="auto"&&(r=Math.max(1,Math.pow(2,6-s)));let x=Net({S:i,segment:n,origin:o,resolution:s}).splitEdges(r).getVertices().map(k=>Fet.inverse(k,o.id)).map(k=>uTe(k)),M=oet(x);return e&&M.push(M[0]),M.reverse(),M}function _Te(t){return BigInt(`0x${t}`)}var MSe=63710072e-1,vdr=4*Math.PI*MSe*MSe;Hc.setMatrixArrayType(Float64Array);var Us=(function(t){t=t||{};var e=typeof t<"u"?t:{},r={},i;for(i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);var n=[],o="";function s(vt){return e.locateFile?e.locateFile(vt,o):o+vt}var a;typeof document<"u"&&document.currentScript&&(o=document.currentScript.src),o.indexOf("blob:")!==0?o=o.substr(0,o.lastIndexOf("/")+1):o="",a=function(Nt,sr,zt){var A=new XMLHttpRequest;A.open("GET",Nt,!0),A.responseType="arraybuffer",A.onload=function(){if(A.status==200||A.status==0&&A.response){sr(A.response);return}var sn=di(Nt);if(sn){sr(sn.buffer);return}zt()},A.onerror=zt,A.send(null)};var u=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(i in r)r.hasOwnProperty(i)&&(e[i]=r[i]);r=null,e.arguments&&(n=e.arguments);var m=0,x=function(vt){m=vt},M=function(){return m},k=8;function F(vt,Nt,sr,zt){switch(sr=sr||"i8",sr.charAt(sr.length-1)==="*"&&(sr="i32"),sr){case"i1":rt[vt>>0]=Nt;break;case"i8":rt[vt>>0]=Nt;break;case"i16":Wt[vt>>1]=Nt;break;case"i32":Bt[vt>>2]=Nt;break;case"i64":fe=[Nt>>>0,(he=Nt,+Ss(he)>=1?he>0?(_c(+Gl(he/4294967296),4294967295)|0)>>>0:~~+Wl((he-+(~~he>>>0))/4294967296)>>>0:0)],Bt[vt>>2]=fe[0],Bt[vt+4>>2]=fe[1];break;case"float":hr[vt>>2]=Nt;break;case"double":nt[vt>>3]=Nt;break;default:Xu("invalid type for setValue: "+sr)}}function j(vt,Nt,sr){switch(Nt=Nt||"i8",Nt.charAt(Nt.length-1)==="*"&&(Nt="i32"),Nt){case"i1":return rt[vt>>0];case"i8":return rt[vt>>0];case"i16":return Wt[vt>>1];case"i32":return Bt[vt>>2];case"i64":return Bt[vt>>2];case"float":return hr[vt>>2];case"double":return nt[vt>>3];default:Xu("invalid type for getValue: "+Nt)}return null}var H=!1;function W(vt,Nt){vt||Xu("Assertion failed: "+Nt)}function Z(vt){var Nt=e["_"+vt];return W(Nt,"Cannot call unknown function "+vt+", make sure it is exported"),Nt}function Y(vt,Nt,sr,zt,A){var wn={string:function(jo){var en=0;if(jo!=null&&jo!==0){var Yi=(jo.length<<2)+1;en=xc(Yi),pe(jo,en,Yi)}return en},array:function(jo){var en=xc(jo.length);return Le(jo,en),en}};function sn(jo){return Nt==="string"?Se(jo):Nt==="boolean"?!!jo:jo}var de=Z(vt),Ms=[],Ys=0;if(zt)for(var So=0;So<zt.length;So++){var qi=wn[sr[So]];qi?(Ys===0&&(Ys=Gh()),Ms[So]=qi(zt[So])):Ms[So]=zt[So]}var Kn=de.apply(null,Ms);return Kn=sn(Kn),Ys!==0&&Oo(Ys),Kn}function ee(vt,Nt,sr,zt){sr=sr||[];var A=sr.every(function(sn){return sn==="number"}),wn=Nt!=="string";return wn&&A&&!zt?Z(vt):function(){return Y(vt,Nt,sr,arguments,zt)}}var ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ge(vt,Nt,sr){for(var zt=Nt+sr,A=Nt;vt[A]&&!(A>=zt);)++A;if(A-Nt>16&&vt.subarray&&ce)return ce.decode(vt.subarray(Nt,A));for(var wn="";Nt<A;){var sn=vt[Nt++];if(!(sn&128)){wn+=String.fromCharCode(sn);continue}var de=vt[Nt++]&63;if((sn&224)==192){wn+=String.fromCharCode((sn&31)<<6|de);continue}var Ms=vt[Nt++]&63;if((sn&240)==224?sn=(sn&15)<<12|de<<6|Ms:sn=(sn&7)<<18|de<<12|Ms<<6|vt[Nt++]&63,sn<65536)wn+=String.fromCharCode(sn);else{var Ys=sn-65536;wn+=String.fromCharCode(55296|Ys>>10,56320|Ys&1023)}}return wn}function Se(vt,Nt){return vt?ge(at,vt,Nt):""}function ne(vt,Nt,sr,zt){if(!(zt>0))return 0;for(var A=sr,wn=sr+zt-1,sn=0;sn<vt.length;++sn){var de=vt.charCodeAt(sn);if(de>=55296&&de<=57343){var Ms=vt.charCodeAt(++sn);de=65536+((de&1023)<<10)|Ms&1023}if(de<=127){if(sr>=wn)break;Nt[sr++]=de}else if(de<=2047){if(sr+1>=wn)break;Nt[sr++]=192|de>>6,Nt[sr++]=128|de&63}else if(de<=65535){if(sr+2>=wn)break;Nt[sr++]=224|de>>12,Nt[sr++]=128|de>>6&63,Nt[sr++]=128|de&63}else{if(sr+3>=wn)break;Nt[sr++]=240|de>>18,Nt[sr++]=128|de>>12&63,Nt[sr++]=128|de>>6&63,Nt[sr++]=128|de&63}}return Nt[sr]=0,sr-A}function pe(vt,Nt,sr){return ne(vt,at,Nt,sr)}var ue=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Le(vt,Nt){rt.set(vt,Nt)}function We(vt,Nt){return vt%Nt>0&&(vt+=Nt-vt%Nt),vt}var ze,rt,at,Wt,It,Bt,Qt,hr,nt;function Et(vt){ze=vt,e.HEAP8=rt=new Int8Array(vt),e.HEAP16=Wt=new Int16Array(vt),e.HEAP32=Bt=new Int32Array(vt),e.HEAPU8=at=new Uint8Array(vt),e.HEAPU16=It=new Uint16Array(vt),e.HEAPU32=Qt=new Uint32Array(vt),e.HEAPF32=hr=new Float32Array(vt),e.HEAPF64=nt=new Float64Array(vt)}var yr=5271520,xr=28608,oi=e.TOTAL_MEMORY||33554432;e.buffer?ze=e.buffer:ze=new ArrayBuffer(oi),oi=ze.byteLength,Et(ze),Bt[xr>>2]=yr;function jr(vt){for(;vt.length>0;){var Nt=vt.shift();if(typeof Nt=="function"){Nt();continue}var sr=Nt.func;typeof sr=="number"?Nt.arg===void 0?e.dynCall_v(sr):e.dynCall_vi(sr,Nt.arg):sr(Nt.arg===void 0?null:Nt.arg)}}var zi=[],on=[],Ki=[],hn=[];function _l(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)vl(e.preRun.shift());jr(zi)}function xn(){jr(on)}function dn(){jr(Ki)}function Pa(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)cs(e.postRun.shift());jr(hn)}function vl(vt){zi.unshift(vt)}function cs(vt){hn.unshift(vt)}var Ss=Math.abs,Wl=Math.ceil,Gl=Math.floor,_c=Math.min,us=0,$s=null,vc=null;function bl(vt){us++,e.monitorRunDependencies&&e.monitorRunDependencies(us)}function rm(vt){if(us--,e.monitorRunDependencies&&e.monitorRunDependencies(us),us==0&&($s!==null&&(clearInterval($s),$s=null),vc)){var Nt=vc;vc=null,Nt()}}e.preloadedImages={},e.preloadedAudios={};var Ia=null,Hl="data:application/octet-stream;base64,";function Je(vt){return String.prototype.startsWith?vt.startsWith(Hl):vt.indexOf(Hl)===0}var he,fe;Ia="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var xe=28624;function Ne(vt){return vt}function $e(vt){var Nt=/\b__Z[\w\d_]+/g;return vt.replace(Nt,function(sr){var zt=sr;return sr===zt?sr:zt+" ["+sr+"]"})}function tt(){var vt=new Error;if(!vt.stack){try{throw new Error(0)}catch(Nt){vt=Nt}if(!vt.stack)return"(no stack trace available)"}return vt.stack.toString()}function yt(){var vt=tt();return e.extraStackTrace&&(vt+=`
`+e.extraStackTrace()),$e(vt)}function it(vt,Nt,sr,zt){Xu("Assertion failed: "+Se(vt)+", at: "+[Nt?Se(Nt):"unknown filename",sr,zt?Se(zt):"unknown function"])}function xt(){return rt.length}function Ft(vt,Nt,sr){at.set(at.subarray(Nt,Nt+sr),vt)}function Ct(vt){return e.___errno_location&&(Bt[e.___errno_location()>>2]=vt),vt}function vr(vt){Xu("OOM")}function lt(vt){try{var Nt=new ArrayBuffer(vt);return Nt.byteLength!=vt?void 0:(new Int8Array(Nt).set(rt),cv(Nt),Et(Nt),1)}catch{}}function Ei(vt){var Nt=xt(),sr=16777216,zt=2147483648-sr;if(vt>zt)return!1;for(var A=16777216,wn=Math.max(Nt,A);wn<vt;)wn<=536870912?wn=We(2*wn,sr):wn=Math.min(We((3*wn+2147483648)/4,sr),zt);var sn=lt(wn);return!!sn}var jn=typeof atob=="function"?atob:function(vt){var Nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sr="",zt,A,wn,sn,de,Ms,Ys,So=0;vt=vt.replace(/[^A-Za-z0-9\+\/\=]/g,"");do sn=Nt.indexOf(vt.charAt(So++)),de=Nt.indexOf(vt.charAt(So++)),Ms=Nt.indexOf(vt.charAt(So++)),Ys=Nt.indexOf(vt.charAt(So++)),zt=sn<<2|de>>4,A=(de&15)<<4|Ms>>2,wn=(Ms&3)<<6|Ys,sr=sr+String.fromCharCode(zt),Ms!==64&&(sr=sr+String.fromCharCode(A)),Ys!==64&&(sr=sr+String.fromCharCode(wn));while(So<vt.length);return sr};function wr(vt){try{for(var Nt=jn(vt),sr=new Uint8Array(Nt.length),zt=0;zt<Nt.length;++zt)sr[zt]=Nt.charCodeAt(zt);return sr}catch{throw new Error("Converting base64 string to bytes failed.")}}function di(vt){if(Je(vt))return wr(vt.slice(Hl.length))}var rn={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Jo={a:Xu,b:x,c:M,d:it,e:Ct,f:xt,g:Ft,h:Ei,i:vr,j:Ne,k:$e,l:lt,m:tt,n:yt,o:xe,p:xr},Lt=(function(vt,Nt,sr){"almost asm";var zt=new vt.Int8Array(sr),A=new vt.Int32Array(sr),wn=new vt.Uint8Array(sr),sn=new vt.Float32Array(sr),de=new vt.Float64Array(sr),Ms=Nt.o|0,Ys=Nt.p|0,So=vt.Math.floor,qi=vt.Math.abs,Kn=vt.Math.sqrt,jo=vt.Math.pow,en=vt.Math.cos,Yi=vt.Math.sin,hm=vt.Math.tan,Nx=vt.Math.acos,zx=vt.Math.asin,dm=vt.Math.atan,Da=vt.Math.atan2,hf=vt.Math.ceil,wc=vt.Math.imul,dA=vt.Math.min,Ux=vt.Math.max,Es=vt.Math.clz32,si=Nt.b,be=Nt.c,Ur=Nt.d,Vx=Nt.e,Mp=Nt.f,jx=Nt.g,B4=Nt.h,$x=Nt.i,me=28640;function gv(g){return zt=new Int8Array(g),wn=new Uint8Array(g),A=new Int32Array(g),sn=new Float32Array(g),de=new Float64Array(g),sr=g,!0}function Av(g){g=g|0;var y=0;return y=me,me=me+g|0,me=me+15&-16,y|0}function Wx(){return me|0}function fA(g){g=g|0,me=g}function su(g,y){g=g|0,y=y|0,me=g}function yv(g,y){g=g|0,y=y|0;var b=0,T=0,E=0;return(g|0)<0?(y=2,y|0):(g|0)>13780509?(y=vf(15,y)|0,y|0):(b=((g|0)<0)<<31>>31,E=Ar(g|0,b|0,3,0)|0,T=be()|0,b=Ye(g|0,b|0,1,0)|0,b=Ar(E|0,T|0,b|0,be()|0)|0,b=Ye(b|0,be()|0,1,0)|0,g=be()|0,A[y>>2]=b,A[y+4>>2]=g,y=0,y|0)}function pA(g,y,b,T){return g=g|0,y=y|0,b=b|0,T=T|0,mA(g,y,b,T,0)|0}function mA(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0;if(G=me,me=me+16|0,B=G,!(_v(g,y,b,T,E)|0))return T=0,me=G,T|0;do if((b|0)>=0){if((b|0)>13780509){if(O=vf(15,B)|0,O|0)break;N=B,B=A[N>>2]|0,N=A[N+4>>2]|0}else O=((b|0)<0)<<31>>31,K=Ar(b|0,O|0,3,0)|0,N=be()|0,O=Ye(b|0,O|0,1,0)|0,O=Ar(K|0,N|0,O|0,be()|0)|0,O=Ye(O|0,be()|0,1,0)|0,N=be()|0,A[B>>2]=O,A[B+4>>2]=N,B=O;if(ro(T|0,0,B<<3|0)|0,E|0){ro(E|0,0,B<<2|0)|0,O=Ti(g,y,b,T,E,B,N,0)|0;break}O=ct(B,4)|0,O?(K=Ti(g,y,b,T,O,B,N,0)|0,Ke(O),O=K):O=13}else O=2;while(!1);return K=O,me=G,K|0}function _v(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0;if(qe=me,me=me+16|0,ke=qe,Ie=qe+8|0,Ee=ke,A[Ee>>2]=g,A[Ee+4>>2]=y,(b|0)<0)return Ie=2,me=qe,Ie|0;if(O=T,A[O>>2]=g,A[O+4>>2]=y,O=(E|0)!=0,O&&(A[E>>2]=0),En(g,y)|0)return Ie=9,me=qe,Ie|0;A[Ie>>2]=0;e:do if((b|0)>=1)if(O)for(te=1,K=0,_e=0,Ee=1,O=g;;){if(!(K|_e)){if(O=fo(O,y,4,Ie,ke)|0,O|0)break e;if(y=ke,O=A[y>>2]|0,y=A[y+4>>2]|0,En(O,y)|0){O=9;break e}}if(O=fo(O,y,A[26800+(_e<<2)>>2]|0,Ie,ke)|0,O|0)break e;if(y=ke,O=A[y>>2]|0,y=A[y+4>>2]|0,g=T+(te<<3)|0,A[g>>2]=O,A[g+4>>2]=y,A[E+(te<<2)>>2]=Ee,g=K+1|0,B=(g|0)==(Ee|0),N=_e+1|0,G=(N|0)==6,En(O,y)|0){O=9;break e}if(Ee=Ee+(G&B&1)|0,(Ee|0)>(b|0)){O=0;break}else te=te+1|0,K=B?0:g,_e=B?G?0:N:_e}else for(te=1,K=0,_e=0,Ee=1,O=g;;){if(!(K|_e)){if(O=fo(O,y,4,Ie,ke)|0,O|0)break e;if(y=ke,O=A[y>>2]|0,y=A[y+4>>2]|0,En(O,y)|0){O=9;break e}}if(O=fo(O,y,A[26800+(_e<<2)>>2]|0,Ie,ke)|0,O|0)break e;if(y=ke,O=A[y>>2]|0,y=A[y+4>>2]|0,g=T+(te<<3)|0,A[g>>2]=O,A[g+4>>2]=y,g=K+1|0,B=(g|0)==(Ee|0),N=_e+1|0,G=(N|0)==6,En(O,y)|0){O=9;break e}if(Ee=Ee+(G&B&1)|0,(Ee|0)>(b|0)){O=0;break}else te=te+1|0,K=B?0:g,_e=B?G?0:N:_e}else O=0;while(!1);return Ie=O,me=qe,Ie|0}function Ti(g,y,b,T,E,O,B,N){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,O=O|0,B=B|0,N=N|0;var G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0;if(qe=me,me=me+16|0,ke=qe+8|0,Ie=qe,G=An(g|0,y|0,O|0,B|0)|0,te=be()|0,_e=T+(G<<3)|0,ot=_e,wt=A[ot>>2]|0,ot=A[ot+4>>2]|0,K=(wt|0)==(g|0)&(ot|0)==(y|0),!((wt|0)==0&(ot|0)==0|K))do G=Ye(G|0,te|0,1,0)|0,G=Wi(G|0,be()|0,O|0,B|0)|0,te=be()|0,_e=T+(G<<3)|0,wt=_e,ot=A[wt>>2]|0,wt=A[wt+4>>2]|0,K=(ot|0)==(g|0)&(wt|0)==(y|0);while(!((ot|0)==0&(wt|0)==0|K));if(G=E+(G<<2)|0,K&&(A[G>>2]|0)<=(N|0)||(wt=_e,A[wt>>2]=g,A[wt+4>>2]=y,A[G>>2]=N,(N|0)>=(b|0)))return wt=0,me=qe,wt|0;switch(K=N+1|0,A[ke>>2]=0,G=fo(g,y,2,ke,Ie)|0,G|0){case 9:{Ee=9;break}case 0:{G=Ie,G=Ti(A[G>>2]|0,A[G+4>>2]|0,b,T,E,O,B,K)|0,G||(Ee=9);break}default:}e:do if((Ee|0)==9){switch(A[ke>>2]=0,G=fo(g,y,3,ke,Ie)|0,G|0){case 9:break;case 0:{if(G=Ie,G=Ti(A[G>>2]|0,A[G+4>>2]|0,b,T,E,O,B,K)|0,G|0)break e;break}default:break e}switch(A[ke>>2]=0,G=fo(g,y,1,ke,Ie)|0,G|0){case 9:break;case 0:{if(G=Ie,G=Ti(A[G>>2]|0,A[G+4>>2]|0,b,T,E,O,B,K)|0,G|0)break e;break}default:break e}switch(A[ke>>2]=0,G=fo(g,y,5,ke,Ie)|0,G|0){case 9:break;case 0:{if(G=Ie,G=Ti(A[G>>2]|0,A[G+4>>2]|0,b,T,E,O,B,K)|0,G|0)break e;break}default:break e}switch(A[ke>>2]=0,G=fo(g,y,4,ke,Ie)|0,G|0){case 9:break;case 0:{if(G=Ie,G=Ti(A[G>>2]|0,A[G+4>>2]|0,b,T,E,O,B,K)|0,G|0)break e;break}default:break e}switch(A[ke>>2]=0,G=fo(g,y,6,ke,Ie)|0,G|0){case 9:break;case 0:{if(G=Ie,G=Ti(A[G>>2]|0,A[G+4>>2]|0,b,T,E,O,B,K)|0,G|0)break e;break}default:break e}return wt=0,me=qe,wt|0}while(!1);return wt=G,me=qe,wt|0}function fo(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0;if(b>>>0>6)return E=1,E|0;if(_e=(A[T>>2]|0)%6|0,A[T>>2]=_e,(_e|0)>0){O=0;do b=au(b)|0,O=O+1|0;while((O|0)<(A[T>>2]|0))}if(_e=St(g|0,y|0,45)|0,be()|0,te=_e&127,te>>>0>121)return E=5,E|0;G=po(g,y)|0,O=St(g|0,y|0,52)|0,be()|0,O=O&15;e:do if(!O)K=8;else{for(;;){if(B=(15-O|0)*3|0,N=St(g|0,y|0,B|0)|0,be()|0,N=N&7,(N|0)==7){y=5;break}if(Ie=(wl(O)|0)==0,O=O+-1|0,Ee=Dt(7,0,B|0)|0,y=y&~(be()|0),ke=Dt(A[(Ie?432:16)+(N*28|0)+(b<<2)>>2]|0,0,B|0)|0,B=be()|0,b=A[(Ie?640:224)+(N*28|0)+(b<<2)>>2]|0,g=ke|g&~Ee,y=B|y,!b){b=0;break e}if(!O){K=8;break e}}return y|0}while(!1);(K|0)==8&&(Ie=A[848+(te*28|0)+(b<<2)>>2]|0,ke=Dt(Ie|0,0,45)|0,g=ke|g,y=be()|0|y&-1040385,b=A[4272+(te*28|0)+(b<<2)>>2]|0,(Ie&127|0)==127&&(Ie=Dt(A[848+(te*28|0)+20>>2]|0,0,45)|0,y=be()|0|y&-1040385,b=A[4272+(te*28|0)+20>>2]|0,g=Qh(Ie|g,y)|0,y=be()|0,A[T>>2]=(A[T>>2]|0)+1)),N=St(g|0,y|0,45)|0,be()|0,N=N&127;e:do if(In(N)|0){t:do if((po(g,y)|0)==1){if((te|0)!=(N|0))if(xl(N,A[7696+(te*28|0)>>2]|0)|0){g=kv(g,y)|0,B=1,y=be()|0;break}else Ur(27795,26864,533,26872);switch(G|0){case 3:{g=Qh(g,y)|0,y=be()|0,A[T>>2]=(A[T>>2]|0)+1,B=0;break t}case 5:{g=kv(g,y)|0,y=be()|0,A[T>>2]=(A[T>>2]|0)+5,B=0;break t}case 0:return Ie=9,Ie|0;default:return Ie=1,Ie|0}}else B=0;while(!1);if((b|0)>0){O=0;do g=Kl(g,y)|0,y=be()|0,O=O+1|0;while((O|0)!=(b|0))}if((te|0)!=(N|0)){if(!(Ep(N)|0)){if((B|0)!=0|(po(g,y)|0)!=5)break;A[T>>2]=(A[T>>2]|0)+1;break}switch(_e&127){case 8:case 118:break e;default:}(po(g,y)|0)!=3&&(A[T>>2]=(A[T>>2]|0)+1)}}else if((b|0)>0){O=0;do g=Qh(g,y)|0,y=be()|0,O=O+1|0;while((O|0)!=(b|0))}while(!1);return A[T>>2]=((A[T>>2]|0)+b|0)%6|0,Ie=E,A[Ie>>2]=g,A[Ie+4>>2]=y,Ie=0,Ie|0}function vv(g,y,b,T){return g=g|0,y=y|0,b=b|0,T=T|0,Gx(g,y,b,T)|0?(ro(T|0,0,b*48|0)|0,T=F4(g,y,b,T)|0,T|0):(T=0,T|0)}function Gx(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0;if(Ie=me,me=me+16|0,Ee=Ie,ke=Ie+8|0,_e=Ee,A[_e>>2]=g,A[_e+4>>2]=y,(b|0)<0)return ke=2,me=Ie,ke|0;if(!b)return ke=T,A[ke>>2]=g,A[ke+4>>2]=y,ke=0,me=Ie,ke|0;A[ke>>2]=0;e:do if(En(g,y)|0)g=9;else{E=0,_e=g;do{if(g=fo(_e,y,4,ke,Ee)|0,g|0)break e;if(y=Ee,_e=A[y>>2]|0,y=A[y+4>>2]|0,E=E+1|0,En(_e,y)|0){g=9;break e}}while((E|0)<(b|0));te=T,A[te>>2]=_e,A[te+4>>2]=y,te=b+-1|0,K=0,g=1;do{if(E=26800+(K<<2)|0,(K|0)==5)for(B=A[E>>2]|0,O=0,E=g;;){if(g=Ee,g=fo(A[g>>2]|0,A[g+4>>2]|0,B,ke,Ee)|0,g|0)break e;if((O|0)!=(te|0))if(G=Ee,N=A[G>>2]|0,G=A[G+4>>2]|0,g=T+(E<<3)|0,A[g>>2]=N,A[g+4>>2]=G,!(En(N,G)|0))g=E+1|0;else{g=9;break e}else g=E;if(O=O+1|0,(O|0)>=(b|0))break;E=g}else for(B=Ee,G=A[E>>2]|0,N=0,E=g,O=A[B>>2]|0,B=A[B+4>>2]|0;;){if(g=fo(O,B,G,ke,Ee)|0,g|0)break e;if(B=Ee,O=A[B>>2]|0,B=A[B+4>>2]|0,g=T+(E<<3)|0,A[g>>2]=O,A[g+4>>2]=B,g=E+1|0,En(O,B)|0){g=9;break e}if(N=N+1|0,(N|0)>=(b|0))break;E=g}K=K+1|0}while(K>>>0<6);g=Ee,g=(_e|0)==(A[g>>2]|0)&&(y|0)==(A[g+4>>2]|0)?0:9}while(!1);return ke=g,me=Ie,ke|0}function F4(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0;if(_e=me,me=me+16|0,B=_e,!b)return A[T>>2]=g,A[T+4>>2]=y,T=0,me=_e,T|0;do if((b|0)>=0){if((b|0)>13780509){if(E=vf(15,B)|0,E|0)break;O=B,E=A[O>>2]|0,O=A[O+4>>2]|0}else E=((b|0)<0)<<31>>31,te=Ar(b|0,E|0,3,0)|0,O=be()|0,E=Ye(b|0,E|0,1,0)|0,E=Ar(te|0,O|0,E|0,be()|0)|0,E=Ye(E|0,be()|0,1,0)|0,O=be()|0,te=B,A[te>>2]=E,A[te+4>>2]=O;if(K=ct(E,8)|0,!K)E=13;else{if(te=ct(E,4)|0,!te){Ke(K),E=13;break}if(E=Ti(g,y,b,K,te,E,O,0)|0,E|0){Ke(K),Ke(te);break}if(y=A[B>>2]|0,B=A[B+4>>2]|0,(B|0)>0|(B|0)==0&y>>>0>0){E=0,N=0,G=0;do g=K+(N<<3)|0,O=A[g>>2]|0,g=A[g+4>>2]|0,!((O|0)==0&(g|0)==0)&&(A[te+(N<<2)>>2]|0)==(b|0)&&(Ee=T+(E<<3)|0,A[Ee>>2]=O,A[Ee+4>>2]=g,E=E+1|0),N=Ye(N|0,G|0,1,0)|0,G=be()|0;while((G|0)<(B|0)|(G|0)==(B|0)&N>>>0<y>>>0)}Ke(K),Ke(te),E=0}}else E=2;while(!1);return Ee=E,me=_e,Ee|0}function bv(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0;for(N=me,me=me+16|0,O=N,B=N+8|0,E=(En(g,y)|0)==0,E=E?1:2;;){if(A[B>>2]=0,K=(fo(g,y,E,B,O)|0)==0,G=O,K&((A[G>>2]|0)==(b|0)?(A[G+4>>2]|0)==(T|0):0)){g=4;break}if(E=E+1|0,E>>>0>=7){E=7,g=4;break}}return(g|0)==4?(me=N,E|0):0}function N4(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0;if(N=me,me=me+48|0,E=N+16|0,O=N+8|0,B=N,b=bf(b)|0,b|0)return B=b,me=N,B|0;if(K=g,G=A[K+4>>2]|0,b=O,A[b>>2]=A[K>>2],A[b+4>>2]=G,id(O,E),b=xA(E,y,B)|0,!b){if(y=A[O>>2]|0,O=A[g+8>>2]|0,(O|0)>0){E=A[g+12>>2]|0,b=0;do y=(A[E+(b<<3)>>2]|0)+y|0,b=b+1|0;while((b|0)<(O|0))}b=B,E=A[b>>2]|0,b=A[b+4>>2]|0,O=((y|0)<0)<<31>>31,(b|0)<(O|0)|(b|0)==(O|0)&E>>>0<y>>>0?(b=B,A[b>>2]=y,A[b+4>>2]=O,b=O):y=E,G=Ye(y|0,b|0,12,0)|0,K=be()|0,b=B,A[b>>2]=G,A[b+4>>2]=K,b=T,A[b>>2]=G,A[b+4>>2]=K,b=0}return K=b,me=N,K|0}function xv(g,y,b,T,E,O,B){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,O=O|0,B=B|0;var N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0,Nr=0,Ai=0,Wr=0,kr=0,qt=0,Ci=0,Sn=0,yi=0,Bn=0,Fa=0,CR=0;if(Sn=me,me=me+64|0,Wr=Sn+48|0,kr=Sn+32|0,qt=Sn+24|0,Yt=Sn+8|0,Mr=Sn,G=A[g>>2]|0,(G|0)<=0)return Ci=0,me=Sn,Ci|0;for(dr=g+4|0,Qr=Wr+8|0,Nr=kr+8|0,Ai=Yt+8|0,N=0,ut=0;;){K=A[dr>>2]|0,At=K+(ut<<4)|0,A[Wr>>2]=A[At>>2],A[Wr+4>>2]=A[At+4>>2],A[Wr+8>>2]=A[At+8>>2],A[Wr+12>>2]=A[At+12>>2],(ut|0)==(G+-1|0)?(A[kr>>2]=A[K>>2],A[kr+4>>2]=A[K+4>>2],A[kr+8>>2]=A[K+8>>2],A[kr+12>>2]=A[K+12>>2]):(At=K+(ut+1<<4)|0,A[kr>>2]=A[At>>2],A[kr+4>>2]=A[At+4>>2],A[kr+8>>2]=A[At+8>>2],A[kr+12>>2]=A[At+12>>2]),G=Li(Wr,kr,T,qt)|0;e:do if(G)K=0,N=G;else if(G=qt,K=A[G>>2]|0,G=A[G+4>>2]|0,(G|0)>0|(G|0)==0&K>>>0>0){wt=0,At=0;t:for(;;){if(Bn=1/(+(K>>>0)+4294967296*+(G|0)),CR=+de[Wr>>3],G=gt(K|0,G|0,wt|0,At|0)|0,Fa=+(G>>>0)+4294967296*+(be()|0),yi=+(wt>>>0)+4294967296*+(At|0),de[Yt>>3]=Bn*(CR*Fa)+Bn*(+de[kr>>3]*yi),de[Ai>>3]=Bn*(+de[Qr>>3]*Fa)+Bn*(+de[Nr>>3]*yi),G=Tc(Yt,T,Mr)|0,G|0){N=G;break}ot=Mr,qe=A[ot>>2]|0,ot=A[ot+4>>2]|0,Ee=An(qe|0,ot|0,y|0,b|0)|0,te=be()|0,G=B+(Ee<<3)|0,_e=G,K=A[_e>>2]|0,_e=A[_e+4>>2]|0;r:do if((K|0)==0&(_e|0)==0)Xe=G,Ci=16;else for(ke=0,Ie=0;;){if((ke|0)>(b|0)|(ke|0)==(b|0)&Ie>>>0>y>>>0){N=1;break t}if((K|0)==(qe|0)&(_e|0)==(ot|0))break r;if(G=Ye(Ee|0,te|0,1,0)|0,Ee=Wi(G|0,be()|0,y|0,b|0)|0,te=be()|0,Ie=Ye(Ie|0,ke|0,1,0)|0,ke=be()|0,G=B+(Ee<<3)|0,_e=G,K=A[_e>>2]|0,_e=A[_e+4>>2]|0,(K|0)==0&(_e|0)==0){Xe=G,Ci=16;break}}while(!1);if((Ci|0)==16&&(Ci=0,!((qe|0)==0&(ot|0)==0))&&(Ie=Xe,A[Ie>>2]=qe,A[Ie+4>>2]=ot,Ie=O+(A[E>>2]<<3)|0,A[Ie>>2]=qe,A[Ie+4>>2]=ot,Ie=E,Ie=Ye(A[Ie>>2]|0,A[Ie+4>>2]|0,1,0)|0,qe=be()|0,ot=E,A[ot>>2]=Ie,A[ot+4>>2]=qe),wt=Ye(wt|0,At|0,1,0)|0,At=be()|0,G=qt,K=A[G>>2]|0,G=A[G+4>>2]|0,!((G|0)>(At|0)|(G|0)==(At|0)&K>>>0>wt>>>0)){K=1;break e}}K=0}else K=1;while(!1);if(ut=ut+1|0,!K){Ci=21;break}if(G=A[g>>2]|0,(ut|0)>=(G|0)){N=0,Ci=21;break}}return(Ci|0)==21?(me=Sn,N|0):0}function z4(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0,Nr=0,Ai=0,Wr=0,kr=0,qt=0,Ci=0,Sn=0,yi=0,Bn=0,Fa=0;if(Fa=me,me=me+112|0,Ci=Fa+80|0,G=Fa+72|0,Sn=Fa,yi=Fa+56|0,E=bf(b)|0,E|0)return Bn=E,me=Fa,Bn|0;if(K=g+8|0,Bn=et((A[K>>2]<<5)+32|0)|0,!Bn)return Bn=13,me=Fa,Bn|0;if(nd(g,Bn),E=bf(b)|0,!E){if(kr=g,qt=A[kr+4>>2]|0,E=G,A[E>>2]=A[kr>>2],A[E+4>>2]=qt,id(G,Ci),E=xA(Ci,y,Sn)|0,E)kr=0,qt=0;else{if(E=A[G>>2]|0,O=A[K>>2]|0,(O|0)>0){B=A[g+12>>2]|0,b=0;do E=(A[B+(b<<3)>>2]|0)+E|0,b=b+1|0;while((b|0)!=(O|0));b=E}else b=E;E=Sn,O=A[E>>2]|0,E=A[E+4>>2]|0,B=((b|0)<0)<<31>>31,(E|0)<(B|0)|(E|0)==(B|0)&O>>>0<b>>>0?(E=Sn,A[E>>2]=b,A[E+4>>2]=B,E=B):b=O,kr=Ye(b|0,E|0,12,0)|0,qt=be()|0,E=Sn,A[E>>2]=kr,A[E+4>>2]=qt,E=0}if(!E){if(b=ct(kr,8)|0,!b)return Ke(Bn),Bn=13,me=Fa,Bn|0;if(N=ct(kr,8)|0,!N)return Ke(Bn),Ke(b),Bn=13,me=Fa,Bn|0;Ai=Ci,A[Ai>>2]=0,A[Ai+4>>2]=0,Ai=g,Wr=A[Ai+4>>2]|0,E=G,A[E>>2]=A[Ai>>2],A[E+4>>2]=Wr,E=xv(G,kr,qt,y,Ci,b,N)|0;e:do if(E)Ke(b),Ke(N),Ke(Bn);else{t:do if((A[K>>2]|0)>0){for(B=g+12|0,O=0;E=xv((A[B>>2]|0)+(O<<3)|0,kr,qt,y,Ci,b,N)|0,O=O+1|0,!(E|0);)if((O|0)>=(A[K>>2]|0))break t;Ke(b),Ke(N),Ke(Bn);break e}while(!1);(qt|0)>0|(qt|0)==0&kr>>>0>0&&ro(N|0,0,kr<<3|0)|0,Wr=Ci,Ai=A[Wr+4>>2]|0;t:do if((Ai|0)>0|(Ai|0)==0&(A[Wr>>2]|0)>>>0>0){dr=b,Qr=N,Nr=b,Ai=N,Wr=b,E=b,Xe=b,Yt=N,Mr=N,b=N;r:for(;;){for(ot=0,wt=0,At=0,ut=0,O=0,B=0;;){N=Sn,G=N+56|0;do A[N>>2]=0,N=N+4|0;while((N|0)<(G|0));if(y=dr+(ot<<3)|0,K=A[y>>2]|0,y=A[y+4>>2]|0,_v(K,y,1,Sn,0)|0){N=Sn,G=N+56|0;do A[N>>2]=0,N=N+4|0;while((N|0)<(G|0));N=ct(7,4)|0,N|0&&(Ti(K,y,1,Sn,N,7,0,0)|0,Ke(N))}for(qe=0;;){Ie=Sn+(qe<<3)|0,ke=A[Ie>>2]|0,Ie=A[Ie+4>>2]|0;i:do if((ke|0)==0&(Ie|0)==0)N=O,G=B;else{if(te=An(ke|0,Ie|0,kr|0,qt|0)|0,K=be()|0,N=T+(te<<3)|0,y=N,G=A[y>>2]|0,y=A[y+4>>2]|0,!((G|0)==0&(y|0)==0)){_e=0,Ee=0;do{if((_e|0)>(qt|0)|(_e|0)==(qt|0)&Ee>>>0>kr>>>0)break r;if((G|0)==(ke|0)&(y|0)==(Ie|0)){N=O,G=B;break i}N=Ye(te|0,K|0,1,0)|0,te=Wi(N|0,be()|0,kr|0,qt|0)|0,K=be()|0,Ee=Ye(Ee|0,_e|0,1,0)|0,_e=be()|0,N=T+(te<<3)|0,y=N,G=A[y>>2]|0,y=A[y+4>>2]|0}while(!((G|0)==0&(y|0)==0))}if((ke|0)==0&(Ie|0)==0){N=O,G=B;break}Jh(ke,Ie,yi)|0,eh(g,Bn,yi)|0&&(Ee=Ye(O|0,B|0,1,0)|0,B=be()|0,_e=N,A[_e>>2]=ke,A[_e+4>>2]=Ie,O=Qr+(O<<3)|0,A[O>>2]=ke,A[O+4>>2]=Ie,O=Ee),N=O,G=B}while(!1);if(qe=qe+1|0,qe>>>0>=7)break;O=N,B=G}if(ot=Ye(ot|0,wt|0,1,0)|0,wt=be()|0,At=Ye(At|0,ut|0,1,0)|0,ut=be()|0,B=Ci,O=A[B>>2]|0,B=A[B+4>>2]|0,(ut|0)<(B|0)|(ut|0)==(B|0)&At>>>0<O>>>0)O=N,B=G;else break}if((B|0)>0|(B|0)==0&O>>>0>0){O=0,B=0;do ut=dr+(O<<3)|0,A[ut>>2]=0,A[ut+4>>2]=0,O=Ye(O|0,B|0,1,0)|0,B=be()|0,ut=Ci,At=A[ut+4>>2]|0;while((B|0)<(At|0)|((B|0)==(At|0)?O>>>0<(A[ut>>2]|0)>>>0:0))}if(ut=Ci,A[ut>>2]=N,A[ut+4>>2]=G,(G|0)>0|(G|0)==0&N>>>0>0)qe=b,ot=Mr,wt=Wr,At=Yt,ut=Qr,b=Xe,Mr=E,Yt=Nr,Xe=qe,E=ot,Wr=Ai,Ai=wt,Nr=At,Qr=dr,dr=ut;else break t}Ke(Nr),Ke(Ai),Ke(Bn),E=1;break e}else E=N;while(!1);Ke(Bn),Ke(b),Ke(E),E=0}while(!1);return Bn=E,me=Fa,Bn|0}}return Ke(Bn),Bn=E,me=Fa,Bn|0}function Hx(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(te=me,me=me+176|0,G=te,(y|0)<1)return Te(b,0,0),K=0,me=te,K|0;for(N=g,N=St(A[N>>2]|0,A[N+4>>2]|0,52)|0,be()|0,Te(b,(y|0)>6?y:6,N&15),N=0;T=g+(N<<3)|0,T=Ql(A[T>>2]|0,A[T+4>>2]|0,G)|0,!(T|0);){if(T=A[G>>2]|0,(T|0)>0){B=0;do O=G+8+(B<<4)|0,B=B+1|0,T=G+8+(((B|0)%(T|0)|0)<<4)|0,E=Oe(b,T,O)|0,E?De(b,E)|0:Ve(b,O,T)|0,T=A[G>>2]|0;while((B|0)<(T|0))}if(N=N+1|0,(N|0)>=(y|0)){T=0,K=13;break}}return(K|0)==13?(me=te,T|0):(Me(b),K=T,me=te,K|0)}function gA(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0;if(O=me,me=me+32|0,T=O,E=O+16|0,g=Hx(g,y,E)|0,g|0)return b=g,me=O,b|0;if(A[b>>2]=0,A[b+4>>2]=0,A[b+8>>2]=0,g=Ce(E)|0,g|0)do{y=Lr(b)|0;do $p(y,g)|0,B=g+16|0,A[T>>2]=A[B>>2],A[T+4>>2]=A[B+4>>2],A[T+8>>2]=A[B+8>>2],A[T+12>>2]=A[B+12>>2],De(E,g)|0,g=je(E,T)|0;while((g|0)!=0);g=Ce(E)|0}while((g|0)!=0);return Me(E),g=wm(b)|0,g?($A(b),B=g,me=O,B|0):(B=0,me=O,B|0)}function In(g){return g=g|0,g>>>0>121?(g=0,g|0):(g=A[7696+(g*28|0)+16>>2]|0,g|0)}function Ep(g){return g=g|0,(g|0)==4|(g|0)==117|0}function AA(g){return g=g|0,A[11120+((A[g>>2]|0)*216|0)+((A[g+4>>2]|0)*72|0)+((A[g+8>>2]|0)*24|0)+(A[g+12>>2]<<3)>>2]|0}function df(g){return g=g|0,A[11120+((A[g>>2]|0)*216|0)+((A[g+4>>2]|0)*72|0)+((A[g+8>>2]|0)*24|0)+(A[g+12>>2]<<3)+4>>2]|0}function fm(g,y){g=g|0,y=y|0,g=7696+(g*28|0)|0,A[y>>2]=A[g>>2],A[y+4>>2]=A[g+4>>2],A[y+8>>2]=A[g+8>>2],A[y+12>>2]=A[g+12>>2]}function Cp(g,y){g=g|0,y=y|0;var b=0,T=0;if(y>>>0>20)return y=-1,y|0;do if((A[11120+(y*216|0)>>2]|0)!=(g|0))if((A[11120+(y*216|0)+8>>2]|0)!=(g|0))if((A[11120+(y*216|0)+16>>2]|0)!=(g|0))if((A[11120+(y*216|0)+24>>2]|0)!=(g|0))if((A[11120+(y*216|0)+32>>2]|0)!=(g|0))if((A[11120+(y*216|0)+40>>2]|0)!=(g|0))if((A[11120+(y*216|0)+48>>2]|0)!=(g|0))if((A[11120+(y*216|0)+56>>2]|0)!=(g|0))if((A[11120+(y*216|0)+64>>2]|0)!=(g|0))if((A[11120+(y*216|0)+72>>2]|0)!=(g|0))if((A[11120+(y*216|0)+80>>2]|0)!=(g|0))if((A[11120+(y*216|0)+88>>2]|0)!=(g|0))if((A[11120+(y*216|0)+96>>2]|0)!=(g|0))if((A[11120+(y*216|0)+104>>2]|0)!=(g|0))if((A[11120+(y*216|0)+112>>2]|0)!=(g|0))if((A[11120+(y*216|0)+120>>2]|0)!=(g|0))if((A[11120+(y*216|0)+128>>2]|0)!=(g|0))if((A[11120+(y*216|0)+136>>2]|0)==(g|0))g=2,b=1,T=2;else{if((A[11120+(y*216|0)+144>>2]|0)==(g|0)){g=0,b=2,T=0;break}if((A[11120+(y*216|0)+152>>2]|0)==(g|0)){g=0,b=2,T=1;break}if((A[11120+(y*216|0)+160>>2]|0)==(g|0)){g=0,b=2,T=2;break}if((A[11120+(y*216|0)+168>>2]|0)==(g|0)){g=1,b=2,T=0;break}if((A[11120+(y*216|0)+176>>2]|0)==(g|0)){g=1,b=2,T=1;break}if((A[11120+(y*216|0)+184>>2]|0)==(g|0)){g=1,b=2,T=2;break}if((A[11120+(y*216|0)+192>>2]|0)==(g|0)){g=2,b=2,T=0;break}if((A[11120+(y*216|0)+200>>2]|0)==(g|0)){g=2,b=2,T=1;break}if((A[11120+(y*216|0)+208>>2]|0)==(g|0)){g=2,b=2,T=2;break}else g=-1;return g|0}else g=2,b=1,T=1;else g=2,b=1,T=0;else g=1,b=1,T=2;else g=1,b=1,T=1;else g=1,b=1,T=0;else g=0,b=1,T=2;else g=0,b=1,T=1;else g=0,b=1,T=0;else g=2,b=0,T=2;else g=2,b=0,T=1;else g=2,b=0,T=0;else g=1,b=0,T=2;else g=1,b=0,T=1;else g=1,b=0,T=0;else g=0,b=0,T=2;else g=0,b=0,T=1;else g=0,b=0,T=0;while(!1);return y=A[11120+(y*216|0)+(b*72|0)+(g*24|0)+(T<<3)+4>>2]|0,y|0}function xl(g,y){return g=g|0,y=y|0,(A[7696+(g*28|0)+20>>2]|0)==(y|0)?(y=1,y|0):(y=(A[7696+(g*28|0)+24>>2]|0)==(y|0),y|0)}function yA(g,y){return g=g|0,y=y|0,A[848+(g*28|0)+(y<<2)>>2]|0}function _A(g,y){return g=g|0,y=y|0,(A[848+(g*28|0)>>2]|0)==(y|0)?(y=0,y|0):(A[848+(g*28|0)+4>>2]|0)==(y|0)?(y=1,y|0):(A[848+(g*28|0)+8>>2]|0)==(y|0)?(y=2,y|0):(A[848+(g*28|0)+12>>2]|0)==(y|0)?(y=3,y|0):(A[848+(g*28|0)+16>>2]|0)==(y|0)?(y=4,y|0):(A[848+(g*28|0)+20>>2]|0)==(y|0)?(y=5,y|0):((A[848+(g*28|0)+24>>2]|0)==(y|0)?6:7)|0}function wv(){return 122}function ff(g){g=g|0;var y=0,b=0,T=0;y=0;do Dt(y|0,0,45)|0,T=be()|0|134225919,b=g+(y<<3)|0,A[b>>2]=-1,A[b+4>>2]=T,y=y+1|0;while((y|0)!=122);return 0}function vA(g){g=g|0;var y=0,b=0,T=0;return T=+de[g+16>>3],b=+de[g+24>>3],y=T-b,+(T<b?y+6.283185307179586:y)}function pm(g){return g=g|0,+de[g+16>>3]<+de[g+24>>3]|0}function mm(g){return g=g|0,+(+de[g>>3]-+de[g+8>>3])}function Pp(g,y){g=g|0,y=y|0;var b=0,T=0,E=0;return b=+de[y>>3],!(b>=+de[g+8>>3])||!(b<=+de[g>>3])?(y=0,y|0):(T=+de[g+16>>3],b=+de[g+24>>3],E=+de[y+8>>3],y=E>=b,g=E<=T&1,T<b?y&&(g=1):y||(g=0),y=(g|0)!=0,y|0)}function bA(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;return+de[g>>3]<+de[y+8>>3]||+de[g+8>>3]>+de[y>>3]?(T=0,T|0):(O=+de[g+16>>3],b=g+24|0,te=+de[b>>3],B=O<te,T=y+16|0,K=+de[T>>3],E=y+24|0,G=+de[E>>3],N=K<G,y=te-K<G-O,g=B?N|y?1:2:0,y=N?B?1:y?2:1:0,O=+ha(O,g),O<+ha(+de[E>>3],y)||(te=+ha(+de[b>>3],g),te>+ha(+de[T>>3],y))?(N=0,N|0):(N=1,N|0))}function Ip(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0;O=+de[g+16>>3],G=+de[g+24>>3],g=O<G,N=+de[y+16>>3],B=+de[y+24>>3],E=N<B,y=G-N<B-O,A[b>>2]=g?E|y?1:2:0,A[T>>2]=E?g?1:y?2:1:0}function pf(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;return+de[g>>3]<+de[y>>3]||+de[g+8>>3]>+de[y+8>>3]?(T=0,T|0):(T=g+16|0,G=+de[T>>3],O=+de[g+24>>3],B=G<O,b=y+16|0,te=+de[b>>3],E=y+24|0,K=+de[E>>3],N=te<K,y=O-te<K-G,g=B?N|y?1:2:0,y=N?B?1:y?2:1:0,O=+ha(O,g),O<=+ha(+de[E>>3],y)?(te=+ha(+de[T>>3],g),N=te>=+ha(+de[b>>3],y),N|0):(N=0,N|0))}function Sv(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0;E=me,me=me+176|0,T=E,A[T>>2]=4,N=+de[y>>3],de[T+8>>3]=N,O=+de[y+16>>3],de[T+16>>3]=O,de[T+24>>3]=N,N=+de[y+24>>3],de[T+32>>3]=N,B=+de[y+8>>3],de[T+40>>3]=B,de[T+48>>3]=N,de[T+56>>3]=B,de[T+64>>3]=O,y=T+72|0,b=y+96|0;do A[y>>2]=0,y=y+4|0;while((y|0)<(b|0));Gn(g|0,T|0,168)|0,me=E}function xA(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0;Ie=me,me=me+288|0,te=Ie+264|0,_e=Ie+96|0,K=Ie,N=K,G=N+96|0;do A[N>>2]=0,N=N+4|0;while((N|0)<(G|0));return y=vm(y,K)|0,y|0?(ke=y,me=Ie,ke|0):(G=K,K=A[G>>2]|0,G=A[G+4>>2]|0,Jh(K,G,te)|0,Ql(K,G,_e)|0,B=+Vp(te,_e+8|0),de[te>>3]=+de[g>>3],G=te+8|0,de[G>>3]=+de[g+16>>3],de[_e>>3]=+de[g+8>>3],K=_e+8|0,de[K>>3]=+de[g+24>>3],E=+Vp(te,_e),ot=+de[G>>3]-+de[K>>3],O=+qi(+ot),qe=+de[te>>3]-+de[_e>>3],T=+qi(+qe),!(ot==0|qe==0)&&(ot=+eo(+O,+T),ot=+hf(+(E*E/+$o(+(ot/+$o(+O,+T)),3)/(B*(B*2.59807621135)*.8))),de[Ms>>3]=ot,Ee=~~ot>>>0,ke=+qi(ot)>=1?ot>0?~~+dA(+So(ot/4294967296),4294967295)>>>0:~~+hf((ot-+(~~ot>>>0))/4294967296)>>>0:0,(A[Ms+4>>2]&2146435072|0)!=2146435072)?(_e=(Ee|0)==0&(ke|0)==0,y=b,A[y>>2]=_e?1:Ee,A[y+4>>2]=_e?0:ke,y=0):y=1,ke=y,me=Ie,ke|0)}function Li(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0;K=me,me=me+288|0,B=K+264|0,N=K+96|0,G=K,E=G,O=E+96|0;do A[E>>2]=0,E=E+4|0;while((E|0)<(O|0));return b=vm(b,G)|0,b|0?(T=b,me=K,T|0):(b=G,E=A[b>>2]|0,b=A[b+4>>2]|0,Jh(E,b,B)|0,Ql(E,b,N)|0,te=+Vp(B,N+8|0),te=+hf(+(+Vp(g,y)/(te*2))),de[Ms>>3]=te,b=~~te>>>0,E=+qi(te)>=1?te>0?~~+dA(+So(te/4294967296),4294967295)>>>0:~~+hf((te-+(~~te>>>0))/4294967296)>>>0:0,(A[Ms+4>>2]&2146435072|0)==2146435072?(T=1,me=K,T|0):(G=(b|0)==0&(E|0)==0,A[T>>2]=G?1:b,A[T+4>>2]=G?0:E,T=0,me=K,T|0))}function kp(g,y){g=g|0,y=+y;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;O=g+16|0,B=+de[O>>3],b=g+24|0,E=+de[b>>3],T=B-E,T=B<E?T+6.283185307179586:T,K=+de[g>>3],N=g+8|0,G=+de[N>>3],te=K-G,T=(T*y-T)*.5,y=(te*y-te)*.5,K=K+y,de[g>>3]=K>1.5707963267948966?1.5707963267948966:K,y=G-y,de[N>>3]=y<-1.5707963267948966?-1.5707963267948966:y,y=B+T,y=y>3.141592653589793?y+-6.283185307179586:y,de[O>>3]=y<-3.141592653589793?y+6.283185307179586:y,y=E-T,y=y>3.141592653589793?y+-6.283185307179586:y,de[b>>3]=y<-3.141592653589793?y+6.283185307179586:y}function U4(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0,A[g>>2]=y,A[g+4>>2]=b,A[g+8>>2]=T}function qx(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0;_e=y+8|0,A[_e>>2]=0,G=+de[g>>3],B=+qi(+G),K=+de[g+8>>3],N=+qi(+K)*1.1547005383792515,B=B+N*.5,b=~~B,g=~~N,B=B-+(b|0),N=N-+(g|0);do if(B<.5)if(B<.3333333333333333)if(A[y>>2]=b,N<(B+1)*.5){A[y+4>>2]=g;break}else{g=g+1|0,A[y+4>>2]=g;break}else if(Ee=1-B,g=(!(N<Ee)&1)+g|0,A[y+4>>2]=g,Ee<=N&N<B*2){b=b+1|0,A[y>>2]=b;break}else{A[y>>2]=b;break}else{if(!(B<.6666666666666666))if(b=b+1|0,A[y>>2]=b,N<B*.5){A[y+4>>2]=g;break}else{g=g+1|0,A[y+4>>2]=g;break}if(N<1-B){if(A[y+4>>2]=g,B*2+-1<N){A[y>>2]=b;break}}else g=g+1|0,A[y+4>>2]=g;b=b+1|0,A[y>>2]=b}while(!1);do if(G<0)if(g&1){te=(g+1|0)/2|0,te=gt(b|0,((b|0)<0)<<31>>31|0,te|0,((te|0)<0)<<31>>31|0)|0,b=~~(+(b|0)-((+(te>>>0)+4294967296*+(be()|0))*2+1)),A[y>>2]=b;break}else{te=(g|0)/2|0,te=gt(b|0,((b|0)<0)<<31>>31|0,te|0,((te|0)<0)<<31>>31|0)|0,b=~~(+(b|0)-(+(te>>>0)+4294967296*+(be()|0))*2),A[y>>2]=b;break}while(!1);te=y+4|0,K<0&&(b=b-((g<<1|1|0)/2|0)|0,A[y>>2]=b,g=0-g|0,A[te>>2]=g),T=g-b|0,(b|0)<0?(E=0-b|0,A[te>>2]=T,A[_e>>2]=E,A[y>>2]=0,g=T,b=0):E=0,(g|0)<0&&(b=b-g|0,A[y>>2]=b,E=E-g|0,A[_e>>2]=E,A[te>>2]=0,g=0),O=b-E|0,T=g-E|0,(E|0)<0&&(A[y>>2]=O,A[te>>2]=T,A[_e>>2]=0,g=T,b=O,E=0),T=(g|0)<(b|0)?g:b,T=(E|0)<(T|0)?E:T,!((T|0)<=0)&&(A[y>>2]=b-T,A[te>>2]=g-T,A[_e>>2]=E-T)}function es(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0;y=A[g>>2]|0,B=g+4|0,b=A[B>>2]|0,(y|0)<0&&(b=b-y|0,A[B>>2]=b,O=g+8|0,A[O>>2]=(A[O>>2]|0)-y,A[g>>2]=0,y=0),(b|0)<0?(y=y-b|0,A[g>>2]=y,O=g+8|0,E=(A[O>>2]|0)-b|0,A[O>>2]=E,A[B>>2]=0,b=0):(E=g+8|0,O=E,E=A[E>>2]|0),(E|0)<0&&(y=y-E|0,A[g>>2]=y,b=b-E|0,A[B>>2]=b,A[O>>2]=0,E=0),T=(b|0)<(y|0)?b:y,T=(E|0)<(T|0)?E:T,!((T|0)<=0)&&(A[g>>2]=y-T,A[B>>2]=b-T,A[O>>2]=E-T)}function qh(g,y){g=g|0,y=y|0;var b=0,T=0;T=A[g+8>>2]|0,b=+((A[g+4>>2]|0)-T|0),de[y>>3]=+((A[g>>2]|0)-T|0)-b*.5,de[y+8>>3]=b*.8660254037844386}function La(g,y,b){g=g|0,y=y|0,b=b|0,A[b>>2]=(A[y>>2]|0)+(A[g>>2]|0),A[b+4>>2]=(A[y+4>>2]|0)+(A[g+4>>2]|0),A[b+8>>2]=(A[y+8>>2]|0)+(A[g+8>>2]|0)}function wA(g,y,b){g=g|0,y=y|0,b=b|0,A[b>>2]=(A[g>>2]|0)-(A[y>>2]|0),A[b+4>>2]=(A[g+4>>2]|0)-(A[y+4>>2]|0),A[b+8>>2]=(A[g+8>>2]|0)-(A[y+8>>2]|0)}function gm(g,y){g=g|0,y=y|0;var b=0,T=0;b=wc(A[g>>2]|0,y)|0,A[g>>2]=b,b=g+4|0,T=wc(A[b>>2]|0,y)|0,A[b>>2]=T,g=g+8|0,y=wc(A[g>>2]|0,y)|0,A[g>>2]=y}function mf(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;B=A[g>>2]|0,N=(B|0)<0,T=(A[g+4>>2]|0)-(N?B:0)|0,O=(T|0)<0,E=(O?0-T|0:0)+((A[g+8>>2]|0)-(N?B:0))|0,b=(E|0)<0,g=b?0:E,y=(O?0:T)-(b?E:0)|0,E=(N?0:B)-(O?T:0)-(b?E:0)|0,b=(y|0)<(E|0)?y:E,b=(g|0)<(b|0)?g:b,T=(b|0)>0,g=g-(T?b:0)|0,y=y-(T?b:0)|0;e:do switch(E-(T?b:0)|0){case 0:switch(y|0){case 0:return N=(g|0)==0?0:(g|0)==1?1:7,N|0;case 1:return N=(g|0)==0?2:(g|0)==1?3:7,N|0;default:break e}case 1:switch(y|0){case 0:return N=(g|0)==0?4:(g|0)==1?5:7,N|0;case 1:{if(!g)g=6;else break e;return g|0}default:break e}default:}while(!1);return N=7,N|0}function SA(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0;if(G=g+8|0,B=A[G>>2]|0,N=(A[g>>2]|0)-B|0,K=g+4|0,B=(A[K>>2]|0)-B|0,N>>>0>715827881|B>>>0>715827881){if(T=(N|0)>0,E=2147483647-N|0,O=-2147483648-N|0,(T?(E|0)<(N|0):(O|0)>(N|0))||(b=N<<1,T?(2147483647-b|0)<(N|0):(-2147483648-b|0)>(N|0))||((B|0)>0?(2147483647-B|0)<(B|0):(-2147483648-B|0)>(B|0))||(y=N*3|0,b=B<<1,(T?(E|0)<(b|0):(O|0)>(b|0))||((N|0)>-1?(y|-2147483648|0)>=(B|0):(y^-2147483648|0)<(B|0))))return K=1,K|0}else b=B<<1,y=N*3|0;return T=Be(+(y-B|0)*.14285714285714285)|0,A[g>>2]=T,E=Be(+(b+N|0)*.14285714285714285)|0,A[K>>2]=E,A[G>>2]=0,b=(E|0)<(T|0),y=b?T:E,b=b?E:T,(b|0)<0&&(((b|0)==-2147483648||((y|0)>0?(2147483647-y|0)<(b|0):(-2147483648-y|0)>(b|0)))&&Ur(27795,26892,354,26903),((y|0)>-1?(y|-2147483648|0)>=(b|0):(y^-2147483648|0)<(b|0))&&Ur(27795,26892,354,26903)),y=E-T|0,(T|0)<0?(b=0-T|0,A[K>>2]=y,A[G>>2]=b,A[g>>2]=0,T=0):(y=E,b=0),(y|0)<0&&(T=T-y|0,A[g>>2]=T,b=b-y|0,A[G>>2]=b,A[K>>2]=0,y=0),O=T-b|0,E=y-b|0,(b|0)<0?(A[g>>2]=O,A[K>>2]=E,A[G>>2]=0,y=E,E=O,b=0):E=T,T=(y|0)<(E|0)?y:E,T=(b|0)<(T|0)?b:T,(T|0)<=0?(K=0,K|0):(A[g>>2]=E-T,A[K>>2]=y-T,A[G>>2]=b-T,K=0,K|0)}function TA(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0;if(B=g+8|0,E=A[B>>2]|0,O=(A[g>>2]|0)-E|0,N=g+4|0,E=(A[N>>2]|0)-E|0,O>>>0>715827881|E>>>0>715827881){if(b=(O|0)>0,(b?(2147483647-O|0)<(O|0):(-2147483648-O|0)>(O|0))||(y=O<<1,T=(E|0)>0,T?(2147483647-E|0)<(E|0):(-2147483648-E|0)>(E|0)))return N=1,N|0;if(G=E<<1,(T?(2147483647-G|0)<(E|0):(-2147483648-G|0)>(E|0))||(b?(2147483647-y|0)<(E|0):(-2147483648-y|0)>(E|0))||(b=E*3|0,(E|0)>-1?(b|-2147483648|0)>=(O|0):(b^-2147483648|0)<(O|0)))return G=1,G|0}else b=E*3|0,y=O<<1;return T=Be(+(y+E|0)*.14285714285714285)|0,A[g>>2]=T,E=Be(+(b-O|0)*.14285714285714285)|0,A[N>>2]=E,A[B>>2]=0,b=(E|0)<(T|0),y=b?T:E,b=b?E:T,(b|0)<0&&(((b|0)==-2147483648||((y|0)>0?(2147483647-y|0)<(b|0):(-2147483648-y|0)>(b|0)))&&Ur(27795,26892,402,26917),((y|0)>-1?(y|-2147483648|0)>=(b|0):(y^-2147483648|0)<(b|0))&&Ur(27795,26892,402,26917)),y=E-T|0,(T|0)<0?(b=0-T|0,A[N>>2]=y,A[B>>2]=b,A[g>>2]=0,T=0):(y=E,b=0),(y|0)<0&&(T=T-y|0,A[g>>2]=T,b=b-y|0,A[B>>2]=b,A[N>>2]=0,y=0),O=T-b|0,E=y-b|0,(b|0)<0?(A[g>>2]=O,A[N>>2]=E,A[B>>2]=0,y=E,E=O,b=0):E=T,T=(y|0)<(E|0)?y:E,T=(b|0)<(T|0)?b:T,(T|0)<=0?(G=0,G|0):(A[g>>2]=E-T,A[N>>2]=y-T,A[B>>2]=b-T,G=0,G|0)}function MA(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;B=g+8|0,b=A[B>>2]|0,y=(A[g>>2]|0)-b|0,N=g+4|0,b=(A[N>>2]|0)-b|0,T=Be(+((y*3|0)-b|0)*.14285714285714285)|0,A[g>>2]=T,y=Be(+((b<<1)+y|0)*.14285714285714285)|0,A[N>>2]=y,A[B>>2]=0,b=y-T|0,(T|0)<0?(O=0-T|0,A[N>>2]=b,A[B>>2]=O,A[g>>2]=0,y=b,T=0,b=O):b=0,(y|0)<0&&(T=T-y|0,A[g>>2]=T,b=b-y|0,A[B>>2]=b,A[N>>2]=0,y=0),O=T-b|0,E=y-b|0,(b|0)<0?(A[g>>2]=O,A[N>>2]=E,A[B>>2]=0,y=E,E=O,b=0):E=T,T=(y|0)<(E|0)?y:E,T=(b|0)<(T|0)?b:T,!((T|0)<=0)&&(A[g>>2]=E-T,A[N>>2]=y-T,A[B>>2]=b-T)}function EA(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;B=g+8|0,b=A[B>>2]|0,y=(A[g>>2]|0)-b|0,N=g+4|0,b=(A[N>>2]|0)-b|0,T=Be(+((y<<1)+b|0)*.14285714285714285)|0,A[g>>2]=T,y=Be(+((b*3|0)-y|0)*.14285714285714285)|0,A[N>>2]=y,A[B>>2]=0,b=y-T|0,(T|0)<0?(O=0-T|0,A[N>>2]=b,A[B>>2]=O,A[g>>2]=0,y=b,T=0,b=O):b=0,(y|0)<0&&(T=T-y|0,A[g>>2]=T,b=b-y|0,A[B>>2]=b,A[N>>2]=0,y=0),O=T-b|0,E=y-b|0,(b|0)<0?(A[g>>2]=O,A[N>>2]=E,A[B>>2]=0,y=E,E=O,b=0):E=T,T=(y|0)<(E|0)?y:E,T=(b|0)<(T|0)?b:T,!((T|0)<=0)&&(A[g>>2]=E-T,A[N>>2]=y-T,A[B>>2]=b-T)}function Am(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;y=A[g>>2]|0,B=g+4|0,b=A[B>>2]|0,N=g+8|0,T=A[N>>2]|0,E=b+(y*3|0)|0,A[g>>2]=E,b=T+(b*3|0)|0,A[B>>2]=b,y=(T*3|0)+y|0,A[N>>2]=y,T=b-E|0,(E|0)<0?(y=y-E|0,A[B>>2]=T,A[N>>2]=y,A[g>>2]=0,b=T,T=0):T=E,(b|0)<0&&(T=T-b|0,A[g>>2]=T,y=y-b|0,A[N>>2]=y,A[B>>2]=0,b=0),O=T-y|0,E=b-y|0,(y|0)<0?(A[g>>2]=O,A[B>>2]=E,A[N>>2]=0,T=O,y=0):E=b,b=(E|0)<(T|0)?E:T,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=T-b,A[B>>2]=E-b,A[N>>2]=y-b)}function Sc(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;E=A[g>>2]|0,B=g+4|0,y=A[B>>2]|0,N=g+8|0,b=A[N>>2]|0,T=(y*3|0)+E|0,E=b+(E*3|0)|0,A[g>>2]=E,A[B>>2]=T,y=(b*3|0)+y|0,A[N>>2]=y,b=T-E|0,(E|0)<0?(y=y-E|0,A[B>>2]=b,A[N>>2]=y,A[g>>2]=0,E=0):b=T,(b|0)<0&&(E=E-b|0,A[g>>2]=E,y=y-b|0,A[N>>2]=y,A[B>>2]=0,b=0),O=E-y|0,T=b-y|0,(y|0)<0?(A[g>>2]=O,A[B>>2]=T,A[N>>2]=0,E=O,y=0):T=b,b=(T|0)<(E|0)?T:E,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=E-b,A[B>>2]=T-b,A[N>>2]=y-b)}function Rp(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0;(y+-1|0)>>>0>=6||(E=(A[15440+(y*12|0)>>2]|0)+(A[g>>2]|0)|0,A[g>>2]=E,N=g+4|0,T=(A[15440+(y*12|0)+4>>2]|0)+(A[N>>2]|0)|0,A[N>>2]=T,B=g+8|0,y=(A[15440+(y*12|0)+8>>2]|0)+(A[B>>2]|0)|0,A[B>>2]=y,b=T-E|0,(E|0)<0?(y=y-E|0,A[N>>2]=b,A[B>>2]=y,A[g>>2]=0,T=0):(b=T,T=E),(b|0)<0&&(T=T-b|0,A[g>>2]=T,y=y-b|0,A[B>>2]=y,A[N>>2]=0,b=0),O=T-y|0,E=b-y|0,(y|0)<0?(A[g>>2]=O,A[N>>2]=E,A[B>>2]=0,T=O,y=0):E=b,b=(E|0)<(T|0)?E:T,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=T-b,A[N>>2]=E-b,A[B>>2]=y-b))}function ym(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;E=A[g>>2]|0,B=g+4|0,y=A[B>>2]|0,N=g+8|0,b=A[N>>2]|0,T=y+E|0,E=b+E|0,A[g>>2]=E,A[B>>2]=T,y=b+y|0,A[N>>2]=y,b=T-E|0,(E|0)<0?(y=y-E|0,A[B>>2]=b,A[N>>2]=y,A[g>>2]=0,T=0):(b=T,T=E),(b|0)<0&&(T=T-b|0,A[g>>2]=T,y=y-b|0,A[N>>2]=y,A[B>>2]=0,b=0),O=T-y|0,E=b-y|0,(y|0)<0?(A[g>>2]=O,A[B>>2]=E,A[N>>2]=0,T=O,y=0):E=b,b=(E|0)<(T|0)?E:T,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=T-b,A[B>>2]=E-b,A[N>>2]=y-b)}function Zu(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;y=A[g>>2]|0,B=g+4|0,T=A[B>>2]|0,N=g+8|0,b=A[N>>2]|0,E=T+y|0,A[g>>2]=E,T=b+T|0,A[B>>2]=T,y=b+y|0,A[N>>2]=y,b=T-E|0,(E|0)<0?(y=y-E|0,A[B>>2]=b,A[N>>2]=y,A[g>>2]=0,T=0):(b=T,T=E),(b|0)<0&&(T=T-b|0,A[g>>2]=T,y=y-b|0,A[N>>2]=y,A[B>>2]=0,b=0),O=T-y|0,E=b-y|0,(y|0)<0?(A[g>>2]=O,A[B>>2]=E,A[N>>2]=0,T=O,y=0):E=b,b=(E|0)<(T|0)?E:T,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=T-b,A[B>>2]=E-b,A[N>>2]=y-b)}function au(g){switch(g=g|0,g|0){case 1:{g=5;break}case 5:{g=4;break}case 4:{g=6;break}case 6:{g=2;break}case 2:{g=3;break}case 3:{g=1;break}default:}return g|0}function Ku(g){switch(g=g|0,g|0){case 1:{g=3;break}case 3:{g=2;break}case 2:{g=6;break}case 6:{g=4;break}case 4:{g=5;break}case 5:{g=1;break}default:}return g|0}function gf(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;y=A[g>>2]|0,B=g+4|0,b=A[B>>2]|0,N=g+8|0,T=A[N>>2]|0,E=b+(y<<1)|0,A[g>>2]=E,b=T+(b<<1)|0,A[B>>2]=b,y=(T<<1)+y|0,A[N>>2]=y,T=b-E|0,(E|0)<0?(y=y-E|0,A[B>>2]=T,A[N>>2]=y,A[g>>2]=0,b=T,T=0):T=E,(b|0)<0&&(T=T-b|0,A[g>>2]=T,y=y-b|0,A[N>>2]=y,A[B>>2]=0,b=0),O=T-y|0,E=b-y|0,(y|0)<0?(A[g>>2]=O,A[B>>2]=E,A[N>>2]=0,T=O,y=0):E=b,b=(E|0)<(T|0)?E:T,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=T-b,A[B>>2]=E-b,A[N>>2]=y-b)}function Yx(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;E=A[g>>2]|0,B=g+4|0,y=A[B>>2]|0,N=g+8|0,b=A[N>>2]|0,T=(y<<1)+E|0,E=b+(E<<1)|0,A[g>>2]=E,A[B>>2]=T,y=(b<<1)+y|0,A[N>>2]=y,b=T-E|0,(E|0)<0?(y=y-E|0,A[B>>2]=b,A[N>>2]=y,A[g>>2]=0,E=0):b=T,(b|0)<0&&(E=E-b|0,A[g>>2]=E,y=y-b|0,A[N>>2]=y,A[B>>2]=0,b=0),O=E-y|0,T=b-y|0,(y|0)<0?(A[g>>2]=O,A[B>>2]=T,A[N>>2]=0,E=O,y=0):T=b,b=(T|0)<(E|0)?T:E,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(A[g>>2]=E-b,A[B>>2]=T-b,A[N>>2]=y-b)}function CA(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0;return B=(A[g>>2]|0)-(A[y>>2]|0)|0,N=(B|0)<0,T=(A[g+4>>2]|0)-(A[y+4>>2]|0)-(N?B:0)|0,O=(T|0)<0,E=(N?0-B|0:0)+(A[g+8>>2]|0)-(A[y+8>>2]|0)+(O?0-T|0:0)|0,g=(E|0)<0,y=g?0:E,b=(O?0:T)-(g?E:0)|0,E=(N?0:B)-(O?T:0)-(g?E:0)|0,g=(b|0)<(E|0)?b:E,g=(y|0)<(g|0)?y:g,T=(g|0)>0,y=y-(T?g:0)|0,b=b-(T?g:0)|0,g=E-(T?g:0)|0,g=(g|0)>-1?g:0-g|0,b=(b|0)>-1?b:0-b|0,y=(y|0)>-1?y:0-y|0,y=(b|0)>(y|0)?b:y,((g|0)>(y|0)?g:y)|0}function PA(g,y){g=g|0,y=y|0;var b=0;b=A[g+8>>2]|0,A[y>>2]=(A[g>>2]|0)-b,A[y+4>>2]=(A[g+4>>2]|0)-b}function Tv(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0;return T=A[g>>2]|0,A[y>>2]=T,E=A[g+4>>2]|0,B=y+4|0,A[B>>2]=E,N=y+8|0,A[N>>2]=0,b=(E|0)<(T|0),g=b?T:E,b=b?E:T,(b|0)<0&&((b|0)==-2147483648||((g|0)>0?(2147483647-g|0)<(b|0):(-2147483648-g|0)>(b|0))||((g|0)>-1?(g|-2147483648|0)>=(b|0):(g^-2147483648|0)<(b|0)))?(y=1,y|0):(g=E-T|0,(T|0)<0?(b=0-T|0,A[B>>2]=g,A[N>>2]=b,A[y>>2]=0,T=0):(g=E,b=0),(g|0)<0&&(T=T-g|0,A[y>>2]=T,b=b-g|0,A[N>>2]=b,A[B>>2]=0,g=0),O=T-b|0,E=g-b|0,(b|0)<0?(A[y>>2]=O,A[B>>2]=E,A[N>>2]=0,g=E,E=O,b=0):E=T,T=(g|0)<(E|0)?g:E,T=(b|0)<(T|0)?b:T,(T|0)<=0?(y=0,y|0):(A[y>>2]=E-T,A[B>>2]=g-T,A[N>>2]=b-T,y=0,y|0))}function IA(g){g=g|0;var y=0,b=0,T=0,E=0;y=g+8|0,E=A[y>>2]|0,b=E-(A[g>>2]|0)|0,A[g>>2]=b,T=g+4|0,g=(A[T>>2]|0)-E|0,A[T>>2]=g,A[y>>2]=0-(g+b)}function Mv(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;b=A[g>>2]|0,y=0-b|0,A[g>>2]=y,B=g+8|0,A[B>>2]=0,N=g+4|0,T=A[N>>2]|0,E=T+b|0,(b|0)>0?(A[N>>2]=E,A[B>>2]=b,A[g>>2]=0,y=0,T=E):b=0,(T|0)<0?(O=y-T|0,A[g>>2]=O,b=b-T|0,A[B>>2]=b,A[N>>2]=0,E=O-b|0,y=0-b|0,(b|0)<0?(A[g>>2]=E,A[N>>2]=y,A[B>>2]=0,T=y,b=0):(T=0,E=O)):E=y,y=(T|0)<(E|0)?T:E,y=(b|0)<(y|0)?b:y,!((y|0)<=0)&&(A[g>>2]=E-y,A[N>>2]=T-y,A[B>>2]=b-y)}function Op(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0;if(_e=me,me=me+64|0,te=_e,N=_e+56|0,!(!0&(y&2013265920|0)==134217728&(!0&(T&2013265920|0)==134217728)))return E=5,me=_e,E|0;if((g|0)==(b|0)&(y|0)==(T|0))return A[E>>2]=0,E=0,me=_e,E|0;if(B=St(g|0,y|0,52)|0,be()|0,B=B&15,K=St(b|0,T|0,52)|0,be()|0,(B|0)!=(K&15|0))return E=12,me=_e,E|0;if(O=B+-1|0,B>>>0>1){FA(g,y,O,te)|0,FA(b,T,O,N)|0,K=te,G=A[K>>2]|0,K=A[K+4>>2]|0;e:do if((G|0)==(A[N>>2]|0)&&(K|0)==(A[N+4>>2]|0)){B=(B^15)*3|0,O=St(g|0,y|0,B|0)|0,be()|0,O=O&7,B=St(b|0,T|0,B|0)|0,be()|0,B=B&7;do if((O|0)==0|(B|0)==0)A[E>>2]=1,O=0;else if((O|0)==7)O=5;else{if((O|0)==1|(B|0)==1&&En(G,K)|0){O=5;break}if((A[15536+(O<<2)>>2]|0)!=(B|0)&&(A[15568+(O<<2)>>2]|0)!=(B|0))break e;A[E>>2]=1,O=0}while(!1);return E=O,me=_e,E|0}while(!1)}O=te,B=O+56|0;do A[O>>2]=0,O=O+4|0;while((O|0)<(B|0));return pA(g,y,1,te)|0,y=te,!((A[y>>2]|0)==(b|0)&&(A[y+4>>2]|0)==(T|0))&&(y=te+8|0,!((A[y>>2]|0)==(b|0)&&(A[y+4>>2]|0)==(T|0)))&&(y=te+16|0,!((A[y>>2]|0)==(b|0)&&(A[y+4>>2]|0)==(T|0)))&&(y=te+24|0,!((A[y>>2]|0)==(b|0)&&(A[y+4>>2]|0)==(T|0)))&&(y=te+32|0,!((A[y>>2]|0)==(b|0)&&(A[y+4>>2]|0)==(T|0)))&&(y=te+40|0,!((A[y>>2]|0)==(b|0)&&(A[y+4>>2]|0)==(T|0)))?(O=te+48|0,O=((A[O>>2]|0)==(b|0)?(A[O+4>>2]|0)==(T|0):0)&1):O=1,A[E>>2]=O,E=0,me=_e,E|0}function _m(g,y,b,T,E){return g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,b=bv(g,y,b,T)|0,(b|0)==7?(E=11,E|0):(T=Dt(b|0,0,56)|0,y=y&-2130706433|(be()|0)|268435456,A[E>>2]=g|T,A[E+4>>2]=y,E=0,E|0)}function Ev(g,y,b){return g=g|0,y=y|0,b=b|0,!0&(y&2013265920|0)==268435456?(A[b>>2]=g,A[b+4>>2]=y&-2130706433|134217728,b=0,b|0):(b=6,b|0)}function kA(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;return E=me,me=me+16|0,T=E,A[T>>2]=0,!0&(y&2013265920|0)==268435456?(O=St(g|0,y|0,56)|0,be()|0,T=fo(g,y&-2130706433|134217728,O&7,T,b)|0,me=E,T|0):(T=6,me=E,T|0)}function Qn(g,y){g=g|0,y=y|0;var b=0;switch(b=St(g|0,y|0,56)|0,be()|0,b&7){case 0:case 7:return b=0,b|0;default:}return b=y&-2130706433|134217728,!(!0&(y&2013265920|0)==268435456)||!0&(y&117440512|0)==16777216&(En(g,b)|0)!=0?(b=0,b|0):(b=LA(g,b)|0,b|0)}function Af(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0;return E=me,me=me+16|0,T=E,!0&(y&2013265920|0)==268435456?(O=y&-2130706433|134217728,B=b,A[B>>2]=g,A[B+4>>2]=O,A[T>>2]=0,y=St(g|0,y|0,56)|0,be()|0,T=fo(g,O,y&7,T,b+8|0)|0,me=E,T|0):(T=6,me=E,T|0)}function Xl(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0;return E=(En(g,y)|0)==0,y=y&-2130706433,T=b,A[T>>2]=E?g:0,A[T+4>>2]=E?y|285212672:0,T=b+8|0,A[T>>2]=g,A[T+4>>2]=y|301989888,T=b+16|0,A[T>>2]=g,A[T+4>>2]=y|318767104,T=b+24|0,A[T>>2]=g,A[T+4>>2]=y|335544320,T=b+32|0,A[T>>2]=g,A[T+4>>2]=y|352321536,b=b+40|0,A[b>>2]=g,A[b+4>>2]=y|369098752,0}function Dp(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0;return B=me,me=me+16|0,E=B,O=y&-2130706433|134217728,!0&(y&2013265920|0)==268435456?(T=St(g|0,y|0,56)|0,be()|0,T=X(g,O,T&7)|0,(T|0)==-1?(A[b>>2]=0,O=6,me=B,O|0):(ar(g,O,E)|0&&Ur(27795,26932,282,26947),y=St(g|0,y|0,52)|0,be()|0,y=y&15,En(g,O)|0?Xh(E,y,T,2,b):OA(E,y,T,2,b),O=0,me=B,O|0)):(O=6,me=B,O|0)}function RA(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0;T=me,me=me+16|0,E=T,Xx(g,y,b,E),qx(E,b+4|0),me=T}function Xx(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0;if(N=me,me=me+16|0,G=N,Lp(g,b,G),O=+Nx(+(1-+de[G>>3]*.5)),O<1e-16){A[T>>2]=0,A[T+4>>2]=0,A[T+8>>2]=0,A[T+12>>2]=0,me=N;return}if(G=A[b>>2]|0,E=+de[15920+(G*24|0)>>3],E=+Up(E-+Up(+tw(15600+(G<<4)|0,g))),wl(y)|0?B=+Up(E+-.3334731722518321):B=E,E=+hm(+O)*2.618033988749896,(y|0)>0){g=0;do E=E*2.6457513110645907,g=g+1|0;while((g|0)!=(y|0))}O=+en(+B)*E,de[T>>3]=O,B=+Yi(+B)*E,de[T+8>>3]=B,me=N}function Lp(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;if(O=me,me=me+32|0,E=O,V(g,E),A[y>>2]=0,de[b>>3]=5,T=+z(16400,E),T<+de[b>>3]&&(A[y>>2]=0,de[b>>3]=T),T=+z(16424,E),T<+de[b>>3]&&(A[y>>2]=1,de[b>>3]=T),T=+z(16448,E),T<+de[b>>3]&&(A[y>>2]=2,de[b>>3]=T),T=+z(16472,E),T<+de[b>>3]&&(A[y>>2]=3,de[b>>3]=T),T=+z(16496,E),T<+de[b>>3]&&(A[y>>2]=4,de[b>>3]=T),T=+z(16520,E),T<+de[b>>3]&&(A[y>>2]=5,de[b>>3]=T),T=+z(16544,E),T<+de[b>>3]&&(A[y>>2]=6,de[b>>3]=T),T=+z(16568,E),T<+de[b>>3]&&(A[y>>2]=7,de[b>>3]=T),T=+z(16592,E),T<+de[b>>3]&&(A[y>>2]=8,de[b>>3]=T),T=+z(16616,E),T<+de[b>>3]&&(A[y>>2]=9,de[b>>3]=T),T=+z(16640,E),T<+de[b>>3]&&(A[y>>2]=10,de[b>>3]=T),T=+z(16664,E),T<+de[b>>3]&&(A[y>>2]=11,de[b>>3]=T),T=+z(16688,E),T<+de[b>>3]&&(A[y>>2]=12,de[b>>3]=T),T=+z(16712,E),T<+de[b>>3]&&(A[y>>2]=13,de[b>>3]=T),T=+z(16736,E),T<+de[b>>3]&&(A[y>>2]=14,de[b>>3]=T),T=+z(16760,E),T<+de[b>>3]&&(A[y>>2]=15,de[b>>3]=T),T=+z(16784,E),T<+de[b>>3]&&(A[y>>2]=16,de[b>>3]=T),T=+z(16808,E),T<+de[b>>3]&&(A[y>>2]=17,de[b>>3]=T),T=+z(16832,E),T<+de[b>>3]&&(A[y>>2]=18,de[b>>3]=T),T=+z(16856,E),!(T<+de[b>>3])){me=O;return}A[y>>2]=19,de[b>>3]=T,me=O}function Yh(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0;if(O=+S(g),O<1e-16){y=15600+(y<<4)|0,A[E>>2]=A[y>>2],A[E+4>>2]=A[y+4>>2],A[E+8>>2]=A[y+8>>2],A[E+12>>2]=A[y+12>>2];return}if(B=+Da(+ +de[g+8>>3],+ +de[g>>3]),(b|0)>0){g=0;do O=O*.37796447300922725,g=g+1|0;while((g|0)!=(b|0))}N=O*.3333333333333333,T?(b=(wl(b)|0)==0,O=+dm(+((b?N:N*.37796447300922725)*.381966011250105))):(O=+dm(+(O*.381966011250105)),wl(b)|0&&(B=+Up(B+.3334731722518321))),V4(15600+(y<<4)|0,+Up(+de[15920+(y*24|0)>>3]-B),O,E)}function Bp(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0;T=me,me=me+16|0,E=T,qh(g+4|0,E),Yh(E,A[g>>2]|0,y,0,b),me=T}function Xh(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0,Nr=0,Ai=0,Wr=0,kr=0,qt=0,Ci=0,Sn=0,yi=0;if(Ci=me,me=me+272|0,O=Ci+256|0,At=Ci+240|0,Wr=Ci,kr=Ci+224|0,qt=Ci+208|0,ut=Ci+176|0,Xe=Ci+160|0,Yt=Ci+192|0,Mr=Ci+144|0,dr=Ci+128|0,Qr=Ci+112|0,Nr=Ci+96|0,Ai=Ci+80|0,A[O>>2]=y,A[At>>2]=A[g>>2],A[At+4>>2]=A[g+4>>2],A[At+8>>2]=A[g+8>>2],A[At+12>>2]=A[g+12>>2],Cv(At,O,Wr),A[E>>2]=0,At=T+b+((T|0)==5&1)|0,(At|0)<=(b|0)){me=Ci;return}G=A[O>>2]|0,K=kr+4|0,te=ut+4|0,_e=b+5|0,Ee=16880+(G<<2)|0,ke=16960+(G<<2)|0,Ie=dr+8|0,qe=Qr+8|0,ot=Nr+8|0,wt=qt+4|0,N=b;e:for(;;){B=Wr+(((N|0)%5|0)<<4)|0,A[qt>>2]=A[B>>2],A[qt+4>>2]=A[B+4>>2],A[qt+8>>2]=A[B+8>>2],A[qt+12>>2]=A[B+12>>2];do;while((Zh(qt,G,0,1)|0)==2);if((N|0)>(b|0)&(wl(y)|0)!=0){if(A[ut>>2]=A[qt>>2],A[ut+4>>2]=A[qt+4>>2],A[ut+8>>2]=A[qt+8>>2],A[ut+12>>2]=A[qt+12>>2],qh(K,Xe),T=A[ut>>2]|0,O=A[17040+(T*80|0)+(A[kr>>2]<<2)>>2]|0,A[ut>>2]=A[18640+(T*80|0)+(O*20|0)>>2],B=A[18640+(T*80|0)+(O*20|0)+16>>2]|0,(B|0)>0){g=0;do ym(te),g=g+1|0;while((g|0)<(B|0))}switch(B=18640+(T*80|0)+(O*20|0)+4|0,A[Yt>>2]=A[B>>2],A[Yt+4>>2]=A[B+4>>2],A[Yt+8>>2]=A[B+8>>2],gm(Yt,(A[Ee>>2]|0)*3|0),La(te,Yt,te),es(te),qh(te,Mr),Sn=+(A[ke>>2]|0),de[dr>>3]=Sn*3,de[Ie>>3]=0,yi=Sn*-1.5,de[Qr>>3]=yi,de[qe>>3]=Sn*2.598076211353316,de[Nr>>3]=yi,de[ot>>3]=Sn*-2.598076211353316,A[17040+((A[ut>>2]|0)*80|0)+(A[qt>>2]<<2)>>2]|0){case 1:{g=Qr,T=dr;break}case 3:{g=Nr,T=Qr;break}case 2:{g=dr,T=Nr;break}default:{g=12;break e}}I(Xe,Mr,T,g,Ai),Yh(Ai,A[ut>>2]|0,G,1,E+8+(A[E>>2]<<4)|0),A[E>>2]=(A[E>>2]|0)+1}if((N|0)<(_e|0)&&(qh(wt,ut),Yh(ut,A[qt>>2]|0,G,1,E+8+(A[E>>2]<<4)|0),A[E>>2]=(A[E>>2]|0)+1),A[kr>>2]=A[qt>>2],A[kr+4>>2]=A[qt+4>>2],A[kr+8>>2]=A[qt+8>>2],A[kr+12>>2]=A[qt+12>>2],N=N+1|0,(N|0)>=(At|0)){g=3;break}}if((g|0)==3){me=Ci;return}else(g|0)==12&&Ur(26970,27017,572,27027)}function Cv(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0;G=me,me=me+128|0,T=G+64|0,E=G,O=T,B=20240,N=O+60|0;do A[O>>2]=A[B>>2],O=O+4|0,B=B+4|0;while((O|0)<(N|0));O=E,B=20304,N=O+60|0;do A[O>>2]=A[B>>2],O=O+4|0,B=B+4|0;while((O|0)<(N|0));N=(wl(A[y>>2]|0)|0)==0,T=N?T:E,E=g+4|0,gf(E),Yx(E),wl(A[y>>2]|0)|0&&(Sc(E),A[y>>2]=(A[y>>2]|0)+1),A[b>>2]=A[g>>2],y=b+4|0,La(E,T,y),es(y),A[b+16>>2]=A[g>>2],y=b+20|0,La(E,T+12|0,y),es(y),A[b+32>>2]=A[g>>2],y=b+36|0,La(E,T+24|0,y),es(y),A[b+48>>2]=A[g>>2],y=b+52|0,La(E,T+36|0,y),es(y),A[b+64>>2]=A[g>>2],b=b+68|0,La(E,T+48|0,b),es(b),me=G}function Zh(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0;if(Ie=me,me=me+32|0,Ee=Ie+12|0,N=Ie,ke=g+4|0,_e=A[16960+(y<<2)>>2]|0,te=(T|0)!=0,_e=te?_e*3|0:_e,E=A[ke>>2]|0,K=g+8|0,B=A[K>>2]|0,te){if(O=g+12|0,T=A[O>>2]|0,E=B+E+T|0,(E|0)==(_e|0))return ke=1,me=Ie,ke|0;G=O}else G=g+12|0,T=A[G>>2]|0,E=B+E+T|0;if((E|0)<=(_e|0))return ke=0,me=Ie,ke|0;do if((T|0)>0){if(T=A[g>>2]|0,(B|0)>0){O=18640+(T*80|0)+60|0,T=g;break}T=18640+(T*80|0)+40|0,b?(U4(Ee,_e,0,0),wA(ke,Ee,N),Zu(N),La(N,Ee,ke),O=T,T=g):(O=T,T=g)}else O=18640+((A[g>>2]|0)*80|0)+20|0,T=g;while(!1);if(A[T>>2]=A[O>>2],E=O+16|0,(A[E>>2]|0)>0){T=0;do ym(ke),T=T+1|0;while((T|0)<(A[E>>2]|0))}return g=O+4|0,A[Ee>>2]=A[g>>2],A[Ee+4>>2]=A[g+4>>2],A[Ee+8>>2]=A[g+8>>2],y=A[16880+(y<<2)>>2]|0,gm(Ee,te?y*3|0:y),La(ke,Ee,ke),es(ke),te?T=((A[K>>2]|0)+(A[ke>>2]|0)+(A[G>>2]|0)|0)==(_e|0)?1:2:T=2,ke=T,me=Ie,ke|0}function Pv(g,y){g=g|0,y=y|0;var b=0;do b=Zh(g,y,0,1)|0;while((b|0)==2);return b|0}function OA(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0,Nr=0,Ai=0,Wr=0;if(Nr=me,me=me+240|0,O=Nr+224|0,Yt=Nr+208|0,Mr=Nr,dr=Nr+192|0,Qr=Nr+176|0,ot=Nr+160|0,wt=Nr+144|0,At=Nr+128|0,ut=Nr+112|0,Xe=Nr+96|0,A[O>>2]=y,A[Yt>>2]=A[g>>2],A[Yt+4>>2]=A[g+4>>2],A[Yt+8>>2]=A[g+8>>2],A[Yt+12>>2]=A[g+12>>2],DA(Yt,O,Mr),A[E>>2]=0,qe=T+b+((T|0)==6&1)|0,(qe|0)<=(b|0)){me=Nr;return}G=A[O>>2]|0,K=b+6|0,te=16960+(G<<2)|0,_e=wt+8|0,Ee=At+8|0,ke=ut+8|0,Ie=dr+4|0,B=0,N=b,T=-1;e:for(;;){if(O=(N|0)%6|0,g=Mr+(O<<4)|0,A[dr>>2]=A[g>>2],A[dr+4>>2]=A[g+4>>2],A[dr+8>>2]=A[g+8>>2],A[dr+12>>2]=A[g+12>>2],g=B,B=Zh(dr,G,0,1)|0,(N|0)>(b|0)&(wl(y)|0)!=0&&(g|0)!=1&&(A[dr>>2]|0)!=(T|0)){switch(qh(Mr+(((O+5|0)%6|0)<<4)+4|0,Qr),qh(Mr+(O<<4)+4|0,ot),Ai=+(A[te>>2]|0),de[wt>>3]=Ai*3,de[_e>>3]=0,Wr=Ai*-1.5,de[At>>3]=Wr,de[Ee>>3]=Ai*2.598076211353316,de[ut>>3]=Wr,de[ke>>3]=Ai*-2.598076211353316,O=A[Yt>>2]|0,A[17040+(O*80|0)+(((T|0)==(O|0)?A[dr>>2]|0:T)<<2)>>2]|0){case 1:{g=At,T=wt;break}case 3:{g=ut,T=At;break}case 2:{g=wt,T=ut;break}default:{g=8;break e}}I(Qr,ot,T,g,Xe),!(D(Qr,Xe)|0)&&!(D(ot,Xe)|0)&&(Yh(Xe,A[Yt>>2]|0,G,1,E+8+(A[E>>2]<<4)|0),A[E>>2]=(A[E>>2]|0)+1)}if((N|0)<(K|0)&&(qh(Ie,Qr),Yh(Qr,A[dr>>2]|0,G,1,E+8+(A[E>>2]<<4)|0),A[E>>2]=(A[E>>2]|0)+1),N=N+1|0,(N|0)>=(qe|0)){g=3;break}else T=A[dr>>2]|0}if((g|0)==3){me=Nr;return}else(g|0)==8&&Ur(27054,27017,737,27099)}function DA(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0;G=me,me=me+160|0,T=G+80|0,E=G,O=T,B=20368,N=O+72|0;do A[O>>2]=A[B>>2],O=O+4|0,B=B+4|0;while((O|0)<(N|0));O=E,B=20448,N=O+72|0;do A[O>>2]=A[B>>2],O=O+4|0,B=B+4|0;while((O|0)<(N|0));N=(wl(A[y>>2]|0)|0)==0,T=N?T:E,E=g+4|0,gf(E),Yx(E),wl(A[y>>2]|0)|0&&(Sc(E),A[y>>2]=(A[y>>2]|0)+1),A[b>>2]=A[g>>2],y=b+4|0,La(E,T,y),es(y),A[b+16>>2]=A[g>>2],y=b+20|0,La(E,T+12|0,y),es(y),A[b+32>>2]=A[g>>2],y=b+36|0,La(E,T+24|0,y),es(y),A[b+48>>2]=A[g>>2],y=b+52|0,La(E,T+36|0,y),es(y),A[b+64>>2]=A[g>>2],y=b+68|0,La(E,T+48|0,y),es(y),A[b+80>>2]=A[g>>2],b=b+84|0,La(E,T+60|0,b),es(b),me=G}function Kh(g,y){return g=g|0,y=y|0,y=St(g|0,y|0,52)|0,be()|0,y&15|0}function yf(g,y){return g=g|0,y=y|0,y=St(g|0,y|0,45)|0,be()|0,y&127|0}function LA(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0;return!(!0&(y&-16777216|0)==134217728)||(T=St(g|0,y|0,52)|0,be()|0,T=T&15,b=St(g|0,y|0,45)|0,be()|0,b=b&127,b>>>0>121)?(g=0,g|0):(B=(T^15)*3|0,E=St(g|0,y|0,B|0)|0,B=Dt(E|0,be()|0,B|0)|0,E=be()|0,O=gt(-1227133514,-1171,B|0,E|0)|0,!((B&613566756&O|0)==0&(E&4681&(be()|0)|0)==0)||(B=(T*3|0)+19|0,O=Dt(~g|0,~y|0,B|0)|0,B=St(O|0,be()|0,B|0)|0,!((T|0)==15|(B|0)==0&(be()|0)==0))?(B=0,B|0):!(zt[20528+b>>0]|0)||(y=y&8191,(g|0)==0&(y|0)==0)?(B=1,B|0):(B=ts(g|0,y|0,0)|0,be()|0,((63-B|0)%3|0|0)!=0|0))}function BA(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0;if(E=Dt(y|0,0,52)|0,O=be()|0,b=Dt(b|0,0,45)|0,b=O|(be()|0)|134225919,(y|0)<1){O=-1,T=b,y=g,A[y>>2]=O,g=g+4|0,A[g>>2]=T;return}for(O=1,E=-1;B=(15-O|0)*3|0,N=Dt(7,0,B|0)|0,b=b&~(be()|0),B=Dt(T|0,0,B|0)|0,E=E&~N|B,b=b|(be()|0),(O|0)!=(y|0);)O=O+1|0;N=g,B=N,A[B>>2]=E,N=N+4|0,A[N>>2]=b}function FA(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0;if(O=St(g|0,y|0,52)|0,be()|0,O=O&15,b>>>0>15)return T=4,T|0;if((O|0)<(b|0))return T=12,T|0;if((O|0)==(b|0))return A[T>>2]=g,A[T+4>>2]=y,T=0,T|0;if(E=Dt(b|0,0,52)|0,E=E|g,g=be()|0|y&-15728641,(O|0)>(b|0))do y=Dt(7,0,(14-b|0)*3|0)|0,b=b+1|0,E=y|E,g=be()|0|g;while((b|0)<(O|0));return A[T>>2]=E,A[T+4>>2]=g,T=0,T|0}function Fp(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0;if(O=St(g|0,y|0,52)|0,be()|0,O=O&15,!((b|0)<16&(O|0)<=(b|0)))return T=4,T|0;E=b-O|0,b=St(g|0,y|0,45)|0,be()|0;e:do if(!(In(b&127)|0))b=gn(7,0,E,((E|0)<0)<<31>>31)|0,E=be()|0;else{t:do if(O|0){for(b=1;B=Dt(7,0,(15-b|0)*3|0)|0,!!((B&g|0)==0&((be()|0)&y|0)==0);)if(b>>>0<O>>>0)b=b+1|0;else break t;b=gn(7,0,E,((E|0)<0)<<31>>31)|0,E=be()|0;break e}while(!1);b=gn(7,0,E,((E|0)<0)<<31>>31)|0,b=Ar(b|0,be()|0,5,0)|0,b=Ye(b|0,be()|0,-5,-1)|0,b=kt(b|0,be()|0,6,0)|0,b=Ye(b|0,be()|0,1,0)|0,E=be()|0}while(!1);return B=T,A[B>>2]=b,A[B+4>>2]=E,B=0,B|0}function En(g,y){g=g|0,y=y|0;var b=0,T=0,E=0;if(E=St(g|0,y|0,45)|0,be()|0,!(In(E&127)|0))return E=0,E|0;E=St(g|0,y|0,52)|0,be()|0,E=E&15;e:do if(!E)b=0;else for(T=1;;){if(b=St(g|0,y|0,(15-T|0)*3|0)|0,be()|0,b=b&7,b|0)break e;if(T>>>0<E>>>0)T=T+1|0;else{b=0;break}}while(!1);return E=(b|0)==0&1,E|0}function Zx(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0;if(B=me,me=me+16|0,O=B,NA(O,g,y,b),y=O,g=A[y>>2]|0,y=A[y+4>>2]|0,(g|0)==0&(y|0)==0)return me=B,0;E=0,b=0;do N=T+(E<<3)|0,A[N>>2]=g,A[N+4>>2]=y,E=Ye(E|0,b|0,1,0)|0,b=be()|0,zA(O),N=O,g=A[N>>2]|0,y=A[N+4>>2]|0;while(!((g|0)==0&(y|0)==0));return me=B,0}function _f(g,y,b,T){return g=g|0,y=y|0,b=b|0,T=T|0,(T|0)<(b|0)?(b=y,T=g,si(b|0),T|0):(b=Dt(-1,-1,((T-b|0)*3|0)+3|0)|0,T=Dt(~b|0,~(be()|0)|0,(15-T|0)*3|0)|0,b=~(be()|0)&y,T=~T&g,si(b|0),T|0)}function Qu(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0;return E=St(g|0,y|0,52)|0,be()|0,E=E&15,(b|0)<16&(E|0)<=(b|0)?((E|0)<(b|0)&&(E=Dt(-1,-1,((b+-1-E|0)*3|0)+3|0)|0,E=Dt(~E|0,~(be()|0)|0,(15-b|0)*3|0)|0,y=~(be()|0)&y,g=~E&g),E=Dt(b|0,0,52)|0,b=y&-15728641|(be()|0),A[T>>2]=g|E,A[T+4>>2]=b,T=0,T|0):(T=4,T|0)}function tl(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0,Nr=0,Ai=0,Wr=0,kr=0,qt=0;if((b|0)==0&(T|0)==0)return qt=0,qt|0;if(E=g,O=A[E>>2]|0,E=A[E+4>>2]|0,!0&(E&15728640|0)==0){if(!((T|0)>0|(T|0)==0&b>>>0>0)||(qt=y,A[qt>>2]=O,A[qt+4>>2]=E,(b|0)==1&(T|0)==0))return qt=0,qt|0;E=1,O=0;do Wr=g+(E<<3)|0,kr=A[Wr+4>>2]|0,qt=y+(E<<3)|0,A[qt>>2]=A[Wr>>2],A[qt+4>>2]=kr,E=Ye(E|0,O|0,1,0)|0,O=be()|0;while((O|0)<(T|0)|(O|0)==(T|0)&E>>>0<b>>>0);return E=0,E|0}if(Ai=b<<3,kr=et(Ai)|0,!kr)return qt=13,qt|0;if(Gn(kr|0,g|0,Ai|0)|0,Wr=ct(b,8)|0,!Wr)return Ke(kr),qt=13,qt|0;e:for(;;){E=kr,K=A[E>>2]|0,E=A[E+4>>2]|0,Qr=St(K|0,E|0,52)|0,be()|0,Qr=Qr&15,Nr=Qr+-1|0,dr=(Qr|0)!=0,Mr=(T|0)>0|(T|0)==0&b>>>0>0;t:do if(dr&Mr){if(At=Dt(Nr|0,0,52)|0,ut=be()|0,Nr>>>0>15){if(!((K|0)==0&(E|0)==0)){qt=16;break e}for(O=0,g=0;;){if(O=Ye(O|0,g|0,1,0)|0,g=be()|0,!((g|0)<(T|0)|(g|0)==(T|0)&O>>>0<b>>>0))break t;if(B=kr+(O<<3)|0,Yt=A[B>>2]|0,B=A[B+4>>2]|0,!((Yt|0)==0&(B|0)==0)){E=B,qt=16;break e}}}for(N=K,g=E,O=0,B=0;;){if(!((N|0)==0&(g|0)==0)){if(!(!0&(g&117440512|0)==0)){qt=21;break e}if(te=St(N|0,g|0,52)|0,be()|0,te=te&15,(te|0)<(Nr|0)){E=12,qt=27;break e}if((te|0)!=(Nr|0)&&(N=N|At,g=g&-15728641|ut,te>>>0>=Qr>>>0)){G=Nr;do Yt=Dt(7,0,(14-G|0)*3|0)|0,G=G+1|0,N=Yt|N,g=be()|0|g;while(G>>>0<te>>>0)}if(Ee=An(N|0,g|0,b|0,T|0)|0,ke=be()|0,G=Wr+(Ee<<3)|0,te=G,_e=A[te>>2]|0,te=A[te+4>>2]|0,!((_e|0)==0&(te|0)==0)){ot=0,wt=0;do{if((ot|0)>(T|0)|(ot|0)==(T|0)&wt>>>0>b>>>0){qt=31;break e}if((_e|0)==(N|0)&(te&-117440513|0)==(g|0)){Ie=St(_e|0,te|0,56)|0,be()|0,Ie=Ie&7,qe=Ie+1|0,Yt=St(_e|0,te|0,45)|0,be()|0;r:do if(!(In(Yt&127)|0))te=7;else{if(_e=St(_e|0,te|0,52)|0,be()|0,_e=_e&15,!_e){te=6;break}for(te=1;;){if(Yt=Dt(7,0,(15-te|0)*3|0)|0,!((Yt&N|0)==0&((be()|0)&g|0)==0)){te=7;break r}if(te>>>0<_e>>>0)te=te+1|0;else{te=6;break}}}while(!1);if((Ie+2|0)>>>0>te>>>0){qt=41;break e}Yt=Dt(qe|0,0,56)|0,g=be()|0|g&-117440513,Xe=G,A[Xe>>2]=0,A[Xe+4>>2]=0,N=Yt|N}else Ee=Ye(Ee|0,ke|0,1,0)|0,Ee=Wi(Ee|0,be()|0,b|0,T|0)|0,ke=be()|0;wt=Ye(wt|0,ot|0,1,0)|0,ot=be()|0,G=Wr+(Ee<<3)|0,te=G,_e=A[te>>2]|0,te=A[te+4>>2]|0}while(!((_e|0)==0&(te|0)==0))}Yt=G,A[Yt>>2]=N,A[Yt+4>>2]=g}if(O=Ye(O|0,B|0,1,0)|0,B=be()|0,!((B|0)<(T|0)|(B|0)==(T|0)&O>>>0<b>>>0))break t;g=kr+(O<<3)|0,N=A[g>>2]|0,g=A[g+4>>2]|0}}while(!1);if(Yt=Ye(b|0,T|0,5,0)|0,Xe=be()|0,Xe>>>0<0|(Xe|0)==0&Yt>>>0<11){qt=85;break}if(Yt=kt(b|0,T|0,6,0)|0,be()|0,Yt=ct(Yt,8)|0,!Yt){qt=48;break}do if(Mr){for(qe=0,g=0,Ie=0,ot=0;;){if(te=Wr+(qe<<3)|0,B=te,O=A[B>>2]|0,B=A[B+4>>2]|0,(O|0)==0&(B|0)==0)Xe=Ie;else{_e=St(O|0,B|0,56)|0,be()|0,_e=_e&7,N=_e+1|0,Ee=B&-117440513,Xe=St(O|0,B|0,45)|0,be()|0;t:do if(In(Xe&127)|0){if(ke=St(O|0,B|0,52)|0,be()|0,ke=ke&15,ke|0)for(G=1;;){if(Xe=Dt(7,0,(15-G|0)*3|0)|0,!((O&Xe|0)==0&(Ee&(be()|0)|0)==0))break t;if(G>>>0<ke>>>0)G=G+1|0;else break}B=Dt(N|0,0,56)|0,O=B|O,B=be()|0|Ee,N=te,A[N>>2]=O,A[N+4>>2]=B,N=_e+2|0}while(!1);(N|0)==7?(Xe=Yt+(g<<3)|0,A[Xe>>2]=O,A[Xe+4>>2]=B&-117440513,g=Ye(g|0,Ie|0,1,0)|0,Xe=be()|0):Xe=Ie}if(qe=Ye(qe|0,ot|0,1,0)|0,ot=be()|0,(ot|0)<(T|0)|(ot|0)==(T|0)&qe>>>0<b>>>0)Ie=Xe;else break}if(Mr){if(wt=Nr>>>0>15,At=Dt(Nr|0,0,52)|0,ut=be()|0,!dr){for(O=0,G=0,N=0,B=0;(K|0)==0&(E|0)==0||(Nr=y+(O<<3)|0,A[Nr>>2]=K,A[Nr+4>>2]=E,O=Ye(O|0,G|0,1,0)|0,G=be()|0),N=Ye(N|0,B|0,1,0)|0,B=be()|0,!!((B|0)<(T|0)|(B|0)==(T|0)&N>>>0<b>>>0);)E=kr+(N<<3)|0,K=A[E>>2]|0,E=A[E+4>>2]|0;E=Xe;break}for(O=0,G=0,B=0,N=0;;){do if(!((K|0)==0&(E|0)==0)){if(ke=St(K|0,E|0,52)|0,be()|0,ke=ke&15,wt|(ke|0)<(Nr|0)){qt=80;break e}if((ke|0)!=(Nr|0)){if(te=K|At,_e=E&-15728641|ut,ke>>>0>=Qr>>>0){Ee=Nr;do dr=Dt(7,0,(14-Ee|0)*3|0)|0,Ee=Ee+1|0,te=dr|te,_e=be()|0|_e;while(Ee>>>0<ke>>>0)}}else te=K,_e=E;Ie=An(te|0,_e|0,b|0,T|0)|0,Ee=0,ke=0,ot=be()|0;do{if((Ee|0)>(T|0)|(Ee|0)==(T|0)&ke>>>0>b>>>0){qt=81;break e}if(dr=Wr+(Ie<<3)|0,qe=A[dr+4>>2]|0,(qe&-117440513|0)==(_e|0)&&(A[dr>>2]|0)==(te|0)){qt=65;break}dr=Ye(Ie|0,ot|0,1,0)|0,Ie=Wi(dr|0,be()|0,b|0,T|0)|0,ot=be()|0,ke=Ye(ke|0,Ee|0,1,0)|0,Ee=be()|0,dr=Wr+(Ie<<3)|0}while(!((A[dr>>2]|0)==(te|0)&&(A[dr+4>>2]|0)==(_e|0)));if((qt|0)==65&&(qt=0,!0&(qe&117440512|0)==100663296))break;dr=y+(O<<3)|0,A[dr>>2]=K,A[dr+4>>2]=E,O=Ye(O|0,G|0,1,0)|0,G=be()|0}while(!1);if(B=Ye(B|0,N|0,1,0)|0,N=be()|0,!((N|0)<(T|0)|(N|0)==(T|0)&B>>>0<b>>>0))break;E=kr+(B<<3)|0,K=A[E>>2]|0,E=A[E+4>>2]|0}E=Xe}else O=0,E=Xe}else O=0,g=0,E=0;while(!1);if(ro(Wr|0,0,Ai|0)|0,Gn(kr|0,Yt|0,g<<3|0)|0,Ke(Yt),(g|0)==0&(E|0)==0){qt=89;break}else y=y+(O<<3)|0,T=E,b=g}if((qt|0)==16)!0&(E&117440512|0)==0?(E=4,qt=27):qt=21;else if((qt|0)==31)Ur(27795,27122,529,27132);else{if((qt|0)==41)return Ke(kr),Ke(Wr),qt=10,qt|0;if((qt|0)==48)return Ke(kr),Ke(Wr),qt=13,qt|0;(qt|0)==80?Ur(27795,27122,620,27132):(qt|0)==81?Ur(27795,27122,632,27132):(qt|0)==85&&(Gn(y|0,kr|0,b<<3|0)|0,qt=89)}return(qt|0)==21?(Ke(kr),Ke(Wr),qt=5,qt|0):(qt|0)==27?(Ke(kr),Ke(Wr),qt=E,qt|0):(qt|0)==89?(Ke(kr),Ke(Wr),qt=0,qt|0):0}function ua(g,y,b,T,E,O,B){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,O=O|0,B=B|0;var N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0;if(qe=me,me=me+16|0,Ie=qe,!((b|0)>0|(b|0)==0&y>>>0>0))return Ie=0,me=qe,Ie|0;if((B|0)>=16)return Ie=12,me=qe,Ie|0;Ee=0,ke=0,_e=0,N=0;e:for(;;){if(K=g+(Ee<<3)|0,G=A[K>>2]|0,K=A[K+4>>2]|0,te=St(G|0,K|0,52)|0,be()|0,(te&15|0)>(B|0)){N=12,G=11;break}if(NA(Ie,G,K,B),te=Ie,K=A[te>>2]|0,te=A[te+4>>2]|0,(K|0)==0&(te|0)==0)G=_e;else{G=_e;do{if(!((N|0)<(O|0)|(N|0)==(O|0)&G>>>0<E>>>0)){G=10;break e}_e=T+(G<<3)|0,A[_e>>2]=K,A[_e+4>>2]=te,G=Ye(G|0,N|0,1,0)|0,N=be()|0,zA(Ie),_e=Ie,K=A[_e>>2]|0,te=A[_e+4>>2]|0}while(!((K|0)==0&(te|0)==0))}if(Ee=Ye(Ee|0,ke|0,1,0)|0,ke=be()|0,(ke|0)<(b|0)|(ke|0)==(b|0)&Ee>>>0<y>>>0)_e=G;else{N=0,G=11;break}}return(G|0)==10?(Ie=14,me=qe,Ie|0):(G|0)==11?(me=qe,N|0):0}function Zl(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0;Ee=me,me=me+16|0,_e=Ee;e:do if((b|0)>0|(b|0)==0&y>>>0>0){for(K=0,B=0,O=0,te=0;;){if(G=g+(K<<3)|0,N=A[G>>2]|0,G=A[G+4>>2]|0,!((N|0)==0&(G|0)==0)&&(G=(Fp(N,G,T,_e)|0)==0,N=_e,B=Ye(A[N>>2]|0,A[N+4>>2]|0,B|0,O|0)|0,O=be()|0,!G)){O=12;break}if(K=Ye(K|0,te|0,1,0)|0,te=be()|0,!((te|0)<(b|0)|(te|0)==(b|0)&K>>>0<y>>>0))break e}return me=Ee,O|0}else B=0,O=0;while(!1);return A[E>>2]=B,A[E+4>>2]=O,E=0,me=Ee,E|0}function Kx(g,y){return g=g|0,y=y|0,y=St(g|0,y|0,52)|0,be()|0,y&1|0}function po(g,y){g=g|0,y=y|0;var b=0,T=0,E=0;if(E=St(g|0,y|0,52)|0,be()|0,E=E&15,!E)return E=0,E|0;for(T=1;;){if(b=St(g|0,y|0,(15-T|0)*3|0)|0,be()|0,b=b&7,b|0){T=5;break}if(T>>>0<E>>>0)T=T+1|0;else{b=0,T=5;break}}return(T|0)==5?b|0:0}function Kl(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0;if(G=St(g|0,y|0,52)|0,be()|0,G=G&15,!G)return N=y,G=g,si(N|0),G|0;for(N=1,b=0;;){O=(15-N|0)*3|0,T=Dt(7,0,O|0)|0,E=be()|0,B=St(g|0,y|0,O|0)|0,be()|0,O=Dt(au(B&7)|0,0,O|0)|0,B=be()|0,g=O|g&~T,y=B|y&~E;e:do if(!b)if((O&T|0)==0&(B&E|0)==0)b=0;else if(T=St(g|0,y|0,52)|0,be()|0,T=T&15,!T)b=1;else{b=1;t:for(;;){switch(B=St(g|0,y|0,(15-b|0)*3|0)|0,be()|0,B&7){case 1:break t;case 0:break;default:{b=1;break e}}if(b>>>0<T>>>0)b=b+1|0;else{b=1;break e}}for(b=1;;)if(B=(15-b|0)*3|0,E=St(g|0,y|0,B|0)|0,be()|0,O=Dt(7,0,B|0)|0,y=y&~(be()|0),B=Dt(au(E&7)|0,0,B|0)|0,g=g&~O|B,y=y|(be()|0),b>>>0<T>>>0)b=b+1|0;else{b=1;break}}while(!1);if(N>>>0<G>>>0)N=N+1|0;else break}return si(y|0),g|0}function Qh(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0;if(T=St(g|0,y|0,52)|0,be()|0,T=T&15,!T)return b=y,T=g,si(b|0),T|0;for(b=1;O=(15-b|0)*3|0,B=St(g|0,y|0,O|0)|0,be()|0,E=Dt(7,0,O|0)|0,y=y&~(be()|0),O=Dt(au(B&7)|0,0,O|0)|0,g=O|g&~E,y=be()|0|y,b>>>0<T>>>0;)b=b+1|0;return si(y|0),g|0}function Iv(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0;if(G=St(g|0,y|0,52)|0,be()|0,G=G&15,!G)return N=y,G=g,si(N|0),G|0;for(N=1,b=0;;){O=(15-N|0)*3|0,T=Dt(7,0,O|0)|0,E=be()|0,B=St(g|0,y|0,O|0)|0,be()|0,O=Dt(Ku(B&7)|0,0,O|0)|0,B=be()|0,g=O|g&~T,y=B|y&~E;e:do if(!b)if((O&T|0)==0&(B&E|0)==0)b=0;else if(T=St(g|0,y|0,52)|0,be()|0,T=T&15,!T)b=1;else{b=1;t:for(;;){switch(B=St(g|0,y|0,(15-b|0)*3|0)|0,be()|0,B&7){case 1:break t;case 0:break;default:{b=1;break e}}if(b>>>0<T>>>0)b=b+1|0;else{b=1;break e}}for(b=1;;)if(E=(15-b|0)*3|0,O=Dt(7,0,E|0)|0,B=y&~(be()|0),y=St(g|0,y|0,E|0)|0,be()|0,y=Dt(Ku(y&7)|0,0,E|0)|0,g=g&~O|y,y=B|(be()|0),b>>>0<T>>>0)b=b+1|0;else{b=1;break}}while(!1);if(N>>>0<G>>>0)N=N+1|0;else break}return si(y|0),g|0}function kv(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0;if(T=St(g|0,y|0,52)|0,be()|0,T=T&15,!T)return b=y,T=g,si(b|0),T|0;for(b=1;B=(15-b|0)*3|0,O=Dt(7,0,B|0)|0,E=y&~(be()|0),y=St(g|0,y|0,B|0)|0,be()|0,y=Dt(Ku(y&7)|0,0,B|0)|0,g=y|g&~O,y=be()|0|E,b>>>0<T>>>0;)b=b+1|0;return si(y|0),g|0}function Rv(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(G=me,me=me+64|0,N=G+40|0,T=G+24|0,E=G+12|0,O=G,Dt(y|0,0,52)|0,b=be()|0|134225919,!y)return(A[g+4>>2]|0)>2||(A[g+8>>2]|0)>2||(A[g+12>>2]|0)>2?(B=0,N=0,si(B|0),me=G,N|0):(Dt(AA(g)|0,0,45)|0,B=be()|0|b,N=-1,si(B|0),me=G,N|0);if(A[N>>2]=A[g>>2],A[N+4>>2]=A[g+4>>2],A[N+8>>2]=A[g+8>>2],A[N+12>>2]=A[g+12>>2],B=N+4|0,(y|0)>0)for(g=-1;A[T>>2]=A[B>>2],A[T+4>>2]=A[B+4>>2],A[T+8>>2]=A[B+8>>2],y&1?(MA(B),A[E>>2]=A[B>>2],A[E+4>>2]=A[B+4>>2],A[E+8>>2]=A[B+8>>2],Am(E)):(EA(B),A[E>>2]=A[B>>2],A[E+4>>2]=A[B+4>>2],A[E+8>>2]=A[B+8>>2],Sc(E)),wA(T,E,O),es(O),te=(15-y|0)*3|0,K=Dt(7,0,te|0)|0,b=b&~(be()|0),te=Dt(mf(O)|0,0,te|0)|0,g=te|g&~K,b=be()|0|b,(y|0)>1;)y=y+-1|0;else g=-1;e:do if((A[B>>2]|0)<=2&&(A[N+8>>2]|0)<=2&&(A[N+12>>2]|0)<=2){if(T=AA(N)|0,y=Dt(T|0,0,45)|0,y=y|g,g=be()|0|b&-1040385,O=df(N)|0,!(In(T)|0)){if((O|0)<=0)break;for(E=0;;){if(T=St(y|0,g|0,52)|0,be()|0,T=T&15,T)for(b=1;te=(15-b|0)*3|0,N=St(y|0,g|0,te|0)|0,be()|0,K=Dt(7,0,te|0)|0,g=g&~(be()|0),te=Dt(au(N&7)|0,0,te|0)|0,y=y&~K|te,g=g|(be()|0),b>>>0<T>>>0;)b=b+1|0;if(E=E+1|0,(E|0)==(O|0))break e}}E=St(y|0,g|0,52)|0,be()|0,E=E&15;t:do if(E){b=1;r:for(;;){switch(te=St(y|0,g|0,(15-b|0)*3|0)|0,be()|0,te&7){case 1:break r;case 0:break;default:break t}if(b>>>0<E>>>0)b=b+1|0;else break t}if(xl(T,A[N>>2]|0)|0)for(b=1;N=(15-b|0)*3|0,K=Dt(7,0,N|0)|0,te=g&~(be()|0),g=St(y|0,g|0,N|0)|0,be()|0,g=Dt(Ku(g&7)|0,0,N|0)|0,y=y&~K|g,g=te|(be()|0),b>>>0<E>>>0;)b=b+1|0;else for(b=1;te=(15-b|0)*3|0,N=St(y|0,g|0,te|0)|0,be()|0,K=Dt(7,0,te|0)|0,g=g&~(be()|0),te=Dt(au(N&7)|0,0,te|0)|0,y=y&~K|te,g=g|(be()|0),b>>>0<E>>>0;)b=b+1|0}while(!1);if((O|0)>0){b=0;do y=Kl(y,g)|0,g=be()|0,b=b+1|0;while((b|0)!=(O|0))}}else y=0,g=0;while(!1);return K=g,te=y,si(K|0),me=G,te|0}function wl(g){return g=g|0,(g|0)%2|0|0}function Tc(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0;return E=me,me=me+16|0,T=E,y>>>0>15?(T=4,me=E,T|0):(A[g+4>>2]&2146435072|0)==2146435072||(A[g+8+4>>2]&2146435072|0)==2146435072?(T=3,me=E,T|0):(RA(g,y,T),y=Rv(T,y)|0,T=be()|0,A[b>>2]=y,A[b+4>>2]=T,(y|0)==0&(T|0)==0&&Ur(27795,27122,959,27145),T=0,me=E,T|0)}function Mc(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0;if(E=b+4|0,O=St(g|0,y|0,52)|0,be()|0,O=O&15,B=St(g|0,y|0,45)|0,be()|0,T=(O|0)==0,In(B&127)|0){if(T)return B=1,B|0;T=1}else{if(T)return B=0,B|0;(A[E>>2]|0)==0&&(A[b+8>>2]|0)==0?T=(A[b+12>>2]|0)!=0&1:T=1}for(b=1;b&1?Am(E):Sc(E),B=St(g|0,y|0,(15-b|0)*3|0)|0,be()|0,Rp(E,B&7),b>>>0<O>>>0;)b=b+1|0;return T|0}function ar(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(te=me,me=me+16|0,G=te,K=St(g|0,y|0,45)|0,be()|0,K=K&127,K>>>0>121)return A[b>>2]=0,A[b+4>>2]=0,A[b+8>>2]=0,A[b+12>>2]=0,K=5,me=te,K|0;e:do if((In(K)|0)!=0&&(O=St(g|0,y|0,52)|0,be()|0,O=O&15,(O|0)!=0)){T=1;t:for(;;){switch(N=St(g|0,y|0,(15-T|0)*3|0)|0,be()|0,N&7){case 5:break t;case 0:break;default:{T=y;break e}}if(T>>>0<O>>>0)T=T+1|0;else{T=y;break e}}for(E=1,T=y;y=(15-E|0)*3|0,B=Dt(7,0,y|0)|0,N=T&~(be()|0),T=St(g|0,T|0,y|0)|0,be()|0,T=Dt(Ku(T&7)|0,0,y|0)|0,g=g&~B|T,T=N|(be()|0),E>>>0<O>>>0;)E=E+1|0}else T=y;while(!1);if(N=7696+(K*28|0)|0,A[b>>2]=A[N>>2],A[b+4>>2]=A[N+4>>2],A[b+8>>2]=A[N+8>>2],A[b+12>>2]=A[N+12>>2],!(Mc(g,T,b)|0))return K=0,me=te,K|0;if(B=b+4|0,A[G>>2]=A[B>>2],A[G+4>>2]=A[B+4>>2],A[G+8>>2]=A[B+8>>2],O=St(g|0,T|0,52)|0,be()|0,N=O&15,O&1?(Sc(B),O=N+1|0):O=N,!(In(K)|0))T=0;else{e:do if(!N)T=0;else for(y=1;;){if(E=St(g|0,T|0,(15-y|0)*3|0)|0,be()|0,E=E&7,E|0){T=E;break e}if(y>>>0<N>>>0)y=y+1|0;else{T=0;break}}while(!1);T=(T|0)==4&1}if(!(Zh(b,O,T,0)|0))(O|0)!=(N|0)&&(A[B>>2]=A[G>>2],A[B+4>>2]=A[G+4>>2],A[B+8>>2]=A[G+8>>2]);else{if(In(K)|0)do;while((Zh(b,O,0,0)|0)!=0);(O|0)!=(N|0)&&EA(B)}return K=0,me=te,K|0}function Jh(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;return O=me,me=me+16|0,T=O,E=ar(g,y,T)|0,E|0?(me=O,E|0):(E=St(g|0,y|0,52)|0,be()|0,Bp(T,E&15,b),E=0,me=O,E|0)}function Ql(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0;if(B=me,me=me+16|0,O=B,T=ar(g,y,O)|0,T|0)return O=T,me=B,O|0;T=St(g|0,y|0,45)|0,be()|0,T=(In(T&127)|0)==0,E=St(g|0,y|0,52)|0,be()|0,E=E&15;e:do if(!T){if(E|0)for(T=1;;){if(N=Dt(7,0,(15-T|0)*3|0)|0,!((N&g|0)==0&((be()|0)&y|0)==0))break e;if(T>>>0<E>>>0)T=T+1|0;else break}return Xh(O,E,0,5,b),N=0,me=B,N|0}while(!1);return OA(O,E,0,6,b),N=0,me=B,N|0}function Qx(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;if(E=St(g|0,y|0,45)|0,be()|0,!(In(E&127)|0))return E=2,A[b>>2]=E,0;if(E=St(g|0,y|0,52)|0,be()|0,E=E&15,!E)return E=5,A[b>>2]=E,0;for(T=1;;){if(O=Dt(7,0,(15-T|0)*3|0)|0,!((O&g|0)==0&((be()|0)&y|0)==0)){T=2,g=6;break}if(T>>>0<E>>>0)T=T+1|0;else{T=5,g=6;break}}return(g|0)==6&&(A[b>>2]=T),0}function Np(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0;_e=me,me=me+128|0,K=_e+112|0,O=_e+96|0,te=_e,E=St(g|0,y|0,52)|0,be()|0,N=E&15,A[K>>2]=N,B=St(g|0,y|0,45)|0,be()|0,B=B&127;e:do if(In(B)|0){if(N|0)for(T=1;;){if(G=Dt(7,0,(15-T|0)*3|0)|0,!((G&g|0)==0&((be()|0)&y|0)==0)){E=0;break e}if(T>>>0<N>>>0)T=T+1|0;else break}if(E&1)E=1;else return G=Dt(N+1|0,0,52)|0,te=be()|0|y&-15728641,K=Dt(7,0,(14-N|0)*3|0)|0,te=Np((G|g)&~K,te&~(be()|0),b)|0,me=_e,te|0}else E=0;while(!1);if(T=ar(g,y,O)|0,!T){E?(Cv(O,K,te),G=5):(DA(O,K,te),G=6);e:do if(In(B)|0)if(!N)g=5;else for(T=1;;){if(B=Dt(7,0,(15-T|0)*3|0)|0,!((B&g|0)==0&((be()|0)&y|0)==0)){g=2;break e}if(T>>>0<N>>>0)T=T+1|0;else{g=5;break}}else g=2;while(!1);ro(b|0,-1,g<<2|0)|0;e:do if(E)for(O=0;;){if(B=te+(O<<4)|0,Pv(B,A[K>>2]|0)|0,B=A[B>>2]|0,N=A[b>>2]|0,(N|0)==-1|(N|0)==(B|0))T=b;else{E=0;do{if(E=E+1|0,E>>>0>=g>>>0){T=1;break e}T=b+(E<<2)|0,N=A[T>>2]|0}while(!((N|0)==-1|(N|0)==(B|0)))}if(A[T>>2]=B,O=O+1|0,O>>>0>=G>>>0){T=0;break}}else for(O=0;;){if(B=te+(O<<4)|0,Zh(B,A[K>>2]|0,0,1)|0,B=A[B>>2]|0,N=A[b>>2]|0,(N|0)==-1|(N|0)==(B|0))T=b;else{E=0;do{if(E=E+1|0,E>>>0>=g>>>0){T=1;break e}T=b+(E<<2)|0,N=A[T>>2]|0}while(!((N|0)==-1|(N|0)==(B|0)))}if(A[T>>2]=B,O=O+1|0,O>>>0>=G>>>0){T=0;break}}while(!1)}return te=T,me=_e,te|0}function ed(){return 12}function vm(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0;if(g>>>0>15)return N=4,N|0;if(Dt(g|0,0,52)|0,N=be()|0|134225919,!g){b=0,T=0;do In(T)|0&&(Dt(T|0,0,45)|0,B=N|(be()|0),g=y+(b<<3)|0,A[g>>2]=-1,A[g+4>>2]=B,b=b+1|0),T=T+1|0;while((T|0)!=122);return b=0,b|0}b=0,B=0;do{if(In(B)|0){for(Dt(B|0,0,45)|0,T=1,E=-1,O=N|(be()|0);G=Dt(7,0,(15-T|0)*3|0)|0,E=E&~G,O=O&~(be()|0),(T|0)!=(g|0);)T=T+1|0;G=y+(b<<3)|0,A[G>>2]=E,A[G+4>>2]=O,b=b+1|0}B=B+1|0}while((B|0)!=122);return b=0,b|0}function Ri(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0;if(At=me,me=me+16|0,ot=At,wt=St(g|0,y|0,52)|0,be()|0,wt=wt&15,b>>>0>15)return wt=4,me=At,wt|0;if((wt|0)<(b|0))return wt=12,me=At,wt|0;if((wt|0)!=(b|0))if(O=Dt(b|0,0,52)|0,O=O|g,N=be()|0|y&-15728641,(wt|0)>(b|0)){G=b;do qe=Dt(7,0,(14-G|0)*3|0)|0,G=G+1|0,O=qe|O,N=be()|0|N;while((G|0)<(wt|0));qe=O}else qe=O;else qe=g,N=y;Ie=St(qe|0,N|0,45)|0,be()|0;e:do if(In(Ie&127)|0){if(G=St(qe|0,N|0,52)|0,be()|0,G=G&15,G|0)for(O=1;;){if(Ie=Dt(7,0,(15-O|0)*3|0)|0,!((Ie&qe|0)==0&((be()|0)&N|0)==0)){K=33;break e}if(O>>>0<G>>>0)O=O+1|0;else break}if(Ie=T,A[Ie>>2]=0,A[Ie+4>>2]=0,(wt|0)>(b|0)){for(Ie=y&-15728641,ke=wt;;){if(Ee=ke,ke=ke+-1|0,ke>>>0>15|(wt|0)<(ke|0)){K=19;break}if((wt|0)!=(ke|0))if(O=Dt(ke|0,0,52)|0,O=O|g,G=be()|0|Ie,(wt|0)<(Ee|0))_e=O;else{K=ke;do _e=Dt(7,0,(14-K|0)*3|0)|0,K=K+1|0,O=_e|O,G=be()|0|G;while((K|0)<(wt|0));_e=O}else _e=g,G=y;if(te=St(_e|0,G|0,45)|0,be()|0,!(In(te&127)|0))O=0;else{te=St(_e|0,G|0,52)|0,be()|0,te=te&15;t:do if(!te)O=0;else for(K=1;;){if(O=St(_e|0,G|0,(15-K|0)*3|0)|0,be()|0,O=O&7,O|0)break t;if(K>>>0<te>>>0)K=K+1|0;else{O=0;break}}while(!1);O=(O|0)==0&1}if(G=St(g|0,y|0,(15-Ee|0)*3|0)|0,be()|0,G=G&7,(G|0)==7){E=5,K=42;break}if(O=(O|0)!=0,(G|0)==1&O){E=5,K=42;break}if(_e=G+(((G|0)!=0&O)<<31>>31)|0,_e|0&&(K=wt-Ee|0,K=gn(7,0,K,((K|0)<0)<<31>>31)|0,te=be()|0,O?(O=Ar(K|0,te|0,5,0)|0,O=Ye(O|0,be()|0,-5,-1)|0,O=kt(O|0,be()|0,6,0)|0,O=Ye(O|0,be()|0,1,0)|0,G=be()|0):(O=K,G=te),Ee=_e+-1|0,Ee=Ar(K|0,te|0,Ee|0,((Ee|0)<0)<<31>>31|0)|0,Ee=Ye(O|0,G|0,Ee|0,be()|0)|0,_e=be()|0,te=T,te=Ye(Ee|0,_e|0,A[te>>2]|0,A[te+4>>2]|0)|0,_e=be()|0,Ee=T,A[Ee>>2]=te,A[Ee+4>>2]=_e),(ke|0)<=(b|0)){K=37;break}}if((K|0)==19)Ur(27795,27122,1276,27158);else if((K|0)==37){B=T,E=A[B+4>>2]|0,B=A[B>>2]|0;break}else if((K|0)==42)return me=At,E|0}else E=0,B=0}else K=33;while(!1);e:do if((K|0)==33)if(Ie=T,A[Ie>>2]=0,A[Ie+4>>2]=0,(wt|0)>(b|0)){for(O=wt;;){if(E=St(g|0,y|0,(15-O|0)*3|0)|0,be()|0,E=E&7,(E|0)==7){E=5;break}if(B=wt-O|0,B=gn(7,0,B,((B|0)<0)<<31>>31)|0,E=Ar(B|0,be()|0,E|0,0)|0,B=be()|0,Ie=T,B=Ye(A[Ie>>2]|0,A[Ie+4>>2]|0,E|0,B|0)|0,E=be()|0,Ie=T,A[Ie>>2]=B,A[Ie+4>>2]=E,O=O+-1|0,(O|0)<=(b|0))break e}return me=At,E|0}else E=0,B=0;while(!1);return Fp(qe,N,wt,ot)|0&&Ur(27795,27122,1236,27173),wt=ot,ot=A[wt+4>>2]|0,((E|0)>-1|(E|0)==-1&B>>>0>4294967295)&((ot|0)>(E|0)|((ot|0)==(E|0)?(A[wt>>2]|0)>>>0>B>>>0:0))?(wt=0,me=At,wt|0):(Ur(27795,27122,1316,27158),0)}function zp(g,y,b,T,E,O){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,O=O|0;var B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0;if(_e=me,me=me+16|0,B=_e,E>>>0>15)return O=4,me=_e,O|0;if(N=St(b|0,T|0,52)|0,be()|0,N=N&15,(N|0)>(E|0))return O=12,me=_e,O|0;if(Fp(b,T,E,B)|0&&Ur(27795,27122,1236,27173),te=B,K=A[te+4>>2]|0,!(((y|0)>-1|(y|0)==-1&g>>>0>4294967295)&((K|0)>(y|0)|((K|0)==(y|0)?(A[te>>2]|0)>>>0>g>>>0:0))))return O=2,me=_e,O|0;te=E-N|0,E=Dt(E|0,0,52)|0,G=be()|0|T&-15728641,K=O,A[K>>2]=E|b,A[K+4>>2]=G,K=St(b|0,T|0,45)|0,be()|0;e:do if(In(K&127)|0){if(N|0)for(B=1;;){if(K=Dt(7,0,(15-B|0)*3|0)|0,!((K&b|0)==0&((be()|0)&T|0)==0))break e;if(B>>>0<N>>>0)B=B+1|0;else break}if((te|0)<1)return O=0,me=_e,O|0;for(K=N^15,T=-1,G=1,B=1;;){N=te-G|0,N=gn(7,0,N,((N|0)<0)<<31>>31)|0,b=be()|0;do if(B)if(B=Ar(N|0,b|0,5,0)|0,B=Ye(B|0,be()|0,-5,-1)|0,B=kt(B|0,be()|0,6,0)|0,E=be()|0,(y|0)>(E|0)|(y|0)==(E|0)&g>>>0>B>>>0){y=Ye(g|0,y|0,-1,-1)|0,y=gt(y|0,be()|0,B|0,E|0)|0,B=be()|0,Ee=O,Ie=A[Ee>>2]|0,Ee=A[Ee+4>>2]|0,qe=(K+T|0)*3|0,ke=Dt(7,0,qe|0)|0,Ee=Ee&~(be()|0),T=kt(y|0,B|0,N|0,b|0)|0,g=be()|0,E=Ye(T|0,g|0,2,0)|0,qe=Dt(E|0,be()|0,qe|0)|0,Ee=be()|0|Ee,E=O,A[E>>2]=qe|Ie&~ke,A[E+4>>2]=Ee,g=Ar(T|0,g|0,N|0,b|0)|0,g=gt(y|0,B|0,g|0,be()|0)|0,B=0,y=be()|0;break}else{qe=O,ke=A[qe>>2]|0,qe=A[qe+4>>2]|0,Ie=Dt(7,0,(K+T|0)*3|0)|0,qe=qe&~(be()|0),B=O,A[B>>2]=ke&~Ie,A[B+4>>2]=qe,B=1;break}else ke=O,E=A[ke>>2]|0,ke=A[ke+4>>2]|0,T=(K+T|0)*3|0,Ee=Dt(7,0,T|0)|0,ke=ke&~(be()|0),qe=kt(g|0,y|0,N|0,b|0)|0,B=be()|0,T=Dt(qe|0,B|0,T|0)|0,ke=be()|0|ke,Ie=O,A[Ie>>2]=T|E&~Ee,A[Ie+4>>2]=ke,B=Ar(qe|0,B|0,N|0,b|0)|0,g=gt(g|0,y|0,B|0,be()|0)|0,B=0,y=be()|0;while(!1);if((te|0)>(G|0))T=~G,G=G+1|0;else{y=0;break}}return me=_e,y|0}while(!1);if((te|0)<1)return qe=0,me=_e,qe|0;for(E=N^15,B=1;;)if(Ie=te-B|0,Ie=gn(7,0,Ie,((Ie|0)<0)<<31>>31)|0,qe=be()|0,G=O,b=A[G>>2]|0,G=A[G+4>>2]|0,N=(E-B|0)*3|0,T=Dt(7,0,N|0)|0,G=G&~(be()|0),Ee=kt(g|0,y|0,Ie|0,qe|0)|0,ke=be()|0,N=Dt(Ee|0,ke|0,N|0)|0,G=be()|0|G,K=O,A[K>>2]=N|b&~T,A[K+4>>2]=G,qe=Ar(Ee|0,ke|0,Ie|0,qe|0)|0,g=gt(g|0,y|0,qe|0,be()|0)|0,y=be()|0,(te|0)<=(B|0)){y=0;break}else B=B+1|0;return me=_e,y|0}function NA(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0;E=St(y|0,b|0,52)|0,be()|0,E=E&15,(y|0)==0&(b|0)==0|((T|0)>15|(E|0)>(T|0))?(O=-1,y=-1,b=0,E=0):(y=_f(y,b,E+1|0,T)|0,B=(be()|0)&-15728641,b=Dt(T|0,0,52)|0,b=y|b,B=B|(be()|0),y=(En(b,B)|0)==0,O=E,y=y?-1:T,E=B),B=g,A[B>>2]=b,A[B+4>>2]=E,A[g+8>>2]=O,A[g+12>>2]=y}function bm(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0;if(E=St(g|0,y|0,52)|0,be()|0,E=E&15,O=T+8|0,A[O>>2]=E,(g|0)==0&(y|0)==0|((b|0)>15|(E|0)>(b|0))){b=T,A[b>>2]=0,A[b+4>>2]=0,A[O>>2]=-1,A[T+12>>2]=-1;return}if(g=_f(g,y,E+1|0,b)|0,O=(be()|0)&-15728641,E=Dt(b|0,0,52)|0,E=g|E,O=O|(be()|0),g=T,A[g>>2]=E,A[g+4>>2]=O,g=T+12|0,En(E,O)|0){A[g>>2]=b;return}else{A[g>>2]=-1;return}}function zA(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0;if(b=g,y=A[b>>2]|0,b=A[b+4>>2]|0,!((y|0)==0&(b|0)==0)&&(T=St(y|0,b|0,52)|0,be()|0,T=T&15,N=Dt(1,0,(T^15)*3|0)|0,y=Ye(N|0,be()|0,y|0,b|0)|0,b=be()|0,N=g,A[N>>2]=y,A[N+4>>2]=b,N=g+8|0,B=A[N>>2]|0,!((T|0)<(B|0)))){for(G=g+12|0,O=T;;){if((O|0)==(B|0)){T=5;break}if(K=(O|0)==(A[G>>2]|0),E=(15-O|0)*3|0,T=St(y|0,b|0,E|0)|0,be()|0,T=T&7,K&((T|0)==1&!0)){T=7;break}if(!((T|0)==7&!0)){T=10;break}if(K=Dt(1,0,E|0)|0,y=Ye(y|0,b|0,K|0,be()|0)|0,b=be()|0,K=g,A[K>>2]=y,A[K+4>>2]=b,(O|0)>(B|0))O=O+-1|0;else{T=10;break}}if((T|0)==5){K=g,A[K>>2]=0,A[K+4>>2]=0,A[N>>2]=-1,A[G>>2]=-1;return}else if((T|0)==7){B=Dt(1,0,E|0)|0,B=Ye(y|0,b|0,B|0,be()|0)|0,N=be()|0,K=g,A[K>>2]=B,A[K+4>>2]=N,A[G>>2]=O+-1;return}else if((T|0)==10)return}}function Up(g){g=+g;var y=0;return y=g<0?g+6.283185307179586:g,+(g>=6.283185307179586?y+-6.283185307179586:y)}function Ju(g,y){return g=g|0,y=y|0,+qi(+(+de[g>>3]-+de[y>>3]))<17453292519943298e-27?(y=+qi(+(+de[g+8>>3]-+de[y+8>>3]))<17453292519943298e-27,y|0):(y=0,y|0)}function ha(g,y){switch(g=+g,y=y|0,y|0){case 1:{g=g<0?g+6.283185307179586:g;break}case 2:{g=g>0?g+-6.283185307179586:g;break}default:}return+g}function Jx(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0;return E=+de[y>>3],T=+de[g>>3],O=+Yi(+((E-T)*.5)),b=+Yi(+((+de[y+8>>3]-+de[g+8>>3])*.5)),b=O*O+b*(+en(+E)*+en(+T)*b),+(+Da(+ +Kn(+b),+ +Kn(+(1-b)))*2)}function Vp(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0;return E=+de[y>>3],T=+de[g>>3],O=+Yi(+((E-T)*.5)),b=+Yi(+((+de[y+8>>3]-+de[g+8>>3])*.5)),b=O*O+b*(+en(+E)*+en(+T)*b),+(+Da(+ +Kn(+b),+ +Kn(+(1-b)))*2*6371.007180918475)}function ew(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0;return E=+de[y>>3],T=+de[g>>3],O=+Yi(+((E-T)*.5)),b=+Yi(+((+de[y+8>>3]-+de[g+8>>3])*.5)),b=O*O+b*(+en(+E)*+en(+T)*b),+(+Da(+ +Kn(+b),+ +Kn(+(1-b)))*2*6371.007180918475*1e3)}function tw(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0;return O=+de[y>>3],T=+en(+O),E=+de[y+8>>3]-+de[g+8>>3],B=T*+Yi(+E),b=+de[g>>3],+ +Da(+B,+(+Yi(+O)*+en(+b)-+en(+E)*(T*+Yi(+b))))}function V4(g,y,b,T){g=g|0,y=+y,b=+b,T=T|0;var E=0,O=0,B=0,N=0;if(b<1e-16){A[T>>2]=A[g>>2],A[T+4>>2]=A[g+4>>2],A[T+8>>2]=A[g+8>>2],A[T+12>>2]=A[g+12>>2];return}O=y<0?y+6.283185307179586:y,O=y>=6.283185307179586?O+-6.283185307179586:O;do if(O<1e-16)y=+de[g>>3]+b,de[T>>3]=y,E=T;else{if(E=+qi(+(O+-3.141592653589793))<1e-16,y=+de[g>>3],E){y=y-b,de[T>>3]=y,E=T;break}if(B=+en(+b),b=+Yi(+b),y=B*+Yi(+y)+ +en(+O)*(b*+en(+y)),y=y>1?1:y,y=+zx(+(y<-1?-1:y)),de[T>>3]=y,+qi(+(y+-1.5707963267948966))<1e-16){de[T>>3]=1.5707963267948966,de[T+8>>3]=0;return}if(+qi(+(y+1.5707963267948966))<1e-16){de[T>>3]=-1.5707963267948966,de[T+8>>3]=0;return}if(N=1/+en(+y),O=b*+Yi(+O)*N,b=+de[g>>3],y=N*((B-+Yi(+y)*+Yi(+b))/+en(+b)),B=O>1?1:O,y=y>1?1:y,y=+de[g+8>>3]+ +Da(+(B<-1?-1:B),+(y<-1?-1:y)),y>3.141592653589793)do y=y+-6.283185307179586;while(y>3.141592653589793);if(y<-3.141592653589793)do y=y+6.283185307179586;while(y<-3.141592653589793);de[T+8>>3]=y;return}while(!1);if(+qi(+(y+-1.5707963267948966))<1e-16){de[E>>3]=1.5707963267948966,de[T+8>>3]=0;return}if(+qi(+(y+1.5707963267948966))<1e-16){de[E>>3]=-1.5707963267948966,de[T+8>>3]=0;return}if(y=+de[g+8>>3],y>3.141592653589793)do y=y+-6.283185307179586;while(y>3.141592653589793);if(y<-3.141592653589793)do y=y+6.283185307179586;while(y<-3.141592653589793);de[T+8>>3]=y}function lu(g,y){return g=g|0,y=y|0,g>>>0>15?(y=4,y|0):(de[y>>3]=+de[20656+(g<<3)>>3],y=0,y|0)}function Cn(g,y){return g=g|0,y=y|0,g>>>0>15?(y=4,y|0):(de[y>>3]=+de[20784+(g<<3)>>3],y=0,y|0)}function j4(g,y){return g=g|0,y=y|0,g>>>0>15?(y=4,y|0):(de[y>>3]=+de[20912+(g<<3)>>3],y=0,y|0)}function UA(g,y){return g=g|0,y=y|0,g>>>0>15?(y=4,y|0):(de[y>>3]=+de[21040+(g<<3)>>3],y=0,y|0)}function vf(g,y){g=g|0,y=y|0;var b=0;return g>>>0>15?(y=4,y|0):(b=gn(7,0,g,((g|0)<0)<<31>>31)|0,b=Ar(b|0,be()|0,120,0)|0,g=be()|0,A[y>>2]=b|2,A[y+4>>2]=g,y=0,y|0)}function VA(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0;return Ee=+de[y>>3],te=+de[g>>3],G=+Yi(+((Ee-te)*.5)),O=+de[y+8>>3],K=+de[g+8>>3],B=+Yi(+((O-K)*.5)),N=+en(+te),_e=+en(+Ee),B=G*G+B*(_e*N*B),B=+Da(+ +Kn(+B),+ +Kn(+(1-B)))*2,G=+de[b>>3],Ee=+Yi(+((G-Ee)*.5)),T=+de[b+8>>3],O=+Yi(+((T-O)*.5)),E=+en(+G),O=Ee*Ee+O*(_e*E*O),O=+Da(+ +Kn(+O),+ +Kn(+(1-O)))*2,G=+Yi(+((te-G)*.5)),T=+Yi(+((K-T)*.5)),T=G*G+T*(N*E*T),T=+Da(+ +Kn(+T),+ +Kn(+(1-T)))*2,E=(B+O+T)*.5,+(+dm(+ +Kn(+(+hm(+(E*.5))*+hm(+((E-B)*.5))*+hm(+((E-O)*.5))*+hm(+((E-T)*.5)))))*4)}function xm(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0;if(N=me,me=me+192|0,O=N+168|0,B=N,E=Jh(g,y,O)|0,E|0)return b=E,me=N,b|0;if(Ql(g,y,B)|0&&Ur(27795,27190,415,27199),y=A[B>>2]|0,(y|0)>0){if(T=+VA(B+8|0,B+8+(((y|0)!=1&1)<<4)|0,O)+0,(y|0)!=1){g=1;do E=g,g=g+1|0,T=T+ +VA(B+8+(E<<4)|0,B+8+(((g|0)%(y|0)|0)<<4)|0,O);while((g|0)<(y|0))}}else T=0;return de[b>>3]=T,b=0,me=N,b|0}function Ov(g,y,b){return g=g|0,y=y|0,b=b|0,g=xm(g,y,b)|0,g|0||(de[b>>3]=+de[b>>3]*6371.007180918475*6371.007180918475),g|0}function jA(g,y,b){return g=g|0,y=y|0,b=b|0,g=xm(g,y,b)|0,g|0||(de[b>>3]=+de[b>>3]*6371.007180918475*6371.007180918475*1e3*1e3),g|0}function cu(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(N=me,me=me+176|0,B=N,g=Dp(g,y,B)|0,g|0)return B=g,me=N,B|0;if(de[b>>3]=0,g=A[B>>2]|0,(g|0)<=1)return B=0,me=N,B|0;y=g+-1|0,g=0,T=+de[B+8>>3],E=+de[B+16>>3],O=0;do g=g+1|0,K=T,T=+de[B+8+(g<<4)>>3],te=+Yi(+((T-K)*.5)),G=E,E=+de[B+8+(g<<4)+8>>3],G=+Yi(+((E-G)*.5)),G=te*te+G*(+en(+T)*+en(+K)*G),O=O+ +Da(+ +Kn(+G),+ +Kn(+(1-G)))*2;while((g|0)<(y|0));return de[b>>3]=O,B=0,me=N,B|0}function jp(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(N=me,me=me+176|0,B=N,g=Dp(g,y,B)|0,g|0)return B=g,O=+de[b>>3],O=O*6371.007180918475,de[b>>3]=O,me=N,B|0;if(de[b>>3]=0,g=A[B>>2]|0,(g|0)<=1)return B=0,O=0,O=O*6371.007180918475,de[b>>3]=O,me=N,B|0;y=g+-1|0,g=0,T=+de[B+8>>3],E=+de[B+16>>3],O=0;do g=g+1|0,K=T,T=+de[B+8+(g<<4)>>3],te=+Yi(+((T-K)*.5)),G=E,E=+de[B+8+(g<<4)+8>>3],G=+Yi(+((E-G)*.5)),G=te*te+G*(+en(+K)*+en(+T)*G),O=O+ +Da(+ +Kn(+G),+ +Kn(+(1-G)))*2;while((g|0)!=(y|0));return de[b>>3]=O,B=0,te=O,te=te*6371.007180918475,de[b>>3]=te,me=N,B|0}function _r(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(N=me,me=me+176|0,B=N,g=Dp(g,y,B)|0,g|0)return B=g,O=+de[b>>3],O=O*6371.007180918475,O=O*1e3,de[b>>3]=O,me=N,B|0;if(de[b>>3]=0,g=A[B>>2]|0,(g|0)<=1)return B=0,O=0,O=O*6371.007180918475,O=O*1e3,de[b>>3]=O,me=N,B|0;y=g+-1|0,g=0,T=+de[B+8>>3],E=+de[B+16>>3],O=0;do g=g+1|0,K=T,T=+de[B+8+(g<<4)>>3],te=+Yi(+((T-K)*.5)),G=E,E=+de[B+8+(g<<4)+8>>3],G=+Yi(+((E-G)*.5)),G=te*te+G*(+en(+K)*+en(+T)*G),O=O+ +Da(+ +Kn(+G),+ +Kn(+(1-G)))*2;while((g|0)!=(y|0));return de[b>>3]=O,B=0,te=O,te=te*6371.007180918475,te=te*1e3,de[b>>3]=te,me=N,B|0}function Lr(g){g=g|0;var y=0,b=0,T=0;return y=ct(1,12)|0,y||Ur(27280,27235,49,27293),b=g+4|0,T=A[b>>2]|0,T|0?(T=T+8|0,A[T>>2]=y,A[b>>2]=y,y|0):(A[g>>2]|0&&Ur(27310,27235,61,27333),T=g,A[T>>2]=y,A[b>>2]=y,y|0)}function $p(g,y){g=g|0,y=y|0;var b=0,T=0;return T=et(24)|0,T||Ur(27347,27235,78,27361),A[T>>2]=A[y>>2],A[T+4>>2]=A[y+4>>2],A[T+8>>2]=A[y+8>>2],A[T+12>>2]=A[y+12>>2],A[T+16>>2]=0,y=g+4|0,b=A[y>>2]|0,b|0?(A[b+16>>2]=T,A[y>>2]=T,T|0):(A[g>>2]|0&&Ur(27376,27235,82,27361),A[g>>2]=T,A[y>>2]=T,T|0)}function $A(g){g=g|0;var y=0,b=0,T=0,E=0;if(g)for(T=1;;){if(y=A[g>>2]|0,y|0)do{if(b=A[y>>2]|0,b|0)do E=b,b=A[b+16>>2]|0,Ke(E);while((b|0)!=0);E=y,y=A[y+8>>2]|0,Ke(E)}while((y|0)!=0);if(y=g,g=A[g+8>>2]|0,T||Ke(y),g)T=0;else break}}function wm(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0,Nr=0,Ai=0,Wr=0,kr=0,qt=0,Ci=0,Sn=0,yi=0;if(E=g+8|0,A[E>>2]|0)return yi=1,yi|0;if(T=A[g>>2]|0,!T)return yi=0,yi|0;y=T,b=0;do b=b+1|0,y=A[y+8>>2]|0;while((y|0)!=0);if(b>>>0<2)return yi=0,yi|0;Ci=et(b<<2)|0,Ci||Ur(27396,27235,317,27415),qt=et(b<<5)|0,qt||Ur(27437,27235,321,27415),A[g>>2]=0,Mr=g+4|0,A[Mr>>2]=0,A[E>>2]=0,b=0,kr=0,Yt=0,_e=0;e:for(;;){if(te=A[T>>2]|0,te){O=0,B=te;do{if(G=+de[B+8>>3],y=B,B=A[B+16>>2]|0,K=(B|0)==0,E=K?te:B,N=+de[E+8>>3],+qi(+(G-N))>3.141592653589793){yi=14;break}O=O+(N-G)*(+de[y>>3]+ +de[E>>3])}while(!K);if((yi|0)==14){yi=0,O=0,y=te;do Xe=+de[y+8>>3],Wr=y+16|0,Ai=A[Wr>>2]|0,Ai=(Ai|0)==0?te:Ai,ut=+de[Ai+8>>3],O=O+(+de[y>>3]+ +de[Ai>>3])*((ut<0?ut+6.283185307179586:ut)-(Xe<0?Xe+6.283185307179586:Xe)),y=A[((y|0)==0?T:Wr)>>2]|0;while((y|0)!=0)}O>0?(A[Ci+(kr<<2)>>2]=T,kr=kr+1|0,E=Yt,y=_e):yi=19}else yi=19;if((yi|0)==19){yi=0;do if(b){if(y=b+8|0,A[y>>2]|0){yi=21;break e}if(b=ct(1,12)|0,!b){yi=23;break e}A[y>>2]=b,E=b+4|0,B=b,y=_e}else if(_e){E=Mr,B=_e+8|0,y=T,b=g;break}else if(A[g>>2]|0){yi=27;break e}else{E=Mr,B=g,y=T,b=g;break}while(!1);if(A[B>>2]=T,A[E>>2]=T,B=qt+(Yt<<5)|0,K=A[T>>2]|0,K){for(te=qt+(Yt<<5)+8|0,de[te>>3]=17976931348623157e292,_e=qt+(Yt<<5)+24|0,de[_e>>3]=17976931348623157e292,de[B>>3]=-17976931348623157e292,Ee=qt+(Yt<<5)+16|0,de[Ee>>3]=-17976931348623157e292,wt=17976931348623157e292,At=-17976931348623157e292,E=0,ke=K,G=17976931348623157e292,qe=17976931348623157e292,ot=-17976931348623157e292,N=-17976931348623157e292;O=+de[ke>>3],Xe=+de[ke+8>>3],ke=A[ke+16>>2]|0,Ie=(ke|0)==0,ut=+de[(Ie?K:ke)+8>>3],O<G&&(de[te>>3]=O,G=O),Xe<qe&&(de[_e>>3]=Xe,qe=Xe),O>ot?de[B>>3]=O:O=ot,Xe>N&&(de[Ee>>3]=Xe,N=Xe),wt=Xe>0&Xe<wt?Xe:wt,At=Xe<0&Xe>At?Xe:At,E=E|+qi(+(Xe-ut))>3.141592653589793,!Ie;)ot=O;E&&(de[Ee>>3]=At,de[_e>>3]=wt)}else A[B>>2]=0,A[B+4>>2]=0,A[B+8>>2]=0,A[B+12>>2]=0,A[B+16>>2]=0,A[B+20>>2]=0,A[B+24>>2]=0,A[B+28>>2]=0;E=Yt+1|0}if(Wr=T+8|0,T=A[Wr>>2]|0,A[Wr>>2]=0,T)Yt=E,_e=y;else{yi=45;break}}if((yi|0)==21)Ur(27213,27235,35,27247);else if((yi|0)==23)Ur(27267,27235,37,27247);else if((yi|0)==27)Ur(27310,27235,61,27333);else if((yi|0)==45){e:do if((kr|0)>0){for(Wr=(E|0)==0,Nr=E<<2,Ai=(g|0)==0,Qr=0,y=0;;){if(dr=A[Ci+(Qr<<2)>>2]|0,Wr)yi=73;else{if(Yt=et(Nr)|0,!Yt){yi=50;break}if(Mr=et(Nr)|0,!Mr){yi=52;break}t:do if(Ai)b=0;else{for(E=0,b=0,B=g;T=qt+(E<<5)|0,da(A[B>>2]|0,T,A[dr>>2]|0)|0?(A[Yt+(b<<2)>>2]=B,A[Mr+(b<<2)>>2]=T,Ie=b+1|0):Ie=b,B=A[B+8>>2]|0,B;)E=E+1|0,b=Ie;if((Ie|0)>0)if(T=A[Yt>>2]|0,(Ie|0)==1)b=T;else for(Ee=0,ke=-1,b=T,_e=T;;){for(K=A[_e>>2]|0,T=0,B=0;E=A[A[Yt+(B<<2)>>2]>>2]|0,(E|0)==(K|0)?te=T:te=T+((da(E,A[Mr+(B<<2)>>2]|0,A[K>>2]|0)|0)&1)|0,B=B+1|0,(B|0)!=(Ie|0);)T=te;if(E=(te|0)>(ke|0),b=E?_e:b,T=Ee+1|0,(T|0)==(Ie|0))break t;Ee=T,ke=E?te:ke,_e=A[Yt+(T<<2)>>2]|0}else b=0}while(!1);if(Ke(Yt),Ke(Mr),b){if(E=b+4|0,T=A[E>>2]|0,T)b=T+8|0;else if(A[b>>2]|0){yi=70;break}A[b>>2]=dr,A[E>>2]=dr}else yi=73}if((yi|0)==73){if(yi=0,y=A[dr>>2]|0,y|0)do Mr=y,y=A[y+16>>2]|0,Ke(Mr);while((y|0)!=0);Ke(dr),y=1}if(Qr=Qr+1|0,(Qr|0)>=(kr|0)){Sn=y;break e}}(yi|0)==50?Ur(27452,27235,249,27471):(yi|0)==52?Ur(27490,27235,252,27471):(yi|0)==70&&Ur(27310,27235,61,27333)}else Sn=0;while(!1);return Ke(Ci),Ke(qt),yi=Sn,yi|0}return 0}function da(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(!(Pp(y,b)|0)||(y=pm(y)|0,T=+de[b>>3],E=+de[b+8>>3],E=y&E<0?E+6.283185307179586:E,g=A[g>>2]|0,!g))return g=0,g|0;if(y){y=0,K=E,b=g;e:for(;;){for(;B=+de[b>>3],E=+de[b+8>>3],b=b+16|0,te=A[b>>2]|0,te=(te|0)==0?g:te,O=+de[te>>3],N=+de[te+8>>3],B>O?(G=B,B=N):(G=O,O=B,B=E,E=N),T=T==O|T==G?T+2220446049250313e-31:T,!!(T<O|T>G);)if(b=A[b>>2]|0,!b){b=22;break e}if(N=B<0?B+6.283185307179586:B,B=E<0?E+6.283185307179586:E,K=N==K|B==K?K+-2220446049250313e-31:K,G=N+(B-N)*((T-O)/(G-O)),(G<0?G+6.283185307179586:G)>K&&(y=y^1),b=A[b>>2]|0,!b){b=22;break}}if((b|0)==22)return y|0}else{y=0,K=E,b=g;e:for(;;){for(;B=+de[b>>3],E=+de[b+8>>3],b=b+16|0,te=A[b>>2]|0,te=(te|0)==0?g:te,O=+de[te>>3],N=+de[te+8>>3],B>O?(G=B,B=N):(G=O,O=B,B=E,E=N),T=T==O|T==G?T+2220446049250313e-31:T,!!(T<O|T>G);)if(b=A[b>>2]|0,!b){b=22;break e}if(K=B==K|E==K?K+-2220446049250313e-31:K,B+(E-B)*((T-O)/(G-O))>K&&(y=y^1),b=A[b>>2]|0,!b){b=22;break}}if((b|0)==22)return y|0}return 0}function uu(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0;if(At=me,me=me+32|0,wt=At+16|0,ot=At,O=St(g|0,y|0,52)|0,be()|0,O=O&15,ke=St(b|0,T|0,52)|0,be()|0,(O|0)!=(ke&15|0))return wt=12,me=At,wt|0;if(K=St(g|0,y|0,45)|0,be()|0,K=K&127,te=St(b|0,T|0,45)|0,be()|0,te=te&127,K>>>0>121|te>>>0>121)return wt=5,me=At,wt|0;if(ke=(K|0)!=(te|0),ke){if(N=_A(K,te)|0,(N|0)==7)return wt=1,me=At,wt|0;G=_A(te,K)|0,(G|0)==7?Ur(27514,27538,161,27548):(Ie=N,B=G)}else Ie=0,B=0;_e=In(K)|0,Ee=In(te)|0,A[wt>>2]=0,A[wt+4>>2]=0,A[wt+8>>2]=0,A[wt+12>>2]=0;do if(Ie){if(te=A[4272+(K*28|0)+(Ie<<2)>>2]|0,N=(te|0)>0,Ee)if(N){K=0,G=b,N=T;do G=Iv(G,N)|0,N=be()|0,B=Ku(B)|0,(B|0)==1&&(B=Ku(1)|0),K=K+1|0;while((K|0)!=(te|0));te=B,K=G,G=N}else te=B,K=b,G=T;else if(N){K=0,G=b,N=T;do G=kv(G,N)|0,N=be()|0,B=Ku(B)|0,K=K+1|0;while((K|0)!=(te|0));te=B,K=G,G=N}else te=B,K=b,G=T;if(Mc(K,G,wt)|0,ke||Ur(27563,27538,191,27548),N=(_e|0)!=0,B=(Ee|0)!=0,N&B&&Ur(27590,27538,192,27548),N){if(B=po(g,y)|0,(B|0)==7){O=5;break}if(zt[22e3+(B*7|0)+Ie>>0]|0){O=1;break}G=A[21168+(B*28|0)+(Ie<<2)>>2]|0,K=G}else if(B){if(B=po(K,G)|0,(B|0)==7){O=5;break}if(zt[22e3+(B*7|0)+te>>0]|0){O=1;break}K=0,G=A[21168+(te*28|0)+(B<<2)>>2]|0}else K=0,G=0;if((K|G|0)<0)O=5;else{if((G|0)>0){N=wt+4|0,B=0;do Zu(N),B=B+1|0;while((B|0)!=(G|0))}if(A[ot>>2]=0,A[ot+4>>2]=0,A[ot+8>>2]=0,Rp(ot,Ie),O|0)for(;wl(O)|0?Am(ot):Sc(ot),(O|0)>1;)O=O+-1|0;if((K|0)>0){O=0;do Zu(ot),O=O+1|0;while((O|0)!=(K|0))}qe=wt+4|0,La(qe,ot,qe),es(qe),qe=51}}else if(Mc(b,T,wt)|0,(_e|0)!=0&(Ee|0)!=0)if((te|0)!=(K|0)&&Ur(27621,27538,261,27548),B=po(g,y)|0,O=po(b,T)|0,(B|0)==7|(O|0)==7)O=5;else if(zt[22e3+(B*7|0)+O>>0]|0)O=1;else if(B=A[21168+(B*28|0)+(O<<2)>>2]|0,(B|0)>0){N=wt+4|0,O=0;do Zu(N),O=O+1|0;while((O|0)!=(B|0));qe=51}else qe=51;else qe=51;while(!1);return(qe|0)==51&&(O=wt+4|0,A[E>>2]=A[O>>2],A[E+4>>2]=A[O+4>>2],A[E+8>>2]=A[O+8>>2],O=0),wt=O,me=At,wt|0}function Jl(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0;if(qe=me,me=me+48|0,K=qe+36|0,B=qe+24|0,N=qe+12|0,G=qe,E=St(g|0,y|0,52)|0,be()|0,E=E&15,Ee=St(g|0,y|0,45)|0,be()|0,Ee=Ee&127,Ee>>>0>121)return T=5,me=qe,T|0;if(te=In(Ee)|0,Dt(E|0,0,52)|0,ot=be()|0|134225919,O=T,A[O>>2]=-1,A[O+4>>2]=ot,!E)return E=mf(b)|0,(E|0)==7||(E=yA(Ee,E)|0,(E|0)==127)?(ot=1,me=qe,ot|0):(ke=Dt(E|0,0,45)|0,Ie=be()|0,Ee=T,Ie=A[Ee+4>>2]&-1040385|Ie,ot=T,A[ot>>2]=A[Ee>>2]|ke,A[ot+4>>2]=Ie,ot=0,me=qe,ot|0);for(A[K>>2]=A[b>>2],A[K+4>>2]=A[b+4>>2],A[K+8>>2]=A[b+8>>2],b=E;;){if(O=b,b=b+-1|0,A[B>>2]=A[K>>2],A[B+4>>2]=A[K+4>>2],A[B+8>>2]=A[K+8>>2],wl(O)|0){if(E=SA(K)|0,E|0){b=13;break}A[N>>2]=A[K>>2],A[N+4>>2]=A[K+4>>2],A[N+8>>2]=A[K+8>>2],Am(N)}else{if(E=TA(K)|0,E|0){b=13;break}A[N>>2]=A[K>>2],A[N+4>>2]=A[K+4>>2],A[N+8>>2]=A[K+8>>2],Sc(N)}if(wA(B,N,G),es(G),E=T,At=A[E>>2]|0,E=A[E+4>>2]|0,ut=(15-O|0)*3|0,wt=Dt(7,0,ut|0)|0,E=E&~(be()|0),ut=Dt(mf(G)|0,0,ut|0)|0,E=be()|0|E,ot=T,A[ot>>2]=ut|At&~wt,A[ot+4>>2]=E,(O|0)<=1){b=14;break}}e:do if((b|0)!=13&&(b|0)==14)if((A[K>>2]|0)<=1&&(A[K+4>>2]|0)<=1&&(A[K+8>>2]|0)<=1){b=mf(K)|0,E=yA(Ee,b)|0,(E|0)==127?G=0:G=In(E)|0;t:do if(b){if(te){if(E=po(g,y)|0,(E|0)==7){E=5;break e}if(O=A[21376+(E*28|0)+(b<<2)>>2]|0,(O|0)>0){E=b,b=0;do E=au(E)|0,b=b+1|0;while((b|0)!=(O|0))}else E=b;if((E|0)==1){E=9;break e}b=yA(Ee,E)|0,(b|0)==127&&Ur(27648,27538,411,27678),In(b)|0?Ur(27693,27538,412,27678):(Ie=b,ke=O,_e=E)}else Ie=E,ke=0,_e=b;if(N=A[4272+(Ee*28|0)+(_e<<2)>>2]|0,(N|0)<=-1&&Ur(27724,27538,419,27678),!G){if((ke|0)<0){E=5;break e}if(ke|0){O=T,E=0,b=A[O>>2]|0,O=A[O+4>>2]|0;do b=Qh(b,O)|0,O=be()|0,ut=T,A[ut>>2]=b,A[ut+4>>2]=O,E=E+1|0;while((E|0)<(ke|0))}if((N|0)<=0){E=Ie,b=58;break}for(O=T,E=0,b=A[O>>2]|0,O=A[O+4>>2]|0;;)if(b=Qh(b,O)|0,O=be()|0,ut=T,A[ut>>2]=b,A[ut+4>>2]=O,E=E+1|0,(E|0)==(N|0)){E=Ie,b=58;break t}}if(B=_A(Ie,Ee)|0,(B|0)==7&&Ur(27514,27538,428,27678),E=T,b=A[E>>2]|0,E=A[E+4>>2]|0,(N|0)>0){O=0;do b=Qh(b,E)|0,E=be()|0,ut=T,A[ut>>2]=b,A[ut+4>>2]=E,O=O+1|0;while((O|0)!=(N|0))}if(E=po(b,E)|0,(E|0)==7&&Ur(27795,27538,440,27678),b=Ep(Ie)|0,b=A[(b?21792:21584)+(B*28|0)+(E<<2)>>2]|0,(b|0)<0&&Ur(27795,27538,454,27678),!b)E=Ie,b=58;else{B=T,E=0,O=A[B>>2]|0,B=A[B+4>>2]|0;do O=Kl(O,B)|0,B=be()|0,ut=T,A[ut>>2]=O,A[ut+4>>2]=B,E=E+1|0;while((E|0)<(b|0));E=Ie,b=58}}else if((te|0)!=0&(G|0)!=0){if(b=po(g,y)|0,O=T,O=po(A[O>>2]|0,A[O+4>>2]|0)|0,(b|0)==7|(O|0)==7){E=5;break e}if(O=A[21376+(b*28|0)+(O<<2)>>2]|0,(O|0)<0){E=5;break e}if(!O)b=59;else{N=T,b=0,B=A[N>>2]|0,N=A[N+4>>2]|0;do B=Qh(B,N)|0,N=be()|0,ut=T,A[ut>>2]=B,A[ut+4>>2]=N,b=b+1|0;while((b|0)<(O|0));b=58}}else b=58;while(!1);if((b|0)==58&&G&&(b=59),(b|0)==59&&(ut=T,(po(A[ut>>2]|0,A[ut+4>>2]|0)|0)==1)){E=9;break}ut=T,wt=A[ut>>2]|0,ut=A[ut+4>>2]&-1040385,At=Dt(E|0,0,45)|0,ut=ut|(be()|0),E=T,A[E>>2]=wt|At,A[E+4>>2]=ut,E=0}else E=1;while(!1);return ut=E,me=qe,ut|0}function rw(g,y,b,T,E,O){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,O=O|0;var B=0,N=0;return N=me,me=me+16|0,B=N,E?g=15:(g=uu(g,y,b,T,B)|0,g||(PA(B,O),g=0)),me=N,g|0}function $4(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0;return B=me,me=me+16|0,O=B,T?b=15:(b=Tv(b,O)|0,b||(b=Jl(g,y,O,E)|0)),me=B,b|0}function Wp(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0;return G=me,me=me+32|0,B=G+12|0,N=G,O=uu(g,y,g,y,B)|0,O|0?(N=O,me=G,N|0):(g=uu(g,y,b,T,N)|0,g|0?(N=g,me=G,N|0):(B=CA(B,N)|0,N=E,A[N>>2]=B,A[N+4>>2]=((B|0)<0)<<31>>31,N=0,me=G,N|0))}function W4(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0;return G=me,me=me+32|0,B=G+12|0,N=G,O=uu(g,y,g,y,B)|0,!O&&(O=uu(g,y,b,T,N)|0,!O)?(T=CA(B,N)|0,T=Ye(T|0,((T|0)<0)<<31>>31|0,1,0)|0,B=be()|0,N=E,A[N>>2]=T,A[N+4>>2]=B,N=0,me=G,N|0):(N=O,me=G,N|0)}function Sm(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0;if(dr=me,me=me+48|0,Yt=dr+24|0,B=dr+12|0,Mr=dr,O=uu(g,y,g,y,Yt)|0,!O&&(O=uu(g,y,b,T,B)|0,!O)){ut=CA(Yt,B)|0,Xe=((ut|0)<0)<<31>>31,A[Yt>>2]=0,A[Yt+4>>2]=0,A[Yt+8>>2]=0,A[B>>2]=0,A[B+4>>2]=0,A[B+8>>2]=0,uu(g,y,g,y,Yt)|0&&Ur(27795,27538,692,27747),uu(g,y,b,T,B)|0&&Ur(27795,27538,697,27747),IA(Yt),IA(B),te=(ut|0)==0?0:1/+(ut|0),b=A[Yt>>2]|0,qe=te*+((A[B>>2]|0)-b|0),ot=Yt+4|0,T=A[ot>>2]|0,wt=te*+((A[B+4>>2]|0)-T|0),At=Yt+8|0,O=A[At>>2]|0,te=te*+((A[B+8>>2]|0)-O|0),A[Mr>>2]=b,_e=Mr+4|0,A[_e>>2]=T,Ee=Mr+8|0,A[Ee>>2]=O;e:do if((ut|0)<0)O=0;else for(ke=0,Ie=0;;){G=+(Ie>>>0)+4294967296*+(ke|0),Qr=qe*G+ +(b|0),N=wt*G+ +(T|0),G=te*G+ +(O|0),b=~~+to(+Qr),B=~~+to(+N),O=~~+to(+G),Qr=+qi(+(+(b|0)-Qr)),N=+qi(+(+(B|0)-N)),G=+qi(+(+(O|0)-G));do if(Qr>N&Qr>G)b=0-(B+O)|0,T=B;else if(K=0-b|0,N>G){T=K-O|0;break}else{T=B,O=K-B|0;break}while(!1);if(A[Mr>>2]=b,A[_e>>2]=T,A[Ee>>2]=O,Mv(Mr),O=Jl(g,y,Mr,E+(Ie<<3)|0)|0,O|0)break e;if(!((ke|0)<(Xe|0)|(ke|0)==(Xe|0)&Ie>>>0<ut>>>0)){O=0;break e}b=Ye(Ie|0,ke|0,1,0)|0,T=be()|0,ke=T,Ie=b,b=A[Yt>>2]|0,T=A[ot>>2]|0,O=A[At>>2]|0}while(!1);return Mr=O,me=dr,Mr|0}return Mr=O,me=dr,Mr|0}function gn(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0;if((b|0)==0&(T|0)==0)return E=0,O=1,si(E|0),O|0;O=g,E=y,g=1,y=0;do B=(b&1|0)==0&!0,g=Ar((B?1:O)|0,(B?0:E)|0,g|0,y|0)|0,y=be()|0,b=kn(b|0,T|0,1)|0,T=be()|0,O=Ar(O|0,E|0,O|0,E|0)|0,E=be()|0;while(!((b|0)==0&(T|0)==0));return si(y|0),g|0}function Jn(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0;N=me,me=me+16|0,O=N,B=St(g|0,y|0,52)|0,be()|0,B=B&15;do if(B){if(E=Jh(g,y,O)|0,!E){K=+de[O>>3],G=1/+en(+K),te=+de[25968+(B<<3)>>3],de[b>>3]=K+te,de[b+8>>3]=K-te,K=+de[O+8>>3],G=te*G,de[b+16>>3]=G+K,de[b+24>>3]=K-G;break}return B=E,me=N,B|0}else{if(E=St(g|0,y|0,45)|0,be()|0,E=E&127,E>>>0>121)return B=5,me=N,B|0;O=22064+(E<<5)|0,A[b>>2]=A[O>>2],A[b+4>>2]=A[O+4>>2],A[b+8>>2]=A[O+8>>2],A[b+12>>2]=A[O+12>>2],A[b+16>>2]=A[O+16>>2],A[b+20>>2]=A[O+20>>2],A[b+24>>2]=A[O+24>>2],A[b+28>>2]=A[O+28>>2];break}while(!1);return kp(b,T?1.4:1.1),T=26096+(B<<3)|0,(A[T>>2]|0)==(g|0)&&(A[T+4>>2]|0)==(y|0)&&(de[b>>3]=1.5707963267948966),B=26224+(B<<3)|0,(A[B>>2]|0)==(g|0)&&(A[B+4>>2]|0)==(y|0)&&(de[b+8>>3]=-1.5707963267948966),+de[b>>3]!=1.5707963267948966&&+de[b+8>>3]!=-1.5707963267948966?(B=0,me=N,B|0):(de[b+16>>3]=3.141592653589793,de[b+24>>3]=-3.141592653589793,B=0,me=N,B|0)}function iw(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0;K=me,me=me+48|0,B=K+32|0,O=K+40|0,N=K,BA(B,0,0,0),G=A[B>>2]|0,B=A[B+4>>2]|0;do if(b>>>0<=15){if(E=bf(T)|0,E|0){T=N,A[T>>2]=0,A[T+4>>2]=0,A[N+8>>2]=E,A[N+12>>2]=-1,T=N+16|0,G=N+29|0,A[T>>2]=0,A[T+4>>2]=0,A[T+8>>2]=0,zt[T+12>>0]=0,zt[G>>0]=zt[O>>0]|0,zt[G+1>>0]=zt[O+1>>0]|0,zt[G+2>>0]=zt[O+2>>0]|0;break}if(E=ct((A[y+8>>2]|0)+1|0,32)|0,E){nd(y,E),te=N,A[te>>2]=G,A[te+4>>2]=B,A[N+8>>2]=0,A[N+12>>2]=b,A[N+16>>2]=T,A[N+20>>2]=y,A[N+24>>2]=E,zt[N+28>>0]=0,G=N+29|0,zt[G>>0]=zt[O>>0]|0,zt[G+1>>0]=zt[O+1>>0]|0,zt[G+2>>0]=zt[O+2>>0]|0;break}else{T=N,A[T>>2]=0,A[T+4>>2]=0,A[N+8>>2]=13,A[N+12>>2]=-1,T=N+16|0,G=N+29|0,A[T>>2]=0,A[T+4>>2]=0,A[T+8>>2]=0,zt[T+12>>0]=0,zt[G>>0]=zt[O>>0]|0,zt[G+1>>0]=zt[O+1>>0]|0,zt[G+2>>0]=zt[O+2>>0]|0;break}}else G=N,A[G>>2]=0,A[G+4>>2]=0,A[N+8>>2]=4,A[N+12>>2]=-1,G=N+16|0,te=N+29|0,A[G>>2]=0,A[G+4>>2]=0,A[G+8>>2]=0,zt[G+12>>0]=0,zt[te>>0]=zt[O>>0]|0,zt[te+1>>0]=zt[O+1>>0]|0,zt[te+2>>0]=zt[O+2>>0]|0;while(!1);td(N),A[g>>2]=A[N>>2],A[g+4>>2]=A[N+4>>2],A[g+8>>2]=A[N+8>>2],A[g+12>>2]=A[N+12>>2],A[g+16>>2]=A[N+16>>2],A[g+20>>2]=A[N+20>>2],A[g+24>>2]=A[N+24>>2],A[g+28>>2]=A[N+28>>2],me=K}function td(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0;if(Xe=me,me=me+336|0,ke=Xe+168|0,Ie=Xe,T=g,b=A[T>>2]|0,T=A[T+4>>2]|0,(b|0)==0&(T|0)==0){me=Xe;return}if(y=g+28|0,zt[y>>0]|0?(b=Ec(b,T)|0,T=be()|0):zt[y>>0]=1,ut=g+20|0,!(A[A[ut>>2]>>2]|0)){y=g+24|0,b=A[y>>2]|0,b|0&&Ke(b),At=g,A[At>>2]=0,A[At+4>>2]=0,A[g+8>>2]=0,A[ut>>2]=0,A[g+12>>2]=-1,A[g+16>>2]=0,A[y>>2]=0,me=Xe;return}At=g+16|0,y=A[At>>2]|0,E=y&15;e:do if((b|0)==0&(T|0)==0)wt=g+24|0;else{qe=g+12|0,_e=(E|0)==3,te=y&255,G=(E|1|0)==3,Ee=g+24|0,K=(E+-1|0)>>>0<3,B=(E|2|0)==3,N=Ie+8|0;t:for(;;){if(O=St(b|0,T|0,52)|0,be()|0,O=O&15,(O|0)==(A[qe>>2]|0)){switch(te&15){case 0:case 2:case 3:{if(E=Jh(b,T,ke)|0,E|0){ot=15;break t}if(eh(A[ut>>2]|0,A[Ee>>2]|0,ke)|0){ot=19;break t}break}default:}if(G&&(E=A[(A[ut>>2]|0)+4>>2]|0,A[ke>>2]=A[E>>2],A[ke+4>>2]=A[E+4>>2],A[ke+8>>2]=A[E+8>>2],A[ke+12>>2]=A[E+12>>2],Pp(26832,ke)|0)){if(Tc(A[(A[ut>>2]|0)+4>>2]|0,O,Ie)|0){ot=25;break}if(E=Ie,(A[E>>2]|0)==(b|0)&&(A[E+4>>2]|0)==(T|0)){ot=29;break}}if(K){if(E=Ql(b,T,ke)|0,E|0){ot=32;break}if(Jn(b,T,Ie,0)|0){ot=36;break}if(B&&GA(A[ut>>2]|0,A[Ee>>2]|0,ke,Ie)|0){ot=42;break}if(G&&od(A[ut>>2]|0,A[Ee>>2]|0,ke,Ie)|0){ot=42;break}}if(_e){if(y=Jn(b,T,ke,1)|0,E=A[Ee>>2]|0,y|0){ot=45;break}if(bA(E,ke)|0){if(Sv(Ie,ke),pf(ke,A[Ee>>2]|0)|0){ot=53;break}if(eh(A[ut>>2]|0,A[Ee>>2]|0,N)|0){ot=53;break}if(od(A[ut>>2]|0,A[Ee>>2]|0,Ie,ke)|0){ot=53;break}}}}do if((O|0)<(A[qe>>2]|0)){if(y=Jn(b,T,ke,1)|0,E=A[Ee>>2]|0,y|0){ot=58;break t}if(!(bA(E,ke)|0)){ot=73;break}if(pf(A[Ee>>2]|0,ke)|0&&(Sv(Ie,ke),GA(A[ut>>2]|0,A[Ee>>2]|0,Ie,ke)|0)){ot=65;break t}if(b=Qu(b,T,O+1|0,Ie)|0,b|0){ot=67;break t}T=Ie,b=A[T>>2]|0,T=A[T+4>>2]|0}else ot=73;while(!1);if((ot|0)==73&&(ot=0,b=Ec(b,T)|0,T=be()|0),(b|0)==0&(T|0)==0){wt=Ee;break e}}switch(ot|0){case 15:{y=A[Ee>>2]|0,y|0&&Ke(y),ot=g,A[ot>>2]=0,A[ot+4>>2]=0,A[ut>>2]=0,A[qe>>2]=-1,A[At>>2]=0,A[Ee>>2]=0,A[g+8>>2]=E,ot=20;break}case 19:{A[g>>2]=b,A[g+4>>2]=T,ot=20;break}case 25:{Ur(27795,27761,470,27772);break}case 29:{A[g>>2]=b,A[g+4>>2]=T,me=Xe;return}case 32:{y=A[Ee>>2]|0,y|0&&Ke(y),wt=g,A[wt>>2]=0,A[wt+4>>2]=0,A[ut>>2]=0,A[qe>>2]=-1,A[At>>2]=0,A[Ee>>2]=0,A[g+8>>2]=E,me=Xe;return}case 36:{Ur(27795,27761,493,27772);break}case 42:{A[g>>2]=b,A[g+4>>2]=T,me=Xe;return}case 45:{E|0&&Ke(E),ot=g,A[ot>>2]=0,A[ot+4>>2]=0,A[ut>>2]=0,A[qe>>2]=-1,A[At>>2]=0,A[Ee>>2]=0,A[g+8>>2]=y,ot=55;break}case 53:{A[g>>2]=b,A[g+4>>2]=T,ot=55;break}case 58:{E|0&&Ke(E),ot=g,A[ot>>2]=0,A[ot+4>>2]=0,A[ut>>2]=0,A[qe>>2]=-1,A[At>>2]=0,A[Ee>>2]=0,A[g+8>>2]=y,ot=71;break}case 65:{A[g>>2]=b,A[g+4>>2]=T,ot=71;break}case 67:{y=A[Ee>>2]|0,y|0&&Ke(y),wt=g,A[wt>>2]=0,A[wt+4>>2]=0,A[ut>>2]=0,A[qe>>2]=-1,A[At>>2]=0,A[Ee>>2]=0,A[g+8>>2]=b,me=Xe;return}}if((ot|0)==20){me=Xe;return}else if((ot|0)==55){me=Xe;return}else if((ot|0)==71){me=Xe;return}}while(!1);y=A[wt>>2]|0,y|0&&Ke(y),ot=g,A[ot>>2]=0,A[ot+4>>2]=0,A[g+8>>2]=0,A[ut>>2]=0,A[g+12>>2]=-1,A[At>>2]=0,A[wt>>2]=0,me=Xe}function Ec(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0;_e=me,me=me+16|0,te=_e,T=St(g|0,y|0,52)|0,be()|0,T=T&15,b=St(g|0,y|0,45)|0,be()|0;do if(T){for(;b=Dt(T+4095|0,0,52)|0,E=be()|0|y&-15728641,O=(15-T|0)*3|0,B=Dt(7,0,O|0)|0,N=be()|0,b=b|g|B,E=E|N,G=St(g|0,y|0,O|0)|0,be()|0,G=G&7,T=T+-1|0,!(G>>>0<6);)if(T)y=E,g=b;else{K=4;break}if((K|0)==4){b=St(b|0,E|0,45)|0,be()|0;break}return te=(G|0)==0&(En(b,E)|0)!=0,te=Dt((te?2:1)+G|0,0,O|0)|0,K=be()|0|y&~N,te=te|g&~B,si(K|0),me=_e,te|0}while(!1);return b=b&127,b>>>0>120?(K=0,te=0,si(K|0),me=_e,te|0):(BA(te,0,b+1|0,0),K=A[te+4>>2]|0,te=A[te>>2]|0,si(K|0),me=_e,te|0)}function WA(g,y,b,T,E,O){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0,O=O|0;var B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0;ot=me,me=me+160|0,_e=ot+80|0,N=ot+64|0,Ee=ot+112|0,qe=ot,iw(_e,g,y,b),K=_e,NA(N,A[K>>2]|0,A[K+4>>2]|0,y),K=N,G=A[K>>2]|0,K=A[K+4>>2]|0,B=A[_e+8>>2]|0,ke=Ee+4|0,A[ke>>2]=A[_e>>2],A[ke+4>>2]=A[_e+4>>2],A[ke+8>>2]=A[_e+8>>2],A[ke+12>>2]=A[_e+12>>2],A[ke+16>>2]=A[_e+16>>2],A[ke+20>>2]=A[_e+20>>2],A[ke+24>>2]=A[_e+24>>2],A[ke+28>>2]=A[_e+28>>2],ke=qe,A[ke>>2]=G,A[ke+4>>2]=K,ke=qe+8|0,A[ke>>2]=B,g=qe+12|0,y=Ee,b=g+36|0;do A[g>>2]=A[y>>2],g=g+4|0,y=y+4|0;while((g|0)<(b|0));if(Ee=qe+48|0,A[Ee>>2]=A[N>>2],A[Ee+4>>2]=A[N+4>>2],A[Ee+8>>2]=A[N+8>>2],A[Ee+12>>2]=A[N+12>>2],(G|0)==0&(K|0)==0)return qe=B,me=ot,qe|0;b=qe+16|0,te=qe+24|0,_e=qe+28|0,B=0,N=0,y=G,g=K;do{if(!((B|0)<(E|0)|(B|0)==(E|0)&N>>>0<T>>>0)){Ie=4;break}if(K=N,N=Ye(N|0,B|0,1,0)|0,B=be()|0,K=O+(K<<3)|0,A[K>>2]=y,A[K+4>>2]=g,zA(Ee),g=Ee,y=A[g>>2]|0,g=A[g+4>>2]|0,(y|0)==0&(g|0)==0){if(td(b),y=b,g=A[y>>2]|0,y=A[y+4>>2]|0,(g|0)==0&(y|0)==0){Ie=10;break}bm(g,y,A[_e>>2]|0,Ee),g=Ee,y=A[g>>2]|0,g=A[g+4>>2]|0}K=qe,A[K>>2]=y,A[K+4>>2]=g}while(!((y|0)==0&(g|0)==0));return(Ie|0)==4?(g=qe+40|0,y=A[g>>2]|0,y|0&&Ke(y),Ie=qe+16|0,A[Ie>>2]=0,A[Ie+4>>2]=0,A[te>>2]=0,A[qe+36>>2]=0,A[_e>>2]=-1,A[qe+32>>2]=0,A[g>>2]=0,bm(0,0,0,Ee),A[qe>>2]=0,A[qe+4>>2]=0,A[ke>>2]=0,qe=14,me=ot,qe|0):((Ie|0)==10&&(A[qe>>2]=0,A[qe+4>>2]=0,A[ke>>2]=A[te>>2]),qe=A[ke>>2]|0,me=ot,qe|0)}function Tm(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0;if(_e=me,me=me+48|0,G=_e+32|0,N=_e+40|0,K=_e,!(A[g>>2]|0))return te=T,A[te>>2]=0,A[te+4>>2]=0,te=0,me=_e,te|0;BA(G,0,0,0),B=G,E=A[B>>2]|0,B=A[B+4>>2]|0;do if(y>>>0>15)te=K,A[te>>2]=0,A[te+4>>2]=0,A[K+8>>2]=4,A[K+12>>2]=-1,te=K+16|0,b=K+29|0,A[te>>2]=0,A[te+4>>2]=0,A[te+8>>2]=0,zt[te+12>>0]=0,zt[b>>0]=zt[N>>0]|0,zt[b+1>>0]=zt[N+1>>0]|0,zt[b+2>>0]=zt[N+2>>0]|0,b=4,te=9;else{if(b=bf(b)|0,b|0){G=K,A[G>>2]=0,A[G+4>>2]=0,A[K+8>>2]=b,A[K+12>>2]=-1,G=K+16|0,te=K+29|0,A[G>>2]=0,A[G+4>>2]=0,A[G+8>>2]=0,zt[G+12>>0]=0,zt[te>>0]=zt[N>>0]|0,zt[te+1>>0]=zt[N+1>>0]|0,zt[te+2>>0]=zt[N+2>>0]|0,te=9;break}if(b=ct((A[g+8>>2]|0)+1|0,32)|0,!b){te=K,A[te>>2]=0,A[te+4>>2]=0,A[K+8>>2]=13,A[K+12>>2]=-1,te=K+16|0,b=K+29|0,A[te>>2]=0,A[te+4>>2]=0,A[te+8>>2]=0,zt[te+12>>0]=0,zt[b>>0]=zt[N>>0]|0,zt[b+1>>0]=zt[N+1>>0]|0,zt[b+2>>0]=zt[N+2>>0]|0,b=13,te=9;break}nd(g,b),ke=K,A[ke>>2]=E,A[ke+4>>2]=B,B=K+8|0,A[B>>2]=0,A[K+12>>2]=y,A[K+20>>2]=g,A[K+24>>2]=b,zt[K+28>>0]=0,E=K+29|0,zt[E>>0]=zt[N>>0]|0,zt[E+1>>0]=zt[N+1>>0]|0,zt[E+2>>0]=zt[N+2>>0]|0,A[K+16>>2]=3,Ee=+mm(b),Ee=Ee*+vA(b),O=+qi(+ +de[b>>3]),O=Ee/+en(+ +$o(+O,+ +qi(+ +de[b+8>>3])))*6371.007180918475*6371.007180918475,E=K+12|0,b=A[E>>2]|0;e:do if((b|0)>0)do{if(lu(b+-1|0,G)|0,!(O/+de[G>>3]>10))break e;ke=A[E>>2]|0,b=ke+-1|0,A[E>>2]=b}while((ke|0)>1);while(!1);if(td(K),E=T,A[E>>2]=0,A[E+4>>2]=0,E=K,b=A[E>>2]|0,E=A[E+4>>2]|0,!((b|0)==0&(E|0)==0))do Fp(b,E,y,G)|0,N=G,g=T,N=Ye(A[g>>2]|0,A[g+4>>2]|0,A[N>>2]|0,A[N+4>>2]|0)|0,g=be()|0,ke=T,A[ke>>2]=N,A[ke+4>>2]=g,td(K),ke=K,b=A[ke>>2]|0,E=A[ke+4>>2]|0;while(!((b|0)==0&(E|0)==0));b=A[B>>2]|0}while(!1);return ke=b,me=_e,ke|0}function rd(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0;if(!(Pp(y,b)|0)||(y=pm(y)|0,T=+de[b>>3],E=+de[b+8>>3],E=y&E<0?E+6.283185307179586:E,Ee=A[g>>2]|0,(Ee|0)<=0))return Ee=0,Ee|0;if(_e=A[g+4>>2]|0,y){y=0,te=E,b=-1,g=0;e:for(;;){for(K=g;B=+de[_e+(K<<4)>>3],E=+de[_e+(K<<4)+8>>3],g=(b+2|0)%(Ee|0)|0,O=+de[_e+(g<<4)>>3],N=+de[_e+(g<<4)+8>>3],B>O?(G=B,B=N):(G=O,O=B,B=E,E=N),T=T==O|T==G?T+2220446049250313e-31:T,!!(T<O|T>G);)if(b=K+1|0,(b|0)>=(Ee|0)){b=22;break e}else g=K,K=b,b=g;if(N=B<0?B+6.283185307179586:B,B=E<0?E+6.283185307179586:E,te=N==te|B==te?te+-2220446049250313e-31:te,G=N+(B-N)*((T-O)/(G-O)),(G<0?G+6.283185307179586:G)>te&&(y=y^1),g=K+1|0,(g|0)>=(Ee|0)){b=22;break}else b=K}if((b|0)==22)return y|0}else{y=0,te=E,b=-1,g=0;e:for(;;){for(K=g;B=+de[_e+(K<<4)>>3],E=+de[_e+(K<<4)+8>>3],g=(b+2|0)%(Ee|0)|0,O=+de[_e+(g<<4)>>3],N=+de[_e+(g<<4)+8>>3],B>O?(G=B,B=N):(G=O,O=B,B=E,E=N),T=T==O|T==G?T+2220446049250313e-31:T,!!(T<O|T>G);)if(b=K+1|0,(b|0)>=(Ee|0)){b=22;break e}else g=K,K=b,b=g;if(te=B==te|E==te?te+-2220446049250313e-31:te,B+(E-B)*((T-O)/(G-O))>te&&(y=y^1),g=K+1|0,(g|0)>=(Ee|0)){b=22;break}else b=K}if((b|0)==22)return y|0}return 0}function id(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0;if(Ie=A[g>>2]|0,!Ie){A[y>>2]=0,A[y+4>>2]=0,A[y+8>>2]=0,A[y+12>>2]=0,A[y+16>>2]=0,A[y+20>>2]=0,A[y+24>>2]=0,A[y+28>>2]=0;return}if(qe=y+8|0,de[qe>>3]=17976931348623157e292,ot=y+24|0,de[ot>>3]=17976931348623157e292,de[y>>3]=-17976931348623157e292,wt=y+16|0,de[wt>>3]=-17976931348623157e292,!((Ie|0)<=0)){for(Ee=A[g+4>>2]|0,K=17976931348623157e292,te=-17976931348623157e292,_e=0,g=-1,O=17976931348623157e292,B=17976931348623157e292,G=-17976931348623157e292,T=-17976931348623157e292,ke=0;b=+de[Ee+(ke<<4)>>3],N=+de[Ee+(ke<<4)+8>>3],g=g+2|0,E=+de[Ee+(((g|0)==(Ie|0)?0:g)<<4)+8>>3],b<O&&(de[qe>>3]=b,O=b),N<B&&(de[ot>>3]=N,B=N),b>G?de[y>>3]=b:b=G,N>T&&(de[wt>>3]=N,T=N),K=N>0&N<K?N:K,te=N<0&N>te?N:te,_e=_e|+qi(+(N-E))>3.141592653589793,g=ke+1|0,(g|0)!=(Ie|0);)At=ke,G=b,ke=g,g=At;_e&&(de[wt>>3]=te,de[ot>>3]=K)}}function bf(g){return g=g|0,(g>>>0<4?0:15)|0}function nd(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0;if(Ie=A[g>>2]|0,Ie){if(qe=y+8|0,de[qe>>3]=17976931348623157e292,ot=y+24|0,de[ot>>3]=17976931348623157e292,de[y>>3]=-17976931348623157e292,wt=y+16|0,de[wt>>3]=-17976931348623157e292,(Ie|0)>0){for(E=A[g+4>>2]|0,Ee=17976931348623157e292,ke=-17976931348623157e292,T=0,b=-1,G=17976931348623157e292,K=17976931348623157e292,_e=-17976931348623157e292,B=-17976931348623157e292,At=0;O=+de[E+(At<<4)>>3],te=+de[E+(At<<4)+8>>3],Mr=b+2|0,N=+de[E+(((Mr|0)==(Ie|0)?0:Mr)<<4)+8>>3],O<G&&(de[qe>>3]=O,G=O),te<K&&(de[ot>>3]=te,K=te),O>_e?de[y>>3]=O:O=_e,te>B&&(de[wt>>3]=te,B=te),Ee=te>0&te<Ee?te:Ee,ke=te<0&te>ke?te:ke,T=T|+qi(+(te-N))>3.141592653589793,b=At+1|0,(b|0)!=(Ie|0);)Mr=At,_e=O,At=b,b=Mr;T&&(de[wt>>3]=ke,de[ot>>3]=Ee)}}else A[y>>2]=0,A[y+4>>2]=0,A[y+8>>2]=0,A[y+12>>2]=0,A[y+16>>2]=0,A[y+20>>2]=0,A[y+24>>2]=0,A[y+28>>2]=0;if(Mr=g+8|0,b=A[Mr>>2]|0,!((b|0)<=0)){Yt=g+12|0,Xe=0;do if(E=A[Yt>>2]|0,T=Xe,Xe=Xe+1|0,ot=y+(Xe<<5)|0,wt=A[E+(T<<3)>>2]|0,wt){if(At=y+(Xe<<5)+8|0,de[At>>3]=17976931348623157e292,g=y+(Xe<<5)+24|0,de[g>>3]=17976931348623157e292,de[ot>>3]=-17976931348623157e292,ut=y+(Xe<<5)+16|0,de[ut>>3]=-17976931348623157e292,(wt|0)>0){for(Ie=A[E+(T<<3)+4>>2]|0,Ee=17976931348623157e292,ke=-17976931348623157e292,E=0,T=-1,qe=0,G=17976931348623157e292,K=17976931348623157e292,te=-17976931348623157e292,B=-17976931348623157e292;O=+de[Ie+(qe<<4)>>3],_e=+de[Ie+(qe<<4)+8>>3],T=T+2|0,N=+de[Ie+(((T|0)==(wt|0)?0:T)<<4)+8>>3],O<G&&(de[At>>3]=O,G=O),_e<K&&(de[g>>3]=_e,K=_e),O>te?de[ot>>3]=O:O=te,_e>B&&(de[ut>>3]=_e,B=_e),Ee=_e>0&_e<Ee?_e:Ee,ke=_e<0&_e>ke?_e:ke,E=E|+qi(+(_e-N))>3.141592653589793,T=qe+1|0,(T|0)!=(wt|0);)dr=qe,qe=T,te=O,T=dr;E&&(de[ut>>3]=ke,de[g>>3]=Ee)}}else A[ot>>2]=0,A[ot+4>>2]=0,A[ot+8>>2]=0,A[ot+12>>2]=0,A[ot+16>>2]=0,A[ot+20>>2]=0,A[ot+24>>2]=0,A[ot+28>>2]=0,b=A[Mr>>2]|0;while((Xe|0)<(b|0))}}function eh(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;if(!(rd(g,y,b)|0))return E=0,E|0;if(E=g+8|0,(A[E>>2]|0)<=0)return E=1,E|0;for(T=g+12|0,g=0;;){if(O=g,g=g+1|0,rd((A[T>>2]|0)+(O<<3)|0,y+(g<<5)|0,b)|0){g=0,T=6;break}if((g|0)>=(A[E>>2]|0)){g=1,T=6;break}}return(T|0)==6?g|0:0}function GA(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0;if(K=me,me=me+16|0,N=K,B=b+8|0,!(rd(g,y,B)|0))return G=0,me=K,G|0;G=g+8|0;e:do if((A[G>>2]|0)>0){for(O=g+12|0,E=0;;){if(te=E,E=E+1|0,rd((A[O>>2]|0)+(te<<3)|0,y+(E<<5)|0,B)|0){E=0;break}if((E|0)>=(A[G>>2]|0))break e}return me=K,E|0}while(!1);if(xf(g,y,b,T)|0)return te=0,me=K,te|0;A[N>>2]=A[b>>2],A[N+4>>2]=B,E=A[G>>2]|0;e:do if((E|0)>0)for(g=g+12|0,B=0,O=E;;){if(E=A[g>>2]|0,(A[E+(B<<3)>>2]|0)>0){if(rd(N,T,A[E+(B<<3)+4>>2]|0)|0){E=0;break e}if(E=B+1|0,xf((A[g>>2]|0)+(B<<3)|0,y+(E<<5)|0,b,T)|0){E=0;break e}O=A[G>>2]|0}else E=B+1|0;if((E|0)<(O|0))B=E;else{E=1;break}}else E=1;while(!1);return te=E,me=K,te|0}function xf(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0,Mr=0,dr=0,Qr=0;if(Mr=me,me=me+176|0,At=Mr+172|0,E=Mr+168|0,ut=Mr,!(bA(y,T)|0))return g=0,me=Mr,g|0;if(Ip(y,T,At,E),Gn(ut|0,b|0,168)|0,(A[b>>2]|0)>0){y=0;do dr=ut+8+(y<<4)+8|0,wt=+ha(+de[dr>>3],A[E>>2]|0),de[dr>>3]=wt,y=y+1|0;while((y|0)<(A[b>>2]|0))}qe=+de[T>>3],ot=+de[T+8>>3],wt=+ha(+de[T+16>>3],A[E>>2]|0),ke=+ha(+de[T+24>>3],A[E>>2]|0);e:do if((A[g>>2]|0)>0){if(T=g+4|0,E=A[ut>>2]|0,(E|0)<=0){for(y=0;;)if(y=y+1|0,(y|0)>=(A[g>>2]|0)){y=0;break e}}for(b=0;;){if(y=A[T>>2]|0,Ee=+de[y+(b<<4)>>3],Ie=+ha(+de[y+(b<<4)+8>>3],A[At>>2]|0),y=A[T>>2]|0,b=b+1|0,dr=(b|0)%(A[g>>2]|0)|0,O=+de[y+(dr<<4)>>3],B=+ha(+de[y+(dr<<4)+8>>3],A[At>>2]|0),!(Ee>=qe)|!(O>=qe)&&!(Ee<=ot)|!(O<=ot)&&!(Ie<=ke)|!(B<=ke)&&!(Ie>=wt)|!(B>=wt)){_e=O-Ee,K=B-Ie,y=0;do if(Qr=y,y=y+1|0,dr=(y|0)==(E|0)?0:y,O=+de[ut+8+(Qr<<4)+8>>3],B=+de[ut+8+(dr<<4)+8>>3]-O,N=+de[ut+8+(Qr<<4)>>3],G=+de[ut+8+(dr<<4)>>3]-N,te=_e*B-K*G,te!=0&&(Xe=Ie-O,Yt=Ee-N,G=(Xe*G-B*Yt)/te,!(G<0|G>1))&&(te=(_e*Xe-K*Yt)/te,te>=0&te<=1)){y=1;break e}while((y|0)<(E|0))}if((b|0)>=(A[g>>2]|0)){y=0;break}}}else y=0;while(!1);return Qr=y,me=Mr,Qr|0}function od(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0;if(xf(g,y,b,T)|0)return O=1,O|0;if(O=g+8|0,(A[O>>2]|0)<=0)return O=0,O|0;for(E=g+12|0,g=0;;){if(B=g,g=g+1|0,xf((A[E>>2]|0)+(B<<3)|0,y+(g<<5)|0,b,T)|0){g=1,E=6;break}if((g|0)>=(A[O>>2]|0)){g=0,E=6;break}}return(E|0)==6?g|0:0}function Dv(){return 8}function Lv(){return 16}function HA(){return 168}function qA(){return 8}function C(){return 16}function l(){return 12}function f(){return 8}function v(g){return g=g|0,+(+((A[g>>2]|0)>>>0)+4294967296*+(A[g+4>>2]|0))}function S(g){g=g|0;var y=0,b=0;return b=+de[g>>3],y=+de[g+8>>3],+ +Kn(+(b*b+y*y))}function I(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0;K=+de[g>>3],G=+de[y>>3]-K,N=+de[g+8>>3],B=+de[y+8>>3]-N,_e=+de[b>>3],O=+de[T>>3]-_e,Ee=+de[b+8>>3],te=+de[T+8>>3]-Ee,O=(O*(N-Ee)-(K-_e)*te)/(G*te-B*O),de[E>>3]=K+G*O,de[E+8>>3]=N+B*O}function D(g,y){return g=g|0,y=y|0,+qi(+(+de[g>>3]-+de[y>>3]))<11920928955078125e-23?(y=+qi(+(+de[g+8>>3]-+de[y+8>>3]))<11920928955078125e-23,y|0):(y=0,y|0)}function z(g,y){g=g|0,y=y|0;var b=0,T=0,E=0;return E=+de[g>>3]-+de[y>>3],T=+de[g+8>>3]-+de[y+8>>3],b=+de[g+16>>3]-+de[y+16>>3],+(E*E+T*T+b*b)}function V(g,y){g=g|0,y=y|0;var b=0,T=0,E=0;b=+de[g>>3],T=+en(+b),b=+Yi(+b),de[y+16>>3]=b,b=+de[g+8>>3],E=T*+en(+b),de[y>>3]=E,b=T*+Yi(+b),de[y+8>>3]=b}function X(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;if(O=me,me=me+16|0,E=O,T=En(g,y)|0,(b+-1|0)>>>0>5||(T=(T|0)!=0,(b|0)==1&T))return E=-1,me=O,E|0;do if(Q(g,y,E)|0)T=-1;else if(T){T=((A[26352+(b<<2)>>2]|0)+5-(A[E>>2]|0)|0)%5|0;break}else{T=((A[26384+(b<<2)>>2]|0)+6-(A[E>>2]|0)|0)%6|0;break}while(!1);return E=T,me=O,E|0}function Q(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0,K=0;if(K=me,me=me+32|0,B=K+16|0,N=K,T=ar(g,y,B)|0,T|0)return b=T,me=K,b|0;O=yf(g,y)|0,G=po(g,y)|0,fm(O,N),T=Cp(O,A[B>>2]|0)|0;e:do if(In(O)|0){do switch(O|0){case 4:{g=0;break}case 14:{g=1;break}case 24:{g=2;break}case 38:{g=3;break}case 49:{g=4;break}case 58:{g=5;break}case 63:{g=6;break}case 72:{g=7;break}case 83:{g=8;break}case 97:{g=9;break}case 107:{g=10;break}case 117:{g=11;break}default:{T=1;break e}}while(!1);if(E=A[26416+(g*24|0)+8>>2]|0,y=A[26416+(g*24|0)+16>>2]|0,g=A[B>>2]|0,(g|0)!=(A[N>>2]|0)&&(N=Ep(O)|0,g=A[B>>2]|0,N|(g|0)==(y|0)&&(T=(T+1|0)%6|0)),(G|0)==3&(g|0)==(y|0)){T=(T+5|0)%6|0,E=22;break}(G|0)==5&(g|0)==(E|0)&&(T=(T+1|0)%6|0),E=22}else E=22;while(!1);return(E|0)==22&&(A[b>>2]=T,T=0),b=T,me=K,b|0}function ie(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0;if(ut=me,me=me+32|0,At=ut+24|0,ot=ut+20|0,Ie=ut+8|0,ke=ut+16|0,Ee=ut,G=(En(g,y)|0)==0,G=G?6:5,te=St(g|0,y|0,52)|0,be()|0,te=te&15,G>>>0<=b>>>0)return T=2,me=ut,T|0;_e=(te|0)==0,!_e&&(qe=Dt(7,0,(te^15)*3|0)|0,(qe&g|0)==0&((be()|0)&y|0)==0)?E=b:O=4;e:do if((O|0)==4){if(E=(En(g,y)|0)!=0,((E?4:5)|0)<(b|0)||Q(g,y,At)|0||(O=(A[At>>2]|0)+b|0,E?E=26704+(((O|0)%5|0)<<2)|0:E=26736+(((O|0)%6|0)<<2)|0,qe=A[E>>2]|0,(qe|0)==7))return T=1,me=ut,T|0;A[ot>>2]=0,E=fo(g,y,qe,ot,Ie)|0;do if(!E){if(N=Ie,K=A[N>>2]|0,N=A[N+4>>2]|0,B=N>>>0<y>>>0|(N|0)==(y|0)&K>>>0<g>>>0,O=B?K:g,B=B?N:y,!_e&&(_e=Dt(7,0,(te^15)*3|0)|0,(K&_e|0)==0&(N&(be()|0)|0)==0))E=b;else{if(N=(b+-1+G|0)%(G|0)|0,E=En(g,y)|0,(N|0)<0&&Ur(27795,27797,246,27806),G=(E|0)!=0,((G?4:5)|0)<(N|0)&&Ur(27795,27797,246,27806),Q(g,y,At)|0&&Ur(27795,27797,246,27806),E=(A[At>>2]|0)+N|0,G?E=26704+(((E|0)%5|0)<<2)|0:E=26736+(((E|0)%6|0)<<2)|0,N=A[E>>2]|0,(N|0)==7&&Ur(27795,27797,246,27806),A[ke>>2]=0,E=fo(g,y,N,ke,Ee)|0,E|0)break;K=Ee,G=A[K>>2]|0,K=A[K+4>>2]|0;do if(K>>>0<B>>>0|(K|0)==(B|0)&G>>>0<O>>>0){if(En(G,K)|0?O=bv(G,K,g,y)|0:O=A[26800+((((A[ke>>2]|0)+(A[26768+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,E=En(G,K)|0,(O+-1|0)>>>0>5){E=-1,O=G,B=K;break}if(E=(E|0)!=0,(O|0)==1&E){E=-1,O=G,B=K;break}do if(Q(G,K,At)|0)E=-1;else if(E){E=((A[26352+(O<<2)>>2]|0)+5-(A[At>>2]|0)|0)%5|0;break}else{E=((A[26384+(O<<2)>>2]|0)+6-(A[At>>2]|0)|0)%6|0;break}while(!1);O=G,B=K}else E=b;while(!1);N=Ie,K=A[N>>2]|0,N=A[N+4>>2]|0}if((O|0)==(K|0)&(B|0)==(N|0)){if(G=(En(K,N)|0)!=0,G?g=bv(K,N,g,y)|0:g=A[26800+((((A[ot>>2]|0)+(A[26768+(qe<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,E=En(K,N)|0,(g+-1|0)>>>0<=5&&(wt=(E|0)!=0,!((g|0)==1&wt)))do if(Q(K,N,At)|0)E=-1;else if(wt){E=((A[26352+(g<<2)>>2]|0)+5-(A[At>>2]|0)|0)%5|0;break}else{E=((A[26384+(g<<2)>>2]|0)+6-(A[At>>2]|0)|0)%6|0;break}while(!1);else E=-1;E=E+1|0,E=(E|0)==6|G&(E|0)==5?0:E}y=B,g=O;break e}while(!1);return T=E,me=ut,T|0}while(!1);return wt=Dt(E|0,0,56)|0,At=be()|0|y&-2130706433|536870912,A[T>>2]=wt|g,A[T+4>>2]=At,T=0,me=ut,T|0}function re(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;return O=(En(g,y)|0)==0,T=ie(g,y,0,b)|0,E=(T|0)==0,O?!E||(T=ie(g,y,1,b+8|0)|0,T|0)||(T=ie(g,y,2,b+16|0)|0,T|0)||(T=ie(g,y,3,b+24|0)|0,T|0)||(T=ie(g,y,4,b+32|0)|0,T)?(O=T,O|0):ie(g,y,5,b+40|0)|0:!E||(T=ie(g,y,1,b+8|0)|0,T|0)||(T=ie(g,y,2,b+16|0)|0,T|0)||(T=ie(g,y,3,b+24|0)|0,T|0)||(T=ie(g,y,4,b+32|0)|0,T|0)?(O=T,O|0):(O=b+40|0,A[O>>2]=0,A[O+4>>2]=0,O=0,O|0)}function ae(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0,N=0,G=0;return G=me,me=me+192|0,E=G,O=G+168|0,B=St(g|0,y|0,56)|0,be()|0,B=B&7,N=y&-2130706433|134217728,T=ar(g,N,O)|0,T|0?(N=T,me=G,N|0):(y=St(g|0,y|0,52)|0,be()|0,y=y&15,En(g,N)|0?Xh(O,y,B,1,E):OA(O,y,B,1,E),N=E+8|0,A[b>>2]=A[N>>2],A[b+4>>2]=A[N+4>>2],A[b+8>>2]=A[N+8>>2],A[b+12>>2]=A[N+12>>2],N=0,me=G,N|0)}function Ae(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0;return E=me,me=me+16|0,b=E,!(!0&(y&2013265920|0)==536870912)||(T=y&-2130706433|134217728,!(LA(g,T)|0))?(T=0,me=E,T|0):(O=St(g|0,y|0,56)|0,be()|0,O=(ie(g,T,O&7,b)|0)==0,T=b,T=O&((A[T>>2]|0)==(g|0)?(A[T+4>>2]|0)==(y|0):0)&1,me=E,T|0)}function Te(g,y,b){g=g|0,y=y|0,b=b|0;var T=0;(y|0)>0?(T=ct(y,4)|0,A[g>>2]=T,T||Ur(27819,27842,40,27856)):A[g>>2]=0,A[g+4>>2]=y,A[g+8>>2]=0,A[g+12>>2]=b}function Me(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0;E=g+4|0,O=g+12|0,B=g+8|0;e:for(;;){for(b=A[E>>2]|0,y=0;;){if((y|0)>=(b|0))break e;if(T=A[g>>2]|0,N=A[T+(y<<2)>>2]|0,!N)y=y+1|0;else break}y=T+(~~(+qi(+(+jo(10,+ +(15-(A[O>>2]|0)|0))*(+de[N>>3]+ +de[N+8>>3])))%+(b|0))>>>0<<2)|0,b=A[y>>2]|0;t:do if(b|0){if(T=N+32|0,(b|0)==(N|0))A[y>>2]=A[T>>2];else{if(b=b+32|0,y=A[b>>2]|0,!y)break;for(;(y|0)!=(N|0);)if(b=y+32|0,y=A[b>>2]|0,!y)break t;A[b>>2]=A[T>>2]}Ke(N),A[B>>2]=(A[B>>2]|0)+-1}while(!1)}Ke(A[g>>2]|0)}function Ce(g){g=g|0;var y=0,b=0,T=0;for(T=A[g+4>>2]|0,b=0;;){if((b|0)>=(T|0)){y=0,b=4;break}if(y=A[(A[g>>2]|0)+(b<<2)>>2]|0,!y)b=b+1|0;else{b=4;break}}return(b|0)==4?y|0:0}function De(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0;if(b=~~(+qi(+(+jo(10,+ +(15-(A[g+12>>2]|0)|0))*(+de[y>>3]+ +de[y+8>>3])))%+(A[g+4>>2]|0))>>>0,b=(A[g>>2]|0)+(b<<2)|0,T=A[b>>2]|0,!T)return O=1,O|0;O=y+32|0;do if((T|0)!=(y|0)){if(b=A[T+32>>2]|0,!b)return O=1,O|0;for(E=b;;){if((E|0)==(y|0)){E=8;break}if(b=A[E+32>>2]|0,b)T=E,E=b;else{b=1,E=10;break}}if((E|0)==8){A[T+32>>2]=A[O>>2];break}else if((E|0)==10)return b|0}else A[b>>2]=A[O>>2];while(!1);return Ke(y),O=g+8|0,A[O>>2]=(A[O>>2]|0)+-1,O=0,O|0}function Ve(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0;O=et(40)|0,O||Ur(27872,27842,98,27885),A[O>>2]=A[y>>2],A[O+4>>2]=A[y+4>>2],A[O+8>>2]=A[y+8>>2],A[O+12>>2]=A[y+12>>2],E=O+16|0,A[E>>2]=A[b>>2],A[E+4>>2]=A[b+4>>2],A[E+8>>2]=A[b+8>>2],A[E+12>>2]=A[b+12>>2],A[O+32>>2]=0,E=~~(+qi(+(+jo(10,+ +(15-(A[g+12>>2]|0)|0))*(+de[y>>3]+ +de[y+8>>3])))%+(A[g+4>>2]|0))>>>0,E=(A[g>>2]|0)+(E<<2)|0,T=A[E>>2]|0;do if(!T)A[E>>2]=O;else{for(;!(Ju(T,y)|0&&Ju(T+16|0,b)|0);)if(E=A[T+32>>2]|0,T=(E|0)==0?T:E,!(A[T+32>>2]|0)){B=10;break}if((B|0)==10){A[T+32>>2]=O;break}return Ke(O),B=T,B|0}while(!1);return B=g+8|0,A[B>>2]=(A[B>>2]|0)+1,B=O,B|0}function Oe(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0;if(E=~~(+qi(+(+jo(10,+ +(15-(A[g+12>>2]|0)|0))*(+de[y>>3]+ +de[y+8>>3])))%+(A[g+4>>2]|0))>>>0,E=A[(A[g>>2]|0)+(E<<2)>>2]|0,!E)return b=0,b|0;if(!b){for(g=E;;){if(Ju(g,y)|0){T=10;break}if(g=A[g+32>>2]|0,!g){g=0,T=10;break}}if((T|0)==10)return g|0}for(g=E;;){if(Ju(g,y)|0&&Ju(g+16|0,b)|0){T=10;break}if(g=A[g+32>>2]|0,!g){g=0,T=10;break}}return(T|0)==10?g|0:0}function je(g,y){g=g|0,y=y|0;var b=0;if(b=~~(+qi(+(+jo(10,+ +(15-(A[g+12>>2]|0)|0))*(+de[y>>3]+ +de[y+8>>3])))%+(A[g+4>>2]|0))>>>0,g=A[(A[g>>2]|0)+(b<<2)>>2]|0,!g)return b=0,b|0;for(;;){if(Ju(g,y)|0){y=5;break}if(g=A[g+32>>2]|0,!g){g=0,y=5;break}}return(y|0)==5?g|0:0}function He(){return 27904}function Be(g){return g=+g,~~+th(+g)|0}function et(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0,qe=0,ot=0,wt=0,At=0,ut=0,Xe=0,Yt=0;Yt=me,me=me+16|0,Ee=Yt;do if(g>>>0<245){if(K=g>>>0<11?16:g+11&-8,g=K>>>3,_e=A[6977]|0,b=_e>>>g,b&3|0)return y=(b&1^1)+g|0,g=27948+(y<<1<<2)|0,b=g+8|0,T=A[b>>2]|0,E=T+8|0,O=A[E>>2]|0,(O|0)==(g|0)?A[6977]=_e&~(1<<y):(A[O+12>>2]=g,A[b>>2]=O),Xe=y<<3,A[T+4>>2]=Xe|3,Xe=T+Xe+4|0,A[Xe>>2]=A[Xe>>2]|1,Xe=E,me=Yt,Xe|0;if(te=A[6979]|0,K>>>0>te>>>0){if(b|0)return y=2<<g,y=b<<g&(y|0-y),y=(y&0-y)+-1|0,N=y>>>12&16,y=y>>>N,b=y>>>5&8,y=y>>>b,O=y>>>2&4,y=y>>>O,g=y>>>1&2,y=y>>>g,T=y>>>1&1,T=(b|N|O|g|T)+(y>>>T)|0,y=27948+(T<<1<<2)|0,g=y+8|0,O=A[g>>2]|0,N=O+8|0,b=A[N>>2]|0,(b|0)==(y|0)?(g=_e&~(1<<T),A[6977]=g):(A[b+12>>2]=y,A[g>>2]=b,g=_e),Xe=T<<3,B=Xe-K|0,A[O+4>>2]=K|3,E=O+K|0,A[E+4>>2]=B|1,A[O+Xe>>2]=B,te|0&&(T=A[6982]|0,y=te>>>3,b=27948+(y<<1<<2)|0,y=1<<y,g&y?(g=b+8|0,y=A[g>>2]|0):(A[6977]=g|y,y=b,g=b+8|0),A[g>>2]=T,A[y+12>>2]=T,A[T+8>>2]=y,A[T+12>>2]=b),A[6979]=B,A[6982]=E,Xe=N,me=Yt,Xe|0;if(O=A[6978]|0,O){for(b=(O&0-O)+-1|0,E=b>>>12&16,b=b>>>E,T=b>>>5&8,b=b>>>T,B=b>>>2&4,b=b>>>B,N=b>>>1&2,b=b>>>N,G=b>>>1&1,G=A[28212+((T|E|B|N|G)+(b>>>G)<<2)>>2]|0,b=G,N=G,G=(A[G+4>>2]&-8)-K|0;g=A[b+16>>2]|0,!(!g&&(g=A[b+20>>2]|0,!g));)B=(A[g+4>>2]&-8)-K|0,E=B>>>0<G>>>0,b=g,N=E?g:N,G=E?B:G;if(B=N+K|0,B>>>0>N>>>0){E=A[N+24>>2]|0,y=A[N+12>>2]|0;do if((y|0)==(N|0)){if(g=N+20|0,y=A[g>>2]|0,!y&&(g=N+16|0,y=A[g>>2]|0,!y)){b=0;break}for(;;)if(T=y+20|0,b=A[T>>2]|0,b)y=b,g=T;else if(T=y+16|0,b=A[T>>2]|0,b)y=b,g=T;else break;A[g>>2]=0,b=y}else b=A[N+8>>2]|0,A[b+12>>2]=y,A[y+8>>2]=b,b=y;while(!1);do if(E|0){if(y=A[N+28>>2]|0,g=28212+(y<<2)|0,(N|0)==(A[g>>2]|0)){if(A[g>>2]=b,!b){A[6978]=O&~(1<<y);break}}else if(Xe=E+16|0,A[((A[Xe>>2]|0)==(N|0)?Xe:E+20|0)>>2]=b,!b)break;A[b+24>>2]=E,y=A[N+16>>2]|0,y|0&&(A[b+16>>2]=y,A[y+24>>2]=b),y=A[N+20>>2]|0,y|0&&(A[b+20>>2]=y,A[y+24>>2]=b)}while(!1);return G>>>0<16?(Xe=G+K|0,A[N+4>>2]=Xe|3,Xe=N+Xe+4|0,A[Xe>>2]=A[Xe>>2]|1):(A[N+4>>2]=K|3,A[B+4>>2]=G|1,A[B+G>>2]=G,te|0&&(T=A[6982]|0,y=te>>>3,b=27948+(y<<1<<2)|0,y=1<<y,y&_e?(g=b+8|0,y=A[g>>2]|0):(A[6977]=y|_e,y=b,g=b+8|0),A[g>>2]=T,A[y+12>>2]=T,A[T+8>>2]=y,A[T+12>>2]=b),A[6979]=G,A[6982]=B),Xe=N+8|0,me=Yt,Xe|0}else _e=K}else _e=K}else _e=K}else if(g>>>0<=4294967231)if(g=g+11|0,K=g&-8,T=A[6978]|0,T){E=0-K|0,g=g>>>8,g?K>>>0>16777215?G=31:(_e=(g+1048320|0)>>>16&8,qe=g<<_e,N=(qe+520192|0)>>>16&4,qe=qe<<N,G=(qe+245760|0)>>>16&2,G=14-(N|_e|G)+(qe<<G>>>15)|0,G=K>>>(G+7|0)&1|G<<1):G=0,b=A[28212+(G<<2)>>2]|0;e:do if(!b)b=0,g=0,qe=61;else for(g=0,N=K<<((G|0)==31?0:25-(G>>>1)|0),O=0;;){if(B=(A[b+4>>2]&-8)-K|0,B>>>0<E>>>0)if(B)g=b,E=B;else{g=b,E=0,qe=65;break e}if(qe=A[b+20>>2]|0,b=A[b+16+(N>>>31<<2)>>2]|0,O=(qe|0)==0|(qe|0)==(b|0)?O:qe,b)N=N<<1;else{b=O,qe=61;break}}while(!1);if((qe|0)==61){if((b|0)==0&(g|0)==0){if(g=2<<G,g=(g|0-g)&T,!g){_e=K;break}_e=(g&0-g)+-1|0,B=_e>>>12&16,_e=_e>>>B,O=_e>>>5&8,_e=_e>>>O,N=_e>>>2&4,_e=_e>>>N,G=_e>>>1&2,_e=_e>>>G,b=_e>>>1&1,g=0,b=A[28212+((O|B|N|G|b)+(_e>>>b)<<2)>>2]|0}b?qe=65:(N=g,B=E)}if((qe|0)==65)for(O=b;;)if(_e=(A[O+4>>2]&-8)-K|0,b=_e>>>0<E>>>0,E=b?_e:E,g=b?O:g,b=A[O+16>>2]|0,b||(b=A[O+20>>2]|0),b)O=b;else{N=g,B=E;break}if((N|0)!=0&&B>>>0<((A[6979]|0)-K|0)>>>0&&(te=N+K|0,te>>>0>N>>>0)){O=A[N+24>>2]|0,y=A[N+12>>2]|0;do if((y|0)==(N|0)){if(g=N+20|0,y=A[g>>2]|0,!y&&(g=N+16|0,y=A[g>>2]|0,!y)){y=0;break}for(;;)if(E=y+20|0,b=A[E>>2]|0,b)y=b,g=E;else if(E=y+16|0,b=A[E>>2]|0,b)y=b,g=E;else break;A[g>>2]=0}else Xe=A[N+8>>2]|0,A[Xe+12>>2]=y,A[y+8>>2]=Xe;while(!1);do if(O){if(g=A[N+28>>2]|0,b=28212+(g<<2)|0,(N|0)==(A[b>>2]|0)){if(A[b>>2]=y,!y){T=T&~(1<<g),A[6978]=T;break}}else if(Xe=O+16|0,A[((A[Xe>>2]|0)==(N|0)?Xe:O+20|0)>>2]=y,!y)break;A[y+24>>2]=O,g=A[N+16>>2]|0,g|0&&(A[y+16>>2]=g,A[g+24>>2]=y),g=A[N+20>>2]|0,g&&(A[y+20>>2]=g,A[g+24>>2]=y)}while(!1);e:do if(B>>>0<16)Xe=B+K|0,A[N+4>>2]=Xe|3,Xe=N+Xe+4|0,A[Xe>>2]=A[Xe>>2]|1;else{if(A[N+4>>2]=K|3,A[te+4>>2]=B|1,A[te+B>>2]=B,y=B>>>3,B>>>0<256){b=27948+(y<<1<<2)|0,g=A[6977]|0,y=1<<y,g&y?(g=b+8|0,y=A[g>>2]|0):(A[6977]=g|y,y=b,g=b+8|0),A[g>>2]=te,A[y+12>>2]=te,A[te+8>>2]=y,A[te+12>>2]=b;break}if(y=B>>>8,y?B>>>0>16777215?b=31:(ut=(y+1048320|0)>>>16&8,Xe=y<<ut,At=(Xe+520192|0)>>>16&4,Xe=Xe<<At,b=(Xe+245760|0)>>>16&2,b=14-(At|ut|b)+(Xe<<b>>>15)|0,b=B>>>(b+7|0)&1|b<<1):b=0,y=28212+(b<<2)|0,A[te+28>>2]=b,g=te+16|0,A[g+4>>2]=0,A[g>>2]=0,g=1<<b,!(T&g)){A[6978]=T|g,A[y>>2]=te,A[te+24>>2]=y,A[te+12>>2]=te,A[te+8>>2]=te;break}y=A[y>>2]|0;t:do if((A[y+4>>2]&-8|0)!=(B|0)){for(T=B<<((b|0)==31?0:25-(b>>>1)|0);b=y+16+(T>>>31<<2)|0,g=A[b>>2]|0,!!g;)if((A[g+4>>2]&-8|0)==(B|0)){y=g;break t}else T=T<<1,y=g;A[b>>2]=te,A[te+24>>2]=y,A[te+12>>2]=te,A[te+8>>2]=te;break e}while(!1);ut=y+8|0,Xe=A[ut>>2]|0,A[Xe+12>>2]=te,A[ut>>2]=te,A[te+8>>2]=Xe,A[te+12>>2]=y,A[te+24>>2]=0}while(!1);return Xe=N+8|0,me=Yt,Xe|0}else _e=K}else _e=K;else _e=-1;while(!1);if(b=A[6979]|0,b>>>0>=_e>>>0)return y=b-_e|0,g=A[6982]|0,y>>>0>15?(Xe=g+_e|0,A[6982]=Xe,A[6979]=y,A[Xe+4>>2]=y|1,A[g+b>>2]=y,A[g+4>>2]=_e|3):(A[6979]=0,A[6982]=0,A[g+4>>2]=b|3,Xe=g+b+4|0,A[Xe>>2]=A[Xe>>2]|1),Xe=g+8|0,me=Yt,Xe|0;if(B=A[6980]|0,B>>>0>_e>>>0)return At=B-_e|0,A[6980]=At,Xe=A[6983]|0,ut=Xe+_e|0,A[6983]=ut,A[ut+4>>2]=At|1,A[Xe+4>>2]=_e|3,Xe=Xe+8|0,me=Yt,Xe|0;if(A[7095]|0?g=A[7097]|0:(A[7097]=4096,A[7096]=4096,A[7098]=-1,A[7099]=-1,A[7100]=0,A[7088]=0,A[7095]=Ee&-16^1431655768,g=4096),N=_e+48|0,G=_e+47|0,O=g+G|0,E=0-g|0,K=O&E,K>>>0<=_e>>>0||(g=A[7087]|0,g|0&&(te=A[7085]|0,Ee=te+K|0,Ee>>>0<=te>>>0|Ee>>>0>g>>>0)))return Xe=0,me=Yt,Xe|0;e:do if(A[7088]&4)y=0,qe=143;else{b=A[6983]|0;t:do if(b){for(T=28356;Ee=A[T>>2]|0,!(Ee>>>0<=b>>>0&&(Ee+(A[T+4>>2]|0)|0)>>>0>b>>>0);)if(g=A[T+8>>2]|0,g)T=g;else{qe=128;break t}if(y=O-B&E,y>>>0<2147483647)if(g=Ba(y|0)|0,(g|0)==((A[T>>2]|0)+(A[T+4>>2]|0)|0)){if((g|0)!=-1){B=y,O=g,qe=145;break e}}else T=g,qe=136;else y=0}else qe=128;while(!1);do if((qe|0)==128)if(b=Ba(0)|0,(b|0)!=-1&&(y=b,ke=A[7096]|0,Ie=ke+-1|0,y=((Ie&y|0)==0?0:(Ie+y&0-ke)-y|0)+K|0,ke=A[7085]|0,Ie=y+ke|0,y>>>0>_e>>>0&y>>>0<2147483647)){if(Ee=A[7087]|0,Ee|0&&Ie>>>0<=ke>>>0|Ie>>>0>Ee>>>0){y=0;break}if(g=Ba(y|0)|0,(g|0)==(b|0)){B=y,O=b,qe=145;break e}else T=g,qe=136}else y=0;while(!1);do if((qe|0)==136){if(b=0-y|0,!(N>>>0>y>>>0&(y>>>0<2147483647&(T|0)!=-1)))if((T|0)==-1){y=0;break}else{B=y,O=T,qe=145;break e}if(g=A[7097]|0,g=G-y+g&0-g,g>>>0>=2147483647){B=y,O=T,qe=145;break e}if((Ba(g|0)|0)==-1){Ba(b|0)|0,y=0;break}else{B=g+y|0,O=T,qe=145;break e}}while(!1);A[7088]=A[7088]|4,qe=143}while(!1);if((qe|0)==143&&K>>>0<2147483647&&(At=Ba(K|0)|0,Ie=Ba(0)|0,ot=Ie-At|0,wt=ot>>>0>(_e+40|0)>>>0,!((At|0)==-1|wt^1|At>>>0<Ie>>>0&((At|0)!=-1&(Ie|0)!=-1)^1))&&(B=wt?ot:y,O=At,qe=145),(qe|0)==145){y=(A[7085]|0)+B|0,A[7085]=y,y>>>0>(A[7086]|0)>>>0&&(A[7086]=y),G=A[6983]|0;e:do if(G){for(y=28356;;){if(g=A[y>>2]|0,b=A[y+4>>2]|0,(O|0)==(g+b|0)){qe=154;break}if(T=A[y+8>>2]|0,T)y=T;else break}if((qe|0)==154&&(ut=y+4|0,(A[y+12>>2]&8|0)==0)&&O>>>0>G>>>0&g>>>0<=G>>>0){A[ut>>2]=b+B,Xe=(A[6980]|0)+B|0,At=G+8|0,At=(At&7|0)==0?0:0-At&7,ut=G+At|0,At=Xe-At|0,A[6983]=ut,A[6980]=At,A[ut+4>>2]=At|1,A[G+Xe+4>>2]=40,A[6984]=A[7099];break}for(O>>>0<(A[6981]|0)>>>0&&(A[6981]=O),b=O+B|0,y=28356;;){if((A[y>>2]|0)==(b|0)){qe=162;break}if(g=A[y+8>>2]|0,g)y=g;else break}if((qe|0)==162&&(A[y+12>>2]&8|0)==0){A[y>>2]=O,te=y+4|0,A[te>>2]=(A[te>>2]|0)+B,te=O+8|0,te=O+((te&7|0)==0?0:0-te&7)|0,y=b+8|0,y=b+((y&7|0)==0?0:0-y&7)|0,K=te+_e|0,N=y-te-_e|0,A[te+4>>2]=_e|3;t:do if((G|0)==(y|0))Xe=(A[6980]|0)+N|0,A[6980]=Xe,A[6983]=K,A[K+4>>2]=Xe|1;else{if((A[6982]|0)==(y|0)){Xe=(A[6979]|0)+N|0,A[6979]=Xe,A[6982]=K,A[K+4>>2]=Xe|1,A[K+Xe>>2]=Xe;break}if(g=A[y+4>>2]|0,(g&3|0)==1){B=g&-8,T=g>>>3;r:do if(g>>>0<256)if(g=A[y+8>>2]|0,b=A[y+12>>2]|0,(b|0)==(g|0)){A[6977]=A[6977]&~(1<<T);break}else{A[g+12>>2]=b,A[b+8>>2]=g;break}else{O=A[y+24>>2]|0,g=A[y+12>>2]|0;do if((g|0)==(y|0)){if(b=y+16|0,T=b+4|0,g=A[T>>2]|0,g)b=T;else if(g=A[b>>2]|0,!g){g=0;break}for(;;)if(E=g+20|0,T=A[E>>2]|0,T)g=T,b=E;else if(E=g+16|0,T=A[E>>2]|0,T)g=T,b=E;else break;A[b>>2]=0}else Xe=A[y+8>>2]|0,A[Xe+12>>2]=g,A[g+8>>2]=Xe;while(!1);if(!O)break;b=A[y+28>>2]|0,T=28212+(b<<2)|0;do if((A[T>>2]|0)!=(y|0)){if(Xe=O+16|0,A[((A[Xe>>2]|0)==(y|0)?Xe:O+20|0)>>2]=g,!g)break r}else{if(A[T>>2]=g,g|0)break;A[6978]=A[6978]&~(1<<b);break r}while(!1);if(A[g+24>>2]=O,b=y+16|0,T=A[b>>2]|0,T|0&&(A[g+16>>2]=T,A[T+24>>2]=g),b=A[b+4>>2]|0,!b)break;A[g+20>>2]=b,A[b+24>>2]=g}while(!1);y=y+B|0,E=B+N|0}else E=N;if(y=y+4|0,A[y>>2]=A[y>>2]&-2,A[K+4>>2]=E|1,A[K+E>>2]=E,y=E>>>3,E>>>0<256){b=27948+(y<<1<<2)|0,g=A[6977]|0,y=1<<y,g&y?(g=b+8|0,y=A[g>>2]|0):(A[6977]=g|y,y=b,g=b+8|0),A[g>>2]=K,A[y+12>>2]=K,A[K+8>>2]=y,A[K+12>>2]=b;break}y=E>>>8;do if(!y)T=0;else{if(E>>>0>16777215){T=31;break}ut=(y+1048320|0)>>>16&8,Xe=y<<ut,At=(Xe+520192|0)>>>16&4,Xe=Xe<<At,T=(Xe+245760|0)>>>16&2,T=14-(At|ut|T)+(Xe<<T>>>15)|0,T=E>>>(T+7|0)&1|T<<1}while(!1);if(y=28212+(T<<2)|0,A[K+28>>2]=T,g=K+16|0,A[g+4>>2]=0,A[g>>2]=0,g=A[6978]|0,b=1<<T,!(g&b)){A[6978]=g|b,A[y>>2]=K,A[K+24>>2]=y,A[K+12>>2]=K,A[K+8>>2]=K;break}y=A[y>>2]|0;r:do if((A[y+4>>2]&-8|0)!=(E|0)){for(T=E<<((T|0)==31?0:25-(T>>>1)|0);b=y+16+(T>>>31<<2)|0,g=A[b>>2]|0,!!g;)if((A[g+4>>2]&-8|0)==(E|0)){y=g;break r}else T=T<<1,y=g;A[b>>2]=K,A[K+24>>2]=y,A[K+12>>2]=K,A[K+8>>2]=K;break t}while(!1);ut=y+8|0,Xe=A[ut>>2]|0,A[Xe+12>>2]=K,A[ut>>2]=K,A[K+8>>2]=Xe,A[K+12>>2]=y,A[K+24>>2]=0}while(!1);return Xe=te+8|0,me=Yt,Xe|0}for(y=28356;g=A[y>>2]|0,!(g>>>0<=G>>>0&&(Xe=g+(A[y+4>>2]|0)|0,Xe>>>0>G>>>0));)y=A[y+8>>2]|0;E=Xe+-47|0,g=E+8|0,g=E+((g&7|0)==0?0:0-g&7)|0,E=G+16|0,g=g>>>0<E>>>0?G:g,y=g+8|0,b=B+-40|0,At=O+8|0,At=(At&7|0)==0?0:0-At&7,ut=O+At|0,At=b-At|0,A[6983]=ut,A[6980]=At,A[ut+4>>2]=At|1,A[O+b+4>>2]=40,A[6984]=A[7099],b=g+4|0,A[b>>2]=27,A[y>>2]=A[7089],A[y+4>>2]=A[7090],A[y+8>>2]=A[7091],A[y+12>>2]=A[7092],A[7089]=O,A[7090]=B,A[7092]=0,A[7091]=y,y=g+24|0;do ut=y,y=y+4|0,A[y>>2]=7;while((ut+8|0)>>>0<Xe>>>0);if((g|0)!=(G|0)){if(O=g-G|0,A[b>>2]=A[b>>2]&-2,A[G+4>>2]=O|1,A[g>>2]=O,y=O>>>3,O>>>0<256){b=27948+(y<<1<<2)|0,g=A[6977]|0,y=1<<y,g&y?(g=b+8|0,y=A[g>>2]|0):(A[6977]=g|y,y=b,g=b+8|0),A[g>>2]=G,A[y+12>>2]=G,A[G+8>>2]=y,A[G+12>>2]=b;break}if(y=O>>>8,y?O>>>0>16777215?T=31:(ut=(y+1048320|0)>>>16&8,Xe=y<<ut,At=(Xe+520192|0)>>>16&4,Xe=Xe<<At,T=(Xe+245760|0)>>>16&2,T=14-(At|ut|T)+(Xe<<T>>>15)|0,T=O>>>(T+7|0)&1|T<<1):T=0,b=28212+(T<<2)|0,A[G+28>>2]=T,A[G+20>>2]=0,A[E>>2]=0,y=A[6978]|0,g=1<<T,!(y&g)){A[6978]=y|g,A[b>>2]=G,A[G+24>>2]=b,A[G+12>>2]=G,A[G+8>>2]=G;break}y=A[b>>2]|0;t:do if((A[y+4>>2]&-8|0)!=(O|0)){for(T=O<<((T|0)==31?0:25-(T>>>1)|0);b=y+16+(T>>>31<<2)|0,g=A[b>>2]|0,!!g;)if((A[g+4>>2]&-8|0)==(O|0)){y=g;break t}else T=T<<1,y=g;A[b>>2]=G,A[G+24>>2]=y,A[G+12>>2]=G,A[G+8>>2]=G;break e}while(!1);ut=y+8|0,Xe=A[ut>>2]|0,A[Xe+12>>2]=G,A[ut>>2]=G,A[G+8>>2]=Xe,A[G+12>>2]=y,A[G+24>>2]=0}}else Xe=A[6981]|0,(Xe|0)==0|O>>>0<Xe>>>0&&(A[6981]=O),A[7089]=O,A[7090]=B,A[7092]=0,A[6986]=A[7095],A[6985]=-1,A[6990]=27948,A[6989]=27948,A[6992]=27956,A[6991]=27956,A[6994]=27964,A[6993]=27964,A[6996]=27972,A[6995]=27972,A[6998]=27980,A[6997]=27980,A[7e3]=27988,A[6999]=27988,A[7002]=27996,A[7001]=27996,A[7004]=28004,A[7003]=28004,A[7006]=28012,A[7005]=28012,A[7008]=28020,A[7007]=28020,A[7010]=28028,A[7009]=28028,A[7012]=28036,A[7011]=28036,A[7014]=28044,A[7013]=28044,A[7016]=28052,A[7015]=28052,A[7018]=28060,A[7017]=28060,A[7020]=28068,A[7019]=28068,A[7022]=28076,A[7021]=28076,A[7024]=28084,A[7023]=28084,A[7026]=28092,A[7025]=28092,A[7028]=28100,A[7027]=28100,A[7030]=28108,A[7029]=28108,A[7032]=28116,A[7031]=28116,A[7034]=28124,A[7033]=28124,A[7036]=28132,A[7035]=28132,A[7038]=28140,A[7037]=28140,A[7040]=28148,A[7039]=28148,A[7042]=28156,A[7041]=28156,A[7044]=28164,A[7043]=28164,A[7046]=28172,A[7045]=28172,A[7048]=28180,A[7047]=28180,A[7050]=28188,A[7049]=28188,A[7052]=28196,A[7051]=28196,Xe=B+-40|0,At=O+8|0,At=(At&7|0)==0?0:0-At&7,ut=O+At|0,At=Xe-At|0,A[6983]=ut,A[6980]=At,A[ut+4>>2]=At|1,A[O+Xe+4>>2]=40,A[6984]=A[7099];while(!1);if(y=A[6980]|0,y>>>0>_e>>>0)return At=y-_e|0,A[6980]=At,Xe=A[6983]|0,ut=Xe+_e|0,A[6983]=ut,A[ut+4>>2]=At|1,A[Xe+4>>2]=_e|3,Xe=Xe+8|0,me=Yt,Xe|0}return Xe=He()|0,A[Xe>>2]=12,Xe=0,me=Yt,Xe|0}function Ke(g){g=g|0;var y=0,b=0,T=0,E=0,O=0,B=0,N=0,G=0;if(g){b=g+-8|0,E=A[6981]|0,g=A[g+-4>>2]|0,y=g&-8,G=b+y|0;do if(g&1)N=b,B=b;else{if(T=A[b>>2]|0,!(g&3)||(B=b+(0-T)|0,O=T+y|0,B>>>0<E>>>0))return;if((A[6982]|0)==(B|0)){if(g=G+4|0,y=A[g>>2]|0,(y&3|0)!=3){N=B,y=O;break}A[6979]=O,A[g>>2]=y&-2,A[B+4>>2]=O|1,A[B+O>>2]=O;return}if(b=T>>>3,T>>>0<256)if(g=A[B+8>>2]|0,y=A[B+12>>2]|0,(y|0)==(g|0)){A[6977]=A[6977]&~(1<<b),N=B,y=O;break}else{A[g+12>>2]=y,A[y+8>>2]=g,N=B,y=O;break}E=A[B+24>>2]|0,g=A[B+12>>2]|0;do if((g|0)==(B|0)){if(y=B+16|0,b=y+4|0,g=A[b>>2]|0,g)y=b;else if(g=A[y>>2]|0,!g){g=0;break}for(;;)if(T=g+20|0,b=A[T>>2]|0,b)g=b,y=T;else if(T=g+16|0,b=A[T>>2]|0,b)g=b,y=T;else break;A[y>>2]=0}else N=A[B+8>>2]|0,A[N+12>>2]=g,A[g+8>>2]=N;while(!1);if(E){if(y=A[B+28>>2]|0,b=28212+(y<<2)|0,(A[b>>2]|0)==(B|0)){if(A[b>>2]=g,!g){A[6978]=A[6978]&~(1<<y),N=B,y=O;break}}else if(N=E+16|0,A[((A[N>>2]|0)==(B|0)?N:E+20|0)>>2]=g,!g){N=B,y=O;break}A[g+24>>2]=E,y=B+16|0,b=A[y>>2]|0,b|0&&(A[g+16>>2]=b,A[b+24>>2]=g),y=A[y+4>>2]|0,y?(A[g+20>>2]=y,A[y+24>>2]=g,N=B,y=O):(N=B,y=O)}else N=B,y=O}while(!1);if(!(B>>>0>=G>>>0)&&(g=G+4|0,T=A[g>>2]|0,!!(T&1))){if(T&2)A[g>>2]=T&-2,A[N+4>>2]=y|1,A[B+y>>2]=y,E=y;else{if((A[6983]|0)==(G|0)){if(G=(A[6980]|0)+y|0,A[6980]=G,A[6983]=N,A[N+4>>2]=G|1,(N|0)!=(A[6982]|0))return;A[6982]=0,A[6979]=0;return}if((A[6982]|0)==(G|0)){G=(A[6979]|0)+y|0,A[6979]=G,A[6982]=B,A[N+4>>2]=G|1,A[B+G>>2]=G;return}E=(T&-8)+y|0,b=T>>>3;do if(T>>>0<256)if(y=A[G+8>>2]|0,g=A[G+12>>2]|0,(g|0)==(y|0)){A[6977]=A[6977]&~(1<<b);break}else{A[y+12>>2]=g,A[g+8>>2]=y;break}else{O=A[G+24>>2]|0,g=A[G+12>>2]|0;do if((g|0)==(G|0)){if(y=G+16|0,b=y+4|0,g=A[b>>2]|0,g)y=b;else if(g=A[y>>2]|0,!g){b=0;break}for(;;)if(T=g+20|0,b=A[T>>2]|0,b)g=b,y=T;else if(T=g+16|0,b=A[T>>2]|0,b)g=b,y=T;else break;A[y>>2]=0,b=g}else b=A[G+8>>2]|0,A[b+12>>2]=g,A[g+8>>2]=b,b=g;while(!1);if(O|0){if(g=A[G+28>>2]|0,y=28212+(g<<2)|0,(A[y>>2]|0)==(G|0)){if(A[y>>2]=b,!b){A[6978]=A[6978]&~(1<<g);break}}else if(T=O+16|0,A[((A[T>>2]|0)==(G|0)?T:O+20|0)>>2]=b,!b)break;A[b+24>>2]=O,g=G+16|0,y=A[g>>2]|0,y|0&&(A[b+16>>2]=y,A[y+24>>2]=b),g=A[g+4>>2]|0,g|0&&(A[b+20>>2]=g,A[g+24>>2]=b)}}while(!1);if(A[N+4>>2]=E|1,A[B+E>>2]=E,(N|0)==(A[6982]|0)){A[6979]=E;return}}if(g=E>>>3,E>>>0<256){b=27948+(g<<1<<2)|0,y=A[6977]|0,g=1<<g,y&g?(y=b+8|0,g=A[y>>2]|0):(A[6977]=y|g,g=b,y=b+8|0),A[y>>2]=N,A[g+12>>2]=N,A[N+8>>2]=g,A[N+12>>2]=b;return}g=E>>>8,g?E>>>0>16777215?T=31:(B=(g+1048320|0)>>>16&8,G=g<<B,O=(G+520192|0)>>>16&4,G=G<<O,T=(G+245760|0)>>>16&2,T=14-(O|B|T)+(G<<T>>>15)|0,T=E>>>(T+7|0)&1|T<<1):T=0,g=28212+(T<<2)|0,A[N+28>>2]=T,A[N+20>>2]=0,A[N+16>>2]=0,y=A[6978]|0,b=1<<T;e:do if(!(y&b))A[6978]=y|b,A[g>>2]=N,A[N+24>>2]=g,A[N+12>>2]=N,A[N+8>>2]=N;else{g=A[g>>2]|0;t:do if((A[g+4>>2]&-8|0)!=(E|0)){for(T=E<<((T|0)==31?0:25-(T>>>1)|0);b=g+16+(T>>>31<<2)|0,y=A[b>>2]|0,!!y;)if((A[y+4>>2]&-8|0)==(E|0)){g=y;break t}else T=T<<1,g=y;A[b>>2]=N,A[N+24>>2]=g,A[N+12>>2]=N,A[N+8>>2]=N;break e}while(!1);B=g+8|0,G=A[B>>2]|0,A[G+12>>2]=N,A[B>>2]=N,A[N+8>>2]=G,A[N+12>>2]=g,A[N+24>>2]=0}while(!1);if(G=(A[6985]|0)+-1|0,A[6985]=G,!(G|0)){for(g=28364;g=A[g>>2]|0,g;)g=g+8|0;A[6985]=-1}}}}function ct(g,y){g=g|0,y=y|0;var b=0;return g?(b=wc(y,g)|0,(y|g)>>>0>65535&&(b=((b>>>0)/(g>>>0)|0|0)==(y|0)?b:-1)):b=0,g=et(b)|0,!g||!(A[g+-4>>2]&3)||ro(g|0,0,b|0)|0,g|0}function Ye(g,y,b,T){return g=g|0,y=y|0,b=b|0,T=T|0,b=g+b>>>0,si(y+T+(b>>>0<g>>>0|0)>>>0|0),b|0|0}function gt(g,y,b,T){return g=g|0,y=y|0,b=b|0,T=T|0,T=y-T-(b>>>0>g>>>0|0)>>>0,si(T|0),g-b>>>0|0|0}function Gt(g){return g=g|0,(g?31-(Es(g^g-1)|0)|0:32)|0}function Ht(g,y,b,T,E){g=g|0,y=y|0,b=b|0,T=T|0,E=E|0;var O=0,B=0,N=0,G=0,K=0,te=0,_e=0,Ee=0,ke=0,Ie=0;if(te=g,G=y,K=G,B=b,Ee=T,N=Ee,!K)return O=(E|0)!=0,N?O?(A[E>>2]=g|0,A[E+4>>2]=y&0,Ee=0,E=0,si(Ee|0),E|0):(Ee=0,E=0,si(Ee|0),E|0):(O&&(A[E>>2]=(te>>>0)%(B>>>0),A[E+4>>2]=0),Ee=0,E=(te>>>0)/(B>>>0)>>>0,si(Ee|0),E|0);O=(N|0)==0;do if(B){if(!O){if(O=(Es(N|0)|0)-(Es(K|0)|0)|0,O>>>0<=31){_e=O+1|0,N=31-O|0,y=O-31>>31,B=_e,g=te>>>(_e>>>0)&y|K<<N,y=K>>>(_e>>>0)&y,O=0,N=te<<N;break}return E?(A[E>>2]=g|0,A[E+4>>2]=G|y&0,Ee=0,E=0,si(Ee|0),E|0):(Ee=0,E=0,si(Ee|0),E|0)}if(O=B-1|0,O&B|0){N=(Es(B|0)|0)+33-(Es(K|0)|0)|0,Ie=64-N|0,_e=32-N|0,G=_e>>31,ke=N-32|0,y=ke>>31,B=N,g=_e-1>>31&K>>>(ke>>>0)|(K<<_e|te>>>(N>>>0))&y,y=y&K>>>(N>>>0),O=te<<Ie&G,N=(K<<Ie|te>>>(ke>>>0))&G|te<<_e&N-33>>31;break}return E|0&&(A[E>>2]=O&te,A[E+4>>2]=0),(B|0)==1?(ke=G|y&0,Ie=g|0|0,si(ke|0),Ie|0):(Ie=Gt(B|0)|0,ke=K>>>(Ie>>>0)|0,Ie=K<<32-Ie|te>>>(Ie>>>0)|0,si(ke|0),Ie|0)}else{if(O)return E|0&&(A[E>>2]=(K>>>0)%(B>>>0),A[E+4>>2]=0),ke=0,Ie=(K>>>0)/(B>>>0)>>>0,si(ke|0),Ie|0;if(!te)return E|0&&(A[E>>2]=0,A[E+4>>2]=(K>>>0)%(N>>>0)),ke=0,Ie=(K>>>0)/(N>>>0)>>>0,si(ke|0),Ie|0;if(O=N-1|0,!(O&N))return E|0&&(A[E>>2]=g|0,A[E+4>>2]=O&K|y&0),ke=0,Ie=K>>>((Gt(N|0)|0)>>>0),si(ke|0),Ie|0;if(O=(Es(N|0)|0)-(Es(K|0)|0)|0,O>>>0<=30){y=O+1|0,N=31-O|0,B=y,g=K<<N|te>>>(y>>>0),y=K>>>(y>>>0),O=0,N=te<<N;break}return E?(A[E>>2]=g|0,A[E+4>>2]=G|y&0,ke=0,Ie=0,si(ke|0),Ie|0):(ke=0,Ie=0,si(ke|0),Ie|0)}while(!1);if(!B)K=N,G=0,N=0;else{_e=b|0|0,te=Ee|T&0,K=Ye(_e|0,te|0,-1,-1)|0,b=be()|0,G=N,N=0;do T=G,G=O>>>31|G<<1,O=N|O<<1,T=g<<1|T>>>31|0,Ee=g>>>31|y<<1|0,gt(K|0,b|0,T|0,Ee|0)|0,Ie=be()|0,ke=Ie>>31|((Ie|0)<0?-1:0)<<1,N=ke&1,g=gt(T|0,Ee|0,ke&_e|0,(((Ie|0)<0?-1:0)>>31|((Ie|0)<0?-1:0)<<1)&te|0)|0,y=be()|0,B=B-1|0;while((B|0)!=0);K=G,G=0}return B=0,E|0&&(A[E>>2]=g,A[E+4>>2]=y),ke=(O|0)>>>31|(K|B)<<1|(B<<1|O>>>31)&0|G,Ie=(O<<1|0)&-2|N,si(ke|0),Ie|0}function kt(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0;return K=y>>31|((y|0)<0?-1:0)<<1,G=((y|0)<0?-1:0)>>31|((y|0)<0?-1:0)<<1,O=T>>31|((T|0)<0?-1:0)<<1,E=((T|0)<0?-1:0)>>31|((T|0)<0?-1:0)<<1,N=gt(K^g|0,G^y|0,K|0,G|0)|0,B=be()|0,g=O^K,y=E^G,gt((Ht(N,B,gt(O^b|0,E^T|0,O|0,E|0)|0,be()|0,0)|0)^g|0,(be()|0)^y|0,g|0,y|0)|0}function pr(g,y){g=g|0,y=y|0;var b=0,T=0,E=0,O=0;return O=g&65535,E=y&65535,b=wc(E,O)|0,T=g>>>16,g=(b>>>16)+(wc(E,T)|0)|0,E=y>>>16,y=wc(E,O)|0,si((g>>>16)+(wc(E,T)|0)+(((g&65535)+y|0)>>>16)|0),g+y<<16|b&65535|0|0}function Ar(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0;return E=g,O=b,b=pr(E,O)|0,g=be()|0,si((wc(y,O)|0)+(wc(T,E)|0)+g|g&0|0),b|0|0|0}function Wi(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0,B=0,N=0,G=0,K=0;return E=me,me=me+16|0,N=E|0,B=y>>31|((y|0)<0?-1:0)<<1,O=((y|0)<0?-1:0)>>31|((y|0)<0?-1:0)<<1,K=T>>31|((T|0)<0?-1:0)<<1,G=((T|0)<0?-1:0)>>31|((T|0)<0?-1:0)<<1,g=gt(B^g|0,O^y|0,B|0,O|0)|0,y=be()|0,Ht(g,y,gt(K^b|0,G^T|0,K|0,G|0)|0,be()|0,N)|0,T=gt(A[N>>2]^B|0,A[N+4>>2]^O|0,B|0,O|0)|0,b=be()|0,me=E,si(b|0),T|0}function An(g,y,b,T){g=g|0,y=y|0,b=b|0,T=T|0;var E=0,O=0;return O=me,me=me+16|0,E=O|0,Ht(g,y,b,T,E)|0,me=O,si(A[E+4>>2]|0),A[E>>2]|0|0}function kn(g,y,b){return g=g|0,y=y|0,b=b|0,(b|0)<32?(si(y>>b|0),g>>>b|(y&(1<<b)-1)<<32-b):(si(((y|0)<0?-1:0)|0),y>>b-32|0)}function St(g,y,b){return g=g|0,y=y|0,b=b|0,(b|0)<32?(si(y>>>b|0),g>>>b|(y&(1<<b)-1)<<32-b):(si(0),y>>>b-32|0)}function Dt(g,y,b){return g=g|0,y=y|0,b=b|0,(b|0)<32?(si(y<<b|(g&(1<<b)-1<<32-b)>>>32-b|0),g<<b):(si(g<<b-32|0),0)}function ts(g,y,b){return g=g|0,y=y|0,b=b|0,y=Es(y)|0,(y|0)==32&&(y=y+(Es(g)|0)|0),si(0),y|0}function eo(g,y){return g=+g,y=+y,g!=g?+y:y!=y?+g:+Ux(+g,+y)}function $o(g,y){return g=+g,y=+y,g!=g?+y:y!=y?+g:+dA(+g,+y)}function to(g){return g=+g,g>=0?+So(g+.5):+hf(g-.5)}function Gn(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0;if((b|0)>=8192)return jx(g|0,y|0,b|0)|0,g|0;if(O=g|0,E=g+b|0,(g&3)==(y&3)){for(;g&3;){if(!b)return O|0;zt[g>>0]=zt[y>>0]|0,g=g+1|0,y=y+1|0,b=b-1|0}for(b=E&-4|0,T=b-64|0;(g|0)<=(T|0);)A[g>>2]=A[y>>2],A[g+4>>2]=A[y+4>>2],A[g+8>>2]=A[y+8>>2],A[g+12>>2]=A[y+12>>2],A[g+16>>2]=A[y+16>>2],A[g+20>>2]=A[y+20>>2],A[g+24>>2]=A[y+24>>2],A[g+28>>2]=A[y+28>>2],A[g+32>>2]=A[y+32>>2],A[g+36>>2]=A[y+36>>2],A[g+40>>2]=A[y+40>>2],A[g+44>>2]=A[y+44>>2],A[g+48>>2]=A[y+48>>2],A[g+52>>2]=A[y+52>>2],A[g+56>>2]=A[y+56>>2],A[g+60>>2]=A[y+60>>2],g=g+64|0,y=y+64|0;for(;(g|0)<(b|0);)A[g>>2]=A[y>>2],g=g+4|0,y=y+4|0}else for(b=E-4|0;(g|0)<(b|0);)zt[g>>0]=zt[y>>0]|0,zt[g+1>>0]=zt[y+1>>0]|0,zt[g+2>>0]=zt[y+2>>0]|0,zt[g+3>>0]=zt[y+3>>0]|0,g=g+4|0,y=y+4|0;for(;(g|0)<(E|0);)zt[g>>0]=zt[y>>0]|0,g=g+1|0,y=y+1|0;return O|0}function ro(g,y,b){g=g|0,y=y|0,b=b|0;var T=0,E=0,O=0,B=0;if(O=g+b|0,y=y&255,(b|0)>=67){for(;g&3;)zt[g>>0]=y,g=g+1|0;for(T=O&-4|0,B=y|y<<8|y<<16|y<<24,E=T-64|0;(g|0)<=(E|0);)A[g>>2]=B,A[g+4>>2]=B,A[g+8>>2]=B,A[g+12>>2]=B,A[g+16>>2]=B,A[g+20>>2]=B,A[g+24>>2]=B,A[g+28>>2]=B,A[g+32>>2]=B,A[g+36>>2]=B,A[g+40>>2]=B,A[g+44>>2]=B,A[g+48>>2]=B,A[g+52>>2]=B,A[g+56>>2]=B,A[g+60>>2]=B,g=g+64|0;for(;(g|0)<(T|0);)A[g>>2]=B,g=g+4|0}for(;(g|0)<(O|0);)zt[g>>0]=y,g=g+1|0;return O-b|0}function th(g){return g=+g,g>=0?+So(g+.5):+hf(g-.5)}function Ba(g){g=g|0;var y=0,b=0,T=0;return T=Mp()|0,b=A[Ys>>2]|0,y=b+g|0,(g|0)>0&(y|0)<(b|0)|(y|0)<0?($x(y|0)|0,Vx(12),-1):(y|0)>(T|0)&&!(B4(y|0)|0)?(Vx(12),-1):(A[Ys>>2]=y,b|0)}return{___divdi3:kt,___muldi3:Ar,___remdi3:Wi,___uremdi3:An,_areNeighborCells:Op,_bitshift64Ashr:kn,_bitshift64Lshr:St,_bitshift64Shl:Dt,_calloc:ct,_cellAreaKm2:Ov,_cellAreaM2:jA,_cellAreaRads2:xm,_cellToBoundary:Ql,_cellToCenterChild:Qu,_cellToChildPos:Ri,_cellToChildren:Zx,_cellToChildrenSize:Fp,_cellToLatLng:Jh,_cellToLocalIj:rw,_cellToParent:FA,_cellToVertex:ie,_cellToVertexes:re,_cellsToDirectedEdge:_m,_cellsToLinkedMultiPolygon:gA,_childPosToCell:zp,_compactCells:tl,_destroyLinkedMultiPolygon:$A,_directedEdgeToBoundary:Dp,_directedEdgeToCells:Af,_edgeLengthKm:jp,_edgeLengthM:_r,_edgeLengthRads:cu,_emscripten_replace_memory:gv,_free:Ke,_getBaseCellNumber:yf,_getDirectedEdgeDestination:kA,_getDirectedEdgeOrigin:Ev,_getHexagonAreaAvgKm2:lu,_getHexagonAreaAvgM2:Cn,_getHexagonEdgeLengthAvgKm:j4,_getHexagonEdgeLengthAvgM:UA,_getIcosahedronFaces:Np,_getNumCells:vf,_getPentagons:vm,_getRes0Cells:ff,_getResolution:Kh,_greatCircleDistanceKm:Vp,_greatCircleDistanceM:ew,_greatCircleDistanceRads:Jx,_gridDisk:pA,_gridDiskDistances:mA,_gridDistance:Wp,_gridPathCells:Sm,_gridPathCellsSize:W4,_gridRing:vv,_gridRingUnsafe:Gx,_i64Add:Ye,_i64Subtract:gt,_isPentagon:En,_isResClassIII:Kx,_isValidCell:LA,_isValidDirectedEdge:Qn,_isValidVertex:Ae,_latLngToCell:Tc,_llvm_ctlz_i64:ts,_llvm_maxnum_f64:eo,_llvm_minnum_f64:$o,_llvm_round_f64:to,_localIjToCell:$4,_malloc:et,_maxFaceCount:Qx,_maxGridDiskSize:yv,_maxPolygonToCellsSize:N4,_maxPolygonToCellsSizeExperimental:Tm,_memcpy:Gn,_memset:ro,_originToDirectedEdges:Xl,_pentagonCount:ed,_polygonToCells:z4,_polygonToCellsExperimental:WA,_readInt64AsDoubleFromPointer:v,_res0CellCount:wv,_round:th,_sbrk:Ba,_sizeOfCellBoundary:HA,_sizeOfCoordIJ:f,_sizeOfGeoLoop:qA,_sizeOfGeoPolygon:C,_sizeOfH3Index:Dv,_sizeOfLatLng:Lv,_sizeOfLinkedGeoPolygon:l,_uncompactCells:ua,_uncompactCellsSize:Zl,_vertexToLatLng:ae,establishStackSpace:su,stackAlloc:Av,stackRestore:fA,stackSave:Wx}})(rn,Jo,ze),Ws=e.___divdi3=Lt.___divdi3,ko=e.___muldi3=Lt.___muldi3,Zn=e.___remdi3=Lt.___remdi3,Vo=e.___uremdi3=Lt.___uremdi3,Ot=e._areNeighborCells=Lt._areNeighborCells,wo=e._bitshift64Ashr=Lt._bitshift64Ashr,ka=e._bitshift64Lshr=Lt._bitshift64Lshr,tf=e._bitshift64Shl=Lt._bitshift64Shl,Ra=e._calloc=Lt._calloc,Kt=e._cellAreaKm2=Lt._cellAreaKm2,fi=e._cellAreaM2=Lt._cellAreaM2,Si=e._cellAreaRads2=Lt._cellAreaRads2,ql=e._cellToBoundary=Lt._cellToBoundary,im=e._cellToCenterChild=Lt._cellToCenterChild,Gu=e._cellToChildPos=Lt._cellToChildPos,Kr=e._cellToChildren=Lt._cellToChildren,rf=e._cellToChildrenSize=Lt._cellToChildrenSize,yp=e._cellToLatLng=Lt._cellToLatLng,_p=e._cellToLocalIj=Lt._cellToLocalIj,nm=e._cellToParent=Lt._cellToParent,nf=e._cellToVertex=Lt._cellToVertex,om=e._cellToVertexes=Lt._cellToVertexes,Hu=e._cellsToDirectedEdge=Lt._cellsToDirectedEdge,Oa=e._cellsToLinkedMultiPolygon=Lt._cellsToLinkedMultiPolygon,Ii=e._childPosToCell=Lt._childPosToCell,k4=e._compactCells=Lt._compactCells,vp=e._destroyLinkedMultiPolygon=Lt._destroyLinkedMultiPolygon,of=e._directedEdgeToBoundary=Lt._directedEdgeToBoundary,$h=e._directedEdgeToCells=Lt._directedEdgeToCells,Wh=e._edgeLengthKm=Lt._edgeLengthKm,Rx=e._edgeLengthM=Lt._edgeLengthM,lv=e._edgeLengthRads=Lt._edgeLengthRads,cv=e._emscripten_replace_memory=Lt._emscripten_replace_memory,sf=e._free=Lt._free,Ox=e._getBaseCellNumber=Lt._getBaseCellNumber,R4=e._getDirectedEdgeDestination=Lt._getDirectedEdgeDestination,O4=e._getDirectedEdgeOrigin=Lt._getDirectedEdgeOrigin,D4=e._getHexagonAreaAvgKm2=Lt._getHexagonAreaAvgKm2,Dx=e._getHexagonAreaAvgM2=Lt._getHexagonAreaAvgM2,Lx=e._getHexagonEdgeLengthAvgKm=Lt._getHexagonEdgeLengthAvgKm,uv=e._getHexagonEdgeLengthAvgM=Lt._getHexagonEdgeLengthAvgM,aA=e._getIcosahedronFaces=Lt._getIcosahedronFaces,bp=e._getNumCells=Lt._getNumCells,hv=e._getPentagons=Lt._getPentagons,dv=e._getRes0Cells=Lt._getRes0Cells,sm=e._getResolution=Lt._getResolution,am=e._greatCircleDistanceKm=Lt._greatCircleDistanceKm,lA=e._greatCircleDistanceM=Lt._greatCircleDistanceM,Bx=e._greatCircleDistanceRads=Lt._greatCircleDistanceRads,af=e._gridDisk=Lt._gridDisk,fv=e._gridDiskDistances=Lt._gridDiskDistances,iu=e._gridDistance=Lt._gridDistance,gi=e._gridPathCells=Lt._gridPathCells,bc=e._gridPathCellsSize=Lt._gridPathCellsSize,ci=e._gridRing=Lt._gridRing,cA=e._gridRingUnsafe=Lt._gridRingUnsafe,Fx=e._i64Add=Lt._i64Add,lm=e._i64Subtract=Lt._i64Subtract,Gs=e._isPentagon=Lt._isPentagon,Ts=e._isResClassIII=Lt._isResClassIII,ca=e._isValidCell=Lt._isValidCell,hs=e._isValidDirectedEdge=Lt._isValidDirectedEdge,$n=e._isValidVertex=Lt._isValidVertex,L4=e._latLngToCell=Lt._latLngToCell,Hs=e._llvm_ctlz_i64=Lt._llvm_ctlz_i64,qs=e._llvm_maxnum_f64=Lt._llvm_maxnum_f64,Ja=e._llvm_minnum_f64=Lt._llvm_minnum_f64,pv=e._llvm_round_f64=Lt._llvm_round_f64,xp=e._localIjToCell=Lt._localIjToCell,uo=e._malloc=Lt._malloc,Mn=e._maxFaceCount=Lt._maxFaceCount,qu=e._maxGridDiskSize=Lt._maxGridDiskSize,$i=e._maxPolygonToCellsSize=Lt._maxPolygonToCellsSize,zr=e._maxPolygonToCellsSizeExperimental=Lt._maxPolygonToCellsSizeExperimental,uA=e._memcpy=Lt._memcpy,ki=e._memset=Lt._memset,mv=e._originToDirectedEdges=Lt._originToDirectedEdges,nu=e._pentagonCount=Lt._pentagonCount,wp=e._polygonToCells=Lt._polygonToCells,lf=e._polygonToCellsExperimental=Lt._polygonToCellsExperimental,cm=e._readInt64AsDoubleFromPointer=Lt._readInt64AsDoubleFromPointer,um=e._res0CellCount=Lt._res0CellCount,Xt=e._round=Lt._round,ur=e._sbrk=Lt._sbrk,Ir=e._sizeOfCellBoundary=Lt._sizeOfCellBoundary,Di=e._sizeOfCoordIJ=Lt._sizeOfCoordIJ,Qi=e._sizeOfGeoLoop=Lt._sizeOfGeoLoop,Hi=e._sizeOfGeoPolygon=Lt._sizeOfGeoPolygon,Wn=e._sizeOfH3Index=Lt._sizeOfH3Index,ou=e._sizeOfLatLng=Lt._sizeOfLatLng,Yl=e._sizeOfLinkedGeoPolygon=Lt._sizeOfLinkedGeoPolygon,ho=e._uncompactCells=Lt._uncompactCells,Sp=e._uncompactCellsSize=Lt._uncompactCellsSize,cf=e._vertexToLatLng=Lt._vertexToLatLng,Ro=e.establishStackSpace=Lt.establishStackSpace,xc=e.stackAlloc=Lt.stackAlloc,Oo=e.stackRestore=Lt.stackRestore,Gh=e.stackSave=Lt.stackSave;if(e.asm=Lt,e.cwrap=ee,e.setValue=F,e.getValue=j,Ia){Je(Ia)||(Ia=s(Ia));{bl("memory initializer");var uf=function(vt){vt.byteLength&&(vt=new Uint8Array(vt)),at.set(vt,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,rm("memory initializer")},hA=function(){a(Ia,uf,function(){throw"could not load memory initializer "+Ia})},Yu=di(Ia);if(Yu)uf(Yu.buffer);else if(e.memoryInitializerRequest){var Tp=function(){var vt=e.memoryInitializerRequest,Nt=vt.response;if(vt.status!==200&&vt.status!==0){var sr=di(e.memoryInitializerRequestURL);if(sr)Nt=sr.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+vt.status+", retrying "+Ia),hA();return}}uf(Nt)};e.memoryInitializerRequest.response?setTimeout(Tp,0):e.memoryInitializerRequest.addEventListener("load",Tp)}else hA()}}var Hh;vc=function vt(){Hh||el(),Hh||(vc=vt)};function el(vt){if(vt=vt||n,us>0||(_l(),us>0))return;function Nt(){Hh||(Hh=!0,!H&&(xn(),dn(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Pa()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Nt()},1)):Nt()}e.run=el;function Xu(vt){throw e.onAbort&&e.onAbort(vt),vt+="",u(vt),p(vt),H=!0,"abort("+vt+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Xu,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return el(),t})(typeof Us=="object"?Us:{}),wi="number",ni=wi,jI=wi,bi=wi,xi=wi,ml=wi,Tr=wi,zet=[["sizeOfH3Index",wi],["sizeOfLatLng",wi],["sizeOfCellBoundary",wi],["sizeOfGeoLoop",wi],["sizeOfGeoPolygon",wi],["sizeOfLinkedGeoPolygon",wi],["sizeOfCoordIJ",wi],["readInt64AsDoubleFromPointer",wi],["isValidCell",jI,[bi,xi]],["latLngToCell",ni,[wi,wi,ml,Tr]],["cellToLatLng",ni,[bi,xi,Tr]],["cellToBoundary",ni,[bi,xi,Tr]],["maxGridDiskSize",ni,[wi,Tr]],["gridDisk",ni,[bi,xi,wi,Tr]],["gridDiskDistances",ni,[bi,xi,wi,Tr,Tr]],["gridRing",ni,[bi,xi,wi,Tr]],["gridRingUnsafe",ni,[bi,xi,wi,Tr]],["maxPolygonToCellsSize",ni,[Tr,ml,wi,Tr]],["polygonToCells",ni,[Tr,ml,wi,Tr]],["maxPolygonToCellsSizeExperimental",ni,[Tr,ml,wi,Tr]],["polygonToCellsExperimental",ni,[Tr,ml,wi,wi,wi,Tr]],["cellsToLinkedMultiPolygon",ni,[Tr,wi,Tr]],["destroyLinkedMultiPolygon",null,[Tr]],["compactCells",ni,[Tr,Tr,wi,wi]],["uncompactCells",ni,[Tr,wi,wi,Tr,wi,ml]],["uncompactCellsSize",ni,[Tr,wi,wi,ml,Tr]],["isPentagon",jI,[bi,xi]],["isResClassIII",jI,[bi,xi]],["getBaseCellNumber",wi,[bi,xi]],["getResolution",wi,[bi,xi]],["maxFaceCount",ni,[bi,xi,Tr]],["getIcosahedronFaces",ni,[bi,xi,Tr]],["cellToParent",ni,[bi,xi,ml,Tr]],["cellToChildren",ni,[bi,xi,ml,Tr]],["cellToCenterChild",ni,[bi,xi,ml,Tr]],["cellToChildrenSize",ni,[bi,xi,ml,Tr]],["cellToChildPos",ni,[bi,xi,ml,Tr]],["childPosToCell",ni,[wi,wi,bi,xi,ml,Tr]],["areNeighborCells",ni,[bi,xi,bi,xi,Tr]],["cellsToDirectedEdge",ni,[bi,xi,bi,xi,Tr]],["getDirectedEdgeOrigin",ni,[bi,xi,Tr]],["getDirectedEdgeDestination",ni,[bi,xi,Tr]],["isValidDirectedEdge",jI,[bi,xi]],["directedEdgeToCells",ni,[bi,xi,Tr]],["originToDirectedEdges",ni,[bi,xi,Tr]],["directedEdgeToBoundary",ni,[bi,xi,Tr]],["gridDistance",ni,[bi,xi,bi,xi,Tr]],["gridPathCells",ni,[bi,xi,bi,xi,Tr]],["gridPathCellsSize",ni,[bi,xi,bi,xi,Tr]],["cellToLocalIj",ni,[bi,xi,bi,xi,wi,Tr]],["localIjToCell",ni,[bi,xi,Tr,wi,Tr]],["getHexagonAreaAvgM2",ni,[ml,Tr]],["getHexagonAreaAvgKm2",ni,[ml,Tr]],["getHexagonEdgeLengthAvgM",ni,[ml,Tr]],["getHexagonEdgeLengthAvgKm",ni,[ml,Tr]],["greatCircleDistanceM",wi,[Tr,Tr]],["greatCircleDistanceKm",wi,[Tr,Tr]],["greatCircleDistanceRads",wi,[Tr,Tr]],["cellAreaM2",ni,[bi,xi,Tr]],["cellAreaKm2",ni,[bi,xi,Tr]],["cellAreaRads2",ni,[bi,xi,Tr]],["edgeLengthM",ni,[bi,xi,Tr]],["edgeLengthKm",ni,[bi,xi,Tr]],["edgeLengthRads",ni,[bi,xi,Tr]],["getNumCells",ni,[ml,Tr]],["getRes0Cells",ni,[Tr]],["res0CellCount",wi],["getPentagons",ni,[wi,Tr]],["pentagonCount",wi],["cellToVertex",ni,[bi,xi,wi,Tr]],["cellToVertexes",ni,[bi,xi,Tr]],["vertexToLatLng",ni,[bi,xi,Tr]],["isValidVertex",jI,[bi,xi]]],Uet=0,Vet=1,jet=2,$et=3,xTe=4,Wet=5,Get=6,Het=7,qet=8,Yet=9,Xet=10,Zet=11,Ket=12,Qet=13,Jet=14,ett=15,zl={};zl[Uet]="Success";zl[Vet]="The operation failed but a more specific error is not available";zl[jet]="Argument was outside of acceptable range";zl[$et]="Latitude or longitude arguments were outside of acceptable range";zl[xTe]="Resolution argument was outside of acceptable range";zl[Wet]="Cell argument was not valid";zl[Get]="Directed edge argument was not valid";zl[Het]="Undirected edge argument was not valid";zl[qet]="Vertex argument was not valid";zl[Yet]="Pentagon distortion was encountered";zl[Xet]="Duplicate input";zl[Zet]="Cell arguments were not neighbors";zl[Ket]="Cell arguments had incompatible resolutions";zl[Qet]="Memory allocation failed";zl[Jet]="Bounds of provided memory were insufficient";zl[ett]="Mode or flags argument was not valid";var wTe=1e3,ttt=1001,STe=1002,CN={};CN[wTe]="Unknown unit";CN[ttt]="Array length out of bounds";CN[STe]="Got unexpected null value for H3 index";var rtt="Unknown error";function TTe(t,e,r){var i=r&&"value"in r,n=new Error((t[e]||rtt)+" (code: "+e+(i?", value: "+r.value:"")+")");return n.code=e,n}function MTe(t,e){var r=arguments.length===2?{value:e}:{};return TTe(zl,t,r)}function ETe(t,e){var r=arguments.length===2?{value:e}:{};return TTe(CN,t,r)}function lT(t){if(t!==0)throw MTe(t)}var gl={};zet.forEach(function(e){gl[e[0]]=Us.cwrap.apply(Us,e)});var aT=16;var itt=4;var Kb=8,ntt=8,cee=gl.sizeOfH3Index(),CTe=gl.sizeOfLatLng(),ott=gl.sizeOfCellBoundary(),Pdr=gl.sizeOfGeoPolygon(),Idr=gl.sizeOfGeoLoop(),kdr=gl.sizeOfLinkedGeoPolygon(),Rdr=gl.sizeOfCoordIJ(),vTe={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function stt(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw MTe(xTe,t);return t}function att(t){if(!t)throw ETe(STe);return t}var Odr=Math.pow(2,32)-1;var ltt=/[^0-9a-fA-F]/;function cT(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||ltt.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),aT),r=parseInt(t.substring(t.length-8),aT);return[r,e]}function bTe(t){if(t>=0)return t.toString(aT);t=t&2147483647;var e=PTe(8,t.toString(aT)),r=(parseInt(e[0],aT)+8).toString(aT);return e=r+e.substring(1),e}function ctt(t,e){return bTe(e)+PTe(8,bTe(t))}function PTe(t,e){for(var r=t-e.length,i="",n=0;n<r;n++)i+="0";return i=i+e,i}var Ddr=Math.pow(2,32);function utt(t,e){e===void 0&&(e=0);var r=Us.getValue(t+cee*e,"i32"),i=Us.getValue(t+cee*e+itt,"i32");return i?ctt(r,i):null}function htt(t,e){return e===void 0&&(e=0),Us.getValue(t+Kb*e,"double")}function dtt(t){return gl.readInt64AsDoubleFromPointer(t)}function EN(t){return gtt(Us.getValue(t,"double"))}function ITe(t){return[EN(t),EN(t+Kb)]}function ftt(t){return[EN(t+Kb),EN(t)]}function ptt(t,e,r){for(var i=Us.getValue(t,"i32"),n=t+Kb,o=[],s=e?ftt:ITe,a=0;a<i*2;a+=2)o.push(s(n+Kb*a));return r&&o.push(o[0]),o}function kTe(t){var e=cT(t),r=e[0],i=e[1];return!!gl.isPentagon(r,i)}function RTe(t){var e=cT(t),r=e[0],i=e[1];return gl.isValidCell(r,i)?gl.getResolution(r,i):-1}function OTe(t,e,r){var i=Us._malloc(CTe);Us.HEAPF64.set([t,e].map(mtt),i/Kb);var n=Us._malloc(cee);try{return lT(gl.latLngToCell(i,r,n)),att(utt(n))}finally{Us._free(n),Us._free(i)}}function $I(t){var e=Us._malloc(CTe),r=cT(t),i=r[0],n=r[1];try{return lT(gl.cellToLatLng(i,n,e)),ITe(e)}finally{Us._free(e)}}function DTe(t,e){var r=Us._malloc(ott),i=cT(t),n=i[0],o=i[1];try{return lT(gl.cellToBoundary(n,o,r)),ptt(r,e,e)}finally{Us._free(r)}}function LTe(t,e){var r=cT(t),i=r[0],n=r[1],o=cT(e),s=o[0],a=o[1],u=Us._malloc(ntt);try{return lT(gl.gridDistance(i,n,s,a,u)),dtt(u)}finally{Us._free(u)}}function BTe(t,e){stt(t);var r=Us._malloc(Kb);try{switch(e){case vTe.m:lT(gl.getHexagonEdgeLengthAvgM(t,r));break;case vTe.km:lT(gl.getHexagonEdgeLengthAvgKm(t,r));break;default:throw ETe(wTe,e)}return htt(r)}finally{Us._free(r)}}function mtt(t){return t*Math.PI/180}function gtt(t){return t*180/Math.PI}function FTe(t,e){e=e===void 0?t[0][0]:e;for(let r of t){let i=r[0]-e;i>180?r[0]-=360:i<-180&&(r[0]+=360)}}function Att(t,e,r){let[i,n]=$I(t),o=e.length;FTe(e,n);let s=e[0]===e[o-1]?o-1:o;for(let a=0;a<s;a++)e[a][0]=sc(n,e[a][0],r),e[a][1]=sc(i,e[a][1],r)}function NTe(t,e,r){let i=t(e,r),[n,o]=$I(i);return[o,n]}function uee(t,e=1){let r=DTe(t,!0);return e!==1?Att(t,r,e):FTe(r),r}function PN(t){let e=new Float64Array(t.length*2),r=0;for(let i of t)e[r++]=i[0],e[r++]=i[1];return e}var ytt={getPentagon:{type:"accessor",value:t=>t.pentagon}},WI=class extends tT{indexToBounds(){let{data:e,getPentagon:r}=this.props;return{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(i,n)=>{let o=r(i,n),s=yTe(typeof o=="string"?_Te(o):o,{closedRing:!0,segments:"auto"});return PN(s)}}}};WI.layerName="A5Layer";WI.defaultProps=ytt;var IN=WI;var kN=Tt(hee(),1),_tt=3,vtt=30,btt=2*vtt+1,UTe=180/Math.PI;function jTe(t,e,r){let i=1<<e;return[(t[0]+r[0])/i,(t[1]+r[1])/i]}function VTe(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function $Te(t){return[VTe(t[0]),VTe(t[1])]}function WTe(t,[e,r]){switch(t){case 0:return[1,e,r];case 1:return[-e,1,r];case 2:return[-e,-r,1];case 3:return[-1,-r,-e];case 4:return[r,-1,-e];case 5:return[r,e,-1];default:throw new Error("Invalid face")}}function GTe([t,e,r]){let i=Math.atan2(r,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*UTe,i*UTe]}function HTe(t){let e=kN.default.fromString(t,!0,10).toString(2);for(;e.length<_tt+btt;)e="0"+e;let r=e.lastIndexOf("1"),i=e.substring(0,3),n=e.substring(3,r),o=n.length/2,s=kN.default.fromString(i,!0,2).toString(10),a=kN.default.fromString(n,!0,2).toString(4);for(;a.length<o;)a="0"+a;return`${s}/${a}`}function xtt(t,e,r,i){if(i===0){r===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);let n=e[0];e[0]=e[1],e[1]=n}}function qTe(t){let e=t.split("/"),r=parseInt(e[0],10),i=e[1],n=i.length,o=[0,0],s;for(let a=n-1;a>=0;a--){s=n-a;let u=i[a],p=0,m=0;u==="1"?m=1:u==="2"?(p=1,m=1):u==="3"&&(p=1);let x=Math.pow(2,s-1);xtt(x,o,p,m),o[0]+=x*p,o[1]+=x*m}if(r%2===1){let a=o[0];o[0]=o[1],o[1]=a}return{face:r,ij:o,level:s}}var YTe=Tt(hee(),1);function wtt(t){let e=t.padEnd(16,"0");return YTe.default.fromString(e,16)}var Stt=100;function Ttt({face:t,ij:e,level:r}){let i=[[0,0],[0,1],[1,1],[1,0],[0,0]],n=Math.max(1,Math.ceil(Stt*Math.pow(2,-r))),o=new Float64Array(4*n*2+2),s=0,a=0;for(let u=0;u<4;u++){let p=i[u].slice(0),m=i[u+1],x=(m[0]-p[0])/n,M=(m[1]-p[1])/n;for(let k=0;k<n;k++){p[0]+=x,p[1]+=M;let F=jTe(e,r,p),j=$Te(F),H=WTe(t,j),W=GTe(H);Math.abs(W[1])>89.999&&(W[0]=a);let Z=W[0]-a;W[0]+=Z>180?-360:Z<-180?360:0,o[s++]=W[0],o[s++]=W[1],a=W[0]}}return o[s++]=o[0],o[s++]=o[1],o}function Mtt(t){if(typeof t=="string"){if(t.indexOf("/")>0)return t;t=wtt(t)}return HTe(t.toString())}function XTe(t){let e=Mtt(t),r=qTe(e);return Ttt(r)}var Ett={getS2Token:{type:"accessor",value:t=>t.token}},HI=class extends tT{indexToBounds(){let{data:e,getS2Token:r}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(i,n)=>XTe(r(i,n))}}};HI.layerName="S2Layer";HI.defaultProps=Ett;var RN=HI;var ON=class{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){let e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:r,onLoad:i,onError:n}){let{index:o,id:s,bbox:a,userData:u,zoom:p}=this,m=this._loaderId;this._abortController=new AbortController;let{signal:x}=this._abortController,M=await r.scheduleRequest(this,j=>j.isSelected?1:-1);if(!M){this._isCancelled=!0;return}if(this._isCancelled){M.done();return}let k=null,F;try{k=await e({index:o,id:s,bbox:a,userData:u,zoom:p,signal:x})}catch(j){F=j||!0}finally{M.done()}if(m===this._loaderId){if(this._loader=void 0,this.content=k,this._isCancelled&&!k){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,F?n(F,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}};var aa={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};var ZTe=new lr,Ctt=new lr,uT=class t{constructor(e=[0,0,0],r=[0,0,0],i){i=i||ZTe.copy(e).add(r).scale(.5),this.center=new lr(i),this.halfDiagonal=new lr(r).subtract(this.center),this.minimum=new lr(e),this.maximum=new lr(r)}clone(){return new t(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){let{halfDiagonal:r}=this,i=Ctt.from(e.normal),n=r.x*Math.abs(i.x)+r.y*Math.abs(i.y)+r.z*Math.abs(i.z),o=this.center.dot(i)+e.distance;return o-n>0?aa.INSIDE:o+n<0?aa.OUTSIDE:aa.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){let r=ZTe.from(e).subtract(this.center),{halfDiagonal:i}=this,n=0,o;return o=Math.abs(r.x)-i.x,o>0&&(n+=o*o),o=Math.abs(r.y)-i.y,o>0&&(n+=o*o),o=Math.abs(r.z)-i.z,o>0&&(n+=o*o),n}};var qI=new lr,KTe=new lr,hT=class t{constructor(e=[0,0,0],r=0){this.radius=-0,this.center=new lr,this.fromCenterRadius(e,r)}fromCenterRadius(e,r){return this.center.from(e),this.radius=r,this}fromCornerPoints(e,r){return r=qI.from(r),this.center=new lr().from(e).add(r).scale(.5),this.radius=this.center.distance(r),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new t(this.center,this.radius)}union(e){let r=this.center,i=this.radius,n=e.center,o=e.radius,s=qI.copy(n).subtract(r),a=s.magnitude();if(i>=a+o)return this.clone();if(o>=a+i)return e.clone();let u=(i+a+o)*.5;return KTe.copy(s).scale((-i+u)/a).add(r),this.center.copy(KTe),this.radius=u,this}expand(e){let i=qI.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);let r=ia.getScaling(qI,e);return this.radius=Math.max(r[0],Math.max(r[1],r[2]))*this.radius,this}distanceSquaredTo(e){let r=this.distanceTo(e);return r*r}distanceTo(e){let i=qI.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){let r=this.center,i=this.radius,o=e.normal.dot(r)+e.distance;return o<-i?aa.OUTSIDE:o<i?aa.INTERSECTING:aa.INSIDE}};var Ptt=new lr,Itt=new lr,DN=new lr,LN=new lr,BN=new lr,ktt=new lr,Rtt=new lr,Yg={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},YI=class t{constructor(e=[0,0,0],r=[0,0,0,0,0,0,0,0,0]){this.center=new lr().from(e),this.halfAxes=new gs(r)}get halfSize(){let e=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new lr(e).len(),new lr(r).len(),new lr(i).len()]}get quaternion(){let e=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),n=new lr(e).normalize(),o=new lr(r).normalize(),s=new lr(i).normalize();return new E3().fromMatrix3(new gs([...n,...o,...s]))}fromCenterHalfSizeQuaternion(e,r,i){let n=new E3(i),o=new gs().fromQuaternion(n);return o[0]=o[0]*r[0],o[1]=o[1]*r[0],o[2]=o[2]*r[0],o[3]=o[3]*r[1],o[4]=o[4]*r[1],o[5]=o[5]*r[1],o[6]=o[6]*r[2],o[7]=o[7]*r[2],o[8]=o[8]*r[2],this.center=new lr().from(e),this.halfAxes=o,this}clone(){return new t(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new hT){let r=this.halfAxes,i=r.getColumn(0,DN),n=r.getColumn(1,LN),o=r.getColumn(2,BN),s=Ptt.copy(i).add(n).add(o);return e.center.copy(this.center),e.radius=s.magnitude(),e}intersectPlane(e){let r=this.center,i=e.normal,n=this.halfAxes,o=i.x,s=i.y,a=i.z,u=Math.abs(o*n[Yg.COLUMN0ROW0]+s*n[Yg.COLUMN0ROW1]+a*n[Yg.COLUMN0ROW2])+Math.abs(o*n[Yg.COLUMN1ROW0]+s*n[Yg.COLUMN1ROW1]+a*n[Yg.COLUMN1ROW2])+Math.abs(o*n[Yg.COLUMN2ROW0]+s*n[Yg.COLUMN2ROW1]+a*n[Yg.COLUMN2ROW2]),p=i.dot(r)+e.distance;return p<=-u?aa.OUTSIDE:p>=u?aa.INSIDE:aa.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){let r=Itt.from(e).subtract(this.center),i=this.halfAxes,n=i.getColumn(0,DN),o=i.getColumn(1,LN),s=i.getColumn(2,BN),a=n.magnitude(),u=o.magnitude(),p=s.magnitude();n.normalize(),o.normalize(),s.normalize();let m=0,x;return x=Math.abs(r.dot(n))-a,x>0&&(m+=x*x),x=Math.abs(r.dot(o))-u,x>0&&(m+=x*x),x=Math.abs(r.dot(s))-p,x>0&&(m+=x*x),m}computePlaneDistances(e,r,i=[-0,-0]){let n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=this.center,a=this.halfAxes,u=a.getColumn(0,DN),p=a.getColumn(1,LN),m=a.getColumn(2,BN),x=ktt.copy(u).add(p).add(m).add(s),M=Rtt.copy(x).subtract(e),k=r.dot(M);return n=Math.min(k,n),o=Math.max(k,o),x.copy(s).add(u).add(p).subtract(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),x.copy(s).add(u).subtract(p).add(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),x.copy(s).add(u).subtract(p).subtract(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),s.copy(x).subtract(u).add(p).add(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),s.copy(x).subtract(u).add(p).subtract(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),s.copy(x).subtract(u).subtract(p).add(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),s.copy(x).subtract(u).subtract(p).subtract(m),M.copy(x).subtract(e),k=r.dot(M),n=Math.min(k,n),o=Math.max(k,o),i[0]=n,i[1]=o,i}transform(e){this.center.transformAsPoint(e);let r=this.halfAxes.getColumn(0,DN);r.transformAsPoint(e);let i=this.halfAxes.getColumn(1,LN);i.transformAsPoint(e);let n=this.halfAxes.getColumn(2,BN);return n.transformAsPoint(e),this.halfAxes=new gs([...r,...i,...n]),this}getTransform(){throw new Error("not implemented")}};var QTe=new lr,JTe=new lr,Xg=class t{constructor(e=[0,0,1],r=0){this.normal=new lr,this.distance=-0,this.fromNormalDistance(e,r)}fromNormalDistance(e,r){return m0(Number.isFinite(r)),this.normal.from(e).normalize(),this.distance=r,this}fromPointNormal(e,r){e=QTe.from(e),this.normal.from(r).normalize();let i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,r,i,n){return this.normal.set(e,r,i),m0(ra(this.normal.len(),1)),this.distance=n,this}clone(){return new t(this.normal,this.distance)}equals(e){return ra(this.distance,e.distance)&&ra(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){let r=JTe.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,r)}projectPointOntoPlane(e,r=[0,0,0]){let i=QTe.from(e),n=this.getPointDistance(i),o=JTe.copy(this.normal).scale(n);return i.subtract(o).to(r)}};var e4e=[new lr([1,0,0]),new lr([0,1,0]),new lr([0,0,1])],t4e=new lr,Ott=new lr,Zg=class t{constructor(e=[]){this.planes=e}fromBoundingSphere(e){this.planes.length=2*e4e.length;let r=e.center,i=e.radius,n=0;for(let o of e4e){let s=this.planes[n],a=this.planes[n+1];s||(s=this.planes[n]=new Xg),a||(a=this.planes[n+1]=new Xg);let u=t4e.copy(o).scale(-i).add(r);s.fromPointNormal(u,o);let p=t4e.copy(o).scale(i).add(r),m=Ott.copy(o).negate();a.fromPointNormal(p,m),n+=2}return this}computeVisibility(e){let r=aa.INSIDE;for(let i of this.planes)switch(e.intersectPlane(i)){case aa.OUTSIDE:return aa.OUTSIDE;case aa.INTERSECTING:r=aa.INTERSECTING;break;default:}return r}computeVisibilityWithPlaneMask(e,r){if(m0(Number.isFinite(r),"parentPlaneMask is required."),r===t.MASK_OUTSIDE||r===t.MASK_INSIDE)return r;let i=t.MASK_INSIDE,n=this.planes;for(let o=0;o<this.planes.length;++o){let s=o<31?1<<o:0;if(o<31&&(r&s)===0)continue;let a=n[o],u=e.intersectPlane(a);if(u===aa.OUTSIDE)return t.MASK_OUTSIDE;u===aa.INTERSECTING&&(i|=s)}return i}};Zg.MASK_OUTSIDE=4294967295;Zg.MASK_INSIDE=0;Zg.MASK_INDETERMINATE=2147483647;var Afr=new lr,yfr=new lr,_fr=new lr,vfr=new lr,bfr=new lr;var Efr=new lr,Cfr=new lr,Pfr=new lr,Ifr=new lr,kfr=new lr,Rfr=new lr,Ofr=new lr,Dfr=new lr,Lfr=new lr,Bfr=new lr,Ffr=new lr,Nfr=new lr;var W0=new gs,Ltt=new gs,Btt=new gs,FN=new gs,r4e=new gs;function pee(t,e={}){let r=M5.EPSILON20,i=10,n=0,o=0,s=Ltt,a=Btt;s.identity(),a.copy(t);let u=r*Ftt(a);for(;o<i&&Ntt(a)>u;)ztt(a,FN),r4e.copy(FN).transpose(),a.multiplyRight(FN),a.multiplyLeft(r4e),s.multiplyRight(FN),++n>2&&(++o,n=0);return e.unitary=s.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function Ftt(t){let e=0;for(let r=0;r<9;++r){let i=t[r];e+=i*i}return Math.sqrt(e)}var dee=[1,0,0],fee=[2,2,1];function Ntt(t){let e=0;for(let r=0;r<3;++r){let i=t[W0.getElementIndex(fee[r],dee[r])];e+=2*i*i}return Math.sqrt(e)}function ztt(t,e){let r=M5.EPSILON15,i=0,n=1;for(let p=0;p<3;++p){let m=Math.abs(t[W0.getElementIndex(fee[p],dee[p])]);m>i&&(n=p,i=m)}let o=dee[n],s=fee[n],a=1,u=0;if(Math.abs(t[W0.getElementIndex(s,o)])>r){let p=t[W0.getElementIndex(s,s)],m=t[W0.getElementIndex(o,o)],x=t[W0.getElementIndex(s,o)],M=(p-m)/2/x,k;M<0?k=-1/(-M+Math.sqrt(1+M*M)):k=1/(M+Math.sqrt(1+M*M)),a=1/Math.sqrt(1+k*k),u=k*a}return gs.IDENTITY.to(e),e[W0.getElementIndex(o,o)]=e[W0.getElementIndex(s,s)]=a,e[W0.getElementIndex(s,o)]=u,e[W0.getElementIndex(o,s)]=-u,e}var N_=new lr,Utt=new lr,Vtt=new lr,jtt=new lr,$tt=new lr,Wtt=new gs,Gtt={diagonal:new gs,unitary:new gs};function mee(t,e=new YI){if(!t||t.length===0)return e.halfAxes=new gs([0,0,0,0,0,0,0,0,0]),e.center=new lr,e;let r=t.length,i=new lr(0,0,0);for(let pe of t)i.add(pe);let n=1/r;i.multiplyByScalar(n);let o=0,s=0,a=0,u=0,p=0,m=0;for(let pe of t){let ue=N_.copy(pe).subtract(i);o+=ue.x*ue.x,s+=ue.x*ue.y,a+=ue.x*ue.z,u+=ue.y*ue.y,p+=ue.y*ue.z,m+=ue.z*ue.z}o*=n,s*=n,a*=n,u*=n,p*=n,m*=n;let x=Wtt;x[0]=o,x[1]=s,x[2]=a,x[3]=s,x[4]=u,x[5]=p,x[6]=a,x[7]=p,x[8]=m;let{unitary:M}=pee(x,Gtt),k=e.halfAxes.copy(M),F=k.getColumn(0,Vtt),j=k.getColumn(1,jtt),H=k.getColumn(2,$tt),W=-Number.MAX_VALUE,Z=-Number.MAX_VALUE,Y=-Number.MAX_VALUE,ee=Number.MAX_VALUE,ce=Number.MAX_VALUE,ge=Number.MAX_VALUE;for(let pe of t)N_.copy(pe),W=Math.max(N_.dot(F),W),Z=Math.max(N_.dot(j),Z),Y=Math.max(N_.dot(H),Y),ee=Math.min(N_.dot(F),ee),ce=Math.min(N_.dot(j),ce),ge=Math.min(N_.dot(H),ge);F=F.multiplyByScalar(.5*(ee+W)),j=j.multiplyByScalar(.5*(ce+Z)),H=H.multiplyByScalar(.5*(ge+Y)),e.center.copy(F).add(j).add(H);let Se=Utt.set(W-ee,Z-ce,Y-ge).multiplyByScalar(.5),ne=new gs([Se[0],0,0,0,Se[1],0,0,0,Se[2]]);return e.halfAxes.multiplyRight(ne),e}var dT=512,i4e=3,n4e=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],o4e=n4e.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Htt=o4e.concat([[.25,.5],[.75,.5]]),gee=class t{constructor(e,r,i){this.x=e,this.y=r,this.z=i}get children(){if(!this._children){let e=this.x*2,r=this.y*2,i=this.z+1;this._children=[new t(e,r,i),new t(e,r+1,i),new t(e+1,r,i),new t(e+1,r+1,i)]}return this._children}update(e){let{viewport:r,cullingVolume:i,elevationBounds:n,minZ:o,maxZ:s,bounds:a,offset:u,project:p}=e,m=this.getBoundingVolume(n,u,p);if(a&&!this.insideBounds(a)||i.computeVisibility(m)<0)return!1;if(!this.childVisible){let{z:M}=this;if(M<s&&M>=o){let k=m.distanceTo(r.cameraPosition)*r.scale/r.height;M+=Math.floor(Math.log2(k))}if(M>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(let M of this.children)M.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(let r of this._children)r.getSelected(e);return e}insideBounds([e,r,i,n]){let o=Math.pow(2,this.z),s=dT/o;return this.x*s<i&&this.y*s<n&&(this.x+1)*s>e&&(this.y+1)*s>r}getBoundingVolume(e,r,i){if(i){let u=this.z<1?Htt:this.z<2?o4e:n4e,p=[];for(let m of u){let x=NN(this.x+m[0],this.y+m[1],this.z);x[2]=e[0],p.push(i(x)),e[0]!==e[1]&&(x[2]=e[1],p.push(i(x)))}return mee(p)}let n=Math.pow(2,this.z),o=dT/n,s=this.x*o+r*dT,a=dT-(this.y+1)*o;return new uT([s,a,e[0]],[s+o,a+o,e[1]])}};function s4e(t,e,r,i){let n=t instanceof M0&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map(({normal:k,distance:F})=>new Xg(k.clone().negate(),F)),s=new Zg(o),a=t.distanceScales.unitsPerMeter[2],u=r&&r[0]*a||0,p=r&&r[1]*a||0,m=t instanceof Th&&t.pitch<=60?e:0;if(i){let[k,F,j,H]=i,W=Ha([k,H]),Z=Ha([j,F]);i=[W[0],dT-W[1],Z[0],dT-Z[1]]}let x=new gee(0,0,0),M={viewport:t,project:n,cullingVolume:s,elevationBounds:[u,p],minZ:m,maxZ:e,bounds:i,offset:0};if(x.update(M),t instanceof Th&&t.subViewports&&t.subViewports.length>1){for(M.offset=-1;x.update(M)&&!(--M.offset<-i4e););for(M.offset=1;x.update(M)&&!(++M.offset>i4e););}return x.getSelected()}var Kg=512,qtt=[-1/0,-1/0,1/0,1/0],yee={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(r=>typeof r=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;let r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}};function zN(t,e){let r=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...r.map(n=>n[0])),Math.min(...r.map(n=>n[1])),Math.max(...r.map(n=>n[0])),Math.max(...r.map(n=>n[1]))]}function Ytt(t){return Math.abs(t.split("").reduce((e,r)=>(e<<5)-e+r.charCodeAt(0)|0,0))}function _ee(t,e){if(!t||!t.length)return null;let{index:r,id:i}=e;if(Array.isArray(t)){let o=Ytt(i)%t.length;t=t[o]}let n=t;for(let o of Object.keys(r)){let s=new RegExp(`{${o}}`,"g");n=n.replace(s,String(r[o]))}return Number.isInteger(r.y)&&Number.isInteger(r.z)&&(n=n.replace(/\{-y\}/g,String(Math.pow(2,r.z)-r.y-1))),n}function Xtt(t,e,r){let i;if(e&&e.length===2){let[n,o]=e,s=t.getBounds({z:n}),a=t.getBounds({z:o});i=[Math.min(s[0],a[0]),Math.min(s[1],a[1]),Math.max(s[2],a[2]),Math.max(s[3],a[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],r[0]),Math.max(i[1],r[1]),Math.min(i[2],r[2]),Math.min(i[3],r[3])]:[Math.max(Math.min(i[0],r[2]),r[0]),Math.max(Math.min(i[1],r[3]),r[1]),Math.min(Math.max(i[2],r[0]),r[2]),Math.min(Math.max(i[3],r[1]),r[3])]}function l4e({viewport:t,z:e,cullRect:r}){return(t.subViewports||[t]).map(n=>Aee(n,e||0,r))}function Aee(t,e,r){if(!Array.isArray(e)){let o=r.x-t.x,s=r.y-t.y,{width:a,height:u}=r,p={targetZ:e},m=t.unproject([o,s],p),x=t.unproject([o+a,s],p),M=t.unproject([o,s+u],p),k=t.unproject([o+a,s+u],p);return[Math.min(m[0],x[0],M[0],k[0]),Math.min(m[1],x[1],M[1],k[1]),Math.max(m[0],x[0],M[0],k[0]),Math.max(m[1],x[1],M[1],k[1])]}let i=Aee(t,e[0],r),n=Aee(t,e[1],r);return[Math.min(i[0],n[0]),Math.min(i[1],n[1]),Math.max(i[2],n[2]),Math.max(i[3],n[3])]}function Ztt(t,e,r){return r?zN(t,r).map(n=>n*e/Kg):t.map(i=>i*e/Kg)}function vee(t,e){return Math.pow(2,t)*Kg/e}function NN(t,e,r){let i=vee(r,Kg),n=t/i*360-180,o=Math.PI-2*Math.PI*e/i,s=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[n,s]}function a4e(t,e,r,i){let n=vee(r,i);return[t/n*Kg,e/n*Kg]}function bee(t,e,r,i,n=Kg){if(t.isGeospatial){let[p,m]=NN(e,r,i),[x,M]=NN(e+1,r+1,i);return{west:p,north:m,east:x,south:M}}let[o,s]=a4e(e,r,i,n),[a,u]=a4e(e+1,r+1,i,n);return{left:o,top:s,right:a,bottom:u}}function Ktt(t,e,r,i,n){let o=Xtt(t,null,i),s=vee(e,r),[a,u,p,m]=Ztt(o,s,n),x=[];for(let M=Math.floor(a);M<p;M++)for(let k=Math.floor(u);k<m;k++)x.push({x:M,y:k,z:e});return x}function xee({viewport:t,maxZoom:e,minZoom:r,zRange:i,extent:n,tileSize:o=Kg,modelMatrix:s,modelMatrixInverse:a,zoomOffset:u=0}){let p=t.isGeospatial?Math.round(t.zoom+Math.log2(Kg/o))+u:Math.ceil(t.zoom)+u;if(typeof r=="number"&&Number.isFinite(r)&&p<r){if(!n)return[];p=r}typeof e=="number"&&Number.isFinite(e)&&p>e&&(p=e);let m=n;return s&&a&&n&&!t.isGeospatial&&(m=zN(n,s)),t.isGeospatial?s4e(t,p,i,n):Ktt(t,p,o,m||qtt,a)}function c4e(t){let e={},r;return i=>{for(let n in i)if(!Qtt(i[n],e[n])){r=t(i),e=i;break}return r}}function Qtt(t,e){if(t===e)return!0;if(Array.isArray(t)){let r=t.length;if(!e||e.length!==r)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}return!1}var u4e=1,UN=2,Jtt="never",ert="no-overlap",ZI="best-available",trt=5,rrt={[ZI]:nrt,[ert]:ort,[Jtt]:()=>{}},irt={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}},XI=class{constructor(e){this._getCullBounds=c4e(l4e),this.opts={...irt,...e},this.setOptions(this.opts),this.onTileLoad=r=>{this.opts.onTileLoad?.(r),this.opts.maxCacheByteSize!==null&&(this._cacheByteSize+=r.byteLength,this._resizeCache())},this._requestScheduler=new o3({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new mn,this._modelMatrixInverse=new mn}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(let e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(let e of this._cache.keys()){let r=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(r)?this._cache.delete(e):r.setNeedsReload()}}update(e,{zRange:r,modelMatrix:i}={zRange:null,modelMatrix:null}){let n=i?new mn(i):new mn,o=!n.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!ra(this._zRange,r)||o){o&&(this._modelMatrixInverse=n.clone().invert(),this._modelMatrix=n),this._viewport=e,this._zRange=r;let a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:r,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(u=>this._getTile(u,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));let s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(e,r,i){if(!e.isVisible)return!1;if(r&&this._viewport){let n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:r}),{bbox:o}=e;for(let[s,a,u,p]of n){let m;if("west"in o)m=o.west<u&&o.east>s&&o.south<p&&o.north>a;else{if(i&&!mn.IDENTITY.equals(i)){let[k,F,j,H]=zN([o.left,o.top,o.right,o.bottom],i);o={left:k,top:F,right:j,bottom:H}}let x=Math.min(o.top,o.bottom),M=Math.max(o.top,o.bottom);m=o.left<u&&o.right>s&&x<p&&M>a}if(m)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:r,minZoom:i,zRange:n,modelMatrix:o,modelMatrixInverse:s}){let{tileSize:a,extent:u,zoomOffset:p}=this.opts;return xee({viewport:e,maxZoom:r,minZoom:i,zRange:n,tileSize:a,extent:u,modelMatrix:o,modelMatrixInverse:s,zoomOffset:p})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){let{tileSize:r}=this.opts;return{bbox:bee(this._viewport,e.x,e.y,e.z,r)}}getParentIndex(e){let r=Math.floor(e.x/2),i=Math.floor(e.y/2),n=e.z-1;return{x:r,y:i,z:n}}updateTileStates(){let e=this.opts.refinementStrategy||ZI,r=new Array(this._cache.size),i=0;for(let n of this._cache.values())r[i++]=n.isVisible,n.isSelected=!1,n.isVisible=!1;for(let n of this._selectedTiles)n.isSelected=!0,n.isVisible=!0;(typeof e=="function"?e:rrt[e])(Array.from(this._cache.values())),i=0;for(let n of this._cache.values())if(r[i++]!==n.isVisible)return!0;return!1}_pruneRequests(){let{maxRequests:e=0}=this.opts,r=[],i=0;for(let n of this._cache.values())n.isLoading&&(i++,!n.isSelected&&!n.isVisible&&r.push(n));for(;e>0&&i>e&&r.length>0;)r.shift().abort(),i--}_rebuildTree(){let{_cache:e}=this;for(let r of e.values())r.parent=null,r.children&&(r.children.length=0);for(let r of e.values()){let i=this._getNearestAncestor(r);r.parent=i,i?.children&&i.children.push(r)}}_resizeCache(){let{_cache:e,opts:r}=this,i=r.maxCacheSize??(r.maxCacheByteSize!==null?1/0:trt*this.selectedTiles.length),n=r.maxCacheByteSize??1/0;if(e.size>i||this._cacheByteSize>n){for(let[s,a]of e)if(!a.isVisible&&!a.isSelected&&(this._cacheByteSize-=r.maxCacheByteSize!==null?a.byteLength:0,e.delete(s),this.opts.onTileUnload?.(a)),e.size<=i&&this._cacheByteSize<=n)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((s,a)=>s.zoom-a.zoom),this._dirty=!1)}_getTile(e,r){let i=this.getTileId(e),n=this._cache.get(i),o=!1;return!n&&r?(n=new ON(e),Object.assign(n,this.getTileMetadata(n.index)),Object.assign(n,{id:i,zoom:this.getTileZoom(n.index)}),o=!0,this._cache.set(i,n),this._dirty=!0):n&&n.needsReload&&(o=!0),n&&o&&n.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),n}_getNearestAncestor(e){let{_minZoom:r=0}=this,i=e.index;for(;this.getTileZoom(i)>r;){i=this.getParentIndex(i);let n=this._getTile(i);if(n)return n}return null}};function nrt(t){for(let e of t)e.state=0;for(let e of t)e.isSelected&&!h4e(e)&&wee(e);for(let e of t)e.isVisible=!!(e.state&UN)}function ort(t){for(let r of t)r.state=0;for(let r of t)r.isSelected&&h4e(r);let e=Array.from(t).sort((r,i)=>r.zoom-i.zoom);for(let r of e)if(r.isVisible=!!(r.state&UN),r.children&&(r.isVisible||r.state&u4e))for(let i of r.children)i.state=u4e;else r.isSelected&&wee(r)}function h4e(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=UN,!0;e=e.parent}return!1}function wee(t){for(let e of t.children)e.isLoaded||e.content?e.state|=UN:wee(e)}var srt={TilesetClass:XI,data:{type:"data",value:[]},dataComparator:yee.equal,renderSubLayers:{type:"function",value:t=>new GJ(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:ZI,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0},KI=class extends ji{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return!!this.state?.tileset?.selectedTiles?.every(e=>e.isLoaded&&e.layers&&e.layers.every(r=>r.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:r}=this.state,i=e.propsOrDataChanged||e.updateTriggersChanged,n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);r?i&&(r.setOptions(this._getTilesetOptions()),n?r.reloadAll():r.tiles.forEach(o=>{o.layers=null})):(r=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:r})),this._updateTileset()}_getTilesetOptions(){let{tileSize:e,maxCacheSize:r,maxCacheByteSize:i,refinementStrategy:n,extent:o,maxZoom:s,minZoom:a,maxRequests:u,debounceTime:p,zoomOffset:m}=this.props;return{maxCacheSize:r,maxCacheByteSize:i,maxZoom:s,minZoom:a,tileSize:e,refinementStrategy:n,extent:o,maxRequests:u,debounceTime:p,zoomOffset:m,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){let e=this.state.tileset,{zRange:r,modelMatrix:i}=this.props,n=e.update(this.context.viewport,{zRange:r,modelMatrix:i}),{isLoaded:o}=e,s=this.state.isLoaded!==o,a=this.state.frameNumber!==n;o&&(s||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:n}),this.state.isLoaded=o}_onViewportLoad(){let{tileset:e}=this.state,{onViewportLoad:r}=this.props;r&&r(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,r){this.props.onTileError(e),r.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){let{data:r,getTileData:i,fetch:n}=this.props,{signal:o}=e;return e.url=typeof r=="string"||Array.isArray(r)?_ee(r,e):null,i?i(e):n&&e.url?n(e.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){let r=e.sourceLayer,i=r.props.tile,n=e.info;return n.picked&&(n.tile=i),n.sourceTile=i,n.sourceTileSubLayer=r,n}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{let r=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)r&&e.layers[0]&&Object.keys(r).some(i=>e.layers[0].props[i]!==r[i])&&(e.layers=e.layers.map(i=>i.clone(r)));else{let i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=Uc(i,Boolean).map(n=>n.clone({tile:e,...r}))}return e.layers})}filterSubLayer({layer:e,cullRect:r}){let{tile:i}=e.props,{modelMatrix:n}=this.props;return this.state.tileset.isTileVisible(i,r,n?new mn(n):null)}};KI.defaultProps=srt;KI.layerName="TileLayer";var See=KI;var d4e=`uniform tripsUniforms {
  bool fadeTrail;
  float trailLength;
  float currentTime;
} trips;
`,f4e={name:"trips",vs:d4e,fs:d4e,uniformTypes:{fadeTrail:"f32",trailLength:"f32",currentTime:"f32"}};var art={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}},QI=class extends up{getShaders(){let e=super.getShaders();return e.inject={"vs:#decl":`in float instanceTimestamps;
in float instanceNextTimestamps;
out float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`in float vTime;
`,"fs:#main-start":`if(vTime > trips.currentTime || (trips.fadeTrail && (vTime < trips.currentTime - trips.trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(trips.fadeTrail) {
  color.a *= 1.0 - (trips.currentTime - vTime) / trips.trailLength;
}
`},e.modules=[...e.modules,f4e],e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){let{fadeTrail:r,trailLength:i,currentTime:n}=this.props,o={fadeTrail:r,trailLength:i,currentTime:n};this.state.model.shaderInputs.setProps({trips:o}),super.draw(e)}};QI.layerName="TripsLayer";QI.defaultProps=art;var Tee=QI;var lrt=10;function crt(t,e){let r;return t==null?r=e:typeof t=="object"?r={...t,coverage:e}:r={getHexagon:t,coverage:e},r}var urt={...hp.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0},fT=class t extends ji{initializeState(){t._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:r}){if(e.highPrecision!==!0&&(r.dataChanged||r.updateTriggersChanged&&r.updateTriggersChanged.getHexagon)){let i=this._calculateH3DataProps();this.setState(i)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,r=!1,i=!1,{iterable:n,objectInfo:o}=Vc(this.props.data);for(let s of n){o.index++;let a=this.props.getHexagon(s,o),u=RTe(a);if(e<0){if(e=u,!this.props.highPrecision)break}else if(e!==u){i=!0;break}if(kTe(a)){r=!0;break}}return{resolution:e,edgeLengthKM:e>=0?BTe(e,"km"):0,hasMultipleRes:i,hasPentagon:r}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){let{resolution:e,hasPentagon:r,hasMultipleRes:i}=this.state,{viewport:n}=this.context;return!!n?.resolution||i||r||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;let{resolution:r,edgeLengthKM:i,centerHex:n}=this.state;if(r<0)return;let o=this.props.centerHexagon||OTe(e.latitude,e.longitude,r);if(n===o)return;if(n)try{if(LTe(n,o)*i<lrt)return}catch{}let{unitsPerMeter:s}=e.distanceScales,a=uee(o),[u,p]=$I(o),[m,x]=e.projectFlat([p,u]);a=a.map(M=>{let k=e.projectFlat(M);return[(k[0]-m)/s[0],(k[1]-x)/s[1]]}),this.setState({centerHex:o,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){let{elevationScale:e,material:r,coverage:i,extruded:n,wireframe:o,stroked:s,filled:a,lineWidthUnits:u,lineWidthScale:p,lineWidthMinPixels:m,lineWidthMaxPixels:x,getFillColor:M,getElevation:k,getLineColor:F,getLineWidth:j,transitions:H,updateTriggers:W}=this.props;return{elevationScale:e,extruded:n,coverage:i,wireframe:o,stroked:s,filled:a,lineWidthUnits:u,lineWidthScale:p,lineWidthMinPixels:m,lineWidthMaxPixels:x,material:r,getElevation:k,getFillColor:M,getLineColor:F,getLineWidth:j,transitions:H,updateTriggers:{getFillColor:W.getFillColor,getElevation:W.getElevation,getLineColor:W.getLineColor,getLineWidth:W.getLineWidth}}}_renderPolygonLayer(){let{data:e,getHexagon:r,updateTriggers:i,coverage:n}=this.props,o=this.getSubLayerClass("hexagon-cell-hifi",hp),s=this._getForwardProps();return s.updateTriggers.getPolygon=crt(i.getHexagon,n),new o(s,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:s.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(a,u)=>{let p=r(a,u);return PN(uee(p,n))}})}_renderColumnLayer(){let{data:e,getHexagon:r,updateTriggers:i}=this.props,n=this.getSubLayerClass("hexagon-cell",XS),o=this._getForwardProps();return o.updateTriggers.getPosition=i.getHexagon,new n(o,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:o.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:NTe.bind(null,r)})}};fT.defaultProps=urt;fT.layerName="H3HexagonLayer";fT._checkH3Lib=()=>{};var VN=fT;Vi();var Mee=Math.PI/180,jN=new Float32Array(16),p4e=new Float32Array(12);function m4e(t,e,r){let i=e[0]*Mee,n=e[1]*Mee,o=e[2]*Mee,s=Math.sin(o),a=Math.sin(i),u=Math.sin(n),p=Math.cos(o),m=Math.cos(i),x=Math.cos(n),M=r[0],k=r[1],F=r[2];t[0]=M*x*m,t[1]=M*u*m,t[2]=M*-a,t[3]=k*(-u*p+x*a*s),t[4]=k*(x*p+u*a*s),t[5]=k*m*s,t[6]=F*(u*s+x*a*p),t[7]=F*(-x*s+u*a*p),t[8]=F*m*p}function g4e(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var A4e={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:r}){let{data:i,getOrientation:n,getScale:o,getTranslation:s,getTransformMatrix:a}=this.props,u=Array.isArray(a),p=u&&a.length===16,m=Array.isArray(o),x=Array.isArray(n),M=Array.isArray(s),k=p||!u&&!!a(i[0]);k?t.constant=p:t.constant=x&&m&&M;let F=t.value;if(t.constant){let j;k?(jN.set(a),j=g4e(jN)):(j=p4e,m4e(j,n,o),j.set(s,9)),t.value=new Float32Array(j)}else{let j=e*t.size,{iterable:H,objectInfo:W}=Vc(i,e,r);for(let Z of H){W.index++;let Y;if(k)jN.set(p?a:a(Z,W)),Y=g4e(jN);else{Y=p4e;let ee=x?n:n(Z,W),ce=m?o:o(Z,W);m4e(Y,ee,ce),Y.set(M?s:s(Z,W),9)}F[j++]=Y[0],F[j++]=Y[1],F[j++]=Y[2],F[j++]=Y[3],F[j++]=Y[4],F[j++]=Y[5],F[j++]=Y[6],F[j++]=Y[7],F[j++]=Y[8],F[j++]=Y[9],F[j++]=Y[10],F[j++]=Y[11]}}}};function y4e(t,e){return e===Gr.CARTESIAN||e===Gr.METER_OFFSETS||e===Gr.DEFAULT&&!t.isGeospatial}var _4e=`uniform simpleMeshUniforms {
  float sizeScale;
  bool composeModelMatrix;
  bool hasTexture;
  bool flatShading;
} simpleMesh;
`,v4e={name:"simpleMesh",vs:_4e,fs:_4e,uniformTypes:{sizeScale:"f32",composeModelMatrix:"f32",hasTexture:"f32",flatShading:"f32"}};var b4e=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = texCoords;
geometry.pickingColor = instancePickingColors;
vTexCoord = texCoords;
cameraPosition = project.cameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale + instanceTranslation;
if (simpleMesh.composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
geometry.position = position_commonspace;
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
}
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var x4e=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform sampler2D sampler;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
geometry.uv = vTexCoord;
vec3 normal;
if (simpleMesh.flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;
DECKGL_FILTER_COLOR(color, geometry);
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * layer.opacity);
}
`;function Eee(t){let e=t.positions||t.POSITION;mr.assert(e,'no "postions" or "POSITION" attribute in mesh');let r=e.value.length/e.size,i=t.COLOR_0||t.colors;i||(i={size:3,value:new Float32Array(r*3).fill(1)});let n=t.NORMAL||t.normals;n||(n={size:3,value:new Float32Array(r*3).fill(0)});let o=t.TEXCOORD_0||t.texCoords;return o||(o={size:2,value:new Float32Array(r*2).fill(0)}),{positions:e,colors:i,normals:n,texCoords:o}}function w4e(t){return t instanceof Ds?(t.attributes=Eee(t.attributes),t):t.attributes?new Ds({...t,topology:"triangle-list",attributes:Eee(t.attributes)}):new Ds({topology:"triangle-list",attributes:Eee(t)})}var hrt=[0,0,0,255],drt={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:hrt},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0,value:null}},JI=class extends Mo{getShaders(){return super.getShaders({vs:b4e,fs:x4e,modules:[No,ib,Os,v4e]})}getBounds(){if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;let{mesh:r}=this.props;if(!r)return null;if(e=r.header?.boundingBox,!e){let{attributes:i}=w4e(r);i.POSITION=i.POSITION||i.positions,e=tX(i)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:"float64",fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:"unorm8",transition:!0,size:this.props.colorFormat.length,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:A4e}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);let{props:r,oldProps:i,changeFlags:n}=e;if(r.mesh!==i.mesh||n.extensionsChanged){if(this.state.positionBounds=null,this.state.model?.destroy(),r.mesh){this.state.model=this.getModel(r.mesh);let o=r.mesh.attributes||r.mesh;this.setState({hasNormals:!!(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}r.texture!==i.texture&&r.texture instanceof ps&&this.setTexture(r.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?"line-strip":"triangle-list")}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){let{model:r}=this.state;if(!r)return;let{viewport:i,renderPass:n}=this.context,{sizeScale:o,coordinateSystem:s,_instanced:a}=this.props,u={sizeScale:o,composeModelMatrix:!a||y4e(i,s),flatShading:!this.state.hasNormals};r.shaderInputs.setProps({simpleMesh:u}),r.draw(n)}get isLoaded(){return!!(this.state?.model&&super.isLoaded)}getModel(e){let r=new bn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:w4e(e),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:n}=this.state,o={sampler:i||n,hasTexture:!!i};return r.shaderInputs.setProps({simpleMesh:o}),r}setTexture(e){let{emptyTexture:r,model:i}=this.state;if(i){let n={sampler:e||r,hasTexture:!!e};i.shaderInputs.setProps({simpleMesh:n})}}};JI.defaultProps=drt;JI.layerName="SimpleMeshLayer";var Cee=JI;var S4e="0123456789bcdefghjkmnpqrstuvwxyz",T4e={};for(let t=0;t<S4e.length;t++)T4e[S4e.charAt(t)]=t;var frt=-90,prt=90,mrt=-180,grt=180;function Art(t){let e=!0,r=prt,i=frt,n=grt,o=mrt,s,a=0;for(let u=0,p=t.length;u<p;u++){let m=t[u].toLowerCase();a=T4e[m];for(let x=4;x>=0;x--){let M=a>>x&1;e?(s=(n+o)/2,M===1?o=s:n=s):(s=(r+i)/2,M===1?i=s:r=s),e=!e}}return[i,o,r,n]}function M4e(t){let[e,r,i,n]=Art(t);return[n,i,n,e,r,e,r,i,n,i]}var yrt={getGeohash:{type:"accessor",value:t=>t.geohash}},ek=class extends tT{indexToBounds(){let{data:e,getGeohash:r}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(i,n)=>M4e(r(i,n))}}};ek.layerName="GeohashLayer";ek.defaultProps=yrt;var $N=ek;function lk(t){"@babel/helpers - typeof";return lk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lk(t)}function _rt(t,e){if(lk(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(lk(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vrt(t){var e=_rt(t,"string");return lk(e)=="symbol"?e:String(e)}function Yd(t,e,r){return e=vrt(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var brt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...brt}};var WN=globalThis.mathgl.config;function kee(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function tz(t,e,r){let i=WN.EPSILON;r&&(WN.EPSILON=r);try{if(t===e)return!0;if(kee(t)&&kee(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!tz(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=WN.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{WN.EPSILON=i}}var E4e={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function xrt(t,e,r={}){return wrt(t,r)!==e?(Trt(t,r),!0):!1}function wrt(t,e={}){return Math.sign(Vee(t,e))}var xT={x:0,y:1,z:2};function Vee(t,e={}){let{start:r=0,end:i=t.length,plane:n="xy"}=e,o=e.size||2,s=0,a=xT[n[0]],u=xT[n[1]];for(let p=r,m=i-o;p<i;p+=o)s+=(t[p+a]-t[m+a])*(t[p+u]+t[m+u]),m=p;return s/2}function Srt(t,e,r={}){let{start:i=0,end:n=t.length,size:o=2,isClosed:s}=r,a=(n-i)/o;for(let m=0;m<a-1;++m)e(t[i+m*o],t[i+m*o+1],t[i+(m+1)*o],t[i+(m+1)*o+1],m,m+1);let u=i+(a-1)*o;s||tz(t[i],t[u])&&tz(t[i+1],t[u+1])||e(t[u],t[u+1],t[i],t[i+1],a-1,0)}function Trt(t,e){let{start:r=0,end:i=t.length,size:n=2}=e,o=(i-r)/n,s=Math.floor(o/2);for(let a=0;a<s;++a){let u=r+a*n,p=r+(o-1-a)*n;for(let m=0;m<n;++m){let x=t[u+m];t[u+m]=t[p+m],t[p+m]=x}}}function Mrt(t,e,r={}){return Ert(t,r)!==e?(t.reverse(),!0):!1}function Ert(t,e={}){return Math.sign(Y4e(t,e))}function Y4e(t,e={}){let{start:r=0,end:i=t.length,plane:n="xy"}=e,o=0,s=xT[n[0]],a=xT[n[1]];for(let u=r,p=i-1;u<i;++u)o+=(t[u][s]-t[p][s])*(t[u][a]+t[p][a]),p=u;return o/2}function Crt(t,e,r={}){let{start:i=0,end:n=t.length,isClosed:o}=r;for(let a=i;a<n-1;++a)e(t[a],t[a+1],a,a+1);o||tz(t[n-1],t[0])||e(t[n-1],t[0],n-1,0)}var Ree=class{constructor(e,r={}){Yd(this,"points",void 0),Yd(this,"isFlatArray",void 0),Yd(this,"options",void 0),this.points=e,this.isFlatArray=!kee(e[0]),this.options={start:r.start||0,end:r.end||e.length,size:r.size||2,isClosed:r.isClosed},Object.freeze(this)}getSignedArea(){return this.isFlatArray?Vee(this.points,this.options):Y4e(this.points,this.options)}getArea(){return Math.abs(this.getSignedArea())}getWindingDirection(){return Math.sign(this.getSignedArea())}forEachSegment(e){this.isFlatArray?Srt(this.points,(r,i,n,o,s,a)=>{e([r,i],[n,o],s,a)},this.options):Crt(this.points,e,this.options)}modifyWindingDirection(e){return this.isFlatArray?xrt(this.points,e,this.options):Mrt(this.points,e,this.options)}};function Prt(t,e,r=2,i,n="xy"){let o=e&&e.length,s=o?e[0]*r:t.length,a=X4e(t,0,s,r,!0,i&&i[0],n),u=[];if(!a||a.next===a.prev)return u;let p,m,x,M,k,F,j;if(o&&(a=Drt(t,e,a,r,i,n)),t.length>80*r){M=m=t[0],k=x=t[1];for(let H=r;H<s;H+=r)F=t[H],j=t[H+1],F<M&&(M=F),j<k&&(k=j),F>m&&(m=F),j>x&&(x=j);p=Math.max(m-M,x-k),p=p!==0?32767/p:0}return ck(a,u,r,M,k,p,0),u}function X4e(t,e,r,i,n,o,s){let a,u;o===void 0&&(o=Vee(t,{start:e,end:r,size:i,plane:s}));let p=xT[s[0]],m=xT[s[1]];if(n===o<0)for(a=e;a<r;a+=i)u=C4e(a,t[a+p],t[a+m],u);else for(a=r-i;a>=e;a-=i)u=C4e(a,t[a+p],t[a+m],u);return u&&lz(u,u.next)&&(hk(u),u=u.next),u}function Qb(t,e){if(!t)return t;e||(e=t);let r=t,i;do if(i=!1,!r.steiner&&(lz(r,r.next)||xs(r.prev,r,r.next)===0)){if(hk(r),r=e=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==e);return e}function ck(t,e,r,i,n,o,s){if(!t)return;!s&&o&&zrt(t,i,n,o);let a=t,u,p;for(;t.prev!==t.next;){if(u=t.prev,p=t.next,o?krt(t,i,n,o):Irt(t)){e.push(u.i/r|0),e.push(t.i/r|0),e.push(p.i/r|0),hk(t),t=p.next,a=p.next;continue}if(t=p,t===a){s?s===1?(t=Rrt(Qb(t),e,r),ck(t,e,r,i,n,o,2)):s===2&&Ort(t,e,r,i,n,o):ck(Qb(t),e,r,i,n,o,1);break}}}function Irt(t){let e=t.prev,r=t,i=t.next;if(xs(e,r,i)>=0)return!1;let n=e.x,o=r.x,s=i.x,a=e.y,u=r.y,p=i.y,m=n<o?n<s?n:s:o<s?o:s,x=a<u?a<p?a:p:u<p?u:p,M=n>o?n>s?n:s:o>s?o:s,k=a>u?a>p?a:p:u>p?u:p,F=i.next;for(;F!==e;){if(F.x>=m&&F.x<=M&&F.y>=x&&F.y<=k&&mT(n,a,o,u,s,p,F.x,F.y)&&xs(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function krt(t,e,r,i){let n=t.prev,o=t,s=t.next;if(xs(n,o,s)>=0)return!1;let a=n.x,u=o.x,p=s.x,m=n.y,x=o.y,M=s.y,k=a<u?a<p?a:p:u<p?u:p,F=m<x?m<M?m:M:x<M?x:M,j=a>u?a>p?a:p:u>p?u:p,H=m>x?m>M?m:M:x>M?x:M,W=Oee(k,F,e,r,i),Z=Oee(j,H,e,r,i),Y=t.prevZ,ee=t.nextZ;for(;Y&&Y.z>=W&&ee&&ee.z<=Z;){if(Y.x>=k&&Y.x<=j&&Y.y>=F&&Y.y<=H&&Y!==n&&Y!==s&&mT(a,m,u,x,p,M,Y.x,Y.y)&&xs(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,ee.x>=k&&ee.x<=j&&ee.y>=F&&ee.y<=H&&ee!==n&&ee!==s&&mT(a,m,u,x,p,M,ee.x,ee.y)&&xs(ee.prev,ee,ee.next)>=0))return!1;ee=ee.nextZ}for(;Y&&Y.z>=W;){if(Y.x>=k&&Y.x<=j&&Y.y>=F&&Y.y<=H&&Y!==n&&Y!==s&&mT(a,m,u,x,p,M,Y.x,Y.y)&&xs(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;ee&&ee.z<=Z;){if(ee.x>=k&&ee.x<=j&&ee.y>=F&&ee.y<=H&&ee!==n&&ee!==s&&mT(a,m,u,x,p,M,ee.x,ee.y)&&xs(ee.prev,ee,ee.next)>=0)return!1;ee=ee.nextZ}return!0}function Rrt(t,e,r){let i=t;do{let n=i.prev,o=i.next.next;!lz(n,o)&&Z4e(n,i,i.next,o)&&uk(n,o)&&uk(o,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(o.i/r|0),hk(i),hk(i.next),i=t=o),i=i.next}while(i!==t);return Qb(i)}function Ort(t,e,r,i,n,o){let s=t;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&jrt(s,a)){let u=K4e(s,a);s=Qb(s,s.next),u=Qb(u,u.next),ck(s,e,r,i,n,o,0),ck(u,e,r,i,n,o,0);return}a=a.next}s=s.next}while(s!==t)}function Drt(t,e,r,i,n,o){let s=[],a,u,p,m,x;for(a=0,u=e.length;a<u;a++)p=e[a]*i,m=a<u-1?e[a+1]*i:t.length,x=X4e(t,p,m,i,!1,n&&n[a+1],o),x===x.next&&(x.steiner=!0),s.push(Vrt(x));for(s.sort(Lrt),a=0;a<s.length;a++)r=Brt(s[a],r);return r}function Lrt(t,e){return t.x-e.x}function Brt(t,e){let r=Frt(t,e);if(!r)return e;let i=K4e(r,t);return Qb(i,i.next),Qb(r,r.next)}function Frt(t,e){let r=e,i=t.x,n=t.y,o=-1/0,s;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){let M=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(M<=i&&M>o&&(o=M,s=r.x<r.next.x?r:r.next,M===i))return s}r=r.next}while(r!==e);if(!s)return null;let a=s,u=s.x,p=s.y,m=1/0,x;r=s;do i>=r.x&&r.x>=u&&i!==r.x&&mT(n<p?i:o,n,u,p,n<p?o:i,n,r.x,r.y)&&(x=Math.abs(n-r.y)/(i-r.x),uk(r,t)&&(x<m||x===m&&(r.x>s.x||r.x===s.x&&Nrt(s,r)))&&(s=r,m=x)),r=r.next;while(r!==a);return s}function Nrt(t,e){return xs(t.prev,t,e.prev)<0&&xs(e.next,t,t.next)<0}function zrt(t,e,r,i){let n=t;do n.z===0&&(n.z=Oee(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,Urt(n)}function Urt(t){let e,r,i=1,n,o,s,a,u,p;do{for(o=t,t=null,p=null,n=0;o;){for(n++,a=o,s=0,r=0;r<i&&(s++,a=a.nextZ,!!a);r++);for(u=i;s>0||u>0&&a;)s!==0&&(u===0||!a||o.z<=a.z)?(e=o,o=o.nextZ,s--):(e=a,a=a.nextZ,u--),p?p.nextZ=e:t=e,e.prevZ=p,p=e;o=a}p.nextZ=null,i*=2}while(n>1);return t}function Oee(t,e,r,i,n){return t=(t-r)*n|0,e=(e-i)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Vrt(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function mT(t,e,r,i,n,o,s,a){return(n-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(r-s)*(e-a)&&(r-s)*(o-a)>=(n-s)*(i-a)}function jrt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!$rt(t,e)&&(uk(t,e)&&uk(e,t)&&Wrt(t,e)&&(xs(t.prev,t,e.prev)||xs(t,e.prev,e))||lz(t,e)&&xs(t.prev,t,t.next)>0&&xs(e.prev,e,e.next)>0)}function xs(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function lz(t,e){return t.x===e.x&&t.y===e.y}function Z4e(t,e,r,i){let n=HN(xs(t,e,r)),o=HN(xs(t,e,i)),s=HN(xs(r,i,t)),a=HN(xs(r,i,e));return!!(n!==o&&s!==a||n===0&&GN(t,r,e)||o===0&&GN(t,i,e)||s===0&&GN(r,t,i)||a===0&&GN(r,e,i))}function GN(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function HN(t){return t>0?1:t<0?-1:0}function $rt(t,e){let r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Z4e(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function uk(t,e){return xs(t.prev,t,t.next)<0?xs(t,e,t.next)>=0&&xs(t,t.prev,e)>=0:xs(t,e,t.prev)<0||xs(t,t.next,e)<0}function Wrt(t,e){let r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i}function K4e(t,e){let r=new dk(t.i,t.x,t.y),i=new dk(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function C4e(t,e,r,i){let n=new dk(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function hk(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}var dk=class{constructor(e,r,i){Yd(this,"i",void 0),Yd(this,"x",void 0),Yd(this,"y",void 0),Yd(this,"prev",null),Yd(this,"next",null),Yd(this,"z",0),Yd(this,"prevZ",null),Yd(this,"nextZ",null),Yd(this,"steiner",!1),this.i=e,this.x=r,this.y=i}};function gk(t){return"data"in t?t.getChildAt(0):t.children[0]}function Ak(t){return"data"in t?t.getChildAt(0):t.children[0]}function TT(t){return"data"in t?t.getChildAt(0):t.children[0]}function Grt(t){return"data"in t?t.getChildAt(0):t.children[0]}function Hrt(t){return"data"in t?t.getChildAt(0):t.children[0]}function cz(t){return"data"in t?t.getChildAt(0):t.children[0]}var Ni=Object.freeze({__proto__:null,getLineStringChild:Ak,getMultiLineStringChild:Hrt,getMultiPointChild:Grt,getMultiPolygonChild:cz,getPointChild:gk,getPolygonChild:TT});function uz(t,e){let r=t.valueOffsets,i=TT(t),n=i.valueOffsets,o=Ak(i),s=o.type.listSize,a=gk(o),u=r[e],p=r[e+1],m=n[u],x=n[p],M=a.values.subarray(m*s,x*s);return new Ree(M,{size:s,isClosed:!0})}function Q4e(t){if("data"in t)return new Or(t.data.map(r=>Q4e(r)));let e=new Float64Array(t.length);for(let r=0;r<t.length;r++){let i=uz(t,r);e[r]=i.getArea()}return Dr({type:new pl(Dn.DOUBLE),length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,data:e})}function J4e(t){if("data"in t)return new Or(t.data.map(r=>J4e(r)));let e=new Float64Array(t.length);for(let r=0;r<t.length;r++){let i=uz(t,r);e[r]=i.getSignedArea()}return Dr({type:new pl(Dn.DOUBLE),length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,data:e})}function eMe(t){if("data"in t)return t.data.map(o=>eMe(o));let e=[],r=0;for(let o=0;o<t.length;o++){let s=qrt(t,o);e.push(s),r+=s.length}let i=new Uint32Array(r),n=0;for(let o of e)for(let s of o)i[n]=s,n+=1;return i}function qrt(t,e){let r=t.valueOffsets,i=TT(t),n=i.valueOffsets,o=Ak(i),s=o.type.listSize,a=gk(o),u=r[e],p=r[e+1],m=n[u],x=n[p],M=a.values.subarray(m*s,x*s),k=n[u],F=[];for(let H=u+1;H<p;H++)F.push(n[H]-k);let j=Prt(M,F,s);for(let H=0;H<j.length;H++)j[H]+=k;return j}function tMe(t){return"data"in t?new Or(t.data.map(e=>tMe(e))):TT(t)}function rMe(t){return"data"in t?new Or(t.data.map(e=>rMe(e))):cz(t)}function jee(t){return or.isFixedSizeList(t)?!(![2,3,4].includes(t.listSize)||!or.isFloat(t.children[0])):or.isStruct(t)?!(![2,3,4].includes(t.children.length)||!t.children.every(e=>["x","y","z","m"].includes(e.name))||!t.children.every(e=>or.isFloat(e))):!1}function $ee(t){return!(!or.isList(t)||!jee(t.children[0].type))}function iMe(t){return!(!or.isList(t)||!$ee(t.children[0].type))}function Yrt(t){return!(!or.isList(t)||!jee(t.children[0].type))}function Xrt(t){return!(!or.isList(t)||!$ee(t.children[0].type))}function Zrt(t){return!(!or.isList(t)||!iMe(t.children[0].type))}function nMe(t){return jee(t.type)}function oMe(t){return $ee(t.type)}function sMe(t){return iMe(t.type)}function aMe(t){return Yrt(t.type)}function lMe(t){return Xrt(t.type)}function cMe(t){return Zrt(t.type)}var $r=Object.freeze({__proto__:null,isLineStringData:oMe,isMultiLineStringData:lMe,isMultiPointData:aMe,isMultiPolygonData:cMe,isPointData:nMe,isPolygonData:sMe});function Krt(t,e){if(!t)throw new Error(`assertion failed ${e}`)}function Qrt(){throw new Error("assertion failed")}function uMe(t,e){if(nMe(t))return hMe(t,e);if(oMe(t))return Dee(t,e);if(sMe(t))return Lee(t,e);if(aMe(t))return Dee(t,e);if(lMe(t))return Lee(t,e);if(cMe(t))return Jrt(t,e);Qrt()}function hMe(t,e){Krt(t.type.listSize===2,"expected 2D");let r=gk(t),i=r.values,n=new Float64Array(i.length);for(let s=0;s<t.length;s++){let a=i[s*2],u=i[s*2+1],[p,m]=e(a,u);n[s*2]=p,n[s*2+1]=m}let o=Dr({type:r.type,length:r.length,nullCount:r.nullCount,nullBitmap:r.nullBitmap,data:n});return Dr({type:t.type,length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,child:o})}function Dee(t,e){let r=Ak(t),i=hMe(r,e);return Dr({type:t.type,length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,child:i,valueOffsets:t.valueOffsets})}function Lee(t,e){let r=TT(t),i=Dee(r,e);return Dr({type:t.type,length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,child:i,valueOffsets:t.valueOffsets})}function Jrt(t,e){let r=cz(t),i=Lee(r,e);return Dr({type:t.type,length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,child:i,valueOffsets:t.valueOffsets})}function eit(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Jb=1,ex=2,vT=3,tit=4,Bee=5,P4e=6378137,rit=6356752314e-3,I4e=.0066943799901413165,sk=484813681109536e-20,rr=Math.PI/2,iit=.16666666666666666,nit=.04722222222222222,oit=.022156084656084655,gr=1e-10,Ul=.017453292519943295,H0=57.29577951308232,Yn=Math.PI/4,fk=Math.PI*2,la=3.14159265359,Nu={};Nu.greenwich=0;Nu.lisbon=-9.131906111111;Nu.paris=2.337229166667;Nu.bogota=-74.080916666667;Nu.madrid=-3.687938888889;Nu.rome=12.452333333333;Nu.bern=7.439583333333;Nu.jakarta=106.807719444444;Nu.ferro=-17.666666666667;Nu.brussels=4.367975;Nu.stockholm=18.058277777778;Nu.athens=23.7163375;Nu.oslo=10.722916666667;var sit={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},k4e=/[\s_\-\/\(\)]/g;function V_(t,e){if(t[e])return t[e];for(var r=Object.keys(t),i=e.toLowerCase().replace(k4e,""),n=-1,o,s;++n<r.length;)if(o=r[n],s=o.toLowerCase().replace(k4e,""),s===i)return t[o]}function Fee(t){var e={},r=t.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,u){var p=u.split("=");return p.push(!0),a[p[0].toLowerCase()]=p[1],a},{}),i,n,o,s={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*Ul},lat_1:function(a){e.lat1=a*Ul},lat_2:function(a){e.lat2=a*Ul},lat_ts:function(a){e.lat_ts=a*Ul},lon_0:function(a){e.long0=a*Ul},lon_1:function(a){e.long1=a*Ul},lon_2:function(a){e.long2=a*Ul},alpha:function(a){e.alpha=parseFloat(a)*Ul},gamma:function(a){e.rectified_grid_angle=parseFloat(a)},lonc:function(a){e.longc=a*Ul},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(u){return parseFloat(u)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var u=V_(sit,a);u&&(e.to_meter=u.to_meter)},from_greenwich:function(a){e.from_greenwich=a*Ul},pm:function(a){var u=V_(Nu,a);e.from_greenwich=(u||parseFloat(a))*Ul},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var u="ewnsud";a.length===3&&u.indexOf(a.substr(0,1))!==-1&&u.indexOf(a.substr(1,1))!==-1&&u.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0}};for(i in r)n=r[i],i in s?(o=s[i],typeof o=="function"?o(n):e[o]=n):e[i]=n;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var pk=1,dMe=2,fMe=3,rz=4,pMe=5,Wee=-1,ait=/\s/,lit=/[A-Za-z]/,cit=/[A-Za-z84_]/,hz=/[,\]]/,mMe=/[\d\.E\-\+]/;function Qg(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=pk}Qg.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==rz)for(;ait.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case pk:return this.neutral(t);case dMe:return this.keyword(t);case rz:return this.quoted(t);case pMe:return this.afterquote(t);case fMe:return this.number(t);case Wee:return}};Qg.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=rz;return}if(hz.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};Qg.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=pk;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=pk,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Wee);return}};Qg.prototype.number=function(t){if(mMe.test(t)){this.word+=t;return}if(hz.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};Qg.prototype.quoted=function(t){if(t==='"'){this.state=pMe;return}this.word+=t};Qg.prototype.keyword=function(t){if(cit.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=pk;return}if(hz.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};Qg.prototype.neutral=function(t){if(lit.test(t)){this.word=t,this.state=dMe;return}if(t==='"'){this.word="",this.state=rz;return}if(mMe.test(t)){this.word=t,this.state=fMe;return}if(hz.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};Qg.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Wee)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function uit(t){var e=new Qg(t);return e.output()}function R4e(t,e,r){Array.isArray(e)&&(r.unshift(e),e=null);var i=e?{}:t,n=r.reduce(function(o,s){return gT(s,o),o},i);e&&(t[e]=n)}function gT(t,e){if(!Array.isArray(t)){e[t]=!0;return}var r=t.shift();if(r==="PARAMETER"&&(r=t.shift()),t.length===1){if(Array.isArray(t[0])){e[r]={},gT(t[0],e[r]);return}e[r]=t[0];return}if(!t.length){e[r]=!0;return}if(r==="TOWGS84"){e[r]=t;return}if(r==="AXIS"){r in e||(e[r]=[]),e[r].push(t);return}Array.isArray(r)||(e[r]={});var i;switch(r){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[r]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&gT(t[2],e[r]);return;case"SPHEROID":case"ELLIPSOID":e[r]={name:t[0],a:t[1],rf:t[2]},t.length===4&&gT(t[3],e[r]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":t[0]=["name",t[0]],R4e(e,r,t);return;default:for(i=-1;++i<t.length;)if(!Array.isArray(t[i]))return gT(t,e[r]);return R4e(e,r,t)}}var hit=.017453292519943295;function dit(t,e){var r=e[0],i=e[1];!(r in t)&&i in t&&(t[r]=t[i],e.length===3&&(t[r]=e[2](t[r])))}function G0(t){return t*hit}function fit(t){if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",r=0,i=t.AXIS.length;r<i;++r){var n=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];n[0].indexOf("north")!==-1||(n[0]==="y"||n[0]==="lat")&&n[1]==="north"?e+="n":n[0].indexOf("south")!==-1||(n[0]==="y"||n[0]==="lat")&&n[1]==="south"?e+="s":n[0].indexOf("east")!==-1||(n[0]==="x"||n[0]==="lon")&&n[1]==="east"?e+="e":(n[0].indexOf("west")!==-1||(n[0]==="x"||n[0]==="lon")&&n[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;t.type==="GEOGCS"&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),(t.datumCode==="new_zealand_geodetic_datum_1949"||t.datumCode==="new_zealand_1949")&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode.slice(-6)==="_ferro"&&(t.datumCode=t.datumCode.slice(0,-6)),t.datumCode.slice(-8)==="_jakarta"&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a);function s(p){var m=t.to_meter||1;return p*m}var a=function(p){return dit(t,p)},u=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",G0],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",G0],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",G0],["lat0","latitude_of_origin",G0],["lat0","standard_parallel_1",G0],["lat1","standard_parallel_1",G0],["lat2","standard_parallel_2",G0],["azimuth","Azimuth"],["alpha","azimuth",G0],["srsCode","name"]];u.forEach(a),!t.long0&&t.longc&&(t.projName==="Albers_Conic_Equal_Area"||t.projName==="Lambert_Azimuthal_Equal_Area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(t.projName==="Stereographic_South_Pole"||t.projName==="Polar Stereographic (variant B)")?(t.lat0=G0(t.lat1>0?90:-90),t.lat_ts=t.lat1):!t.lat_ts&&t.lat0&&t.projName==="Polar_Stereographic"&&(t.lat_ts=t.lat0,t.lat0=G0(t.lat0>0?90:-90))}function gMe(t){var e=uit(t),r=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",r]);var n={};return gT(e,n),fit(n),n}function qc(t){var e=this;if(arguments.length===2){var r=arguments[1];typeof r=="string"?r.charAt(0)==="+"?qc[t]=Fee(arguments[1]):qc[t]=gMe(arguments[1]):qc[t]=r}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(i){Array.isArray(i)?qc.apply(e,i):qc(i)});if(typeof t=="string"){if(t in qc)return qc[t]}else"EPSG"in t?qc["EPSG:"+t.EPSG]=t:"ESRI"in t?qc["ESRI:"+t.ESRI]=t:"IAU2000"in t?qc["IAU2000:"+t.IAU2000]=t:console.log(t);return}}eit(qc);function pit(t){return typeof t=="string"}function mit(t){return t in qc}var git=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Ait(t){return git.some(function(e){return t.indexOf(e)>-1})}var yit=["3857","900913","3785","102113"];function _it(t){var e=V_(t,"authority");if(e){var r=V_(e,"epsg");return r&&yit.indexOf(r)>-1}}function vit(t){var e=V_(t,"extension");if(e)return V_(e,"proj4")}function bit(t){return t[0]==="+"}function xit(t){if(pit(t)){if(mit(t))return qc[t];if(Ait(t)){var e=gMe(t);if(_it(e))return qc["EPSG:3857"];var r=vit(e);return r?Fee(r):e}if(bit(t))return Fee(t)}else return t}function O4e(t,e){t=t||{};var r,i;if(!e)return t;for(i in e)r=e[i],r!==void 0&&(t[i]=r);return t}function Y0(t,e,r){var i=t*e;return r/Math.sqrt(1-i*i)}function yk(t){return t<0?-1:1}function Cr(t){return Math.abs(t)<=la?t:t-yk(t)*fk}function fp(t,e,r){var i=t*r,n=.5*t;return i=Math.pow((1-i)/(1+i),n),Math.tan(.5*(rr-e))/i}function mk(t,e){for(var r=.5*t,i,n,o=rr-2*Math.atan(e),s=0;s<=15;s++)if(i=t*Math.sin(o),n=rr-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-o,o+=n,Math.abs(n)<=1e-10)return o;return-9999}function wit(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Y0(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Sit(t){var e=t.x,r=t.y;if(r*H0>90&&r*H0<-90&&e*H0>180&&e*H0<-180)return null;var i,n;if(Math.abs(Math.abs(r)-rr)<=gr)return null;if(this.sphere)i=this.x0+this.a*this.k0*Cr(e-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(Yn+.5*r));else{var o=Math.sin(r),s=fp(this.e,r,o);i=this.x0+this.a*this.k0*Cr(e-this.long0),n=this.y0-this.a*this.k0*Math.log(s)}return t.x=i,t.y=n,t}function Tit(t){var e=t.x-this.x0,r=t.y-this.y0,i,n;if(this.sphere)n=rr-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(n=mk(this.e,o),n===-9999)return null}return i=Cr(this.long0+e/(this.a*this.k0)),t.x=i,t.y=n,t}var Mit=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],Eit={init:wit,forward:Sit,inverse:Tit,names:Mit};function Cit(){}function D4e(t){return t}var Pit=["longlat","identity"],Iit={init:Cit,forward:D4e,inverse:D4e,names:Pit},kit=[Eit,Iit],ZN={},iz=[];function AMe(t,e){var r=iz.length;return t.names?(iz[r]=t,t.names.forEach(function(i){ZN[i.toLowerCase()]=r}),this):(console.log(e),!0)}function Rit(t){if(!t)return!1;var e=t.toLowerCase();if(typeof ZN[e]<"u"&&iz[ZN[e]])return iz[ZN[e]]}function Oit(){kit.forEach(AMe)}var Dit={start:Oit,add:AMe,get:Rit},Oi={};Oi.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Oi.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Oi.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Oi.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Oi.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Oi.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Oi.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Oi.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Oi.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Oi.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Oi.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Oi.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Oi.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Oi.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Oi.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Oi.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Oi.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Oi.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Oi.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Oi.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Oi.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Oi.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Oi.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Oi.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Oi.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Oi.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Oi.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Oi.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Oi.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Oi.hough={a:6378270,rf:297,ellipseName:"Hough"};Oi.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Oi.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Oi.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Oi.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Oi.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Oi.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Oi.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Oi.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Oi.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Oi.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Oi.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Oi.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Lit=Oi.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Oi.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Bit(t,e,r,i){var n=t*t,o=e*e,s=(n-o)/n,a=0;i?(t*=1-s*(iit+s*(nit+s*oit)),n=t*t,s=0):a=Math.sqrt(s);var u=(n-o)/o;return{es:s,e:a,ep2:u}}function Fit(t,e,r,i,n){if(!t){var o=V_(Oi,i);o||(o=Lit),t=o.a,e=o.b,r=o.rf}return r&&!e&&(e=(1-1/r)*t),(r===0||Math.abs(t-e)<gr)&&(n=!0,e=t),{a:t,b:e,rf:r,sphere:n}}var Qa={};Qa.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};Qa.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};Qa.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};Qa.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};Qa.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};Qa.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};Qa.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};Qa.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};Qa.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"};Qa.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};Qa.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};Qa.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};Qa.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};Qa.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};Qa.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};Qa.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};Qa.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};Qa.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function Nit(t,e,r,i,n,o,s){var a={};return t===void 0||t==="none"?a.datum_type=Bee:a.datum_type=tit,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Jb),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=ex,a.datum_params[3]*=sk,a.datum_params[4]*=sk,a.datum_params[5]*=sk,a.datum_params[6]=a.datum_params[6]/1e6+1)),s&&(a.datum_type=vT,a.grids=s),a.a=r,a.b=i,a.es=n,a.ep2=o,a}var yMe={};function zit(t,e){var r=new DataView(e),i=jit(r),n=$it(r,i),o=Wit(r,n,i),s={header:n,subgrids:o};return yMe[t]=s,s}function Uit(t){if(t===void 0)return null;var e=t.split(",");return e.map(Vit)}function Vit(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:yMe[t]||null,isNull:!1}}function AT(t){return t/3600*Math.PI/180}function jit(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function $it(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Nee(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function Nee(t,e,r){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,r)))}function Wit(t,e,r){for(var i=176,n=[],o=0;o<e.nSubgrids;o++){var s=Hit(t,i,r),a=qit(t,i,s,r),u=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),p=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);n.push({ll:[AT(s.lowerLongitude),AT(s.lowerLatitude)],del:[AT(s.longitudeInterval),AT(s.latitudeInterval)],lim:[u,p],count:s.gridNodeCount,cvs:Git(a)}),i+=176+s.gridNodeCount*16}return n}function Git(t){return t.map(function(e){return[AT(e.longitudeShift),AT(e.latitudeShift)]})}function Hit(t,e,r){return{name:Nee(t,e+8,e+16).trim(),parent:Nee(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,r),upperLatitude:t.getFloat64(e+88,r),lowerLongitude:t.getFloat64(e+104,r),upperLongitude:t.getFloat64(e+120,r),latitudeInterval:t.getFloat64(e+136,r),longitudeInterval:t.getFloat64(e+152,r),gridNodeCount:t.getInt32(e+168,r)}}function qit(t,e,r,i){for(var n=e+176,o=16,s=[],a=0;a<r.gridNodeCount;a++){var u={latitudeShift:t.getFloat32(n+a*o,i),longitudeShift:t.getFloat32(n+a*o+4,i),latitudeAccuracy:t.getFloat32(n+a*o+8,i),longitudeAccuracy:t.getFloat32(n+a*o+12,i)};s.push(u)}return s}function q0(t,e){if(!(this instanceof q0))return new q0(t);e=e||function(p){if(p)throw p};var r=xit(t);if(typeof r!="object"){e(t);return}var i=q0.projections.get(r.projName);if(!i){e(t);return}if(r.datumCode&&r.datumCode!=="none"){var n=V_(Qa,r.datumCode);n&&(r.datum_params=r.datum_params||(n.towgs84?n.towgs84.split(","):null),r.ellps=n.ellipse,r.datumName=n.datumName?n.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84",r.lat1=r.lat1||r.lat0;var o=Fit(r.a,r.b,r.rf,r.ellps,r.sphere),s=Bit(o.a,o.b,o.rf,r.R_A),a=Uit(r.nadgrids),u=r.datum||Nit(r.datumCode,r.datum_params,o.a,o.b,s.es,s.ep2,a);O4e(this,r),O4e(this,i),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=u,this.init(),e(null,this)}q0.projections=Dit;q0.projections.start();function Yit(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Jb?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===ex?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function _Me(t,e,r){var i=t.x,n=t.y,o=t.z?t.z:0,s,a,u,p;if(n<-rr&&n>-1.001*rr)n=-rr;else if(n>rr&&n<1.001*rr)n=rr;else{if(n<-rr)return{x:-1/0,y:-1/0,z:t.z};if(n>rr)return{x:1/0,y:1/0,z:t.z}}return i>Math.PI&&(i-=2*Math.PI),a=Math.sin(n),p=Math.cos(n),u=a*a,s=r/Math.sqrt(1-e*u),{x:(s+o)*p*Math.cos(i),y:(s+o)*p*Math.sin(i),z:(s*(1-e)+o)*a}}function vMe(t,e,r,i){var n=1e-12,o=n*n,s=30,a,u,p,m,x,M,k,F,j,H,W,Z,Y,ee=t.x,ce=t.y,ge=t.z?t.z:0,Se,ne,pe;if(a=Math.sqrt(ee*ee+ce*ce),u=Math.sqrt(ee*ee+ce*ce+ge*ge),a/r<n){if(Se=0,u/r<n)return ne=rr,pe=-i,{x:t.x,y:t.y,z:t.z}}else Se=Math.atan2(ce,ee);p=ge/u,m=a/u,x=1/Math.sqrt(1-e*(2-e)*m*m),F=m*(1-e)*x,j=p*x,Y=0;do Y++,k=r/Math.sqrt(1-e*j*j),pe=a*F+ge*j-k*(1-e*j*j),M=e*k/(k+pe),x=1/Math.sqrt(1-M*(2-M)*m*m),H=m*(1-M)*x,W=p*x,Z=W*F-H*j,F=H,j=W;while(Z*Z>o&&Y<s);return ne=Math.atan(W/Math.abs(H)),{x:Se,y:ne,z:pe}}function Xit(t,e,r){if(e===Jb)return{x:t.x+r[0],y:t.y+r[1],z:t.z+r[2]};if(e===ex){var i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],u=r[5],p=r[6];return{x:p*(t.x-u*t.y+a*t.z)+i,y:p*(u*t.x+t.y-s*t.z)+n,z:p*(-a*t.x+s*t.y+t.z)+o}}}function Zit(t,e,r){if(e===Jb)return{x:t.x-r[0],y:t.y-r[1],z:t.z-r[2]};if(e===ex){var i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],u=r[5],p=r[6],m=(t.x-i)/p,x=(t.y-n)/p,M=(t.z-o)/p;return{x:m+u*x-a*M,y:-u*m+x+s*M,z:a*m-s*x+M}}}function qN(t){return t===Jb||t===ex}function Kit(t,e,r){if(Yit(t,e)||t.datum_type===Bee||e.datum_type===Bee)return r;var i=t.a,n=t.es;if(t.datum_type===vT){var o=L4e(t,!1,r);if(o!==0)return;i=P4e,n=I4e}var s=e.a,a=e.b,u=e.es;if(e.datum_type===vT&&(s=P4e,a=rit,u=I4e),n===u&&i===s&&!qN(t.datum_type)&&!qN(e.datum_type))return r;if(r=_Me(r,n,i),qN(t.datum_type)&&(r=Xit(r,t.datum_type,t.datum_params)),qN(e.datum_type)&&(r=Zit(r,e.datum_type,e.datum_params)),r=vMe(r,u,s,a),e.datum_type===vT){var p=L4e(e,!0,r);if(p!==0)return}return r}function L4e(t,e,r){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var i={x:-r.x,y:r.y},n={x:Number.NaN,y:Number.NaN},o=[];e:for(var s=0;s<t.grids.length;s++){var a=t.grids[s];if(o.push(a.name),a.isNull){n=i;break}if(a.mandatory,a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var u=a.grid.subgrids,p=0,m=u.length;p<m;p++){var x=u[p],M=(Math.abs(x.del[1])+Math.abs(x.del[0]))/1e4,k=x.ll[0]-M,F=x.ll[1]-M,j=x.ll[0]+(x.lim[0]-1)*x.del[0]+M,H=x.ll[1]+(x.lim[1]-1)*x.del[1]+M;if(!(F>i.y||k>i.x||H<i.y||j<i.x)&&(n=Qit(i,e,x),!isNaN(n.x)))break e}}return isNaN(n.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*H0+" "+i.y*H0+" tried: '"+o+"'"),-1):(r.x=-n.x,r.y=n.y,0)}function Qit(t,e,r){var i={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return i;var n={x:t.x,y:t.y};n.x-=r.ll[0],n.y-=r.ll[1],n.x=Cr(n.x-Math.PI)+Math.PI;var o=B4e(n,r);if(e){if(isNaN(o.x))return i;o.x=n.x-o.x,o.y=n.y-o.y;var s=9,a=1e-12,u,p;do{if(p=B4e(o,r),isNaN(p.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}u={x:n.x-(p.x+o.x),y:n.y-(p.y+o.y)},o.x+=u.x,o.y+=u.y}while(s--&&Math.abs(u.x)>a&&Math.abs(u.y)>a);if(s<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Cr(o.x+r.ll[0]),i.y=o.y+r.ll[1]}else isNaN(o.x)||(i.x=t.x+o.x,i.y=t.y+o.y);return i}function B4e(t,e){var r={x:t.x/e.del[0],y:t.y/e.del[1]},i={x:Math.floor(r.x),y:Math.floor(r.y)},n={x:r.x-1*i.x,y:r.y-1*i.y},o={x:Number.NaN,y:Number.NaN},s;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return o;s=i.y*e.lim[0]+i.x;var a={x:e.cvs[s][0],y:e.cvs[s][1]};s++;var u={x:e.cvs[s][0],y:e.cvs[s][1]};s+=e.lim[0];var p={x:e.cvs[s][0],y:e.cvs[s][1]};s--;var m={x:e.cvs[s][0],y:e.cvs[s][1]},x=n.x*n.y,M=n.x*(1-n.y),k=(1-n.x)*(1-n.y),F=(1-n.x)*n.y;return o.x=k*a.x+M*u.x+F*m.x+x*p.x,o.y=k*a.y+M*u.y+F*m.y+x*p.y,o}function F4e(t,e,r){var i=r.x,n=r.y,o=r.z||0,s,a,u,p={};for(u=0;u<3;u++)if(!(e&&u===2&&r.z===void 0))switch(u===0?(s=i,"ew".indexOf(t.axis[u])!==-1?a="x":a="y"):u===1?(s=n,"ns".indexOf(t.axis[u])!==-1?a="y":a="x"):(s=o,a="z"),t.axis[u]){case"e":p[a]=s;break;case"w":p[a]=-s;break;case"n":p[a]=s;break;case"s":p[a]=-s;break;case"u":r[a]!==void 0&&(p.z=s);break;case"d":r[a]!==void 0&&(p.z=-s);break;default:return null}return p}function bMe(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Jit(t){N4e(t.x),N4e(t.y)}function N4e(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function ent(t,e){return(t.datum.datum_type===Jb||t.datum.datum_type===ex||t.datum.datum_type===vT)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Jb||e.datum.datum_type===ex||e.datum.datum_type===vT)&&t.datumCode!=="WGS84"}function nz(t,e,r,i){var n;Array.isArray(r)?r=bMe(r):r={x:r.x,y:r.y,z:r.z,m:r.m};var o=r.z!==void 0;if(Jit(r),t.datum&&e.datum&&ent(t,e)&&(n=new q0("WGS84"),r=nz(t,n,r,i),t=n),i&&t.axis!=="enu"&&(r=F4e(t,!1,r)),t.projName==="longlat")r={x:r.x*Ul,y:r.y*Ul,z:r.z||0};else if(t.to_meter&&(r={x:r.x*t.to_meter,y:r.y*t.to_meter,z:r.z||0}),r=t.inverse(r),!r)return;if(t.from_greenwich&&(r.x+=t.from_greenwich),r=Kit(t.datum,e.datum,r),!!r)return e.from_greenwich&&(r={x:r.x-e.from_greenwich,y:r.y,z:r.z||0}),e.projName==="longlat"?r={x:r.x*H0,y:r.y*H0,z:r.z||0}:(r=e.forward(r),e.to_meter&&(r={x:r.x/e.to_meter,y:r.y/e.to_meter,z:r.z||0})),i&&e.axis!=="enu"?F4e(e,!0,r):(r&&!o&&delete r.z,r)}var z4e=q0("WGS84");function Pee(t,e,r,i){var n,o,s;return Array.isArray(r)?(n=nz(t,e,r,i)||{x:NaN,y:NaN},r.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof n.z=="number"?[n.x,n.y,n.z].concat(r.splice(3)):[n.x,n.y,r[2]].concat(r.splice(3)):[n.x,n.y].concat(r.splice(2)):[n.x,n.y]):(o=nz(t,e,r,i),s=Object.keys(r),s.length===2||s.forEach(function(a){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;o[a]=r[a]}),o)}function U4e(t){return t instanceof q0?t:t.oProj?t.oProj:q0(t)}function Nh(t,e,r){t=U4e(t);var i=!1,n;return typeof e>"u"?(e=t,t=z4e,i=!0):(typeof e.x<"u"||Array.isArray(e))&&(r=e,e=t,t=z4e,i=!0),e=U4e(e),r?Pee(t,e,r):(n={forward:function(o,s){return Pee(t,e,o,s)},inverse:function(o,s){return Pee(e,t,o,s)}},i&&(n.oProj=e),n)}var V4e=6,xMe="AJSAJS",wMe="AFAFAF",yT=65,Fu=73,qd=79,ik=86,nk=90,tnt={forward:SMe,inverse:rnt,toPoint:TMe};function SMe(t,e){return e=e||5,ont(int({lat:t[1],lon:t[0]}),e)}function rnt(t){var e=Gee(EMe(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function TMe(t){var e=Gee(EMe(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Iee(t){return t*(Math.PI/180)}function j4e(t){return 180*(t/Math.PI)}function int(t){var e=t.lat,r=t.lon,i=6378137,n=.00669438,o=.9996,s,a,u,p,m,x,M,k=Iee(e),F=Iee(r),j,H;H=Math.floor((r+180)/6)+1,r===180&&(H=60),e>=56&&e<64&&r>=3&&r<12&&(H=32),e>=72&&e<84&&(r>=0&&r<9?H=31:r>=9&&r<21?H=33:r>=21&&r<33?H=35:r>=33&&r<42&&(H=37)),s=(H-1)*6-180+3,j=Iee(s),a=n/(1-n),u=i/Math.sqrt(1-n*Math.sin(k)*Math.sin(k)),p=Math.tan(k)*Math.tan(k),m=a*Math.cos(k)*Math.cos(k),x=Math.cos(k)*(F-j),M=i*((1-n/4-3*n*n/64-5*n*n*n/256)*k-(3*n/8+3*n*n/32+45*n*n*n/1024)*Math.sin(2*k)+(15*n*n/256+45*n*n*n/1024)*Math.sin(4*k)-35*n*n*n/3072*Math.sin(6*k));var W=o*u*(x+(1-p+m)*x*x*x/6+(5-18*p+p*p+72*m-58*a)*x*x*x*x*x/120)+5e5,Z=o*(M+u*Math.tan(k)*(x*x/2+(5-p+9*m+4*m*m)*x*x*x*x/24+(61-58*p+p*p+600*m-330*a)*x*x*x*x*x*x/720));return e<0&&(Z+=1e7),{northing:Math.round(Z),easting:Math.round(W),zoneNumber:H,zoneLetter:nnt(e)}}function Gee(t){var e=t.northing,r=t.easting,i=t.zoneLetter,n=t.zoneNumber;if(n<0||n>60)return null;var o=.9996,s=6378137,a=.00669438,u,p=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),m,x,M,k,F,j,H,W,Z,Y=r-5e5,ee=e;i<"N"&&(ee-=1e7),H=(n-1)*6-180+3,u=a/(1-a),j=ee/o,W=j/(s*(1-a/4-3*a*a/64-5*a*a*a/256)),Z=W+(3*p/2-27*p*p*p/32)*Math.sin(2*W)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*W)+151*p*p*p/96*Math.sin(6*W),m=s/Math.sqrt(1-a*Math.sin(Z)*Math.sin(Z)),x=Math.tan(Z)*Math.tan(Z),M=u*Math.cos(Z)*Math.cos(Z),k=s*(1-a)/Math.pow(1-a*Math.sin(Z)*Math.sin(Z),1.5),F=Y/(m*o);var ce=Z-m*Math.tan(Z)/k*(F*F/2-(5+3*x+10*M-4*M*M-9*u)*F*F*F*F/24+(61+90*x+298*M+45*x*x-252*u-3*M*M)*F*F*F*F*F*F/720);ce=j4e(ce);var ge=(F-(1+2*x+M)*F*F*F/6+(5-2*M+28*x-3*M*M+8*u+24*x*x)*F*F*F*F*F/120)/Math.cos(Z);ge=H+j4e(ge);var Se;if(t.accuracy){var ne=Gee({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});Se={top:ne.lat,right:ne.lon,bottom:ce,left:ge}}else Se={lat:ce,lon:ge};return Se}function nnt(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function ont(t,e){var r="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+snt(t.easting,t.northing,t.zoneNumber)+r.substr(r.length-5,e)+i.substr(i.length-5,e)}function snt(t,e,r){var i=MMe(r),n=Math.floor(t/1e5),o=Math.floor(e/1e5)%20;return ant(n,o,i)}function MMe(t){var e=t%V4e;return e===0&&(e=V4e),e}function ant(t,e,r){var i=r-1,n=xMe.charCodeAt(i),o=wMe.charCodeAt(i),s=n+t-1,a=o+e,u=!1;s>nk&&(s=s-nk+yT-1,u=!0),(s===Fu||n<Fu&&s>Fu||(s>Fu||n<Fu)&&u)&&s++,(s===qd||n<qd&&s>qd||(s>qd||n<qd)&&u)&&(s++,s===Fu&&s++),s>nk&&(s=s-nk+yT-1),a>ik?(a=a-ik+yT-1,u=!0):u=!1,(a===Fu||o<Fu&&a>Fu||(a>Fu||o<Fu)&&u)&&a++,(a===qd||o<qd&&a>qd||(a>qd||o<qd)&&u)&&(a++,a===Fu&&a++),a>ik&&(a=a-ik+yT-1);var p=String.fromCharCode(s)+String.fromCharCode(a);return p}function EMe(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,r=null,i="",n,o=0;!/[A-Z]/.test(n=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;i+=n,o++}var s=parseInt(i,10);if(o===0||o+3>e)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+t;r=t.substring(o,o+=2);for(var u=MMe(s),p=lnt(r.charAt(0),u),m=cnt(r.charAt(1),u);m<unt(a);)m+=2e6;var x=e-o;if(x%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var M=x/2,k=0,F=0,j,H,W,Z,Y;return M>0&&(j=1e5/Math.pow(10,M),H=t.substring(o,o+M),k=parseFloat(H)*j,W=t.substring(o+M),F=parseFloat(W)*j),Z=k+p,Y=F+m,{easting:Z,northing:Y,zoneLetter:a,zoneNumber:s,accuracy:j}}function lnt(t,e){for(var r=xMe.charCodeAt(e-1),i=1e5,n=!1;r!==t.charCodeAt(0);){if(r++,r===Fu&&r++,r===qd&&r++,r>nk){if(n)throw"Bad character: "+t;r=yT,n=!0}i+=1e5}return i}function cnt(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var r=wMe.charCodeAt(e-1),i=0,n=!1;r!==t.charCodeAt(0);){if(r++,r===Fu&&r++,r===qd&&r++,r>ik){if(n)throw"Bad character: "+t;r=yT,n=!0}i+=1e5}return i}function unt(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function wT(t,e,r){if(!(this instanceof wT))return new wT(t,e,r);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}wT.fromMGRS=function(t){return new wT(TMe(t))};wT.prototype.toMGRS=function(t){return SMe([this.x,this.y],t)};var hnt=1,dnt=.25,$4e=.046875,W4e=.01953125,G4e=.01068115234375,fnt=.75,pnt=.46875,mnt=.013020833333333334,gnt=.007120768229166667,Ant=.3645833333333333,ynt=.005696614583333333,_nt=.3076171875;function CMe(t){var e=[];e[0]=hnt-t*(dnt+t*($4e+t*(W4e+t*G4e))),e[1]=t*(fnt-t*($4e+t*(W4e+t*G4e)));var r=t*t;return e[2]=r*(pnt-t*(mnt+t*gnt)),r*=t,e[3]=r*(Ant-t*ynt),e[4]=r*t*_nt,e}function dz(t,e,r,i){return r*=e,e*=e,i[0]*t-r*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var vnt=20;function PMe(t,e,r){for(var i=1/(1-e),n=t,o=vnt;o;--o){var s=Math.sin(n),a=1-e*s*s;if(a=(dz(n,s,Math.cos(n),r)-t)*(a*Math.sqrt(a))*i,n-=a,Math.abs(a)<gr)return n}return n}function bnt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=CMe(this.es),this.ml0=dz(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function xnt(t){var e=t.x,r=t.y,i=Cr(e-this.long0),n,o,s,a=Math.sin(r),u=Math.cos(r);if(this.es){var m=u*i,x=Math.pow(m,2),M=this.ep2*Math.pow(u,2),k=Math.pow(M,2),F=Math.abs(u)>gr?Math.tan(r):0,j=Math.pow(F,2),H=Math.pow(j,2);n=1-this.es*Math.pow(a,2),m=m/Math.sqrt(n);var W=dz(r,a,u,this.en);o=this.a*(this.k0*m*(1+x/6*(1-j+M+x/20*(5-18*j+H+14*M-58*j*M+x/42*(61+179*H-H*j-479*j)))))+this.x0,s=this.a*(this.k0*(W-this.ml0+a*i*m/2*(1+x/12*(5-j+9*M+4*k+x/30*(61+H-58*j+270*M-330*j*M+x/56*(1385+543*H-H*j-3111*j))))))+this.y0}else{var p=u*Math.sin(i);if(Math.abs(Math.abs(p)-1)<gr)return 93;if(o=.5*this.a*this.k0*Math.log((1+p)/(1-p))+this.x0,s=u*Math.cos(i)/Math.sqrt(1-Math.pow(p,2)),p=Math.abs(s),p>=1){if(p-1>gr)return 93;s=0}else s=Math.acos(s);r<0&&(s=-s),s=this.a*this.k0*(s-this.lat0)+this.y0}return t.x=o,t.y=s,t}function wnt(t){var e,r,i,n,o=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+s/this.k0,r=PMe(e,this.es,this.en),Math.abs(r)<rr){var x=Math.sin(r),M=Math.cos(r),k=Math.abs(M)>gr?Math.tan(r):0,F=this.ep2*Math.pow(M,2),j=Math.pow(F,2),H=Math.pow(k,2),W=Math.pow(H,2);e=1-this.es*Math.pow(x,2);var Z=o*Math.sqrt(e)/this.k0,Y=Math.pow(Z,2);e=e*k,i=r-e*Y/(1-this.es)*.5*(1-Y/12*(5+3*H-9*F*H+F-4*j-Y/30*(61+90*H-252*F*H+45*W+46*F-Y/56*(1385+3633*H+4095*W+1574*W*H)))),n=Cr(this.long0+Z*(1-Y/6*(1+2*H+F-Y/20*(5+28*H+24*W+8*F*H+6*F-Y/42*(61+662*H+1320*W+720*W*H))))/M)}else i=rr*yk(s),n=0;else{var a=Math.exp(o/this.k0),u=.5*(a-1/a),p=this.lat0+s/this.k0,m=Math.cos(p);e=Math.sqrt((1-Math.pow(m,2))/(1+Math.pow(u,2))),i=Math.asin(e),s<0&&(i=-i),u===0&&m===0?n=0:n=Cr(Math.atan2(u,m)+this.long0)}return t.x=n,t.y=i,t}var Snt=["Fast_Transverse_Mercator","Fast Transverse Mercator"],KN={init:bnt,forward:xnt,inverse:wnt,names:Snt};function IMe(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function Xd(t,e){t=Math.abs(t),e=Math.abs(e);var r=Math.max(t,e),i=Math.min(t,e)/(r||1);return r*Math.sqrt(1+Math.pow(i,2))}function Tnt(t){var e=1+t,r=e-1;return r===0?t:t*Math.log(e)/r}function Mnt(t){var e=Math.abs(t);return e=Tnt(e*(1+e/(Xd(1,e)+1))),t<0?-e:e}function Hee(t,e){for(var r=2*Math.cos(2*e),i=t.length-1,n=t[i],o=0,s;--i>=0;)s=-o+r*n+t[i],o=n,n=s;return e+s*Math.sin(2*e)}function Ent(t,e){for(var r=2*Math.cos(e),i=t.length-1,n=t[i],o=0,s;--i>=0;)s=-o+r*n+t[i],o=n,n=s;return Math.sin(e)*s}function Cnt(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function kMe(t,e,r){for(var i=Math.sin(e),n=Math.cos(e),o=IMe(r),s=Cnt(r),a=2*n*s,u=-2*i*o,p=t.length-1,m=t[p],x=0,M=0,k=0,F,j;--p>=0;)F=M,j=x,M=m,x=k,m=-F+a*M-u*x+t[p],k=-j+u*M+a*x;return a=i*s,u=n*o,[a*m-u*k,a*k+u*m]}function Pnt(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(KN.init.apply(this),this.forward=KN.forward,this.inverse=KN.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),r=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),r=r*e,this.cgb[1]=r*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=r*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),r=r*e,this.cgb[2]=r*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=r*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),r=r*e,this.cgb[3]=r*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=r*(1237/630+e*(-12/5+e*(-24832/14175))),r=r*e,this.cgb[4]=r*(4174/315+e*(-144838/6237)),this.cbg[4]=r*(-734/315+e*(109598/31185)),r=r*e,this.cgb[5]=r*(601676/22275),this.cbg[5]=r*(444337/155925),r=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+r*(1/4+r*(1/64+r/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=r*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=r*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),r=r*e,this.utg[2]=r*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=r*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),r=r*e,this.utg[3]=r*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=r*(49561/161280+e*(-179/168+e*(6601661/7257600))),r=r*e,this.utg[4]=r*(-4583/161280+e*(108847/3991680)),this.gtu[4]=r*(34729/80640+e*(-3418889/1995840)),r=r*e,this.utg[5]=r*(-20648693/638668800),this.gtu[5]=r*(212378941/319334400);var i=Hee(this.cbg,this.lat0);this.Zb=-this.Qn*(i+Ent(this.gtu,2*i))}function Int(t){var e=Cr(t.x-this.long0),r=t.y;r=Hee(this.cbg,r);var i=Math.sin(r),n=Math.cos(r),o=Math.sin(e),s=Math.cos(e);r=Math.atan2(i,s*n),e=Math.atan2(o*n,Xd(i,n*s)),e=Mnt(Math.tan(e));var a=kMe(this.gtu,2*r,2*e);r=r+a[0],e=e+a[1];var u,p;return Math.abs(e)<=2.623395162778?(u=this.a*(this.Qn*e)+this.x0,p=this.a*(this.Qn*r+this.Zb)+this.y0):(u=1/0,p=1/0),t.x=u,t.y=p,t}function knt(t){var e=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);r=(r-this.Zb)/this.Qn,e=e/this.Qn;var i,n;if(Math.abs(e)<=2.623395162778){var o=kMe(this.utg,2*r,2*e);r=r+o[0],e=e+o[1],e=Math.atan(IMe(e));var s=Math.sin(r),a=Math.cos(r),u=Math.sin(e),p=Math.cos(e);r=Math.atan2(s*p,Xd(u,p*a)),e=Math.atan2(u,p*a),i=Cr(e+this.long0),n=Hee(this.cgb,r)}else i=1/0,n=1/0;return t.x=i,t.y=n,t}var Rnt=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"],QN={init:Pnt,forward:Int,inverse:knt,names:Rnt};function Ont(t,e){if(t===void 0){if(t=Math.floor((Cr(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var Dnt="etmerc";function Lnt(){var t=Ont(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Ul,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,QN.init.apply(this),this.forward=QN.forward,this.inverse=QN.inverse}var Bnt=["Universal Transverse Mercator System","utm"],Fnt={init:Lnt,names:Bnt,dependsOn:Dnt};function qee(t,e){return Math.pow((1-t)/(1+t),e)}var Nnt=20;function znt(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Yn)/(Math.pow(Math.tan(.5*this.lat0+Yn),this.C)*qee(this.e*t,this.ratexp))}function Unt(t){var e=t.x,r=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+Yn),this.C)*qee(this.e*Math.sin(r),this.ratexp))-rr,t.x=this.C*e,t}function Vnt(t){for(var e=1e-14,r=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+Yn)/this.K,1/this.C),o=Nnt;o>0&&(i=2*Math.atan(n*qee(this.e*Math.sin(t.y),-.5*this.e))-rr,!(Math.abs(i-t.y)<e));--o)t.y=i;return o?(t.x=r,t.y=i,t):null}var jnt=["gauss"],Yee={init:znt,forward:Unt,inverse:Vnt,names:jnt};function $nt(){Yee.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Wnt(t){var e,r,i,n;return t.x=Cr(t.x-this.long0),Yee.forward.apply(this,[t]),e=Math.sin(t.y),r=Math.cos(t.y),i=Math.cos(t.x),n=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*r*i),t.x=n*r*Math.sin(t.x),t.y=n*(this.cosc0*e-this.sinc0*r*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Gnt(t){var e,r,i,n,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Xd(t.x,t.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),r=Math.cos(s),n=Math.asin(r*this.sinc0+t.y*e*this.cosc0/o),i=Math.atan2(t.x*e,o*this.cosc0*r-t.y*this.sinc0*e)}else n=this.phic0,i=0;return t.x=i,t.y=n,Yee.inverse.apply(this,[t]),t.x=Cr(t.x+this.long0),t}var Hnt=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"],qnt={init:$nt,forward:Wnt,inverse:Gnt,names:Hnt};function Ynt(t,e,r){return e*=r,Math.tan(.5*(rr+t))*Math.pow((1-e)/(1+e),.5*r)}function Xnt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=gr&&(this.k0=.5*(1+yk(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=gr&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=gr&&Math.abs(Math.cos(this.lat_ts))>gr&&(this.k0=.5*this.cons*Y0(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/fp(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Y0(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-rr,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Znt(t){var e=t.x,r=t.y,i=Math.sin(r),n=Math.cos(r),o,s,a,u,p,m,x=Cr(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=gr&&Math.abs(r+this.lat0)<=gr?(t.x=NaN,t.y=NaN,t):this.sphere?(o=2*this.k0/(1+this.sinlat0*i+this.coslat0*n*Math.cos(x)),t.x=this.a*o*n*Math.sin(x)+this.x0,t.y=this.a*o*(this.coslat0*i-this.sinlat0*n*Math.cos(x))+this.y0,t):(s=2*Math.atan(this.ssfn_(r,i,this.e))-rr,u=Math.cos(s),a=Math.sin(s),Math.abs(this.coslat0)<=gr?(p=fp(this.e,r*this.con,this.con*i),m=2*this.a*this.k0*p/this.cons,t.x=this.x0+m*Math.sin(e-this.long0),t.y=this.y0-this.con*m*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<gr?(o=2*this.a*this.k0/(1+u*Math.cos(x)),t.y=o*a):(o=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*u*Math.cos(x))),t.y=o*(this.cosX0*a-this.sinX0*u*Math.cos(x))+this.y0),t.x=o*u*Math.sin(x)+this.x0,t))}function Knt(t){t.x-=this.x0,t.y-=this.y0;var e,r,i,n,o,s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,r=this.lat0,s<=gr?(t.x=e,t.y=r,t):(r=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/s),Math.abs(this.coslat0)<gr?this.lat0>0?e=Cr(this.long0+Math.atan2(t.x,-1*t.y)):e=Cr(this.long0+Math.atan2(t.x,t.y)):e=Cr(this.long0+Math.atan2(t.x*Math.sin(a),s*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=r,t)}else if(Math.abs(this.coslat0)<=gr){if(s<=gr)return r=this.lat0,e=this.long0,t.x=e,t.y=r,t;t.x*=this.con,t.y*=this.con,i=s*this.cons/(2*this.a*this.k0),r=this.con*mk(this.e,i),e=this.con*Cr(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else n=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=gr?o=this.X0:(o=Math.asin(Math.cos(n)*this.sinX0+t.y*Math.sin(n)*this.cosX0/s),e=Cr(this.long0+Math.atan2(t.x*Math.sin(n),s*this.cosX0*Math.cos(n)-t.y*this.sinX0*Math.sin(n)))),r=-1*mk(this.e,Math.tan(.5*(rr+o)));return t.x=e,t.y=r,t}var Qnt=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],Jnt={init:Xnt,forward:Znt,inverse:Knt,names:Qnt,ssfn_:Ynt};function eot(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),r=this.a,i=this.rf,n=1/i,o=2*n-Math.pow(n,2),s=this.e=Math.sqrt(o);this.R=this.k0*r*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+t/2)),p=Math.log((1+s*e)/(1-s*e));this.K=a-this.alpha*u+this.alpha*s/2*p}function tot(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+r)+this.K,n=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t}function rot(t){for(var e=t.x-this.x0,r=t.y-this.y0,i=e/this.R,n=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(i)),s=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(n))),a=this.lambda0+s/this.alpha,u=0,p=o,m=-1e3,x=0;Math.abs(p-m)>1e-7;){if(++x>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(p))/2)),m=p,p=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=a,t.y=p,t}var iot=["somerc"],not={init:eot,forward:tot,inverse:rot,names:iot},pT=1e-7;function oot(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],r=typeof t.PROJECTION=="object"?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||e.indexOf(r)!==-1}function sot(){var t,e,r,i,n,o,s,a,u,p,m=0,x,M=0,k=0,F=0,j=0,H=0,W=0;this.no_off=oot(this),this.no_rot="no_rot"in this;var Z=!1;"alpha"in this&&(Z=!0);var Y=!1;if("rectified_grid_angle"in this&&(Y=!0),Z&&(W=this.alpha),Y&&(m=this.rectified_grid_angle*Ul),Z||Y)M=this.longc;else if(k=this.long1,j=this.lat1,F=this.long2,H=this.lat2,Math.abs(j-H)<=pT||(t=Math.abs(j))<=pT||Math.abs(t-rr)<=pT||Math.abs(Math.abs(this.lat0)-rr)<=pT||Math.abs(Math.abs(H)-rr)<=pT)throw new Error;var ee=1-this.es;e=Math.sqrt(ee),Math.abs(this.lat0)>gr?(a=Math.sin(this.lat0),r=Math.cos(this.lat0),t=1-this.es*a*a,this.B=r*r,this.B=Math.sqrt(1+this.es*this.B*this.B/ee),this.A=this.B*this.k0*e/t,i=this.B*e/(r*Math.sqrt(t)),n=i*i-1,n<=0?n=0:(n=Math.sqrt(n),this.lat0<0&&(n=-n)),this.E=n+=i,this.E*=Math.pow(fp(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=n=1),Z||Y?(Z?(x=Math.asin(Math.sin(W)/i),Y||(m=W)):(x=m,W=Math.asin(i*Math.sin(x))),this.lam0=M-Math.asin(.5*(n-1/n)*Math.tan(x))/this.B):(o=Math.pow(fp(this.e,j,Math.sin(j)),this.B),s=Math.pow(fp(this.e,H,Math.sin(H)),this.B),n=this.E/o,u=(s-o)/(s+o),p=this.E*this.E,p=(p-s*o)/(p+s*o),t=k-F,t<-Math.pi?F-=fk:t>Math.pi&&(F+=fk),this.lam0=Cr(.5*(k+F)-Math.atan(p*Math.tan(.5*this.B*(k-F))/u)/this.B),x=Math.atan(2*Math.sin(this.B*Cr(k-this.lam0))/(n-1/n)),m=W=Math.asin(i*Math.sin(x))),this.singam=Math.sin(x),this.cosgam=Math.cos(x),this.sinrot=Math.sin(m),this.cosrot=Math.cos(m),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(W))),this.lat0<0&&(this.u_0=-this.u_0)),n=.5*x,this.v_pole_n=this.ArB*Math.log(Math.tan(Yn-n)),this.v_pole_s=this.ArB*Math.log(Math.tan(Yn+n))}function aot(t){var e={},r,i,n,o,s,a,u,p;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-rr)>gr){if(s=this.E/Math.pow(fp(this.e,t.y,Math.sin(t.y)),this.B),a=1/s,r=.5*(s-a),i=.5*(s+a),o=Math.sin(this.B*t.x),n=(r*this.singam-o*this.cosgam)/i,Math.abs(Math.abs(n)-1)<gr)throw new Error;p=.5*this.ArB*Math.log((1-n)/(1+n)),a=Math.cos(this.B*t.x),Math.abs(a)<pT?u=this.A*t.x:u=this.ArB*Math.atan2(r*this.cosgam+o*this.singam,a)}else p=t.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*t.y;return this.no_rot?(e.x=u,e.y=p):(u-=this.u_0,e.x=p*this.cosrot+u*this.sinrot,e.y=u*this.cosrot-p*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function lot(t){var e,r,i,n,o,s,a,u={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(r=t.y,e=t.x):(r=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*r),n=.5*(i-1/i),o=.5*(i+1/i),s=Math.sin(this.BrA*e),a=(s*this.cosgam+n*this.singam)/o,Math.abs(Math.abs(a)-1)<gr)u.x=0,u.y=a<0?-rr:rr;else{if(u.y=this.E/Math.sqrt((1+a)/(1-a)),u.y=mk(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw new Error;u.x=-this.rB*Math.atan2(n*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return u.x+=this.lam0,u}var cot=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"],uot={init:sot,forward:aot,inverse:lot,names:cot};function hot(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<gr)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),r=Math.cos(this.lat1),i=Y0(this.e,e,r),n=fp(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Y0(this.e,o,s),u=fp(this.e,this.lat2,o),p=fp(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>gr?this.ns=Math.log(i/a)/Math.log(n/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(n,this.ns)),this.rh=this.a*this.f0*Math.pow(p,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function dot(t){var e=t.x,r=t.y;Math.abs(2*Math.abs(r)-Math.PI)<=gr&&(r=yk(r)*(rr-2*gr));var i=Math.abs(Math.abs(r)-rr),n,o;if(i>gr)n=fp(this.e,r,Math.sin(r)),o=this.a*this.f0*Math.pow(n,this.ns);else{if(i=r*this.ns,i<=0)return null;o=0}var s=this.ns*Cr(e-this.long0);return t.x=this.k0*(o*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-o*Math.cos(s))+this.y0,t}function fot(t){var e,r,i,n,o,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+a*a),r=1):(e=-Math.sqrt(s*s+a*a),r=-1);var u=0;if(e!==0&&(u=Math.atan2(r*s,r*a)),e!==0||this.ns>0){if(r=1/this.ns,i=Math.pow(e/(this.a*this.f0),r),n=mk(this.e,i),n===-9999)return null}else n=-rr;return o=Cr(u/this.ns+this.long0),t.x=o,t.y=n,t}var pot=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"],mot={init:hot,forward:dot,inverse:fot,names:pot};function got(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Aot(t){var e,r,i,n,o,s,a,u=t.x,p=t.y,m=Cr(u-this.long0);return e=Math.pow((1+this.e*Math.sin(p))/(1-this.e*Math.sin(p)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(p/2+this.s45),this.alfa)/e)-this.s45),i=-m*this.alfa,n=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),o=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(n)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(n/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t}function yot(t){var e,r,i,n,o,s,a,u,p=t.x;t.x=t.y,t.y=p,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x),n=o/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),r=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(e)),t.x=this.long0-r/this.alfa,a=e,u=0;var m=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(u=1),a=t.y,m+=1;while(u===0&&m<15);return m>=15?null:t}var _ot=["Krovak","krovak"],vot={init:got,forward:Aot,inverse:yot,names:_ot};function Yc(t,e,r,i,n){return t*n-e*Math.sin(2*n)+r*Math.sin(4*n)-i*Math.sin(6*n)}function _k(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function vk(t){return .375*t*(1+.25*t*(1+.46875*t))}function bk(t){return .05859375*t*t*(1+.75*t)}function xk(t){return t*t*t*(35/3072)}function ST(t,e,r){var i=e*r;return t/Math.sqrt(1-i*i)}function MT(t){return Math.abs(t)<rr?t:t-yk(t)*Math.PI}function oz(t,e,r,i,n){var o,s;o=t/e;for(var a=0;a<15;a++)if(s=(t-(e*o-r*Math.sin(2*o)+i*Math.sin(4*o)-n*Math.sin(6*o)))/(e-2*r*Math.cos(2*o)+4*i*Math.cos(4*o)-6*n*Math.cos(6*o)),o+=s,Math.abs(s)<=1e-10)return o;return NaN}function bot(){this.sphere||(this.e0=_k(this.es),this.e1=vk(this.es),this.e2=bk(this.es),this.e3=xk(this.es),this.ml0=this.a*Yc(this.e0,this.e1,this.e2,this.e3,this.lat0))}function xot(t){var e,r,i=t.x,n=t.y;if(i=Cr(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(n)*Math.sin(i)),r=this.a*(Math.atan2(Math.tan(n),Math.cos(i))-this.lat0);else{var o=Math.sin(n),s=Math.cos(n),a=ST(this.a,this.e,o),u=Math.tan(n)*Math.tan(n),p=i*Math.cos(n),m=p*p,x=this.es*s*s/(1-this.es),M=this.a*Yc(this.e0,this.e1,this.e2,this.e3,n);e=a*p*(1-m*u*(1/6-(8-u+8*x)*m/120)),r=M-this.ml0+a*o/s*m*(.5+(5-u+6*x)*m/24)}return t.x=e+this.x0,t.y=r+this.y0,t}function wot(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,r=t.y/this.a,i,n;if(this.sphere){var o=r+this.lat0;i=Math.asin(Math.sin(o)*Math.cos(e)),n=Math.atan2(Math.tan(e),Math.cos(o))}else{var s=this.ml0/this.a+r,a=oz(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-rr)<=gr)return t.x=this.long0,t.y=rr,r<0&&(t.y*=-1),t;var u=ST(this.a,this.e,Math.sin(a)),p=u*u*u/this.a/this.a*(1-this.es),m=Math.pow(Math.tan(a),2),x=e*this.a/u,M=x*x;i=a-u*Math.tan(a)/p*x*x*(.5-(1+3*m)*x*x/24),n=x*(1-M*(m/3+(1+3*m)*m*M/15))/Math.cos(a)}return t.x=Cr(n+this.long0),t.y=MT(i),t}var Sot=["Cassini","Cassini_Soldner","cass"],Tot={init:bot,forward:xot,inverse:wot,names:Sot};function U_(t,e){var r;return t>1e-7?(r=t*e,(1-t*t)*(e/(1-r*r)-.5/t*Math.log((1-r)/(1+r)))):2*e}var Mot=1,Eot=2,Cot=3,Pot=4;function Iot(){var t=Math.abs(this.lat0);if(Math.abs(t-rr)<gr?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<gr?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=U_(this.e,1),this.mmf=.5/(1-this.es),this.apa=zot(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=U_(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function kot(t){var e,r,i,n,o,s,a,u,p,m,x=t.x,M=t.y;if(x=Cr(x-this.long0),this.sphere){if(o=Math.sin(M),m=Math.cos(M),i=Math.cos(x),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(r=this.mode===this.EQUIT?1+m*i:1+this.sinph0*o+this.cosph0*m*i,r<=gr)return null;r=Math.sqrt(2/r),e=r*m*Math.sin(x),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*m*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(M+this.lat0)<gr)return null;r=Yn-M*.5,r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)),e=r*Math.sin(x),r*=i}}else{switch(a=0,u=0,p=0,i=Math.cos(x),n=Math.sin(x),o=Math.sin(M),s=U_(this.e,o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=s/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:p=1+this.sinb1*a+this.cosb1*u*i;break;case this.EQUIT:p=1+u*i;break;case this.N_POLE:p=rr+M,s=this.qp-s;break;case this.S_POLE:p=M-rr,s=this.qp+s;break}if(Math.abs(p)<gr)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:p=Math.sqrt(2/p),this.mode===this.OBLIQ?r=this.ymf*p*(this.cosb1*a-this.sinb1*u*i):r=(p=Math.sqrt(2/(1+u*i)))*a*this.ymf,e=this.xmf*p*u*n;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(p=Math.sqrt(s))*n,r=i*(this.mode===this.S_POLE?p:-p)):e=r=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*r+this.y0,t}function Rot(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,r=t.y/this.a,i,n,o,s,a,u,p;if(this.sphere){var m=0,x,M=0;if(x=Math.sqrt(e*e+r*r),n=x*.5,n>1)return null;switch(n=2*Math.asin(n),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(M=Math.sin(n),m=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(x)<=gr?0:Math.asin(r*M/x),e*=M,r=m*x;break;case this.OBLIQ:n=Math.abs(x)<=gr?this.lat0:Math.asin(m*this.sinph0+r*M*this.cosph0/x),e*=M*this.cosph0,r=(m-Math.sin(n)*this.sinph0)*x;break;case this.N_POLE:r=-r,n=rr-n;break;case this.S_POLE:n-=rr;break}i=r===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,r)}else{if(p=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,r*=this.dd,u=Math.sqrt(e*e+r*r),u<gr)return t.x=this.long0,t.y=this.lat0,t;s=2*Math.asin(.5*u/this.rq),o=Math.cos(s),e*=s=Math.sin(s),this.mode===this.OBLIQ?(p=o*this.sinb1+r*s*this.cosb1/u,a=this.qp*p,r=u*this.cosb1*o-r*this.sinb1*s):(p=r*s/u,a=this.qp*p,r=u*o)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),a=e*e+r*r,!a)return t.x=this.long0,t.y=this.lat0,t;p=1-a/this.qp,this.mode===this.S_POLE&&(p=-p)}i=Math.atan2(e,r),n=Uot(Math.asin(p),this.apa)}return t.x=Cr(this.long0+i),t.y=n,t}var Oot=.3333333333333333,Dot=.17222222222222222,Lot=.10257936507936508,Bot=.06388888888888888,Fot=.0664021164021164,Not=.016415012942191543;function zot(t){var e,r=[];return r[0]=t*Oot,e=t*t,r[0]+=e*Dot,r[1]=e*Bot,e*=t,r[0]+=e*Lot,r[1]+=e*Fot,r[2]=e*Not,r}function Uot(t,e){var r=t+t;return t+e[0]*Math.sin(r)+e[1]*Math.sin(r+r)+e[2]*Math.sin(r+r+r)}var Vot=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],jot={init:Iot,forward:kot,inverse:Rot,names:Vot,S_POLE:Mot,N_POLE:Eot,EQUIT:Cot,OBLIQ:Pot};function j_(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function $ot(){Math.abs(this.lat1+this.lat2)<gr||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Y0(this.e3,this.sin_po,this.cos_po),this.qs1=U_(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Y0(this.e3,this.sin_po,this.cos_po),this.qs2=U_(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=U_(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>gr?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Wot(t){var e=t.x,r=t.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var i=U_(this.e3,this.sin_phi),n=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,o=this.ns0*Cr(e-this.long0),s=n*Math.sin(o)+this.x0,a=this.rh-n*Math.cos(o)+this.y0;return t.x=s,t.y=a,t}function Got(t){var e,r,i,n,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),n=0,e!==0&&(n=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-i*i)/(2*this.ns0)):(r=(this.c-i*i)/this.ns0,s=this.phi1z(this.e3,r)),o=Cr(n/this.ns0+this.long0),t.x=o,t.y=s,t}function Hot(t,e){var r,i,n,o,s,a=j_(.5*e);if(t<gr)return a;for(var u=t*t,p=1;p<=25;p++)if(r=Math.sin(a),i=Math.cos(a),n=t*r,o=1-n*n,s=.5*o*o/i*(e/(1-u)-r/o+.5/t*Math.log((1-n)/(1+n))),a=a+s,Math.abs(s)<=1e-7)return a;return null}var qot=["Albers_Conic_Equal_Area","Albers","aea"],Yot={init:$ot,forward:Wot,inverse:Got,names:qot,phi1z:Hot};function Xot(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Zot(t){var e,r,i,n,o,s,a,u,p=t.x,m=t.y;return i=Cr(p-this.long0),e=Math.sin(m),r=Math.cos(m),n=Math.cos(i),s=this.sin_p14*e+this.cos_p14*r*n,o=1,s>0||Math.abs(s)<=gr?(a=this.x0+this.a*o*r*Math.sin(i)/s,u=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*r*n)/s):(a=this.x0+this.infinity_dist*r*Math.sin(i),u=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*r*n)),t.x=a,t.y=u,t}function Kot(t){var e,r,i,n,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(n=Math.atan2(e,this.rc),r=Math.sin(n),i=Math.cos(n),s=j_(i*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r),o=Cr(this.long0+o)):(s=this.phic0,o=0),t.x=o,t.y=s,t}var Qot=["gnom"],Jot={init:Xot,forward:Zot,inverse:Kot,names:Qot};function est(t,e){var r=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-r)<1e-6)return e<0?-1*rr:rr;for(var i=Math.asin(.5*e),n,o,s,a,u=0;u<30;u++)if(o=Math.sin(i),s=Math.cos(i),a=t*o,n=Math.pow(1-a*a,2)/(2*s)*(e/(1-t*t)-o/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),i+=n,Math.abs(n)<=1e-10)return i;return NaN}function tst(){this.sphere||(this.k0=Y0(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function rst(t){var e=t.x,r=t.y,i,n,o=Cr(e-this.long0);if(this.sphere)i=this.x0+this.a*o*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var s=U_(this.e,Math.sin(r));i=this.x0+this.a*this.k0*o,n=this.y0+this.a*s*.5/this.k0}return t.x=i,t.y=n,t}function ist(t){t.x-=this.x0,t.y-=this.y0;var e,r;return this.sphere?(e=Cr(this.long0+t.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(r=est(this.e,2*t.y*this.k0/this.a),e=Cr(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=r,t}var nst=["cea"],ost={init:tst,forward:rst,inverse:ist,names:nst};function sst(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function ast(t){var e=t.x,r=t.y,i=Cr(e-this.long0),n=MT(r-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*n,t}function lst(t){var e=t.x,r=t.y;return t.x=Cr(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=MT(this.lat0+(r-this.y0)/this.a),t}var cst=["Equirectangular","Equidistant_Cylindrical","eqc"],ust={init:sst,forward:ast,inverse:lst,names:cst},H4e=20;function hst(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=_k(this.es),this.e1=vk(this.es),this.e2=bk(this.es),this.e3=xk(this.es),this.ml0=this.a*Yc(this.e0,this.e1,this.e2,this.e3,this.lat0)}function dst(t){var e=t.x,r=t.y,i,n,o,s=Cr(e-this.long0);if(o=s*Math.sin(r),this.sphere)Math.abs(r)<=gr?(i=this.a*s,n=-1*this.a*this.lat0):(i=this.a*Math.sin(o)/Math.tan(r),n=this.a*(MT(r-this.lat0)+(1-Math.cos(o))/Math.tan(r)));else if(Math.abs(r)<=gr)i=this.a*s,n=-1*this.ml0;else{var a=ST(this.a,this.e,Math.sin(r))/Math.tan(r);i=a*Math.sin(o),n=this.a*Yc(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*(1-Math.cos(o))}return t.x=i+this.x0,t.y=n+this.y0,t}function fst(t){var e,r,i,n,o,s,a,u,p;if(i=t.x-this.x0,n=t.y-this.y0,this.sphere)if(Math.abs(n+this.a*this.lat0)<=gr)e=Cr(i/this.a+this.long0),r=0;else{s=this.lat0+n/this.a,a=i*i/this.a/this.a+s*s,u=s;var m;for(o=H4e;o;--o)if(m=Math.tan(u),p=-1*(s*(u*m+1)-u-.5*(u*u+a)*m)/((u-s)/m-1),u+=p,Math.abs(p)<=gr){r=u;break}e=Cr(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(r))}else if(Math.abs(n+this.ml0)<=gr)r=0,e=Cr(this.long0+i/this.a);else{s=(this.ml0+n)/this.a,a=i*i/this.a/this.a+s*s,u=s;var x,M,k,F,j;for(o=H4e;o;--o)if(j=this.e*Math.sin(u),x=Math.sqrt(1-j*j)*Math.tan(u),M=this.a*Yc(this.e0,this.e1,this.e2,this.e3,u),k=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),F=M/this.a,p=(s*(x*F+1)-F-.5*x*(F*F+a))/(this.es*Math.sin(2*u)*(F*F+a-2*s*F)/(4*x)+(s-F)*(x*k-2/Math.sin(2*u))-k),u-=p,Math.abs(p)<=gr){r=u;break}x=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),e=Cr(this.long0+Math.asin(i*x/this.a)/Math.sin(r))}return t.x=e,t.y=r,t}var pst=["Polyconic","poly"],mst={init:hst,forward:dst,inverse:fst,names:pst};function gst(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Ast(t){var e,r=t.x,i=t.y,n=i-this.lat0,o=r-this.long0,s=n/sk*1e-5,a=o,u=1,p=0;for(e=1;e<=10;e++)u=u*s,p=p+this.A[e]*u;var m=p,x=a,M=1,k=0,F,j,H=0,W=0;for(e=1;e<=6;e++)F=M*m-k*x,j=k*m+M*x,M=F,k=j,H=H+this.B_re[e]*M-this.B_im[e]*k,W=W+this.B_im[e]*M+this.B_re[e]*k;return t.x=W*this.a+this.x0,t.y=H*this.a+this.y0,t}function yst(t){var e,r=t.x,i=t.y,n=r-this.x0,o=i-this.y0,s=o/this.a,a=n/this.a,u=1,p=0,m,x,M=0,k=0;for(e=1;e<=6;e++)m=u*s-p*a,x=p*s+u*a,u=m,p=x,M=M+this.C_re[e]*u-this.C_im[e]*p,k=k+this.C_im[e]*u+this.C_re[e]*p;for(var F=0;F<this.iterations;F++){var j=M,H=k,W,Z,Y=s,ee=a;for(e=2;e<=6;e++)W=j*M-H*k,Z=H*M+j*k,j=W,H=Z,Y=Y+(e-1)*(this.B_re[e]*j-this.B_im[e]*H),ee=ee+(e-1)*(this.B_im[e]*j+this.B_re[e]*H);j=1,H=0;var ce=this.B_re[1],ge=this.B_im[1];for(e=2;e<=6;e++)W=j*M-H*k,Z=H*M+j*k,j=W,H=Z,ce=ce+e*(this.B_re[e]*j-this.B_im[e]*H),ge=ge+e*(this.B_im[e]*j+this.B_re[e]*H);var Se=ce*ce+ge*ge;M=(Y*ce+ee*ge)/Se,k=(ee*ce-Y*ge)/Se}var ne=M,pe=k,ue=1,Le=0;for(e=1;e<=9;e++)ue=ue*ne,Le=Le+this.D[e]*ue;var We=this.lat0+Le*sk*1e5,ze=this.long0+pe;return t.x=ze,t.y=We,t}var _st=["New_Zealand_Map_Grid","nzmg"],vst={init:gst,forward:Ast,inverse:yst,names:_st};function bst(){}function xst(t){var e=t.x,r=t.y,i=Cr(e-this.long0),n=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return t.x=n,t.y=o,t}function wst(t){t.x-=this.x0,t.y-=this.y0;var e=Cr(this.long0+t.x/this.a),r=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=r,t}var Sst=["Miller_Cylindrical","mill"],Tst={init:bst,forward:xst,inverse:wst,names:Sst},Mst=20;function Est(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=CMe(this.es)}function Cst(t){var e,r,i=t.x,n=t.y;if(i=Cr(i-this.long0),this.sphere){if(!this.m)n=this.n!==1?Math.asin(this.n*Math.sin(n)):n;else for(var o=this.n*Math.sin(n),s=Mst;s;--s){var a=(this.m*n+Math.sin(n)-o)/(this.m+Math.cos(n));if(n-=a,Math.abs(a)<gr)break}e=this.a*this.C_x*i*(this.m+Math.cos(n)),r=this.a*this.C_y*n}else{var u=Math.sin(n),p=Math.cos(n);r=this.a*dz(n,u,p,this.en),e=this.a*i*p/Math.sqrt(1-this.es*u*u)}return t.x=e,t.y=r,t}function Pst(t){var e,r,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=j_((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=j_(Math.sin(e)/this.n)),i=Cr(i+this.long0),e=MT(e)):(e=PMe(t.y/this.a,this.es,this.en),n=Math.abs(e),n<rr?(n=Math.sin(e),r=this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)),i=Cr(r)):n-gr<rr&&(i=this.long0)),t.x=i,t.y=e,t}var Ist=["Sinusoidal","sinu"],kst={init:Est,forward:Cst,inverse:Pst,names:Ist};function Rst(){}function Ost(t){for(var e=t.x,r=t.y,i=Cr(e-this.long0),n=r,o=Math.PI*Math.sin(r);;){var s=-(n+Math.sin(n)-o)/(1+Math.cos(n));if(n+=s,Math.abs(s)<gr)break}n/=2,Math.PI/2-Math.abs(r)<gr&&(i=0);var a=.900316316158*this.a*i*Math.cos(n)+this.x0,u=1.4142135623731*this.a*Math.sin(n)+this.y0;return t.x=a,t.y=u,t}function Dst(t){var e,r;t.x-=this.x0,t.y-=this.y0,r=t.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),e=Math.asin(r);var i=Cr(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),r=(2*e+Math.sin(2*e))/Math.PI,Math.abs(r)>1&&(r=1);var n=Math.asin(r);return t.x=i,t.y=n,t}var Lst=["Mollweide","moll"],Bst={init:Rst,forward:Ost,inverse:Dst,names:Lst};function Fst(){Math.abs(this.lat1+this.lat2)<gr||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=_k(this.es),this.e1=vk(this.es),this.e2=bk(this.es),this.e3=xk(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Y0(this.e,this.sinphi,this.cosphi),this.ml1=Yc(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<gr?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Y0(this.e,this.sinphi,this.cosphi),this.ml2=Yc(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Yc(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Nst(t){var e=t.x,r=t.y,i;if(this.sphere)i=this.a*(this.g-r);else{var n=Yc(this.e0,this.e1,this.e2,this.e3,r);i=this.a*(this.g-n)}var o=this.ns*Cr(e-this.long0),s=this.x0+i*Math.sin(o),a=this.y0+this.rh-i*Math.cos(o);return t.x=s,t.y=a,t}function zst(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,r,i,n;this.ns>=0?(r=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(r=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(r!==0&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return n=Cr(this.long0+o/this.ns),i=MT(this.g-r/this.a),t.x=n,t.y=i,t;var s=this.g-r/this.a;return i=oz(s,this.e0,this.e1,this.e2,this.e3),n=Cr(this.long0+o/this.ns),t.x=n,t.y=i,t}var Ust=["Equidistant_Conic","eqdc"],Vst={init:Fst,forward:Nst,inverse:zst,names:Ust};function jst(){this.R=this.a}function $st(t){var e=t.x,r=t.y,i=Cr(e-this.long0),n,o;Math.abs(r)<=gr&&(n=this.x0+this.R*i,o=this.y0);var s=j_(2*Math.abs(r/Math.PI));(Math.abs(i)<=gr||Math.abs(Math.abs(r)-rr)<=gr)&&(n=this.x0,r>=0?o=this.y0+Math.PI*this.R*Math.tan(.5*s):o=this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/i-i/Math.PI),u=a*a,p=Math.sin(s),m=Math.cos(s),x=m/(p+m-1),M=x*x,k=x*(2/p-1),F=k*k,j=Math.PI*this.R*(a*(x-F)+Math.sqrt(u*(x-F)*(x-F)-(F+u)*(M-F)))/(F+u);i<0&&(j=-j),n=this.x0+j;var H=u+x;return j=Math.PI*this.R*(k*H-a*Math.sqrt((F+u)*(u+1)-H*H))/(F+u),r>=0?o=this.y0+j:o=this.y0-j,t.x=n,t.y=o,t}function Wst(t){var e,r,i,n,o,s,a,u,p,m,x,M,k;return t.x-=this.x0,t.y-=this.y0,x=Math.PI*this.R,i=t.x/x,n=t.y/x,o=i*i+n*n,s=-Math.abs(n)*(1+o),a=s-2*n*n+i*i,u=-2*s+1+2*n*n+o*o,k=n*n/u+(2*a*a*a/u/u/u-9*s*a/u/u)/27,p=(s-a*a/3/u)/u,m=2*Math.sqrt(-p/3),x=3*k/p/m,Math.abs(x)>1&&(x>=0?x=1:x=-1),M=Math.acos(x)/3,t.y>=0?r=(-m*Math.cos(M+Math.PI/3)-a/3/u)*Math.PI:r=-(-m*Math.cos(M+Math.PI/3)-a/3/u)*Math.PI,Math.abs(i)<gr?e=this.long0:e=Cr(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(i*i-n*n)+o*o))/2/i),t.x=e,t.y=r,t}var Gst=["Van_der_Grinten_I","VanDerGrinten","vandg"],Hst={init:jst,forward:$st,inverse:Wst,names:Gst};function qst(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Yst(t){var e=t.x,r=t.y,i=Math.sin(t.y),n=Math.cos(t.y),o=Cr(e-this.long0),s,a,u,p,m,x,M,k,F,j,H,W,Z,Y,ee,ce,ge,Se,ne,pe,ue,Le,We;return this.sphere?Math.abs(this.sin_p12-1)<=gr?(t.x=this.x0+this.a*(rr-r)*Math.sin(o),t.y=this.y0-this.a*(rr-r)*Math.cos(o),t):Math.abs(this.sin_p12+1)<=gr?(t.x=this.x0+this.a*(rr+r)*Math.sin(o),t.y=this.y0+this.a*(rr+r)*Math.cos(o),t):(Se=this.sin_p12*i+this.cos_p12*n*Math.cos(o),ce=Math.acos(Se),ge=ce?ce/Math.sin(ce):1,t.x=this.x0+this.a*ge*n*Math.sin(o),t.y=this.y0+this.a*ge*(this.cos_p12*i-this.sin_p12*n*Math.cos(o)),t):(s=_k(this.es),a=vk(this.es),u=bk(this.es),p=xk(this.es),Math.abs(this.sin_p12-1)<=gr?(m=this.a*Yc(s,a,u,p,rr),x=this.a*Yc(s,a,u,p,r),t.x=this.x0+(m-x)*Math.sin(o),t.y=this.y0-(m-x)*Math.cos(o),t):Math.abs(this.sin_p12+1)<=gr?(m=this.a*Yc(s,a,u,p,rr),x=this.a*Yc(s,a,u,p,r),t.x=this.x0+(m+x)*Math.sin(o),t.y=this.y0+(m+x)*Math.cos(o),t):(M=i/n,k=ST(this.a,this.e,this.sin_p12),F=ST(this.a,this.e,i),j=Math.atan((1-this.es)*M+this.es*k*this.sin_p12/(F*n)),H=Math.atan2(Math.sin(o),this.cos_p12*Math.tan(j)-this.sin_p12*Math.cos(o)),H===0?ne=Math.asin(this.cos_p12*Math.sin(j)-this.sin_p12*Math.cos(j)):Math.abs(Math.abs(H)-Math.PI)<=gr?ne=-Math.asin(this.cos_p12*Math.sin(j)-this.sin_p12*Math.cos(j)):ne=Math.asin(Math.sin(o)*Math.cos(j)/Math.sin(H)),W=this.e*this.sin_p12/Math.sqrt(1-this.es),Z=this.e*this.cos_p12*Math.cos(H)/Math.sqrt(1-this.es),Y=W*Z,ee=Z*Z,pe=ne*ne,ue=pe*ne,Le=ue*ne,We=Le*ne,ce=k*ne*(1-pe*ee*(1-ee)/6+ue/8*Y*(1-2*ee)+Le/120*(ee*(4-7*ee)-3*W*W*(1-7*ee))-We/48*Y),t.x=this.x0+ce*Math.sin(H),t.y=this.y0+ce*Math.cos(H),t))}function Xst(t){t.x-=this.x0,t.y-=this.y0;var e,r,i,n,o,s,a,u,p,m,x,M,k,F,j,H,W,Z,Y,ee,ce,ge,Se,ne;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*rr*this.a?void 0:(r=e/this.a,i=Math.sin(r),n=Math.cos(r),o=this.long0,Math.abs(e)<=gr?s=this.lat0:(s=j_(n*this.sin_p12+t.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-rr,Math.abs(a)<=gr?this.lat0>=0?o=Cr(this.long0+Math.atan2(t.x,-t.y)):o=Cr(this.long0-Math.atan2(-t.x,t.y)):o=Cr(this.long0+Math.atan2(t.x*i,e*this.cos_p12*n-t.y*this.sin_p12*i))),t.x=o,t.y=s,t)):(u=_k(this.es),p=vk(this.es),m=bk(this.es),x=xk(this.es),Math.abs(this.sin_p12-1)<=gr?(M=this.a*Yc(u,p,m,x,rr),e=Math.sqrt(t.x*t.x+t.y*t.y),k=M-e,s=oz(k/this.a,u,p,m,x),o=Cr(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=s,t):Math.abs(this.sin_p12+1)<=gr?(M=this.a*Yc(u,p,m,x,rr),e=Math.sqrt(t.x*t.x+t.y*t.y),k=e-M,s=oz(k/this.a,u,p,m,x),o=Cr(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=s,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),H=Math.atan2(t.x,t.y),F=ST(this.a,this.e,this.sin_p12),W=Math.cos(H),Z=this.e*this.cos_p12*W,Y=-Z*Z/(1-this.es),ee=3*this.es*(1-Y)*this.sin_p12*this.cos_p12*W/(1-this.es),ce=e/F,ge=ce-Y*(1+Y)*Math.pow(ce,3)/6-ee*(1+3*Y)*Math.pow(ce,4)/24,Se=1-Y*ge*ge/2-ce*ge*ge*ge/6,j=Math.asin(this.sin_p12*Math.cos(ge)+this.cos_p12*Math.sin(ge)*W),o=Cr(this.long0+Math.asin(Math.sin(H)*Math.sin(ge)/Math.cos(j))),ne=Math.sin(j),s=Math.atan2((ne-this.es*Se*this.sin_p12)*Math.tan(j),ne*(1-this.es)),t.x=o,t.y=s,t))}var Zst=["Azimuthal_Equidistant","aeqd"],Kst={init:qst,forward:Yst,inverse:Xst,names:Zst};function Qst(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Jst(t){var e,r,i,n,o,s,a,u,p=t.x,m=t.y;return i=Cr(p-this.long0),e=Math.sin(m),r=Math.cos(m),n=Math.cos(i),s=this.sin_p14*e+this.cos_p14*r*n,o=1,(s>0||Math.abs(s)<=gr)&&(a=this.a*o*r*Math.sin(i),u=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*r*n)),t.x=a,t.y=u,t}function eat(t){var e,r,i,n,o,s,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),r=j_(e/this.a),i=Math.sin(r),n=Math.cos(r),s=this.long0,Math.abs(e)<=gr?(a=this.lat0,t.x=s,t.y=a,t):(a=j_(n*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.abs(this.lat0)-rr,Math.abs(o)<=gr?(this.lat0>=0?s=Cr(this.long0+Math.atan2(t.x,-t.y)):s=Cr(this.long0-Math.atan2(-t.x,t.y)),t.x=s,t.y=a,t):(s=Cr(this.long0+Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i)),t.x=s,t.y=a,t))}var tat=["ortho"],rat={init:Qst,forward:Jst,inverse:eat,names:tat},bs={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Xn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function iat(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=rr-Yn/2?this.face=bs.TOP:this.lat0<=-(rr-Yn/2)?this.face=bs.BOTTOM:Math.abs(this.long0)<=Yn?this.face=bs.FRONT:Math.abs(this.long0)<=rr+Yn?this.face=this.long0>0?bs.RIGHT:bs.LEFT:this.face=bs.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function nat(t){var e={x:0,y:0},r,i,n,o,s,a,u={value:0};if(t.x-=this.long0,this.es!==0?r=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):r=t.y,i=t.x,this.face===bs.TOP)o=rr-r,i>=Yn&&i<=rr+Yn?(u.value=Xn.AREA_0,n=i-rr):i>rr+Yn||i<=-(rr+Yn)?(u.value=Xn.AREA_1,n=i>0?i-la:i+la):i>-(rr+Yn)&&i<=-Yn?(u.value=Xn.AREA_2,n=i+rr):(u.value=Xn.AREA_3,n=i);else if(this.face===bs.BOTTOM)o=rr+r,i>=Yn&&i<=rr+Yn?(u.value=Xn.AREA_0,n=-i+rr):i<Yn&&i>=-Yn?(u.value=Xn.AREA_1,n=-i):i<-Yn&&i>=-(rr+Yn)?(u.value=Xn.AREA_2,n=-i-rr):(u.value=Xn.AREA_3,n=i>0?-i+la:-i-la);else{var p,m,x,M,k,F,j;this.face===bs.RIGHT?i=bT(i,+rr):this.face===bs.BACK?i=bT(i,+la):this.face===bs.LEFT&&(i=bT(i,-rr)),M=Math.sin(r),k=Math.cos(r),F=Math.sin(i),j=Math.cos(i),p=k*j,m=k*F,x=M,this.face===bs.FRONT?(o=Math.acos(p),n=YN(o,x,m,u)):this.face===bs.RIGHT?(o=Math.acos(m),n=YN(o,x,-p,u)):this.face===bs.BACK?(o=Math.acos(-p),n=YN(o,x,-m,u)):this.face===bs.LEFT?(o=Math.acos(-m),n=YN(o,x,p,u)):(o=n=0,u.value=Xn.AREA_0)}return a=Math.atan(12/la*(n+Math.acos(Math.sin(n)*Math.cos(Yn))-rr)),s=Math.sqrt((1-Math.cos(o))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(n))))),u.value===Xn.AREA_1?a+=rr:u.value===Xn.AREA_2?a+=la:u.value===Xn.AREA_3&&(a+=1.5*la),e.x=s*Math.cos(a),e.y=s*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function oat(t){var e={lam:0,phi:0},r,i,n,o,s,a,u,p,m,x={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),r=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?x.value=Xn.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(x.value=Xn.AREA_1,r-=rr):t.x<0&&-t.x>=Math.abs(t.y)?(x.value=Xn.AREA_2,r=r<0?r+la:r-la):(x.value=Xn.AREA_3,r+=rr),m=la/12*Math.tan(r),s=Math.sin(m)/(Math.cos(m)-1/Math.sqrt(2)),a=Math.atan(s),n=Math.cos(r),o=Math.tan(i),u=1-n*n*o*o*(1-Math.cos(Math.atan(1/Math.cos(a)))),u<-1?u=-1:u>1&&(u=1),this.face===bs.TOP)p=Math.acos(u),e.phi=rr-p,x.value===Xn.AREA_0?e.lam=a+rr:x.value===Xn.AREA_1?e.lam=a<0?a+la:a-la:x.value===Xn.AREA_2?e.lam=a-rr:e.lam=a;else if(this.face===bs.BOTTOM)p=Math.acos(u),e.phi=p-rr,x.value===Xn.AREA_0?e.lam=-a+rr:x.value===Xn.AREA_1?e.lam=-a:x.value===Xn.AREA_2?e.lam=-a-rr:e.lam=a<0?-a-la:-a+la;else{var M,k,F;M=u,m=M*M,m>=1?F=0:F=Math.sqrt(1-m)*Math.sin(a),m+=F*F,m>=1?k=0:k=Math.sqrt(1-m),x.value===Xn.AREA_1?(m=k,k=-F,F=m):x.value===Xn.AREA_2?(k=-k,F=-F):x.value===Xn.AREA_3&&(m=k,k=F,F=-m),this.face===bs.RIGHT?(m=M,M=-k,k=m):this.face===bs.BACK?(M=-M,k=-k):this.face===bs.LEFT&&(m=M,M=k,k=-m),e.phi=Math.acos(-F)-rr,e.lam=Math.atan2(k,M),this.face===bs.RIGHT?e.lam=bT(e.lam,-rr):this.face===bs.BACK?e.lam=bT(e.lam,-la):this.face===bs.LEFT&&(e.lam=bT(e.lam,+rr))}if(this.es!==0){var j,H,W;j=e.phi<0?1:0,H=Math.tan(e.phi),W=this.b/Math.sqrt(H*H+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-W*W)/(this.one_minus_f*W)),j&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function YN(t,e,r,i){var n;return t<gr?(i.value=Xn.AREA_0,n=0):(n=Math.atan2(e,r),Math.abs(n)<=Yn?i.value=Xn.AREA_0:n>Yn&&n<=rr+Yn?(i.value=Xn.AREA_1,n-=rr):n>rr+Yn||n<=-(rr+Yn)?(i.value=Xn.AREA_2,n=n>=0?n-la:n+la):(i.value=Xn.AREA_3,n+=rr)),n}function bT(t,e){var r=t+e;return r<-la?r+=fk:r>+la&&(r-=fk),r}var sat=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"],aat={init:iat,forward:nat,inverse:oat,names:sat},zee=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],ok=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],RMe=.8487,OMe=1.3523,DMe=H0/5,lat=1/DMe,_T=18,sz=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},cat=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function uat(t,e,r,i){for(var n=e;i;--i){var o=t(n);if(n-=o,Math.abs(o)<r)break}return n}function hat(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function dat(t){var e=Cr(t.x-this.long0),r=Math.abs(t.y),i=Math.floor(r*DMe);i<0?i=0:i>=_T&&(i=_T-1),r=H0*(r-lat*i);var n={x:sz(zee[i],r)*e,y:sz(ok[i],r)};return t.y<0&&(n.y=-n.y),n.x=n.x*this.a*RMe+this.x0,n.y=n.y*this.a*OMe+this.y0,n}function fat(t){var e={x:(t.x-this.x0)/(this.a*RMe),y:Math.abs(t.y-this.y0)/(this.a*OMe)};if(e.y>=1)e.x/=zee[_T][0],e.y=t.y<0?-rr:rr;else{var r=Math.floor(e.y*_T);for(r<0?r=0:r>=_T&&(r=_T-1);;)if(ok[r][0]>e.y)--r;else if(ok[r+1][0]<=e.y)++r;else break;var i=ok[r],n=5*(e.y-i[0])/(ok[r+1][0]-i[0]);n=uat(function(o){return(sz(i,o)-e.y)/cat(i,o)},n,gr,100),e.x/=sz(zee[r],n),e.y=(5*r+n)*Ul,t.y<0&&(e.y=-e.y)}return e.x=Cr(e.x+this.long0),e}var pat=["Robinson","robin"],mat={init:hat,forward:dat,inverse:fat,names:pat};function gat(){this.name="geocent"}function Aat(t){var e=_Me(t,this.es,this.a);return e}function yat(t){var e=vMe(t,this.es,this.a,this.b);return e}var _at=["Geocentric","geocentric","geocent","Geocent"],vat={init:gat,forward:Aat,inverse:yat,names:_at},dc={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},tk={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function bat(){if(Object.keys(tk).forEach(function(r){if(typeof this[r]>"u")this[r]=tk[r].def;else{if(tk[r].num&&isNaN(this[r]))throw new Error("Invalid parameter value, must be numeric "+r+" = "+this[r]);tk[r].num&&(this[r]=parseFloat(this[r]))}tk[r].degrees&&(this[r]=this[r]*Ul)}.bind(this)),Math.abs(Math.abs(this.lat0)-rr)<gr?this.mode=this.lat0<0?dc.S_POLE:dc.N_POLE:Math.abs(this.lat0)<gr?this.mode=dc.EQUIT:(this.mode=dc.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function xat(t){t.x-=this.long0;var e=Math.sin(t.y),r=Math.cos(t.y),i=Math.cos(t.x),n,o;switch(this.mode){case dc.OBLIQ:o=this.sinph0*e+this.cosph0*r*i;break;case dc.EQUIT:o=r*i;break;case dc.S_POLE:o=-e;break;case dc.N_POLE:o=e;break}switch(o=this.pn1/(this.p-o),n=o*r*Math.sin(t.x),this.mode){case dc.OBLIQ:o*=this.cosph0*e-this.sinph0*r*i;break;case dc.EQUIT:o*=e;break;case dc.N_POLE:o*=-(r*i);break;case dc.S_POLE:o*=r*i;break}var s,a;return s=o*this.cg+n*this.sg,a=1/(s*this.sw*this.h1+this.cw),n=(n*this.cg-o*this.sg)*this.cw*a,o=s*a,t.x=n*this.a,t.y=o*this.a,t}function wat(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},r,i,n;n=1/(this.pn1-t.y*this.sw),r=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=r*this.cg+i*this.sg,t.y=i*this.cg-r*this.sg;var o=Xd(t.x,t.y);if(Math.abs(o)<gr)e.x=0,e.y=t.y;else{var s,a;switch(a=1-o*o*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/o+o/this.pn1),s=Math.sqrt(1-a*a),this.mode){case dc.OBLIQ:e.y=Math.asin(s*this.sinph0+t.y*a*this.cosph0/o),t.y=(s-this.sinph0*Math.sin(e.y))*o,t.x*=a*this.cosph0;break;case dc.EQUIT:e.y=Math.asin(t.y*a/o),t.y=s*o,t.x*=a;break;case dc.N_POLE:e.y=Math.asin(s),t.y=-t.y;break;case dc.S_POLE:e.y=-Math.asin(s);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var Sat=["Tilted_Perspective","tpers"],Tat={init:bat,forward:xat,inverse:wat,names:Sat};function Mat(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Eat(t){var e=t.x,r=t.y,i,n,o,s;if(e=e-this.long0,this.shape==="ellipse"){r=Math.atan(this.radius_p2*Math.tan(r));var a=this.radius_p/Xd(this.radius_p*Math.cos(r),Math.sin(r));if(n=a*Math.cos(e)*Math.cos(r),o=a*Math.sin(e)*Math.cos(r),s=a*Math.sin(r),(this.radius_g-n)*n-o*o-s*s*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;i=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(o/Xd(s,i)),t.y=this.radius_g_1*Math.atan(s/i)):(t.x=this.radius_g_1*Math.atan(o/i),t.y=this.radius_g_1*Math.atan(s/Xd(o,i)))}else this.shape==="sphere"&&(i=Math.cos(r),n=Math.cos(e)*i,o=Math.sin(e)*i,s=Math.sin(r),i=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(o/Xd(s,i)),t.y=this.radius_g_1*Math.atan(s/i)):(t.x=this.radius_g_1*Math.atan(o/i),t.y=this.radius_g_1*Math.atan(s/Xd(o,i))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function Cat(t){var e=-1,r=0,i=0,n,o,s,a;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(t.y/this.radius_g_1),r=Math.tan(t.x/this.radius_g_1)*Xd(1,i)):(r=Math.tan(t.x/this.radius_g_1),i=Math.tan(t.y/this.radius_g_1)*Xd(1,r));var u=i/this.radius_p;if(n=r*r+u*u+e*e,o=2*this.radius_g*e,s=o*o-4*n*this.C,s<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-o-Math.sqrt(s))/(2*n),e=this.radius_g+a*e,r*=a,i*=a,t.x=Math.atan2(r,e),t.y=Math.atan(i*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(t.y/this.radius_g_1),r=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+i*i)):(r=Math.tan(t.x/this.radius_g_1),i=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+r*r)),n=r*r+i*i+e*e,o=2*this.radius_g*e,s=o*o-4*n*this.C,s<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-o-Math.sqrt(s))/(2*n),e=this.radius_g+a*e,r*=a,i*=a,t.x=Math.atan2(r,e),t.y=Math.atan(i*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var Pat=["Geostationary Satellite View","Geostationary_Satellite","geos"],Iat={init:Mat,forward:Eat,inverse:Cat,names:Pat};function kat(t){t.Proj.projections.add(KN),t.Proj.projections.add(QN),t.Proj.projections.add(Fnt),t.Proj.projections.add(qnt),t.Proj.projections.add(Jnt),t.Proj.projections.add(not),t.Proj.projections.add(uot),t.Proj.projections.add(mot),t.Proj.projections.add(vot),t.Proj.projections.add(Tot),t.Proj.projections.add(jot),t.Proj.projections.add(Yot),t.Proj.projections.add(Jot),t.Proj.projections.add(ost),t.Proj.projections.add(ust),t.Proj.projections.add(mst),t.Proj.projections.add(vst),t.Proj.projections.add(Tst),t.Proj.projections.add(kst),t.Proj.projections.add(Bst),t.Proj.projections.add(Vst),t.Proj.projections.add(Hst),t.Proj.projections.add(Kst),t.Proj.projections.add(rat),t.Proj.projections.add(aat),t.Proj.projections.add(mat),t.Proj.projections.add(vat),t.Proj.projections.add(Tat),t.Proj.projections.add(Iat)}Nh.defaultDatum="WGS84";Nh.Proj=q0;Nh.WGS84=new Nh.Proj("WGS84");Nh.Point=wT;Nh.toPoint=bMe;Nh.defs=qc;Nh.nadgrid=zit;Nh.transform=nz;Nh.mgrs=tnt;Nh.version="__VERSION__";kat(Nh);function Rat(t,e,r){let i=Nh(e,r);return"data"in t?new Or(t.data.map(n=>q4e(n,i))):q4e(t,i)}function q4e(t,e){let r=[0,0];return uMe(t,(n,o)=>(r[0]=n,r[1]=o,e.forward(r)))}var z_;(function(t){t.POINT="geoarrow.point",t.LINESTRING="geoarrow.linestring",t.POLYGON="geoarrow.polygon",t.MULTIPOINT="geoarrow.multipoint",t.MULTILINESTRING="geoarrow.multilinestring",t.MULTIPOLYGON="geoarrow.multipolygon"})(z_||(z_={}));var az=class{minX;minY;maxX;maxY;constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}updateBbox(e){e.minX<this.minX&&(this.minX=e.minX),e.minY<this.minY&&(this.minY=e.minY),e.maxX>this.maxX&&(this.maxX=e.maxX),e.maxY>this.maxY&&(this.maxY=e.maxY)}updateCoord(e,r){e<this.minX&&(this.minX=e),r<this.minY&&(this.minY=r),e>this.maxX&&(this.maxX=e),r>this.maxY&&(this.maxY=r)}};function Oat(t,e){switch(e.metadata.get("ARROW:extension:name")){case z_.POINT:return LMe(t);case z_.LINESTRING:case z_.MULTIPOINT:return BMe(t);case z_.POLYGON:case z_.MULTILINESTRING:return FMe(t);case z_.MULTIPOLYGON:return Lat(t);default:throw new Error("Unknown ext type name")}}function Dat(t){let r=gk(t).values,i=new az;for(let n=0;n<t.length;n++){let o=r[n*2],s=r[n*2+1];i.updateCoord(o,s)}return i}function LMe(t){let e=new az;for(let r of t.data)e.updateBbox(Dat(r));return e}function BMe(t){let e=Ak(t);return LMe(e)}function FMe(t){let e=TT(t);return BMe(e)}function Lat(t){let e=cz(t);return FMe(e)}var Uee;(function(t){t[t.CLOCKWISE=E4e.CLOCKWISE]="CLOCKWISE",t[t.COUNTER_CLOCKWISE=E4e.COUNTER_CLOCKWISE]="COUNTER_CLOCKWISE"})(Uee||(Uee={}));function NMe(t){if("data"in t)return new Or(t.data.map(r=>NMe(r)));let e=new R_({type:new Iu,nullValues:[null]});e.set(t.length-1,null);for(let r=0;r<t.length;r++){if(!t.getValid(r)){e.setValid(r,!1);continue}let n=uz(t,r).getWindingDirection();e.set(r,n===Uee.CLOCKWISE)}return e.finish().flush()}function zMe(t,e){if("data"in t){t.data.forEach(r=>zMe(r,e));return}for(let r=0;r<t.length;r++)uz(t,r).modifyWindingDirection(e)}var Xee=Object.freeze({__proto__:null,area:Q4e,earcut:eMe,getMultiPolygonExterior:rMe,getPolygonExterior:tMe,mapCoords:uMe,modifyWindingDirection:zMe,reproject:Rat,signedArea:J4e,totalBounds:Oat,windingDirection:NMe});function ak(t,e=!1){if("data"in t)return new Or(t.data.map(o=>ak(o,e)));let r=[];for(let o of t.children)r.push(ak(o,e));let i;t.dictionary!==void 0&&(i=ak(t.dictionary,e));let n={[un.OFFSET]:XN(t.buffers[un.OFFSET],e),[un.DATA]:XN(t.buffers[un.DATA],e),[un.VALIDITY]:XN(t.buffers[un.VALIDITY],e),[un.TYPE]:XN(t.buffers[un.TYPE],e)};return new Ji(t.type,t.offset,t.length,t._nullCount,n,r,i)}function JN(t){if("data"in t)return t.data.some(r=>JN(r));for(let r of t.children)if(JN(r))return!0;if(t.dictionary!==void 0&&JN(t.dictionary))return!0;let e=[un.OFFSET,un.DATA,un.VALIDITY,un.TYPE];for(let r of e)if(t.buffers[r]!==void 0&&UMe(t.buffers[r]))return!0;return!1}function UMe(t){return!(t.byteOffset===0&&t.byteLength===t.buffer.byteLength)}function XN(t,e){return t===void 0||!e&&!UMe(t)?t:t.slice()}function ez(t,e=!1){if("data"in t){let i=[],n=[];for(let s of t.data){let[a,u]=ez(s);i.push(a),n.push(...u)}return[new Or(i),n]}t=ak(t,e);let r=[];for(let i=0;i<t.children.length;i++){let n=t.children[i],[o,s]=ez(n);t.children[i]=o,r.push(...s)}if(t.dictionary!==void 0){let[i,n]=ez(t.dictionary);t.dictionary=i,r.push(...n)}return t.buffers[un.OFFSET]!==void 0&&r.push(t.buffers[un.OFFSET].buffer),t.buffers[un.DATA]!==void 0&&r.push(t.buffers[un.DATA].buffer),t.buffers[un.VALIDITY]!==void 0&&r.push(t.buffers[un.VALIDITY].buffer),t.buffers[un.TYPE]!==void 0&&r.push(t.buffers[un.TYPE].buffer),[t,r]}function VMe(t){switch(t.typeId){case Qe.Null:return new fl;case Qe.Int:return new Fs(t.isSigned,t.bitWidth);case Qe.Float:return new pl(t.precision);case Qe.Binary:return new Bd;case Qe.Utf8:return new Fd;case Qe.Bool:return new Iu;case Qe.Decimal:return new Nd(t.scale,t.precision,t.bitWidth);case Qe.Date:return new zd(t.unit);case Qe.Time:return new Ud(t.unit,t.bitWidth);case Qe.Timestamp:return new Vd(t.unit,t.timezone);case Qe.Interval:return new jd(t.unit);case Qe.List:{let e=t.children.map(rk);if(e.length>1)throw new Error("expected 1 field");return new Za(e[0])}case Qe.Struct:{let e=t.children.map(rk);return new so(e)}case Qe.Union:{let e=t.children.map(rk);return new ku(t.mode,t.typeIds,e)}case Qe.FixedSizeBinary:return new Wd(t.byteWidth);case Qe.FixedSizeList:{let e=t.children.map(rk);if(e.length>1)throw new Error("expected 1 field");return new lc(t.listSize,e[0])}case Qe.Map:{let e=t.children.map(rk);if(e.length>1)throw new Error("expected 1 field");let r=e[0];return new Ru(r,t.keysSorted)}case Qe.Duration:return new $d(t.unit);default:throw new Error(`unknown type ${t}`)}}function rk(t){let e=VMe(t.type);return new Mi(t.name,e,t.nullable,t.metadata)}function Zee(t){let e=t.children.map(n=>Zee(n)),r=t.dictionary?jMe(t.dictionary):void 0,i={[un.OFFSET]:t.valueOffsets,[un.DATA]:t.values,[un.VALIDITY]:t.nullBitmap,[un.TYPE]:t.typeIds};return new Ji(VMe(t.type),t.offset,t.length,t._nullCount,i,e,r)}function jMe(t){return new Or(t.data.map(e=>Zee(e)))}var Kee=Object.freeze({__proto__:null,hardClone:ak,isShared:JN,preparePostMessage:ez,rehydrateData:Zee,rehydrateVector:jMe});function Bat(t,e,r){let i=t.fields.findIndex(n=>n.name===r||n.metadata.get("ARROW:extension:name")===e);return i!==-1?i:null}function Fat(t){return or.isFixedSizeList(t.type)}function Nat(t){return or.isStruct(t.type)}function Co(t){if(or.isList(t.type))return Co(t.children[0]);if(or.isStruct(t.type))return!0;if(or.isFixedSizeList(t.type))return!1;throw new Error(`Unsupported geometry data type: ${t.type}`)}function Xc(t){if(Fat(t))return t;if(Nat(t)){let e=t.children.length,r=new Float64Array(t.length*e);for(let a=0;a<t.length;a++)for(let u=0;u<e;u++)r[a*e+u]=t.children[u].values[a];let i=new xb,n=new lc(e,new Mi("coords",i)),o=Dr({type:i,length:r.length,data:r});return Dr({type:n,length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,child:o})}throw new Error(`Unsupported coordinate data type: ${t.type}`)}function ET(t){let e=Ni.getLineStringChild(t),r=Xc(e);return Dr({type:new Za(new Mi("element",r.type)),length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,valueOffsets:t.valueOffsets,offset:t.offset,child:r})}function tx(t){let e=Ni.getPolygonChild(t),r=ET(e);return Dr({type:new Za(new Mi("element",r.type)),length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,valueOffsets:t.valueOffsets,offset:t.offset,child:r})}function zat(t,e){let{index:r,data:i}=t,n=r;i.invertedGeomOffsets!==void 0&&(n=i.invertedGeomOffsets[r]);let o={data:i.data,length:i.length,attributes:i.attributes},s={index:n,data:o,target:t.target};return e(s)}function ao(t){let{props:e,propName:r,propInput:i,geomCoordOffsets:n}=t;if(i!==void 0)if(e.data.attributes=e.data.attributes||{},i instanceof Ji){let o=i;if(or.isFixedSizeList(o)){Pr(o.children.length===1);let s=o.children[0].values;n&&(s=fz(s,o.type.listSize,n)),e.data.attributes[r]={value:s,size:o.type.listSize,normalized:!0}}else if(or.isFloat(o)){let s=o.values;n&&(s=fz(s,1,n)),e.data.attributes[r]={value:s,size:1}}}else typeof i=="function"?e[r]=(o,s)=>r==="getPolygonOffset"?i(o,s):zat(s,i):e[r]=i}function fz(t,e,r){let i=r[r.length-1],n=new t.constructor(i*e);for(let o=0;o<r.length-1;o++){let s=r[o],a=r[o+1];for(let u=s;u<a;u++)for(let p=0;p<e;p++)n[u*e+p]=t[o*e+p]}return n}function ss(t,e){let r=Bat(t.schema,e);if(r===null)return null;let i=t.getChildAt(r);return Pr(i?.data.length===1),i.data[0]}function $Me(t){let e=t.valueOffsets,i=Ni.getMultiLineStringChild(t).valueOffsets,n=new Int32Array(e.length);for(let o=0;o<n.length;++o)n[o]=i[e[o]];return n}function Qee(t){let e=t.valueOffsets,i=Ni.getPolygonChild(t).valueOffsets,n=new Int32Array(e.length);for(let o=0;o<n.length;++o)n[o]=i[e[o]];return n}function WMe(t){let e=Ni.getMultiPolygonChild(t),r=Ni.getPolygonChild(e),i=t.valueOffsets,n=e.valueOffsets,o=r.valueOffsets,s=new Int32Array(i.length);for(let a=0;a<s.length;++a)s[a]=o[n[i[a]]];return s}function CT(t){let e=t[t.length-1],r=t.length<Math.pow(2,8)?Uint8Array:t.length<Math.pow(2,16)?Uint16Array:Uint32Array,i=new r(e);for(let n=0;n<t.length-1;n++){let o=t[n],s=t[n+1];for(let a=o;a<s;a++)i[a]=n}return i}function lo(t,e){let r={},i={};for(let[n,o]of Object.entries(t))e.includes(n)||(n.startsWith("get")?r[n]=o:i[n]=o);return[r,i]}function Vs({info:t,sourceLayer:e},r){let i=t.index;e.props.data.invertedGeomOffsets&&(i=e.props.data.invertedGeomOffsets[i]);let n=r.get(i);return n===null?t:{...t,index:i,object:n}}function co(t,e){let r=[],i=[];for(let[n,o]of Object.entries(t))n.startsWith("get")&&o instanceof Ji&&(r.push(o),n.endsWith("Color")&&i.push(o));Uat(e,r);for(let n of i)Vat(n)}function Uat(t,e){for(let r of e)Pr(t.numRows===r.length)}function Vat(t){Pr(or.isFixedSizeList(t.type)),Pr(t.type.listSize===3||t.type.listSize===4),Pr(or.isInt(t.type.children[0])),Pr(t.type.children[0].type.bitWidth===8)}var{data:E0r,getPentagon:C0r,...jat}=IN.defaultProps,GMe={_validate:!0},$at={...jat,...GMe},wk=class extends ji{static defaultProps=$at;static layerName="GeoArrowA5Layer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){return this._renderLayer()}_renderLayer(){let{data:e,getPentagon:r}=this.props;this.props._validate&&co(this.props,e);let[i,n]=lo(this.props,["getPentagon"]),o=new Or([r]),s={...GMe,...n,id:`${this.props.id}-geoarrow-a5`,data:{data:e,length:e.numRows},getPentagon:(a,u)=>o.get(u.index)};for(let[a,u]of Object.entries(i))ao({props:s,propName:a,propInput:u});return new IN(this.getSubLayerProps(s))}};var{data:B0r,getSourcePosition:F0r,getTargetPosition:N0r,...Wat}=jF.defaultProps,HMe={_validate:!0},Gat={...Wat,...HMe},Sk=class extends ji{static defaultProps=Gat;static layerName="GeoArrowArcLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){return this._renderLayersPoint()}_renderLayersPoint(){let{data:e}=this.props,{getSourcePosition:r,getTargetPosition:i}=this.props;this.props._validate&&(co(this.props,e),Pr($r.isPointData(r)),Pr($r.isPointData(i)));let[n,o]=lo(this.props,["getSourcePosition","getTargetPosition"]);Co(r)&&(r=Xc(r));let s=Ni.getPointChild(r).values;Co(i)&&(i=Xc(i));let a=Ni.getPointChild(i).values,u={...HMe,...o,id:`${this.props.id}-geoarrow-arc`,data:{data:e,length:r.length,attributes:{getSourcePosition:{value:s,size:r.type.listSize},getTargetPosition:{value:a,size:i.type.listSize}}}};for(let[p,m]of Object.entries(n))ao({props:u,propName:p,propInput:m});return new jF(this.getSubLayerProps(u))}};var Uo;(function(t){t.POINT="geoarrow.point",t.LINESTRING="geoarrow.linestring",t.POLYGON="geoarrow.polygon",t.MULTIPOINT="geoarrow.multipoint",t.MULTILINESTRING="geoarrow.multilinestring",t.MULTIPOLYGON="geoarrow.multipolygon"})(Uo||(Uo={}));var{data:q0r,getPosition:Y0r,...Hat}=XS.defaultProps,qMe={_validate:!0},qat={...Hat,...qMe},Tk=class extends ji{static defaultProps=qat;static layerName="GeoArrowColumnLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){let{data:e}=this.props,r=ss(e,Uo.POINT);if(r!==null&&$r.isPointData(r))return this._renderPointLayer(r);let i=this.props.getPosition;if(i!==void 0&&$r.isPointData(i))return this._renderPointLayer(i);throw new Error("getPosition not GeoArrow point")}_renderPointLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isPointData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPosition"]);Co(e)&&(e=Xc(e));let s=Ni.getPointChild(e).values,a={...qMe,...n,id:`${this.props.id}-geoarrow-column`,data:{data:r,length:e.length,attributes:{getPosition:{value:s,size:e.type.listSize}}}};for(let[u,p]of Object.entries(i))ao({props:a,propName:u,propInput:p});return new XS(this.getSubLayerProps(a))}};var{data:tmr,getGeohash:rmr,...Yat}=$N.defaultProps,YMe={_validate:!0},Xat={...Yat,...YMe},Mk=class extends ji{static defaultProps=Xat;static layerName="GeoArrowGeohashLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){return this._renderLayer()}_renderLayer(){let{data:e,getGeohash:r}=this.props;this.props._validate&&co(this.props,e);let[i,n]=lo(this.props,["getGeohash"]),o=new Or([r]),s={...YMe,...n,id:`${this.props.id}-geoarrow-geohash`,data:{data:e,length:e.numRows},getGeohash:(a,u)=>o.get(u.index)};for(let[a,u]of Object.entries(i))ao({props:s,propName:a,propInput:u});return new $N(this.getSubLayerProps(s))}};var{data:cmr,getHexagon:umr,...Zat}=VN.defaultProps,XMe={_validate:!0},Kat={...Zat,...XMe},Ek=class extends ji{static defaultProps=Kat;static layerName="GeoArrowH3HexagonLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){return this._renderLayer()}_renderLayer(){let{data:e,getHexagon:r}=this.props;this.props._validate&&co(this.props,e);let[i,n]=lo(this.props,["getHexagon"]),o=new Or([r]),s={...XMe,...n,id:`${this.props.id}-geoarrow-h3`,data:{data:e,length:r.length},getHexagon:(a,u)=>{let p=o.get(u.index);return typeof p=="string"?p:p.toString(16)}};for(let[a,u]of Object.entries(i))ao({props:s,propName:a,propInput:u});return new VN(this.getSubLayerProps(s))}};var ZMe=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function KMe(t,e=!1,r=Float32Array){let i;if(Number.isFinite(t[0]))i=new r(t);else{i=new r(t.length*4);let n=0;for(let o=0;o<t.length;o++){let s=t[o];i[n++]=s[0],i[n++]=s[1],i[n++]=s[2],i[n++]=Number.isFinite(s[3])?s[3]:255}}if(e)for(let n=0;n<i.length;n++)i[n]/=255;return i}function JMe(t){let e=t.map(a=>a[0]),r=t.map(a=>a[1]),i=Math.min.apply(null,e),n=Math.max.apply(null,e),o=Math.min.apply(null,r),s=Math.max.apply(null,r);return[i,o,n,s]}function eEe(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}var QMe=new Float32Array(12);function Jee(t,e=2){let r=0;for(let i of t)for(let n=0;n<e;n++)QMe[r++]=i[n]||0;return QMe}function tEe(t,e,r){let[i,n,o,s]=t,a=o-i,u=s-n,p=a,m=u;a/u<e/r?p=e/r*u:m=r/e*a,p<e&&(p=e,m=r);let x=(o+i)/2,M=(s+n)/2;return[x-p/2,M-m/2,x+p/2,M+m/2]}function rEe(t,e){let[r,i,n,o]=e;return[(t[0]-r)/(n-r),(t[1]-i)/(o-i)]}var iEe=`#version 300 es
#define SHADER_NAME heatp-map-layer-vertex-shader
uniform sampler2D maxTexture;
in vec3 positions;
in vec2 texCoords;
out vec2 vTexCoords;
out float vIntensityMin;
out float vIntensityMax;
void main(void) {
gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));
vTexCoords = texCoords;
vec4 maxTexture = texture(maxTexture, vec2(0.5));
float maxValue = triangle.aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;
float minValue = maxValue * triangle.threshold;
if (triangle.colorDomain[1] > 0.) {
maxValue = triangle.colorDomain[1];
minValue = triangle.colorDomain[0];
}
vIntensityMax = triangle.intensity / maxValue;
vIntensityMin = triangle.intensity / minValue;
}
`;var nEe=`#version 300 es
#define SHADER_NAME triangle-layer-fragment-shader
precision highp float;
uniform sampler2D weightsTexture;
uniform sampler2D colorTexture;
in vec2 vTexCoords;
in float vIntensityMin;
in float vIntensityMax;
out vec4 fragColor;
vec4 getLinearColor(float value) {
float factor = clamp(value * vIntensityMax, 0., 1.);
vec4 color = texture(colorTexture, vec2(factor, 0.5));
color.a *= min(value * vIntensityMin, 1.0);
return color;
}
void main(void) {
vec4 weights = texture(weightsTexture, vTexCoords);
float weight = weights.r;
if (triangle.aggregationMode > 0.5) {
weight /= max(1.0, weights.a);
}
if (weight <= 0.) {
discard;
}
vec4 linearColor = getLinearColor(weight);
linearColor.a *= layer.opacity;
fragColor = linearColor;
}
`;var oEe=`uniform triangleUniforms {
  float aggregationMode;
  vec2 colorDomain;
  float intensity;
  float threshold;
} triangle;
`,sEe={name:"triangle",vs:oEe,fs:oEe,uniformTypes:{aggregationMode:"f32",colorDomain:"vec2<f32>",intensity:"f32",threshold:"f32"}};var pz=class extends Mo{getShaders(){return super.getShaders({vs:iEe,fs:nEe,modules:[No,sEe]})}initializeState({device:e}){this.setState({model:this._getModel(e)})}_getModel(e){let{vertexCount:r,data:i}=this.props;return new bn(e,{...this.getShaders(),id:this.props.id,attributes:i.attributes,bufferLayout:[{name:"positions",format:"float32x3"},{name:"texCoords",format:"float32x2"}],topology:"triangle-strip",vertexCount:r})}draw(){let{model:e}=this.state,{aggregationMode:r,colorDomain:i,intensity:n,threshold:o,colorTexture:s,maxTexture:a,weightsTexture:u}=this.props,p={aggregationMode:r,colorDomain:i,intensity:n,threshold:o,colorTexture:s,maxTexture:a,weightsTexture:u};e.shaderInputs.setProps({triangle:p}),e.draw(this.context.renderPass)}};pz.layerName="TriangleLayer";var aEe=pz;function lEe(t,e){let r={};for(let i in t)e.includes(i)||(r[i]=t[i]);return r}var mz=class extends ji{initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:lEe(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);let{changeFlags:r}=e;if(r.extensionsChanged){let i=this.getShaders({});i&&i.defines&&(i.defines.NON_INSTANCED_MODEL=1),this.updateShaders(i)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){let{viewport:e,mousePosition:r,device:i}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:r,picking:{isActive:0},devicePixelRatio:i.canvasContext.cssToDeviceRatio()})}updateShaders(e){}isAggregationDirty(e,r={}){let{props:i,oldProps:n,changeFlags:o}=e,{compareAll:s=!1,dimension:a}=r,{ignoreProps:u}=this.state,{props:p,accessors:m=[]}=a,{updateTriggersChanged:x}=o;if(o.dataChanged)return!0;if(x){if(x.all)return!0;for(let M of m)if(x[M])return!0}if(s)return o.extensionsChanged?!0:bP({oldProps:n,newProps:i,ignoreProps:u,propTypes:this.constructor._propTypes});for(let M of p)if(i[M]!==n[M])return!0;return!1}isAttributeChanged(e){let{changedAttributes:r}=this.state;return e?r&&r[e]!==void 0:!Qat(r)}_getAttributeManager(){return new T0(this.context.device,{id:this.props.id,stats:this.context.stats})}};mz.layerName="AggregationLayer";var cEe=mz;function Qat(t){let e=!0;for(let r in t){e=!1;break}return e}var gz=`#version 300 es
in vec3 positions;
in vec3 positions64Low;
in float weights;
out vec4 weightsTexture;
void main()
{
weightsTexture = vec4(weights * weight.weightsScale, 0., 0., 1.);
float radiusTexels = project_pixel_size(weight.radiusPixels) * weight.textureWidth / (weight.commonBounds.z - weight.commonBounds.x);
gl_PointSize = radiusTexels * 2.;
vec3 commonPosition = project_position(positions, positions64Low);
gl_Position.xy = (commonPosition.xy - weight.commonBounds.xy) / (weight.commonBounds.zw - weight.commonBounds.xy) ;
gl_Position.xy = (gl_Position.xy * 2.) - (1.);
gl_Position.w = 1.0;
}
`;var Az=`#version 300 es
in vec4 weightsTexture;
out vec4 fragColor;
float gaussianKDE(float u){
return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);
}
void main()
{
float dist = length(gl_PointCoord - vec2(0.5, 0.5));
if (dist > 0.5) {
discard;
}
fragColor = weightsTexture * gaussianKDE(2. * dist);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var uEe=`#version 300 es
uniform sampler2D inTexture;
out vec4 outTexture;
void main()
{
int yIndex = gl_VertexID / int(maxWeight.textureSize);
int xIndex = gl_VertexID - (yIndex * int(maxWeight.textureSize));
vec2 uv = (0.5 + vec2(float(xIndex), float(yIndex))) / maxWeight.textureSize;
outTexture = texture(inTexture, uv);
gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
gl_PointSize = 1.0;
}
`;var hEe=`#version 300 es
in vec4 outTexture;
out vec4 fragColor;
void main() {
fragColor = outTexture;
fragColor.g = outTexture.r / max(1.0, outTexture.a);
}
`;var Jat=`uniform weightUniforms {
  vec4 commonBounds;
  float radiusPixels;
  float textureWidth;
  float weightsScale;
} weight;
`,dEe={name:"weight",vs:Jat,uniformTypes:{commonBounds:"vec4<f32>",radiusPixels:"f32",textureWidth:"f32",weightsScale:"f32"}},fEe={name:"maxWeight",vs:`uniform maxWeightUniforms {
  float textureSize;
} maxWeight;
`,uniformTypes:{textureSize:"f32"}};var elt=2,ete={format:"rgba8unorm",dimension:"2d",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},pEe=[0,0],tlt={SUM:0,MEAN:1},rlt={getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:ZMe,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},ilt=["float32-renderable-webgl","texture-blend-float-webgl"],nlt={data:{props:["radiusPixels"]}},Ck=class extends cEe{getShaders(e){let r=[No];return e.modules&&(r=[...r,...e.modules]),super.getShaders({...e,modules:r})}initializeState(){super.initializeAggregationLayer(nlt),this.setState({colorDomain:pEe}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){super.updateState(e),this._updateHeatmapState(e)}_updateHeatmapState(e){let{props:r,oldProps:i}=e,n=this._getChangeFlags(e);if((n.dataChanged||n.viewportChanged)&&(n.boundsChanged=this._updateBounds(n.dataChanged),this._updateTextureRenderingBounds()),n.dataChanged||n.boundsChanged){if(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0}),n.dataChanged){let o=this.getShaders({vs:gz,fs:Az});this._createWeightsTransform(o)}}else n.viewportZoomChanged&&this._debouncedUpdateWeightmap();r.colorRange!==i.colorRange&&this._updateColorTexture(e),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:e.context.viewport.zoom})}renderLayers(){let{weightsTexture:e,triPositionBuffer:r,triTexCoordBuffer:i,maxWeightsTexture:n,colorTexture:o,colorDomain:s}=this.state,{updateTriggers:a,intensity:u,threshold:p,aggregation:m}=this.props,x=this.getSubLayerClass("triangle",aEe);return new x(this.getSubLayerProps({id:"triangle-layer",updateTriggers:a}),{coordinateSystem:Gr.DEFAULT,data:{attributes:{positions:r,texCoords:i}},vertexCount:4,maxTexture:n,colorTexture:o,aggregationMode:tlt[m]||0,weightsTexture:e,intensity:u,threshold:p,colorDomain:s})}finalizeState(e){super.finalizeState(e);let{weightsTransform:r,weightsTexture:i,maxWeightTransform:n,maxWeightsTexture:o,triPositionBuffer:s,triTexCoordBuffer:a,colorTexture:u,updateTimer:p}=this.state;r?.destroy(),i?.destroy(),n?.destroy(),o?.destroy(),s?.destroy(),a?.destroy(),u?.destroy(),p&&clearTimeout(p)}_getAttributeManager(){return new T0(this.context.device,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(e){let r={},{dimensions:i}=this.state;r.dataChanged=this.isAttributeChanged()&&"attribute changed"||this.isAggregationDirty(e,{compareAll:!0,dimension:i.data})&&"aggregation is dirty",r.viewportChanged=e.changeFlags.viewportChanged;let{zoom:n}=this.state;return(!e.context.viewport||e.context.viewport.zoom!==n)&&(r.viewportZoomChanged=!0),r}_createTextures(){let{textureSize:e,format:r}=this.state;this.setState({weightsTexture:this.context.device.createTexture({...ete,width:e,height:e,format:r}),maxWeightsTexture:this.context.device.createTexture({...ete,width:1,height:1,format:r})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){let{device:e}=this.context,{weightsTextureSize:r}=this.props,i=Math.min(r,e.limits.maxTextureDimension2D),n=ilt.every(a=>e.features.has(a)),o=n?"rgba32float":"rgba8unorm",s=n?1:1/255;this.setState({textureSize:i,format:o,weightsScale:s}),n||mr.warn(`HeatmapLayer: ${this.id} rendering to float texture not supported, falling back to low precision format`)()}_createWeightsTransform(e){let{weightsTransform:r}=this.state,{weightsTexture:i}=this.state,n=this.getAttributeManager();r?.destroy(),r=new U3(this.context.device,{id:`${this.id}-weights-transform`,bufferLayout:n.getBufferLayouts(),vertexCount:1,targetTexture:i,parameters:{depthWriteEnabled:!1,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"},topology:"point-list",...e,modules:[...e.modules,dEe]}),this.setState({weightsTransform:r})}_setupResources(){this._createTextures();let{device:e}=this.context,{textureSize:r,weightsTexture:i,maxWeightsTexture:n}=this.state,o=this.getShaders({vs:gz,fs:Az});this._createWeightsTransform(o);let s=this.getShaders({vs:uEe,fs:hEe,modules:[fEe]}),a=new U3(e,{id:`${this.id}-max-weights-transform`,targetTexture:n,...s,vertexCount:r*r,topology:"point-list",parameters:{depthWriteEnabled:!1,blendColorOperation:"max",blendAlphaOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}}),u={inTexture:i,textureSize:r};a.model.shaderInputs.setProps({maxWeight:u}),this.setState({weightsTexture:i,maxWeightsTexture:n,maxWeightTransform:a,zoom:null,triPositionBuffer:e.createBuffer({byteLength:48}),triTexCoordBuffer:e.createBuffer({byteLength:48})})}updateShaders(e){this._createWeightsTransform({vs:gz,fs:Az,...e})}_updateMaxWeightValue(){let{maxWeightTransform:e}=this.state;e.run({parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]})}_updateBounds(e=!1){let{viewport:r}=this.context,i=[r.unproject([0,0]),r.unproject([r.width,0]),r.unproject([0,r.height]),r.unproject([r.width,r.height])].map(a=>a.map(Math.fround)),n=JMe(i),o={visibleWorldBounds:n,viewportCorners:i},s=!1;if(e||!this.state.worldBounds||!eEe(this.state.worldBounds,n)){let a=this._worldToCommonBounds(n),u=this._commonToWorldBounds(a);this.props.coordinateSystem===Gr.LNGLAT&&(u[1]=Math.max(u[1],-85.051129),u[3]=Math.min(u[3],85.051129),u[0]=Math.max(u[0],-360),u[2]=Math.min(u[2],360));let p=this._worldToCommonBounds(u);o.worldBounds=u,o.normalizedCommonBounds=p,s=!0}return this.setState(o),s}_updateTextureRenderingBounds(){let{triPositionBuffer:e,triTexCoordBuffer:r,normalizedCommonBounds:i,viewportCorners:n}=this.state,{viewport:o}=this.context;e.write(Jee(n,3));let s=n.map(a=>rEe(o.projectPosition(a),i));r.write(Jee(s,2))}_updateColorTexture(e){let{colorRange:r}=e.props,{colorTexture:i}=this.state,n=KMe(r,!1,Uint8Array);i?.destroy(),i=this.context.device.createTexture({...ete,data:n,width:r.length,height:1}),this.setState({colorTexture:i})}_updateWeightmap(){let{radiusPixels:e,colorDomain:r,aggregation:i}=this.props,{worldBounds:n,textureSize:o,weightsScale:s,weightsTexture:a}=this.state,u=this.state.weightsTransform;this.state.isWeightMapDirty=!1;let p=this._worldToCommonBounds(n,{useLayerCoordinateSystem:!0});if(r&&i==="SUM"){let{viewport:Y}=this.context,ee=Y.distanceScales.metersPerUnit[2]*(p[2]-p[0])/o;this.state.colorDomain=r.map(ce=>ce*ee*s)}else this.state.colorDomain=r||pEe;let x=this.getAttributeManager().getAttributes(),M=this.getModuleSettings();this._setModelAttributes(u.model,x),u.model.setVertexCount(this.getNumInstances());let k={radiusPixels:e,commonBounds:p,textureWidth:o,weightsScale:s,weightsTexture:a},{viewport:F,devicePixelRatio:j,coordinateSystem:H,coordinateOrigin:W}=M,{modelMatrix:Z}=this.props;u.model.shaderInputs.setProps({project:{viewport:F,devicePixelRatio:j,modelMatrix:Z,coordinateSystem:H,coordinateOrigin:W},weight:k}),u.run({parameters:{viewport:[0,0,o,o]},clearColor:[0,0,0,0]}),this._updateMaxWeightValue()}_debouncedUpdateWeightmap(e=!1){let{updateTimer:r}=this.state,{debounceTimeout:i}=this.props;e?(r=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(r),r=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),i)),this.setState({updateTimer:r})}_worldToCommonBounds(e,r={}){let{useLayerCoordinateSystem:i=!1}=r,[n,o,s,a]=e,{viewport:u}=this.context,{textureSize:p}=this.state,{coordinateSystem:m}=this.props,x=i&&(m===Gr.LNGLAT_OFFSETS||m===Gr.METER_OFFSETS),M=x?u.projectPosition(this.props.coordinateOrigin):[0,0],k=p*elt/u.scale,F,j;return i&&!x?(F=this.projectPosition([n,o,0]),j=this.projectPosition([s,a,0])):(F=u.projectPosition([n,o,0]),j=u.projectPosition([s,a,0])),tEe([F[0]-M[0],F[1]-M[1],j[0]-M[0],j[1]-M[1]],k,k)}_commonToWorldBounds(e){let[r,i,n,o]=e,{viewport:s}=this.context,a=s.unprojectPosition([r,i]),u=s.unprojectPosition([n,o]);return a.slice(0,2).concat(u.slice(0,2))}};Ck.layerName="HeatmapLayer";Ck.defaultProps=rlt;var yz=Ck;var{data:Kmr,getPosition:Qmr,...olt}=yz.defaultProps,mEe={_validate:!0},slt={...olt,...mEe},Pk=class extends ji{static defaultProps=slt;static layerName="GeoArrowHeatmapLayer";renderLayers(){let{data:e}=this.props;if(this.props.getPosition!==void 0){let r=this.props.getPosition;if(r!==void 0&&$r.isPointData(r))return this._renderPointLayer(r);throw new Error("getPosition should pass in an arrow Data of Point type")}else{let r=ss(e,Uo.POINT);if(r!==null&&$r.isPointData(r))return this._renderPointLayer(r)}throw new Error("getPosition not GeoArrow point")}_renderPointLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isPointData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPosition"]);Co(e)&&(e=Xc(e));let s=Ni.getPointChild(e).values,a={...mEe,...n,id:`${this.props.id}-geoarrow-heatmap`,data:{data:r,length:e.length,attributes:{getPosition:{value:s,size:e.type.listSize}}}};for(let[u,p]of Object.entries(i))ao({props:a,propName:u,propInput:p});return new yz(this.getSubLayerProps(a))}};var{data:sgr,getPath:agr,...alt}=up.defaultProps,tte={_pathType:"open",_validate:!0},rte={...alt,...tte},rx=class extends ji{static defaultProps=rte;static layerName="GeoArrowPathLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){let{data:e}=this.props;if(this.props.getPath!==void 0){let r=this.props.getPath;if(r!==void 0&&$r.isLineStringData(r))return this._renderLineStringLayer(r);if(r!==void 0&&$r.isMultiLineStringData(r))return this._renderMultiLineStringLayer(r);throw new Error("getPath should be an arrow Data of LineString or MultiLineString type")}else{let r=ss(e,Uo.LINESTRING);if(r!==null&&$r.isLineStringData(r))return this._renderLineStringLayer(r);let i=ss(e,Uo.MULTILINESTRING);if(i!==null&&$r.isMultiLineStringData(i))return this._renderMultiLineStringLayer(i)}throw new Error("getPath not GeoArrow LineString or MultiLineString")}_renderLineStringLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isLineStringData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPath"]);Co(e)&&(e=ET(e));let o=e.valueOffsets,s=Ni.getLineStringChild(e),a=s.type.listSize,p=Ni.getPointChild(s).values,m={...tte,...n,id:`${this.props.id}-geoarrow-path-linestring`,data:{data:r,length:e.length,startIndices:o,attributes:{getPath:{value:p,size:a}}}};for(let[x,M]of Object.entries(i))ao({props:m,propName:x,propInput:M,geomCoordOffsets:o});return new up(this.getSubLayerProps(m))}_renderMultiLineStringLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isMultiLineStringData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPath"]),o=Ni.getMultiLineStringChild(e);Co(o)&&(o=ET(o));let s=Ni.getLineStringChild(o),a=Ni.getPointChild(s),u=e.valueOffsets,p=o.valueOffsets,m=s.type.listSize,x=a.values,M=$Me(e),k={...tte,...n,id:`${this.props.id}-geoarrow-path-multilinestring`,data:{data:r,invertedGeomOffsets:CT(u),length:o.length,startIndices:p,attributes:{getPath:{value:x,size:m}}}};for(let[F,j]of Object.entries(i))ao({props:k,propName:F,propInput:j,geomCoordOffsets:M});return new up(this.getSubLayerProps(k))}};var{data:mgr,getPosition:ggr,...llt}=GF.defaultProps,gEe={_validate:!0},clt={...llt,...gEe},Ik=class extends ji{static defaultProps=clt;static layerName="GeoArrowPointCloudLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){let{data:e}=this.props;if(this.props.getPosition!==void 0){let r=this.props.getPosition;if(r!==void 0&&$r.isPointData(r))return this._renderPointLayer(r);throw new Error("getPosition should pass in an arrow Data of Point type")}else{let r=ss(e,Uo.POINT);if(r!==null&&$r.isPointData(r))return this._renderPointLayer(r)}throw new Error("getPosition not GeoArrow point")}_renderPointLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isPointData(e),"The geometry column is not a valid PointVector."),Pr(e.type.listSize===3,"Points of a PointCloudLayer in the geometry column must be three-dimensional."),co(this.props,r));let[i,n]=lo(this.props,["getPosition"]);Co(e)&&(e=Xc(e));let s=Ni.getPointChild(e).values,a={...gEe,...n,id:`${this.props.id}-geoarrow-pointcloud`,data:{data:r,length:e.length,attributes:{getPosition:{value:s,size:e.type.listSize}}}};for(let[u,p]of Object.entries(i))ao({props:a,propName:u,propInput:p});return new GF(this.getSubLayerProps(a))}};var eA=Tt(SCe(),1),oAr=eA.default.registerSerializer,Lz=eA.default.spawn,Bz=eA.default.BlobWorker,sAr=eA.default.DefaultSerializer,Fz=eA.default.Pool,aAr=eA.default.Thread,Ite=eA.default.Transfer,lAr=eA.default.Worker;var{data:AAr,getPolygon:yAr,...qut}=qg.defaultProps,kte={_normalize:!1,_windingOrder:"CCW",_validate:!0,metrics:!1,earcutWorkerUrl:"https://cdn.jsdelivr.net/npm/@geoarrow/geoarrow-js@0.3.0/dist/earcut-worker.min.js",earcutWorkerPoolSize:1},Yut={...qut,...kte},ax=class extends ji{static defaultProps=Yut;static layerName="GeoArrowSolidPolygonLayer";initializeState(e){this.state={batch:null,triangles:null,earcutWorkerRequest:this.props.earcutWorkerUrl===null||this.props.earcutWorkerUrl===void 0?null:fetch(this.props.earcutWorkerUrl).then(r=>r.text()),earcutWorkerPool:this.props.earcutWorkerPool||null}}async initEarcutPool(){if(this.state.earcutWorkerPool)return this.state.earcutWorkerPool;let e=await this.state.earcutWorkerRequest;if(!e||window?.location?.href.startsWith("file://"))return null;try{let r=Fz(()=>Lz(Bz.fromText(e)),this.props.earcutWorkerPoolSize||1);return this.state.earcutWorkerPool=r,this.state.earcutWorkerPool}catch{return null}}async finalizeState(e){await this.state?.earcutWorkerPool?.terminate(),console.log("terminated")}async updateData(){let{data:e}=this.props,r=await this._updateEarcut(e);this.setState({batch:this.props.data,triangles:r})}async _updateEarcut(e){let r=ss(e,Uo.POLYGON);if(r!==null&&$r.isPolygonData(r))return this._earcutPolygonData(r);let i=ss(e,Uo.MULTIPOLYGON);if(i!==null&&$r.isMultiPolygonData(i))return this._earcutMultiPolygonData(i);let n=this.props.getPolygon;if(n!==void 0&&$r.isPolygonData(n))return this._earcutPolygonData(n);if(n!==void 0&&$r.isMultiPolygonData(n))return this._earcutMultiPolygonData(n);throw new Error("geometryColumn not Polygon or MultiPolygon")}async _earcutPolygonData(e){let r=await this.initEarcutPool();if(!r)return this._earcutPolygonVectorMainThread(e);let i=null,n=(Date.now()+Math.floor(Math.random()*1e3)).toString();this.props.metrics&&console.time(n),Co(e)&&(e=tx(e));let[o,s]=Kee.preparePostMessage(e,!0);return r.queue(async a=>{i=await a(Ite(o,s))}),await r.completed(),this.props.metrics&&console.timeEnd(n),Pr(i!==null),i}_earcutPolygonVectorMainThread(e){return Co(e)&&(e=tx(e)),Xee.earcut(e)}async _earcutMultiPolygonData(e){let r=await this.initEarcutPool();if(!r)return this._earcutMultiPolygonVectorMainThread(e);let i=null,n=(Date.now()+Math.floor(Math.random()*1e3)).toString();this.props.metrics&&console.time(n);let o=Ni.getMultiPolygonChild(e);Co(o)&&(o=tx(o));let[s,a]=Kee.preparePostMessage(o,!0);return r.queue(async u=>{i=await u(Ite(s,a))}),await r.completed(),this.props.metrics&&console.timeEnd(n),Pr(i!==null),i}_earcutMultiPolygonVectorMainThread(e){let r=Ni.getMultiPolygonChild(e);return Co(r)&&(r=tx(r)),Xee.earcut(r)}updateState({props:e,changeFlags:r}){r.dataChanged&&this.updateData()}getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){let{batch:e}=this.state;if(!e)return null;if(this.props.getPolygon!==void 0){let r=this.props.getPolygon;if(r!==void 0&&$r.isPolygonData(r))return this._renderPolygonLayer(r);if(r!==void 0&&$r.isMultiPolygonData(r))return this._renderMultiPolygonLayer(r);throw new Error("getPolygon should be an arrow Data of Polygon or MultiPolygon type")}else{let r=ss(e,Uo.POLYGON);if(r!==null&&$r.isPolygonData(r))return this._renderPolygonLayer(r);let i=ss(e,Uo.MULTIPOLYGON);if(i!==null&&$r.isMultiPolygonData(i))return this._renderMultiPolygonLayer(i)}throw new Error("getPolygon not GeoArrow Polygon or MultiPolygon")}_renderPolygonLayer(e){let{batch:r}=this.state;if(!r)return null;this.props._validate&&(Pr($r.isPolygonData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPolygon"]);Co(e)&&(e=tx(e));let o=Ni.getPolygonChild(e),s=Ni.getLineStringChild(o),a=Ni.getPointChild(s),u=s.type.listSize,p=a.values,m=Qee(e);if(!this.state.triangles)return null;let x=this.state.triangles,M={...kte,...n,id:`${this.props.id}-geoarrow-solid-polygon`,data:{data:r,length:e.length,startIndices:m,attributes:{getPolygon:{value:p,size:u},indices:{value:x,size:1}}}};for(let[k,F]of Object.entries(i))ao({props:M,propName:k,propInput:F,geomCoordOffsets:m});return new qg(this.getSubLayerProps(M))}_renderMultiPolygonLayer(e){let{batch:r}=this.state;if(!r)return null;this.props._validate&&(Pr($r.isMultiPolygonData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPolygon"]),o=Ni.getMultiPolygonChild(e);Co(o)&&(o=tx(o));let s=Ni.getPolygonChild(o),a=Ni.getLineStringChild(s),u=Ni.getPointChild(a),p=a.type.listSize,m=e.valueOffsets,x=u.values;if(!this.state.triangles)return null;let M=this.state.triangles,k=Qee(o),F=WMe(e),j={...kte,...n,id:`${this.props.id}-geoarrow-solid-polygon-multi`,data:{data:r,invertedGeomOffsets:CT(m),length:o.length,startIndices:k,attributes:{getPolygon:{value:x,size:p},indices:{value:M,size:1}}}};for(let[W,Z]of Object.entries(i))ao({props:j,propName:W,propInput:Z,geomCoordOffsets:F});let H=this.getSubLayerProps(j);return new qg(H)}};function TCe(t){return"data"in t?new Or(t.data.map(e=>TCe(e))):t}function MCe(t){if("data"in t)return new Or(t.data.map(s=>MCe(s)));let e=t.valueOffsets,r=Ni.getMultiPolygonChild(t),i=r.valueOffsets,n=Ni.getPolygonChild(r),o=new Int32Array(e.length);for(let s=0;s<o.length;++s)o[s]=i[e[s]];return Dr({type:new Za(r.type.children[0]),length:t.length,nullCount:t.nullCount,nullBitmap:t.nullBitmap,child:n,valueOffsets:o})}var{data:MAr,getPolygon:EAr,...Xut}=hp.defaultProps,Zut={_normalize:!1,_windingOrder:"CCW",_validate:!0},Kut={...Xut,...Zut},Qut=[0,0,0,255];var Gk=class extends ji{static defaultProps=Kut;static layerName="GeoArrowPolygonLayer";getPickingInfo(e){return e.info}renderLayers(){let{data:e}=this.props;if(this.props.getPolygon!==void 0){let r=this.props.getPolygon;if($r.isPolygonData(r))return this._renderLayers(r);if($r.isMultiPolygonData(r))return this._renderLayers(r);throw new Error("getPolygon should be an arrow Data of Polygon or MultiPolygon type")}else{let r=ss(e,Uo.POLYGON);if(r!==null&&$r.isPolygonData(r))return this._renderLayers(r);let i=ss(e,Uo.MULTIPOLYGON);if(i!==null&&$r.isMultiPolygonData(i))return this._renderLayers(i)}throw new Error("geometryColumn not Polygon or MultiPolygon")}_renderLayers(e){let{data:r}=this.props,i;$r.isPolygonData(e)?i=TCe(e):$r.isMultiPolygonData(e)?i=MCe(e):Pr(!1);let{data:n,_dataDiff:o,stroked:s,filled:a,extruded:u,wireframe:p,_normalize:m,_windingOrder:x,elevationScale:M,transitions:k,positionFormat:F}=this.props,{lineWidthUnits:j,lineWidthScale:H,lineWidthMinPixels:W,lineWidthMaxPixels:Z,lineJointRounded:Y,lineMiterLimit:ee,lineDashJustified:ce}=this.props,{getFillColor:ge,getLineColor:Se,getLineWidth:ne,getElevation:pe,getPolygon:ue,updateTriggers:Le,material:We,earcutWorkerPool:ze,earcutWorkerPoolSize:rt,earcutWorkerUrl:at}=this.props,Wt=this.getSubLayerClass("fill",ax),It=this.getSubLayerClass("stroke",rx),Bt=new Wt({extruded:u,elevationScale:M,filled:a,wireframe:p,_normalize:m,_windingOrder:x,getElevation:pe,getFillColor:ge,getLineColor:u&&p?Se:Qut,material:We,transitions:k,earcutWorkerPool:ze,earcutWorkerPoolSize:rt,earcutWorkerUrl:at},this.getSubLayerProps({id:"fill",updateTriggers:Le&&{getPolygon:Le.getPolygon,getElevation:Le.getElevation,getFillColor:Le.getFillColor,getLineColor:Le.getLineColor}}),{data:n,positionFormat:F,getPolygon:ue}),Qt=!u&&s&&new It({widthUnits:j,widthScale:H,widthMinPixels:W,widthMaxPixels:Z,jointRounded:Y,miterLimit:ee,dashJustified:ce,_pathType:"loop",transitions:k&&{getWidth:k.getLineWidth,getColor:k.getLineColor,getPath:k.getPolygon},getColor:this.getSubLayerAccessor(Se),getWidth:this.getSubLayerAccessor(ne)},this.getSubLayerProps({id:"stroke",updateTriggers:Le&&{getWidth:Le.getLineWidth,getColor:Le.getLineColor,getDashArray:Le.getLineDashArray}}),{data:r,positionFormat:F,getPath:i,pickable:!1});return[!u&&Bt,Qt,u&&Bt]}};var{data:DAr,getS2Token:LAr,...Jut}=RN.defaultProps,ECe={_validate:!0},eht={...Jut,...ECe},Hk=class extends ji{static defaultProps=eht;static layerName="GeoArrowS2Layer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){return this._renderLayer()}_renderLayer(){let{data:e,getS2Token:r}=this.props;this.props._validate&&co(this.props,e);let[i,n]=lo(this.props,["getS2Token"]),o=new Or([r]),s={...ECe,...n,id:`${this.props.id}-geoarrow-S2`,data:{data:e,length:e.numRows},getS2Token:(a,u)=>{let p=o.get(u.index);return typeof p=="string"?p:p.toString(16)}};for(let[a,u]of Object.entries(i))ao({props:s,propName:a,propInput:u});return new RN(this.getSubLayerProps(s))}};var{data:$Ar,getPosition:WAr,...tht}=Wb.defaultProps,Rte={_validate:!0},rht={...tht,...Rte},qk=class extends ji{static defaultProps=rht;static layerName="GeoArrowScatterplotLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){let{data:e}=this.props;if(this.props.getPosition!==void 0){let r=this.props.getPosition;if(r!==void 0&&$r.isPointData(r))return this._renderPointLayer(r);if(r!==void 0&&$r.isMultiPointData(r))return this._renderMultiPointLayer(r);throw new Error("getPosition should pass in an arrow Data of Point or MultiPoint type")}else{let r=ss(e,Uo.POINT);if(r!==null&&$r.isPointData(r))return this._renderPointLayer(r);let i=ss(e,Uo.MULTIPOINT);if(i!==null&&$r.isMultiPointData(i))return this._renderMultiPointLayer(i)}throw new Error("getPosition not GeoArrow point or multipoint")}_renderPointLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isPointData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPosition"]);Co(e)&&(e=Xc(e));let s=Ni.getPointChild(e).values,a={...Rte,...n,id:`${this.props.id}-geoarrow-scatterplot-point`,data:{data:r,length:e.length,attributes:{getPosition:{value:s,size:e.type.listSize}}}};for(let[u,p]of Object.entries(i))ao({props:a,propName:u,propInput:p});return new Wb(this.getSubLayerProps(a))}_renderMultiPointLayer(e){let{data:r}=this.props;this.props._validate&&(Pr($r.isMultiPointData(e)),co(this.props,r));let[i,n]=lo(this.props,["getPosition"]),o=Ni.getMultiPointChild(e);Co(o)&&(o=Xc(o));let s=e.valueOffsets,u=Ni.getPointChild(o).values,p={...Rte,...n,id:`${this.props.id}-geoarrow-scatterplot-multipoint`,data:{data:r,invertedGeomOffsets:CT(s),length:o.length,attributes:{getPosition:{value:u,size:o.type.listSize}}}};for(let[m,x]of Object.entries(i))ao({props:p,propName:m,propInput:x,geomCoordOffsets:s});return new Wb(this.getSubLayerProps(p))}};var{data:QAr,getPosition:JAr,getText:eyr,getTextAnchor:tyr,getAlignmentBaseline:ryr,getPixelOffset:iyr,...iht}=JS.defaultProps,CCe={getTextAnchor:"middle",getAlignmentBaseline:"center",getPixelOffset:[0,0],_validate:!0},nht={...iht,...CCe},Yk=class extends ji{static defaultProps=nht;static layerName="GeoArrowTextLayer";getPickingInfo(e){return Vs(e,this.props.data)}renderLayers(){let{data:e}=this.props;if(this.props.getPosition!==void 0){let r=this.props.getPosition;if(r!==void 0&&$r.isPointData(r))return this._renderTextLayer(r,this.props.getText);throw new Error("getPosition should pass in an arrow Data of Point type")}else{let r=ss(e,Uo.POINT);if(r!==null&&$r.isPointData(r))return this._renderTextLayer(r,this.props.getText)}throw new Error("getPosition not GeoArrow point")}_renderTextLayer(e,r){let{data:i}=this.props;this.props._validate&&(Pr($r.isPointData(e)),co(this.props,i));let[n,o]=lo(this.props,["getPosition","getText"]);Co(e)&&(e=Xc(e));let a=Ni.getPointChild(e).values,u=r.values,p=r.valueOffsets,m={...CCe,...o,id:`${this.props.id}-geoarrow-text`,data:{data:i,length:e.length,startIndices:p,attributes:{getPosition:{value:fz(a,e.type.listSize,p),size:e.type.listSize},getText:{value:u}}}};for(let[x,M]of Object.entries(n))ao({props:m,propName:x,propInput:M,geomCoordOffsets:p});return new JS(this.getSubLayerProps(m))}};var{data:hyr,getPath:dyr,...oht}=rte,PCe={_pathType:"open",_validate:!0},sht={...oht,...PCe},Xk=class extends ji{static defaultProps=sht;static layerName="GeoArrowTripsLayer";renderLayers(){let{data:e,getTimestamps:r}=this.props;if(this.props.getPath!==void 0){let i=this.props.getPath;if(i!==void 0&&$r.isLineStringData(i))return this._renderLineStringLayer(i,r);throw new Error("getPath should be an arrow Data of LineString type")}else{let i=ss(e,Uo.LINESTRING);if(i!==null&&$r.isLineStringData(i))return this._renderLineStringLayer(i,r)}throw new Error("getPath not GeoArrow LineString")}_renderLineStringLayer(e,r){let{data:i}=this.props;this.props._validate&&(Pr($r.isLineStringData(e)),co(this.props,i));let[n,o]=lo(this.props,["getPath","getTimestamps"]);Co(e)&&(e=ET(e));let s=e.valueOffsets,a=Ni.getLineStringChild(e),u=a.type.listSize,m=Ni.getPointChild(a).values,x=r.children[0].values,M={...PCe,...o,id:`${this.props.id}-geoarrow-trip`,data:{data:i,length:e.length,startIndices:s,attributes:{getPath:{value:m,size:u},getTimestamps:{value:x,size:1}}}};for(let[k,F]of Object.entries(n))ao({props:M,propName:k,propInput:F,geomCoordOffsets:s});return new Tee(M)}};function as(t,e){return Array.isArray(t)?t:t.data[e]}function ls(t,e){return typeof t=="number"?t:t.data[e]}var zT=class extends sa{static layerType="arc";greatCircle;numSegments;widthUnits;widthScale;widthMinPixels;widthMaxPixels;getSourcePosition;getTargetPosition;getSourceColor;getTargetColor;getWidth;getHeight;getTilt;constructor(e,r){super(e,r),this.initRegularAttribute("great_circle","greatCircle"),this.initRegularAttribute("num_segments","numSegments"),this.initRegularAttribute("width_units","widthUnits"),this.initRegularAttribute("width_scale","widthScale"),this.initRegularAttribute("width_min_pixels","widthMinPixels"),this.initRegularAttribute("width_max_pixels","widthMaxPixels"),this.initVectorizedAccessor("get_source_position","getSourcePosition"),this.initVectorizedAccessor("get_target_position","getTargetPosition"),this.initVectorizedAccessor("get_source_color","getSourceColor"),this.initVectorizedAccessor("get_target_color","getTargetColor"),this.initVectorizedAccessor("get_width","getWidth"),this.initVectorizedAccessor("get_height","getHeight"),this.initVectorizedAccessor("get_tilt","getTilt")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],getSourcePosition:this.getSourcePosition.data[e],getTargetPosition:this.getTargetPosition.data[e],...Ze(this.greatCircle)&&{greatCircle:this.greatCircle},...Ze(this.numSegments)&&{numSegments:this.numSegments},...Ze(this.widthUnits)&&{widthUnits:this.widthUnits},...Ze(this.widthScale)&&{widthScale:this.widthScale},...Ze(this.widthMinPixels)&&{widthMinPixels:this.widthMinPixels},...Ze(this.widthMaxPixels)&&{widthMaxPixels:this.widthMaxPixels},...Ze(this.getSourceColor)&&{getSourceColor:as(this.getSourceColor,e)},...Ze(this.getTargetColor)&&{getTargetColor:as(this.getTargetColor,e)},...Ze(this.getWidth)&&{getWidth:ls(this.getWidth,e)},...Ze(this.getHeight)&&{getHeight:ls(this.getHeight,e)},...Ze(this.getTilt)&&{getTilt:ls(this.getTilt,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Sk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var UT=class extends Hg{static layerType="bitmap";image;bounds;desaturate;transparentColor;tintColor;constructor(e,r){super(e,r),this.initRegularAttribute("image","image"),this.initRegularAttribute("bounds","bounds"),this.initRegularAttribute("desaturate","desaturate"),this.initRegularAttribute("transparent_color","transparentColor"),this.initRegularAttribute("tint_color","tintColor")}layerProps(){return{id:this.model.model_id,...Ze(this.image)&&{image:this.image},...Ze(this.bounds)&&{bounds:this.bounds},...Ze(this.desaturate)&&{desaturate:this.desaturate},...Ze(this.transparentColor)&&{transparentColor:this.transparentColor},...Ze(this.tintColor)&&{tintColor:this.tintColor}}}render(){return new $F({...this.baseLayerProps(),...this.layerProps(),data:void 0,pickable:!1})}},VT=class extends Hg{static layerType="bitmap-tile";data;tileSize;zoomOffset;maxZoom;minZoom;extent;maxCacheSize;maxCacheByteSize;refinementStrategy;maxRequests;desaturate;transparentColor;tintColor;constructor(e,r){super(e,r),this.initRegularAttribute("data","data"),this.initRegularAttribute("tile_size","tileSize"),this.initRegularAttribute("zoom_offset","zoomOffset"),this.initRegularAttribute("max_zoom","maxZoom"),this.initRegularAttribute("min_zoom","minZoom"),this.initRegularAttribute("extent","extent"),this.initRegularAttribute("max_cache_size","maxCacheSize"),this.initRegularAttribute("max_cache_byte_size","maxCacheByteSize"),this.initRegularAttribute("refinement_strategy","refinementStrategy"),this.initRegularAttribute("max_requests","maxRequests"),this.initRegularAttribute("desaturate","desaturate"),this.initRegularAttribute("transparent_color","transparentColor"),this.initRegularAttribute("tint_color","tintColor")}bitmapLayerProps(){return{id:this.model.model_id,...Ze(this.desaturate)&&{desaturate:this.desaturate},...Ze(this.transparentColor)&&{transparentColor:this.transparentColor},...Ze(this.tintColor)&&{tintColor:this.tintColor}}}layerProps(){return{id:this.model.model_id,data:this.data,...Ze(this.tileSize)&&{tileSize:this.tileSize},...Ze(this.zoomOffset)&&{zoomOffset:this.zoomOffset},...Ze(this.maxZoom)&&{maxZoom:this.maxZoom},...Ze(this.minZoom)&&{minZoom:this.minZoom},...Ze(this.extent)&&{extent:this.extent},...Ze(this.maxCacheSize)&&{maxCacheSize:this.maxCacheSize},...Ze(this.maxCacheByteSize)&&{maxCacheByteSize:this.maxCacheByteSize},...Ze(this.refinementStrategy)&&{refinementStrategy:this.refinementStrategy},...Ze(this.maxRequests)&&{maxRequests:this.maxRequests}}}render(){return[new See({...this.baseLayerProps(),...this.layerProps(),renderSubLayers:r=>{let[i,n]=r.tile.boundingBox;return new $F(r,{...this.bitmapLayerProps(),data:void 0,image:r.data,bounds:[i[0],i[1],n[0],n[1]]})}})]}};var jT=class extends sa{static layerType="column";diskResolution;radius;angle;offset;coverage;elevationScale;filled;stroked;extruded;wireframe;flatShading;radiusUnits;lineWidthUnits;lineWidthScale;lineWidthMinPixels;lineWidthMaxPixels;getPosition;getFillColor;getLineColor;getElevation;getLineWidth;constructor(e,r){super(e,r),this.initRegularAttribute("disk_resolution","diskResolution"),this.initRegularAttribute("radius","radius"),this.initRegularAttribute("angle","angle"),this.initRegularAttribute("offset","offset"),this.initRegularAttribute("coverage","coverage"),this.initRegularAttribute("elevation_scale","elevationScale"),this.initRegularAttribute("filled","filled"),this.initRegularAttribute("stroked","stroked"),this.initRegularAttribute("extruded","extruded"),this.initRegularAttribute("wireframe","wireframe"),this.initRegularAttribute("flat_shading","flatShading"),this.initRegularAttribute("radius_units","radiusUnits"),this.initRegularAttribute("line_width_units","lineWidthUnits"),this.initRegularAttribute("line_width_scale","lineWidthScale"),this.initRegularAttribute("line_width_min_pixels","lineWidthMinPixels"),this.initRegularAttribute("line_width_max_pixels","lineWidthMaxPixels"),this.initVectorizedAccessor("get_position","getPosition"),this.initVectorizedAccessor("get_fill_color","getFillColor"),this.initVectorizedAccessor("get_line_color","getLineColor"),this.initVectorizedAccessor("get_elevation","getElevation"),this.initVectorizedAccessor("get_line_width","getLineWidth")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],...Ze(this.diskResolution)&&{diskResolution:this.diskResolution},...Ze(this.radius)&&{radius:this.radius},...Ze(this.angle)&&{angle:this.angle},...Ze(this.offset)&&{offset:this.offset},...Ze(this.coverage)&&{coverage:this.coverage},...Ze(this.elevationScale)&&{elevationScale:this.elevationScale},...Ze(this.filled)&&{filled:this.filled},...Ze(this.stroked)&&{stroked:this.stroked},...Ze(this.extruded)&&{extruded:this.extruded},...Ze(this.wireframe)&&{wireframe:this.wireframe},...Ze(this.flatShading)&&{flatShading:this.flatShading},...Ze(this.radiusUnits)&&{radiusUnits:this.radiusUnits},...Ze(this.lineWidthUnits)&&{lineWidthUnits:this.lineWidthUnits},...Ze(this.lineWidthScale)&&{lineWidthScale:this.lineWidthScale},...Ze(this.lineWidthMinPixels)&&{lineWidthMinPixels:this.lineWidthMinPixels},...Ze(this.lineWidthMaxPixels)&&{lineWidthMaxPixels:this.lineWidthMaxPixels},...Ze(this.getPosition)&&{getPosition:this.getPosition.data[e]},...Ze(this.getFillColor)&&{getFillColor:as(this.getFillColor,e)},...Ze(this.getLineColor)&&{getLineColor:as(this.getLineColor,e)},...Ze(this.getElevation)&&{getElevation:ls(this.getElevation,e)},...Ze(this.getLineWidth)&&{getLineWidth:ls(this.getLineWidth,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Tk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var $T=class extends sa{static layerType="heatmap";radiusPixels;colorRange;intensity;threshold;colorDomain;aggregation;weightsTextureSize;debounceTimeout;getPosition;getWeight;constructor(e,r){super(e,r),this.initRegularAttribute("radius_pixels","radiusPixels"),this.initRegularAttribute("color_range","colorRange"),this.initRegularAttribute("intensity","intensity"),this.initRegularAttribute("threshold","threshold"),this.initRegularAttribute("color_domain","colorDomain"),this.initRegularAttribute("aggregation","aggregation"),this.initRegularAttribute("weights_texture_size","weightsTextureSize"),this.initRegularAttribute("debounce_timeout","debounceTimeout"),this.initVectorizedAccessor("get_position","getPosition"),this.initVectorizedAccessor("get_weight","getWeight")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],...Ze(this.radiusPixels)&&{radiusPixels:this.radiusPixels},...Ze(this.colorRange)&&{colorRange:this.colorRange},...Ze(this.intensity)&&{intensity:this.intensity},...Ze(this.threshold)&&{threshold:this.threshold},...Ze(this.colorDomain)&&{colorDomain:this.colorDomain},...Ze(this.aggregation)&&{aggregation:this.aggregation},...Ze(this.weightsTextureSize)&&{weightsTextureSize:this.weightsTextureSize},...Ze(this.debounceTimeout)&&{debounceTimeout:this.debounceTimeout},...Ze(this.getPosition)&&{getPosition:this.getPosition.data[e]},...Ze(this.getWeight)&&{getWeight:ls(this.getWeight,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Pk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var WT=class extends sa{static layerType="path";widthUnits;widthScale;widthMinPixels;widthMaxPixels;jointRounded;capRounded;miterLimit;billboard;getColor;getWidth;constructor(e,r){super(e,r),this.initRegularAttribute("width_units","widthUnits"),this.initRegularAttribute("width_scale","widthScale"),this.initRegularAttribute("width_min_pixels","widthMinPixels"),this.initRegularAttribute("width_max_pixels","widthMaxPixels"),this.initRegularAttribute("joint_rounded","jointRounded"),this.initRegularAttribute("cap_rounded","capRounded"),this.initRegularAttribute("miter_limit","miterLimit"),this.initRegularAttribute("billboard","billboard"),this.initVectorizedAccessor("get_color","getColor"),this.initVectorizedAccessor("get_width","getWidth")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],...Ze(this.widthUnits)&&{widthUnits:this.widthUnits},...Ze(this.widthScale)&&{widthScale:this.widthScale},...Ze(this.widthMinPixels)&&{widthMinPixels:this.widthMinPixels},...Ze(this.widthMaxPixels)&&{widthMaxPixels:this.widthMaxPixels},...Ze(this.jointRounded)&&{jointRounded:this.jointRounded},...Ze(this.capRounded)&&{capRounded:this.capRounded},...Ze(this.miterLimit)&&{miterLimit:this.miterLimit},...Ze(this.billboard)&&{billboard:this.billboard},...Ze(this.getColor)&&{getColor:as(this.getColor,e)},...Ze(this.getWidth)&&{getWidth:ls(this.getWidth,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new rx({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var GT=class extends sa{static layerType="point-cloud";sizeUnits;pointSize;getColor;getNormal;constructor(e,r){super(e,r),this.initRegularAttribute("size_units","sizeUnits"),this.initRegularAttribute("point_size","pointSize"),this.initVectorizedAccessor("get_color","getColor"),this.initVectorizedAccessor("get_normal","getNormal")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],...Ze(this.sizeUnits)&&{sizeUnits:this.sizeUnits},...Ze(this.pointSize)&&{pointSize:this.pointSize},...Ze(this.getColor)&&{getColor:as(this.getColor,e)},...Ze(this.getNormal)&&{getNormal:this.getNormal.data[e]}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Ik({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var ICe='var Ie=Object.create;var ie=Object.defineProperty;var Ae=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var We=Object.getPrototypeOf,Ze=Object.prototype.hasOwnProperty;var z=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Oe=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ve(t))!Ze.call(e,o)&&o!==n&&ie(e,o,{get:()=>t[o],enumerable:!(r=Ae(t,o))||r.enumerable});return e};var Be=(e,t,n)=>(n=e!=null?Ie(We(e)):{},Oe(t||!e||!e.__esModule?ie(n,"default",{value:e,enumerable:!0}):n,e));var le=z((At,se)=>{"use strict";se.exports=e=>e?typeof Symbol.observable=="symbol"&&typeof e[Symbol.observable]=="function"?e===e[Symbol.observable]():typeof e["@@observable"]=="function"?e===e["@@observable"]():!1:!1});var ce=z(E=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});E.DefaultSerializer=E.extendSerializer=void 0;function $e(e,t){let n=e.deserialize.bind(e),r=e.serialize.bind(e);return{deserialize(o){return t.deserialize(o,n)},serialize(o){return t.serialize(o,r)}}}E.extendSerializer=$e;var ue={deserialize(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},je=e=>e&&typeof e=="object"&&"__error_marker"in e&&e.__error_marker==="$$error";E.DefaultSerializer={deserialize(e){return je(e)?ue.deserialize(e):e},serialize(e){return e instanceof Error?ue.serialize(e):e}}});var J=z(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.serialize=D.deserialize=D.registerSerializer=void 0;var fe=ce(),$=fe.DefaultSerializer;function Fe(e){$=fe.extendSerializer($,e)}D.registerSerializer=Fe;function Re(e){return $.deserialize(e)}D.deserialize=Re;function He(e){return $.serialize(e)}D.serialize=He});var ae=z(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.$worker=S.$transferable=S.$terminate=S.$events=S.$errors=void 0;S.$errors=Symbol("thread.errors");S.$events=Symbol("thread.events");S.$terminate=Symbol("thread.terminate");S.$transferable=Symbol("thread.transferable");S.$worker=Symbol("thread.worker")});var K=z(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.Transfer=k.isTransferDescriptor=void 0;var ge=ae();function Ge(e){return!(!e||typeof e!="object")}function Ne(e){return e&&typeof e=="object"&&e[ge.$transferable]}k.isTransferDescriptor=Ne;function Je(e,t){if(!t){if(!Ge(e))throw Error();t=[e]}return{[ge.$transferable]:!0,send:e,transferables:t}}k.Transfer=Je});var ye=z(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.WorkerMessageType=w.MasterMessageType=void 0;var Ke;(function(e){e.cancel="cancel",e.run="run"})(Ke=w.MasterMessageType||(w.MasterMessageType={}));var Ue;(function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"})(Ue=w.WorkerMessageType||(w.WorkerMessageType={}))});var pe=z(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});var qe=function(){let t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)},Qe=function(t,n){self.postMessage(t,n)},Xe=function(t){let n=o=>{t(o.data)},r=()=>{self.removeEventListener("message",n)};return self.addEventListener("message",n),r};U.default={isWorkerRuntime:qe,postMessageToMaster:Qe,subscribeToMasterMessages:Xe}});var ve=z(M=>{"use strict";var Ye=M&&M.__awaiter||function(e,t,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(f){try{u(r.next(f))}catch(a){i(a)}}function c(f){try{u(r.throw(f))}catch(a){i(a)}}function u(f){f.done?s(f.value):o(f.value).then(l,c)}u((r=r.apply(e,t||[])).next())})},Pe=M&&M.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(M,"__esModule",{value:!0});M.expose=M.isWorkerRuntime=M.Transfer=M.registerSerializer=void 0;var et=Pe(le()),C=J(),tt=K(),L=ye(),v=Pe(pe()),nt=J();Object.defineProperty(M,"registerSerializer",{enumerable:!0,get:function(){return nt.registerSerializer}});var rt=K();Object.defineProperty(M,"Transfer",{enumerable:!0,get:function(){return rt.Transfer}});M.isWorkerRuntime=v.default.isWorkerRuntime;var de=!1,A=new Map,ot=e=>e&&e.type===L.MasterMessageType.cancel,xe=e=>e&&e.type===L.MasterMessageType.run,he=e=>et.default(e)||it(e);function it(e){return e&&typeof e=="object"&&typeof e.subscribe=="function"}function Me(e){return tt.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function st(){let e={type:L.WorkerMessageType.init,exposed:{type:"function"}};v.default.postMessageToMaster(e)}function lt(e){let t={type:L.WorkerMessageType.init,exposed:{type:"module",methods:e}};v.default.postMessageToMaster(t)}function q(e,t){let{payload:n,transferables:r}=Me(t),o={type:L.WorkerMessageType.error,uid:e,error:C.serialize(n)};v.default.postMessageToMaster(o,r)}function Q(e,t,n){let{payload:r,transferables:o}=Me(n),s={type:L.WorkerMessageType.result,uid:e,complete:t?!0:void 0,payload:r};v.default.postMessageToMaster(s,o)}function ut(e,t){let n={type:L.WorkerMessageType.running,uid:e,resultType:t};v.default.postMessageToMaster(n)}function j(e){try{let t={type:L.WorkerMessageType.uncaughtError,error:C.serialize(e)};v.default.postMessageToMaster(t)}catch(t){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:`,t,`\nOriginal error:`,e)}}function me(e,t,n){return Ye(this,void 0,void 0,function*(){let r;try{r=t(...n)}catch(s){return q(e,s)}let o=he(r)?"observable":"promise";if(ut(e,o),he(r)){let s=r.subscribe(i=>Q(e,!1,C.serialize(i)),i=>{q(e,C.serialize(i)),A.delete(e)},()=>{Q(e,!0),A.delete(e)});A.set(e,s)}else try{let s=yield r;Q(e,!0,C.serialize(s))}catch(s){q(e,C.serialize(s))}})}function ct(e){if(!v.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(de)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(de=!0,typeof e=="function")v.default.subscribeToMasterMessages(t=>{xe(t)&&!t.method&&me(t.uid,e,t.args.map(C.deserialize))}),st();else if(typeof e=="object"&&e){v.default.subscribeToMasterMessages(n=>{xe(n)&&n.method&&me(n.uid,e[n.method],n.args.map(C.deserialize))});let t=Object.keys(e).filter(n=>typeof e[n]=="function");lt(t)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);v.default.subscribeToMasterMessages(t=>{if(ot(t)){let n=t.uid,r=A.get(n);r&&(r.unsubscribe(),A.delete(n))}})}M.expose=ct;typeof self<"u"&&typeof self.addEventListener=="function"&&v.default.isWorkerRuntime()&&(self.addEventListener("error",e=>{setTimeout(()=>j(e.error||e),250)}),self.addEventListener("unhandledrejection",e=>{let t=e.reason;t&&typeof t.message=="string"&&setTimeout(()=>j(t),250)}));typeof process<"u"&&typeof process.on=="function"&&v.default.isWorkerRuntime()&&(process.on("uncaughtException",e=>{setTimeout(()=>j(e),250)}),process.on("unhandledRejection",e=>{e&&typeof e.message=="string"&&setTimeout(()=>j(e),250)}))});var F=Be(ve(),1),Se=F.default.expose,Ft=F.default.registerSerializer,be=F.default.Transfer;function T(e){"@babel/helpers - typeof";return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(e)}function X(e,t){if(T(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(T(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y(e){var t=X(e,"string");return T(t)=="symbol"?t:String(t)}function b(e,t,n){return t=Y(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V={x:0,y:1,z:2};function R(e,t={}){let{start:n=0,end:r=e.length,plane:o="xy"}=t,s=t.size||2,i=0,l=V[o[0]],c=V[o[1]];for(let u=n,f=r-s;u<r;u+=s)i+=(e[u+l]-e[f+l])*(e[u+c]+e[f+c]),f=u;return i/2}function te(e,t,n=2,r,o="xy"){let s=t&&t.length,i=s?t[0]*n:e.length,l=De(e,0,i,n,!0,r&&r[0],o),c=[];if(!l||l.next===l.prev)return c;let u,f,a,p,m,d,P;if(s&&(l=xt(e,t,l,n,r,o)),e.length>80*n){p=f=e[0],m=a=e[1];for(let h=n;h<i;h+=n)d=e[h],P=e[h+1],d<p&&(p=d),P<m&&(m=P),d>f&&(f=d),P>a&&(a=P);u=Math.max(f-p,a-m),u=u!==0?32767/u:0}return W(l,c,n,p,m,u,0),c}function De(e,t,n,r,o,s,i){let l,c;s===void 0&&(s=R(e,{start:t,end:n,size:r,plane:i}));let u=V[i[0]],f=V[i[1]];if(o===s<0)for(l=t;l<n;l+=r)c=ze(l,e[l+u],e[l+f],c);else for(l=n-r;l>=t;l-=r)c=ze(l,e[l+u],e[l+f],c);return c&&N(c,c.next)&&(O(c),c=c.next),c}function _(e,t){if(!e)return e;t||(t=e);let n=e,r;do if(r=!1,!n.steiner&&(N(n,n.next)||x(n.prev,n,n.next)===0)){if(O(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function W(e,t,n,r,o,s,i){if(!e)return;!i&&s&&vt(e,r,o,s);let l=e,c,u;for(;e.prev!==e.next;){if(c=e.prev,u=e.next,s?yt(e,r,o,s):gt(e)){t.push(c.i/n|0),t.push(e.i/n|0),t.push(u.i/n|0),O(e),e=u.next,l=u.next;continue}if(e=u,e===l){i?i===1?(e=pt(_(e),t,n),W(e,t,n,r,o,s,2)):i===2&&dt(e,t,n,r,o,s):W(_(e),t,n,r,o,s,1);break}}}function gt(e){let t=e.prev,n=e,r=e.next;if(x(t,n,r)>=0)return!1;let o=t.x,s=n.x,i=r.x,l=t.y,c=n.y,u=r.y,f=o<s?o<i?o:i:s<i?s:i,a=l<c?l<u?l:u:c<u?c:u,p=o>s?o>i?o:i:s>i?s:i,m=l>c?l>u?l:u:c>u?c:u,d=r.next;for(;d!==t;){if(d.x>=f&&d.x<=p&&d.y>=a&&d.y<=m&&I(o,l,s,c,i,u,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function yt(e,t,n,r){let o=e.prev,s=e,i=e.next;if(x(o,s,i)>=0)return!1;let l=o.x,c=s.x,u=i.x,f=o.y,a=s.y,p=i.y,m=l<c?l<u?l:u:c<u?c:u,d=f<a?f<p?f:p:a<p?a:p,P=l>c?l>u?l:u:c>u?c:u,h=f>a?f>p?f:p:a>p?a:p,re=ee(m,d,t,n,r),oe=ee(P,h,t,n,r),g=e.prevZ,y=e.nextZ;for(;g&&g.z>=re&&y&&y.z<=oe;){if(g.x>=m&&g.x<=P&&g.y>=d&&g.y<=h&&g!==o&&g!==i&&I(l,f,c,a,u,p,g.x,g.y)&&x(g.prev,g,g.next)>=0||(g=g.prevZ,y.x>=m&&y.x<=P&&y.y>=d&&y.y<=h&&y!==o&&y!==i&&I(l,f,c,a,u,p,y.x,y.y)&&x(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;g&&g.z>=re;){if(g.x>=m&&g.x<=P&&g.y>=d&&g.y<=h&&g!==o&&g!==i&&I(l,f,c,a,u,p,g.x,g.y)&&x(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;y&&y.z<=oe;){if(y.x>=m&&y.x<=P&&y.y>=d&&y.y<=h&&y!==o&&y!==i&&I(l,f,c,a,u,p,y.x,y.y)&&x(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function pt(e,t,n){let r=e;do{let o=r.prev,s=r.next.next;!N(o,s)&&we(o,r,r.next,s)&&Z(o,s)&&Z(s,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(s.i/n|0),O(r),O(r.next),r=e=s),r=r.next}while(r!==e);return _(r)}function dt(e,t,n,r,o,s){let i=e;do{let l=i.next.next;for(;l!==i.prev;){if(i.i!==l.i&&zt(i,l)){let c=Ce(i,l);i=_(i,i.next),c=_(c,c.next),W(i,t,n,r,o,s,0),W(c,t,n,r,o,s,0);return}l=l.next}i=i.next}while(i!==e)}function xt(e,t,n,r,o,s){let i=[],l,c,u,f,a;for(l=0,c=t.length;l<c;l++)u=t[l]*r,f=l<c-1?t[l+1]*r:e.length,a=De(e,u,f,r,!1,o&&o[l+1],s),a===a.next&&(a.steiner=!0),i.push(bt(a));for(i.sort(ht),l=0;l<i.length;l++)n=mt(i[l],n);return n}function ht(e,t){return e.x-t.x}function mt(e,t){let n=Pt(e,t);if(!n)return t;let r=Ce(n,e);return _(r,r.next),_(n,n.next)}function Pt(e,t){let n=t,r=e.x,o=e.y,s=-1/0,i;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){let p=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(p<=r&&p>s&&(s=p,i=n.x<n.next.x?n:n.next,p===r))return i}n=n.next}while(n!==t);if(!i)return null;let l=i,c=i.x,u=i.y,f=1/0,a;n=i;do r>=n.x&&n.x>=c&&r!==n.x&&I(o<u?r:s,o,c,u,o<u?s:r,o,n.x,n.y)&&(a=Math.abs(o-n.y)/(r-n.x),Z(n,e)&&(a<f||a===f&&(n.x>i.x||n.x===i.x&&Mt(i,n)))&&(i=n,f=a)),n=n.next;while(n!==l);return i}function Mt(e,t){return x(e.prev,e,t.prev)<0&&x(t.next,e,e.next)<0}function vt(e,t,n,r){let o=e;do o.z===0&&(o.z=ee(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,St(o)}function St(e){let t,n,r=1,o,s,i,l,c,u;do{for(s=e,e=null,u=null,o=0;s;){for(o++,l=s,i=0,n=0;n<r&&(i++,l=l.nextZ,!!l);n++);for(c=r;i>0||c>0&&l;)i!==0&&(c===0||!l||s.z<=l.z)?(t=s,s=s.nextZ,i--):(t=l,l=l.nextZ,c--),u?u.nextZ=t:e=t,t.prevZ=u,u=t;s=l}u.nextZ=null,r*=2}while(o>1);return e}function ee(e,t,n,r,o){return e=(e-n)*o|0,t=(t-r)*o|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function bt(e){let t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function I(e,t,n,r,o,s,i,l){return(o-i)*(t-l)>=(e-i)*(s-l)&&(e-i)*(r-l)>=(n-i)*(t-l)&&(n-i)*(s-l)>=(o-i)*(r-l)}function zt(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Dt(e,t)&&(Z(e,t)&&Z(t,e)&&wt(e,t)&&(x(e.prev,e,t.prev)||x(e,t.prev,t))||N(e,t)&&x(e.prev,e,e.next)>0&&x(t.prev,t,t.next)>0)}function x(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function N(e,t){return e.x===t.x&&e.y===t.y}function we(e,t,n,r){let o=G(x(e,t,n)),s=G(x(e,t,r)),i=G(x(n,r,e)),l=G(x(n,r,t));return!!(o!==s&&i!==l||o===0&&H(e,n,t)||s===0&&H(e,r,t)||i===0&&H(n,e,r)||l===0&&H(n,t,r))}function H(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function G(e){return e>0?1:e<0?-1:0}function Dt(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&we(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function Z(e,t){return x(e.prev,e,e.next)<0?x(e,t,e.next)>=0&&x(e,e.prev,t)>=0:x(e,t,e.prev)<0||x(e,e.next,t)<0}function wt(e,t){let n=e,r=!1,o=(e.x+t.x)/2,s=(e.y+t.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&o<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function Ce(e,t){let n=new B(e.i,e.x,e.y),r=new B(t.i,t.x,t.y),o=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function ze(e,t,n,r){let o=new B(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function O(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}var B=class{constructor(t,n,r){b(this,"i",void 0),b(this,"x",void 0),b(this,"y",void 0),b(this,"prev",null),b(this,"next",null),b(this,"z",0),b(this,"prevZ",null),b(this,"nextZ",null),b(this,"steiner",!1),this.i=t,this.x=n,this.y=r}};function _e(e){return"data"in e?e.getChildAt(0):e.children[0]}function Ee(e){return"data"in e?e.getChildAt(0):e.children[0]}function ke(e){return"data"in e?e.getChildAt(0):e.children[0]}function ne(e){if("data"in e)return e.data.map(s=>ne(s));let t=[],n=0;for(let s=0;s<e.length;s++){let i=Et(e,s);t.push(i),n+=i.length}let r=new Uint32Array(n),o=0;for(let s of t)for(let i of s)r[o]=i,o+=1;return r}function Et(e,t){let n=e.valueOffsets,r=ke(e),o=r.valueOffsets,s=Ee(r),i=s.type.listSize,l=_e(s),c=n[t],u=n[t+1],f=o[c],a=o[u],p=l.values.subarray(f*i,a*i),m=o[c],d=[];for(let h=c+1;h<u;h++)d.push(o[h]-m);let P=te(p,d,i);for(let h=0;h<P.length;h++)P[h]+=m;return P}function kt(e){let t=ne(e);return be(t,[t.buffer])}Se(kt);\n';var lht=8;function cht(t){return Fz(()=>Lz(Bz.fromText(ICe)),t)}var Ote=cht(lht);var HT=class extends sa{static layerType="solid-polygon";filled;extruded;wireframe;elevationScale;getElevation;getFillColor;getLineColor;constructor(e,r){super(e,r),this.initRegularAttribute("filled","filled"),this.initRegularAttribute("extruded","extruded"),this.initRegularAttribute("wireframe","wireframe"),this.initRegularAttribute("elevation_scale","elevationScale"),this.initVectorizedAccessor("get_elevation","getElevation"),this.initVectorizedAccessor("get_fill_color","getFillColor"),this.initVectorizedAccessor("get_line_color","getLineColor")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],earcutWorkerPool:Ote,...Ze(this.filled)&&{filled:this.filled},...Ze(this.extruded)&&{extruded:this.extruded},...Ze(this.wireframe)&&{wireframe:this.wireframe},...Ze(this.elevationScale)&&{elevationScale:this.elevationScale},...Ze(this.getElevation)&&{getElevation:ls(this.getElevation,e)},...Ze(this.getFillColor)&&{getFillColor:as(this.getFillColor,e)},...Ze(this.getLineColor)&&{getLineColor:as(this.getLineColor,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new ax({...this.baseLayerProps(r),...this.layerProps(r)}));return e}},lx=class extends sa{stroked;filled;extruded;wireframe;elevationScale;lineWidthUnits;lineWidthScale;lineWidthMinPixels;lineWidthMaxPixels;lineJointRounded;lineMiterLimit;getFillColor;getLineColor;getLineWidth;getElevation;constructor(e,r){super(e,r),this.initRegularAttribute("stroked","stroked"),this.initRegularAttribute("filled","filled"),this.initRegularAttribute("extruded","extruded"),this.initRegularAttribute("wireframe","wireframe"),this.initRegularAttribute("elevation_scale","elevationScale"),this.initRegularAttribute("line_width_units","lineWidthUnits"),this.initRegularAttribute("line_width_scale","lineWidthScale"),this.initRegularAttribute("line_width_min_pixels","lineWidthMinPixels"),this.initRegularAttribute("line_width_max_pixels","lineWidthMaxPixels"),this.initRegularAttribute("line_joint_rounded","lineJointRounded"),this.initRegularAttribute("line_miter_limit","lineMiterLimit"),this.initVectorizedAccessor("get_fill_color","getFillColor"),this.initVectorizedAccessor("get_line_color","getLineColor"),this.initVectorizedAccessor("get_line_width","getLineWidth"),this.initVectorizedAccessor("get_elevation","getElevation")}basePolygonLayerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],earcutWorkerPool:Ote,...Ze(this.stroked)&&{stroked:this.stroked},...Ze(this.filled)&&{filled:this.filled},...Ze(this.extruded)&&{extruded:this.extruded},...Ze(this.wireframe)&&{wireframe:this.wireframe},...Ze(this.elevationScale)&&{elevationScale:this.elevationScale},...Ze(this.lineWidthUnits)&&{lineWidthUnits:this.lineWidthUnits},...Ze(this.lineWidthScale)&&{lineWidthScale:this.lineWidthScale},...Ze(this.lineWidthMinPixels)&&{lineWidthMinPixels:this.lineWidthMinPixels},...Ze(this.lineWidthMaxPixels)&&{lineWidthMaxPixels:this.lineWidthMaxPixels},...Ze(this.lineJointRounded)&&{lineJointRounded:this.lineJointRounded},...Ze(this.lineMiterLimit)&&{lineMiterLimit:this.lineMiterLimit},...Ze(this.getFillColor)&&{getFillColor:as(this.getFillColor,e)},...Ze(this.getLineColor)&&{getLineColor:as(this.getLineColor,e)},...Ze(this.getLineWidth)&&{getLineWidth:ls(this.getLineWidth,e)},...Ze(this.getElevation)&&{getElevation:ls(this.getElevation,e)}}}},qT=class extends lx{static layerType="polygon";constructor(e,r){super(e,r)}layerProps(e){return this.basePolygonLayerProps(e)}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Gk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}},YT=class extends lx{static layerType="h3-hexagon";highPrecision;coverage;getHexagon;constructor(e,r){super(e,r),this.initRegularAttribute("high_precision","highPrecision"),this.initRegularAttribute("coverage","coverage"),this.initVectorizedAccessor("get_hexagon","getHexagon")}layerProps(e){return{getHexagon:this.getHexagon.data[e],...Ze(this.highPrecision)&&{highPrecision:this.highPrecision},...Ze(this.coverage)&&{coverage:this.coverage},...this.basePolygonLayerProps(e)}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Ek({...this.baseLayerProps(),...this.layerProps(r)}));return e}},XT=class extends lx{static layerType="a5";getPentagon;constructor(e,r){super(e,r),this.initVectorizedAccessor("get_pentagon","getPentagon")}layerProps(e){return{getPentagon:this.getPentagon.data[e],...this.basePolygonLayerProps(e)}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new wk({...this.baseLayerProps(),...this.layerProps(r)}));return e}},Zk=class extends lx{static layerType="geohash";getGeohash;constructor(e,r){super(e,r),this.initVectorizedAccessor("get_geohash","getGeohash")}layerProps(e){return{getGeohash:this.getGeohash.data[e],...this.basePolygonLayerProps(e)}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Mk({...this.baseLayerProps(),...this.layerProps(r)}));return e}},Kk=class extends lx{static layerType="s2";getS2Token;constructor(e,r){super(e,r),this.initVectorizedAccessor("get_s2_token","getS2Token")}layerProps(e){return{getS2Token:this.getS2Token.data[e],...this.basePolygonLayerProps(e)}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Hk({...this.baseLayerProps(),...this.layerProps(r)}));return e}};var ZT=class extends sa{static layerType="scatterplot";radiusUnits;radiusScale;radiusMinPixels;radiusMaxPixels;lineWidthUnits;lineWidthScale;lineWidthMinPixels;lineWidthMaxPixels;stroked;filled;billboard;antialiasing;getRadius;getFillColor;getLineColor;getLineWidth;constructor(e,r){super(e,r),this.initRegularAttribute("radius_units","radiusUnits"),this.initRegularAttribute("radius_scale","radiusScale"),this.initRegularAttribute("radius_min_pixels","radiusMinPixels"),this.initRegularAttribute("radius_max_pixels","radiusMaxPixels"),this.initRegularAttribute("line_width_units","lineWidthUnits"),this.initRegularAttribute("line_width_scale","lineWidthScale"),this.initRegularAttribute("line_width_min_pixels","lineWidthMinPixels"),this.initRegularAttribute("line_width_max_pixels","lineWidthMaxPixels"),this.initRegularAttribute("stroked","stroked"),this.initRegularAttribute("filled","filled"),this.initRegularAttribute("billboard","billboard"),this.initRegularAttribute("antialiasing","antialiasing"),this.initVectorizedAccessor("get_radius","getRadius"),this.initVectorizedAccessor("get_fill_color","getFillColor"),this.initVectorizedAccessor("get_line_color","getLineColor"),this.initVectorizedAccessor("get_line_width","getLineWidth")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],...Ze(this.radiusUnits)&&{radiusUnits:this.radiusUnits},...Ze(this.radiusScale)&&{radiusScale:this.radiusScale},...Ze(this.radiusMinPixels)&&{radiusMinPixels:this.radiusMinPixels},...Ze(this.radiusMaxPixels)&&{radiusMaxPixels:this.radiusMaxPixels},...Ze(this.lineWidthUnits)&&{lineWidthUnits:this.lineWidthUnits},...Ze(this.lineWidthScale)&&{lineWidthScale:this.lineWidthScale},...Ze(this.lineWidthMinPixels)&&{lineWidthMinPixels:this.lineWidthMinPixels},...Ze(this.lineWidthMaxPixels)&&{lineWidthMaxPixels:this.lineWidthMaxPixels},...Ze(this.stroked)&&{stroked:this.stroked},...Ze(this.filled)&&{filled:this.filled},...Ze(this.billboard)&&{billboard:this.billboard},...Ze(this.antialiasing)&&{antialiasing:this.antialiasing},...Ze(this.getRadius)&&{getRadius:ls(this.getRadius,e)},...Ze(this.getFillColor)&&{getFillColor:as(this.getFillColor,e)},...Ze(this.getLineColor)&&{getLineColor:as(this.getLineColor,e)},...Ze(this.getLineWidth)&&{getLineWidth:ls(this.getLineWidth,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new qk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var KT=class extends Hg{static layerType="surface";positions;texCoords;triangles;texture;wireframe;constructor(e,r){super(e,r),this.initVectorizedAccessor("positions","positions"),this.initVectorizedAccessor("tex_coords","texCoords"),this.initVectorizedAccessor("triangles","triangles"),this.initRegularAttribute("texture","texture"),this.initRegularAttribute("wireframe","wireframe")}prepareTexture(){if(!Ze(this.texture))return;if(typeof this.texture=="string")return this.texture;let e=new Uint8ClampedArray(this.texture.data.buffer,this.texture.data.byteOffset,this.texture.data.byteLength);return new ImageData(e,this.texture.width,this.texture.height)}layerProps(){return{id:this.model.model_id,data:[1],mesh:{indices:{value:this.triangles.data[0].children[0].values,size:1},attributes:{POSITION:{value:this.positions.data[0].children[0].values,size:3},TEXCOORD_0:{value:this.texCoords.data[0].children[0].values,size:2}}},...Ze(this.texture)&&{texture:this.prepareTexture()},...Ze(this.wireframe)&&{wireframe:this.wireframe},_instanced:!1,getPosition:[0,0,0],getColor:[255,255,255]}}render(){return new Cee({...this.baseLayerProps(),...this.layerProps()})}};var QT=class extends sa{static layerType="text";billboard;sizeScale;sizeUnits;sizeMinPixels;sizeMaxPixels;getBackgroundColor;getBorderColor;getBorderWidth;backgroundPadding;characterSet;fontFamily;fontWeight;lineHeight;outlineWidth;outlineColor;fontSettings;wordBreak;maxWidth;getText;getPosition;getColor;getSize;getAngle;getTextAnchor;getAlignmentBaseline;getPixelOffset;constructor(e,r){super(e,r),this.initRegularAttribute("billboard","billboard"),this.initRegularAttribute("size_scale","sizeScale"),this.initRegularAttribute("size_units","sizeUnits"),this.initRegularAttribute("size_min_pixels","sizeMinPixels"),this.initRegularAttribute("size_max_pixels","sizeMaxPixels"),this.initRegularAttribute("background_padding","backgroundPadding"),this.initRegularAttribute("character_set","characterSet"),this.initRegularAttribute("font_family","fontFamily"),this.initRegularAttribute("font_weight","fontWeight"),this.initRegularAttribute("line_height","lineHeight"),this.initRegularAttribute("outline_width","outlineWidth"),this.initRegularAttribute("outline_color","outlineColor"),this.initRegularAttribute("font_settings","fontSettings"),this.initRegularAttribute("word_break","wordBreak"),this.initRegularAttribute("max_width","maxWidth"),this.initVectorizedAccessor("get_background_color","getBackgroundColor"),this.initVectorizedAccessor("get_border_color","getBorderColor"),this.initVectorizedAccessor("get_border_width","getBorderWidth"),this.initVectorizedAccessor("get_text","getText"),this.initVectorizedAccessor("get_position","getPosition"),this.initVectorizedAccessor("get_color","getColor"),this.initVectorizedAccessor("get_size","getSize"),this.initVectorizedAccessor("get_angle","getAngle"),this.initVectorizedAccessor("get_text_anchor","getTextAnchor"),this.initVectorizedAccessor("get_alignment_baseline","getAlignmentBaseline"),this.initVectorizedAccessor("get_pixel_offset","getPixelOffset")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],getText:this.getText.data[e],...Ze(this.billboard)&&{billboard:this.billboard},...Ze(this.sizeScale)&&{sizeScale:this.sizeScale},...Ze(this.sizeUnits)&&{sizeUnits:this.sizeUnits},...Ze(this.sizeMinPixels)&&{sizeMinPixels:this.sizeMinPixels},...Ze(this.sizeMaxPixels)&&{sizeMaxPixels:this.sizeMaxPixels},...Ze(this.backgroundPadding)&&{backgroundPadding:this.backgroundPadding},...Ze(this.characterSet)&&{characterSet:this.characterSet},...Ze(this.fontFamily)&&{fontFamily:this.fontFamily},...Ze(this.fontWeight)&&{fontWeight:this.fontWeight},...Ze(this.lineHeight)&&{lineHeight:this.lineHeight},...Ze(this.outlineWidth)&&{outlineWidth:this.outlineWidth},...Ze(this.outlineColor)&&{outlineColor:this.outlineColor},...Ze(this.fontSettings)&&{fontSettings:this.fontSettings},...Ze(this.wordBreak)&&{wordBreak:this.wordBreak},...Ze(this.maxWidth)&&{maxWidth:this.maxWidth},...Ze(this.getBackgroundColor)&&{getBackgroundColor:as(this.getBackgroundColor,e)},...Ze(this.getBorderColor)&&{getBorderColor:as(this.getBorderColor,e)},...Ze(this.getBorderWidth)&&{getBorderWidth:ls(this.getBorderWidth,e)},...Ze(this.getPosition)&&{getPosition:this.getPosition.data[e]},...Ze(this.getColor)&&{getColor:as(this.getColor,e)},...Ze(this.getSize)&&{getSize:ls(this.getSize,e)},...Ze(this.getAngle)&&{getAngle:ls(this.getAngle,e)},...Ze(this.getTextAnchor)&&{getTextAnchor:typeof this.getTextAnchor=="string"?this.getTextAnchor:this.getTextAnchor.data[e]},...Ze(this.getAlignmentBaseline)&&{getAlignmentBaseline:typeof this.getAlignmentBaseline=="string"?this.getAlignmentBaseline:this.getAlignmentBaseline.data[e]},...Ze(this.getPixelOffset)&&{getPixelOffset:Array.isArray(this.getPixelOffset)?this.getPixelOffset:this.getPixelOffset.data[e]}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Yk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};var JT=class extends sa{static layerType="trip";widthUnits;widthScale;widthMinPixels;widthMaxPixels;jointRounded;capRounded;miterLimit;billboard;fadeTrail;trailLength;currentTime;getColor;getWidth;getTimestamps;constructor(e,r){super(e,r),this.initRegularAttribute("width_units","widthUnits"),this.initRegularAttribute("width_scale","widthScale"),this.initRegularAttribute("width_min_pixels","widthMinPixels"),this.initRegularAttribute("width_max_pixels","widthMaxPixels"),this.initRegularAttribute("joint_rounded","jointRounded"),this.initRegularAttribute("cap_rounded","capRounded"),this.initRegularAttribute("miter_limit","miterLimit"),this.initRegularAttribute("billboard","billboard"),this.initRegularAttribute("fade_trail","fadeTrail"),this.initRegularAttribute("trail_length","trailLength"),this.initRegularAttribute("_current_time","currentTime"),this.initVectorizedAccessor("get_color","getColor"),this.initVectorizedAccessor("get_width","getWidth"),this.initVectorizedAccessor("get_timestamps","getTimestamps")}layerProps(e){return{id:`${this.model.model_id}-${e}`,data:this.table.batches[e],getTimestamps:this.getTimestamps.data[e],...Ze(this.widthUnits)&&{widthUnits:this.widthUnits},...Ze(this.widthScale)&&{widthScale:this.widthScale},...Ze(this.widthMinPixels)&&{widthMinPixels:this.widthMinPixels},...Ze(this.widthMaxPixels)&&{widthMaxPixels:this.widthMaxPixels},...Ze(this.jointRounded)&&{jointRounded:this.jointRounded},...Ze(this.capRounded)&&{capRounded:this.capRounded},...Ze(this.miterLimit)&&{miterLimit:this.miterLimit},...Ze(this.billboard)&&{billboard:this.billboard},...Ze(this.fadeTrail)&&{fadeTrail:this.fadeTrail},...Ze(this.trailLength)&&{trailLength:this.trailLength},...Ze(this.currentTime)&&{currentTime:this.currentTime},...Ze(this.getColor)&&{getColor:as(this.getColor,e)},...Ze(this.getWidth)&&{getWidth:ls(this.getWidth,e)}}}render(){let e=[];for(let r=0;r<this.table.batches.length;r++)e.push(new Xk({...this.baseLayerProps(r),...this.layerProps(r)}));return e}};async function Dte(t,e){let r=t.get("_layer_type"),i;switch(r){case XT.layerType:i=new XT(t,e);break;case zT.layerType:i=new zT(t,e);break;case UT.layerType:i=new UT(t,e);break;case VT.layerType:i=new VT(t,e);break;case jT.layerType:i=new jT(t,e);break;case Zk.layerType:i=new Zk(t,e);break;case YT.layerType:i=new YT(t,e);break;case $T.layerType:i=new $T(t,e);break;case WT.layerType:i=new WT(t,e);break;case GT.layerType:i=new GT(t,e);break;case qT.layerType:i=new qT(t,e);break;case Kk.layerType:i=new Kk(t,e);break;case ZT.layerType:i=new ZT(t,e);break;case HT.layerType:i=new HT(t,e);break;case KT.layerType:i=new KT(t,e);break;case QT.layerType:i=new QT(t,e);break;case JT.layerType:i=new JT(t,e);break;default:throw new Error(`no layer supported for ${r}`)}return await i.loadSubModels(),i}var DCe=Tt($t(),1),Vl=Tt($t(),1);var Nz=Tt($t(),1),uht=typeof window<"u"?Nz.useLayoutEffect:Nz.useEffect,kCe=uht;var Uz=Tt($t(),1),RCe=Tt($t(),1);function e4(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}var Lte=Tt($t(),1),hht={position:"absolute",zIndex:-1};function zz(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(r=>zz(r,e));if(t4(t)){if(dht(t))return e.style=hht,(0,Lte.cloneElement)(t,e);if(fht(t))return(0,Lte.cloneElement)(t,e)}return t}function t4(t){return t&&typeof t=="object"&&"type"in t||!1}function dht(t){return t.props?.mapStyle}function fht(t){let e=t.type;return e&&e.deckGLViewProps}function Bte(t){if(typeof t=="function")return(0,RCe.createElement)(na,{},t);if(Array.isArray(t))return t.map(Bte);if(t4(t)){if(t.type===Uz.Fragment)return Bte(t.props.children);if(e4(t.type,na))return t}return t}function Fte({children:t,layers:e=[],views:r=null}){let i=[],n=[],o={};return Uz.Children.forEach(Bte(t),s=>{if(t4(s)){let a=s.type;if(e4(a,Mo)){let u=pht(a,s.props);n.push(u)}else i.push(s);if(e4(a,na)&&a!==na&&s.props.id){let u=new a(s.props);o[u.id]=u}}else s&&i.push(s)}),Object.keys(o).length>0&&(Array.isArray(r)?r.forEach(s=>{o[s.id]=s}):r&&(o[r.id]=r),r=Object.values(o)),e=n.length>0?[...n,...e]:e,{layers:e,children:i,views:r}}function pht(t,e){let r={},i=t.defaultProps||{};for(let n in e)i[n]!==e[n]&&(r[n]=e[n]);return new t(r)}var Nte=Tt($t(),1);var OCe=Tt($t(),1),Vz=(0,OCe.createContext)();function zte({children:t,deck:e,ContextProvider:r=Vz.Provider}){let{viewManager:i}=e||{};if(!i||!i.views.length)return[];let n={},o=i.views[0].id;for(let s of t){let a=o,u=s;t4(s)&&e4(s.type,na)&&(a=s.props.id||o,u=s.props.children);let p=i.getViewport(a),m=i.getViewState(a);if(p){m.padding=p.padding;let{x,y:M,width:k,height:F}=p;u=zz(u,{x,y:M,width:k,height:F,viewport:p,viewState:m}),n[a]||(n[a]={viewport:p,children:[]}),n[a].children.push(u)}}return Object.keys(n).map(s=>{let{viewport:a,children:u}=n[s],{x:p,y:m,width:x,height:M}=a,k={position:"absolute",left:p,top:m,width:x,height:M},F=`view-${s}`,j=(0,Nte.createElement)("div",{key:F,id:F,style:k},...u),H={deck:e,viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:Z=>{Z.viewId=s,e._onViewStateChange(Z)},widgets:[]},W=`view-${s}-context`;return(0,Nte.createElement)(r,{key:W,value:H},j)})}var mht={mixBlendMode:null};function Ute({width:t,height:e,style:r}){let i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},n={left:0,top:0};if(r)for(let o in r)o in mht?n[o]=r[o]:i[o]=r[o];return{containerStyle:i,canvasStyle:n}}function ght(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function LCe(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function Aht(t,e,r){let i=new e({...r,_customRender:r.deviceProps?.adapters?.[0]?.type==="webgpu"?void 0:n=>{t.redrawReason=n;let o=i.getViewports();t.lastRenderedViewports!==o?t.forceUpdate():LCe(t)}});return i}function yht(t,e){let[r,i]=(0,Vl.useState)(0),o=(0,Vl.useRef)({control:null,version:r,forceUpdate:()=>i(ce=>ce+1)}).current,s=(0,Vl.useRef)(null),a=(0,Vl.useRef)(null),u=(0,Vl.useMemo)(()=>Fte(t),[t.layers,t.views,t.children]),p=!0,m=ce=>p&&t.viewState?(o.viewStateUpdateRequested=ce,null):(o.viewStateUpdateRequested=null,t.onViewStateChange?.(ce)),x=ce=>{p?o.interactionStateUpdateRequested=ce:(o.interactionStateUpdateRequested=null,t.onInteractionStateChange?.(ce))},M=(0,Vl.useMemo)(()=>{let ce={widgets:[],...t,style:null,width:"100%",height:"100%",parent:s.current,canvas:a.current,layers:u.layers,views:u.views,onViewStateChange:m,onInteractionStateChange:x};return delete ce._customRender,o.deck&&o.deck.setProps(ce),ce},[t]);(0,Vl.useEffect)(()=>{let ce=t.Deck||g_;return o.deck=Aht(o,ce,{...M,parent:s.current,canvas:a.current}),()=>o.deck?.finalize()},[]),kCe(()=>{LCe(o);let{viewStateUpdateRequested:ce,interactionStateUpdateRequested:ge}=o;ce&&m(ce),ge&&x(ge),o.deck?.isInitialized&&o.deck.redraw("Initial render")}),(0,Vl.useImperativeHandle)(e,()=>ght(o),[]);let k=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:F,width:j="100%",height:H="100%",id:W,style:Z}=t,{containerStyle:Y,canvasStyle:ee}=(0,Vl.useMemo)(()=>Ute({width:j,height:H,style:Z}),[j,H,Z]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===k||o.version!==r){o.lastRenderedViewports=k,o.version=r;let ce=zte({children:u.children,deck:o.deck,ContextProvider:F}),ge=(0,Vl.createElement)("canvas",{key:"canvas",id:W||"deckgl-overlay",ref:a,style:ee});o.control=(0,Vl.createElement)("div",{id:`${W||"deckgl"}-wrapper`,ref:s,style:Y},[ge,ce])}return p=!1,o.control}var _ht=DCe.forwardRef(yht),Vte=_ht;var Hz,Po,UCe,vht,cx,BCe,VCe,jCe,$Ce,Gte,jte,$te,bht,Qk={},WCe=[],xht=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,qz=Array.isArray;function tA(t,e){for(var r in e)t[r]=e[r];return t}function Hte(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function wht(t,e,r){var i,n,o,s={};for(o in e)o=="key"?i=e[o]:o=="ref"?n=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?Hz.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return $z(t,s,i,n,null)}function $z(t,e,r,i,n){var o={type:t,props:e,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:n??++UCe,__i:-1,__u:0};return n==null&&Po.vnode!=null&&Po.vnode(o),o}function i4(t){return t.children}function Wz(t,e){this.props=t,this.context=e}function r4(t,e){if(e==null)return t.__?r4(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?r4(t):null}function GCe(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return GCe(t)}}function FCe(t){(!t.__d&&(t.__d=!0)&&cx.push(t)&&!Gz.__r++||BCe!=Po.debounceRendering)&&((BCe=Po.debounceRendering)||VCe)(Gz)}function Gz(){for(var t,e,r,i,n,o,s,a=1;cx.length;)cx.length>a&&cx.sort(jCe),t=cx.shift(),a=cx.length,t.__d&&(r=void 0,i=void 0,n=(i=(e=t).__v).__e,o=[],s=[],e.__P&&((r=tA({},i)).__v=i.__v+1,Po.vnode&&Po.vnode(r),qte(e.__P,r,i,e.__n,e.__P.namespaceURI,32&i.__u?[n]:null,o,n??r4(i),!!(32&i.__u),s),r.__v=i.__v,r.__.__k[r.__i]=r,YCe(o,r,s),i.__e=i.__=null,r.__e!=n&&GCe(r)));Gz.__r=0}function HCe(t,e,r,i,n,o,s,a,u,p,m){var x,M,k,F,j,H,W,Z=i&&i.__k||WCe,Y=e.length;for(u=Sht(r,e,Z,u,Y),x=0;x<Y;x++)(k=r.__k[x])!=null&&(M=k.__i==-1?Qk:Z[k.__i]||Qk,k.__i=x,H=qte(t,k,M,n,o,s,a,u,p,m),F=k.__e,k.ref&&M.ref!=k.ref&&(M.ref&&Yte(M.ref,null,k),m.push(k.ref,k.__c||F,k)),j==null&&F!=null&&(j=F),(W=!!(4&k.__u))||M.__k===k.__k?u=qCe(k,u,t,W):typeof k.type=="function"&&H!==void 0?u=H:F&&(u=F.nextSibling),k.__u&=-7);return r.__e=j,u}function Sht(t,e,r,i,n){var o,s,a,u,p,m=r.length,x=m,M=0;for(t.__k=new Array(n),o=0;o<n;o++)(s=e[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(u=o+M,(s=t.__k[o]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?$z(null,s,null,null,null):qz(s)?$z(i4,{children:s},null,null,null):s.constructor==null&&s.__b>0?$z(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=t,s.__b=t.__b+1,a=null,(p=s.__i=Tht(s,r,u,x))!=-1&&(x--,(a=r[p])&&(a.__u|=2)),a==null||a.__v==null?(p==-1&&(n>m?M--:n<m&&M++),typeof s.type!="function"&&(s.__u|=4)):p!=u&&(p==u-1?M--:p==u+1?M++:(p>u?M--:M++,s.__u|=4))):t.__k[o]=null;if(x)for(o=0;o<m;o++)(a=r[o])!=null&&(2&a.__u)==0&&(a.__e==i&&(i=r4(a)),ZCe(a,a));return i}function qCe(t,e,r,i){var n,o;if(typeof t.type=="function"){for(n=t.__k,o=0;n&&o<n.length;o++)n[o]&&(n[o].__=t,e=qCe(n[o],e,r,i));return e}t.__e!=e&&(i&&(e&&t.type&&!e.parentNode&&(e=r4(t)),r.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Tht(t,e,r,i){var n,o,s,a=t.key,u=t.type,p=e[r],m=p!=null&&(2&p.__u)==0;if(p===null&&t.key==null||m&&a==p.key&&u==p.type)return r;if(i>(m?1:0)){for(n=r-1,o=r+1;n>=0||o<e.length;)if((p=e[s=n>=0?n--:o++])!=null&&(2&p.__u)==0&&a==p.key&&u==p.type)return s}return-1}function NCe(t,e,r){e[0]=="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||xht.test(e)?r:r+"px"}function jz(t,e,r,i,n){var o,s;e:if(e=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)r&&e in r||NCe(t.style,e,"");if(r)for(e in r)i&&r[e]==i[e]||NCe(t.style,e,r[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace($Ce,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=r,r?i?r.u=i.u:(r.u=Gte,t.addEventListener(e,o?$te:jte,o)):t.removeEventListener(e,o?$te:jte,o);else{if(n=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&r==1?"":r))}}function zCe(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=Gte++;else if(e.t<r.u)return;return r(Po.event?Po.event(e):e)}}}function qte(t,e,r,i,n,o,s,a,u,p){var m,x,M,k,F,j,H,W,Z,Y,ee,ce,ge,Se,ne,pe,ue,Le=e.type;if(e.constructor!=null)return null;128&r.__u&&(u=!!(32&r.__u),o=[a=e.__e=r.__e]),(m=Po.__b)&&m(e);e:if(typeof Le=="function")try{if(W=e.props,Z="prototype"in Le&&Le.prototype.render,Y=(m=Le.contextType)&&i[m.__c],ee=m?Y?Y.props.value:m.__:i,r.__c?H=(x=e.__c=r.__c).__=x.__E:(Z?e.__c=x=new Le(W,ee):(e.__c=x=new Wz(W,ee),x.constructor=Le,x.render=Eht),Y&&Y.sub(x),x.props=W,x.state||(x.state={}),x.context=ee,x.__n=i,M=x.__d=!0,x.__h=[],x._sb=[]),Z&&x.__s==null&&(x.__s=x.state),Z&&Le.getDerivedStateFromProps!=null&&(x.__s==x.state&&(x.__s=tA({},x.__s)),tA(x.__s,Le.getDerivedStateFromProps(W,x.__s))),k=x.props,F=x.state,x.__v=e,M)Z&&Le.getDerivedStateFromProps==null&&x.componentWillMount!=null&&x.componentWillMount(),Z&&x.componentDidMount!=null&&x.__h.push(x.componentDidMount);else{if(Z&&Le.getDerivedStateFromProps==null&&W!==k&&x.componentWillReceiveProps!=null&&x.componentWillReceiveProps(W,ee),!x.__e&&x.shouldComponentUpdate!=null&&x.shouldComponentUpdate(W,x.__s,ee)===!1||e.__v==r.__v){for(e.__v!=r.__v&&(x.props=W,x.state=x.__s,x.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.some(function(We){We&&(We.__=e)}),ce=0;ce<x._sb.length;ce++)x.__h.push(x._sb[ce]);x._sb=[],x.__h.length&&s.push(x);break e}x.componentWillUpdate!=null&&x.componentWillUpdate(W,x.__s,ee),Z&&x.componentDidUpdate!=null&&x.__h.push(function(){x.componentDidUpdate(k,F,j)})}if(x.context=ee,x.props=W,x.__P=t,x.__e=!1,ge=Po.__r,Se=0,Z){for(x.state=x.__s,x.__d=!1,ge&&ge(e),m=x.render(x.props,x.state,x.context),ne=0;ne<x._sb.length;ne++)x.__h.push(x._sb[ne]);x._sb=[]}else do x.__d=!1,ge&&ge(e),m=x.render(x.props,x.state,x.context),x.state=x.__s;while(x.__d&&++Se<25);x.state=x.__s,x.getChildContext!=null&&(i=tA(tA({},i),x.getChildContext())),Z&&!M&&x.getSnapshotBeforeUpdate!=null&&(j=x.getSnapshotBeforeUpdate(k,F)),pe=m,m!=null&&m.type===i4&&m.key==null&&(pe=XCe(m.props.children)),a=HCe(t,qz(pe)?pe:[pe],e,r,i,n,o,s,a,u,p),x.base=e.__e,e.__u&=-161,x.__h.length&&s.push(x),H&&(x.__E=x.__=null)}catch(We){if(e.__v=null,u||o!=null)if(We.then){for(e.__u|=u?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,e.__e=a}else{for(ue=o.length;ue--;)Hte(o[ue]);Wte(e)}else e.__e=r.__e,e.__k=r.__k,We.then||Wte(e);Po.__e(We,e,r)}else o==null&&e.__v==r.__v?(e.__k=r.__k,e.__e=r.__e):a=e.__e=Mht(r.__e,e,r,i,n,o,s,u,p);return(m=Po.diffed)&&m(e),128&e.__u?void 0:a}function Wte(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Wte)}function YCe(t,e,r){for(var i=0;i<r.length;i++)Yte(r[i],r[++i],r[++i]);Po.__c&&Po.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(o){o.call(n)})}catch(o){Po.__e(o,n.__v)}})}function XCe(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:qz(t)?t.map(XCe):tA({},t)}function Mht(t,e,r,i,n,o,s,a,u){var p,m,x,M,k,F,j,H=r.props,W=e.props,Z=e.type;if(Z=="svg"?n="http://www.w3.org/2000/svg":Z=="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),o!=null){for(p=0;p<o.length;p++)if((k=o[p])&&"setAttribute"in k==!!Z&&(Z?k.localName==Z:k.nodeType==3)){t=k,o[p]=null;break}}if(t==null){if(Z==null)return document.createTextNode(W);t=document.createElementNS(n,Z,W.is&&W),a&&(Po.__m&&Po.__m(e,o),a=!1),o=null}if(Z==null)H===W||a&&t.data==W||(t.data=W);else{if(o=o&&Hz.call(t.childNodes),H=r.props||Qk,!a&&o!=null)for(H={},p=0;p<t.attributes.length;p++)H[(k=t.attributes[p]).name]=k.value;for(p in H)if(k=H[p],p!="children"){if(p=="dangerouslySetInnerHTML")x=k;else if(!(p in W)){if(p=="value"&&"defaultValue"in W||p=="checked"&&"defaultChecked"in W)continue;jz(t,p,null,k,n)}}for(p in W)k=W[p],p=="children"?M=k:p=="dangerouslySetInnerHTML"?m=k:p=="value"?F=k:p=="checked"?j=k:a&&typeof k!="function"||H[p]===k||jz(t,p,k,H[p],n);if(m)a||x&&(m.__html==x.__html||m.__html==t.innerHTML)||(t.innerHTML=m.__html),e.__k=[];else if(x&&(t.innerHTML=""),HCe(e.type=="template"?t.content:t,qz(M)?M:[M],e,r,i,Z=="foreignObject"?"http://www.w3.org/1999/xhtml":n,o,s,o?o[0]:r.__k&&r4(r,0),a,u),o!=null)for(p=o.length;p--;)Hte(o[p]);a||(p="value",Z=="progress"&&F==null?t.removeAttribute("value"):F!=null&&(F!==t[p]||Z=="progress"&&!F||Z=="option"&&F!=H[p])&&jz(t,p,F,H[p],n),p="checked",j!=null&&j!=t[p]&&jz(t,p,j,H[p],n))}return t}function Yte(t,e,r){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&e==null||(t.__u=t(e))}else t.current=e}catch(n){Po.__e(n,r)}}function ZCe(t,e,r){var i,n;if(Po.unmount&&Po.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||Yte(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){Po.__e(o,e)}i.base=i.__P=null}if(i=t.__k)for(n=0;n<i.length;n++)i[n]&&ZCe(i[n],e,r||typeof t.type!="function");r||Hte(t.__e),t.__c=t.__=t.__e=void 0}function Eht(t,e,r){return this.constructor(t,r)}function K_(t,e,r){var i,n,o,s;e==document&&(e=document.documentElement),Po.__&&Po.__(t,e),n=(i=typeof r=="function")?null:r&&r.__k||e.__k,o=[],s=[],qte(e,t=(!i&&r||e).__k=wht(i4,null,[t]),n||Qk,Qk,e.namespaceURI,!i&&r?[r]:n?null:e.firstChild?Hz.call(e.childNodes):null,o,!i&&r?r:n?n.__e:e.firstChild,i,s),YCe(o,t,s)}Hz=WCe.slice,Po={__e:function(t,e,r,i){for(var n,o,s;e=e.__;)if((n=e.__c)&&!n.__)try{if((o=n.constructor)&&o.getDerivedStateFromError!=null&&(n.setState(o.getDerivedStateFromError(t)),s=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t,i||{}),s=n.__d),s)return n.__E=n}catch(a){t=a}throw t}},UCe=0,vht=function(t){return t!=null&&t.constructor==null},Wz.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=tA({},this.state),typeof t=="function"&&(t=t(tA({},r),this.props)),t&&tA(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),FCe(this))},Wz.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),FCe(this))},Wz.prototype.render=i4,cx=[],VCe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,jCe=function(t,e){return t.__v.__b-e.__v.__b},Gz.__r=0,$Ce=/(PointerCapture)$|Capture$/i,Gte=0,jte=zCe(!1),$te=zCe(!0),bht=0;var Cht=0,t1r=Array.isArray;function Vn(t,e,r,i,n,o){e||(e={});var s,a,u=e;if("ref"in u)for(a in u={},e)a=="ref"?s=e[a]:u[a]=e[a];var p={type:t,props:u,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Cht,__i:-1,__u:0,__source:n,__self:o};if(typeof t=="function"&&(s=t.defaultProps))for(a in s)u[a]===void 0&&(u[a]=s[a]);return Po.vnode&&Po.vnode(p),p}var KCe=t=>{let{children:e,orientation:r="horizontal"}=t;return Vn("div",{className:`deck-widget-button-group ${r}`,children:e})};var Xte=t=>{let{className:e="",label:r,onClick:i,children:n}=t;return Vn("button",{className:`deck-widget-icon-button ${e}`,type:"button",onClick:i,title:r,children:n||Vn("div",{className:"deck-widget-icon"})})};var n4=class extends qa{constructor(e={}){super(e),this.className="deck-widget-zoom",this.placement="top-left",this.viewports={},this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let r=Vn(KCe,{orientation:this.props.orientation,children:[Vn(Xte,{onClick:()=>this.handleZoomIn(),label:this.props.zoomInLabel,className:"deck-widget-zoom-in"}),Vn(Xte,{onClick:()=>this.handleZoomOut(),label:this.props.zoomOutLabel,className:"deck-widget-zoom-out"})]});K_(r,e)}onViewportChange(e){this.viewports[e.id]=e}handleZoom(e,r){let i=this.viewId||e?.id||"default-view",n={...e,zoom:r};this.props.transitionDuration>0&&(n.transitionDuration=this.props.transitionDuration,n.transitionInterpolator="latitude"in n?new E0:new dl({transitionProps:["zoom"]})),this.setViewState(i,n)}handleZoomIn(){for(let e of Object.values(this.viewports))this.handleZoom(e,e.zoom+1)}handleZoomOut(){for(let e of Object.values(this.viewports))this.handleZoom(e,e.zoom-1)}setViewState(e,r){this.deck._onViewStateChange({viewId:e,viewState:r,interactionState:{}})}};n4.defaultProps={...qa.defaultProps,id:"zoom",placement:"top-left",orientation:"vertical",transitionDuration:200,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",viewId:null};var QCe=t=>{let{className:e="",label:r,onClick:i,children:n}=t;return Vn("div",{className:"deck-widget-button",children:Vn("button",{className:`deck-widget-icon-button ${e}`,type:"button",onClick:i,title:r,children:n||Vn("div",{className:"deck-widget-icon"})})})};var o4=class extends qa{constructor(e={}){super(e),this.className="deck-widget-compass",this.placement="top-left",this.viewports={},this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let r=this.viewId||Object.values(this.viewports)[0]?.id||"default-view",i=this.viewports[r],[n,o]=this.getRotation(i),s=Vn("div",{className:"deck-widget-button",style:{perspective:100},children:Vn("button",{type:"button",onClick:()=>{for(let a of Object.values(this.viewports))this.handleCompassReset(a)},title:this.props.label,style:{transform:`rotateX(${o}deg)`},children:Vn("svg",{fill:"none",width:"100%",height:"100%",viewBox:"0 0 26 26",children:Vn("g",{transform:`rotate(${n},13,13)`,children:[Vn("path",{d:"M10 13.0001L12.9999 5L15.9997 13.0001H10Z",fill:"var(--icon-compass-north-color, rgb(240, 92, 68))"}),Vn("path",{d:"M16.0002 12.9999L13.0004 21L10.0005 12.9999H16.0002Z",fill:"var(--icon-compass-south-color, rgb(204, 204, 204))"})]})})})});K_(s,e)}onViewportChange(e){e.equals(this.viewports[e.id])||(this.viewports[e.id]=e,this.updateHTML())}getRotation(e){return e instanceof Th?[-e.bearing,e.pitch]:e instanceof M0?[0,Math.max(-80,Math.min(80,e.latitude))]:[0,0]}handleCompassReset(e){let r=this.viewId||e.id||"default-view";if(e instanceof Th){let i={...e,bearing:0,...this.getRotation(e)[0]===0?{pitch:0}:{},transitionDuration:this.props.transitionDuration,transitionInterpolator:new E0};this.deck._onViewStateChange({viewId:r,viewState:i,interactionState:{}})}}};o4.defaultProps={...qa.defaultProps,id:"compass",placement:"top-left",viewId:null,label:"Reset Compass",transitionDuration:200};var s4=class extends qa{constructor(e={}){super(e),this.className="deck-widget-scale",this.placement="bottom-left",this.scaleWidth=10,this.scaleValue=0,this.scaleText="",this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let i=50+this.scaleWidth,n=10;K_(Vn("svg",{className:"deck-widget-scale",width:i,height:30,style:{overflow:"visible",background:"transparent"},onClick:this.handleClick.bind(this),children:[Vn("text",{x:55,y:"10",textAnchor:"end",alignmentBaseline:"middle",style:{fontSize:"16px",fill:"black",fontWeight:"bold",fontFamily:"sans-serif"},children:this.scaleText}),Vn("line",{x1:50,y1:"15",x2:50+this.scaleWidth,y2:"15",stroke:"black",strokeWidth:"6"}),Vn("line",{x1:50,y1:"15",x2:50,y2:15-n,stroke:"black",strokeWidth:"6"}),Vn("line",{x1:50+this.scaleWidth,y1:"15",x2:50+this.scaleWidth,y2:15-n,stroke:"black",strokeWidth:"6"})]}),e)}onViewportChange(e){if(!("latitude"in e))return;let{latitude:r,zoom:i}=e,n=Pht(r,i),{candidate:o,candidatePixels:s}=Iht(n);this.scaleValue=o,this.scaleWidth=s,o>=1e3?this.scaleText=`${(o/1e3).toFixed(1)} km`:this.scaleText=`${o} m`,this.updateHTML()}handleClick(){}};s4.defaultProps={...qa.defaultProps,id:"scale",placement:"bottom-left",label:"Scale",viewId:null};function Pht(t,e){return 40075016686e-3*Math.cos(t*Math.PI/180)/Math.pow(2,e+8)}function Iht(t){let n=150*t,o=Math.floor(Math.log10(n)),s=Math.pow(10,o),a=[1,2,5],u=a[0]*s,p=u/t;for(let m=0;m<a.length;m++){let x=a[m]*s,M=x/t;if(M>=100&&M<=200){u=x,p=M;break}if(M>200){u=m>0?a[m-1]*s:x,p=u/t;break}m===a.length-1&&M<100&&(u=a[0]*s*10,p=u/t)}return{candidate:u,candidatePixels:p}}var a4=class extends qa{constructor(e={}){super(e),this.className="deck-widget-fullscreen",this.placement="top-left",this.fullscreen=!1,this.setProps(this.props)}onAdd(){document.addEventListener("fullscreenchange",this.onFullscreenChange.bind(this))}onRemove(){document.removeEventListener("fullscreenchange",this.onFullscreenChange.bind(this))}onRenderHTML(e){K_(Vn(QCe,{onClick:()=>{this.handleClick().catch(r=>mr.error(r)())},label:this.fullscreen?this.props.exitLabel:this.props.enterLabel,className:this.fullscreen?"deck-widget-fullscreen-exit":"deck-widget-fullscreen-enter"}),e)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}getContainer(){return this.props.container||this.deck?.getCanvas()?.parentElement}onFullscreenChange(){let e=this.fullscreen,r=document.fullscreenElement===this.getContainer();e!==r&&(this.fullscreen=!this.fullscreen),this.updateHTML()}async handleClick(){this.fullscreen?await this.exitFullscreen():await this.requestFullscreen(),this.updateHTML()}async requestFullscreen(){let e=this.getContainer();e?.requestFullscreen?await e.requestFullscreen({navigationUI:"hide"}):this.togglePseudoFullscreen()}async exitFullscreen(){document.exitFullscreen?await document.exitFullscreen():this.togglePseudoFullscreen()}togglePseudoFullscreen(){this.getContainer()?.classList.toggle("deck-pseudo-fullscreen")}};a4.defaultProps={...qa.defaultProps,id:"fullscreen",placement:"top-left",viewId:null,enterLabel:"Enter Fullscreen",exitLabel:"Exit Fullscreen",container:void 0};var ux=Tt($t(),1);function Q_(t,e){let r=(0,ux.useContext)(Vz),{widgets:i,deck:n}=r;(0,ux.useEffect)(()=>{let s=n?.props.widgets;return i?.length&&s?.length&&!vo(s,i,1)&&mr.warn('"widgets" prop will be ignored because React widgets are in use.')(),()=>{let a=i?.indexOf(o);a&&a!==-1&&(i?.splice(a,1),n?.setProps({widgets:i}))}},[]);let o=(0,ux.useMemo)(()=>new t(e),[t]);return i?.push(o),o.setProps(e),(0,ux.useEffect)(()=>{n?.setProps({widgets:i})},[i]),o}var Zte=(t={})=>(Q_(o4,t),null);var Kte=(t={})=>(Q_(a4,t),null);var Qte=(t={})=>(Q_(n4,t),null);var Jte=(t={})=>(Q_(s4,t),null);var J_=Tt($t(),1),Uh=Tt($t(),1);var ere=Tt($t(),1),Yz=Tt($t(),1);var JCe=ere.createContext(null);function e5e(t,e){let r=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,n=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return r===n&&i===o}function Qc(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Qc(t[r],e[r]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){let r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(let n of r)if(!e.hasOwnProperty(n)||!Qc(t[n],e[n]))return!1;return!0}return!1}function tre(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function rre(t,e){let r=e.viewState||e,i={};if("longitude"in r&&"latitude"in r&&(r.longitude!==t.center.lng||r.latitude!==t.center.lat)){let n=t.center.constructor;i.center=new n(r.longitude,r.latitude)}return"zoom"in r&&r.zoom!==t.zoom&&(i.zoom=r.zoom),"bearing"in r&&r.bearing!==t.bearing&&(i.bearing=r.bearing),"pitch"in r&&r.pitch!==t.pitch&&(i.pitch=r.pitch),r.padding&&t.padding&&!Qc(r.padding,t.padding)&&(i.padding=r.padding),i}var kht=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ire(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;let e={};for(let i of t.layers)e[i.id]=i;let r=t.layers.map(i=>{let n=null;"interactive"in i&&(n=Object.assign({},i),delete n.interactive);let o=e[i.ref];if(o){n=n||Object.assign({},i),delete n.ref;for(let s of kht)s in o&&(n[s]=o[s])}return n||i});return{...t,layers:r}}var t5e={version:8,sources:{},layers:[]},r5e={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},i5e={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},n5e={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Rht=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Oht=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"],Xz=class t{constructor(e,r,i){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=n=>{let o=this.props[n5e[n.type]];o?o(n):n.type==="error"&&console.error(n.error)},this._onCameraEvent=n=>{if(this._internalUpdate)return;n.viewState=this._propsedCameraUpdate||tre(this._map.transform);let o=this.props[i5e[n.type]];o&&o(n)},this._onCameraUpdate=n=>this._internalUpdate?n:(this._propsedCameraUpdate=tre(n),rre(n,this.props)),this._onPointerEvent=n=>{(n.type==="mousemove"||n.type==="mouseout")&&this._updateHover(n);let o=this.props[r5e[n.type]];o&&(this.props.interactiveLayerIds&&n.type!=="mouseover"&&n.type!=="mouseout"&&(n.features=this._hoveredFeatures||this._queryRenderedFeatures(n.point)),o(n),delete n.features)},this._MapClass=e,this.props=r,this._initialize(i)}get map(){return this._map}setProps(e){let r=this.props;this.props=e;let i=this._updateSettings(e,r),n=this._updateSize(e),o=this._updateViewState(e);this._updateStyle(e,r),this._updateStyleComponents(e),this._updateHandlers(e,r),(i||n||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,r){let i=t.savedMaps.pop();if(!i)return null;let n=i.map,o=n.getContainer();for(r.className=o.className;o.childNodes.length>0;)r.appendChild(o.childNodes[0]);n._container=r;let s=n._resizeObserver;s&&(s.disconnect(),s.observe(r)),i.setProps({...e,styleDiffing:!1}),n.resize();let{initialViewState:a}=e;return a&&(a.bounds?n.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):i._updateViewState(a)),n.isStyleLoaded()?n.fire("load"):n.once("style.load",()=>n.fire("load")),n._update(),i}_initialize(e){let{props:r}=this,{mapStyle:i=t5e}=r,n={...r,...r.initialViewState,container:e,style:ire(i)},o=n.initialViewState||n.viewState||n;if(Object.assign(n,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),r.gl){let a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=a,r.gl)}let s=new this._MapClass(n);o.padding&&s.setPadding(o.padding),r.cursor&&(s.getCanvas().style.cursor=r.cursor),s.transformCameraUpdate=this._onCameraUpdate,s.on("style.load",()=>{this._styleComponents={light:s.getLight(),sky:s.getSky(),projection:s.getProjection?.(),terrain:s.getTerrain()},this._updateStyleComponents(this.props)}),s.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(let a in r5e)s.on(a,this._onPointerEvent);for(let a in i5e)s.on(a,this._onCameraEvent);for(let a in n5e)s.on(a,this._onEvent);this._map=s}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),t.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){let e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){let{viewState:r}=e;if(r){let i=this._map;if(r.width!==i.transform.width||r.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e){let r=this._map,i=r.transform;if(!r.isMoving()){let o=rre(i,e);if(Object.keys(o).length>0)return this._internalUpdate=!0,r.jumpTo(o),this._internalUpdate=!1,!0}return!1}_updateSettings(e,r){let i=this._map,n=!1;for(let o of Rht)o in e&&!Qc(e[o],r[o])&&(n=!0,i[`set${o[0].toUpperCase()}${o.slice(1)}`]?.call(i,e[o]));return n}_updateStyle(e,r){if(e.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==r.mapStyle){let{mapStyle:i=t5e,styleDiffing:n=!0}=e,o={diff:n};"localIdeographFontFamily"in e&&(o.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(ire(i),o)}}_updateStyleComponents({light:e,projection:r,sky:i,terrain:n}){let o=this._map,s=this._styleComponents;o.style._loaded&&(e&&!Qc(e,s.light)&&(s.light=e,o.setLight(e)),r&&!Qc(r,s.projection)&&r!==s.projection?.type&&(s.projection=typeof r=="string"?{type:r}:r,o.setProjection?.(s.projection)),i&&!Qc(i,s.sky)&&(s.sky=i,o.setSky(i)),n!==void 0&&!Qc(n,s.terrain)&&(!n||o.getSource(n.source))&&(s.terrain=n,o.setTerrain(n)))}_updateHandlers(e,r){let i=this._map;for(let n of Oht){let o=e[n]??!0,s=r[n]??!0;Qc(o,s)||(o?i[n].enable(o):i[n].disable())}}_queryRenderedFeatures(e){let r=this._map,{interactiveLayerIds:i=[]}=this.props;try{return r.queryRenderedFeatures(e,{layers:i.filter(r.getLayer.bind(r))})}catch{return[]}}_updateHover(e){let{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){let n=e.type,o=this._hoveredFeatures?.length>0,s=this._queryRenderedFeatures(e.point),a=s.length>0;!a&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=s,a&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=n}else this._hoveredFeatures=null}};Xz.savedMaps=[];var nre=Xz;var Dht=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function ore(t){if(!t)return null;let e=t.map,r={getMap:()=>e};for(let i of Lht(e))!(i in r)&&!Dht.includes(i)&&(r[i]=e[i].bind(e));return r}function Lht(t){let e=new Set,r=t;for(;r;){for(let i of Object.getOwnPropertyNames(r))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);r=Object.getPrototypeOf(r)}return Array.from(e)}var Zz=Tt($t(),1),Bht=typeof document<"u"?Zz.useLayoutEffect:Zz.useEffect,o5e=Bht;function sre(t,e){let{RTLTextPlugin:r,maxParallelImageRequests:i,workerCount:n,workerUrl:o}=e;if(r&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"){let{pluginUrl:s,lazy:a=!0}=typeof r=="string"?{pluginUrl:r}:r;t.setRTLTextPlugin(s,u=>{u&&console.error(u)},a)}i!==void 0&&t.setMaxParallelImageRequests(i),n!==void 0&&t.setWorkerCount(n),o!==void 0&&t.setWorkerUrl(o)}var Z0=J_.createContext(null);function Fht(t,e){let r=(0,Uh.useContext)(JCe),[i,n]=(0,Uh.useState)(null),o=(0,Uh.useRef)(),{current:s}=(0,Uh.useRef)({mapLib:null,map:null});(0,Uh.useEffect)(()=>{let p=t.mapLib,m=!0,x;return Promise.resolve(p||Promise.resolve().then(()=>Tt(a5e(),1))).then(M=>{if(!m)return;if(!M)throw new Error("Invalid mapLib");let k="Map"in M?M:M.default;if(!k.Map)throw new Error("Invalid mapLib");sre(k,t),t.reuseMaps&&(x=nre.reuse(t,o.current)),x||(x=new nre(k.Map,t,o.current)),s.map=ore(x),s.mapLib=k,n(x),r?.onMapMount(s.map,t.id)}).catch(M=>{let{onError:k}=t;k?k({type:"error",target:null,originalEvent:null,error:M}):console.error(M)}),()=>{m=!1,x&&(r?.onMapUnmount(t.id),t.reuseMaps?x.recycle():x.destroy())}},[]),o5e(()=>{i&&i.setProps(t)}),(0,Uh.useImperativeHandle)(e,()=>s.map,[i]);let a=(0,Uh.useMemo)(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),u={height:"100%"};return J_.createElement("div",{id:t.id,ref:o,style:a},i&&J_.createElement(Z0.Provider,{value:s},J_.createElement("div",{"mapboxgl-children":"",style:u},t.children)))}var l4=J_.forwardRef(Fht);var c5e=Tt($t(),1),u5e=Tt(uM(),1),Jc=Tt($t(),1);var Nht=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function yl(t,e){if(!t||!e)return;let r=t.style;for(let i in e){let n=e[i];Number.isFinite(n)&&!Nht.test(i)?r[i]=`${n}px`:r[i]=n}}function Kz(t,e){if(t===e)return null;let r=l5e(t),i=l5e(e),n=[];for(let o of i)r.has(o)||n.push(o);for(let o of r)i.has(o)||n.push(o);return n.length===0?null:n}function l5e(t){return new Set(t?t.trim().split(/\s+/):[])}var zht=(0,Jc.memo)((0,Jc.forwardRef)((t,e)=>{let{map:r,mapLib:i}=(0,Jc.useContext)(Z0),n=(0,Jc.useRef)({props:t}),o=(0,Jc.useMemo)(()=>{let W=!1;c5e.Children.forEach(t.children,ee=>{ee&&(W=!0)});let Z={...t,element:W?document.createElement("div"):void 0},Y=new i.Marker(Z);return Y.setLngLat([t.longitude,t.latitude]),Y.getElement().addEventListener("click",ee=>{n.current.props.onClick?.({type:"click",target:Y,originalEvent:ee})}),Y.on("dragstart",ee=>{let ce=ee;ce.lngLat=o.getLngLat(),n.current.props.onDragStart?.(ce)}),Y.on("drag",ee=>{let ce=ee;ce.lngLat=o.getLngLat(),n.current.props.onDrag?.(ce)}),Y.on("dragend",ee=>{let ce=ee;ce.lngLat=o.getLngLat(),n.current.props.onDragEnd?.(ce)}),Y},[]);(0,Jc.useEffect)(()=>(o.addTo(r.getMap()),()=>{o.remove()}),[]);let{longitude:s,latitude:a,offset:u,style:p,draggable:m=!1,popup:x=null,rotation:M=0,rotationAlignment:k="auto",pitchAlignment:F="auto"}=t;(0,Jc.useEffect)(()=>{yl(o.getElement(),p)},[p]),(0,Jc.useImperativeHandle)(e,()=>o,[]);let j=n.current.props;(o.getLngLat().lng!==s||o.getLngLat().lat!==a)&&o.setLngLat([s,a]),u&&!e5e(o.getOffset(),u)&&o.setOffset(u),o.isDraggable()!==m&&o.setDraggable(m),o.getRotation()!==M&&o.setRotation(M),o.getRotationAlignment()!==k&&o.setRotationAlignment(k),o.getPitchAlignment()!==F&&o.setPitchAlignment(F),o.getPopup()!==x&&o.setPopup(x);let H=Kz(j.className,t.className);if(H)for(let W of H)o.toggleClassName(W);return n.current.props=t,(0,u5e.createPortal)(t.children,o.getElement())}));var h5e=Tt(uM(),1),fc=Tt($t(),1);var Uht=(0,fc.memo)((0,fc.forwardRef)((t,e)=>{let{map:r,mapLib:i}=(0,fc.useContext)(Z0),n=(0,fc.useMemo)(()=>document.createElement("div"),[]),o=(0,fc.useRef)({props:t}),s=(0,fc.useMemo)(()=>{let a={...t},u=new i.Popup(a);return u.setLngLat([t.longitude,t.latitude]),u.once("open",p=>{o.current.props.onOpen?.(p)}),u},[]);if((0,fc.useEffect)(()=>{let a=u=>{o.current.props.onClose?.(u)};return s.on("close",a),s.setDOMContent(n).addTo(r.getMap()),()=>{s.off("close",a),s.isOpen()&&s.remove()}},[]),(0,fc.useEffect)(()=>{yl(s.getElement(),t.style)},[t.style]),(0,fc.useImperativeHandle)(e,()=>s,[]),s.isOpen()){let a=o.current.props;(s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!Qc(a.offset,t.offset)&&s.setOffset(t.offset),(a.anchor!==t.anchor||a.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth));let u=Kz(a.className,t.className);if(u)for(let p of u)s.toggleClassName(p);o.current.props=t}return(0,h5e.createPortal)(t.children,n)}));var Qz=Tt($t(),1);var c4=Tt($t(),1);function jl(t,e,r,i){let n=(0,c4.useContext)(Z0),o=(0,c4.useMemo)(()=>t(n),[]);return(0,c4.useEffect)(()=>{let s=i||r||e,a=typeof e=="function"&&typeof r=="function"?e:null,u=typeof r=="function"?r:typeof e=="function"?e:null,{map:p}=n;return p.hasControl(o)||(p.addControl(o,s?.position),a&&a(n)),()=>{u&&u(n),p.hasControl(o)&&p.removeControl(o)}},[]),o}function Vht(t){let e=jl(({mapLib:r})=>new r.AttributionControl(t),{position:t.position});return(0,Qz.useEffect)(()=>{yl(e._container,t.style)},[t.style]),null}var jht=(0,Qz.memo)(Vht);var Jz=Tt($t(),1);function $ht(t){let e=jl(({mapLib:r})=>new r.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return(0,Jz.useEffect)(()=>{yl(e._controlContainer,t.style)},[t.style]),null}var cre=(0,Jz.memo)($ht);var K0=Tt($t(),1);function Wht(t,e){let r=(0,K0.useRef)({props:t}),i=jl(({mapLib:n})=>{let o=new n.GeolocateControl(t),s=o._setupUI;return o._setupUI=()=>{o._container.hasChildNodes()||s()},o.on("geolocate",a=>{r.current.props.onGeolocate?.(a)}),o.on("error",a=>{r.current.props.onError?.(a)}),o.on("outofmaxbounds",a=>{r.current.props.onOutOfMaxBounds?.(a)}),o.on("trackuserlocationstart",a=>{r.current.props.onTrackUserLocationStart?.(a)}),o.on("trackuserlocationend",a=>{r.current.props.onTrackUserLocationEnd?.(a)}),o},{position:t.position});return r.current.props=t,(0,K0.useImperativeHandle)(e,()=>i,[]),(0,K0.useEffect)(()=>{yl(i._container,t.style)},[t.style]),null}var Ght=(0,K0.memo)((0,K0.forwardRef)(Wht));var eU=Tt($t(),1);function Hht(t){let e=jl(({mapLib:r})=>new r.NavigationControl(t),{position:t.position});return(0,eU.useEffect)(()=>{yl(e._container,t.style)},[t.style]),null}var ure=(0,eU.memo)(Hht);var u4=Tt($t(),1);function qht(t){let e=jl(({mapLib:o})=>new o.ScaleControl(t),{position:t.position}),r=(0,u4.useRef)(t),i=r.current;r.current=t;let{style:n}=t;return t.maxWidth!==void 0&&t.maxWidth!==i.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==i.unit&&e.setUnit(t.unit),(0,u4.useEffect)(()=>{yl(e._container,n)},[n]),null}var hre=(0,u4.memo)(qht);var tU=Tt($t(),1);function Yht(t){let e=jl(({mapLib:r})=>new r.TerrainControl(t),{position:t.position});return(0,tU.useEffect)(()=>{yl(e._container,t.style)},[t.style]),null}var Xht=(0,tU.memo)(Yht);var rU=Tt($t(),1);function Zht(t){let e=jl(({mapLib:r})=>new r.LogoControl(t),{position:t.position});return(0,rU.useEffect)(()=>{yl(e._container,t.style)},[t.style]),null}var Kht=(0,rU.memo)(Zht);var Jht=Tt($t(),1),h4=Tt($t(),1);var Jk=Tt($t(),1);var Vh=Tt(oo(),1),d4=class extends Bh{static controlType;position;constructor(e,r){super(e,r),this.initRegularAttribute("position","position")}baseDeckProps(){return{...Ze(this.position)?{placement:this.position}:{}}}baseMaplibreProps(){return{...Ze(this.position)?{position:this.position}:{}}}},eR=class extends d4{static controlType="fullscreen";constructor(e,r){super(e,r)}renderDeck(){let{placement:e,...r}=this.baseDeckProps(),i={placement:e||"top-right",...r};return console.log(e),(0,Vh.jsx)("div",{children:(0,Vh.jsx)(Kte,{...i})})}renderMaplibre(){return(0,Vh.jsx)("div",{children:(0,Vh.jsx)(cre,{...this.baseMaplibreProps()})})}},tR=class extends d4{static controlType="navigation";showCompass;showZoom;visualizePitch;visualizeRoll;constructor(e,r){super(e,r),this.initRegularAttribute("show_compass","showCompass"),this.initRegularAttribute("show_zoom","showZoom"),this.initRegularAttribute("visualize_pitch","visualizePitch"),this.initRegularAttribute("visualize_roll","visualizeRoll")}renderDeck(){return(0,Vh.jsxs)("div",{children:[this.showZoom&&(0,Vh.jsx)(Qte,{...this.baseDeckProps()}),this.showCompass&&(0,Vh.jsx)(Zte,{...this.baseDeckProps()})]})}renderMaplibre(){let e={...this.baseMaplibreProps(),...Ze(this.showCompass)&&{showCompass:this.showCompass},...Ze(this.showZoom)&&{showZoom:this.showZoom},...Ze(this.visualizePitch)&&{visualizePitch:this.visualizePitch},...Ze(this.visualizeRoll)&&{visualizeRoll:this.visualizeRoll}};return(0,Vh.jsx)(ure,{...e})}},rR=class extends d4{static controlType="scale";maxWidth;unit;constructor(e,r){super(e,r),this.initRegularAttribute("max_width","maxWidth"),this.initRegularAttribute("unit","unit")}renderDeck(){return(0,Vh.jsx)(Jte,{...this.baseDeckProps()})}renderMaplibre(){let e={...this.baseMaplibreProps(),...Ze(this.maxWidth)&&{maxWidth:this.maxWidth},...Ze(this.unit)&&{unit:this.unit}};return(0,Vh.jsx)("div",{children:(0,Vh.jsx)(hre,{...e})})}};async function d5e(t,e){let r=t.get("_control_type"),i;switch(r){case eR.controlType:i=new eR(t,e);break;case tR.controlType:i=new tR(t,e);break;case rR.controlType:i=new rR(t,e);break;default:throw new Error(`no control supported for ${r}`)}return i}function dre(t,e,r){let[i,n]=(0,iU.useState)({});return(0,iU.useEffect)(()=>{(async()=>{try{let s=await Gg(e,t,i,async a=>d5e(a,r));n(s)}catch(s){console.error("Error loading controls:",s)}})()},[t]),Object.values(i)}var nU=Tt($t(),1);function fre(t,e,r,i,n,o){let[s,a]=(0,nU.useState)({});return(0,nU.useEffect)(()=>{(async()=>{try{let p=await Gg(e,t,s,async m=>Dte(m,r));a(p),n||o(i)}catch(p){console.error("Error loading child models or setting bounds:",p)}})()},[t,i,n]),Object.values(s).flatMap(u=>u.render())}var uU=Tt($t(),1);var hx=class extends Bh{x;y;width;height;padding;constructor(e,r){super(e,r),this.initRegularAttribute("x","x"),this.initRegularAttribute("y","y"),this.initRegularAttribute("width","width"),this.initRegularAttribute("height","height"),this.initRegularAttribute("padding","padding")}baseViewProps(){return{id:this.model.model_id,...Ze(this.x)&&{x:this.x},...Ze(this.y)&&{y:this.y},...Ze(this.width)&&{width:this.width},...Ze(this.height)&&{height:this.height},...Ze(this.padding)&&{padding:this.padding}}}},oU=class extends hx{static viewType="first-person-view";projectionMatrix;fovy;near;far;focalDistance;constructor(e,r){super(e,r),this.initRegularAttribute("projection_matrix","projectionMatrix"),this.initRegularAttribute("fovy","fovy"),this.initRegularAttribute("near","near"),this.initRegularAttribute("far","far"),this.initRegularAttribute("focal_distance","focalDistance")}viewProps(){return{...Ze(this.projectionMatrix)&&{projectionMatrix:this.projectionMatrix},...Ze(this.fovy)&&{fovy:this.fovy},...Ze(this.near)&&{near:this.near},...Ze(this.far)&&{far:this.far},...Ze(this.focalDistance)&&{focalDistance:this.focalDistance}}}build(){return new aQ({...this.baseViewProps(),...this.viewProps()})}},sU=class extends hx{static viewType="globe-view";resolution;nearZMultiplier;farZMultiplier;constructor(e,r){super(e,r),this.initRegularAttribute("resolution","resolution"),this.initRegularAttribute("near_z_multiplier","nearZMultiplier"),this.initRegularAttribute("far_z_multiplier","farZMultiplier")}viewProps(){return{...Ze(this.resolution)&&{resolution:this.resolution},...Ze(this.nearZMultiplier)&&{nearZMultiplier:this.nearZMultiplier},...Ze(this.farZMultiplier)&&{farZMultiplier:this.farZMultiplier}}}build(){return new yb({...this.baseViewProps(),...this.viewProps()})}},aU=class extends hx{static viewType="map-view";repeat;nearZMultiplier;farZMultiplier;projectionMatrix;fovy;altitude;orthographic;constructor(e,r){super(e,r),this.initRegularAttribute("repeat","repeat"),this.initRegularAttribute("near_z_multiplier","nearZMultiplier"),this.initRegularAttribute("far_z_multiplier","farZMultiplier"),this.initRegularAttribute("projection_matrix","projectionMatrix"),this.initRegularAttribute("fovy","fovy"),this.initRegularAttribute("altitude","altitude"),this.initRegularAttribute("orthographic","orthographic")}viewProps(){return{...Ze(this.repeat)&&{repeat:this.repeat},...Ze(this.nearZMultiplier)&&{nearZMultiplier:this.nearZMultiplier},...Ze(this.farZMultiplier)&&{farZMultiplier:this.farZMultiplier},...Ze(this.projectionMatrix)&&{projectionMatrix:this.projectionMatrix},...Ze(this.fovy)&&{fovy:this.fovy},...Ze(this.altitude)&&{altitude:this.altitude},...Ze(this.orthographic)&&{orthographic:this.orthographic}}}build(){return new d_({...this.baseViewProps(),...this.viewProps()})}},lU=class extends hx{static viewType="orbit-view";orbitAxis;projectionMatrix;fovy;near;far;orthographic;constructor(e,r){super(e,r),this.initRegularAttribute("orbit_axis","orbitAxis"),this.initRegularAttribute("projection_matrix","projectionMatrix"),this.initRegularAttribute("fovy","fovy"),this.initRegularAttribute("near","near"),this.initRegularAttribute("far","far"),this.initRegularAttribute("orthographic","orthographic")}viewProps(){return{...Ze(this.orbitAxis)&&{orbitAxis:this.orbitAxis},...Ze(this.projectionMatrix)&&{projectionMatrix:this.projectionMatrix},...Ze(this.fovy)&&{fovy:this.fovy},...Ze(this.near)&&{near:this.near},...Ze(this.far)&&{far:this.far},...Ze(this.orthographic)&&{orthographic:this.orthographic}}}build(){return new lQ({...this.baseViewProps(),...this.viewProps()})}},cU=class extends hx{static viewType="orthographic-view";flipY;near;far;constructor(e,r){super(e,r),this.initRegularAttribute("flip_y","flipY"),this.initRegularAttribute("near","near"),this.initRegularAttribute("far","far")}viewProps(){return{...Ze(this.flipY)&&{flipY:this.flipY},...Ze(this.near)&&{near:this.near},...Ze(this.far)&&{far:this.far}}}build(){return new uQ({...this.baseViewProps(),...this.viewProps()})}};async function f5e(t,e){let r=t.get("_view_type");switch(r){case oU.viewType:return new oU(t,e);case sU.viewType:return new sU(t,e);case aU.viewType:return new aU(t,e);case lU.viewType:return new lU(t,e);case cU.viewType:return new cU(t,e);default:throw new Error(`no view supported for ${r}`)}}function pre(t,e,r){let[i,n]=(0,uU.useState)({});(0,uU.useEffect)(()=>{(async()=>{try{if(!t){n({});return}let a=await Gg(e,typeof t=="string"?[t]:t,i,async u=>f5e(u,r));n(a)}catch(a){console.error("Error loading child views:",a)}})()},[t]);let o=Object.values(i).map(s=>s.build());return o.length>0?o:void 0}var hU=Tt(oo(),1),edt=t=>{let{controls:e,mapStyle:r,customAttribution:i,deckRef:n,renderBasemap:o,...s}=t;return(0,hU.jsxs)(Vte,{ref:n,style:{width:"100%",height:"100%"},controller:!0,...s,children:[e.map(a=>a.renderDeck()),o&&(0,hU.jsx)(l4,{mapStyle:r,customAttribution:i})]})},p5e=edt;var iR="mapbox",mre=512,tdt=Math.PI/180;function dU({map:t,gl:e,deck:r}){if(t.__deck)return t.__deck;let i=r?.props._customRender,n=r?.props.onLoad,o={...r?.props,_customRender:()=>{t.triggerRepaint(),i?.("")}};o.parameters={...nR(t,!0),...o.parameters},o.views||(o.views=f4(t));let s;return(!r||r.props.gl===e)&&(Object.assign(o,{gl:e,width:null,height:null,touchAction:"unset",viewState:p4(t)}),r?.isInitialized?m5e(r,t):o.onLoad=()=>{n?.(),m5e(s,t)}),r?(s=r,r.setProps(o),r.userData.isExternal=!0):(s=new g_(o),t.on("remove",()=>{gre(t)})),s.userData.mapboxLayers=new Set,t.__deck=s,t.on("render",()=>{s.isInitialized&&idt(s,t)}),s}function m5e(t,e){let r=()=>{t.isInitialized?ndt(t,e):e.off("move",r)};e.on("move",r)}function gre(t){t.__deck?.finalize(),t.__deck=null}function nR(t,e){let r=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return fU(t)==="globe"&&(r.cullMode="back"),r}function g5e(t,e){t.userData.mapboxLayers.add(e),Are(t)}function A5e(t,e){t.userData.mapboxLayers.delete(e),Are(t)}function y5e(t,e){Are(t)}function _5e(t,e,r,i){let{currentViewport:n}=t.userData,o=!1;n||(n=v5e(t,e,i),t.userData.currentViewport=n,o=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[n],layerFilter:s=>(!t.props.layerFilter||t.props.layerFilter(s))&&(r.id===s.layer.id||s.layer.props.operation.includes("terrain")),clearStack:o,clearCanvas:!1})}function fU(t){let e=t.getProjection?.(),r=e?.type||e?.name;if(r==="globe")return"globe";if(r&&r!=="mercator")throw new Error("Unsupported projection");return"mercator"}function f4(t){return fU(t)==="globe"?new yb({id:iR}):new d_({id:iR})}function p4(t){let{lng:e,lat:r}=t.getCenter(),i={longitude:(e+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return t.getTerrain?.()&&rdt(t,i),i}function rdt(t,e){if(t.getFreeCameraOptions){let{position:r}=t.getFreeCameraOptions();if(!r||r.z===void 0)return;let i=t.transform.height,{longitude:n,latitude:o,pitch:s}=e,a=r.x*mre,u=(1-r.y)*mre,p=r.z*mre,m=Ha([n,o]),x=a-m[0],M=u-m[1],k=Math.sqrt(x*x+M*M),F=s*tdt,j=1.5*i,H=F<.001?j*Math.cos(F)/p:j*Math.sin(F)/k;e.zoom=Math.log2(H);let W=j*Math.cos(F)/H,Z=p-W;e.position=[0,0,Z/sb(o)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function v5e(t,e,r){let i=p4(e),{views:n}=t.props,o=n&&Uc(n).find(u=>u.id===iR)||f4(e);r&&(o.props.nearZMultiplier=.2);let s=r?.nearZ??e.transform._nearZ,a=r?.farZ??e.transform._farZ;return Number.isFinite(s)&&(i.nearZ=s/e.transform.height,i.farZ=a/e.transform.height),o.makeViewport({width:t.width,height:t.height,viewState:i})}function idt(t,e){let{mapboxLayers:r,isExternal:i}=t.userData;if(i){let n=Array.from(r,m=>m.id),s=Uc(t.props.layers,Boolean).some(m=>m&&!n.includes(m.id)),a=t.getViewports(),u=a.findIndex(m=>m.id===iR),p=a.length>1||u<0;(s||p)&&(u>=0&&(a=a.slice(),a[u]=v5e(t,e)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:m=>(!t.props.layerFilter||t.props.layerFilter(m))&&(m.viewport.id!==iR||!n.includes(m.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function ndt(t,e){t.setProps({viewState:p4(e)}),t.needsRedraw({clearRedrawFlags:!0})}function Are(t){if(t.userData.isExternal)return;let e=[];t.userData.mapboxLayers.forEach(r=>{let i=r.props.type,n=new i(r.props);e.push(n)}),t.setProps({layers:e})}var oR=class{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,r){this.map=e,this.deck=dU({map:e,gl:r,deck:this.props.deck}),g5e(this.deck,this)}onRemove(){this.deck&&A5e(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&y5e(this.deck,this)}render(e,r){_5e(this.deck,this.map,this,r)}};var yre="__UNDEFINED__";function sR(t,e,r,i){if(!t||!e||!t.style||!t.style._loaded)return;let n=Uc(i,Boolean);if(r!==i){let a=Uc(r,Boolean),u=new Set(a.map(p=>p.id));for(let p of n)u.delete(p.id);for(let p of u)t.getLayer(p)&&t.removeLayer(p)}for(let a of n){let u=t.getLayer(a.id);u?(u.implementation||u).setProps(a.props):t.addLayer(new oR({id:a.id,deck:e,slot:a.props.slot}),a.props.beforeId)}let o=t.style._order,s={};for(let a of n){let{beforeId:u}=a.props;(!u||!o.includes(u))&&(u=yre),s[u]=s[u]||[],s[u].push(a.id)}for(let a in s){let u=s[a],p=a===yre?o.length:o.indexOf(a),m=a===yre?void 0:a;for(let x=u.length-1;x>=0;x--){let M=u[x],k=o.indexOf(M);k!==p-1&&(t.moveLayer(M,m),k>p&&p++),p--,m=M}}}var m4=class{constructor(e){this._handleStyleChange=()=>{if(sR(this._map,this._deck,this._props.layers,this._props.layers),!this._map)return;fU(this._map)&&!this._props.views&&this._deck?.setProps({views:f4(this._map)})},this._updateContainerSize=()=>{if(this._map&&this._container){let{clientWidth:i,clientHeight:n}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${n}px`})}},this._updateViewState=()=>{let i=this._deck,n=this._map;i&&n&&(i.setProps({views:this._props.views||f4(n),viewState:p4(n)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{let n=this._deck;if(!n||!n.isInitialized)return;let o={type:i.type,offsetCenter:i.point,srcEvent:i},s=this._lastMouseDownPoint;switch(!i.point&&s&&(o.deltaX=i.originalEvent.clientX-s.clientX,o.deltaY=i.originalEvent.clientY-s.clientY,o.offsetCenter={x:s.x+o.deltaX,y:s.y+o.deltaY}),o.type){case"mousedown":n._onPointerDown(o),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":o.type="panstart",n._onEvent(o);break;case"drag":o.type="panmove",n._onEvent(o);break;case"dragend":o.type="panend",n._onEvent(o);break;case"click":o.tapCount=1,n._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,n._onEvent(o);break;case"mousemove":o.type="pointermove",n._onPointerMove(o);break;case"mouseout":o.type="pointerleave",n._onPointerMove(o);break;default:return}};let{interleaved:r=!1}=e;this._interleaved=r,this._props=this.filterProps(e)}filterProps(e){let{interleaved:r=!1,useDevicePixels:i,...n}=e;return!r&&i!==void 0&&(n.useDevicePixels=i),n}setProps(e){this._interleaved&&e.layers&&sR(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,this.filterProps(e)),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...nR(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){let r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new g_({...this._props,parent:r,parameters:{...nR(e,!1),...this._props.parameters},views:this._props.views||f4(e),viewState:p4(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(e){let r=e.painter.context.gl;return r instanceof WebGLRenderingContext&&mr.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=dU({map:e,gl:r,deck:new g_({...this._props,gl:r,parameters:{...nR(e,!1),...this._props.parameters},deviceProps:{createCanvasContext:{autoResize:!0}}})}),e.on("styledata",this._handleStyleChange),sR(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){let e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),sR(e,this._deck,this._props.layers,[]),gre(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Pr(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Pr(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Pr(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}};var pU=Tt(oo(),1);function odt(t){return jl(()=>new m4(t)).setProps(t),null}var sdt=t=>{let{controls:e,mapStyle:r,customAttribution:i,initialViewState:n,views:o,onViewStateChange:s,...a}=t;return(0,pU.jsxs)(l4,{reuseMaps:!0,initialViewState:n,mapStyle:r,attributionControl:{customAttribution:i},style:{width:"100%",height:"100%"},onMoveEnd:s?p=>{let m={longitude:p.viewState.longitude,latitude:p.viewState.latitude,zoom:p.viewState.zoom,pitch:p.viewState.pitch,bearing:p.viewState.bearing};s({viewId:"mapLibreId",viewState:m})}:void 0,...PB(o)&&{projection:"globe"},children:[e.map(p=>p.renderMaplibre()),(0,pU.jsx)(odt,{...a})]})},b5e=sdt;var w5e=Tt($t(),1);var aR=Tt(oo(),1),mU=({fill:t="currentColor",filled:e=!1,size:r,height:i,width:n,label:o,...s})=>{let a=r||n||i||16;return(0,aR.jsx)("svg",{width:a,height:a,viewBox:"0 0 16 16",fill:e?t:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":o,...s,children:(0,aR.jsx)("polygon",{points:"14.707,2.707 13.293,1.293 8,6.586 2.707,1.293 1.293,2.707 6.586,8 1.293,13.293 2.707,14.707 8,9.414 13.293,14.707 14.707,13.293 9.414,8 ",fill:t})})},x5e=({fill:t="currentColor",filled:e=!1,size:r,height:i,width:n,label:o,...s})=>{let a=r||n||i||24;return(0,aR.jsx)("svg",{width:a,height:a,viewBox:"0 0 24 24",fill:e?t:"none",xmlns:"http://www.w3.org/2000/svg","aria-label":o,...s,children:(0,aR.jsx)("rect",{x:"6",y:"6",width:"12",height:"12",fill:t})})};var eu=Tt(oo(),1),gU=Symbol.for("rowIndex"),adt=({onClose:t})=>(0,eu.jsxs)("div",{className:"pl-4 py-3 flex justify-between items-center border-b border-default-300 bg-default-100",children:[(0,eu.jsx)("div",{className:"font-bold text-lg",children:"Feature properties"}),(0,eu.jsx)(RC,{onClick:t,variant:"flat",isIconOnly:!0,className:"bg-default-100",children:(0,eu.jsx)(mU,{})})]}),ldt=({info:t,onClose:e})=>{let{object:r}=t;if(!r||r[gU]===null||r[gU]===void 0||r[gU]&&r[gU]<0)return null;let i=r.toJSON?.()||r;if(!i||typeof i!="object")return null;let{...n}=i;return Object.keys(n).length===0?null:(0,eu.jsxs)("div",{className:"bg-white shadow-md text-black h-full w-96 overflow-y-auto overflow-x-hidden box-border mr-1",children:[(0,eu.jsx)(adt,{onClose:e}),(0,eu.jsx)("table",{className:"w-full border-collapse [&_td]:block",children:(0,eu.jsx)("tbody",{className:"grid grid-cols-[minmax(0,_2fr)_minmax(0,_3fr)]",children:Object.entries(n).filter(([o])=>o!=="geometry").map(([o,s],a)=>(0,eu.jsxs)(w5e.default.Fragment,{children:[(0,eu.jsx)("td",{className:`border border-gray-300 px-4 py-2 font-medium ${a%2===0?"bg-white":"bg-gray-100"}`,children:(0,eu.jsx)("div",{className:"truncate",title:o,children:o})}),(0,eu.jsx)("td",{className:`border border-gray-300 px-4 py-2 ${a%2===0?"bg-white":"bg-gray-100"}`,children:(0,eu.jsx)("div",{className:"break-words",title:String(s),children:String(s)})})]},o))})})]})},S5e=ldt;var T5e=Tt(fY(),1),AU=Tt($t(),1),cdt=(0,T5e.default)(t=>{t.save_changes()},300);function M5e(t){let e=lE(),[r,i]=AU.useState(e.get(t));return AU.useEffect(()=>{let n=()=>{i(e.get(t))};return e.on(`change:${t}`,n),()=>e.off(`change:${t}`,n)},[e,t]),[r,n=>{e.set(t,n),cdt(e)}]}var k3r=Tt(D6e(),1);var I4=Tt($t()),av=Tt($t());_R();var j6e=Tt(V6e()),Agt=Tt(xie()),$6e=(t,e)=>{e(t);let r=t.getSnapshot().children;r&&Object.values(r).forEach(i=>{$6e(i,e)})};function ygt(t){let e=[];$6e(t,i=>{e.push([i,i.getSnapshot()]),i.observers=new Set});let r=t.system.getSnapshot?.();t.stop(),t.system._snapshot=r,e.forEach(([i,n])=>{i._processingStatus=0,i._snapshot=n})}function _gt(t,...[e]){let[[r,i],n]=(0,av.useState)(()=>{let o=pc(t,e);return[t.config,o]});if(t.config!==r){let o=pc(t,{...e,snapshot:i.getPersistedSnapshot({__unsafeAllowInlineActors:!0})});n([t.config,o]),i=o}return Cme(()=>{i.logic.implementations=t.implementations}),i}function vgt(t,...[e,r]){let i=_gt(t,e);return(0,av.useEffect)(()=>{if(!r)return;let n=i.subscribe(gx(r));return()=>{n.unsubscribe()}},[r]),(0,av.useEffect)(()=>(i.start(),()=>{ygt(i)}),[i]),i}function bgt(t,e){return t===e}function xgt(t,e,r=bgt){let i=(0,av.useCallback)(s=>{if(!t)return()=>{};let{unsubscribe:a}=t.subscribe(s);return a},[t]),n=(0,av.useCallback)(()=>t?.getSnapshot(),[t]);return(0,j6e.useSyncExternalStoreWithSelector)(i,n,n,e,r)}function W6e(t,e){let r=I4.createContext(null),i=r.Provider;function n({children:a,logic:u=t,machine:p,options:m}){if(p)throw new Error('The "machine" prop has been deprecated. Please use "logic" instead.');let x=vgt(u,{...e,...m});return I4.createElement(i,{value:x,children:a})}n.displayName="ActorProvider";function o(){let a=I4.useContext(r);if(!a)throw new Error(`You used a hook from "${n.displayName}" but it's not inside a <${n.displayName}> component.`);return a}function s(a,u){let p=o();return xgt(p,a,u)}return{Provider:n,useActorRef:o,useSelector:s}}_R();var G6e=OU({id:"lonboard",types:{context:{},events:{},actions:{}},context:{bboxSelectStart:void 0,bboxSelectEnd:void 0,highlightedFeature:void 0},states:{"Pan mode":{on:{"BBox select button clicked":{target:"Selecting bbox start position",actions:"clearBboxSelect"},"Clear BBox":{target:"Pan mode",actions:"clearBboxSelect"},"Map click event":{target:"Pan mode",actions:"setHighlightedFeature"},"Close side panel":{target:"Pan mode",actions:"clearHighlightedFeature"}}},"Selecting bbox start position":{on:{"Map click event":{target:"Selecting bbox end position",actions:"setBboxSelectStart"},"Cancel BBox draw":{target:"Pan mode",reenter:!0,actions:"clearBboxSelect"},"Close side panel":{target:"Selecting bbox start position",actions:"clearHighlightedFeature"}}},"Selecting bbox end position":{on:{"Map hover event":{target:"Selecting bbox end position",actions:"setBboxSelectEnd"},"Map click event":{target:"Pan mode",actions:"setBboxSelectEnd"},"Cancel BBox draw":{target:"Pan mode",reenter:!0,actions:"clearBboxSelect"},"Close side panel":{target:"Selecting bbox end position",actions:"clearHighlightedFeature"}}}},initial:"Pan mode"},{actions:{clearBboxSelect:ju(()=>({bboxSelectStart:void 0,bboxSelectEnd:void 0})),setBboxSelectStart:ju(({event:t})=>t.type==="Map click event"&&"data"in t?{bboxSelectStart:t.data.coordinate}:{}),setBboxSelectEnd:ju(({event:t})=>(t.type==="Map click event"||t.type==="Map hover event")&&"data"in t?{bboxSelectEnd:t.data.coordinate}:{}),setHighlightedFeature:ju(({event:t})=>t.type==="Map click event"&&"data"in t&&typeof t.data.object<"u"?{highlightedFeature:t.data}:{highlightedFeature:void 0}),clearHighlightedFeature:ju(()=>({highlightedFeature:void 0}))},actors:{}});var q6e=Tt(oo(),1),Jd=W6e(G6e,void 0);function H6e(t){return(0,q6e.jsx)(Jd.Provider,{children:t.children})}var ER=t=>t.matches("Selecting bbox start position")||t.matches("Selecting bbox end position"),Y6e=t=>t.matches("Selecting bbox end position");var X6e=t=>{if(t.context.bboxSelectStart&&t.context.bboxSelectEnd){let e={id:"bbox-select-polygon",data:[[[t.context.bboxSelectStart[0],t.context.bboxSelectStart[1]],[t.context.bboxSelectEnd[0],t.context.bboxSelectStart[1]],[t.context.bboxSelectEnd[0],t.context.bboxSelectEnd[1]],[t.context.bboxSelectStart[0],t.context.bboxSelectEnd[1]]]],getPolygon:r=>r,getFillColor:[0,0,0,50],getLineColor:[0,0,0,130],stroked:!0,getLineWidth:2,lineWidthUnits:"pixels"};return ER(t)&&(e.getFillColor=[255,255,0,120],e.getLineColor=[211,211,38,200],e.getLineWidth=2),new hp(e)}return null},Z6e=t=>{if(t.context.bboxSelectStart&&t.context.bboxSelectEnd){let[e,r]=t.context.bboxSelectStart,[i,n]=t.context.bboxSelectEnd;return[Math.min(e,i),Math.min(r,n),Math.max(e,i),Math.max(r,n)]}return null};var kx=Tt(oo(),1),wgt=()=>{let t=Jd.useActorRef(),e=Jd.useSelector(ER),r=Jd.useSelector(n=>n.context.bboxSelectStart&&n.context.bboxSelectEnd);return(0,kx.jsx)("div",{style:{position:"absolute",bottom:"20px",right:"20px",zIndex:1e3,backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",padding:"4px",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},children:(0,kx.jsx)(eY,{variant:"flat",children:(0,kx.jsx)(uY,{content:e?"Cancel drawing":r?"Clear bounding box":"Start bounding box selection",placement:"bottom",children:(0,kx.jsx)(RC,{isIconOnly:!0,"aria-label":e?"Cancel drawing":r?"Clear bounding box":"Select BBox",color:e?"warning":r?"danger":"default",onClick:()=>{e?t.send({type:"Cancel BBox draw"}):r?t.send({type:"Clear BBox"}):t.send({type:"BBox select button clicked"})},children:e||r?(0,kx.jsx)(mU,{}):(0,kx.jsx)(x5e,{})})})})})},Q6e=wgt;var hV=Symbol.for("rowIndex");function Sgt(t){return`<table>
      <tbody>
        ${Object.keys(t).map(e=>{let r=t[e];return`<tr>
              <td>${e}</td>
              <td>${r}</td>
            </tr>`}).join("")}
      </tbody>
    </table>`}function J6e({object:t}){if(t){if(t[hV]===null||t[hV]===void 0||t[hV]&&t[hV]<0)return null;let e=t.toJSON();return!e||(delete e.geometry,Object.keys(e).length===0)?null:{className:"lonboard-tooltip",html:Sgt(e),style:{backgroundColor:"#fff",boxShadow:"0 0 15px rgba(0, 0, 0, 0.1)",color:"#000",padding:"6px"}}}return null}var ef=Tt(oo(),1);await Zwe();function Tgt(){let t=Jd.useActorRef(),e=Jd.useSelector(ER),r=Jd.useSelector(Y6e),i=Jd.useSelector(Et=>Et.context.highlightedFeature),n=Jd.useSelector(X6e),o=Jd.useSelector(Z6e),[s,a]=(0,Ap.useState)(!1),u=(0,Ap.useRef)(null);(0,Ap.useEffect)(()=>{u.current&&typeof window<"u"&&(window.__deck=u.current.deck)},[u.current]);let p=lE(),[m]=gh("basemap"),[x]=gh("height"),[M]=gh("show_tooltip"),[k]=gh("show_side_panel"),[F]=gh("picking_radius"),[j]=gh("use_device_pixels"),[H]=gh("parameters"),[W]=gh("custom_attribution"),[Z]=(0,Ap.useState)(yY()),[Y]=gh("layers"),[ee]=gh("view"),[ce]=gh("controls"),[ge,Se]=gh("selected_bounds"),[ne,pe]=M5e("view_state");p.on("msg:custom",Et=>{switch(Et.type){case"fly-to":Rbe(Et,pe);break;default:break}});let[ue,Le]=(0,Ap.useState)(new Date),We=()=>Le(new Date),ze=TJ(m,p.widget_manager,We),rt=dre(ce,p.widget_manager,We),at=fre(Y,p.widget_manager,We,o,e,Se),Wt=pre(ee,p.widget_manager,We),It=(0,Ap.useCallback)(Et=>{typeof Et.coordinate<"u"&&p.get("_has_click_handlers")&&p.send({kind:"on-click",coordinate:Et.coordinate}),a(!0),t.send({type:"Map click event",data:Et}),setTimeout(()=>{a(!1)},100)},[]),Bt=(0,Ap.useCallback)((0,tIe.default)(Et=>r&&!s&&t.send({type:"Map hover event",data:Et}),100),[r,s]),Qt={mapStyle:ze?.style||Qwe,customAttribution:W,deckRef:u,initialViewState:ne,layers:n?at.concat(n):at,getTooltip:M&&J6e||void 0,getCursor:()=>e?"crosshair":"grab",pickingRadius:F,onClick:It,onHover:Bt,...Ze(j)&&{useDevicePixels:j},onResize:(0,eIe.default)(We,100),onViewStateChange:Et=>{pe(kbe(Wt,Et.viewState))},parameters:H||{},views:Wt,controls:rt},hr={interleaved:ze?.mode==="interleaved"},nt={renderBasemap:!!ze};return(0,ef.jsx)("div",{className:"lonboard",style:{minHeight:"100%",height:x},"data-jp-suppress-context-menu":!0,children:(0,ef.jsxs)("div",{id:`map-${Z}`,className:"flex",style:{width:"100%",height:"100%",...PB(Wt)&&{background:"linear-gradient(0, #000, #223)"}},children:[(0,ef.jsx)(Q6e,{}),k&&i&&(0,ef.jsx)(S5e,{info:i,onClose:()=>t.send({type:"Close side panel"})}),(0,ef.jsx)("div",{className:"bg-transparent h-full w-full relative",children:ze?.mode==="overlaid"||ze?.mode==="interleaved"?(0,ef.jsx)(b5e,{...Qt,...hr}):(0,ef.jsx)(p5e,{...Qt,...nt})})]})})}var Mgt=()=>(0,ef.jsx)(Lq,{children:(0,ef.jsx)(H6e,{children:(0,ef.jsx)(Tgt,{})})}),Egt={render:Gce(Mgt)},fSr=Egt;export{fSr as default};
/*! Bundled license information:

react/cjs/react.production.js:
  (**
   * @license React
   * react.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.js:
  (**
   * @license React
   * scheduler.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.js:
  (**
   * @license React
   * react-dom.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom-client.production.js:
  (**
   * @license React
   * react-dom-client.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.js:
  (**
   * @license React
   * react-jsx-runtime.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

long/dist/long.js:
  (**
   * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
   * Released under the Apache License, Version 2.0
   * see: https://github.com/dcodeIO/long.js for details
   *)

maplibre-gl/dist/maplibre-gl.js:
  (**
   * MapLibre GL JS
   * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.10.0/LICENSE.txt
   *)

partysocket/dist/index.js:
  (*!
   * Reconnecting WebSocket
   * by Pedro Ladaria <pedro.ladaria@gmail.com>
   * https://github.com/pladaria/reconnecting-websocket
   * License MIT
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

@nextui-org/shared-utils/dist/chunk-RFEIBVIG.mjs:
  (**
   * @license React
   * react.development.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
